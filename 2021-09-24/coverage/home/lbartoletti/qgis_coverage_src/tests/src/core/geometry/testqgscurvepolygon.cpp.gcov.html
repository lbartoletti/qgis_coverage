<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info.cleaned - /home/lbartoletti/qgis_coverage_src/tests/src/core/geometry/testqgscurvepolygon.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../../index.html">top level</a> - <a href="index.html">home/lbartoletti/qgis_coverage_src/tests/src/core/geometry</a> - testqgscurvepolygon.cpp<span style="font-size: 80%;"> (source / <a href="testqgscurvepolygon.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info.cleaned</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1273</td>
            <td class="headerCovTableEntry">1273</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-09-24 09:20:41</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /***************************************************************************</a>
<a name="2"><span class="lineNum">       2 </span>                :            :      testqgscurvepolygon.cpp</a>
<a name="3"><span class="lineNum">       3 </span>                :            :      --------------------------------------</a>
<a name="4"><span class="lineNum">       4 </span>                :            :     Date                 : August 2021</a>
<a name="5"><span class="lineNum">       5 </span>                :            :     Copyright            : (C) 2021 by Lo√Øc Bartoletti</a>
<a name="6"><span class="lineNum">       6 </span>                :            :                            (C) 2021 by Antoine Facchini</a>
<a name="7"><span class="lineNum">       7 </span>                :            :     Email                : loic dot bartoletti at oslandia dot com</a>
<a name="8"><span class="lineNum">       8 </span>                :            :                            antoine dot facchini at oslandia dot com</a>
<a name="9"><span class="lineNum">       9 </span>                :            :  ***************************************************************************</a>
<a name="10"><span class="lineNum">      10 </span>                :            :  *                                                                         *</a>
<a name="11"><span class="lineNum">      11 </span>                :            :  *   This program is free software; you can redistribute it and/or modify  *</a>
<a name="12"><span class="lineNum">      12 </span>                :            :  *   it under the terms of the GNU General Public License as published by  *</a>
<a name="13"><span class="lineNum">      13 </span>                :            :  *   the Free Software Foundation; either version 2 of the License, or     *</a>
<a name="14"><span class="lineNum">      14 </span>                :            :  *   (at your option) any later version.                                   *</a>
<a name="15"><span class="lineNum">      15 </span>                :            :  *                                                                         *</a>
<a name="16"><span class="lineNum">      16 </span>                :            :  ***************************************************************************/</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #include &quot;qgstest.h&quot;</a>
<a name="18"><span class="lineNum">      18 </span>                :            : #include &lt;QObject&gt;</a>
<a name="19"><span class="lineNum">      19 </span>                :            : #include &lt;QPainter&gt;</a>
<a name="20"><span class="lineNum">      20 </span>                :            : #include &lt;QString&gt;</a>
<a name="21"><span class="lineNum">      21 </span>                :            : </a>
<a name="22"><span class="lineNum">      22 </span>                :            : #include &quot;qgscircularstring.h&quot;</a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &quot;qgscurvepolygon.h&quot;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &quot;qgslinestring.h&quot;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : #include &quot;qgsmulticurve.h&quot;</a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &quot;qgspoint.h&quot;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &quot;qgspolygon.h&quot;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : </a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &quot;testgeometryutils.h&quot;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : </a>
<a name="31"><span class="lineNum">      31 </span>                :<span class="lineCov">          2 : class TestQgsCurvePolygon: public QObject</span></a>
<a name="32"><span class="lineNum">      32 </span>                :            : {</a>
<a name="33"><span class="lineNum">      33 </span>                :            :     Q_OBJECT</a>
<a name="34"><span class="lineNum">      34 </span>                :            : </a>
<a name="35"><span class="lineNum">      35 </span>                :            :   private slots:</a>
<a name="36"><span class="lineNum">      36 </span>                :            :     void testConstructor();</a>
<a name="37"><span class="lineNum">      37 </span>                :            :     void testCopyConstructor();</a>
<a name="38"><span class="lineNum">      38 </span>                :            :     void testClear();</a>
<a name="39"><span class="lineNum">      39 </span>                :            :     void testClone();</a>
<a name="40"><span class="lineNum">      40 </span>                :            :     void testEquality();</a>
<a name="41"><span class="lineNum">      41 </span>                :            :     void testSetExteriorRing();</a>
<a name="42"><span class="lineNum">      42 </span>                :            :     void testAddInteriorRing();</a>
<a name="43"><span class="lineNum">      43 </span>                :            :     void testRemoveInteriorRing();</a>
<a name="44"><span class="lineNum">      44 </span>                :            :     void testMixedRingTypes();</a>
<a name="45"><span class="lineNum">      45 </span>                :            :     void test3dRings();</a>
<a name="46"><span class="lineNum">      46 </span>                :            :     void testAreaPerimeterWithInteriorRing();</a>
<a name="47"><span class="lineNum">      47 </span>                :            :     void testInsertVertex();</a>
<a name="48"><span class="lineNum">      48 </span>                :            :     void testMoveVertex();</a>
<a name="49"><span class="lineNum">      49 </span>                :            :     void testDeleteVertex();</a>
<a name="50"><span class="lineNum">      50 </span>                :            :     void testNextVertex();</a>
<a name="51"><span class="lineNum">      51 </span>                :            :     void testVertexAngle();</a>
<a name="52"><span class="lineNum">      52 </span>                :            :     void testDeleteVertexRemoveRing();</a>
<a name="53"><span class="lineNum">      53 </span>                :            :     void testHasCurvedSegments();</a>
<a name="54"><span class="lineNum">      54 </span>                :            :     void testClosestSegment();</a>
<a name="55"><span class="lineNum">      55 </span>                :            :     void testBoundary();</a>
<a name="56"><span class="lineNum">      56 </span>                :            :     void testBoundingBox();</a>
<a name="57"><span class="lineNum">      57 </span>                :            :     void testDropZValue();</a>
<a name="58"><span class="lineNum">      58 </span>                :            :     void testDropMValue();</a>
<a name="59"><span class="lineNum">      59 </span>                :            :     void testToPolygon();</a>
<a name="60"><span class="lineNum">      60 </span>                :            :     void testSurfaceToPolygon();</a>
<a name="61"><span class="lineNum">      61 </span>                :            :     void testWKB();</a>
<a name="62"><span class="lineNum">      62 </span>                :            :     void testWKT();</a>
<a name="63"><span class="lineNum">      63 </span>                :            :     void testExport();</a>
<a name="64"><span class="lineNum">      64 </span>                :            :     void testCast();</a>
<a name="65"><span class="lineNum">      65 </span>                :            : };</a>
<a name="66"><span class="lineNum">      66 </span>                :            : </a>
<a name="67"><span class="lineNum">      67 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testConstructor()</span></a>
<a name="68"><span class="lineNum">      68 </span>                :            : {</a>
<a name="69"><span class="lineNum">      69 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="70"><span class="lineNum">      70 </span>                :            : </a>
<a name="71"><span class="lineNum">      71 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="72"><span class="lineNum">      72 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="73"><span class="lineNum">      73 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 0 );</span></a>
<a name="74"><span class="lineNum">      74 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.ringCount(), 0 );</span></a>
<a name="75"><span class="lineNum">      75 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.partCount(), 0 );</span></a>
<a name="76"><span class="lineNum">      76 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="77"><span class="lineNum">      77 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="78"><span class="lineNum">      78 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="79"><span class="lineNum">      79 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="80"><span class="lineNum">      80 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="81"><span class="lineNum">      81 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.dimension(), 2 );</span></a>
<a name="82"><span class="lineNum">      82 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.hasCurvedSegments() );</span></a>
<a name="83"><span class="lineNum">      83 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.area(), 0.0 );</span></a>
<a name="84"><span class="lineNum">      84 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.perimeter(), 0.0 );</span></a>
<a name="85"><span class="lineNum">      85 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.exteriorRing() );</span></a>
<a name="86"><span class="lineNum">      86 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 ) );</span></a>
<a name="87"><span class="lineNum">      87 </span>                :            : </a>
<a name="88"><span class="lineNum">      88 </span>                :            :   // set exterior ring</a>
<a name="89"><span class="lineNum">      89 </span>                :            : </a>
<a name="90"><span class="lineNum">      90 </span>                :            :   // try with no ring</a>
<a name="91"><span class="lineNum">      91 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = nullptr;</span></a>
<a name="92"><span class="lineNum">      92 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="93"><span class="lineNum">      93 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="94"><span class="lineNum">      94 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="95"><span class="lineNum">      95 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 0 );</span></a>
<a name="96"><span class="lineNum">      96 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.ringCount(), 0 );</span></a>
<a name="97"><span class="lineNum">      97 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.partCount(), 0 );</span></a>
<a name="98"><span class="lineNum">      98 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.exteriorRing() );</span></a>
<a name="99"><span class="lineNum">      99 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 ) );</span></a>
<a name="100"><span class="lineNum">     100 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="101"><span class="lineNum">     101 </span>                :            : </a>
<a name="102"><span class="lineNum">     102 </span>                :            :   // empty exterior ring</a>
<a name="103"><span class="lineNum">     103 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="104"><span class="lineNum">     104 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="105"><span class="lineNum">     105 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="106"><span class="lineNum">     106 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="107"><span class="lineNum">     107 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 0 );</span></a>
<a name="108"><span class="lineNum">     108 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.ringCount(), 1 );</span></a>
<a name="109"><span class="lineNum">     109 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.partCount(), 1 );</span></a>
<a name="110"><span class="lineNum">     110 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.exteriorRing() );</span></a>
<a name="111"><span class="lineNum">     111 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 ) );</span></a>
<a name="112"><span class="lineNum">     112 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="113"><span class="lineNum">     113 </span>                :            : </a>
<a name="114"><span class="lineNum">     114 </span>                :            :   // valid exterior ring</a>
<a name="115"><span class="lineNum">     115 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="116"><span class="lineNum">     116 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="117"><span class="lineNum">     117 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="118"><span class="lineNum">     118 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="119"><span class="lineNum">     119 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isEmpty() );</span></a>
<a name="120"><span class="lineNum">     120 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="121"><span class="lineNum">     121 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 5 );</span></a>
<a name="122"><span class="lineNum">     122 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.ringCount(), 1 );</span></a>
<a name="123"><span class="lineNum">     123 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.partCount(), 1 );</span></a>
<a name="124"><span class="lineNum">     124 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="125"><span class="lineNum">     125 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="126"><span class="lineNum">     126 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="127"><span class="lineNum">     127 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="128"><span class="lineNum">     128 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="129"><span class="lineNum">     129 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.dimension(), 2 );</span></a>
<a name="130"><span class="lineNum">     130 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.hasCurvedSegments() );</span></a>
<a name="131"><span class="lineNum">     131 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.area(), 157.08, 0.01 );</span></a>
<a name="132"><span class="lineNum">     132 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.perimeter(), 44.4288, 0.01 );</span></a>
<a name="133"><span class="lineNum">     133 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.exteriorRing() );</span></a>
<a name="134"><span class="lineNum">     134 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 ) );</span></a>
<a name="135"><span class="lineNum">     135 </span>                :            : </a>
<a name="136"><span class="lineNum">     136 </span>                :            :   // retrieve exterior ring and check</a>
<a name="137"><span class="lineNum">     137 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( poly.exteriorRing() ) ), *ext );</span></a>
<a name="138"><span class="lineNum">     138 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="139"><span class="lineNum">     139 </span>                :            : </a>
<a name="140"><span class="lineNum">     140 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testCopyConstructor()</span></a>
<a name="141"><span class="lineNum">     141 </span>                :            : {</a>
<a name="142"><span class="lineNum">     142 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly1;</span></a>
<a name="143"><span class="lineNum">     143 </span>                :            : </a>
<a name="144"><span class="lineNum">     144 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly2( poly1 );</span></a>
<a name="145"><span class="lineNum">     145 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="146"><span class="lineNum">     146 </span>                :            : </a>
<a name="147"><span class="lineNum">     147 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="148"><span class="lineNum">     148 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="149"><span class="lineNum">     149 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="150"><span class="lineNum">     150 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="151"><span class="lineNum">     151 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="152"><span class="lineNum">     152 </span>                :            : </a>
<a name="153"><span class="lineNum">     153 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="154"><span class="lineNum">     154 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="155"><span class="lineNum">     155 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="156"><span class="lineNum">     156 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="157"><span class="lineNum">     157 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="158"><span class="lineNum">     158 </span>                :            : </a>
<a name="159"><span class="lineNum">     159 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly3( poly1 );</span></a>
<a name="160"><span class="lineNum">     160 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly3 );</span></a>
<a name="161"><span class="lineNum">     161 </span>                :            : </a>
<a name="162"><span class="lineNum">     162 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly4;</span></a>
<a name="163"><span class="lineNum">     163 </span>                :<span class="lineCov">          1 :   poly4 = poly2;</span></a>
<a name="164"><span class="lineNum">     164 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2, poly4 );</span></a>
<a name="165"><span class="lineNum">     165 </span>                :<span class="lineCov">          1 :   poly4 = poly1;</span></a>
<a name="166"><span class="lineNum">     166 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly4 );</span></a>
<a name="167"><span class="lineNum">     167 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="168"><span class="lineNum">     168 </span>                :            : </a>
<a name="169"><span class="lineNum">     169 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testClear()</span></a>
<a name="170"><span class="lineNum">     170 </span>                :            : {</a>
<a name="171"><span class="lineNum">     171 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="172"><span class="lineNum">     172 </span>                :            : </a>
<a name="173"><span class="lineNum">     173 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="174"><span class="lineNum">     174 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="175"><span class="lineNum">     175 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="176"><span class="lineNum">     176 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="177"><span class="lineNum">     177 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="178"><span class="lineNum">     178 </span>                :            : </a>
<a name="179"><span class="lineNum">     179 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="180"><span class="lineNum">     180 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="181"><span class="lineNum">     181 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="182"><span class="lineNum">     182 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="183"><span class="lineNum">     183 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="184"><span class="lineNum">     184 </span>                :            : </a>
<a name="185"><span class="lineNum">     185 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="186"><span class="lineNum">     186 </span>                :            : </a>
<a name="187"><span class="lineNum">     187 </span>                :<span class="lineCov">          1 :   poly.clear();</span></a>
<a name="188"><span class="lineNum">     188 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="189"><span class="lineNum">     189 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="190"><span class="lineNum">     190 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 0 );</span></a>
<a name="191"><span class="lineNum">     191 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.ringCount(), 0 );</span></a>
<a name="192"><span class="lineNum">     192 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.partCount(), 0 );</span></a>
<a name="193"><span class="lineNum">     193 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="194"><span class="lineNum">     194 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="195"><span class="lineNum">     195 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="196"><span class="lineNum">     196 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="197"><span class="lineNum">     197 </span>                :            : </a>
<a name="198"><span class="lineNum">     198 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testClone()</span></a>
<a name="199"><span class="lineNum">     199 </span>                :            : {</a>
<a name="200"><span class="lineNum">     200 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="201"><span class="lineNum">     201 </span>                :            : </a>
<a name="202"><span class="lineNum">     202 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt;cloned( poly.clone() );</span></a>
<a name="203"><span class="lineNum">     203 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly, *cloned );</span></a>
<a name="204"><span class="lineNum">     204 </span>                :            : </a>
<a name="205"><span class="lineNum">     205 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="206"><span class="lineNum">     206 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="207"><span class="lineNum">     207 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="208"><span class="lineNum">     208 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="209"><span class="lineNum">     209 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="210"><span class="lineNum">     210 </span>                :            : </a>
<a name="211"><span class="lineNum">     211 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="212"><span class="lineNum">     212 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="213"><span class="lineNum">     213 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="214"><span class="lineNum">     214 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="215"><span class="lineNum">     215 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="216"><span class="lineNum">     216 </span>                :            : </a>
<a name="217"><span class="lineNum">     217 </span>                :<span class="lineCov">          1 :   cloned.reset( poly.clone() );</span></a>
<a name="218"><span class="lineNum">     218 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly, *cloned );</span></a>
<a name="219"><span class="lineNum">     219 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="220"><span class="lineNum">     220 </span>                :            : </a>
<a name="221"><span class="lineNum">     221 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testEquality()</span></a>
<a name="222"><span class="lineNum">     222 </span>                :            : {</a>
<a name="223"><span class="lineNum">     223 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly1, poly2;</span></a>
<a name="224"><span class="lineNum">     224 </span>                :            :   QgsCircularString *ext, *ring;</a>
<a name="225"><span class="lineNum">     225 </span>                :            : </a>
<a name="226"><span class="lineNum">     226 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 == poly2 );</span></a>
<a name="227"><span class="lineNum">     227 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 != poly2 ) );</span></a>
<a name="228"><span class="lineNum">     228 </span>                :            : </a>
<a name="229"><span class="lineNum">     229 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="230"><span class="lineNum">     230 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="231"><span class="lineNum">     231 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="232"><span class="lineNum">     232 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="233"><span class="lineNum">     233 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 == poly2 ) );</span></a>
<a name="234"><span class="lineNum">     234 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 != poly2 );</span></a>
<a name="235"><span class="lineNum">     235 </span>                :            : </a>
<a name="236"><span class="lineNum">     236 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="237"><span class="lineNum">     237 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="238"><span class="lineNum">     238 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="239"><span class="lineNum">     239 </span>                :<span class="lineCov">          1 :   poly2.setExteriorRing( ext );</span></a>
<a name="240"><span class="lineNum">     240 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 == poly2 );</span></a>
<a name="241"><span class="lineNum">     241 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 != poly2 ) );</span></a>
<a name="242"><span class="lineNum">     242 </span>                :            : </a>
<a name="243"><span class="lineNum">     243 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="244"><span class="lineNum">     244 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 9 )</span></a>
<a name="245"><span class="lineNum">     245 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 9, 9 ) &lt;&lt; QgsPoint( 9, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="246"><span class="lineNum">     246 </span>                :<span class="lineCov">          1 :   poly2.setExteriorRing( ext );</span></a>
<a name="247"><span class="lineNum">     247 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 == poly2 ) );</span></a>
<a name="248"><span class="lineNum">     248 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 != poly2 );</span></a>
<a name="249"><span class="lineNum">     249 </span>                :            : </a>
<a name="250"><span class="lineNum">     250 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="251"><span class="lineNum">     251 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="252"><span class="lineNum">     252 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="253"><span class="lineNum">     253 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="254"><span class="lineNum">     254 </span>                :<span class="lineCov">          1 :   poly2.setExteriorRing( ext );</span></a>
<a name="255"><span class="lineNum">     255 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 == poly2 ) );</span></a>
<a name="256"><span class="lineNum">     256 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 != poly2 );</span></a>
<a name="257"><span class="lineNum">     257 </span>                :            : </a>
<a name="258"><span class="lineNum">     258 </span>                :<span class="lineCov">          1 :   poly2.setExteriorRing( poly1.exteriorRing()-&gt;clone() );</span></a>
<a name="259"><span class="lineNum">     259 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 == poly2 );</span></a>
<a name="260"><span class="lineNum">     260 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 != poly2 ) );</span></a>
<a name="261"><span class="lineNum">     261 </span>                :            : </a>
<a name="262"><span class="lineNum">     262 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="263"><span class="lineNum">     263 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 )</span></a>
<a name="264"><span class="lineNum">     264 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 9 ) &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="265"><span class="lineNum">     265 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="266"><span class="lineNum">     266 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 == poly2 ) );</span></a>
<a name="267"><span class="lineNum">     267 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 != poly2 );</span></a>
<a name="268"><span class="lineNum">     268 </span>                :            : </a>
<a name="269"><span class="lineNum">     269 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="270"><span class="lineNum">     270 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 2, 9 )</span></a>
<a name="271"><span class="lineNum">     271 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 9 ) &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 2, 1 ) );</span></a>
<a name="272"><span class="lineNum">     272 </span>                :<span class="lineCov">          1 :   poly2.addInteriorRing( ring );</span></a>
<a name="273"><span class="lineNum">     273 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 == poly2 ) );</span></a>
<a name="274"><span class="lineNum">     274 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 != poly2 );</span></a>
<a name="275"><span class="lineNum">     275 </span>                :            : </a>
<a name="276"><span class="lineNum">     276 </span>                :<span class="lineCov">          1 :   poly2.removeInteriorRing( 0 );</span></a>
<a name="277"><span class="lineNum">     277 </span>                :<span class="lineCov">          1 :   poly2.addInteriorRing( poly1.interiorRing( 0 )-&gt;clone() );</span></a>
<a name="278"><span class="lineNum">     278 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1 == poly2 );</span></a>
<a name="279"><span class="lineNum">     279 </span>                :<span class="lineCov">          1 :   QVERIFY( !( poly1 != poly2 ) );</span></a>
<a name="280"><span class="lineNum">     280 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="281"><span class="lineNum">     281 </span>                :            : </a>
<a name="282"><span class="lineNum">     282 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testSetExteriorRing()</span></a>
<a name="283"><span class="lineNum">     283 </span>                :            : {</a>
<a name="284"><span class="lineNum">     284 </span>                :            :   // initial setting of exterior ring should set z/m type</a>
<a name="285"><span class="lineNum">     285 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="286"><span class="lineNum">     286 </span>                :            : </a>
<a name="287"><span class="lineNum">     287 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="288"><span class="lineNum">     288 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="289"><span class="lineNum">     289 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 10 )</span></a>
<a name="290"><span class="lineNum">     290 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 ) );</span></a>
<a name="291"><span class="lineNum">     291 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="292"><span class="lineNum">     292 </span>                :            : </a>
<a name="293"><span class="lineNum">     293 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="294"><span class="lineNum">     294 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 )</span></a>
<a name="295"><span class="lineNum">     295 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 9 )</span></a>
<a name="296"><span class="lineNum">     296 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 ) );</span></a>
<a name="297"><span class="lineNum">     297 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="298"><span class="lineNum">     298 </span>                :            : </a>
<a name="299"><span class="lineNum">     299 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="300"><span class="lineNum">     300 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="301"><span class="lineNum">     301 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="302"><span class="lineNum">     302 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="303"><span class="lineNum">     303 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="304"><span class="lineNum">     304 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( poly.exteriorRing() ) ), *ext );</span></a>
<a name="305"><span class="lineNum">     305 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="306"><span class="lineNum">     306 </span>                :            : </a>
<a name="307"><span class="lineNum">     307 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="308"><span class="lineNum">     308 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="309"><span class="lineNum">     309 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="310"><span class="lineNum">     310 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="311"><span class="lineNum">     311 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="312"><span class="lineNum">     312 </span>                :            : </a>
<a name="313"><span class="lineNum">     313 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.is3D() );</span></a>
<a name="314"><span class="lineNum">     314 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="315"><span class="lineNum">     315 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="316"><span class="lineNum">     316 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygonZ&quot; ) );</span></a>
<a name="317"><span class="lineNum">     317 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="318"><span class="lineNum">     318 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( poly.exteriorRing() ) ), *ext );</span></a>
<a name="319"><span class="lineNum">     319 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="320"><span class="lineNum">     320 </span>                :            : </a>
<a name="321"><span class="lineNum">     321 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="322"><span class="lineNum">     322 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="323"><span class="lineNum">     323 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="324"><span class="lineNum">     324 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="325"><span class="lineNum">     325 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="326"><span class="lineNum">     326 </span>                :            : </a>
<a name="327"><span class="lineNum">     327 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="328"><span class="lineNum">     328 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isMeasure() );</span></a>
<a name="329"><span class="lineNum">     329 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="330"><span class="lineNum">     330 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygonM&quot; ) );</span></a>
<a name="331"><span class="lineNum">     331 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( poly.exteriorRing() ) ), *ext );</span></a>
<a name="332"><span class="lineNum">     332 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="333"><span class="lineNum">     333 </span>                :            : </a>
<a name="334"><span class="lineNum">     334 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="335"><span class="lineNum">     335 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 )</span></a>
<a name="336"><span class="lineNum">     336 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 3, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 5, 3 )</span></a>
<a name="337"><span class="lineNum">     337 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 ) );</span></a>
<a name="338"><span class="lineNum">     338 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="339"><span class="lineNum">     339 </span>                :            : </a>
<a name="340"><span class="lineNum">     340 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.is3D() );</span></a>
<a name="341"><span class="lineNum">     341 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isMeasure() );</span></a>
<a name="342"><span class="lineNum">     342 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="343"><span class="lineNum">     343 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wktTypeStr(), QString( &quot;CurvePolygonZM&quot; ) );</span></a>
<a name="344"><span class="lineNum">     344 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( poly.exteriorRing() ) ), *ext );</span></a>
<a name="345"><span class="lineNum">     345 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="346"><span class="lineNum">     346 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="347"><span class="lineNum">     347 </span>                :            : </a>
<a name="348"><span class="lineNum">     348 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testAddInteriorRing()</span></a>
<a name="349"><span class="lineNum">     349 </span>                :            : {</a>
<a name="350"><span class="lineNum">     350 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="351"><span class="lineNum">     351 </span>                :            : </a>
<a name="352"><span class="lineNum">     352 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="353"><span class="lineNum">     353 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="354"><span class="lineNum">     354 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="355"><span class="lineNum">     355 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="356"><span class="lineNum">     356 </span>                :            : </a>
<a name="357"><span class="lineNum">     357 </span>                :            :   // empty ring</a>
<a name="358"><span class="lineNum">     358 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="359"><span class="lineNum">     359 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( -1 ) );</span></a>
<a name="360"><span class="lineNum">     360 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 ) );</span></a>
<a name="361"><span class="lineNum">     361 </span>                :            : </a>
<a name="362"><span class="lineNum">     362 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( nullptr );</span></a>
<a name="363"><span class="lineNum">     363 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="364"><span class="lineNum">     364 </span>                :            : </a>
<a name="365"><span class="lineNum">     365 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="366"><span class="lineNum">     366 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="367"><span class="lineNum">     367 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="368"><span class="lineNum">     368 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="369"><span class="lineNum">     369 </span>                :            : </a>
<a name="370"><span class="lineNum">     370 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="371"><span class="lineNum">     371 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 ), ring );</span></a>
<a name="372"><span class="lineNum">     372 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 ) );</span></a>
<a name="373"><span class="lineNum">     373 </span>                :            : </a>
<a name="374"><span class="lineNum">     374 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence seq = poly.coordinateSequence();</span></a>
<a name="375"><span class="lineNum">     375 </span>                :<span class="lineCov">          1 :   QCOMPARE( seq, QgsCoordinateSequence() &lt;&lt; ( QgsRingSequence() &lt;&lt; (</span></a>
<a name="376"><span class="lineNum">     376 </span>                :            :               QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</a>
<a name="377"><span class="lineNum">     377 </span>                :            :               &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 )</a>
<a name="378"><span class="lineNum">     378 </span>                :            :             ) &lt;&lt; (</a>
<a name="379"><span class="lineNum">     379 </span>                :            :               QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</a>
<a name="380"><span class="lineNum">     380 </span>                :            :               &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 )</a>
<a name="381"><span class="lineNum">     381 </span>                :            :             ) )</a>
<a name="382"><span class="lineNum">     382 </span>                :            :           );</a>
<a name="383"><span class="lineNum">     383 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 10 );</span></a>
<a name="384"><span class="lineNum">     384 </span>                :            : </a>
<a name="385"><span class="lineNum">     385 </span>                :            :   // try adding an interior ring with z to a 2d polygon, z should be dropped</a>
<a name="386"><span class="lineNum">     386 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="387"><span class="lineNum">     387 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="388"><span class="lineNum">     388 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="389"><span class="lineNum">     389 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="390"><span class="lineNum">     390 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="391"><span class="lineNum">     391 </span>                :            : </a>
<a name="392"><span class="lineNum">     392 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 2 );</span></a>
<a name="393"><span class="lineNum">     393 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="394"><span class="lineNum">     394 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="395"><span class="lineNum">     395 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="396"><span class="lineNum">     396 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 1 ) );</span></a>
<a name="397"><span class="lineNum">     397 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="398"><span class="lineNum">     398 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="399"><span class="lineNum">     399 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="400"><span class="lineNum">     400 </span>                :            : </a>
<a name="401"><span class="lineNum">     401 </span>                :            :   // try adding an interior ring with m to a 2d polygon, m should be dropped</a>
<a name="402"><span class="lineNum">     402 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="403"><span class="lineNum">     403 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 )</span></a>
<a name="404"><span class="lineNum">     404 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.2, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.2, 0, 3 )</span></a>
<a name="405"><span class="lineNum">     405 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 ) );</span></a>
<a name="406"><span class="lineNum">     406 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="407"><span class="lineNum">     407 </span>                :            : </a>
<a name="408"><span class="lineNum">     408 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 3 );</span></a>
<a name="409"><span class="lineNum">     409 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="410"><span class="lineNum">     410 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="411"><span class="lineNum">     411 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="412"><span class="lineNum">     412 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 2 ) );</span></a>
<a name="413"><span class="lineNum">     413 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="414"><span class="lineNum">     414 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="415"><span class="lineNum">     415 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="416"><span class="lineNum">     416 </span>                :            : </a>
<a name="417"><span class="lineNum">     417 </span>                :            : </a>
<a name="418"><span class="lineNum">     418 </span>                :            :   // addInteriorRing without z/m to PolygonZM</a>
<a name="419"><span class="lineNum">     419 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly2;</span></a>
<a name="420"><span class="lineNum">     420 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="421"><span class="lineNum">     421 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 )</span></a>
<a name="422"><span class="lineNum">     422 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3 )</span></a>
<a name="423"><span class="lineNum">     423 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 ) );</span></a>
<a name="424"><span class="lineNum">     424 </span>                :<span class="lineCov">          1 :   poly2.setExteriorRing( ext );</span></a>
<a name="425"><span class="lineNum">     425 </span>                :            : </a>
<a name="426"><span class="lineNum">     426 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.is3D() );</span></a>
<a name="427"><span class="lineNum">     427 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.isMeasure() );</span></a>
<a name="428"><span class="lineNum">     428 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="429"><span class="lineNum">     429 </span>                :            : </a>
<a name="430"><span class="lineNum">     430 </span>                :            :   // ring has no z</a>
<a name="431"><span class="lineNum">     431 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="432"><span class="lineNum">     432 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 2 )</span></a>
<a name="433"><span class="lineNum">     433 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 9 )</span></a>
<a name="434"><span class="lineNum">     434 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1 ) );</span></a>
<a name="435"><span class="lineNum">     435 </span>                :<span class="lineCov">          1 :   poly2.addInteriorRing( ring );</span></a>
<a name="436"><span class="lineNum">     436 </span>                :            : </a>
<a name="437"><span class="lineNum">     437 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 0 ) );</span></a>
<a name="438"><span class="lineNum">     438 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="439"><span class="lineNum">     439 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="440"><span class="lineNum">     440 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="441"><span class="lineNum">     441 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 0, 2 ) );</span></a>
<a name="442"><span class="lineNum">     442 </span>                :            : </a>
<a name="443"><span class="lineNum">     443 </span>                :            :   // ring has no m</a>
<a name="444"><span class="lineNum">     444 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="445"><span class="lineNum">     445 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="446"><span class="lineNum">     446 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="448"><span class="lineNum">     448 </span>                :<span class="lineCov">          1 :   poly2.addInteriorRing( ring );</span></a>
<a name="449"><span class="lineNum">     449 </span>                :            : </a>
<a name="450"><span class="lineNum">     450 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 1 ) );</span></a>
<a name="451"><span class="lineNum">     451 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="452"><span class="lineNum">     452 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="453"><span class="lineNum">     453 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="454"><span class="lineNum">     454 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.1, 1, 0 ) );</span></a>
<a name="455"><span class="lineNum">     455 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="456"><span class="lineNum">     456 </span>                :            : </a>
<a name="457"><span class="lineNum">     457 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testRemoveInteriorRing()</span></a>
<a name="458"><span class="lineNum">     458 </span>                :            : {</a>
<a name="459"><span class="lineNum">     459 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="460"><span class="lineNum">     460 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsCurve * &gt; rings;</span></a>
<a name="461"><span class="lineNum">     461 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="462"><span class="lineNum">     462 </span>                :            : </a>
<a name="463"><span class="lineNum">     463 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="464"><span class="lineNum">     464 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="465"><span class="lineNum">     465 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="466"><span class="lineNum">     466 </span>                :            : </a>
<a name="467"><span class="lineNum">     467 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.removeInteriorRing( -1 ) );</span></a>
<a name="468"><span class="lineNum">     468 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.removeInteriorRing( 0 ) );</span></a>
<a name="469"><span class="lineNum">     469 </span>                :            : </a>
<a name="470"><span class="lineNum">     470 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="471"><span class="lineNum">     471 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="472"><span class="lineNum">     472 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.1, 0.2 ) &lt;&lt; QgsPoint( 0.2, 0.2 )</span></a>
<a name="473"><span class="lineNum">     473 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="474"><span class="lineNum">     474 </span>                :            : </a>
<a name="475"><span class="lineNum">     475 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="476"><span class="lineNum">     476 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="477"><span class="lineNum">     477 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.3, 0.3 ) &lt;&lt; QgsPoint( 0.3, 0.4 ) &lt;&lt; QgsPoint( 0.4, 0.4 )</span></a>
<a name="478"><span class="lineNum">     478 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.4, 0.3 ) &lt;&lt; QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="479"><span class="lineNum">     479 </span>                :            : </a>
<a name="480"><span class="lineNum">     480 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="481"><span class="lineNum">     481 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[2] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="482"><span class="lineNum">     482 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="483"><span class="lineNum">     483 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="484"><span class="lineNum">     484 </span>                :            : </a>
<a name="485"><span class="lineNum">     485 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( rings );</span></a>
<a name="486"><span class="lineNum">     486 </span>                :            : </a>
<a name="487"><span class="lineNum">     487 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 3 );</span></a>
<a name="488"><span class="lineNum">     488 </span>                :            : </a>
<a name="489"><span class="lineNum">     489 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.removeInteriorRing( 0 ) );</span></a>
<a name="490"><span class="lineNum">     490 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 2 );</span></a>
<a name="491"><span class="lineNum">     491 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="492"><span class="lineNum">     492 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="493"><span class="lineNum">     493 </span>                :            : </a>
<a name="494"><span class="lineNum">     494 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.removeInteriorRing( 1 ) );</span></a>
<a name="495"><span class="lineNum">     495 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="496"><span class="lineNum">     496 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="497"><span class="lineNum">     497 </span>                :            : </a>
<a name="498"><span class="lineNum">     498 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.removeInteriorRing( 0 ) );</span></a>
<a name="499"><span class="lineNum">     499 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="500"><span class="lineNum">     500 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.removeInteriorRing( 0 ) );</span></a>
<a name="501"><span class="lineNum">     501 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="502"><span class="lineNum">     502 </span>                :            : </a>
<a name="503"><span class="lineNum">     503 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testMixedRingTypes()</span></a>
<a name="504"><span class="lineNum">     504 </span>                :            : {</a>
<a name="505"><span class="lineNum">     505 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="506"><span class="lineNum">     506 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsCurve * &gt; rings;</span></a>
<a name="507"><span class="lineNum">     507 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="508"><span class="lineNum">     508 </span>                :            : </a>
<a name="509"><span class="lineNum">     509 </span>                :            :   // set exterior rings</a>
<a name="510"><span class="lineNum">     510 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence()</span></a>
<a name="511"><span class="lineNum">     511 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="512"><span class="lineNum">     512 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="513"><span class="lineNum">     513 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="514"><span class="lineNum">     514 </span>                :            : </a>
<a name="515"><span class="lineNum">     515 </span>                :            :   // add a list of rings with mixed types</a>
<a name="516"><span class="lineNum">     516 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="517"><span class="lineNum">     517 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="518"><span class="lineNum">     518 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 )</span></a>
<a name="519"><span class="lineNum">     519 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 )</span></a>
<a name="520"><span class="lineNum">     520 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="521"><span class="lineNum">     521 </span>                :            : </a>
<a name="522"><span class="lineNum">     522 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="523"><span class="lineNum">     523 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="524"><span class="lineNum">     524 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.4, 0, 2 )</span></a>
<a name="525"><span class="lineNum">     525 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.4, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.3, 0, 4 )</span></a>
<a name="526"><span class="lineNum">     526 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 ) );</span></a>
<a name="527"><span class="lineNum">     527 </span>                :            : </a>
<a name="528"><span class="lineNum">     528 </span>                :            :   // throw an empty ring in too</a>
<a name="529"><span class="lineNum">     529 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; 0;</span></a>
<a name="530"><span class="lineNum">     530 </span>                :            : </a>
<a name="531"><span class="lineNum">     531 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="532"><span class="lineNum">     532 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[3] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 )</span></a>
<a name="533"><span class="lineNum">     533 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="534"><span class="lineNum">     534 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="535"><span class="lineNum">     535 </span>                :            : </a>
<a name="536"><span class="lineNum">     536 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( rings );</span></a>
<a name="537"><span class="lineNum">     537 </span>                :            : </a>
<a name="538"><span class="lineNum">     538 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 3 );</span></a>
<a name="539"><span class="lineNum">     539 </span>                :            : </a>
<a name="540"><span class="lineNum">     540 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 0 ) );</span></a>
<a name="541"><span class="lineNum">     541 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="542"><span class="lineNum">     542 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="543"><span class="lineNum">     543 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="544"><span class="lineNum">     544 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.1, 0.1 ) );</span></a>
<a name="545"><span class="lineNum">     545 </span>                :            : </a>
<a name="546"><span class="lineNum">     546 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 1 ) );</span></a>
<a name="547"><span class="lineNum">     547 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="548"><span class="lineNum">     548 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="549"><span class="lineNum">     549 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="550"><span class="lineNum">     550 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.3, 0.3 ) );</span></a>
<a name="551"><span class="lineNum">     551 </span>                :            : </a>
<a name="552"><span class="lineNum">     552 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 2 ) );</span></a>
<a name="553"><span class="lineNum">     553 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="554"><span class="lineNum">     554 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="555"><span class="lineNum">     555 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="556"><span class="lineNum">     556 </span>                :            : </a>
<a name="557"><span class="lineNum">     557 </span>                :            :   // set rings with existing</a>
<a name="558"><span class="lineNum">     558 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="559"><span class="lineNum">     559 </span>                :            : </a>
<a name="560"><span class="lineNum">     560 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="561"><span class="lineNum">     561 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="562"><span class="lineNum">     562 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="563"><span class="lineNum">     563 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="564"><span class="lineNum">     564 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( rings );</span></a>
<a name="565"><span class="lineNum">     565 </span>                :            : </a>
<a name="566"><span class="lineNum">     566 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="567"><span class="lineNum">     567 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 0 ) );</span></a>
<a name="568"><span class="lineNum">     568 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="569"><span class="lineNum">     569 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="570"><span class="lineNum">     570 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="571"><span class="lineNum">     571 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.8, 0.8 ) );</span></a>
<a name="572"><span class="lineNum">     572 </span>                :            : </a>
<a name="573"><span class="lineNum">     573 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="574"><span class="lineNum">     574 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( rings );</span></a>
<a name="575"><span class="lineNum">     575 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="576"><span class="lineNum">     576 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="577"><span class="lineNum">     577 </span>                :            : </a>
<a name="578"><span class="lineNum">     578 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::test3dRings()</span></a>
<a name="579"><span class="lineNum">     579 </span>                :            : {</a>
<a name="580"><span class="lineNum">     580 </span>                :            :   // change dimensionality of interior rings using setExteriorRing</a>
<a name="581"><span class="lineNum">     581 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="582"><span class="lineNum">     582 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsCurve * &gt; rings;</span></a>
<a name="583"><span class="lineNum">     583 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="584"><span class="lineNum">     584 </span>                :            : </a>
<a name="585"><span class="lineNum">     585 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="586"><span class="lineNum">     586 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 1 )</span></a>
<a name="587"><span class="lineNum">     587 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="588"><span class="lineNum">     588 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="589"><span class="lineNum">     589 </span>                :            : </a>
<a name="590"><span class="lineNum">     590 </span>                :            : </a>
<a name="591"><span class="lineNum">     591 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="592"><span class="lineNum">     592 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="593"><span class="lineNum">     593 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 )</span></a>
<a name="594"><span class="lineNum">     594 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 )</span></a>
<a name="595"><span class="lineNum">     595 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="596"><span class="lineNum">     596 </span>                :            : </a>
<a name="597"><span class="lineNum">     597 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="598"><span class="lineNum">     598 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence()</span></a>
<a name="599"><span class="lineNum">     599 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.4, 2 )</span></a>
<a name="600"><span class="lineNum">     600 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.4, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.3, 4 )</span></a>
<a name="601"><span class="lineNum">     601 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3,  1 ) );</span></a>
<a name="602"><span class="lineNum">     602 </span>                :            : </a>
<a name="603"><span class="lineNum">     603 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( rings );</span></a>
<a name="604"><span class="lineNum">     604 </span>                :            : </a>
<a name="605"><span class="lineNum">     605 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.is3D() );</span></a>
<a name="606"><span class="lineNum">     606 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.isMeasure() );</span></a>
<a name="607"><span class="lineNum">     607 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="608"><span class="lineNum">     608 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="609"><span class="lineNum">     609 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="610"><span class="lineNum">     610 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="611"><span class="lineNum">     611 </span>                :            : </a>
<a name="612"><span class="lineNum">     612 </span>                :            :   // reset exterior ring to 2d</a>
<a name="613"><span class="lineNum">     613 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="614"><span class="lineNum">     614 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="615"><span class="lineNum">     615 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="616"><span class="lineNum">     616 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="617"><span class="lineNum">     617 </span>                :            : </a>
<a name="618"><span class="lineNum">     618 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.is3D() );</span></a>
<a name="619"><span class="lineNum">     619 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 0 )-&gt;is3D() ); // rings should also be made 2D</span></a>
<a name="620"><span class="lineNum">     620 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="621"><span class="lineNum">     621 </span>                :            : </a>
<a name="622"><span class="lineNum">     622 </span>                :            :   // reset exterior ring to LineStringM</a>
<a name="623"><span class="lineNum">     623 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="624"><span class="lineNum">     624 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 )</span></a>
<a name="625"><span class="lineNum">     625 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10 )</span></a>
<a name="626"><span class="lineNum">     626 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 ) );</span></a>
<a name="627"><span class="lineNum">     627 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="628"><span class="lineNum">     628 </span>                :            : </a>
<a name="629"><span class="lineNum">     629 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isMeasure() );</span></a>
<a name="630"><span class="lineNum">     630 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 0 )-&gt;isMeasure() ); // rings should also gain measure</span></a>
<a name="631"><span class="lineNum">     631 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="632"><span class="lineNum">     632 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="633"><span class="lineNum">     633 </span>                :            : </a>
<a name="634"><span class="lineNum">     634 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testAreaPerimeterWithInteriorRing()</span></a>
<a name="635"><span class="lineNum">     635 </span>                :            : {</a>
<a name="636"><span class="lineNum">     636 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="637"><span class="lineNum">     637 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="638"><span class="lineNum">     638 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="639"><span class="lineNum">     639 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="640"><span class="lineNum">     640 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="641"><span class="lineNum">     641 </span>                :            : </a>
<a name="642"><span class="lineNum">     642 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="643"><span class="lineNum">     643 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 6 ) &lt;&lt; QgsPoint( 6, 6 )</span></a>
<a name="644"><span class="lineNum">     644 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 6, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="645"><span class="lineNum">     645 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="646"><span class="lineNum">     646 </span>                :            : </a>
<a name="647"><span class="lineNum">     647 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.area(), 117.8104, 0.01 );</span></a>
<a name="648"><span class="lineNum">     648 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.perimeter(), 66.6432, 0.01 );</span></a>
<a name="649"><span class="lineNum">     649 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="650"><span class="lineNum">     650 </span>                :            : </a>
<a name="651"><span class="lineNum">     651 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testInsertVertex()</span></a>
<a name="652"><span class="lineNum">     652 </span>                :            : {</a>
<a name="653"><span class="lineNum">     653 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="654"><span class="lineNum">     654 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="655"><span class="lineNum">     655 </span>                :            : </a>
<a name="656"><span class="lineNum">     656 </span>                :            :   // insert vertex in empty polygon</a>
<a name="657"><span class="lineNum">     657 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="658"><span class="lineNum">     658 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="659"><span class="lineNum">     659 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="660"><span class="lineNum">     660 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="661"><span class="lineNum">     661 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="662"><span class="lineNum">     662 </span>                :            : </a>
<a name="663"><span class="lineNum">     663 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="664"><span class="lineNum">     664 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="665"><span class="lineNum">     665 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="666"><span class="lineNum">     666 </span>                :            : </a>
<a name="667"><span class="lineNum">     667 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="668"><span class="lineNum">     668 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 8 );</span></a>
<a name="669"><span class="lineNum">     669 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="670"><span class="lineNum">     670 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="672"><span class="lineNum">     672 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="673"><span class="lineNum">     673 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 0, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="674"><span class="lineNum">     674 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="675"><span class="lineNum">     675 </span>                :            : </a>
<a name="676"><span class="lineNum">     676 </span>                :            :   // first vertex</a>
<a name="677"><span class="lineNum">     677 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="678"><span class="lineNum">     678 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 9 );</span></a>
<a name="679"><span class="lineNum">     679 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="680"><span class="lineNum">     680 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="681"><span class="lineNum">     681 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="682"><span class="lineNum">     682 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="683"><span class="lineNum">     683 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="684"><span class="lineNum">     684 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="685"><span class="lineNum">     685 </span>                :            : </a>
<a name="686"><span class="lineNum">     686 </span>                :            :   // last vertex</a>
<a name="687"><span class="lineNum">     687 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="688"><span class="lineNum">     688 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 10 );</span></a>
<a name="689"><span class="lineNum">     689 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="690"><span class="lineNum">     690 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="691"><span class="lineNum">     691 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="692"><span class="lineNum">     692 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="693"><span class="lineNum">     693 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="694"><span class="lineNum">     694 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="695"><span class="lineNum">     695 </span>                :            : </a>
<a name="696"><span class="lineNum">     696 </span>                :            :   // with interior ring</a>
<a name="697"><span class="lineNum">     697 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="698"><span class="lineNum">     698 </span>                :            : </a>
<a name="699"><span class="lineNum">     699 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 17 );</span></a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="701"><span class="lineNum">     701 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 18 );</span></a>
<a name="702"><span class="lineNum">     702 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="703"><span class="lineNum">     703 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="704"><span class="lineNum">     704 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="705"><span class="lineNum">     705 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="706"><span class="lineNum">     706 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 1, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="707"><span class="lineNum">     707 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.insertVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="708"><span class="lineNum">     708 </span>                :            : </a>
<a name="709"><span class="lineNum">     709 </span>                :            :   // first vertex in interior ring</a>
<a name="710"><span class="lineNum">     710 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="711"><span class="lineNum">     711 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 19 );</span></a>
<a name="712"><span class="lineNum">     712 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="713"><span class="lineNum">     713 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="714"><span class="lineNum">     714 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="715"><span class="lineNum">     715 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="716"><span class="lineNum">     716 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="717"><span class="lineNum">     717 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="718"><span class="lineNum">     718 </span>                :            : </a>
<a name="719"><span class="lineNum">     719 </span>                :            :   // last vertex in interior ring</a>
<a name="720"><span class="lineNum">     720 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.insertVertex( QgsVertexId( 0, 1, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="721"><span class="lineNum">     721 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.nCoordinates(), 20 );</span></a>
<a name="722"><span class="lineNum">     722 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="723"><span class="lineNum">     723 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="724"><span class="lineNum">     724 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="725"><span class="lineNum">     725 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="726"><span class="lineNum">     726 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="727"><span class="lineNum">     727 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="728"><span class="lineNum">     728 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="729"><span class="lineNum">     729 </span>                :            : </a>
<a name="730"><span class="lineNum">     730 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testMoveVertex()</span></a>
<a name="731"><span class="lineNum">     731 </span>                :            : {</a>
<a name="732"><span class="lineNum">     732 </span>                :            :   // empty polygon</a>
<a name="733"><span class="lineNum">     733 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="734"><span class="lineNum">     734 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="735"><span class="lineNum">     735 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="736"><span class="lineNum">     736 </span>                :            : </a>
<a name="737"><span class="lineNum">     737 </span>                :            :   // valid polygon</a>
<a name="738"><span class="lineNum">     738 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="739"><span class="lineNum">     739 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="740"><span class="lineNum">     740 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="741"><span class="lineNum">     741 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="742"><span class="lineNum">     742 </span>                :            : </a>
<a name="743"><span class="lineNum">     743 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="744"><span class="lineNum">     744 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="745"><span class="lineNum">     745 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="746"><span class="lineNum">     746 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="747"><span class="lineNum">     747 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="748"><span class="lineNum">     748 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="749"><span class="lineNum">     749 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="750"><span class="lineNum">     750 </span>                :            : </a>
<a name="751"><span class="lineNum">     751 </span>                :            :   // move last vertex</a>
<a name="752"><span class="lineNum">     752 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 0, 3 ), QgsPoint( 1.0, 2.0 ) ) );</span></a>
<a name="753"><span class="lineNum">     753 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="754"><span class="lineNum">     754 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="755"><span class="lineNum">     755 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="756"><span class="lineNum">     756 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="757"><span class="lineNum">     757 </span>                :            : </a>
<a name="758"><span class="lineNum">     758 </span>                :            :   // out of range</a>
<a name="759"><span class="lineNum">     759 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="760"><span class="lineNum">     760 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="761"><span class="lineNum">     761 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="762"><span class="lineNum">     762 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="763"><span class="lineNum">     763 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="764"><span class="lineNum">     764 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="765"><span class="lineNum">     765 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="766"><span class="lineNum">     766 </span>                :            : </a>
<a name="767"><span class="lineNum">     767 </span>                :            :   // with interior ring</a>
<a name="768"><span class="lineNum">     768 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="769"><span class="lineNum">     769 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="770"><span class="lineNum">     770 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="771"><span class="lineNum">     771 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.moveVertex( QgsVertexId( 0, 1, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="772"><span class="lineNum">     772 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="773"><span class="lineNum">     773 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="774"><span class="lineNum">     774 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="775"><span class="lineNum">     775 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="776"><span class="lineNum">     776 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="777"><span class="lineNum">     777 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 1, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="778"><span class="lineNum">     778 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.moveVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="779"><span class="lineNum">     779 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="780"><span class="lineNum">     780 </span>                :            : </a>
<a name="781"><span class="lineNum">     781 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testDeleteVertex()</span></a>
<a name="782"><span class="lineNum">     782 </span>                :            : {</a>
<a name="783"><span class="lineNum">     783 </span>                :            :   // empty polygon</a>
<a name="784"><span class="lineNum">     784 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="785"><span class="lineNum">     785 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="786"><span class="lineNum">     786 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="787"><span class="lineNum">     787 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.isEmpty() );</span></a>
<a name="788"><span class="lineNum">     788 </span>                :            : </a>
<a name="789"><span class="lineNum">     789 </span>                :            :   // valid polygon</a>
<a name="790"><span class="lineNum">     790 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="791"><span class="lineNum">     791 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 5, 2 )</span></a>
<a name="792"><span class="lineNum">     792 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 6, 2 ) &lt;&lt; QgsPoint( 7, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="793"><span class="lineNum">     793 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="794"><span class="lineNum">     794 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="795"><span class="lineNum">     795 </span>                :            : </a>
<a name="796"><span class="lineNum">     796 </span>                :            :   // out of range vertices</a>
<a name="797"><span class="lineNum">     797 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="798"><span class="lineNum">     798 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="799"><span class="lineNum">     799 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="800"><span class="lineNum">     800 </span>                :            : </a>
<a name="801"><span class="lineNum">     801 </span>                :            :   // valid vertices</a>
<a name="802"><span class="lineNum">     802 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="803"><span class="lineNum">     803 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="804"><span class="lineNum">     804 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="805"><span class="lineNum">     805 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="806"><span class="lineNum">     806 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="807"><span class="lineNum">     807 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="808"><span class="lineNum">     808 </span>                :            : </a>
<a name="809"><span class="lineNum">     809 </span>                :            :   // delete first vertex</a>
<a name="810"><span class="lineNum">     810 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="811"><span class="lineNum">     811 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="812"><span class="lineNum">     812 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="813"><span class="lineNum">     813 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="814"><span class="lineNum">     814 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="815"><span class="lineNum">     815 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="816"><span class="lineNum">     816 </span>                :            : </a>
<a name="817"><span class="lineNum">     817 </span>                :            :   // delete last vertex</a>
<a name="818"><span class="lineNum">     818 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 4 ) ) );</span></a>
<a name="819"><span class="lineNum">     819 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="820"><span class="lineNum">     820 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="821"><span class="lineNum">     821 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="822"><span class="lineNum">     822 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="823"><span class="lineNum">     823 </span>                :            : </a>
<a name="824"><span class="lineNum">     824 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="825"><span class="lineNum">     825 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="826"><span class="lineNum">     826 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.exteriorRing() );</span></a>
<a name="827"><span class="lineNum">     827 </span>                :            : </a>
<a name="828"><span class="lineNum">     828 </span>                :            :   // with interior ring</a>
<a name="829"><span class="lineNum">     829 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="830"><span class="lineNum">     830 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="831"><span class="lineNum">     831 </span>                :            : </a>
<a name="832"><span class="lineNum">     832 </span>                :            :   // out of range vertices</a>
<a name="833"><span class="lineNum">     833 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 1, -1 ) ) );</span></a>
<a name="834"><span class="lineNum">     834 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 1, 100 ) ) );</span></a>
<a name="835"><span class="lineNum">     835 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.deleteVertex( QgsVertexId( 0, 2, 1 ) ) );</span></a>
<a name="836"><span class="lineNum">     836 </span>                :            : </a>
<a name="837"><span class="lineNum">     837 </span>                :            :   // valid vertices</a>
<a name="838"><span class="lineNum">     838 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="839"><span class="lineNum">     839 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="840"><span class="lineNum">     840 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="841"><span class="lineNum">     841 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="842"><span class="lineNum">     842 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="843"><span class="lineNum">     843 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="844"><span class="lineNum">     844 </span>                :            : </a>
<a name="845"><span class="lineNum">     845 </span>                :            :   // delete first vertex</a>
<a name="846"><span class="lineNum">     846 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="847"><span class="lineNum">     847 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="848"><span class="lineNum">     848 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="849"><span class="lineNum">     849 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="850"><span class="lineNum">     850 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="851"><span class="lineNum">     851 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="852"><span class="lineNum">     852 </span>                :            : </a>
<a name="853"><span class="lineNum">     853 </span>                :            :   // delete last vertex</a>
<a name="854"><span class="lineNum">     854 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 1, 4 ) ) );</span></a>
<a name="855"><span class="lineNum">     855 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="856"><span class="lineNum">     856 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="857"><span class="lineNum">     857 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="858"><span class="lineNum">     858 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( poly.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="859"><span class="lineNum">     859 </span>                :            : </a>
<a name="860"><span class="lineNum">     860 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="861"><span class="lineNum">     861 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="862"><span class="lineNum">     862 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="863"><span class="lineNum">     863 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.exteriorRing() );</span></a>
<a name="864"><span class="lineNum">     864 </span>                :            : </a>
<a name="865"><span class="lineNum">     865 </span>                :            :   // test that interior ring is &quot;promoted&quot; when exterior is removed</a>
<a name="866"><span class="lineNum">     866 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="867"><span class="lineNum">     867 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="868"><span class="lineNum">     868 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="869"><span class="lineNum">     869 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="870"><span class="lineNum">     870 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="871"><span class="lineNum">     871 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="872"><span class="lineNum">     872 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 1 );</span></a>
<a name="873"><span class="lineNum">     873 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="874"><span class="lineNum">     874 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.numInteriorRings(), 0 );</span></a>
<a name="875"><span class="lineNum">     875 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.exteriorRing() );</span></a>
<a name="876"><span class="lineNum">     876 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="877"><span class="lineNum">     877 </span>                :            : </a>
<a name="878"><span class="lineNum">     878 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testNextVertex()</span></a>
<a name="879"><span class="lineNum">     879 </span>                :            : {</a>
<a name="880"><span class="lineNum">     880 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon empty;</span></a>
<a name="881"><span class="lineNum">     881 </span>                :<span class="lineCov">          1 :   QPainter p;</span></a>
<a name="882"><span class="lineNum">     882 </span>                :<span class="lineCov">          1 :   empty.draw( p ); // no crash!</span></a>
<a name="883"><span class="lineNum">     883 </span>                :            : </a>
<a name="884"><span class="lineNum">     884 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="885"><span class="lineNum">     885 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="886"><span class="lineNum">     886 </span>                :<span class="lineCov">          1 :   ( void )empty.closestSegment( QgsPoint( 1, 2 ), pt, v ); // empty curve, just want no crash</span></a>
<a name="887"><span class="lineNum">     887 </span>                :            : </a>
<a name="888"><span class="lineNum">     888 </span>                :            :   // nextVertex</a>
<a name="889"><span class="lineNum">     889 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon curvePoly;</span></a>
<a name="890"><span class="lineNum">     890 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="891"><span class="lineNum">     891 </span>                :            : </a>
<a name="892"><span class="lineNum">     892 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="893"><span class="lineNum">     893 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="894"><span class="lineNum">     894 </span>                :            : </a>
<a name="895"><span class="lineNum">     895 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="896"><span class="lineNum">     896 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="897"><span class="lineNum">     897 </span>                :            : </a>
<a name="898"><span class="lineNum">     898 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="899"><span class="lineNum">     899 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="900"><span class="lineNum">     900 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="901"><span class="lineNum">     901 </span>                :<span class="lineCov">          1 :   curvePoly.setExteriorRing( ring.clone() );</span></a>
<a name="902"><span class="lineNum">     902 </span>                :            : </a>
<a name="903"><span class="lineNum">     903 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 4 ); // out of range</span></a>
<a name="904"><span class="lineNum">     904 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="905"><span class="lineNum">     905 </span>                :            : </a>
<a name="906"><span class="lineNum">     906 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="907"><span class="lineNum">     907 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="908"><span class="lineNum">     908 </span>                :            : </a>
<a name="909"><span class="lineNum">     909 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="910"><span class="lineNum">     910 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="911"><span class="lineNum">     911 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="912"><span class="lineNum">     912 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="913"><span class="lineNum">     913 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="914"><span class="lineNum">     914 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="915"><span class="lineNum">     915 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="916"><span class="lineNum">     916 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="917"><span class="lineNum">     917 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="918"><span class="lineNum">     918 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 12 ) );</span></a>
<a name="919"><span class="lineNum">     919 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="920"><span class="lineNum">     920 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="921"><span class="lineNum">     921 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="922"><span class="lineNum">     922 </span>                :            : </a>
<a name="923"><span class="lineNum">     923 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 0 );</span></a>
<a name="924"><span class="lineNum">     924 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="925"><span class="lineNum">     925 </span>                :            : </a>
<a name="926"><span class="lineNum">     926 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="927"><span class="lineNum">     927 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="928"><span class="lineNum">     928 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) ); // test that part number is maintained</span></a>
<a name="929"><span class="lineNum">     929 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="930"><span class="lineNum">     930 </span>                :            : </a>
<a name="931"><span class="lineNum">     931 </span>                :            :   // add interior ring</a>
<a name="932"><span class="lineNum">     932 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 )</span></a>
<a name="933"><span class="lineNum">     933 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="934"><span class="lineNum">     934 </span>                :<span class="lineCov">          1 :   curvePoly.addInteriorRing( ring.clone() );</span></a>
<a name="935"><span class="lineNum">     935 </span>                :            : </a>
<a name="936"><span class="lineNum">     936 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 4 ); // out of range</span></a>
<a name="937"><span class="lineNum">     937 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="938"><span class="lineNum">     938 </span>                :            : </a>
<a name="939"><span class="lineNum">     939 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -5 );</span></a>
<a name="940"><span class="lineNum">     940 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="941"><span class="lineNum">     941 </span>                :            : </a>
<a name="942"><span class="lineNum">     942 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -1 );</span></a>
<a name="943"><span class="lineNum">     943 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="944"><span class="lineNum">     944 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="945"><span class="lineNum">     945 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="946"><span class="lineNum">     946 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="947"><span class="lineNum">     947 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="948"><span class="lineNum">     948 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="949"><span class="lineNum">     949 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="950"><span class="lineNum">     950 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="951"><span class="lineNum">     951 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 22 ) );</span></a>
<a name="952"><span class="lineNum">     952 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="953"><span class="lineNum">     953 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="954"><span class="lineNum">     954 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="955"><span class="lineNum">     955 </span>                :            : </a>
<a name="956"><span class="lineNum">     956 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 2, 0 );</span></a>
<a name="957"><span class="lineNum">     957 </span>                :<span class="lineCov">          1 :   QVERIFY( !curvePoly.nextVertex( v, pt ) );</span></a>
<a name="958"><span class="lineNum">     958 </span>                :            : </a>
<a name="959"><span class="lineNum">     959 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 1, 0 );</span></a>
<a name="960"><span class="lineNum">     960 </span>                :<span class="lineCov">          1 :   QVERIFY( curvePoly.nextVertex( v, pt ) );</span></a>
<a name="961"><span class="lineNum">     961 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 1, 1 ) ); // test that part number is maintained</span></a>
<a name="962"><span class="lineNum">     962 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="963"><span class="lineNum">     963 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="964"><span class="lineNum">     964 </span>                :            : </a>
<a name="965"><span class="lineNum">     965 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testVertexAngle()</span></a>
<a name="966"><span class="lineNum">     966 </span>                :            : {</a>
<a name="967"><span class="lineNum">     967 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="968"><span class="lineNum">     968 </span>                :            : </a>
<a name="969"><span class="lineNum">     969 </span>                :            :   // just want no crash</a>
<a name="970"><span class="lineNum">     970 </span>                :<span class="lineCov">          1 :   ( void )poly.vertexAngle( QgsVertexId() );</span></a>
<a name="971"><span class="lineNum">     971 </span>                :<span class="lineCov">          1 :   ( void )poly.vertexAngle( QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="972"><span class="lineNum">     972 </span>                :<span class="lineCov">          1 :   ( void )poly.vertexAngle( QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="973"><span class="lineNum">     973 </span>                :            : </a>
<a name="974"><span class="lineNum">     974 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="975"><span class="lineNum">     975 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 )</span></a>
<a name="976"><span class="lineNum">     976 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="977"><span class="lineNum">     977 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="978"><span class="lineNum">     978 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="979"><span class="lineNum">     979 </span>                :            : </a>
<a name="980"><span class="lineNum">     980 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="981"><span class="lineNum">     981 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="982"><span class="lineNum">     982 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="983"><span class="lineNum">     983 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="984"><span class="lineNum">     984 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="985"><span class="lineNum">     985 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="986"><span class="lineNum">     986 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="987"><span class="lineNum">     987 </span>                :            : </a>
<a name="988"><span class="lineNum">     988 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="989"><span class="lineNum">     989 </span>                :            : </a>
<a name="990"><span class="lineNum">     990 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="991"><span class="lineNum">     991 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="992"><span class="lineNum">     992 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="993"><span class="lineNum">     993 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="994"><span class="lineNum">     994 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="995"><span class="lineNum">     995 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="996"><span class="lineNum">     996 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.vertexAngle( QgsVertexId( 0, 1, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="997"><span class="lineNum">     997 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="998"><span class="lineNum">     998 </span>                :            : </a>
<a name="999"><span class="lineNum">     999 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testDeleteVertexRemoveRing()</span></a>
<a name="1000"><span class="lineNum">    1000 </span>                :            : {</a>
<a name="1001"><span class="lineNum">    1001 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1002"><span class="lineNum">    1002 </span>                :            : </a>
<a name="1003"><span class="lineNum">    1003 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1004"><span class="lineNum">    1004 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="1005"><span class="lineNum">    1005 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1006"><span class="lineNum">    1006 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="1007"><span class="lineNum">    1007 </span>                :            : </a>
<a name="1008"><span class="lineNum">    1008 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.exteriorRing() );</span></a>
<a name="1009"><span class="lineNum">    1009 </span>                :<span class="lineCov">          1 :   poly.deleteVertex( QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1010"><span class="lineNum">    1010 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.exteriorRing() );</span></a>
<a name="1011"><span class="lineNum">    1011 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1012"><span class="lineNum">    1012 </span>                :            : </a>
<a name="1013"><span class="lineNum">    1013 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testHasCurvedSegments()</span></a>
<a name="1014"><span class="lineNum">    1014 </span>                :            : {</a>
<a name="1015"><span class="lineNum">    1015 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1016"><span class="lineNum">    1016 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.hasCurvedSegments() );</span></a>
<a name="1017"><span class="lineNum">    1017 </span>                :            : </a>
<a name="1018"><span class="lineNum">    1018 </span>                :<span class="lineCov">          1 :   QgsLineString linePoly;</span></a>
<a name="1019"><span class="lineNum">    1019 </span>                :<span class="lineCov">          2 :   linePoly.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="1020"><span class="lineNum">    1020 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1021"><span class="lineNum">    1021 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( linePoly.clone() );</span></a>
<a name="1022"><span class="lineNum">    1022 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.hasCurvedSegments() );</span></a>
<a name="1023"><span class="lineNum">    1023 </span>                :            : </a>
<a name="1024"><span class="lineNum">    1024 </span>                :<span class="lineCov">          1 :   QgsCircularString circularString;</span></a>
<a name="1025"><span class="lineNum">    1025 </span>                :<span class="lineCov">          2 :   circularString.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="1026"><span class="lineNum">    1026 </span>                :<span class="lineCov">          1 :                             &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1027"><span class="lineNum">    1027 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( circularString.clone() );</span></a>
<a name="1028"><span class="lineNum">    1028 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.hasCurvedSegments() );</span></a>
<a name="1029"><span class="lineNum">    1029 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1030"><span class="lineNum">    1030 </span>                :            : </a>
<a name="1031"><span class="lineNum">    1031 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testClosestSegment()</span></a>
<a name="1032"><span class="lineNum">    1032 </span>                :            : {</a>
<a name="1033"><span class="lineNum">    1033 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon empty;</span></a>
<a name="1034"><span class="lineNum">    1034 </span>                :<span class="lineCov">          1 :   QPainter p;</span></a>
<a name="1035"><span class="lineNum">    1035 </span>                :<span class="lineCov">          1 :   empty.draw( p ); // no crash!</span></a>
<a name="1036"><span class="lineNum">    1036 </span>                :            : </a>
<a name="1037"><span class="lineNum">    1037 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="1038"><span class="lineNum">    1038 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="1039"><span class="lineNum">    1039 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="1040"><span class="lineNum">    1040 </span>                :<span class="lineCov">          1 :   ( void )empty.closestSegment( QgsPoint( 1, 2 ), pt, v ); // empty curve, just want no crash</span></a>
<a name="1041"><span class="lineNum">    1041 </span>                :            : </a>
<a name="1042"><span class="lineNum">    1042 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1043"><span class="lineNum">    1043 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="1044"><span class="lineNum">    1044 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 )</span></a>
<a name="1045"><span class="lineNum">    1045 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="1046"><span class="lineNum">    1046 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1047"><span class="lineNum">    1047 </span>                :            : </a>
<a name="1048"><span class="lineNum">    1048 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="1049"><span class="lineNum">    1049 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="1050"><span class="lineNum">    1050 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="1051"><span class="lineNum">    1051 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="1052"><span class="lineNum">    1052 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1053"><span class="lineNum">    1053 </span>                :            : </a>
<a name="1054"><span class="lineNum">    1054 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="1055"><span class="lineNum">    1055 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="1056"><span class="lineNum">    1056 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="1057"><span class="lineNum">    1057 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="1058"><span class="lineNum">    1058 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1059"><span class="lineNum">    1059 </span>                :            : </a>
<a name="1060"><span class="lineNum">    1060 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 6, 11.5 ), pt, v, &amp;leftOf ), 0.125000, 0.0001 );</span></a>
<a name="1061"><span class="lineNum">    1061 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.25, 0.01 );</span></a>
<a name="1062"><span class="lineNum">    1062 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.25, 0.01 );</span></a>
<a name="1063"><span class="lineNum">    1063 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="1064"><span class="lineNum">    1064 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="1065"><span class="lineNum">    1065 </span>                :            : </a>
<a name="1066"><span class="lineNum">    1066 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="1067"><span class="lineNum">    1067 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="1068"><span class="lineNum">    1068 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="1069"><span class="lineNum">    1069 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1070"><span class="lineNum">    1070 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1071"><span class="lineNum">    1071 </span>                :            : </a>
<a name="1072"><span class="lineNum">    1072 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="1073"><span class="lineNum">    1073 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="1074"><span class="lineNum">    1074 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="1075"><span class="lineNum">    1075 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1076"><span class="lineNum">    1076 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="1077"><span class="lineNum">    1077 </span>                :            : </a>
<a name="1078"><span class="lineNum">    1078 </span>                :            :   // point directly on segment</a>
<a name="1079"><span class="lineNum">    1079 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.closestSegment( QgsPoint( 5, 15 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="1080"><span class="lineNum">    1080 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 5, 15 ) );</span></a>
<a name="1081"><span class="lineNum">    1081 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1082"><span class="lineNum">    1082 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="1083"><span class="lineNum">    1083 </span>                :            : </a>
<a name="1084"><span class="lineNum">    1084 </span>                :            :   // with interior ring</a>
<a name="1085"><span class="lineNum">    1085 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6, 11.5 ) &lt;&lt; QgsPoint( 6.5, 12 ) &lt;&lt; QgsPoint( 6, 13 ) &lt;&lt; QgsPoint( 6, 11.5 ) );</span></a>
<a name="1086"><span class="lineNum">    1086 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1087"><span class="lineNum">    1087 </span>                :            : </a>
<a name="1088"><span class="lineNum">    1088 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="1089"><span class="lineNum">    1089 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="1090"><span class="lineNum">    1090 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="1091"><span class="lineNum">    1091 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="1092"><span class="lineNum">    1092 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1093"><span class="lineNum">    1093 </span>                :            : </a>
<a name="1094"><span class="lineNum">    1094 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="1095"><span class="lineNum">    1095 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="1096"><span class="lineNum">    1096 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="1097"><span class="lineNum">    1097 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="1098"><span class="lineNum">    1098 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1099"><span class="lineNum">    1099 </span>                :            : </a>
<a name="1100"><span class="lineNum">    1100 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 6, 11.4 ), pt, v, &amp;leftOf ), 0.01, 0.0001 );</span></a>
<a name="1101"><span class="lineNum">    1101 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.0, 0.01 );</span></a>
<a name="1102"><span class="lineNum">    1102 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.5, 0.01 );</span></a>
<a name="1103"><span class="lineNum">    1103 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="1104"><span class="lineNum">    1104 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1105"><span class="lineNum">    1105 </span>                :            : </a>
<a name="1106"><span class="lineNum">    1106 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="1107"><span class="lineNum">    1107 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="1108"><span class="lineNum">    1108 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="1109"><span class="lineNum">    1109 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1110"><span class="lineNum">    1110 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="1111"><span class="lineNum">    1111 </span>                :            : </a>
<a name="1112"><span class="lineNum">    1112 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( poly.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="1113"><span class="lineNum">    1113 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="1114"><span class="lineNum">    1114 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="1115"><span class="lineNum">    1115 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="1116"><span class="lineNum">    1116 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="1117"><span class="lineNum">    1117 </span>                :            : </a>
<a name="1118"><span class="lineNum">    1118 </span>                :            :   // point directly on segment</a>
<a name="1119"><span class="lineNum">    1119 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.closestSegment( QgsPoint( 6, 13 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="1120"><span class="lineNum">    1120 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6, 13 ) );</span></a>
<a name="1121"><span class="lineNum">    1121 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="1122"><span class="lineNum">    1122 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="1123"><span class="lineNum">    1123 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1124"><span class="lineNum">    1124 </span>                :            : </a>
<a name="1125"><span class="lineNum">    1125 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testBoundary()</span></a>
<a name="1126"><span class="lineNum">    1126 </span>                :            : {</a>
<a name="1127"><span class="lineNum">    1127 </span>                :<span class="lineCov">          1 :   QgsCircularString extBoundary;</span></a>
<a name="1128"><span class="lineNum">    1128 </span>                :<span class="lineCov">          2 :   extBoundary.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 )</span></a>
<a name="1129"><span class="lineNum">    1129 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( 2, 0, 3 ) &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1130"><span class="lineNum">    1130 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1131"><span class="lineNum">    1131 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly.boundary() );</span></a>
<a name="1132"><span class="lineNum">    1132 </span>                :            : </a>
<a name="1133"><span class="lineNum">    1133 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( extBoundary.clone() );</span></a>
<a name="1134"><span class="lineNum">    1134 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = poly.boundary();</span></a>
<a name="1135"><span class="lineNum">    1135 </span>                :<span class="lineCov">          1 :   QgsCircularString *lineBoundary = dynamic_cast&lt; QgsCircularString * &gt;( boundary );</span></a>
<a name="1136"><span class="lineNum">    1136 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="1137"><span class="lineNum">    1137 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 5 );</span></a>
<a name="1138"><span class="lineNum">    1138 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="1139"><span class="lineNum">    1139 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="1140"><span class="lineNum">    1140 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 2 ), 2.0 );</span></a>
<a name="1141"><span class="lineNum">    1141 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 3 ), 1.0 );</span></a>
<a name="1142"><span class="lineNum">    1142 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 4 ), 0.0 );</span></a>
<a name="1143"><span class="lineNum">    1143 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="1144"><span class="lineNum">    1144 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="1145"><span class="lineNum">    1145 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 2 ), 0.0 );</span></a>
<a name="1146"><span class="lineNum">    1146 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 3 ), 0.5 );</span></a>
<a name="1147"><span class="lineNum">    1147 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 4 ), 0.0 );</span></a>
<a name="1148"><span class="lineNum">    1148 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="1149"><span class="lineNum">    1149 </span>                :            : </a>
<a name="1150"><span class="lineNum">    1150 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryRing1;</span></a>
<a name="1151"><span class="lineNum">    1151 </span>                :<span class="lineCov">          2 :   boundaryRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 )</span></a>
<a name="1152"><span class="lineNum">    1152 </span>                :<span class="lineCov">          1 :                            &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.2 ) );</span></a>
<a name="1153"><span class="lineNum">    1153 </span>                :            : </a>
<a name="1154"><span class="lineNum">    1154 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryRing2;</span></a>
<a name="1155"><span class="lineNum">    1155 </span>                :<span class="lineCov">          2 :   boundaryRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="1156"><span class="lineNum">    1156 </span>                :<span class="lineCov">          1 :                            &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.9 ) );</span></a>
<a name="1157"><span class="lineNum">    1157 </span>                :            : </a>
<a name="1158"><span class="lineNum">    1158 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; boundaryRing1.clone() &lt;&lt; boundaryRing2.clone() );</span></a>
<a name="1159"><span class="lineNum">    1159 </span>                :<span class="lineCov">          1 :   boundary = poly.boundary();</span></a>
<a name="1160"><span class="lineNum">    1160 </span>                :            : </a>
<a name="1161"><span class="lineNum">    1161 </span>                :<span class="lineCov">          1 :   QgsMultiCurve *multiLineBoundary = dynamic_cast&lt; QgsMultiCurve * &gt;( boundary );</span></a>
<a name="1162"><span class="lineNum">    1162 </span>                :<span class="lineCov">          1 :   QVERIFY( multiLineBoundary );</span></a>
<a name="1163"><span class="lineNum">    1163 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLineBoundary-&gt;numGeometries(), 3 );</span></a>
<a name="1164"><span class="lineNum">    1164 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;numPoints(), 5 );</span></a>
<a name="1165"><span class="lineNum">    1165 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="1166"><span class="lineNum">    1166 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="1167"><span class="lineNum">    1167 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 2 ), 2.0 );</span></a>
<a name="1168"><span class="lineNum">    1168 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 3 ), 1.0 );</span></a>
<a name="1169"><span class="lineNum">    1169 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 4 ), 0.0 );</span></a>
<a name="1170"><span class="lineNum">    1170 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="1171"><span class="lineNum">    1171 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="1172"><span class="lineNum">    1172 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 2 ), 0.0 );</span></a>
<a name="1173"><span class="lineNum">    1173 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 3 ), 0.5 );</span></a>
<a name="1174"><span class="lineNum">    1174 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 4 ), 0.0 );</span></a>
<a name="1175"><span class="lineNum">    1175 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;numPoints(), 3 );</span></a>
<a name="1176"><span class="lineNum">    1176 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 0 ), 0.1 );</span></a>
<a name="1177"><span class="lineNum">    1177 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 1 ), 0.2 );</span></a>
<a name="1178"><span class="lineNum">    1178 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 2 ), 0.2 );</span></a>
<a name="1179"><span class="lineNum">    1179 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 0 ), 0.1 );</span></a>
<a name="1180"><span class="lineNum">    1180 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 1 ), 0.1 );</span></a>
<a name="1181"><span class="lineNum">    1181 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 2 ), 0.2 );</span></a>
<a name="1182"><span class="lineNum">    1182 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;numPoints(), 3 );</span></a>
<a name="1183"><span class="lineNum">    1183 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 0 ), 0.8 );</span></a>
<a name="1184"><span class="lineNum">    1184 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 1 ), 0.9 );</span></a>
<a name="1185"><span class="lineNum">    1185 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 2 ), 0.9 );</span></a>
<a name="1186"><span class="lineNum">    1186 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 0 ), 0.8 );</span></a>
<a name="1187"><span class="lineNum">    1187 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 1 ), 0.8 );</span></a>
<a name="1188"><span class="lineNum">    1188 </span>                :<span class="lineCov">          1 :   QCOMPARE( qgis::down_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 2 ), 0.9 );</span></a>
<a name="1189"><span class="lineNum">    1189 </span>                :<span class="lineCov">          1 :   poly.setInteriorRings( QVector&lt; QgsCurve * &gt;() );</span></a>
<a name="1190"><span class="lineNum">    1190 </span>                :            : </a>
<a name="1191"><span class="lineNum">    1191 </span>                :            :   // test boundary with z</a>
<a name="1192"><span class="lineNum">    1192 </span>                :<span class="lineCov">          2 :   extBoundary.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 )</span></a>
<a name="1193"><span class="lineNum">    1193 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 )</span></a>
<a name="1194"><span class="lineNum">    1194 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="1195"><span class="lineNum">    1195 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( extBoundary.clone() );</span></a>
<a name="1196"><span class="lineNum">    1196 </span>                :            : </a>
<a name="1197"><span class="lineNum">    1197 </span>                :<span class="lineCov">          1 :   boundary = poly.boundary();</span></a>
<a name="1198"><span class="lineNum">    1198 </span>                :<span class="lineCov">          1 :   lineBoundary = dynamic_cast&lt; QgsCircularString * &gt;( boundary );</span></a>
<a name="1199"><span class="lineNum">    1199 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="1200"><span class="lineNum">    1200 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 3 );</span></a>
<a name="1201"><span class="lineNum">    1201 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="1202"><span class="lineNum">    1202 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 0 ).z(), 10.0 );</span></a>
<a name="1203"><span class="lineNum">    1203 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 1 ).z(), 15.0 );</span></a>
<a name="1204"><span class="lineNum">    1204 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 2 ).z(), 20.0 );</span></a>
<a name="1205"><span class="lineNum">    1205 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="1206"><span class="lineNum">    1206 </span>                :            : </a>
<a name="1207"><span class="lineNum">    1207 </span>                :            :   // remove interior rings</a>
<a name="1208"><span class="lineNum">    1208 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsExt;</span></a>
<a name="1209"><span class="lineNum">    1209 </span>                :<span class="lineCov">          2 :   removeRingsExt.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="1210"><span class="lineNum">    1210 </span>                :<span class="lineCov">          1 :                             &lt;&lt; QgsPoint( 1, 1 )  &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1211"><span class="lineNum">    1211 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon removeRings1;</span></a>
<a name="1212"><span class="lineNum">    1212 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="1213"><span class="lineNum">    1213 </span>                :            : </a>
<a name="1214"><span class="lineNum">    1214 </span>                :<span class="lineCov">          1 :   removeRings1.setExteriorRing( extBoundary.clone() );</span></a>
<a name="1215"><span class="lineNum">    1215 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="1216"><span class="lineNum">    1216 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="1217"><span class="lineNum">    1217 </span>                :            : </a>
<a name="1218"><span class="lineNum">    1218 </span>                :            :   // add interior rings</a>
<a name="1219"><span class="lineNum">    1219 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsRing1;</span></a>
<a name="1220"><span class="lineNum">    1220 </span>                :<span class="lineCov">          2 :   removeRingsRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 )</span></a>
<a name="1221"><span class="lineNum">    1221 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( 0.1, 1, 2 ) &lt;&lt; QgsPoint( 0, 2, 3 )</span></a>
<a name="1222"><span class="lineNum">    1222 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( -0.1, 1.2, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1223"><span class="lineNum">    1223 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsRing2;</span></a>
<a name="1224"><span class="lineNum">    1224 </span>                :<span class="lineCov">          2 :   removeRingsRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 )</span></a>
<a name="1225"><span class="lineNum">    1225 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( 0.01, 0.1, 2 ) &lt;&lt; QgsPoint( 0, 0.2, 3 )</span></a>
<a name="1226"><span class="lineNum">    1226 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( -0.01, 0.12, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1227"><span class="lineNum">    1227 </span>                :<span class="lineCov">          1 :   removeRings1.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; removeRingsRing1.clone() &lt;&lt; removeRingsRing2.clone() );</span></a>
<a name="1228"><span class="lineNum">    1228 </span>                :            : </a>
<a name="1229"><span class="lineNum">    1229 </span>                :            :   // remove ring with size filter</a>
<a name="1230"><span class="lineNum">    1230 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings( 0.05 );</span></a>
<a name="1231"><span class="lineNum">    1231 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 1 );</span></a>
<a name="1232"><span class="lineNum">    1232 </span>                :            : </a>
<a name="1233"><span class="lineNum">    1233 </span>                :            :   // remove ring with no size filter</a>
<a name="1234"><span class="lineNum">    1234 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="1235"><span class="lineNum">    1235 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="1236"><span class="lineNum">    1236 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1237"><span class="lineNum">    1237 </span>                :            : </a>
<a name="1238"><span class="lineNum">    1238 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testBoundingBox()</span></a>
<a name="1239"><span class="lineNum">    1239 </span>                :            : {</a>
<a name="1240"><span class="lineNum">    1240 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1241"><span class="lineNum">    1241 </span>                :<span class="lineCov">          1 :   QgsRectangle bBox = poly.boundingBox(); // no crash!</span></a>
<a name="1242"><span class="lineNum">    1242 </span>                :            : </a>
<a name="1243"><span class="lineNum">    1243 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1244"><span class="lineNum">    1244 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 10, 2 )</span></a>
<a name="1245"><span class="lineNum">    1245 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 0, 18, 3 ) &lt;&lt; QgsPoint( -1, 4, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1246"><span class="lineNum">    1246 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="1247"><span class="lineNum">    1247 </span>                :            : </a>
<a name="1248"><span class="lineNum">    1248 </span>                :<span class="lineCov">          1 :   bBox = poly.boundingBox();</span></a>
<a name="1249"><span class="lineNum">    1249 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.xMinimum(), -1.435273, 0.001 );</span></a>
<a name="1250"><span class="lineNum">    1250 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.xMaximum(), 1.012344, 0.001 );</span></a>
<a name="1251"><span class="lineNum">    1251 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.yMinimum(), 0.000000, 0.001 );</span></a>
<a name="1252"><span class="lineNum">    1252 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.yMaximum(), 18, 0.001 );</span></a>
<a name="1253"><span class="lineNum">    1253 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1254"><span class="lineNum">    1254 </span>                :            : </a>
<a name="1255"><span class="lineNum">    1255 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testDropZValue()</span></a>
<a name="1256"><span class="lineNum">    1256 </span>                :            : {</a>
<a name="1257"><span class="lineNum">    1257 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1258"><span class="lineNum">    1258 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="1259"><span class="lineNum">    1259 </span>                :            : </a>
<a name="1260"><span class="lineNum">    1260 </span>                :            :   // without z</a>
<a name="1261"><span class="lineNum">    1261 </span>                :<span class="lineCov">          1 :   poly.dropZValue();</span></a>
<a name="1262"><span class="lineNum">    1262 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1263"><span class="lineNum">    1263 </span>                :            : </a>
<a name="1264"><span class="lineNum">    1264 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="1265"><span class="lineNum">    1265 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1266"><span class="lineNum">    1266 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1267"><span class="lineNum">    1267 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1268"><span class="lineNum">    1268 </span>                :            : </a>
<a name="1269"><span class="lineNum">    1269 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1270"><span class="lineNum">    1270 </span>                :            : </a>
<a name="1271"><span class="lineNum">    1271 </span>                :<span class="lineCov">          1 :   poly.dropZValue(); // not z</span></a>
<a name="1272"><span class="lineNum">    1272 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1273"><span class="lineNum">    1273 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1274"><span class="lineNum">    1274 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1275"><span class="lineNum">    1275 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1276"><span class="lineNum">    1276 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1277"><span class="lineNum">    1277 </span>                :            : </a>
<a name="1278"><span class="lineNum">    1278 </span>                :            :   // with z</a>
<a name="1279"><span class="lineNum">    1279 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3 ) &lt;&lt; QgsPoint( 11, 12, 13 )</span></a>
<a name="1280"><span class="lineNum">    1280 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12, 23 ) &lt;&lt; QgsPoint( 1, 2, 3 ) );</span></a>
<a name="1281"><span class="lineNum">    1281 </span>                :<span class="lineCov">          1 :   poly.clear();</span></a>
<a name="1282"><span class="lineNum">    1282 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1283"><span class="lineNum">    1283 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1284"><span class="lineNum">    1284 </span>                :            : </a>
<a name="1285"><span class="lineNum">    1285 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="1286"><span class="lineNum">    1286 </span>                :            : </a>
<a name="1287"><span class="lineNum">    1287 </span>                :<span class="lineCov">          1 :   poly.dropZValue();</span></a>
<a name="1288"><span class="lineNum">    1288 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1289"><span class="lineNum">    1289 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1290"><span class="lineNum">    1290 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1291"><span class="lineNum">    1291 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1292"><span class="lineNum">    1292 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1293"><span class="lineNum">    1293 </span>                :            : </a>
<a name="1294"><span class="lineNum">    1294 </span>                :            :   // with zm</a>
<a name="1295"><span class="lineNum">    1295 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 )</span></a>
<a name="1296"><span class="lineNum">    1296 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="1297"><span class="lineNum">    1297 </span>                :<span class="lineCov">          1 :   poly.clear();</span></a>
<a name="1298"><span class="lineNum">    1298 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1299"><span class="lineNum">    1299 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1300"><span class="lineNum">    1300 </span>                :            : </a>
<a name="1301"><span class="lineNum">    1301 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="1302"><span class="lineNum">    1302 </span>                :            : </a>
<a name="1303"><span class="lineNum">    1303 </span>                :<span class="lineCov">          1 :   poly.dropZValue();</span></a>
<a name="1304"><span class="lineNum">    1304 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="1305"><span class="lineNum">    1305 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="1306"><span class="lineNum">    1306 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="1307"><span class="lineNum">    1307 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="1308"><span class="lineNum">    1308 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="1309"><span class="lineNum">    1309 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1310"><span class="lineNum">    1310 </span>                :            : </a>
<a name="1311"><span class="lineNum">    1311 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testDropMValue()</span></a>
<a name="1312"><span class="lineNum">    1312 </span>                :            : {</a>
<a name="1313"><span class="lineNum">    1313 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1314"><span class="lineNum">    1314 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="1315"><span class="lineNum">    1315 </span>                :            : </a>
<a name="1316"><span class="lineNum">    1316 </span>                :            :   // without z</a>
<a name="1317"><span class="lineNum">    1317 </span>                :<span class="lineCov">          1 :   poly.dropMValue();</span></a>
<a name="1318"><span class="lineNum">    1318 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1319"><span class="lineNum">    1319 </span>                :            : </a>
<a name="1320"><span class="lineNum">    1320 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="1321"><span class="lineNum">    1321 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1322"><span class="lineNum">    1322 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1323"><span class="lineNum">    1323 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1324"><span class="lineNum">    1324 </span>                :            : </a>
<a name="1325"><span class="lineNum">    1325 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1326"><span class="lineNum">    1326 </span>                :            : </a>
<a name="1327"><span class="lineNum">    1327 </span>                :<span class="lineCov">          1 :   poly.dropMValue(); // not zm</span></a>
<a name="1328"><span class="lineNum">    1328 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1329"><span class="lineNum">    1329 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1330"><span class="lineNum">    1330 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1331"><span class="lineNum">    1331 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1332"><span class="lineNum">    1332 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1333"><span class="lineNum">    1333 </span>                :            : </a>
<a name="1334"><span class="lineNum">    1334 </span>                :            :   // with m</a>
<a name="1335"><span class="lineNum">    1335 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 )</span></a>
<a name="1336"><span class="lineNum">    1336 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 13 )</span></a>
<a name="1337"><span class="lineNum">    1337 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 12, 0, 23 )</span></a>
<a name="1338"><span class="lineNum">    1338 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) );</span></a>
<a name="1339"><span class="lineNum">    1339 </span>                :<span class="lineCov">          1 :   poly.clear();</span></a>
<a name="1340"><span class="lineNum">    1340 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1341"><span class="lineNum">    1341 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1342"><span class="lineNum">    1342 </span>                :            : </a>
<a name="1343"><span class="lineNum">    1343 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="1344"><span class="lineNum">    1344 </span>                :            : </a>
<a name="1345"><span class="lineNum">    1345 </span>                :<span class="lineCov">          1 :   poly.dropMValue();</span></a>
<a name="1346"><span class="lineNum">    1346 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1347"><span class="lineNum">    1347 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1348"><span class="lineNum">    1348 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1349"><span class="lineNum">    1349 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1350"><span class="lineNum">    1350 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1351"><span class="lineNum">    1351 </span>                :            : </a>
<a name="1352"><span class="lineNum">    1352 </span>                :            :   // with zm</a>
<a name="1353"><span class="lineNum">    1353 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 )</span></a>
<a name="1354"><span class="lineNum">    1354 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="1355"><span class="lineNum">    1355 </span>                :<span class="lineCov">          1 :   poly.clear();</span></a>
<a name="1356"><span class="lineNum">    1356 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ring.clone() );</span></a>
<a name="1357"><span class="lineNum">    1357 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring.clone() );</span></a>
<a name="1358"><span class="lineNum">    1358 </span>                :            : </a>
<a name="1359"><span class="lineNum">    1359 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="1360"><span class="lineNum">    1360 </span>                :            : </a>
<a name="1361"><span class="lineNum">    1361 </span>                :<span class="lineCov">          1 :   poly.dropMValue();</span></a>
<a name="1362"><span class="lineNum">    1362 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="1363"><span class="lineNum">    1363 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="1364"><span class="lineNum">    1364 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="1365"><span class="lineNum">    1365 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="1366"><span class="lineNum">    1366 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( poly.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="1367"><span class="lineNum">    1367 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1368"><span class="lineNum">    1368 </span>                :            : </a>
<a name="1369"><span class="lineNum">    1369 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testToPolygon()</span></a>
<a name="1370"><span class="lineNum">    1370 </span>                :            : {</a>
<a name="1371"><span class="lineNum">    1371 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly = QgsCurvePolygon();</span></a>
<a name="1372"><span class="lineNum">    1372 </span>                :<span class="lineCov">          1 :   QCOMPARE( *poly.toPolygon(), QgsPolygon() );</span></a>
<a name="1373"><span class="lineNum">    1373 </span>                :            : </a>
<a name="1374"><span class="lineNum">    1374 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; surface( poly.surfaceToPolygon() );</span></a>
<a name="1375"><span class="lineNum">    1375 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;isEmpty() );</span></a>
<a name="1376"><span class="lineNum">    1376 </span>                :            : </a>
<a name="1377"><span class="lineNum">    1377 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1378"><span class="lineNum">    1378 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 )</span></a>
<a name="1379"><span class="lineNum">    1379 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 0, 18 )</span></a>
<a name="1380"><span class="lineNum">    1380 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( -1, 4 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1381"><span class="lineNum">    1381 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="1382"><span class="lineNum">    1382 </span>                :            : </a>
<a name="1383"><span class="lineNum">    1383 </span>                :<span class="lineCov">          1 :   surface.reset( poly.toPolygon() );</span></a>
<a name="1384"><span class="lineNum">    1384 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="1385"><span class="lineNum">    1385 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 );</span></a>
<a name="1386"><span class="lineNum">    1386 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 ); // ncoordinates is cached, so check twice</span></a>
<a name="1387"><span class="lineNum">    1387 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="1388"><span class="lineNum">    1388 </span>                :            : </a>
<a name="1389"><span class="lineNum">    1389 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="1390"><span class="lineNum">    1390 </span>                :<span class="lineCov">          1 :   QgsRectangle r1 = ext-&gt;boundingBox();</span></a>
<a name="1391"><span class="lineNum">    1391 </span>                :<span class="lineCov">          1 :   QgsRectangle r2 = surface-&gt;exteriorRing()-&gt;boundingBox();</span></a>
<a name="1392"><span class="lineNum">    1392 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.01 );</span></a>
<a name="1393"><span class="lineNum">    1393 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.01 );</span></a>
<a name="1394"><span class="lineNum">    1394 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.01 );</span></a>
<a name="1395"><span class="lineNum">    1395 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.01 );</span></a>
<a name="1396"><span class="lineNum">    1396 </span>                :            : </a>
<a name="1397"><span class="lineNum">    1397 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="1398"><span class="lineNum">    1398 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="1399"><span class="lineNum">    1399 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="1400"><span class="lineNum">    1400 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="1401"><span class="lineNum">    1401 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="1402"><span class="lineNum">    1402 </span>                :            : </a>
<a name="1403"><span class="lineNum">    1403 </span>                :<span class="lineCov">          1 :   surface.reset( poly.toPolygon() );</span></a>
<a name="1404"><span class="lineNum">    1404 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="1405"><span class="lineNum">    1405 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 );</span></a>
<a name="1406"><span class="lineNum">    1406 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 ); // ncoordinates is cached, so check twice</span></a>
<a name="1407"><span class="lineNum">    1407 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="1408"><span class="lineNum">    1408 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;numInteriorRings(), 1 );</span></a>
<a name="1409"><span class="lineNum">    1409 </span>                :            : </a>
<a name="1410"><span class="lineNum">    1410 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="1411"><span class="lineNum">    1411 </span>                :<span class="lineCov">          1 :   r1 = ring-&gt;boundingBox();</span></a>
<a name="1412"><span class="lineNum">    1412 </span>                :<span class="lineCov">          1 :   r2 = surface-&gt;interiorRing( 0 )-&gt;boundingBox();</span></a>
<a name="1413"><span class="lineNum">    1413 </span>                :            : </a>
<a name="1414"><span class="lineNum">    1414 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="1415"><span class="lineNum">    1415 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="1416"><span class="lineNum">    1416 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="1417"><span class="lineNum">    1417 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="1418"><span class="lineNum">    1418 </span>                :            : </a>
<a name="1419"><span class="lineNum">    1419 </span>                :            :   // should be identical since it's already a curve</a>
<a name="1420"><span class="lineNum">    1420 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt; curveType( poly.toCurveType() );</span></a>
<a name="1421"><span class="lineNum">    1421 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curveType, poly );</span></a>
<a name="1422"><span class="lineNum">    1422 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1423"><span class="lineNum">    1423 </span>                :            : </a>
<a name="1424"><span class="lineNum">    1424 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testSurfaceToPolygon()</span></a>
<a name="1425"><span class="lineNum">    1425 </span>                :            : {</a>
<a name="1426"><span class="lineNum">    1426 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly;</span></a>
<a name="1427"><span class="lineNum">    1427 </span>                :            : </a>
<a name="1428"><span class="lineNum">    1428 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; surface( poly.surfaceToPolygon() );</span></a>
<a name="1429"><span class="lineNum">    1429 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;isEmpty() );</span></a>
<a name="1430"><span class="lineNum">    1430 </span>                :            : </a>
<a name="1431"><span class="lineNum">    1431 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1432"><span class="lineNum">    1432 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 3 )</span></a>
<a name="1433"><span class="lineNum">    1433 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 4 ) &lt;&lt; QgsPoint( -1, 5 ) &lt;&lt; QgsPoint( 0, 6 ) );</span></a>
<a name="1434"><span class="lineNum">    1434 </span>                :<span class="lineCov">          1 :   poly.setExteriorRing( ext );</span></a>
<a name="1435"><span class="lineNum">    1435 </span>                :            : </a>
<a name="1436"><span class="lineNum">    1436 </span>                :<span class="lineCov">          1 :   surface.reset( poly.surfaceToPolygon() );</span></a>
<a name="1437"><span class="lineNum">    1437 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="1438"><span class="lineNum">    1438 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 );</span></a>
<a name="1439"><span class="lineNum">    1439 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 ); // nCoordinates is cached, so check twice</span></a>
<a name="1440"><span class="lineNum">    1440 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="1441"><span class="lineNum">    1441 </span>                :            : </a>
<a name="1442"><span class="lineNum">    1442 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="1443"><span class="lineNum">    1443 </span>                :<span class="lineCov">          1 :   QgsRectangle r1 = ext-&gt;boundingBox();</span></a>
<a name="1444"><span class="lineNum">    1444 </span>                :<span class="lineCov">          1 :   QgsRectangle r2 = surface-&gt;exteriorRing()-&gt;boundingBox();</span></a>
<a name="1445"><span class="lineNum">    1445 </span>                :            : </a>
<a name="1446"><span class="lineNum">    1446 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="1447"><span class="lineNum">    1447 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="1448"><span class="lineNum">    1448 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="1449"><span class="lineNum">    1449 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="1450"><span class="lineNum">    1450 </span>                :            : </a>
<a name="1451"><span class="lineNum">    1451 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="1452"><span class="lineNum">    1452 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="1453"><span class="lineNum">    1453 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="1454"><span class="lineNum">    1454 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="1455"><span class="lineNum">    1455 </span>                :<span class="lineCov">          1 :   poly.addInteriorRing( ring );</span></a>
<a name="1456"><span class="lineNum">    1456 </span>                :            : </a>
<a name="1457"><span class="lineNum">    1457 </span>                :<span class="lineCov">          1 :   surface.reset( poly.surfaceToPolygon() );</span></a>
<a name="1458"><span class="lineNum">    1458 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="1459"><span class="lineNum">    1459 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 );</span></a>
<a name="1460"><span class="lineNum">    1460 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 ); // nCoordinates is cached, so check twice</span></a>
<a name="1461"><span class="lineNum">    1461 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="1462"><span class="lineNum">    1462 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;numInteriorRings(), 1 );</span></a>
<a name="1463"><span class="lineNum">    1463 </span>                :            : </a>
<a name="1464"><span class="lineNum">    1464 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="1465"><span class="lineNum">    1465 </span>                :<span class="lineCov">          1 :   r1 = ring-&gt;boundingBox();</span></a>
<a name="1466"><span class="lineNum">    1466 </span>                :<span class="lineCov">          1 :   r2 = surface-&gt;interiorRing( 0 )-&gt;boundingBox();</span></a>
<a name="1467"><span class="lineNum">    1467 </span>                :            : </a>
<a name="1468"><span class="lineNum">    1468 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="1469"><span class="lineNum">    1469 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="1470"><span class="lineNum">    1470 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="1471"><span class="lineNum">    1471 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="1472"><span class="lineNum">    1472 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1473"><span class="lineNum">    1473 </span>                :            : </a>
<a name="1474"><span class="lineNum">    1474 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testWKB()</span></a>
<a name="1475"><span class="lineNum">    1475 </span>                :            : {</a>
<a name="1476"><span class="lineNum">    1476 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly1;</span></a>
<a name="1477"><span class="lineNum">    1477 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly2;</span></a>
<a name="1478"><span class="lineNum">    1478 </span>                :            :   QgsCircularString *ext;</a>
<a name="1479"><span class="lineNum">    1479 </span>                :            :   QgsCircularString *ring;</a>
<a name="1480"><span class="lineNum">    1480 </span>                :            : </a>
<a name="1481"><span class="lineNum">    1481 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1482"><span class="lineNum">    1482 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="1483"><span class="lineNum">    1483 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 1, 0.5 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1484"><span class="lineNum">    1484 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1485"><span class="lineNum">    1485 </span>                :            : </a>
<a name="1486"><span class="lineNum">    1486 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="1487"><span class="lineNum">    1487 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.1, 0 )</span></a>
<a name="1488"><span class="lineNum">    1488 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 0.2, 0 ) &lt;&lt; QgsPoint( 0.1, 0.05 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1489"><span class="lineNum">    1489 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="1490"><span class="lineNum">    1490 </span>                :            : </a>
<a name="1491"><span class="lineNum">    1491 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = poly1.asWkb();</span></a>
<a name="1492"><span class="lineNum">    1492 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), poly1.wkbSize() );</span></a>
<a name="1493"><span class="lineNum">    1493 </span>                :            : </a>
<a name="1494"><span class="lineNum">    1494 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="1495"><span class="lineNum">    1495 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr );</span></a>
<a name="1496"><span class="lineNum">    1496 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1497"><span class="lineNum">    1497 </span>                :            : </a>
<a name="1498"><span class="lineNum">    1498 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1499"><span class="lineNum">    1499 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1500"><span class="lineNum">    1500 </span>                :            : </a>
<a name="1501"><span class="lineNum">    1501 </span>                :            :   // CurvePolygonZ</a>
<a name="1502"><span class="lineNum">    1502 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1503"><span class="lineNum">    1503 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 )</span></a>
<a name="1504"><span class="lineNum">    1504 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 0, 3 ) &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1505"><span class="lineNum">    1505 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1506"><span class="lineNum">    1506 </span>                :            : </a>
<a name="1507"><span class="lineNum">    1507 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="1508"><span class="lineNum">    1508 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 0.1, 0, 2 )</span></a>
<a name="1509"><span class="lineNum">    1509 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 0.2, 0, 3 ) &lt;&lt; QgsPoint( 0.1, 0.05, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1510"><span class="lineNum">    1510 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="1511"><span class="lineNum">    1511 </span>                :            : </a>
<a name="1512"><span class="lineNum">    1512 </span>                :<span class="lineCov">          1 :   wkb16 = poly1.asWkb();</span></a>
<a name="1513"><span class="lineNum">    1513 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="1514"><span class="lineNum">    1514 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr2 );</span></a>
<a name="1515"><span class="lineNum">    1515 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1516"><span class="lineNum">    1516 </span>                :            : </a>
<a name="1517"><span class="lineNum">    1517 </span>                :            :   // compound curve</a>
<a name="1518"><span class="lineNum">    1518 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve *cCurve = new QgsCompoundCurve();</span></a>
<a name="1519"><span class="lineNum">    1519 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1520"><span class="lineNum">    1520 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 )</span></a>
<a name="1521"><span class="lineNum">    1521 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 0, 3 ) &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="1522"><span class="lineNum">    1522 </span>                :<span class="lineCov">          1 :   cCurve-&gt;addCurve( ext );</span></a>
<a name="1523"><span class="lineNum">    1523 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( cCurve );</span></a>
<a name="1524"><span class="lineNum">    1524 </span>                :            : </a>
<a name="1525"><span class="lineNum">    1525 </span>                :<span class="lineCov">          1 :   wkb16 = poly1.asWkb();</span></a>
<a name="1526"><span class="lineNum">    1526 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), poly1.wkbSize() );</span></a>
<a name="1527"><span class="lineNum">    1527 </span>                :            : </a>
<a name="1528"><span class="lineNum">    1528 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="1529"><span class="lineNum">    1529 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr3 );</span></a>
<a name="1530"><span class="lineNum">    1530 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1531"><span class="lineNum">    1531 </span>                :            : </a>
<a name="1532"><span class="lineNum">    1532 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1533"><span class="lineNum">    1533 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1534"><span class="lineNum">    1534 </span>                :            : </a>
<a name="1535"><span class="lineNum">    1535 </span>                :            :   // CurvePolygonM</a>
<a name="1536"><span class="lineNum">    1536 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1537"><span class="lineNum">    1537 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="1538"><span class="lineNum">    1538 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 0, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 0, 0, 3 )</span></a>
<a name="1539"><span class="lineNum">    1539 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 0.5, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="1540"><span class="lineNum">    1540 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1541"><span class="lineNum">    1541 </span>                :            : </a>
<a name="1542"><span class="lineNum">    1542 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="1543"><span class="lineNum">    1543 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="1544"><span class="lineNum">    1544 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0, 0, 3 )</span></a>
<a name="1545"><span class="lineNum">    1545 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.05, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="1546"><span class="lineNum">    1546 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="1547"><span class="lineNum">    1547 </span>                :            : </a>
<a name="1548"><span class="lineNum">    1548 </span>                :<span class="lineCov">          1 :   wkb16 = poly1.asWkb();</span></a>
<a name="1549"><span class="lineNum">    1549 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="1550"><span class="lineNum">    1550 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr4 );</span></a>
<a name="1551"><span class="lineNum">    1551 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1552"><span class="lineNum">    1552 </span>                :            : </a>
<a name="1553"><span class="lineNum">    1553 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1554"><span class="lineNum">    1554 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1555"><span class="lineNum">    1555 </span>                :            : </a>
<a name="1556"><span class="lineNum">    1556 </span>                :            :   // CurvePolygonZM</a>
<a name="1557"><span class="lineNum">    1557 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1558"><span class="lineNum">    1558 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1559"><span class="lineNum">    1559 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1560"><span class="lineNum">    1560 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1561"><span class="lineNum">    1561 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="1562"><span class="lineNum">    1562 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1563"><span class="lineNum">    1563 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1564"><span class="lineNum">    1564 </span>                :            : </a>
<a name="1565"><span class="lineNum">    1565 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="1566"><span class="lineNum">    1566 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1567"><span class="lineNum">    1567 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="1568"><span class="lineNum">    1568 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1569"><span class="lineNum">    1569 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="1570"><span class="lineNum">    1570 </span>                :            : </a>
<a name="1571"><span class="lineNum">    1571 </span>                :<span class="lineCov">          1 :   wkb16 = poly1.asWkb();</span></a>
<a name="1572"><span class="lineNum">    1572 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr5( wkb16 );</span></a>
<a name="1573"><span class="lineNum">    1573 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr5 );</span></a>
<a name="1574"><span class="lineNum">    1574 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1575"><span class="lineNum">    1575 </span>                :            : </a>
<a name="1576"><span class="lineNum">    1576 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1577"><span class="lineNum">    1577 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1578"><span class="lineNum">    1578 </span>                :            : </a>
<a name="1579"><span class="lineNum">    1579 </span>                :            :   // With LineString</a>
<a name="1580"><span class="lineNum">    1580 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1581"><span class="lineNum">    1581 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="1582"><span class="lineNum">    1582 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 1, 0.5 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1583"><span class="lineNum">    1583 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1584"><span class="lineNum">    1584 </span>                :            : </a>
<a name="1585"><span class="lineNum">    1585 </span>                :<span class="lineCov">          1 :   QgsLineString *lineRing = new QgsLineString();</span></a>
<a name="1586"><span class="lineNum">    1586 </span>                :<span class="lineCov">          2 :   lineRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.1, 0 )</span></a>
<a name="1587"><span class="lineNum">    1587 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 0.2, 0 ) &lt;&lt; QgsPoint( 0.1, 0.05 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="1588"><span class="lineNum">    1588 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( lineRing );</span></a>
<a name="1589"><span class="lineNum">    1589 </span>                :            : </a>
<a name="1590"><span class="lineNum">    1590 </span>                :<span class="lineCov">          1 :   wkb16 = poly1.asWkb();</span></a>
<a name="1591"><span class="lineNum">    1591 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), poly1.wkbSize() );</span></a>
<a name="1592"><span class="lineNum">    1592 </span>                :            : </a>
<a name="1593"><span class="lineNum">    1593 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr6( wkb16 );</span></a>
<a name="1594"><span class="lineNum">    1594 </span>                :<span class="lineCov">          1 :   poly2.fromWkb( wkb16ptr6 );</span></a>
<a name="1595"><span class="lineNum">    1595 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1596"><span class="lineNum">    1596 </span>                :            : </a>
<a name="1597"><span class="lineNum">    1597 </span>                :<span class="lineCov">          1 :   poly1.clear();</span></a>
<a name="1598"><span class="lineNum">    1598 </span>                :<span class="lineCov">          1 :   poly2.clear();</span></a>
<a name="1599"><span class="lineNum">    1599 </span>                :            : </a>
<a name="1600"><span class="lineNum">    1600 </span>                :            :   // bad WKB - check for no crash</a>
<a name="1601"><span class="lineNum">    1601 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="1602"><span class="lineNum">    1602 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.fromWkb( nullPtr ) );</span></a>
<a name="1603"><span class="lineNum">    1603 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1604"><span class="lineNum">    1604 </span>                :            : </a>
<a name="1605"><span class="lineNum">    1605 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="1606"><span class="lineNum">    1606 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="1607"><span class="lineNum">    1607 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="1608"><span class="lineNum">    1608 </span>                :            : </a>
<a name="1609"><span class="lineNum">    1609 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.fromWkb( wkbPointPtr ) );</span></a>
<a name="1610"><span class="lineNum">    1610 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1611"><span class="lineNum">    1611 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1612"><span class="lineNum">    1612 </span>                :            : </a>
<a name="1613"><span class="lineNum">    1613 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testWKT()</span></a>
<a name="1614"><span class="lineNum">    1614 </span>                :            : {</a>
<a name="1615"><span class="lineNum">    1615 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly1;</span></a>
<a name="1616"><span class="lineNum">    1616 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1617"><span class="lineNum">    1617 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1618"><span class="lineNum">    1618 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="1619"><span class="lineNum">    1619 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1620"><span class="lineNum">    1620 </span>                :<span class="lineCov">          1 :   poly1.setExteriorRing( ext );</span></a>
<a name="1621"><span class="lineNum">    1621 </span>                :            : </a>
<a name="1622"><span class="lineNum">    1622 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="1623"><span class="lineNum">    1623 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1624"><span class="lineNum">    1624 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="1625"><span class="lineNum">    1625 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1626"><span class="lineNum">    1626 </span>                :<span class="lineCov">          1 :   poly1.addInteriorRing( ring );</span></a>
<a name="1627"><span class="lineNum">    1627 </span>                :            : </a>
<a name="1628"><span class="lineNum">    1628 </span>                :<span class="lineCov">          1 :   QString wkt = poly1.asWkt();</span></a>
<a name="1629"><span class="lineNum">    1629 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="1630"><span class="lineNum">    1630 </span>                :            : </a>
<a name="1631"><span class="lineNum">    1631 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon poly2;</span></a>
<a name="1632"><span class="lineNum">    1632 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.fromWkt( wkt ) );</span></a>
<a name="1633"><span class="lineNum">    1633 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly1, poly2 );</span></a>
<a name="1634"><span class="lineNum">    1634 </span>                :            : </a>
<a name="1635"><span class="lineNum">    1635 </span>                :            :   // bad WKT</a>
<a name="1636"><span class="lineNum">    1636 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="1637"><span class="lineNum">    1637 </span>                :<span class="lineCov">          1 :   QVERIFY( poly2.isEmpty() );</span></a>
<a name="1638"><span class="lineNum">    1638 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.exteriorRing() );</span></a>
<a name="1639"><span class="lineNum">    1639 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.numInteriorRings(), 0 );</span></a>
<a name="1640"><span class="lineNum">    1640 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.is3D() );</span></a>
<a name="1641"><span class="lineNum">    1641 </span>                :<span class="lineCov">          1 :   QVERIFY( !poly2.isMeasure() );</span></a>
<a name="1642"><span class="lineNum">    1642 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly2.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="1643"><span class="lineNum">    1643 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1644"><span class="lineNum">    1644 </span>                :            : </a>
<a name="1645"><span class="lineNum">    1645 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testExport()</span></a>
<a name="1646"><span class="lineNum">    1646 </span>                :            : {</a>
<a name="1647"><span class="lineNum">    1647 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon exportPolygon;</span></a>
<a name="1648"><span class="lineNum">    1648 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = new QgsCircularString();</span></a>
<a name="1649"><span class="lineNum">    1649 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1650"><span class="lineNum">    1650 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="1651"><span class="lineNum">    1651 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1652"><span class="lineNum">    1652 </span>                :<span class="lineCov">          1 :   exportPolygon.setExteriorRing( ext );</span></a>
<a name="1653"><span class="lineNum">    1653 </span>                :            : </a>
<a name="1654"><span class="lineNum">    1654 </span>                :            :   // GML document for compare</a>
<a name="1655"><span class="lineNum">    1655 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="1656"><span class="lineNum">    1656 </span>                :            : </a>
<a name="1657"><span class="lineNum">    1657 </span>                :            :   // as GML2</a>
<a name="1658"><span class="lineNum">    1658 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 2,0 2,0 2,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.7,0.3 1.7,0.3 1.7,0.3 1.7,0.3 1.7,0.3 1.6,0.3 1.6,0.3 1.6,0.3 1.6,0.4 1.6,0.4 1.6,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.3,0.5 1.3,0.5 1.3,0.5 1.3,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1,0.5 1,0.5 1,0.5 1,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.7,0.5 0.7,0.5 0.7,0.5 0.7,0.5 0.6,0.4 0.6,0.4 0.6,0.4 0.6,0.4 0.6,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.4,0.4 0.4,0.4 0.4,0.4 0.4,0.3 0.4,0.3 0.4,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.1,0.2 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0,0.1 0,0 0,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1659"><span class="lineNum">    1659 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportPolygon.asGml2( doc, 1 ) );</span></a>
<a name="1660"><span class="lineNum">    1660 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="1661"><span class="lineNum">    1661 </span>                :            : </a>
<a name="1662"><span class="lineNum">    1662 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="1663"><span class="lineNum">    1663 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCurvePolygon().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="1664"><span class="lineNum">    1664 </span>                :            : </a>
<a name="1665"><span class="lineNum">    1665 </span>                :            :   // as GML3</a>
<a name="1666"><span class="lineNum">    1666 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1667"><span class="lineNum">    1667 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc, 2 ) );</span></a>
<a name="1668"><span class="lineNum">    1668 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPolygon.asGml3( doc ) ), expectedSimpleGML3 );</span></a>
<a name="1669"><span class="lineNum">    1669 </span>                :            : </a>
<a name="1670"><span class="lineNum">    1670 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="1671"><span class="lineNum">    1671 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCurvePolygon().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="1672"><span class="lineNum">    1672 </span>                :            : </a>
<a name="1673"><span class="lineNum">    1673 </span>                :            :   // as JSON</a>
<a name="1674"><span class="lineNum">    1674 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[1.0,0.0,11.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.2],[1.9,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.7,0.3,12.3],[1.7,0.3,12.3],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,12.9],[0.9,0.5,12.9],[0.9,0.5,12.8],[0.9,0.5,12.7],[0.9,0.5,12.7],[0.9,0.5,12.6],[0.8,0.5,12.6],[0.8,0.5,12.5],[0.8,0.5,12.5],[0.8,0.5,12.4],[0.8,0.5,12.4],[0.7,0.5,12.3],[0.7,0.5,12.2],[0.7,0.5,12.2],[0.7,0.5,12.1],[0.6,0.4,12.1],[0.6,0.4,12.0],[0.6,0.4,12.0],[0.6,0.4,11.9],[0.6,0.4,11.9],[0.5,0.4,11.8],[0.5,0.4,11.7],[0.5,0.4,11.7],[0.5,0.4,11.6],[0.5,0.4,11.6],[0.4,0.4,11.5],[0.4,0.4,11.5],[0.4,0.4,11.4],[0.4,0.3,11.3],[0.4,0.3,11.3],[0.4,0.3,11.2],[0.3,0.3,11.2],[0.3,0.3,11.1],[0.3,0.3,11.1],[0.3,0.3,11.0],[0.3,0.3,11.0],[0.2,0.2,10.9],[0.2,0.2,10.8],[0.2,0.2,10.8],[0.2,0.2,10.7],[0.2,0.2,10.7],[0.2,0.2,10.6],[0.1,0.2,10.6],[0.1,0.1,10.5],[0.1,0.1,10.4],[0.1,0.1,10.4],[0.1,0.1,10.3],[0.1,0.1,10.3],[0.1,0.1,10.2],[0.0,0.1,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="1675"><span class="lineNum">    1675 </span>                :<span class="lineCov">          1 :   res = exportPolygon.asJson( 1 );</span></a>
<a name="1676"><span class="lineNum">    1676 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="1677"><span class="lineNum">    1677 </span>                :            : </a>
<a name="1678"><span class="lineNum">    1678 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="1679"><span class="lineNum">    1679 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1680"><span class="lineNum">    1680 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="1681"><span class="lineNum">    1681 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1682"><span class="lineNum">    1682 </span>                :<span class="lineCov">          1 :   exportPolygon.addInteriorRing( ring );</span></a>
<a name="1683"><span class="lineNum">    1683 </span>                :            : </a>
<a name="1684"><span class="lineNum">    1684 </span>                :            :   // as JSON</a>
<a name="1685"><span class="lineNum">    1685 </span>                :<span class="lineCov">          1 :   QString expectedJson( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[1.0,0.0,11.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.2],[1.9,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.7,0.3,12.3],[1.7,0.3,12.3],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,12.9],[0.9,0.5,12.9],[0.9,0.5,12.8],[0.9,0.5,12.7],[0.9,0.5,12.7],[0.9,0.5,12.6],[0.8,0.5,12.6],[0.8,0.5,12.5],[0.8,0.5,12.5],[0.8,0.5,12.4],[0.8,0.5,12.4],[0.7,0.5,12.3],[0.7,0.5,12.2],[0.7,0.5,12.2],[0.7,0.5,12.1],[0.6,0.4,12.1],[0.6,0.4,12.0],[0.6,0.4,12.0],[0.6,0.4,11.9],[0.6,0.4,11.9],[0.5,0.4,11.8],[0.5,0.4,11.7],[0.5,0.4,11.7],[0.5,0.4,11.6],[0.5,0.4,11.6],[0.4,0.4,11.5],[0.4,0.4,11.5],[0.4,0.4,11.4],[0.4,0.3,11.3],[0.4,0.3,11.3],[0.4,0.3,11.2],[0.3,0.3,11.2],[0.3,0.3,11.1],[0.3,0.3,11.1],[0.3,0.3,11.0],[0.3,0.3,11.0],[0.2,0.2,10.9],[0.2,0.2,10.8],[0.2,0.2,10.8],[0.2,0.2,10.7],[0.2,0.2,10.7],[0.2,0.2,10.6],[0.1,0.2,10.6],[0.1,0.1,10.5],[0.1,0.1,10.4],[0.1,0.1,10.4],[0.1,0.1,10.3],[0.1,0.1,10.3],[0.1,0.1,10.2],[0.0,0.1,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]],[[0.0,0.0,10.0],[0.1,0.0,11.0],[0.2,0.0,12.0],[0.2,0.0,12.0],[0.2,0.0,12.0],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.8],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.5],[0.1,0.0,12.5],[0.1,0.0,12.4],[0.1,0.0,12.4],[0.1,0.0,12.3],[0.1,0.0,12.2],[0.1,0.0,12.2],[0.1,0.0,12.1],[0.1,0.0,12.1],[0.1,0.0,12.0],[0.1,0.0,12.0],[0.1,0.0,11.9],[0.1,0.0,11.9],[0.1,0.0,11.8],[0.1,0.0,11.7],[0.1,0.0,11.7],[0.0,0.0,11.6],[0.0,0.0,11.6],[0.0,0.0,11.5],[0.0,0.0,11.5],[0.0,0.0,11.4],[0.0,0.0,11.3],[0.0,0.0,11.3],[0.0,0.0,11.2],[0.0,0.0,11.2],[0.0,0.0,11.1],[0.0,0.0,11.1],[0.0,0.0,11.0],[0.0,0.0,11.0],[0.0,0.0,10.9],[0.0,0.0,10.8],[0.0,0.0,10.8],[0.0,0.0,10.7],[0.0,0.0,10.7],[0.0,0.0,10.6],[0.0,0.0,10.6],[0.0,0.0,10.5],[0.0,0.0,10.4],[0.0,0.0,10.4],[0.0,0.0,10.3],[0.0,0.0,10.3],[0.0,0.0,10.2],[0.0,0.0,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="1686"><span class="lineNum">    1686 </span>                :<span class="lineCov">          1 :   res = exportPolygon.asJson( 1 );</span></a>
<a name="1687"><span class="lineNum">    1687 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJson );</span></a>
<a name="1688"><span class="lineNum">    1688 </span>                :            : </a>
<a name="1689"><span class="lineNum">    1689 </span>                :            :   // asKML</a>
<a name="1690"><span class="lineNum">    1690 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;absolute&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,10 1,0,11 2,0,12 2,0,12 2,0,12 2,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.2 1.9,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.3 1.8,0.2,12.3 1.8,0.2,12.3 1.7,0.3,12.3 1.7,0.3,12.3 1.7,0.3,12.4 1.7,0.3,12.4 1.7,0.3,12.4 1.6,0.3,12.4 1.6,0.3,12.4 1.6,0.3,12.4 1.6,0.4,12.5 1.6,0.4,12.5 1.6,0.4,12.5 1.5,0.4,12.5 1.5,0.4,12.5 1.5,0.4,12.6 1.5,0.4,12.6 1.5,0.4,12.6 1.4,0.4,12.6 1.4,0.4,12.6 1.4,0.4,12.7 1.4,0.4,12.7 1.4,0.4,12.7 1.3,0.5,12.7 1.3,0.5,12.7 1.3,0.5,12.7 1.3,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,13 1,0.5,13 1,0.5,13 1,0.5,13 1,0.5,12.9 0.9,0.5,12.9 0.9,0.5,12.8 0.9,0.5,12.7 0.9,0.5,12.7 0.9,0.5,12.6 0.8,0.5,12.6 0.8,0.5,12.5 0.8,0.5,12.5 0.8,0.5,12.4 0.8,0.5,12.4 0.7,0.5,12.3 0.7,0.5,12.2 0.7,0.5,12.2 0.7,0.5,12.1 0.6,0.4,12.1 0.6,0.4,12 0.6,0.4,12 0.6,0.4,11.9 0.6,0.4,11.9 0.5,0.4,11.8 0.5,0.4,11.7 0.5,0.4,11.7 0.5,0.4,11.6 0.5,0.4,11.6 0.4,0.4,11.5 0.4,0.4,11.5 0.4,0.4,11.4 0.4,0.3,11.3 0.4,0.3,11.3 0.4,0.3,11.2 0.3,0.3,11.2 0.3,0.3,11.1 0.3,0.3,11.1 0.3,0.3,11 0.3,0.3,11 0.2,0.2,10.9 0.2,0.2,10.8 0.2,0.2,10.8 0.2,0.2,10.7 0.2,0.2,10.7 0.2,0.2,10.6 0.1,0.2,10.6 0.1,0.1,10.5 0.1,0.1,10.4 0.1,0.1,10.4 0.1,0.1,10.3 0.1,0.1,10.3 0.1,0.1,10.2 0,0.1,10.2 0,0,10.1 0,0,10.1 0,0,10&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;absolute&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,10 0.1,0,11 0.2,0,12 0.2,0,12 0.2,0,12 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,13 0.1,0,13 0.1,0,13 0.1,0,13 0.1,0,12.9 0.1,0,12.9 0.1,0,12.8 0.1,0,12.7 0.1,0,12.7 0.1,0,12.6 0.1,0,12.6 0.1,0,12.5 0.1,0,12.5 0.1,0,12.4 0.1,0,12.4 0.1,0,12.3 0.1,0,12.2 0.1,0,12.2 0.1,0,12.1 0.1,0,12.1 0.1,0,12 0.1,0,12 0.1,0,11.9 0.1,0,11.9 0.1,0,11.8 0.1,0,11.7 0.1,0,11.7 0,0,11.6 0,0,11.6 0,0,11.5 0,0,11.5 0,0,11.4 0,0,11.3 0,0,11.3 0,0,11.2 0,0,11.2 0,0,11.1 0,0,11.1 0,0,11 0,0,11 0,0,10.9 0,0,10.8 0,0,10.8 0,0,10.7 0,0,10.7 0,0,10.6 0,0,10.6 0,0,10.5 0,0,10.4 0,0,10.4 0,0,10.3 0,0,10.3 0,0,10.2 0,0,10.2 0,0,10.1 0,0,10.1 0,0,10&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1691"><span class="lineNum">    1691 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygon.asKml( 1 ), expectedKml );</span></a>
<a name="1692"><span class="lineNum">    1692 </span>                :            : </a>
<a name="1693"><span class="lineNum">    1693 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon exportPolygonFloat;</span></a>
<a name="1694"><span class="lineNum">    1694 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="1695"><span class="lineNum">    1695 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1696"><span class="lineNum">    1696 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1 / 3.0, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2 / 3.0, 0, 12, 3 )</span></a>
<a name="1697"><span class="lineNum">    1697 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1 / 3.0, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1698"><span class="lineNum">    1698 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.setExteriorRing( ext );</span></a>
<a name="1699"><span class="lineNum">    1699 </span>                :            : </a>
<a name="1700"><span class="lineNum">    1700 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="1701"><span class="lineNum">    1701 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 )</span></a>
<a name="1702"><span class="lineNum">    1702 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1 / 3.0, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2 / 3.0, 0, 12, 3 )</span></a>
<a name="1703"><span class="lineNum">    1703 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1 / 3.0, 0.05 / 3.0, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="1704"><span class="lineNum">    1704 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.addInteriorRing( ring );</span></a>
<a name="1705"><span class="lineNum">    1705 </span>                :            : </a>
<a name="1706"><span class="lineNum">    1706 </span>                :            :   // as JSON</a>
<a name="1707"><span class="lineNum">    1707 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[0.333,0.0,11.0],[0.667,0.0,12.0],[0.669,0.006,12.009],[0.671,0.012,12.018],[0.673,0.018,12.027],[0.676,0.024,12.035],[0.677,0.029,12.044],[0.679,0.035,12.053],[0.681,0.042,12.062],[0.683,0.048,12.071],[0.684,0.054,12.08],[0.686,0.06,12.088],[0.687,0.066,12.097],[0.688,0.072,12.106],[0.689,0.078,12.115],[0.69,0.084,12.124],[0.691,0.091,12.133],[0.692,0.097,12.142],[0.693,0.103,12.15],[0.693,0.109,12.159],[0.694,0.116,12.168],[0.694,0.122,12.177],[0.694,0.128,12.186],[0.694,0.135,12.195],[0.694,0.141,12.204],[0.694,0.147,12.212],[0.694,0.153,12.221],[0.694,0.16,12.23],[0.693,0.166,12.239],[0.693,0.172,12.248],[0.692,0.178,12.257],[0.692,0.185,12.265],[0.691,0.191,12.274],[0.69,0.197,12.283],[0.689,0.203,12.292],[0.687,0.209,12.301],[0.686,0.216,12.31],[0.685,0.222,12.319],[0.683,0.228,12.327],[0.682,0.234,12.336],[0.68,0.24,12.345],[0.678,0.246,12.354],[0.676,0.252,12.363],[0.674,0.258,12.372],[0.672,0.264,12.381],[0.67,0.27,12.389],[0.668,0.275,12.398],[0.665,0.281,12.407],[0.663,0.287,12.416],[0.66,0.293,12.425],[0.657,0.298,12.434],[0.654,0.304,12.442],[0.652,0.31,12.451],[0.649,0.315,12.46],[0.645,0.321,12.469],[0.642,0.326,12.478],[0.639,0.331,12.487],[0.636,0.337,12.496],[0.632,0.342,12.504],[0.628,0.347,12.513],[0.625,0.352,12.522],[0.621,0.357,12.531],[0.617,0.362,12.54],[0.613,0.367,12.549],[0.609,0.372,12.558],[0.605,0.377,12.566],[0.601,0.381,12.575],[0.597,0.386,12.584],[0.592,0.39,12.593],[0.588,0.395,12.602],[0.584,0.399,12.611],[0.579,0.404,12.619],[0.574,0.408,12.628],[0.57,0.412,12.637],[0.565,0.416,12.646],[0.56,0.42,12.655],[0.555,0.424,12.664],[0.55,0.428,12.673],[0.545,0.431,12.681],[0.54,0.435,12.69],[0.535,0.439,12.699],[0.529,0.442,12.708],[0.524,0.445,12.717],[0.519,0.449,12.726],[0.513,0.452,12.735],[0.508,0.455,12.743],[0.502,0.458,12.752],[0.497,0.461,12.761],[0.491,0.464,12.77],[0.485,0.466,12.779],[0.48,0.469,12.788],[0.474,0.471,12.796],[0.468,0.474,12.805],[0.462,0.476,12.814],[0.456,0.478,12.823],[0.451,0.48,12.832],[0.445,0.482,12.841],[0.439,0.484,12.85],[0.433,0.486,12.858],[0.426,0.488,12.867],[0.42,0.489,12.876],[0.414,0.491,12.885],[0.408,0.492,12.894],[0.402,0.493,12.903],[0.396,0.495,12.912],[0.39,0.496,12.92],[0.383,0.497,12.929],[0.377,0.497,12.938],[0.371,0.498,12.947],[0.365,0.499,12.956],[0.358,0.499,12.965],[0.352,0.5,12.973],[0.346,0.5,12.982],[0.34,0.5,12.991],[0.333,0.5,13.0],[0.327,0.5,12.973],[0.321,0.5,12.947],[0.314,0.5,12.92],[0.308,0.499,12.894],[0.302,0.499,12.867],[0.296,0.498,12.841],[0.289,0.497,12.814],[0.283,0.497,12.788],[0.277,0.496,12.761],[0.271,0.495,12.735],[0.265,0.493,12.708],[0.259,0.492,12.681],[0.252,0.491,12.655],[0.246,0.489,12.628],[0.24,0.488,12.602],[0.234,0.486,12.575],[0.228,0.484,12.549],[0.222,0.482,12.522],[0.216,0.48,12.496],[0.21,0.478,12.469],[0.204,0.476,12.442],[0.198,0.474,12.416],[0.193,0.471,12.389],[0.187,0.469,12.363],[0.181,0.466,12.336],[0.176,0.464,12.31],[0.17,0.461,12.283],[0.164,0.458,12.257],[0.159,0.455,12.23],[0.153,0.452,12.204],[0.148,0.449,12.177],[0.143,0.445,12.15],[0.137,0.442,12.124],[0.132,0.439,12.097],[0.127,0.435,12.071],[0.122,0.431,12.044],[0.117,0.428,12.018],[0.112,0.424,11.991],[0.107,0.42,11.965],[0.102,0.416,11.938],[0.097,0.412,11.912],[0.092,0.408,11.885],[0.088,0.404,11.858],[0.083,0.399,11.832],[0.079,0.395,11.805],[0.074,0.39,11.779],[0.07,0.386,11.752],[0.066,0.381,11.726],[0.061,0.377,11.699],[0.057,0.372,11.673],[0.053,0.367,11.646],[0.049,0.362,11.619],[0.046,0.357,11.593],[0.042,0.352,11.566],[0.038,0.347,11.54],[0.035,0.342,11.513],[0.031,0.337,11.487],[0.028,0.331,11.46],[0.024,0.326,11.434],[0.021,0.321,11.407],[0.018,0.315,11.381],[0.015,0.31,11.354],[0.012,0.304,11.327],[0.009,0.298,11.301],[0.007,0.293,11.274],[0.004,0.287,11.248],[0.001,0.281,11.221],[-0.001,0.275,11.195],[-0.003,0.27,11.168],[-0.005,0.264,11.142],[-0.008,0.258,11.115],[-0.01,0.252,11.088],[-0.012,0.246,11.062],[-0.013,0.24,11.035],[-0.015,0.234,11.009],[-0.017,0.228,10.982],[-0.018,0.222,10.956],[-0.02,0.216,10.929],[-0.021,0.209,10.903],[-0.022,0.203,10.876],[-0.023,0.197,10.85],[-0.024,0.191,10.823],[-0.025,0.185,10.796],[-0.026,0.178,10.77],[-0.026,0.172,10.743],[-0.027,0.166,10.717],[-0.027,0.16,10.69],[-0.027,0.153,10.664],[-0.028,0.147,10.637],[-0.028,0.141,10.611],[-0.028,0.135,10.584],[-0.028,0.128,10.558],[-0.027,0.122,10.531],[-0.027,0.116,10.504],[-0.027,0.109,10.478],[-0.026,0.103,10.451],[-0.025,0.097,10.425],[-0.025,0.091,10.398],[-0.024,0.084,10.372],[-0.023,0.078,10.345],[-0.022,0.072,10.319],[-0.02,0.066,10.292],[-0.019,0.06,10.265],[-0.018,0.054,10.239],[-0.016,0.048,10.212],[-0.014,0.042,10.186],[-0.013,0.035,10.159],[-0.011,0.029,10.133],[-0.009,0.024,10.106],[-0.007,0.018,10.08],[-0.005,0.012,10.053],[-0.002,0.006,10.027],[0.0,0.0,10.0]],[[0.0,0.0,10.0],[0.033,0.0,11.0],[0.067,0.0,12.0],[0.066,0.001,12.019],[0.066,0.001,12.037],[0.065,0.002,12.056],[0.065,0.002,12.075],[0.064,0.003,12.093],[0.064,0.003,12.112],[0.063,0.004,12.131],[0.063,0.004,12.15],[0.062,0.005,12.168],[0.062,0.005,12.187],[0.061,0.006,12.206],[0.061,0.006,12.224],[0.06,0.007,12.243],[0.06,0.007,12.262],[0.059,0.008,12.28],[0.059,0.008,12.299],[0.058,0.009,12.318],[0.057,0.009,12.336],[0.057,0.009,12.355],[0.056,0.01,12.374],[0.056,0.01,12.393],[0.055,0.011,12.411],[0.054,0.011,12.43],[0.054,0.011,12.449],[0.053,0.012,12.467],[0.052,0.012,12.486],[0.052,0.012,12.505],[0.051,0.013,12.523],[0.051,0.013,12.542],[0.05,0.013,12.561],[0.049,0.014,12.579],[0.049,0.014,12.598],[0.048,0.014,12.617],[0.047,0.014,12.636],[0.046,0.015,12.654],[0.046,0.015,12.673],[0.045,0.015,12.692],[0.044,0.015,12.71],[0.044,0.015,12.729],[0.043,0.016,12.748],[0.042,0.016,12.766],[0.042,0.016,12.785],[0.041,0.016,12.804],[0.04,0.016,12.822],[0.039,0.016,12.841],[0.039,0.016,12.86],[0.038,0.016,12.879],[0.037,0.016,12.897],[0.037,0.017,12.916],[0.036,0.017,12.935],[0.035,0.017,12.953],[0.034,0.017,12.972],[0.034,0.017,12.991],[0.033,0.017,12.972],[0.032,0.017,12.916],[0.032,0.017,12.86],[0.031,0.017,12.804],[0.03,0.017,12.748],[0.029,0.016,12.692],[0.029,0.016,12.636],[0.028,0.016,12.579],[0.027,0.016,12.523],[0.027,0.016,12.467],[0.026,0.016,12.411],[0.025,0.016,12.355],[0.024,0.016,12.299],[0.024,0.016,12.243],[0.023,0.015,12.187],[0.022,0.015,12.131],[0.022,0.015,12.075],[0.021,0.015,12.019],[0.02,0.015,11.963],[0.02,0.014,11.907],[0.019,0.014,11.85],[0.018,0.014,11.794],[0.017,0.014,11.738],[0.017,0.013,11.682],[0.016,0.013,11.626],[0.016,0.013,11.57],[0.015,0.012,11.514],[0.014,0.012,11.458],[0.014,0.012,11.402],[0.013,0.011,11.346],[0.012,0.011,11.29],[0.012,0.011,11.234],[0.011,0.01,11.178],[0.01,0.01,11.121],[0.01,0.009,11.065],[0.009,0.009,11.009],[0.009,0.009,10.953],[0.008,0.008,10.897],[0.008,0.008,10.841],[0.007,0.007,10.785],[0.006,0.007,10.729],[0.006,0.006,10.673],[0.005,0.006,10.617],[0.005,0.005,10.561],[0.004,0.005,10.505],[0.004,0.004,10.449],[0.003,0.004,10.393],[0.003,0.003,10.336],[0.002,0.003,10.28],[0.002,0.002,10.224],[0.001,0.002,10.168],[0.001,0.001,10.112],[0.0,0.001,10.056],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="1708"><span class="lineNum">    1708 </span>                :<span class="lineCov">          1 :   res = exportPolygonFloat.asJson( 3 );</span></a>
<a name="1709"><span class="lineNum">    1709 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygonFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="1710"><span class="lineNum">    1710 </span>                :            : </a>
<a name="1711"><span class="lineNum">    1711 </span>                :            :   // as GML2</a>
<a name="1712"><span class="lineNum">    1712 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 1.98685,0.01722 1.97341,0.03421 1.95967,0.05096 1.94564,0.06747 1.93133,0.08374 1.91674,0.09976 1.90188,0.11552 1.88674,0.13102 1.87134,0.14625 1.85567,0.16122 1.83975,0.17592 1.82358,0.19033 1.80716,0.20446 1.79049,0.21831 1.77359,0.23186 1.75646,0.24512 1.7391,0.25809 1.72151,0.27074 1.70371,0.2831 1.6857,0.29514 1.66748,0.30687 1.64907,0.31828 1.63045,0.32936 1.61165,0.34013 1.59267,0.35057 1.5735,0.36067 1.55417,0.37045 1.53466,0.37988 1.515,0.38898 1.49518,0.39773 1.47522,0.40614 1.45511,0.41421 1.43486,0.42192 1.41448,0.42928 1.39398,0.43629 1.37336,0.44294 1.35263,0.44923 1.33179,0.45516 1.31086,0.46073 1.28983,0.46594 1.26871,0.47078 1.24751,0.47525 1.22624,0.47936 1.2049,0.48309 1.18349,0.48646 1.16204,0.48945 1.14053,0.49208 1.11898,0.49432 1.0974,0.4962 1.07578,0.4977 1.05415,0.49883 1.0325,0.49958 1.01083,0.49995 0.98917,0.49995 0.9675,0.49958 0.94585,0.49883 0.92422,0.4977 0.9026,0.4962 0.88102,0.49432 0.85947,0.49208 0.83796,0.48945 0.81651,0.48646 0.7951,0.48309 0.77376,0.47936 0.75249,0.47525 0.73129,0.47078 0.71017,0.46594 0.68914,0.46073 0.66821,0.45516 0.64737,0.44923 0.62664,0.44294 0.60602,0.43629 0.58552,0.42928 0.56514,0.42192 0.54489,0.41421 0.52478,0.40614 0.50482,0.39773 0.485,0.38898 0.46534,0.37988 0.44583,0.37045 0.4265,0.36067 0.40733,0.35057 0.38835,0.34013 0.36955,0.32936 0.35093,0.31828 0.33252,0.30687 0.3143,0.29514 0.29629,0.2831 0.27849,0.27074 0.2609,0.25809 0.24354,0.24512 0.22641,0.23186 0.20951,0.21831 0.19284,0.20446 0.17642,0.19033 0.16025,0.17592 0.14433,0.16122 0.12866,0.14625 0.11326,0.13102 0.09812,0.11552 0.08326,0.09976 0.06867,0.08374 0.05436,0.06747 0.04033,0.05096 0.02659,0.03421 0.01315,0.01722 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0.1,0 0.2,0 0.19869,0.00172 0.19734,0.00342 0.19597,0.0051 0.19456,0.00675 0.19313,0.00837 0.19167,0.00998 0.19019,0.01155 0.18867,0.0131 0.18713,0.01463 0.18557,0.01612 0.18398,0.01759 0.18236,0.01903 0.18072,0.02045 0.17905,0.02183 0.17736,0.02319 0.17565,0.02451 0.17391,0.02581 0.17215,0.02707 0.17037,0.02831 0.16857,0.02951 0.16675,0.03069 0.16491,0.03183 0.16305,0.03294 0.16117,0.03401 0.15927,0.03506 0.15735,0.03607 0.15542,0.03704 0.15347,0.03799 0.1515,0.0389 0.14952,0.03977 0.14752,0.04061 0.14551,0.04142 0.14349,0.04219 0.14145,0.04293 0.1394,0.04363 0.13734,0.04429 0.13526,0.04492 0.13318,0.04552 0.13109,0.04607 0.12898,0.04659 0.12687,0.04708 0.12475,0.04753 0.12262,0.04794 0.12049,0.04831 0.11835,0.04865 0.1162,0.04895 0.11405,0.04921 0.1119,0.04943 0.10974,0.04962 0.10758,0.04977 0.10541,0.04988 0.10325,0.04996 0.10108,0.05 0.09892,0.05 0.09675,0.04996 0.09459,0.04988 0.09242,0.04977 0.09026,0.04962 0.0881,0.04943 0.08595,0.04921 0.0838,0.04895 0.08165,0.04865 0.07951,0.04831 0.07738,0.04794 0.07525,0.04753 0.07313,0.04708 0.07102,0.04659 0.06891,0.04607 0.06682,0.04552 0.06474,0.04492 0.06266,0.04429 0.0606,0.04363 0.05855,0.04293 0.05651,0.04219 0.05449,0.04142 0.05248,0.04061 0.05048,0.03977 0.0485,0.0389 0.04653,0.03799 0.04458,0.03704 0.04265,0.03607 0.04073,0.03506 0.03883,0.03401 0.03695,0.03294 0.03509,0.03183 0.03325,0.03069 0.03143,0.02951 0.02963,0.02831 0.02785,0.02707 0.02609,0.02581 0.02435,0.02451 0.02264,0.02319 0.02095,0.02183 0.01928,0.02045 0.01764,0.01903 0.01602,0.01759 0.01443,0.01612 0.01287,0.01463 0.01133,0.0131 0.00981,0.01155 0.00833,0.00998 0.00687,0.00837 0.00544,0.00675 0.00403,0.0051 0.00266,0.00342 0.00131,0.00172 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1713"><span class="lineNum">    1713 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml2( doc, 5 ) );</span></a>
<a name="1714"><span class="lineNum">    1714 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2 );</span></a>
<a name="1715"><span class="lineNum">    1715 </span>                :            : </a>
<a name="1716"><span class="lineNum">    1716 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 1.99,0.02 1.97,0.03 1.96,0.05 1.95,0.07 1.93,0.08 1.92,0.1 1.9,0.12 1.89,0.13 1.87,0.15 1.86,0.16 1.84,0.18 1.82,0.19 1.81,0.2 1.79,0.22 1.77,0.23 1.76,0.25 1.74,0.26 1.72,0.27 1.7,0.28 1.69,0.3 1.67,0.31 1.65,0.32 1.63,0.33 1.61,0.34 1.59,0.35 1.57,0.36 1.55,0.37 1.53,0.38 1.52,0.39 1.5,0.4 1.48,0.41 1.46,0.41 1.43,0.42 1.41,0.43 1.39,0.44 1.37,0.44 1.35,0.45 1.33,0.46 1.31,0.46 1.29,0.47 1.27,0.47 1.25,0.48 1.23,0.48 1.2,0.48 1.18,0.49 1.16,0.49 1.14,0.49 1.12,0.49 1.1,0.5 1.08,0.5 1.05,0.5 1.03,0.5 1.01,0.5 0.99,0.5 0.97,0.5 0.95,0.5 0.92,0.5 0.9,0.5 0.88,0.49 0.86,0.49 0.84,0.49 0.82,0.49 0.8,0.48 0.77,0.48 0.75,0.48 0.73,0.47 0.71,0.47 0.69,0.46 0.67,0.46 0.65,0.45 0.63,0.44 0.61,0.44 0.59,0.43 0.57,0.42 0.54,0.41 0.52,0.41 0.5,0.4 0.48,0.39 0.47,0.38 0.45,0.37 0.43,0.36 0.41,0.35 0.39,0.34 0.37,0.33 0.35,0.32 0.33,0.31 0.31,0.3 0.3,0.28 0.28,0.27 0.26,0.26 0.24,0.25 0.23,0.23 0.21,0.22 0.19,0.2 0.18,0.19 0.16,0.18 0.14,0.16 0.13,0.15 0.11,0.13 0.1,0.12 0.08,0.1 0.07,0.08 0.05,0.07 0.04,0.05 0.03,0.03 0.01,0.02 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0.1,0 0.2,0 0.2,0 0.2,0 0.2,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.17,0.03 0.17,0.03 0.17,0.03 0.17,0.03 0.17,0.03 0.16,0.03 0.16,0.03 0.16,0.03 0.16,0.04 0.16,0.04 0.16,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.13,0.05 0.13,0.05 0.13,0.05 0.13,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.1,0.05 0.1,0.05 0.1,0.05 0.1,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.07,0.05 0.07,0.05 0.07,0.05 0.07,0.05 0.06,0.04 0.06,0.04 0.06,0.04 0.06,0.04 0.06,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.04,0.04 0.04,0.04 0.04,0.04 0.04,0.03 0.04,0.03 0.04,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.01,0.02 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0,0.01 0,0 0,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1717"><span class="lineNum">    1717 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml2( doc, 2 ) );</span></a>
<a name="1718"><span class="lineNum">    1718 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec2 );</span></a>
<a name="1719"><span class="lineNum">    1719 </span>                :            : </a>
<a name="1720"><span class="lineNum">    1720 </span>                :            :   // as GML3</a>
<a name="1721"><span class="lineNum">    1721 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 0.10000000000000001 0 11 0.20000000000000001 0 12 0.10000000000000001 0.05 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1722"><span class="lineNum">    1722 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc ) );</span></a>
<a name="1723"><span class="lineNum">    1723 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3 );</span></a>
<a name="1724"><span class="lineNum">    1724 </span>                :            : </a>
<a name="1725"><span class="lineNum">    1725 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 0.1 0 11 0.2 0 12 0.1 0.05 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="1726"><span class="lineNum">    1726 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc, 3 ) );</span></a>
<a name="1727"><span class="lineNum">    1727 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="1728"><span class="lineNum">    1728 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1729"><span class="lineNum">    1729 </span>                :            : </a>
<a name="1730"><span class="lineNum">    1730 </span>                :<span class="lineCov">          1 : void TestQgsCurvePolygon::testCast()</span></a>
<a name="1731"><span class="lineNum">    1731 </span>                :            : {</a>
<a name="1732"><span class="lineNum">    1732 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsCurvePolygon().cast( nullptr ) );</span></a>
<a name="1733"><span class="lineNum">    1733 </span>                :            : </a>
<a name="1734"><span class="lineNum">    1734 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon pCast;</span></a>
<a name="1735"><span class="lineNum">    1735 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast ) );</span></a>
<a name="1736"><span class="lineNum">    1736 </span>                :            : </a>
<a name="1737"><span class="lineNum">    1737 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon pCast2;</span></a>
<a name="1738"><span class="lineNum">    1738 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonZ((0 0 0, 0 1 1, 1 0 2, 0 0 0))&quot; ) );</span></a>
<a name="1739"><span class="lineNum">    1739 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="1740"><span class="lineNum">    1740 </span>                :            : </a>
<a name="1741"><span class="lineNum">    1741 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonM((0 0 1, 0 1 2, 1 0 3, 0 0 1))&quot; ) );</span></a>
<a name="1742"><span class="lineNum">    1742 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="1743"><span class="lineNum">    1743 </span>                :            : </a>
<a name="1744"><span class="lineNum">    1744 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonZM((0 0 0 1, 0 1 1 2, 1 0 2 3, 0 0 0 1))&quot; ) );</span></a>
<a name="1745"><span class="lineNum">    1745 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="1746"><span class="lineNum">    1746 </span>                :            : </a>
<a name="1747"><span class="lineNum">    1747 </span>                :<span class="lineCov">          2 :   QVERIFY( !pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonZ((111111))&quot; ) ) );</span></a>
<a name="1748"><span class="lineNum">    1748 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1749"><span class="lineNum">    1749 </span>                :            : </a>
<a name="1750"><span class="lineNum">    1750 </span>                :            : </a>
<a name="1751"><span class="lineNum">    1751 </span>                :<span class="lineCov">          1 : QGSTEST_MAIN( TestQgsCurvePolygon )</span></a>
<a name="1752"><span class="lineNum">    1752 </span>                :            : #include &quot;testqgscurvepolygon.moc&quot;</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.15</a></td></tr>
  </table>
  <br>

</body>
</html>
