<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info.cleaned - core/providers/gdal/qgsgdalprovider.h</title>
  <link rel="stylesheet" type="text/css" href="../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../index.html">top level</a> - <a href="index.html">core/providers/gdal</a> - qgsgdalprovider.h<span style="font-size: 80%;"> (source / <a href="qgsgdalprovider.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info.cleaned</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntry">2</td>
            <td class="headerCovTableEntryLo">50.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-03-26 12:19:53</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /***************************************************************************</a>
<a name="2"><span class="lineNum">       2 </span>                :            :       qgsgdalprovider.h  -  QGIS Data provider for</a>
<a name="3"><span class="lineNum">       3 </span>                :            :                            GDAL rasters</a>
<a name="4"><span class="lineNum">       4 </span>                :            :                              -------------------</a>
<a name="5"><span class="lineNum">       5 </span>                :            :     begin                : November, 2010</a>
<a name="6"><span class="lineNum">       6 </span>                :            :     copyright            : (C) 2010 by Radim Blazek</a>
<a name="7"><span class="lineNum">       7 </span>                :            :     email                : radim dot blazek at gmail dot com</a>
<a name="8"><span class="lineNum">       8 </span>                :            :  ***************************************************************************/</a>
<a name="9"><span class="lineNum">       9 </span>                :            : </a>
<a name="10"><span class="lineNum">      10 </span>                :            : /***************************************************************************</a>
<a name="11"><span class="lineNum">      11 </span>                :            :  *                                                                         *</a>
<a name="12"><span class="lineNum">      12 </span>                :            :  *   This program is free software; you can redistribute it and/or modify  *</a>
<a name="13"><span class="lineNum">      13 </span>                :            :  *   it under the terms of the GNU General Public License as published by  *</a>
<a name="14"><span class="lineNum">      14 </span>                :            :  *   the Free Software Foundation; either version 2 of the License, or     *</a>
<a name="15"><span class="lineNum">      15 </span>                :            :  *   (at your option) any later version.                                   *</a>
<a name="16"><span class="lineNum">      16 </span>                :            :  *                                                                         *</a>
<a name="17"><span class="lineNum">      17 </span>                :            :  ***************************************************************************/</a>
<a name="18"><span class="lineNum">      18 </span>                :            : </a>
<a name="19"><span class="lineNum">      19 </span>                :            : #ifndef QGSGDALPROVIDER_H</a>
<a name="20"><span class="lineNum">      20 </span>                :            : #define QGSGDALPROVIDER_H</a>
<a name="21"><span class="lineNum">      21 </span>                :            : </a>
<a name="22"><span class="lineNum">      22 </span>                :            : #include &quot;qgscoordinatereferencesystem.h&quot;</a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &quot;qgsdataitem.h&quot;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &quot;qgsrasterdataprovider.h&quot;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : #include &quot;qgsgdalproviderbase.h&quot;</a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &quot;qgsrectangle.h&quot;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &quot;qgscolorrampshader.h&quot;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : #include &quot;qgsrasterbandstats.h&quot;</a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &quot;qgsprovidermetadata.h&quot;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : </a>
<a name="31"><span class="lineNum">      31 </span>                :            : #include &lt;QString&gt;</a>
<a name="32"><span class="lineNum">      32 </span>                :            : #include &lt;QStringList&gt;</a>
<a name="33"><span class="lineNum">      33 </span>                :            : #include &lt;QDomElement&gt;</a>
<a name="34"><span class="lineNum">      34 </span>                :            : #include &lt;QMap&gt;</a>
<a name="35"><span class="lineNum">      35 </span>                :            : #include &lt;QVector&gt;</a>
<a name="36"><span class="lineNum">      36 </span>                :            : </a>
<a name="37"><span class="lineNum">      37 </span>                :            : #include &quot;qgis_sip.h&quot;</a>
<a name="38"><span class="lineNum">      38 </span>                :            : </a>
<a name="39"><span class="lineNum">      39 </span>                :            : ///@cond PRIVATE</a>
<a name="40"><span class="lineNum">      40 </span>                :            : #define SIP_NO_FILE</a>
<a name="41"><span class="lineNum">      41 </span>                :            : </a>
<a name="42"><span class="lineNum">      42 </span>                :            : class QMutex;</a>
<a name="43"><span class="lineNum">      43 </span>                :            : </a>
<a name="44"><span class="lineNum">      44 </span>                :            : class QgsRasterPyramid;</a>
<a name="45"><span class="lineNum">      45 </span>                :            : </a>
<a name="46"><span class="lineNum">      46 </span>                :            : /**</a>
<a name="47"><span class="lineNum">      47 </span>                :            :  * \ingroup core</a>
<a name="48"><span class="lineNum">      48 </span>                :            :  * \brief A call back function for showing progress of gdal operations.</a>
<a name="49"><span class="lineNum">      49 </span>                :            :  */</a>
<a name="50"><span class="lineNum">      50 </span>                :            : int CPL_STDCALL progressCallback( double dfComplete,</a>
<a name="51"><span class="lineNum">      51 </span>                :            :                                   const char *pszMessage,</a>
<a name="52"><span class="lineNum">      52 </span>                :            :                                   void *pProgressArg );</a>
<a name="53"><span class="lineNum">      53 </span>                :            : </a>
<a name="54"><span class="lineNum">      54 </span>                :            : </a>
<a name="55"><span class="lineNum">      55 </span>                :            : class QgsCoordinateTransform;</a>
<a name="56"><span class="lineNum">      56 </span>                :            : </a>
<a name="57"><span class="lineNum">      57 </span>                :            : /**</a>
<a name="58"><span class="lineNum">      58 </span>                :            :  *</a>
<a name="59"><span class="lineNum">      59 </span>                :            :  * \brief Data provider for GDAL layers.</a>
<a name="60"><span class="lineNum">      60 </span>                :            :  *</a>
<a name="61"><span class="lineNum">      61 </span>                :            :  * This provider implements the interface defined in the QgsDataProvider class</a>
<a name="62"><span class="lineNum">      62 </span>                :            :  * to provide access to spatial data residing in a GDAL layers.</a>
<a name="63"><span class="lineNum">      63 </span>                :            :  *</a>
<a name="64"><span class="lineNum">      64 </span>                :            : */</a>
<a name="65"><span class="lineNum">      65 </span>                :            : class QgsGdalProvider final: public QgsRasterDataProvider, QgsGdalProviderBase</a>
<a name="66"><span class="lineNum">      66 </span>                :            : {</a>
<a name="67"><span class="lineNum">      67 </span>                :<span class="lineNoCov">          0 :     Q_OBJECT</span></a>
<a name="68"><span class="lineNum">      68 </span>                :            : </a>
<a name="69"><span class="lineNum">      69 </span>                :            :   public:</a>
<a name="70"><span class="lineNum">      70 </span>                :            : </a>
<a name="71"><span class="lineNum">      71 </span>                :            :     /**</a>
<a name="72"><span class="lineNum">      72 </span>                :            :      * Constructor for the provider.</a>
<a name="73"><span class="lineNum">      73 </span>                :            :      *</a>
<a name="74"><span class="lineNum">      74 </span>                :            :      * \param   uri         file name</a>
<a name="75"><span class="lineNum">      75 </span>                :            :      * \param   update      whether to open in update mode</a>
<a name="76"><span class="lineNum">      76 </span>                :            :      * \param   newDataset  handle of newly created dataset.</a>
<a name="77"><span class="lineNum">      77 </span>                :            :      *</a>
<a name="78"><span class="lineNum">      78 </span>                :            :      */</a>
<a name="79"><span class="lineNum">      79 </span>                :            :     QgsGdalProvider( const QString &amp;uri, const QgsDataProvider::ProviderOptions &amp;providerOptions, bool update = false, GDALDatasetH newDataset = nullptr );</a>
<a name="80"><span class="lineNum">      80 </span>                :            : </a>
<a name="81"><span class="lineNum">      81 </span>                :            :     //! Create invalid provider with error</a>
<a name="82"><span class="lineNum">      82 </span>                :            :     QgsGdalProvider( const QString &amp;uri, const QgsError &amp;error );</a>
<a name="83"><span class="lineNum">      83 </span>                :            : </a>
<a name="84"><span class="lineNum">      84 </span>                :            :     ~QgsGdalProvider() override;</a>
<a name="85"><span class="lineNum">      85 </span>                :            : </a>
<a name="86"><span class="lineNum">      86 </span>                :            :     /**</a>
<a name="87"><span class="lineNum">      87 </span>                :            :      * Gets the data source specification. This may be a path or a protocol</a>
<a name="88"><span class="lineNum">      88 </span>                :            :      * connection string</a>
<a name="89"><span class="lineNum">      89 </span>                :            :      * \param expandAuthConfig Whether to expand any assigned authentication configuration</a>
<a name="90"><span class="lineNum">      90 </span>                :            :      * \returns data source specification</a>
<a name="91"><span class="lineNum">      91 </span>                :            :      * \note The default authentication configuration expansion is FALSE. This keeps credentials</a>
<a name="92"><span class="lineNum">      92 </span>                :            :      * out of layer data source URIs and project files. Expansion should be specifically done</a>
<a name="93"><span class="lineNum">      93 </span>                :            :      * only when needed within a provider</a>
<a name="94"><span class="lineNum">      94 </span>                :            :      */</a>
<a name="95"><span class="lineNum">      95 </span>                :            :     QString dataSourceUri( bool expandAuthConfig = false ) const override;</a>
<a name="96"><span class="lineNum">      96 </span>                :            : </a>
<a name="97"><span class="lineNum">      97 </span>                :            :     /**</a>
<a name="98"><span class="lineNum">      98 </span>                :            :      * Clone the provider.</a>
<a name="99"><span class="lineNum">      99 </span>                :            :      *</a>
<a name="100"><span class="lineNum">     100 </span>                :            :      * The underlying GDAL dataset is shared among the main provider and its</a>
<a name="101"><span class="lineNum">     101 </span>                :            :      * clones.</a>
<a name="102"><span class="lineNum">     102 </span>                :            :      */</a>
<a name="103"><span class="lineNum">     103 </span>                :            :     QgsGdalProvider *clone() const override;</a>
<a name="104"><span class="lineNum">     104 </span>                :            : </a>
<a name="105"><span class="lineNum">     105 </span>                :            :     QString name() const override;</a>
<a name="106"><span class="lineNum">     106 </span>                :            : </a>
<a name="107"><span class="lineNum">     107 </span>                :            :     /**</a>
<a name="108"><span class="lineNum">     108 </span>                :            :      * GDAL data provider key</a>
<a name="109"><span class="lineNum">     109 </span>                :            :      * \since QGIS 3.10</a>
<a name="110"><span class="lineNum">     110 </span>                :            :      */</a>
<a name="111"><span class="lineNum">     111 </span>                :            :     static QString providerKey();</a>
<a name="112"><span class="lineNum">     112 </span>                :            : </a>
<a name="113"><span class="lineNum">     113 </span>                :            :     /**</a>
<a name="114"><span class="lineNum">     114 </span>                :            :      * This helper checks to see whether the file name appears to be a valid</a>
<a name="115"><span class="lineNum">     115 </span>                :            :      * raster file name.  If the file name looks like it could be valid,</a>
<a name="116"><span class="lineNum">     116 </span>                :            :      * but some sort of error occurs in processing the file, the error is</a>
<a name="117"><span class="lineNum">     117 </span>                :            :      * returned in \a retErrMsg.</a>
<a name="118"><span class="lineNum">     118 </span>                :            :      * \since QGIS 3.10</a>
<a name="119"><span class="lineNum">     119 </span>                :            :      */</a>
<a name="120"><span class="lineNum">     120 </span>                :            :     static bool isValidRasterFileName( QString const &amp;fileNameQString, QString &amp;retErrMsg );</a>
<a name="121"><span class="lineNum">     121 </span>                :            : </a>
<a name="122"><span class="lineNum">     122 </span>                :            :     /**</a>
<a name="123"><span class="lineNum">     123 </span>                :            :      * Gets creation options metadata for a given format</a>
<a name="124"><span class="lineNum">     124 </span>                :            :      * \since QGIS 3.10</a>
<a name="125"><span class="lineNum">     125 </span>                :            :      */</a>
<a name="126"><span class="lineNum">     126 </span>                :            :     static QString helpCreationOptionsFormat( QString format );</a>
<a name="127"><span class="lineNum">     127 </span>                :            : </a>
<a name="128"><span class="lineNum">     128 </span>                :            :     QString description() const override;</a>
<a name="129"><span class="lineNum">     129 </span>                :            :     QgsRasterDataProvider::ProviderCapabilities providerCapabilities() const override;</a>
<a name="130"><span class="lineNum">     130 </span>                :            :     QgsCoordinateReferenceSystem crs() const override;</a>
<a name="131"><span class="lineNum">     131 </span>                :            :     QgsRectangle extent() const override;</a>
<a name="132"><span class="lineNum">     132 </span>                :            :     bool isValid() const override;</a>
<a name="133"><span class="lineNum">     133 </span>                :            :     QgsRasterIdentifyResult identify( const QgsPointXY &amp;point, QgsRaster::IdentifyFormat format, const QgsRectangle &amp;boundingBox = QgsRectangle(), int width = 0, int height = 0, int dpi = 96 ) override;</a>
<a name="134"><span class="lineNum">     134 </span>                :            :     double sample( const QgsPointXY &amp;point, int band, bool *ok = nullptr, const QgsRectangle &amp;boundingBox = QgsRectangle(), int width = 0, int height = 0, int dpi = 96 ) override;</a>
<a name="135"><span class="lineNum">     135 </span>                :            :     QString lastErrorTitle() override;</a>
<a name="136"><span class="lineNum">     136 </span>                :            :     QString lastError() override;</a>
<a name="137"><span class="lineNum">     137 </span>                :            :     int capabilities() const override;</a>
<a name="138"><span class="lineNum">     138 </span>                :            :     Qgis::DataType dataType( int bandNo ) const override;</a>
<a name="139"><span class="lineNum">     139 </span>                :            :     Qgis::DataType sourceDataType( int bandNo ) const override;</a>
<a name="140"><span class="lineNum">     140 </span>                :            :     int bandCount() const override;</a>
<a name="141"><span class="lineNum">     141 </span>                :            :     int colorInterpretation( int bandNo ) const override;</a>
<a name="142"><span class="lineNum">     142 </span>                :            :     int xBlockSize() const override;</a>
<a name="143"><span class="lineNum">     143 </span>                :            :     int yBlockSize() const override;</a>
<a name="144"><span class="lineNum">     144 </span>                :            :     int xSize() const override;</a>
<a name="145"><span class="lineNum">     145 </span>                :            :     int ySize() const override;</a>
<a name="146"><span class="lineNum">     146 </span>                :            :     QString generateBandName( int bandNumber ) const override;</a>
<a name="147"><span class="lineNum">     147 </span>                :            : </a>
<a name="148"><span class="lineNum">     148 </span>                :            :     // Reimplemented from QgsRasterDataProvider to bypass second resampling (more efficient for local file based sources)</a>
<a name="149"><span class="lineNum">     149 </span>                :            :     QgsRasterBlock *block( int bandNo, const QgsRectangle &amp;extent, int width, int height, QgsRasterBlockFeedback *feedback = nullptr ) override;</a>
<a name="150"><span class="lineNum">     150 </span>                :            : </a>
<a name="151"><span class="lineNum">     151 </span>                :            :     bool readBlock( int bandNo, int xBlock, int yBlock, void *data ) override;</a>
<a name="152"><span class="lineNum">     152 </span>                :            :     bool readBlock( int bandNo, QgsRectangle  const &amp;viewExtent, int width, int height, void *data, QgsRasterBlockFeedback *feedback = nullptr ) override;</a>
<a name="153"><span class="lineNum">     153 </span>                :            : </a>
<a name="154"><span class="lineNum">     154 </span>                :            :     double bandScale( int bandNo ) const override;</a>
<a name="155"><span class="lineNum">     155 </span>                :            :     double bandOffset( int bandNo ) const override;</a>
<a name="156"><span class="lineNum">     156 </span>                :            :     QList&lt;QgsColorRampShader::ColorRampItem&gt; colorTable( int bandNo )const override;</a>
<a name="157"><span class="lineNum">     157 </span>                :            :     QString htmlMetadata() override;</a>
<a name="158"><span class="lineNum">     158 </span>                :            :     QStringList subLayers() const override;</a>
<a name="159"><span class="lineNum">     159 </span>                :            :     static QStringList subLayers( GDALDatasetH dataset );</a>
<a name="160"><span class="lineNum">     160 </span>                :            : </a>
<a name="161"><span class="lineNum">     161 </span>                :            :     bool hasStatistics( int bandNo,</a>
<a name="162"><span class="lineNum">     162 </span>                :            :                         int stats = QgsRasterBandStats::All,</a>
<a name="163"><span class="lineNum">     163 </span>                :            :                         const QgsRectangle &amp;boundingBox = QgsRectangle(),</a>
<a name="164"><span class="lineNum">     164 </span>                :            :                         int sampleSize = 0 ) override;</a>
<a name="165"><span class="lineNum">     165 </span>                :            : </a>
<a name="166"><span class="lineNum">     166 </span>                :            :     QgsRasterBandStats bandStatistics( int bandNo,</a>
<a name="167"><span class="lineNum">     167 </span>                :            :                                        int stats = QgsRasterBandStats::All,</a>
<a name="168"><span class="lineNum">     168 </span>                :            :                                        const QgsRectangle &amp;boundingBox = QgsRectangle(),</a>
<a name="169"><span class="lineNum">     169 </span>                :            :                                        int sampleSize = 0, QgsRasterBlockFeedback *feedback = nullptr ) override;</a>
<a name="170"><span class="lineNum">     170 </span>                :            : </a>
<a name="171"><span class="lineNum">     171 </span>                :            :     bool hasHistogram( int bandNo,</a>
<a name="172"><span class="lineNum">     172 </span>                :            :                        int binCount = 0,</a>
<a name="173"><span class="lineNum">     173 </span>                :            :                        double minimum = std::numeric_limits&lt;double&gt;::quiet_NaN(),</a>
<a name="174"><span class="lineNum">     174 </span>                :            :                        double maximum = std::numeric_limits&lt;double&gt;::quiet_NaN(),</a>
<a name="175"><span class="lineNum">     175 </span>                :            :                        const QgsRectangle &amp;boundingBox = QgsRectangle(),</a>
<a name="176"><span class="lineNum">     176 </span>                :            :                        int sampleSize = 0,</a>
<a name="177"><span class="lineNum">     177 </span>                :            :                        bool includeOutOfRange = false ) override;</a>
<a name="178"><span class="lineNum">     178 </span>                :            : </a>
<a name="179"><span class="lineNum">     179 </span>                :            :     QgsRasterHistogram histogram( int bandNo,</a>
<a name="180"><span class="lineNum">     180 </span>                :            :                                   int binCount = 0,</a>
<a name="181"><span class="lineNum">     181 </span>                :            :                                   double minimum = std::numeric_limits&lt;double&gt;::quiet_NaN(),</a>
<a name="182"><span class="lineNum">     182 </span>                :            :                                   double maximum = std::numeric_limits&lt;double&gt;::quiet_NaN(),</a>
<a name="183"><span class="lineNum">     183 </span>                :            :                                   const QgsRectangle &amp;boundingBox = QgsRectangle(),</a>
<a name="184"><span class="lineNum">     184 </span>                :            :                                   int sampleSize = 0,</a>
<a name="185"><span class="lineNum">     185 </span>                :            :                                   bool includeOutOfRange = false, QgsRasterBlockFeedback *feedback = nullptr ) override;</a>
<a name="186"><span class="lineNum">     186 </span>                :            : </a>
<a name="187"><span class="lineNum">     187 </span>                :            :     QString buildPyramids( const QList&lt;QgsRasterPyramid&gt; &amp;rasterPyramidList,</a>
<a name="188"><span class="lineNum">     188 </span>                :            :                            const QString &amp;resamplingMethod = &quot;NEAREST&quot;,</a>
<a name="189"><span class="lineNum">     189 </span>                :            :                            QgsRaster::RasterPyramidsFormat format = QgsRaster::PyramidsGTiff,</a>
<a name="190"><span class="lineNum">     190 </span>                :            :                            const QStringList &amp;createOptions = QStringList(),</a>
<a name="191"><span class="lineNum">     191 </span>                :            :                            QgsRasterBlockFeedback *feedback = nullptr ) override;</a>
<a name="192"><span class="lineNum">     192 </span>                :            :     QList&lt;QgsRasterPyramid&gt; buildPyramidList( QList&lt;int&gt; overviewList = QList&lt;int&gt;() ) override;</a>
<a name="193"><span class="lineNum">     193 </span>                :            : </a>
<a name="194"><span class="lineNum">     194 </span>                :            :     static QMap&lt;QString, QString&gt; supportedMimes();</a>
<a name="195"><span class="lineNum">     195 </span>                :            : </a>
<a name="196"><span class="lineNum">     196 </span>                :            :     bool isEditable() const override;</a>
<a name="197"><span class="lineNum">     197 </span>                :            :     bool setEditable( bool enabled ) override;</a>
<a name="198"><span class="lineNum">     198 </span>                :            :     bool write( void *data, int band, int width, int height, int xOffset, int yOffset ) override;</a>
<a name="199"><span class="lineNum">     199 </span>                :            : </a>
<a name="200"><span class="lineNum">     200 </span>                :            :     bool setNoDataValue( int bandNo, double noDataValue ) override;</a>
<a name="201"><span class="lineNum">     201 </span>                :            :     bool remove() override;</a>
<a name="202"><span class="lineNum">     202 </span>                :            : </a>
<a name="203"><span class="lineNum">     203 </span>                :            :     QString validateCreationOptions( const QStringList &amp;createOptions, const QString &amp;format ) override;</a>
<a name="204"><span class="lineNum">     204 </span>                :            :     QString validatePyramidsConfigOptions( QgsRaster::RasterPyramidsFormat pyramidsFormat,</a>
<a name="205"><span class="lineNum">     205 </span>                :            :                                            const QStringList &amp;configOptions, const QString &amp;fileFormat ) override;</a>
<a name="206"><span class="lineNum">     206 </span>                :            : </a>
<a name="207"><span class="lineNum">     207 </span>                :            :     QgsPoint transformCoordinates( const QgsPoint &amp;point, TransformType type ) override;</a>
<a name="208"><span class="lineNum">     208 </span>                :            : </a>
<a name="209"><span class="lineNum">     209 </span>                :            :     bool enableProviderResampling( bool enable ) override { mProviderResamplingEnabled = enable; return true; }</a>
<a name="210"><span class="lineNum">     210 </span>                :            :     bool setZoomedInResamplingMethod( ResamplingMethod method ) override { mZoomedInResamplingMethod = method; return true; }</a>
<a name="211"><span class="lineNum">     211 </span>                :            :     bool setZoomedOutResamplingMethod( ResamplingMethod method ) override { mZoomedOutResamplingMethod = method; return true; }</a>
<a name="212"><span class="lineNum">     212 </span>                :            :     bool setMaxOversampling( double factor ) override { mMaxOversampling = factor; return true; }</a>
<a name="213"><span class="lineNum">     213 </span>                :            : </a>
<a name="214"><span class="lineNum">     214 </span>                :            :   private:</a>
<a name="215"><span class="lineNum">     215 </span>                :            :     QgsGdalProvider( const QgsGdalProvider &amp;other );</a>
<a name="216"><span class="lineNum">     216 </span>                :            :     QgsGdalProvider &amp;operator=( const QgsGdalProvider &amp; ) = delete;</a>
<a name="217"><span class="lineNum">     217 </span>                :            : </a>
<a name="218"><span class="lineNum">     218 </span>                :            :     //! Whether mGdalDataset and mGdalBaseDataset have been attempted to be set</a>
<a name="219"><span class="lineNum">     219 </span>                :            :     bool mHasInit = false;</a>
<a name="220"><span class="lineNum">     220 </span>                :            : </a>
<a name="221"><span class="lineNum">     221 </span>                :            :     //! Open mGdalDataset/mGdalBaseDataset if needed.</a>
<a name="222"><span class="lineNum">     222 </span>                :            :     bool initIfNeeded();</a>
<a name="223"><span class="lineNum">     223 </span>                :            : </a>
<a name="224"><span class="lineNum">     224 </span>                :            :     // There are 2 cloning mechanisms.</a>
<a name="225"><span class="lineNum">     225 </span>                :            :     // * Either the cloned provider use the same GDAL handles as the main provider</a>
<a name="226"><span class="lineNum">     226 </span>                :            :     //   instance, in which case *mpRefCounter is used to count how many providers</a>
<a name="227"><span class="lineNum">     227 </span>                :            :     //    use the main provider. And *mpMutex is used to protect access to the</a>
<a name="228"><span class="lineNum">     228 </span>                :            :     //   GDAL resource.</a>
<a name="229"><span class="lineNum">     229 </span>                :            :     // * Or the cloned provider use its own GDAL handles, but with a cache mechanism</a>
<a name="230"><span class="lineNum">     230 </span>                :            :     //   to avoid constant opening/closing of datasets. In that case *mpParent is</a>
<a name="231"><span class="lineNum">     231 </span>                :            :     //   used to point to the main provider, and *mpLightRefCounter to count how</a>
<a name="232"><span class="lineNum">     232 </span>                :            :     //   many providers point to that main provider.</a>
<a name="233"><span class="lineNum">     233 </span>                :            : </a>
<a name="234"><span class="lineNum">     234 </span>                :            :     // reference counter to know how many main and shared provider instances are linked</a>
<a name="235"><span class="lineNum">     235 </span>                :            :     QAtomicInt *mpRefCounter = nullptr;</a>
<a name="236"><span class="lineNum">     236 </span>                :            : </a>
<a name="237"><span class="lineNum">     237 </span>                :            :     // mutex to protect access to mGdalDataset among main and shared provider instances</a>
<a name="238"><span class="lineNum">     238 </span>                :            :     QMutex *mpMutex = nullptr;</a>
<a name="239"><span class="lineNum">     239 </span>                :            : </a>
<a name="240"><span class="lineNum">     240 </span>                :            :     // pointer to a QgsGdalProvider* that is the parent. Note when *mpParent == this, we are the parent.</a>
<a name="241"><span class="lineNum">     241 </span>                :            :     QgsGdalProvider **mpParent = nullptr;</a>
<a name="242"><span class="lineNum">     242 </span>                :            : </a>
<a name="243"><span class="lineNum">     243 </span>                :            :     // reference counter to know how many main and related provider instances are linked</a>
<a name="244"><span class="lineNum">     244 </span>                :            :     mutable QAtomicInt *mpLightRefCounter = nullptr;</a>
<a name="245"><span class="lineNum">     245 </span>                :            : </a>
<a name="246"><span class="lineNum">     246 </span>                :            :     // update mode</a>
<a name="247"><span class="lineNum">     247 </span>                :            :     bool mUpdate;</a>
<a name="248"><span class="lineNum">     248 </span>                :            : </a>
<a name="249"><span class="lineNum">     249 </span>                :            :     //! Do some initialization on the dataset (e.g. handling of south-up datasets)</a>
<a name="250"><span class="lineNum">     250 </span>                :            :     void initBaseDataset();</a>
<a name="251"><span class="lineNum">     251 </span>                :            : </a>
<a name="252"><span class="lineNum">     252 </span>                :            :     /**</a>
<a name="253"><span class="lineNum">     253 </span>                :            :      * Flag indicating if the layer data source is a valid layer</a>
<a name="254"><span class="lineNum">     254 </span>                :            :      */</a>
<a name="255"><span class="lineNum">     255 </span>                :            :     bool mValid = false;</a>
<a name="256"><span class="lineNum">     256 </span>                :            : </a>
<a name="257"><span class="lineNum">     257 </span>                :            :     //! \brief Whether this raster has overviews / pyramids or not</a>
<a name="258"><span class="lineNum">     258 </span>                :            :     bool mHasPyramids = false;</a>
<a name="259"><span class="lineNum">     259 </span>                :            : </a>
<a name="260"><span class="lineNum">     260 </span>                :            :     /**</a>
<a name="261"><span class="lineNum">     261 </span>                :            :      * \brief Gdal data types used to represent data in in QGIS,</a>
<a name="262"><span class="lineNum">     262 </span>                :            :      * may be longer than source data type to keep nulls</a>
<a name="263"><span class="lineNum">     263 </span>                :            :      * indexed from 0</a>
<a name="264"><span class="lineNum">     264 </span>                :            :      */</a>
<a name="265"><span class="lineNum">     265 </span>                :            :     QList&lt;GDALDataType&gt; mGdalDataType;</a>
<a name="266"><span class="lineNum">     266 </span>                :            : </a>
<a name="267"><span class="lineNum">     267 </span>                :            :     QgsRectangle mExtent;</a>
<a name="268"><span class="lineNum">     268 </span>                :            :     int mWidth = 0;</a>
<a name="269"><span class="lineNum">     269 </span>                :            :     int mHeight = 0;</a>
<a name="270"><span class="lineNum">     270 </span>                :            :     int mXBlockSize = 0;</a>
<a name="271"><span class="lineNum">     271 </span>                :            :     int mYBlockSize = 0;</a>
<a name="272"><span class="lineNum">     272 </span>                :            :     int mBandCount = 1;</a>
<a name="273"><span class="lineNum">     273 </span>                :            : </a>
<a name="274"><span class="lineNum">     274 </span>                :            :     //mutable QList&lt;bool&gt; mMinMaxComputed;</a>
<a name="275"><span class="lineNum">     275 </span>                :            : </a>
<a name="276"><span class="lineNum">     276 </span>                :            :     // List of estimated min values, index 0 for band 1</a>
<a name="277"><span class="lineNum">     277 </span>                :            :     //mutable QList&lt;double&gt; mMinimum;</a>
<a name="278"><span class="lineNum">     278 </span>                :            : </a>
<a name="279"><span class="lineNum">     279 </span>                :            :     // List of estimated max values, index 0 for band 1</a>
<a name="280"><span class="lineNum">     280 </span>                :            :     //mutable QList&lt;double&gt; mMaximum;</a>
<a name="281"><span class="lineNum">     281 </span>                :            : </a>
<a name="282"><span class="lineNum">     282 </span>                :            :     //! \brief Pointer to the gdaldataset</a>
<a name="283"><span class="lineNum">     283 </span>                :            :     GDALDatasetH mGdalBaseDataset = nullptr;</a>
<a name="284"><span class="lineNum">     284 </span>                :            : </a>
<a name="285"><span class="lineNum">     285 </span>                :            :     //! \brief Pointer to the gdaldataset (possibly warped vrt)</a>
<a name="286"><span class="lineNum">     286 </span>                :            :     GDALDatasetH mGdalDataset = nullptr;</a>
<a name="287"><span class="lineNum">     287 </span>                :            : </a>
<a name="288"><span class="lineNum">     288 </span>                :            :     //! \brief Values for mapping pixel to world coordinates. Contents of this array are the same as the GDAL adfGeoTransform</a>
<a name="289"><span class="lineNum">     289 </span>                :            :     double mGeoTransform[6];</a>
<a name="290"><span class="lineNum">     290 </span>                :            : </a>
<a name="291"><span class="lineNum">     291 </span>                :            :     QgsCoordinateReferenceSystem mCrs;</a>
<a name="292"><span class="lineNum">     292 </span>                :            : </a>
<a name="293"><span class="lineNum">     293 </span>                :            :     QList&lt;QgsRasterPyramid&gt; mPyramidList;</a>
<a name="294"><span class="lineNum">     294 </span>                :            : </a>
<a name="295"><span class="lineNum">     295 </span>                :            :     //! \brief sublayers list saved for subsequent access</a>
<a name="296"><span class="lineNum">     296 </span>                :            :     QStringList mSubLayers;</a>
<a name="297"><span class="lineNum">     297 </span>                :            : </a>
<a name="298"><span class="lineNum">     298 </span>                :            :     //! Whether a per-dataset mask band is exposed as an alpha band for the point of view of the rest of the application.</a>
<a name="299"><span class="lineNum">     299 </span>                :            :     bool mMaskBandExposedAsAlpha = false;</a>
<a name="300"><span class="lineNum">     300 </span>                :            : </a>
<a name="301"><span class="lineNum">     301 </span>                :            :     //! \brief Driver short name.</a>
<a name="302"><span class="lineNum">     302 </span>                :            :     // It is kept in case the driver would be de-registered after the provider has been created.</a>
<a name="303"><span class="lineNum">     303 </span>                :            :     // Which is a very dangerous situation (see #29212)</a>
<a name="304"><span class="lineNum">     304 </span>                :            :     QString mDriverName;</a>
<a name="305"><span class="lineNum">     305 </span>                :            : </a>
<a name="306"><span class="lineNum">     306 </span>                :            :     //! Wrapper for GDALGetRasterBand() that takes into account mMaskBandExposedAsAlpha.</a>
<a name="307"><span class="lineNum">     307 </span>                :            :     GDALRasterBandH getBand( int bandNo ) const;</a>
<a name="308"><span class="lineNum">     308 </span>                :            : </a>
<a name="309"><span class="lineNum">     309 </span>                :            :     //! \brief Close data set and release related data</a>
<a name="310"><span class="lineNum">     310 </span>                :            :     void closeDataset();</a>
<a name="311"><span class="lineNum">     311 </span>                :            : </a>
<a name="312"><span class="lineNum">     312 </span>                :            :     //! Pair of GDAL base dataset and &quot;real&quot; dataset handles.</a>
<a name="313"><span class="lineNum">     313 </span>                :            :     struct DatasetPair</a>
<a name="314"><span class="lineNum">     314 </span>                :            :     {</a>
<a name="315"><span class="lineNum">     315 </span>                :            :       GDALDatasetH mGdalBaseDataset;</a>
<a name="316"><span class="lineNum">     316 </span>                :            :       GDALDatasetH mGdalDataset;</a>
<a name="317"><span class="lineNum">     317 </span>                :            :     };</a>
<a name="318"><span class="lineNum">     318 </span>                :            : </a>
<a name="319"><span class="lineNum">     319 </span>                :            :     // Dataset cache</a>
<a name="320"><span class="lineNum">     320 </span>                :            :     static QHash&lt; QgsGdalProvider *, QVector&lt;DatasetPair&gt; &gt; mgDatasetCache;</a>
<a name="321"><span class="lineNum">     321 </span>                :            : </a>
<a name="322"><span class="lineNum">     322 </span>                :            :     // Number of cached datasets in mgDatasetCache ( == sum(iter.value().size() )</a>
<a name="323"><span class="lineNum">     323 </span>                :            :     static int mgDatasetCacheSize;</a>
<a name="324"><span class="lineNum">     324 </span>                :            : </a>
<a name="325"><span class="lineNum">     325 </span>                :            :     //! Add handles to the cache if possible for the specified parent provider, in which case true is returned. If false returned, then the handles should be processed appropriately by the caller</a>
<a name="326"><span class="lineNum">     326 </span>                :            :     static bool cacheGdalHandlesForLaterReuse( QgsGdalProvider *provider, GDALDatasetH gdalBaseDataset, GDALDatasetH gdalDataset );</a>
<a name="327"><span class="lineNum">     327 </span>                :            : </a>
<a name="328"><span class="lineNum">     328 </span>                :            :     //! Gets cached handles for the specified provider, in which case true is returned and 2 handles are set.</a>
<a name="329"><span class="lineNum">     329 </span>                :            :     static bool getCachedGdalHandles( QgsGdalProvider *provider, GDALDatasetH &amp;gdalBaseDataset, GDALDatasetH &amp;gdalDataset );</a>
<a name="330"><span class="lineNum">     330 </span>                :            : </a>
<a name="331"><span class="lineNum">     331 </span>                :            :     //! Close all cached dataset for the specified provider.</a>
<a name="332"><span class="lineNum">     332 </span>                :            :     static void closeCachedGdalHandlesFor( QgsGdalProvider *provider );</a>
<a name="333"><span class="lineNum">     333 </span>                :            : </a>
<a name="334"><span class="lineNum">     334 </span>                :            :     /**</a>
<a name="335"><span class="lineNum">     335 </span>                :            :      * Converts a world (\a x, \a y) coordinate to a pixel \a row and \a col.</a>
<a name="336"><span class="lineNum">     336 </span>                :            :      */</a>
<a name="337"><span class="lineNum">     337 </span>                :            :     bool worldToPixel( double x, double y, int &amp;col, int &amp;row ) const;</a>
<a name="338"><span class="lineNum">     338 </span>                :            : </a>
<a name="339"><span class="lineNum">     339 </span>                :            :     bool mStatisticsAreReliable = false;</a>
<a name="340"><span class="lineNum">     340 </span>                :            : </a>
<a name="341"><span class="lineNum">     341 </span>                :            :     /**</a>
<a name="342"><span class="lineNum">     342 </span>                :            :      * Closes and reinits dataset</a>
<a name="343"><span class="lineNum">     343 </span>                :            :     */</a>
<a name="344"><span class="lineNum">     344 </span>                :            :     void reloadProviderData() override;</a>
<a name="345"><span class="lineNum">     345 </span>                :            : </a>
<a name="346"><span class="lineNum">     346 </span>                :            :     //! Instance of GDAL transformer function used in transformCoordinates() for conversion between image and layer coordinates</a>
<a name="347"><span class="lineNum">     347 </span>                :            :     void *mGdalTransformerArg = nullptr;</a>
<a name="348"><span class="lineNum">     348 </span>                :            : </a>
<a name="349"><span class="lineNum">     349 </span>                :            :     bool canDoResampling(</a>
<a name="350"><span class="lineNum">     350 </span>                :            :       int bandNo,</a>
<a name="351"><span class="lineNum">     351 </span>                :            :       const QgsRectangle &amp;reqExtent,</a>
<a name="352"><span class="lineNum">     352 </span>                :            :       int bufferWidthPix,</a>
<a name="353"><span class="lineNum">     353 </span>                :            :       int bufferHeightPix );</a>
<a name="354"><span class="lineNum">     354 </span>                :            : };</a>
<a name="355"><span class="lineNum">     355 </span>                :            : </a>
<a name="356"><span class="lineNum">     356 </span>                :            : /**</a>
<a name="357"><span class="lineNum">     357 </span>                :            :  * Metadata of the GDAL data provider</a>
<a name="358"><span class="lineNum">     358 </span>                :            :  */</a>
<a name="359"><span class="lineNum">     359 </span>                :<span class="lineCov">          6 : class QgsGdalProviderMetadata final: public QgsProviderMetadata</span></a>
<a name="360"><span class="lineNum">     360 </span>                :            : {</a>
<a name="361"><span class="lineNum">     361 </span>                :            :   public:</a>
<a name="362"><span class="lineNum">     362 </span>                :            :     QgsGdalProviderMetadata();</a>
<a name="363"><span class="lineNum">     363 </span>                :            :     QVariantMap decodeUri( const QString &amp;uri ) const override;</a>
<a name="364"><span class="lineNum">     364 </span>                :            :     QString encodeUri( const QVariantMap &amp;parts ) const override;</a>
<a name="365"><span class="lineNum">     365 </span>                :            :     bool uriIsBlocklisted( const QString &amp;uri ) const override;</a>
<a name="366"><span class="lineNum">     366 </span>                :            :     QgsGdalProvider *createProvider( const QString &amp;uri, const QgsDataProvider::ProviderOptions &amp;options, QgsDataProvider::ReadFlags flags = QgsDataProvider::ReadFlags() ) override;</a>
<a name="367"><span class="lineNum">     367 </span>                :            :     QgsGdalProvider *createRasterDataProvider(</a>
<a name="368"><span class="lineNum">     368 </span>                :            :       const QString &amp;uri,</a>
<a name="369"><span class="lineNum">     369 </span>                :            :       const QString &amp;format,</a>
<a name="370"><span class="lineNum">     370 </span>                :            :       int nBands,</a>
<a name="371"><span class="lineNum">     371 </span>                :            :       Qgis::DataType type,</a>
<a name="372"><span class="lineNum">     372 </span>                :            :       int width,</a>
<a name="373"><span class="lineNum">     373 </span>                :            :       int height,</a>
<a name="374"><span class="lineNum">     374 </span>                :            :       double *geoTransform,</a>
<a name="375"><span class="lineNum">     375 </span>                :            :       const QgsCoordinateReferenceSystem &amp;crs,</a>
<a name="376"><span class="lineNum">     376 </span>                :            :       const QStringList &amp;createOptions ) override;</a>
<a name="377"><span class="lineNum">     377 </span>                :            :     QString filters( FilterType type ) override;</a>
<a name="378"><span class="lineNum">     378 </span>                :            :     QList&lt; QgsDataItemProvider * &gt; dataItemProviders() const override;</a>
<a name="379"><span class="lineNum">     379 </span>                :            :     QList&lt;QPair&lt;QString, QString&gt; &gt; pyramidResamplingMethods() override;</a>
<a name="380"><span class="lineNum">     380 </span>                :            :     ProviderCapabilities providerCapabilities() const override;</a>
<a name="381"><span class="lineNum">     381 </span>                :            : };</a>
<a name="382"><span class="lineNum">     382 </span>                :            : </a>
<a name="383"><span class="lineNum">     383 </span>                :            : ///@endcond</a>
<a name="384"><span class="lineNum">     384 </span>                :            : #endif</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
