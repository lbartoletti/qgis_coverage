<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info.cleaned - /home/lbartoletti/qgis/tests/src/core/testqgsgeometry.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../index.html">top level</a> - <a href="index.html">home/lbartoletti/qgis/tests/src/core</a> - testqgsgeometry.cpp<span style="font-size: 80%;"> (source / <a href="testqgsgeometry.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info.cleaned</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">15103</td>
            <td class="headerCovTableEntry">15133</td>
            <td class="headerCovTableEntryHi">99.8 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-03-26 12:19:53</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /***************************************************************************</a>
<a name="2"><span class="lineNum">       2 </span>                :            :      testqgsgeometry.cpp</a>
<a name="3"><span class="lineNum">       3 </span>                :            :      --------------------------------------</a>
<a name="4"><span class="lineNum">       4 </span>                :            :     Date                 : 20 Jan 2008</a>
<a name="5"><span class="lineNum">       5 </span>                :            :     Copyright            : (C) 2008 by Tim Sutton</a>
<a name="6"><span class="lineNum">       6 </span>                :            :     Email                : tim @ linfiniti.com</a>
<a name="7"><span class="lineNum">       7 </span>                :            :  ***************************************************************************</a>
<a name="8"><span class="lineNum">       8 </span>                :            :  *                                                                         *</a>
<a name="9"><span class="lineNum">       9 </span>                :            :  *   This program is free software; you can redistribute it and/or modify  *</a>
<a name="10"><span class="lineNum">      10 </span>                :            :  *   it under the terms of the GNU General Public License as published by  *</a>
<a name="11"><span class="lineNum">      11 </span>                :            :  *   the Free Software Foundation; either version 2 of the License, or     *</a>
<a name="12"><span class="lineNum">      12 </span>                :            :  *   (at your option) any later version.                                   *</a>
<a name="13"><span class="lineNum">      13 </span>                :            :  *                                                                         *</a>
<a name="14"><span class="lineNum">      14 </span>                :            :  ***************************************************************************/</a>
<a name="15"><span class="lineNum">      15 </span>                :            : #include &quot;qgstest.h&quot;</a>
<a name="16"><span class="lineNum">      16 </span>                :            : #include &lt;cmath&gt;</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #include &lt;memory&gt;</a>
<a name="18"><span class="lineNum">      18 </span>                :            : #include &lt;limits&gt;</a>
<a name="19"><span class="lineNum">      19 </span>                :            : #include &lt;QObject&gt;</a>
<a name="20"><span class="lineNum">      20 </span>                :            : #include &lt;QString&gt;</a>
<a name="21"><span class="lineNum">      21 </span>                :            : #include &lt;QStringList&gt;</a>
<a name="22"><span class="lineNum">      22 </span>                :            : #include &lt;QApplication&gt;</a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &lt;QFileInfo&gt;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &lt;QDir&gt;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : #include &lt;QDesktopServices&gt;</a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &lt;QVector&gt;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &lt;QPointF&gt;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : #include &lt;QImage&gt;</a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &lt;QPainter&gt;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : </a>
<a name="31"><span class="lineNum">      31 </span>                :            : //qgis includes...</a>
<a name="32"><span class="lineNum">      32 </span>                :            : #include &lt;qgsapplication.h&gt;</a>
<a name="33"><span class="lineNum">      33 </span>                :            : #include &quot;qgscompoundcurve.h&quot;</a>
<a name="34"><span class="lineNum">      34 </span>                :            : #include &lt;qgsgeometry.h&gt;</a>
<a name="35"><span class="lineNum">      35 </span>                :            : #include &quot;qgsgeometryutils.h&quot;</a>
<a name="36"><span class="lineNum">      36 </span>                :            : #include &lt;qgspoint.h&gt;</a>
<a name="37"><span class="lineNum">      37 </span>                :            : #include &quot;qgspoint.h&quot;</a>
<a name="38"><span class="lineNum">      38 </span>                :            : #include &quot;qgslinestring.h&quot;</a>
<a name="39"><span class="lineNum">      39 </span>                :            : #include &quot;qgspolygon.h&quot;</a>
<a name="40"><span class="lineNum">      40 </span>                :            : #include &quot;qgstriangle.h&quot;</a>
<a name="41"><span class="lineNum">      41 </span>                :            : #include &quot;qgsgeometryengine.h&quot;</a>
<a name="42"><span class="lineNum">      42 </span>                :            : #include &quot;qgscircle.h&quot;</a>
<a name="43"><span class="lineNum">      43 </span>                :            : #include &quot;qgsellipse.h&quot;</a>
<a name="44"><span class="lineNum">      44 </span>                :            : #include &quot;qgsquadrilateral.h&quot;</a>
<a name="45"><span class="lineNum">      45 </span>                :            : #include &quot;qgsregularpolygon.h&quot;</a>
<a name="46"><span class="lineNum">      46 </span>                :            : #include &quot;qgsmultipoint.h&quot;</a>
<a name="47"><span class="lineNum">      47 </span>                :            : #include &quot;qgsmultilinestring.h&quot;</a>
<a name="48"><span class="lineNum">      48 </span>                :            : #include &quot;qgsmultipolygon.h&quot;</a>
<a name="49"><span class="lineNum">      49 </span>                :            : #include &quot;qgscircularstring.h&quot;</a>
<a name="50"><span class="lineNum">      50 </span>                :            : #include &quot;qgsgeometrycollection.h&quot;</a>
<a name="51"><span class="lineNum">      51 </span>                :            : #include &quot;qgsgeometryfactory.h&quot;</a>
<a name="52"><span class="lineNum">      52 </span>                :            : #include &quot;qgscurvepolygon.h&quot;</a>
<a name="53"><span class="lineNum">      53 </span>                :            : #include &quot;qgsproject.h&quot;</a>
<a name="54"><span class="lineNum">      54 </span>                :            : #include &quot;qgslinesegment.h&quot;</a>
<a name="55"><span class="lineNum">      55 </span>                :            : #include &quot;qgsgeos.h&quot;</a>
<a name="56"><span class="lineNum">      56 </span>                :            : #include &quot;qgsreferencedgeometry.h&quot;</a>
<a name="57"><span class="lineNum">      57 </span>                :            : #include &quot;qgsgeometrytransformer.h&quot;</a>
<a name="58"><span class="lineNum">      58 </span>                :            : </a>
<a name="59"><span class="lineNum">      59 </span>                :            : //qgs unit test utility class</a>
<a name="60"><span class="lineNum">      60 </span>                :            : #include &quot;qgsrenderchecker.h&quot;</a>
<a name="61"><span class="lineNum">      61 </span>                :            : </a>
<a name="62"><span class="lineNum">      62 </span>                :<span class="lineCov">         12 : class TestTransformer : public QgsAbstractGeometryTransformer</span></a>
<a name="63"><span class="lineNum">      63 </span>                :            : {</a>
<a name="64"><span class="lineNum">      64 </span>                :            :   public:</a>
<a name="65"><span class="lineNum">      65 </span>                :            : </a>
<a name="66"><span class="lineNum">      66 </span>                :<span class="lineCov">         50 :     bool transformPoint( double &amp;x, double &amp;y, double &amp;z, double &amp;m ) override</span></a>
<a name="67"><span class="lineNum">      67 </span>                :            :     {</a>
<a name="68"><span class="lineNum">      68 </span>                :<span class="lineCov">         50 :       x *= 3;</span></a>
<a name="69"><span class="lineNum">      69 </span>                :<span class="lineCov">         50 :       y += 14;</span></a>
<a name="70"><span class="lineNum">      70 </span>                :<span class="lineCov">         50 :       z += 5;</span></a>
<a name="71"><span class="lineNum">      71 </span>                :<span class="lineCov">         50 :       m -= 1;</span></a>
<a name="72"><span class="lineNum">      72 </span>                :<span class="lineCov">         50 :       return true;</span></a>
<a name="73"><span class="lineNum">      73 </span>                :            :     }</a>
<a name="74"><span class="lineNum">      74 </span>                :            : };</a>
<a name="75"><span class="lineNum">      75 </span>                :            : </a>
<a name="76"><span class="lineNum">      76 </span>                :            : </a>
<a name="77"><span class="lineNum">      77 </span>                :<span class="lineCov">         12 : class TestFailTransformer : public QgsAbstractGeometryTransformer</span></a>
<a name="78"><span class="lineNum">      78 </span>                :            : {</a>
<a name="79"><span class="lineNum">      79 </span>                :            :   public:</a>
<a name="80"><span class="lineNum">      80 </span>                :            : </a>
<a name="81"><span class="lineNum">      81 </span>                :<span class="lineCov">          6 :     bool transformPoint( double &amp;x, double &amp;y, double &amp;z, double &amp;m ) override</span></a>
<a name="82"><span class="lineNum">      82 </span>                :            :     {</a>
<a name="83"><span class="lineNum">      83 </span>                :<span class="lineCov">          6 :       x *= 3;</span></a>
<a name="84"><span class="lineNum">      84 </span>                :<span class="lineCov">          6 :       y += 14;</span></a>
<a name="85"><span class="lineNum">      85 </span>                :<span class="lineCov">          6 :       z += 5;</span></a>
<a name="86"><span class="lineNum">      86 </span>                :<span class="lineCov">          6 :       m -= 1;</span></a>
<a name="87"><span class="lineNum">      87 </span>                :<span class="lineCov">          6 :       return false;</span></a>
<a name="88"><span class="lineNum">      88 </span>                :            :     }</a>
<a name="89"><span class="lineNum">      89 </span>                :            : };</a>
<a name="90"><span class="lineNum">      90 </span>                :            : </a>
<a name="91"><span class="lineNum">      91 </span>                :            : </a>
<a name="92"><span class="lineNum">      92 </span>                :            : /**</a>
<a name="93"><span class="lineNum">      93 </span>                :            :  * \ingroup UnitTests</a>
<a name="94"><span class="lineNum">      94 </span>                :            :  * This is a unit test for the different geometry operations on vector features.</a>
<a name="95"><span class="lineNum">      95 </span>                :            :  */</a>
<a name="96"><span class="lineNum">      96 </span>                :<span class="lineCov">          1 : class TestQgsGeometry : public QObject</span></a>
<a name="97"><span class="lineNum">      97 </span>                :            : {</a>
<a name="98"><span class="lineNum">      98 </span>                :            :     Q_OBJECT</a>
<a name="99"><span class="lineNum">      99 </span>                :            : </a>
<a name="100"><span class="lineNum">     100 </span>                :            :   public:</a>
<a name="101"><span class="lineNum">     101 </span>                :            :     TestQgsGeometry();</a>
<a name="102"><span class="lineNum">     102 </span>                :            : </a>
<a name="103"><span class="lineNum">     103 </span>                :<span class="lineCov">         12 :     static QgsAbstractGeometry *createEmpty( QgsAbstractGeometry *geom )</span></a>
<a name="104"><span class="lineNum">     104 </span>                :            :     {</a>
<a name="105"><span class="lineNum">     105 </span>                :<span class="lineCov">         12 :       return geom-&gt;createEmptyWithSameType();</span></a>
<a name="106"><span class="lineNum">     106 </span>                :            :     }</a>
<a name="107"><span class="lineNum">     107 </span>                :            : </a>
<a name="108"><span class="lineNum">     108 </span>                :            :   private slots:</a>
<a name="109"><span class="lineNum">     109 </span>                :            :     void initTestCase();// will be called before the first testfunction is executed.</a>
<a name="110"><span class="lineNum">     110 </span>                :            :     void cleanupTestCase();// will be called after the last testfunction was executed.</a>
<a name="111"><span class="lineNum">     111 </span>                :            :     void cleanup();// will be called after every testfunction.</a>
<a name="112"><span class="lineNum">     112 </span>                :            :     void copy();</a>
<a name="113"><span class="lineNum">     113 </span>                :            :     void assignment();</a>
<a name="114"><span class="lineNum">     114 </span>                :            :     void asVariant(); //test conversion to and from a QVariant</a>
<a name="115"><span class="lineNum">     115 </span>                :            :     void referenced();</a>
<a name="116"><span class="lineNum">     116 </span>                :            :     void isEmpty();</a>
<a name="117"><span class="lineNum">     117 </span>                :            :     void isValid();</a>
<a name="118"><span class="lineNum">     118 </span>                :            :     void equality();</a>
<a name="119"><span class="lineNum">     119 </span>                :            :     void vertexIterator();</a>
<a name="120"><span class="lineNum">     120 </span>                :            :     void partIterator();</a>
<a name="121"><span class="lineNum">     121 </span>                :            : </a>
<a name="122"><span class="lineNum">     122 </span>                :            :     void geos();</a>
<a name="123"><span class="lineNum">     123 </span>                :            : </a>
<a name="124"><span class="lineNum">     124 </span>                :            :     // geometry types</a>
<a name="125"><span class="lineNum">     125 </span>                :            :     void point(); //test QgsPointV2</a>
<a name="126"><span class="lineNum">     126 </span>                :            :     void lineString(); //test QgsLineString</a>
<a name="127"><span class="lineNum">     127 </span>                :            :     void circularString();</a>
<a name="128"><span class="lineNum">     128 </span>                :            :     void polygon(); //test QgsPolygon</a>
<a name="129"><span class="lineNum">     129 </span>                :            :     void curvePolygon();</a>
<a name="130"><span class="lineNum">     130 </span>                :            :     void triangle();</a>
<a name="131"><span class="lineNum">     131 </span>                :            :     void circle();</a>
<a name="132"><span class="lineNum">     132 </span>                :            :     void ellipse();</a>
<a name="133"><span class="lineNum">     133 </span>                :            :     void quadrilateral();</a>
<a name="134"><span class="lineNum">     134 </span>                :            :     void regularPolygon();</a>
<a name="135"><span class="lineNum">     135 </span>                :            :     void compoundCurve(); //test QgsCompoundCurve</a>
<a name="136"><span class="lineNum">     136 </span>                :            :     void multiPoint();</a>
<a name="137"><span class="lineNum">     137 </span>                :            :     void multiLineString();</a>
<a name="138"><span class="lineNum">     138 </span>                :            :     void multiCurve();</a>
<a name="139"><span class="lineNum">     139 </span>                :            :     void multiSurface();</a>
<a name="140"><span class="lineNum">     140 </span>                :            :     void multiPolygon();</a>
<a name="141"><span class="lineNum">     141 </span>                :            :     void geometryCollection();</a>
<a name="142"><span class="lineNum">     142 </span>                :            : </a>
<a name="143"><span class="lineNum">     143 </span>                :            :     void fromQgsPointXY();</a>
<a name="144"><span class="lineNum">     144 </span>                :            :     void fromQPoint();</a>
<a name="145"><span class="lineNum">     145 </span>                :            :     void fromQPolygonF();</a>
<a name="146"><span class="lineNum">     146 </span>                :            :     void fromPolyline();</a>
<a name="147"><span class="lineNum">     147 </span>                :            :     void asQPointF();</a>
<a name="148"><span class="lineNum">     148 </span>                :            :     void asQPolygonF();</a>
<a name="149"><span class="lineNum">     149 </span>                :            : </a>
<a name="150"><span class="lineNum">     150 </span>                :            :     void comparePolylines();</a>
<a name="151"><span class="lineNum">     151 </span>                :            :     void comparePolygons();</a>
<a name="152"><span class="lineNum">     152 </span>                :            : </a>
<a name="153"><span class="lineNum">     153 </span>                :            :     void createEmptyWithSameType();</a>
<a name="154"><span class="lineNum">     154 </span>                :            : </a>
<a name="155"><span class="lineNum">     155 </span>                :            :     // MK, Disabled 14.11.2014</a>
<a name="156"><span class="lineNum">     156 </span>                :            :     // Too unclear what exactly should be tested and which variations are allowed for the line</a>
<a name="157"><span class="lineNum">     157 </span>                :            : #if 0</a>
<a name="158"><span class="lineNum">     158 </span>                :            :     void simplifyCheck1();</a>
<a name="159"><span class="lineNum">     159 </span>                :            : #endif</a>
<a name="160"><span class="lineNum">     160 </span>                :            : </a>
<a name="161"><span class="lineNum">     161 </span>                :            :     void intersectionCheck1();</a>
<a name="162"><span class="lineNum">     162 </span>                :            :     void intersectionCheck2();</a>
<a name="163"><span class="lineNum">     163 </span>                :            :     void translateCheck1();</a>
<a name="164"><span class="lineNum">     164 </span>                :            :     void rotateCheck1();</a>
<a name="165"><span class="lineNum">     165 </span>                :            :     void unionCheck1();</a>
<a name="166"><span class="lineNum">     166 </span>                :            :     void unionCheck2();</a>
<a name="167"><span class="lineNum">     167 </span>                :            :     void differenceCheck1();</a>
<a name="168"><span class="lineNum">     168 </span>                :            :     void differenceCheck2();</a>
<a name="169"><span class="lineNum">     169 </span>                :            :     void bufferCheck();</a>
<a name="170"><span class="lineNum">     170 </span>                :            :     void smoothCheck();</a>
<a name="171"><span class="lineNum">     171 </span>                :            :     void shortestLineEmptyGeometry();</a>
<a name="172"><span class="lineNum">     172 </span>                :            : </a>
<a name="173"><span class="lineNum">     173 </span>                :            :     void unaryUnion();</a>
<a name="174"><span class="lineNum">     174 </span>                :            : </a>
<a name="175"><span class="lineNum">     175 </span>                :            :     void dataStream();</a>
<a name="176"><span class="lineNum">     176 </span>                :            : </a>
<a name="177"><span class="lineNum">     177 </span>                :            :     void exportToGeoJSON();</a>
<a name="178"><span class="lineNum">     178 </span>                :            : </a>
<a name="179"><span class="lineNum">     179 </span>                :            :     void wkbInOut();</a>
<a name="180"><span class="lineNum">     180 </span>                :            : </a>
<a name="181"><span class="lineNum">     181 </span>                :            :     void directionNeutralSegmentation();</a>
<a name="182"><span class="lineNum">     182 </span>                :            :     void poleOfInaccessibility();</a>
<a name="183"><span class="lineNum">     183 </span>                :            : </a>
<a name="184"><span class="lineNum">     184 </span>                :            :     void makeValid();</a>
<a name="185"><span class="lineNum">     185 </span>                :            : </a>
<a name="186"><span class="lineNum">     186 </span>                :            :     void isSimple_data();</a>
<a name="187"><span class="lineNum">     187 </span>                :            :     void isSimple();</a>
<a name="188"><span class="lineNum">     188 </span>                :            : </a>
<a name="189"><span class="lineNum">     189 </span>                :            :     void reshapeGeometryLineMerge();</a>
<a name="190"><span class="lineNum">     190 </span>                :            :     void createCollectionOfType();</a>
<a name="191"><span class="lineNum">     191 </span>                :            : </a>
<a name="192"><span class="lineNum">     192 </span>                :            :     void orientedMinimumBoundingBox( );</a>
<a name="193"><span class="lineNum">     193 </span>                :            :     void minimalEnclosingCircle( );</a>
<a name="194"><span class="lineNum">     194 </span>                :            :     void splitGeometry();</a>
<a name="195"><span class="lineNum">     195 </span>                :            :     void snappedToGrid();</a>
<a name="196"><span class="lineNum">     196 </span>                :            : </a>
<a name="197"><span class="lineNum">     197 </span>                :            :     void convertGeometryCollectionToSubclass();</a>
<a name="198"><span class="lineNum">     198 </span>                :            : </a>
<a name="199"><span class="lineNum">     199 </span>                :            :     void emptyJson();</a>
<a name="200"><span class="lineNum">     200 </span>                :            : </a>
<a name="201"><span class="lineNum">     201 </span>                :            :     void testRandomPointsInPolygon();</a>
<a name="202"><span class="lineNum">     202 </span>                :            : </a>
<a name="203"><span class="lineNum">     203 </span>                :            :     void wktParser();</a>
<a name="204"><span class="lineNum">     204 </span>                :            : </a>
<a name="205"><span class="lineNum">     205 </span>                :            :   private:</a>
<a name="206"><span class="lineNum">     206 </span>                :            :     //! Must be called before each render test</a>
<a name="207"><span class="lineNum">     207 </span>                :            :     void initPainterTest();</a>
<a name="208"><span class="lineNum">     208 </span>                :            : </a>
<a name="209"><span class="lineNum">     209 </span>                :            :     //! A helper method to do a render check to see if the geometry op is as expected</a>
<a name="210"><span class="lineNum">     210 </span>                :            :     bool renderCheck( const QString &amp;testName, const QString &amp;comment = QString(), int mismatchCount = 0 );</a>
<a name="211"><span class="lineNum">     211 </span>                :            :     //! A helper method to dump to qdebug the geometry of a multipolygon</a>
<a name="212"><span class="lineNum">     212 </span>                :            :     void dumpMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon );</a>
<a name="213"><span class="lineNum">     213 </span>                :            :     void paintMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon );</a>
<a name="214"><span class="lineNum">     214 </span>                :            :     //! A helper method to dump to qdebug the geometry of a polygon</a>
<a name="215"><span class="lineNum">     215 </span>                :            :     void dumpPolygon( QgsPolygonXY &amp;polygon );</a>
<a name="216"><span class="lineNum">     216 </span>                :            :     void paintPolygon( QgsPolygonXY &amp;polygon );</a>
<a name="217"><span class="lineNum">     217 </span>                :            :     //! A helper method to dump to qdebug the geometry of a polyline</a>
<a name="218"><span class="lineNum">     218 </span>                :            :     void dumpPolyline( QgsPolylineXY &amp;polyline );</a>
<a name="219"><span class="lineNum">     219 </span>                :            : </a>
<a name="220"><span class="lineNum">     220 </span>                :            :     // Release return with delete []</a>
<a name="221"><span class="lineNum">     221 </span>                :<span class="lineCov">          2 :     unsigned char *hex2bytes( const char *hex, int *size )</span></a>
<a name="222"><span class="lineNum">     222 </span>                :            :     {</a>
<a name="223"><span class="lineNum">     223 </span>                :<span class="lineCov">          2 :       QByteArray ba = QByteArray::fromHex( hex );</span></a>
<a name="224"><span class="lineNum">     224 </span>                :<span class="lineCov">          2 :       unsigned char *out = new unsigned char[ba.size()];</span></a>
<a name="225"><span class="lineNum">     225 </span>                :<span class="lineCov">          2 :       memcpy( out, ba.data(), ba.size() );</span></a>
<a name="226"><span class="lineNum">     226 </span>                :<span class="lineCov">          2 :       *size = ba.size();</span></a>
<a name="227"><span class="lineNum">     227 </span>                :<span class="lineCov">          2 :       return out;</span></a>
<a name="228"><span class="lineNum">     228 </span>                :<span class="lineCov">          2 :     }</span></a>
<a name="229"><span class="lineNum">     229 </span>                :            : </a>
<a name="230"><span class="lineNum">     230 </span>                :            :     QString bytes2hex( const unsigned char *bytes, int size )</a>
<a name="231"><span class="lineNum">     231 </span>                :            :     {</a>
<a name="232"><span class="lineNum">     232 </span>                :            :       QByteArray ba( ( const char * )bytes, size );</a>
<a name="233"><span class="lineNum">     233 </span>                :            :       QString out = ba.toHex();</a>
<a name="234"><span class="lineNum">     234 </span>                :            :       return out;</a>
<a name="235"><span class="lineNum">     235 </span>                :            :     }</a>
<a name="236"><span class="lineNum">     236 </span>                :            : </a>
<a name="237"><span class="lineNum">     237 </span>                :            : </a>
<a name="238"><span class="lineNum">     238 </span>                :            :     QString elemToString( const QDomElement &amp;elem ) const;</a>
<a name="239"><span class="lineNum">     239 </span>                :            : </a>
<a name="240"><span class="lineNum">     240 </span>                :            :     QgsPointXY mPoint1;</a>
<a name="241"><span class="lineNum">     241 </span>                :            :     QgsPointXY mPoint2;</a>
<a name="242"><span class="lineNum">     242 </span>                :            :     QgsPointXY mPoint3;</a>
<a name="243"><span class="lineNum">     243 </span>                :            :     QgsPointXY mPoint4;</a>
<a name="244"><span class="lineNum">     244 </span>                :            :     QgsPointXY mPointA;</a>
<a name="245"><span class="lineNum">     245 </span>                :            :     QgsPointXY mPointB;</a>
<a name="246"><span class="lineNum">     246 </span>                :            :     QgsPointXY mPointC;</a>
<a name="247"><span class="lineNum">     247 </span>                :            :     QgsPointXY mPointD;</a>
<a name="248"><span class="lineNum">     248 </span>                :            :     QgsPointXY mPointW;</a>
<a name="249"><span class="lineNum">     249 </span>                :            :     QgsPointXY mPointX;</a>
<a name="250"><span class="lineNum">     250 </span>                :            :     QgsPointXY mPointY;</a>
<a name="251"><span class="lineNum">     251 </span>                :            :     QgsPointXY mPointZ;</a>
<a name="252"><span class="lineNum">     252 </span>                :            :     QgsPolylineXY mPolylineA;</a>
<a name="253"><span class="lineNum">     253 </span>                :            :     QgsPolylineXY mPolylineB;</a>
<a name="254"><span class="lineNum">     254 </span>                :            :     QgsPolylineXY mPolylineC;</a>
<a name="255"><span class="lineNum">     255 </span>                :            :     QgsGeometry mpPolylineGeometryD;</a>
<a name="256"><span class="lineNum">     256 </span>                :            :     QgsPolygonXY mPolygonA;</a>
<a name="257"><span class="lineNum">     257 </span>                :            :     QgsPolygonXY mPolygonB;</a>
<a name="258"><span class="lineNum">     258 </span>                :            :     QgsPolygonXY mPolygonC;</a>
<a name="259"><span class="lineNum">     259 </span>                :            :     QgsGeometry mpPolygonGeometryA;</a>
<a name="260"><span class="lineNum">     260 </span>                :            :     QgsGeometry mpPolygonGeometryB;</a>
<a name="261"><span class="lineNum">     261 </span>                :            :     QgsGeometry mpPolygonGeometryC;</a>
<a name="262"><span class="lineNum">     262 </span>                :            :     QString mWktLine;</a>
<a name="263"><span class="lineNum">     263 </span>                :            :     QString mTestDataDir;</a>
<a name="264"><span class="lineNum">     264 </span>                :            :     QImage mImage;</a>
<a name="265"><span class="lineNum">     265 </span>                :<span class="lineCov">          1 :     QPainter *mpPainter = nullptr;</span></a>
<a name="266"><span class="lineNum">     266 </span>                :            :     QPen mPen1;</a>
<a name="267"><span class="lineNum">     267 </span>                :            :     QPen mPen2;</a>
<a name="268"><span class="lineNum">     268 </span>                :            :     QString mReport;</a>
<a name="269"><span class="lineNum">     269 </span>                :            : </a>
<a name="270"><span class="lineNum">     270 </span>                :            : };</a>
<a name="271"><span class="lineNum">     271 </span>                :            : </a>
<a name="272"><span class="lineNum">     272 </span>                :<span class="lineCov">          3 : TestQgsGeometry::TestQgsGeometry()</span></a>
<a name="273"><span class="lineNum">     273 </span>                :<span class="lineCov">          1 :   : mpPolylineGeometryD( nullptr )</span></a>
<a name="274"><span class="lineNum">     274 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryA( nullptr )</span></a>
<a name="275"><span class="lineNum">     275 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryB( nullptr )</span></a>
<a name="276"><span class="lineNum">     276 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryC( nullptr )</span></a>
<a name="277"><span class="lineNum">     277 </span>                :<span class="lineCov">          2 : {</span></a>
<a name="278"><span class="lineNum">     278 </span>                :            : </a>
<a name="279"><span class="lineNum">     279 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="280"><span class="lineNum">     280 </span>                :            : </a>
<a name="281"><span class="lineNum">     281 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::initTestCase()</span></a>
<a name="282"><span class="lineNum">     282 </span>                :            : {</a>
<a name="283"><span class="lineNum">     283 </span>                :            :   // Runs once before any tests are run</a>
<a name="284"><span class="lineNum">     284 </span>                :            :   // init QGIS's paths - true means that all path will be inited from prefix</a>
<a name="285"><span class="lineNum">     285 </span>                :<span class="lineCov">          1 :   QgsApplication::init();</span></a>
<a name="286"><span class="lineNum">     286 </span>                :<span class="lineCov">          1 :   QgsApplication::initQgis();</span></a>
<a name="287"><span class="lineNum">     287 </span>                :<span class="lineCov">          1 :   QgsApplication::showSettings();</span></a>
<a name="288"><span class="lineNum">     288 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;h1&gt;Geometry Tests&lt;/h1&gt;\n&quot; );</span></a>
<a name="289"><span class="lineNum">     289 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;green\&quot;&gt;Green = polygonA&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="290"><span class="lineNum">     290 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;red\&quot;&gt;Red = polygonB&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="291"><span class="lineNum">     291 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;blue\&quot;&gt;Blue = polygonC&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="292"><span class="lineNum">     292 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="293"><span class="lineNum">     293 </span>                :            : </a>
<a name="294"><span class="lineNum">     294 </span>                :            : </a>
<a name="295"><span class="lineNum">     295 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::cleanupTestCase()</span></a>
<a name="296"><span class="lineNum">     296 </span>                :            : {</a>
<a name="297"><span class="lineNum">     297 </span>                :<span class="lineCov">          1 :   delete mpPainter;</span></a>
<a name="298"><span class="lineNum">     298 </span>                :<span class="lineCov">          1 :   mpPainter = nullptr;</span></a>
<a name="299"><span class="lineNum">     299 </span>                :            : </a>
<a name="300"><span class="lineNum">     300 </span>                :            :   // Runs once after all tests are run</a>
<a name="301"><span class="lineNum">     301 </span>                :<span class="lineCov">          1 :   QString myReportFile = QDir::tempPath() + &quot;/qgistest.html&quot;;</span></a>
<a name="302"><span class="lineNum">     302 </span>                :<span class="lineCov">          1 :   QFile myFile( myReportFile );</span></a>
<a name="303"><span class="lineNum">     303 </span>                :<span class="lineCov">          1 :   if ( myFile.open( QIODevice::WriteOnly | QIODevice::Append ) )</span></a>
<a name="304"><span class="lineNum">     304 </span>                :            :   {</a>
<a name="305"><span class="lineNum">     305 </span>                :<span class="lineCov">          1 :     QTextStream myQTextStream( &amp;myFile );</span></a>
<a name="306"><span class="lineNum">     306 </span>                :<span class="lineCov">          1 :     myQTextStream &lt;&lt; mReport;</span></a>
<a name="307"><span class="lineNum">     307 </span>                :<span class="lineCov">          1 :     myFile.close();</span></a>
<a name="308"><span class="lineNum">     308 </span>                :            :     //QDesktopServices::openUrl( &quot;file:///&quot; + myReportFile );</a>
<a name="309"><span class="lineNum">     309 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="310"><span class="lineNum">     310 </span>                :            : </a>
<a name="311"><span class="lineNum">     311 </span>                :<span class="lineCov">          1 :   QgsApplication::exitQgis();</span></a>
<a name="312"><span class="lineNum">     312 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="313"><span class="lineNum">     313 </span>                :            : </a>
<a name="314"><span class="lineNum">     314 </span>                :<span class="lineCov">          6 : void TestQgsGeometry::initPainterTest()</span></a>
<a name="315"><span class="lineNum">     315 </span>                :            : {</a>
<a name="316"><span class="lineNum">     316 </span>                :<span class="lineCov">          6 :   delete mpPainter;</span></a>
<a name="317"><span class="lineNum">     317 </span>                :<span class="lineCov">          6 :   mpPainter = nullptr;</span></a>
<a name="318"><span class="lineNum">     318 </span>                :            :   //</a>
<a name="319"><span class="lineNum">     319 </span>                :            :   // Reset / reinitialize the geometries before each test is run</a>
<a name="320"><span class="lineNum">     320 </span>                :            :   //</a>
<a name="321"><span class="lineNum">     321 </span>                :<span class="lineCov">          6 :   mPoint1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="322"><span class="lineNum">     322 </span>                :<span class="lineCov">          6 :   mPoint2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="323"><span class="lineNum">     323 </span>                :<span class="lineCov">          6 :   mPoint3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="324"><span class="lineNum">     324 </span>                :<span class="lineCov">          6 :   mPoint4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="325"><span class="lineNum">     325 </span>                :<span class="lineCov">          6 :   mPointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="326"><span class="lineNum">     326 </span>                :<span class="lineCov">          6 :   mPointB = QgsPointXY( 100.0, 40.0 );</span></a>
<a name="327"><span class="lineNum">     327 </span>                :<span class="lineCov">          6 :   mPointC = QgsPointXY( 100.0, 100.0 );</span></a>
<a name="328"><span class="lineNum">     328 </span>                :<span class="lineCov">          6 :   mPointD = QgsPointXY( 40.0, 100.0 );</span></a>
<a name="329"><span class="lineNum">     329 </span>                :<span class="lineCov">          6 :   mPointW = QgsPointXY( 200.0, 200.0 );</span></a>
<a name="330"><span class="lineNum">     330 </span>                :<span class="lineCov">          6 :   mPointX = QgsPointXY( 240.0, 200.0 );</span></a>
<a name="331"><span class="lineNum">     331 </span>                :<span class="lineCov">          6 :   mPointY = QgsPointXY( 240.0, 240.0 );</span></a>
<a name="332"><span class="lineNum">     332 </span>                :<span class="lineCov">          6 :   mPointZ = QgsPointXY( 200.0, 240.0 );</span></a>
<a name="333"><span class="lineNum">     333 </span>                :            : </a>
<a name="334"><span class="lineNum">     334 </span>                :<span class="lineCov">         12 :   mWktLine = QStringLiteral( &quot;LINESTRING(117.623198 35.198654, 117.581274 35.198654, 117.078178 35.324427, 116.868555 35.534051, 116.617007 35.869448, 116.491233 35.953297, 116.155836 36.288694, 116.071987 36.372544, 115.443117 36.749865, 114.814247 37.043338, 114.311152 37.169112, 113.388810 37.378735, 113.095337 37.378735, 112.592241 37.378735, 111.753748 37.294886, 111.502201 37.252961, 111.082954 37.127187, 110.747557 37.127187, 110.160612 36.917564, 110.034838 36.833715, 109.741366 36.749865, 109.573667 36.666016, 109.238270 36.498317, 109.070571 36.414468, 108.819023 36.288694, 108.693250 36.246770, 108.483626 36.162920, 107.645134 35.911372, 106.597017 35.869448, 106.051997 35.701749, 105.800449 35.617900, 105.590826 35.575975, 105.297354 35.575975, 104.961956 35.575975, 104.710409 35.534051, 104.458861 35.492126, 103.871916 35.492126, 103.788066 35.492126, 103.326895 35.408277, 102.949574 35.408277, 102.488402 35.450201, 102.069156 35.450201, 101.482211 35.450201, 100.937191 35.659825, 100.308321 35.869448, 100.056773 36.037146, 99.050582 36.079071, 97.667069 35.743674, 97.163973 35.617900, 96.115857 35.534051, 95.612761 35.534051, 94.396947 35.911372, 93.684228 36.288694, 92.929584 36.833715, 92.258790 37.169112, 91.629920 37.504509, 90.414105 37.881831, 90.414105 37.881831, 90.246407 37.923755, 89.491763 37.839906, 89.156366 37.672207, 88.485572 37.504509, 87.814778 37.252961, 87.563230 37.169112, 87.143983 37.043338, 85.970093 36.875639, 85.802395 36.875639, 84.083484 36.959489, 84.041560 37.043338, 82.951519 37.546433, 82.699971 37.630283)&quot; );</span></a>
<a name="335"><span class="lineNum">     335 </span>                :            : </a>
<a name="336"><span class="lineNum">     336 </span>                :<span class="lineCov">          6 :   mPolygonA.clear();</span></a>
<a name="337"><span class="lineNum">     337 </span>                :<span class="lineCov">          6 :   mPolygonB.clear();</span></a>
<a name="338"><span class="lineNum">     338 </span>                :<span class="lineCov">          6 :   mPolygonC.clear();</span></a>
<a name="339"><span class="lineNum">     339 </span>                :<span class="lineCov">          6 :   mPolylineA.clear();</span></a>
<a name="340"><span class="lineNum">     340 </span>                :<span class="lineCov">          6 :   mPolylineB.clear();</span></a>
<a name="341"><span class="lineNum">     341 </span>                :<span class="lineCov">          6 :   mPolylineC.clear();</span></a>
<a name="342"><span class="lineNum">     342 </span>                :<span class="lineCov">          6 :   mPolylineA &lt;&lt; mPoint1 &lt;&lt; mPoint2 &lt;&lt; mPoint3 &lt;&lt; mPoint4 &lt;&lt; mPoint1;</span></a>
<a name="343"><span class="lineNum">     343 </span>                :<span class="lineCov">          6 :   mPolygonA &lt;&lt; mPolylineA;</span></a>
<a name="344"><span class="lineNum">     344 </span>                :            :   //Polygon B intersects Polygon A</a>
<a name="345"><span class="lineNum">     345 </span>                :<span class="lineCov">          6 :   mPolylineB &lt;&lt; mPointA &lt;&lt; mPointB &lt;&lt; mPointC &lt;&lt; mPointD &lt;&lt; mPointA;</span></a>
<a name="346"><span class="lineNum">     346 </span>                :<span class="lineCov">          6 :   mPolygonB &lt;&lt; mPolylineB;</span></a>
<a name="347"><span class="lineNum">     347 </span>                :            :   // Polygon C should intersect no other polys</a>
<a name="348"><span class="lineNum">     348 </span>                :<span class="lineCov">          6 :   mPolylineC &lt;&lt; mPointW &lt;&lt; mPointX &lt;&lt; mPointY &lt;&lt; mPointZ &lt;&lt; mPointW;</span></a>
<a name="349"><span class="lineNum">     349 </span>                :<span class="lineCov">          6 :   mPolygonC &lt;&lt; mPolylineC;</span></a>
<a name="350"><span class="lineNum">     350 </span>                :            : </a>
<a name="351"><span class="lineNum">     351 </span>                :<span class="lineCov">          6 :   mpPolylineGeometryD = QgsGeometry::fromWkt( mWktLine );</span></a>
<a name="352"><span class="lineNum">     352 </span>                :            : </a>
<a name="353"><span class="lineNum">     353 </span>                :            :   //polygon: first item of the list is outer ring,</a>
<a name="354"><span class="lineNum">     354 </span>                :            :   // inner rings (if any) start from second item</a>
<a name="355"><span class="lineNum">     355 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryA = QgsGeometry::fromPolygonXY( mPolygonA );</span></a>
<a name="356"><span class="lineNum">     356 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryB = QgsGeometry::fromPolygonXY( mPolygonB );</span></a>
<a name="357"><span class="lineNum">     357 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryC = QgsGeometry::fromPolygonXY( mPolygonC );</span></a>
<a name="358"><span class="lineNum">     358 </span>                :            : </a>
<a name="359"><span class="lineNum">     359 </span>                :<span class="lineCov">          6 :   mImage = QImage( 250, 250, QImage::Format_RGB32 );</span></a>
<a name="360"><span class="lineNum">     360 </span>                :<span class="lineCov">          6 :   mImage.fill( qRgb( 152, 219, 249 ) );</span></a>
<a name="361"><span class="lineNum">     361 </span>                :<span class="lineCov">          6 :   mpPainter = new QPainter( &amp;mImage );</span></a>
<a name="362"><span class="lineNum">     362 </span>                :            : </a>
<a name="363"><span class="lineNum">     363 </span>                :            :   // Draw the test shapes first</a>
<a name="364"><span class="lineNum">     364 </span>                :<span class="lineCov">          6 :   mPen1 = QPen();</span></a>
<a name="365"><span class="lineNum">     365 </span>                :<span class="lineCov">          6 :   mPen1.setWidth( 5 );</span></a>
<a name="366"><span class="lineNum">     366 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::green );</span></a>
<a name="367"><span class="lineNum">     367 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="368"><span class="lineNum">     368 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonA );</span></a>
<a name="369"><span class="lineNum">     369 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::red );</span></a>
<a name="370"><span class="lineNum">     370 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="371"><span class="lineNum">     371 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonB );</span></a>
<a name="372"><span class="lineNum">     372 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::blue );</span></a>
<a name="373"><span class="lineNum">     373 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="374"><span class="lineNum">     374 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonC );</span></a>
<a name="375"><span class="lineNum">     375 </span>                :            : </a>
<a name="376"><span class="lineNum">     376 </span>                :<span class="lineCov">          6 :   mPen2 = QPen();</span></a>
<a name="377"><span class="lineNum">     377 </span>                :<span class="lineCov">          6 :   mPen2.setWidth( 1 );</span></a>
<a name="378"><span class="lineNum">     378 </span>                :<span class="lineCov">          6 :   mPen2.setBrush( Qt::black );</span></a>
<a name="379"><span class="lineNum">     379 </span>                :<span class="lineCov">          6 :   QBrush myBrush( Qt::DiagCrossPattern );</span></a>
<a name="380"><span class="lineNum">     380 </span>                :            : </a>
<a name="381"><span class="lineNum">     381 </span>                :            : </a>
<a name="382"><span class="lineNum">     382 </span>                :            :   //set the pen to a different color -</a>
<a name="383"><span class="lineNum">     383 </span>                :            :   //any test outs will be drawn in pen2</a>
<a name="384"><span class="lineNum">     384 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen2 );</span></a>
<a name="385"><span class="lineNum">     385 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setBrush( myBrush );</span></a>
<a name="386"><span class="lineNum">     386 </span>                :<span class="lineCov">          6 : }</span></a>
<a name="387"><span class="lineNum">     387 </span>                :            : </a>
<a name="388"><span class="lineNum">     388 </span>                :<span class="lineCov">         74 : void TestQgsGeometry::cleanup()</span></a>
<a name="389"><span class="lineNum">     389 </span>                :            : {</a>
<a name="390"><span class="lineNum">     390 </span>                :            :   // will be called after every testfunction.</a>
<a name="391"><span class="lineNum">     391 </span>                :<span class="lineCov">         74 : }</span></a>
<a name="392"><span class="lineNum">     392 </span>                :            : </a>
<a name="393"><span class="lineNum">     393 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::copy()</span></a>
<a name="394"><span class="lineNum">     394 </span>                :            : {</a>
<a name="395"><span class="lineNum">     395 </span>                :            :   //create a point geometry</a>
<a name="396"><span class="lineNum">     396 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="397"><span class="lineNum">     397 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="398"><span class="lineNum">     398 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="399"><span class="lineNum">     399 </span>                :            : </a>
<a name="400"><span class="lineNum">     400 </span>                :            :   //implicitly shared copy</a>
<a name="401"><span class="lineNum">     401 </span>                :<span class="lineCov">          1 :   QgsGeometry copy( original );</span></a>
<a name="402"><span class="lineNum">     402 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="403"><span class="lineNum">     403 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="404"><span class="lineNum">     404 </span>                :            : </a>
<a name="405"><span class="lineNum">     405 </span>                :            :   //trigger a detach</a>
<a name="406"><span class="lineNum">     406 </span>                :<span class="lineCov">          1 :   copy.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="407"><span class="lineNum">     407 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 3.0 );</span></a>
<a name="408"><span class="lineNum">     408 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 4.0 );</span></a>
<a name="409"><span class="lineNum">     409 </span>                :            : </a>
<a name="410"><span class="lineNum">     410 </span>                :            :   //make sure original was untouched</a>
<a name="411"><span class="lineNum">     411 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="412"><span class="lineNum">     412 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="413"><span class="lineNum">     413 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="414"><span class="lineNum">     414 </span>                :            : </a>
<a name="415"><span class="lineNum">     415 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::assignment()</span></a>
<a name="416"><span class="lineNum">     416 </span>                :            : {</a>
<a name="417"><span class="lineNum">     417 </span>                :            :   //create a point geometry</a>
<a name="418"><span class="lineNum">     418 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="419"><span class="lineNum">     419 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="420"><span class="lineNum">     420 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="421"><span class="lineNum">     421 </span>                :            : </a>
<a name="422"><span class="lineNum">     422 </span>                :            :   //assign to implicitly shared copy</a>
<a name="423"><span class="lineNum">     423 </span>                :<span class="lineCov">          1 :   QgsGeometry copy;</span></a>
<a name="424"><span class="lineNum">     424 </span>                :<span class="lineCov">          1 :   copy = original;</span></a>
<a name="425"><span class="lineNum">     425 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="426"><span class="lineNum">     426 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="427"><span class="lineNum">     427 </span>                :            : </a>
<a name="428"><span class="lineNum">     428 </span>                :            :   //trigger a detach</a>
<a name="429"><span class="lineNum">     429 </span>                :<span class="lineCov">          1 :   copy.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="430"><span class="lineNum">     430 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 3.0 );</span></a>
<a name="431"><span class="lineNum">     431 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 4.0 );</span></a>
<a name="432"><span class="lineNum">     432 </span>                :            : </a>
<a name="433"><span class="lineNum">     433 </span>                :            :   //make sure original was untouched</a>
<a name="434"><span class="lineNum">     434 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="435"><span class="lineNum">     435 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="436"><span class="lineNum">     436 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="437"><span class="lineNum">     437 </span>                :            : </a>
<a name="438"><span class="lineNum">     438 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asVariant()</span></a>
<a name="439"><span class="lineNum">     439 </span>                :            : {</a>
<a name="440"><span class="lineNum">     440 </span>                :            :   //create a point geometry</a>
<a name="441"><span class="lineNum">     441 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="442"><span class="lineNum">     442 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="443"><span class="lineNum">     443 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="444"><span class="lineNum">     444 </span>                :            : </a>
<a name="445"><span class="lineNum">     445 </span>                :            :   //convert to and from a QVariant</a>
<a name="446"><span class="lineNum">     446 </span>                :<span class="lineCov">          1 :   QVariant var = QVariant::fromValue( original );</span></a>
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">          1 :   QVERIFY( var.isValid() );</span></a>
<a name="448"><span class="lineNum">     448 </span>                :<span class="lineCov">          1 :   QVERIFY( !var.canConvert&lt; QgsReferencedGeometry &gt;() );</span></a>
<a name="449"><span class="lineNum">     449 </span>                :            : </a>
<a name="450"><span class="lineNum">     450 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar = qvariant_cast&lt;QgsGeometry&gt;( var );</span></a>
<a name="451"><span class="lineNum">     451 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="452"><span class="lineNum">     452 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="453"><span class="lineNum">     453 </span>                :            : </a>
<a name="454"><span class="lineNum">     454 </span>                :            :   //also check copying variant</a>
<a name="455"><span class="lineNum">     455 </span>                :<span class="lineCov">          1 :   QVariant var2 = var;</span></a>
<a name="456"><span class="lineNum">     456 </span>                :<span class="lineCov">          1 :   QVERIFY( var2.isValid() );</span></a>
<a name="457"><span class="lineNum">     457 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar2 = qvariant_cast&lt;QgsGeometry&gt;( var2 );</span></a>
<a name="458"><span class="lineNum">     458 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar2.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="459"><span class="lineNum">     459 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar2.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="460"><span class="lineNum">     460 </span>                :            : </a>
<a name="461"><span class="lineNum">     461 </span>                :            :   //modify original and check detachment</a>
<a name="462"><span class="lineNum">     462 </span>                :<span class="lineCov">          1 :   original.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="463"><span class="lineNum">     463 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar3 = qvariant_cast&lt;QgsGeometry&gt;( var );</span></a>
<a name="464"><span class="lineNum">     464 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar3.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="465"><span class="lineNum">     465 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar3.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="466"><span class="lineNum">     466 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="467"><span class="lineNum">     467 </span>                :            : </a>
<a name="468"><span class="lineNum">     468 </span>                :            : </a>
<a name="469"><span class="lineNum">     469 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::referenced()</span></a>
<a name="470"><span class="lineNum">     470 </span>                :            : {</a>
<a name="471"><span class="lineNum">     471 </span>                :<span class="lineCov">          2 :   QgsReferencedGeometry geom1 = QgsReferencedGeometry( QgsGeometry::fromPointXY( QgsPointXY( 1, 2 ) ), QgsCoordinateReferenceSystem( QStringLiteral( &quot;EPSG:3111&quot; ) ) );</span></a>
<a name="472"><span class="lineNum">     472 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom1.crs().authid(), QStringLiteral( &quot;EPSG:3111&quot; ) );</span></a>
<a name="473"><span class="lineNum">     473 </span>                :<span class="lineCov">          2 :   geom1.setCrs( QgsCoordinateReferenceSystem( QStringLiteral( &quot;EPSG:28356&quot; ) ) );</span></a>
<a name="474"><span class="lineNum">     474 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom1.crs().authid(), QStringLiteral( &quot;EPSG:28356&quot; ) );</span></a>
<a name="475"><span class="lineNum">     475 </span>                :            : </a>
<a name="476"><span class="lineNum">     476 </span>                :            :   //convert to and from a QVariant</a>
<a name="477"><span class="lineNum">     477 </span>                :<span class="lineCov">          1 :   QVariant var = QVariant::fromValue( geom1 );</span></a>
<a name="478"><span class="lineNum">     478 </span>                :<span class="lineCov">          1 :   QVERIFY( var.isValid() );</span></a>
<a name="479"><span class="lineNum">     479 </span>                :            : </a>
<a name="480"><span class="lineNum">     480 </span>                :<span class="lineCov">          1 :   QVERIFY( var.canConvert&lt; QgsReferencedGeometry &gt;() );</span></a>
<a name="481"><span class="lineNum">     481 </span>                :            : </a>
<a name="482"><span class="lineNum">     482 </span>                :<span class="lineCov">          1 :   QgsReferencedGeometry geom2 = qvariant_cast&lt;QgsReferencedGeometry&gt;( var );</span></a>
<a name="483"><span class="lineNum">     483 </span>                :<span class="lineCov">          1 :   QCOMPARE( geom2.asWkt(), geom1.asWkt() );</span></a>
<a name="484"><span class="lineNum">     484 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom2.crs().authid(), QStringLiteral( &quot;EPSG:28356&quot; ) );</span></a>
<a name="485"><span class="lineNum">     485 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="486"><span class="lineNum">     486 </span>                :            : </a>
<a name="487"><span class="lineNum">     487 </span>                :            : </a>
<a name="488"><span class="lineNum">     488 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isEmpty()</span></a>
<a name="489"><span class="lineNum">     489 </span>                :            : {</a>
<a name="490"><span class="lineNum">     490 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="491"><span class="lineNum">     491 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isNull() );</span></a>
<a name="492"><span class="lineNum">     492 </span>                :            : </a>
<a name="493"><span class="lineNum">     493 </span>                :<span class="lineCov">          1 :   geom.set( new QgsPoint() );</span></a>
<a name="494"><span class="lineNum">     494 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isEmpty() );</span></a>
<a name="495"><span class="lineNum">     495 </span>                :            : </a>
<a name="496"><span class="lineNum">     496 </span>                :<span class="lineCov">          1 :   geom.set( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="497"><span class="lineNum">     497 </span>                :<span class="lineCov">          1 :   QVERIFY( !geom.isNull() );</span></a>
<a name="498"><span class="lineNum">     498 </span>                :            : </a>
<a name="499"><span class="lineNum">     499 </span>                :<span class="lineCov">          1 :   geom.set( nullptr );</span></a>
<a name="500"><span class="lineNum">     500 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isNull() );</span></a>
<a name="501"><span class="lineNum">     501 </span>                :            : </a>
<a name="502"><span class="lineNum">     502 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection collection;</span></a>
<a name="503"><span class="lineNum">     503 </span>                :<span class="lineCov">          1 :   QVERIFY( collection.isEmpty() );</span></a>
<a name="504"><span class="lineNum">     504 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="505"><span class="lineNum">     505 </span>                :            : </a>
<a name="506"><span class="lineNum">     506 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isValid()</span></a>
<a name="507"><span class="lineNum">     507 </span>                :            : {</a>
<a name="508"><span class="lineNum">     508 </span>                :<span class="lineCov">          1 :   QString error;</span></a>
<a name="509"><span class="lineNum">     509 </span>                :            :   // LineString</a>
<a name="510"><span class="lineNum">     510 </span>                :<span class="lineCov">          1 :   QgsLineString line;</span></a>
<a name="511"><span class="lineNum">     511 </span>                :<span class="lineCov">          1 :   QVERIFY( line.isValid( error ) );</span></a>
<a name="512"><span class="lineNum">     512 </span>                :<span class="lineCov">          1 :   line.addVertex( QgsPoint( 0, 0 ) );</span></a>
<a name="513"><span class="lineNum">     513 </span>                :<span class="lineCov">          1 :   QVERIFY( !line.isValid( error ) );</span></a>
<a name="514"><span class="lineNum">     514 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;LineString has less than 2 points and is not empty.&quot; ) );</span></a>
<a name="515"><span class="lineNum">     515 </span>                :<span class="lineCov">          1 :   line.addVertex( QgsPoint( 1, 1 ) );</span></a>
<a name="516"><span class="lineNum">     516 </span>                :<span class="lineCov">          1 :   QVERIFY( line.isValid( error ) );</span></a>
<a name="517"><span class="lineNum">     517 </span>                :            : </a>
<a name="518"><span class="lineNum">     518 </span>                :            :   // CircularString</a>
<a name="519"><span class="lineNum">     519 </span>                :<span class="lineCov">          1 :   QgsCircularString circ;</span></a>
<a name="520"><span class="lineNum">     520 </span>                :<span class="lineCov">          1 :   QVERIFY( circ.isValid( error ) );</span></a>
<a name="521"><span class="lineNum">     521 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts = QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2.5, 2.3 );</span></a>
<a name="522"><span class="lineNum">     522 </span>                :<span class="lineCov">          1 :   circ.setPoints( pts );</span></a>
<a name="523"><span class="lineNum">     523 </span>                :<span class="lineCov">          1 :   QVERIFY( !circ.isValid( error ) );</span></a>
<a name="524"><span class="lineNum">     524 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;CircularString has less than 3 points and is not empty.&quot; ) );</span></a>
<a name="525"><span class="lineNum">     525 </span>                :<span class="lineCov">          1 :   pts.append( QgsPoint( 5, 5 ) );</span></a>
<a name="526"><span class="lineNum">     526 </span>                :<span class="lineCov">          1 :   circ.setPoints( pts );</span></a>
<a name="527"><span class="lineNum">     527 </span>                :<span class="lineCov">          1 :   QVERIFY( circ.isValid( error ) );</span></a>
<a name="528"><span class="lineNum">     528 </span>                :            : </a>
<a name="529"><span class="lineNum">     529 </span>                :            :   // CompoundCurve</a>
<a name="530"><span class="lineNum">     530 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve curve;</span></a>
<a name="531"><span class="lineNum">     531 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="532"><span class="lineNum">     532 </span>                :<span class="lineCov">          1 :   curve.addCurve( line.clone() );</span></a>
<a name="533"><span class="lineNum">     533 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="534"><span class="lineNum">     534 </span>                :<span class="lineCov">          1 :   curve.addCurve( circ.clone() );</span></a>
<a name="535"><span class="lineNum">     535 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="536"><span class="lineNum">     536 </span>                :<span class="lineCov">          1 :   QgsLineString invalidLine;</span></a>
<a name="537"><span class="lineNum">     537 </span>                :<span class="lineCov">          1 :   invalidLine.addVertex( QgsPoint( 0, 0 ) );</span></a>
<a name="538"><span class="lineNum">     538 </span>                :<span class="lineCov">          1 :   curve.addCurve( invalidLine.clone() );</span></a>
<a name="539"><span class="lineNum">     539 </span>                :<span class="lineCov">          1 :   QVERIFY( !curve.isValid( error ) );</span></a>
<a name="540"><span class="lineNum">     540 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;Curve[3]: LineString has less than 2 points and is not empty.&quot; ) );</span></a>
<a name="541"><span class="lineNum">     541 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="542"><span class="lineNum">     542 </span>                :            : </a>
<a name="543"><span class="lineNum">     543 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::equality()</span></a>
<a name="544"><span class="lineNum">     544 </span>                :            : {</a>
<a name="545"><span class="lineNum">     545 </span>                :            :   // null geometries</a>
<a name="546"><span class="lineNum">     546 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry().equals( QgsGeometry() ) );</span></a>
<a name="547"><span class="lineNum">     547 </span>                :            : </a>
<a name="548"><span class="lineNum">     548 </span>                :            :   // compare to null</a>
<a name="549"><span class="lineNum">     549 </span>                :<span class="lineCov">          1 :   QgsGeometry g1( std::make_unique&lt; QgsPoint &gt;( 1.0, 2.0 ) );</span></a>
<a name="550"><span class="lineNum">     550 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( QgsGeometry() ) );</span></a>
<a name="551"><span class="lineNum">     551 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry().equals( g1 ) );</span></a>
<a name="552"><span class="lineNum">     552 </span>                :            : </a>
<a name="553"><span class="lineNum">     553 </span>                :            :   // compare implicitly shared copies</a>
<a name="554"><span class="lineNum">     554 </span>                :<span class="lineCov">          1 :   QgsGeometry g2( g1 );</span></a>
<a name="555"><span class="lineNum">     555 </span>                :<span class="lineCov">          1 :   QVERIFY( g2.equals( g1 ) );</span></a>
<a name="556"><span class="lineNum">     556 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g2 ) );</span></a>
<a name="557"><span class="lineNum">     557 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g1 ) );</span></a>
<a name="558"><span class="lineNum">     558 </span>                :            : </a>
<a name="559"><span class="lineNum">     559 </span>                :            :   // equal geometry, but different internal data</a>
<a name="560"><span class="lineNum">     560 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;Point( 1.0 2.0 )&quot; );</span></a>
<a name="561"><span class="lineNum">     561 </span>                :<span class="lineCov">          1 :   QVERIFY( g2.equals( g1 ) );</span></a>
<a name="562"><span class="lineNum">     562 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g2 ) );</span></a>
<a name="563"><span class="lineNum">     563 </span>                :            : </a>
<a name="564"><span class="lineNum">     564 </span>                :            :   // different dimensionality</a>
<a name="565"><span class="lineNum">     565 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;PointM( 1.0 2.0 3.0)&quot; );</span></a>
<a name="566"><span class="lineNum">     566 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="567"><span class="lineNum">     567 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="568"><span class="lineNum">     568 </span>                :            : </a>
<a name="569"><span class="lineNum">     569 </span>                :            :   // different type</a>
<a name="570"><span class="lineNum">     570 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;LineString( 1.0 2.0, 3.0 4.0 )&quot; );</span></a>
<a name="571"><span class="lineNum">     571 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="572"><span class="lineNum">     572 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="573"><span class="lineNum">     573 </span>                :            : </a>
<a name="574"><span class="lineNum">     574 </span>                :            :   // different direction</a>
<a name="575"><span class="lineNum">     575 </span>                :<span class="lineCov">          1 :   g1 = QgsGeometry::fromWkt( &quot;LineString( 3.0 4.0, 1.0 2.0 )&quot; );</span></a>
<a name="576"><span class="lineNum">     576 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="577"><span class="lineNum">     577 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="578"><span class="lineNum">     578 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="579"><span class="lineNum">     579 </span>                :            : </a>
<a name="580"><span class="lineNum">     580 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::vertexIterator()</span></a>
<a name="581"><span class="lineNum">     581 </span>                :            : {</a>
<a name="582"><span class="lineNum">     582 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="583"><span class="lineNum">     583 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it = geom.vertices();</span></a>
<a name="584"><span class="lineNum">     584 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="585"><span class="lineNum">     585 </span>                :            : </a>
<a name="586"><span class="lineNum">     586 </span>                :<span class="lineCov">          1 :   QgsPolylineXY polyline;</span></a>
<a name="587"><span class="lineNum">     587 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 3, 4 );</span></a>
<a name="588"><span class="lineNum">     588 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2 = QgsGeometry::fromPolylineXY( polyline );</span></a>
<a name="589"><span class="lineNum">     589 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2 = geom2.vertices();</span></a>
<a name="590"><span class="lineNum">     590 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="591"><span class="lineNum">     591 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 2 ) );</span></a>
<a name="592"><span class="lineNum">     592 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="593"><span class="lineNum">     593 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 3, 4 ) );</span></a>
<a name="594"><span class="lineNum">     594 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="595"><span class="lineNum">     595 </span>                :            : </a>
<a name="596"><span class="lineNum">     596 </span>                :<span class="lineCov">          1 :   QgsGeometry emptyGeom = QgsGeometry::fromWkt( &quot;LINESTRING EMPTY&quot; );</span></a>
<a name="597"><span class="lineNum">     597 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it3 = emptyGeom.vertices();</span></a>
<a name="598"><span class="lineNum">     598 </span>                :<span class="lineCov">          1 :   QVERIFY( !it3.hasNext() );</span></a>
<a name="599"><span class="lineNum">     599 </span>                :<span class="lineCov">          1 :   emptyGeom = QgsGeometry::fromWkt( &quot;POINT EMPTY&quot; );</span></a>
<a name="600"><span class="lineNum">     600 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it4 = emptyGeom.vertices();</span></a>
<a name="601"><span class="lineNum">     601 </span>                :<span class="lineCov">          1 :   QVERIFY( !it4.hasNext() );</span></a>
<a name="602"><span class="lineNum">     602 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="603"><span class="lineNum">     603 </span>                :            : </a>
<a name="604"><span class="lineNum">     604 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::partIterator()</span></a>
<a name="605"><span class="lineNum">     605 </span>                :            : {</a>
<a name="606"><span class="lineNum">     606 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="607"><span class="lineNum">     607 </span>                :<span class="lineCov">          1 :   QgsGeometryPartIterator it = geom.parts();</span></a>
<a name="608"><span class="lineNum">     608 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="609"><span class="lineNum">     609 </span>                :            : </a>
<a name="610"><span class="lineNum">     610 </span>                :<span class="lineCov">          2 :   geom = QgsGeometry::fromWkt( QStringLiteral( &quot;Point( 1 2 )&quot; ) );</span></a>
<a name="611"><span class="lineNum">     611 </span>                :<span class="lineCov">          1 :   QgsGeometryConstPartIterator it2 = geom.constParts();</span></a>
<a name="612"><span class="lineNum">     612 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="613"><span class="lineNum">     613 </span>                :<span class="lineCov">          2 :   QCOMPARE( it2.next()-&gt;asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="614"><span class="lineNum">     614 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="615"><span class="lineNum">     615 </span>                :            : </a>
<a name="616"><span class="lineNum">     616 </span>                :            :   // test that non-const iterator detaches</a>
<a name="617"><span class="lineNum">     617 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2 = geom;</span></a>
<a name="618"><span class="lineNum">     618 </span>                :<span class="lineCov">          1 :   it = geom2.parts();</span></a>
<a name="619"><span class="lineNum">     619 </span>                :<span class="lineCov">          1 :   QVERIFY( it.hasNext() );</span></a>
<a name="620"><span class="lineNum">     620 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *part = it.next();</span></a>
<a name="621"><span class="lineNum">     621 </span>                :<span class="lineCov">          2 :   QCOMPARE( part-&gt;asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="622"><span class="lineNum">     622 </span>                :<span class="lineCov">          1 :   static_cast&lt; QgsPoint * &gt;( part )-&gt;setX( 100 );</span></a>
<a name="623"><span class="lineNum">     623 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom2.asWkt(), QStringLiteral( &quot;Point (100 2)&quot; ) );</span></a>
<a name="624"><span class="lineNum">     624 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="625"><span class="lineNum">     625 </span>                :            :   // geom2 should have adetached, geom should be unaffected by change</a>
<a name="626"><span class="lineNum">     626 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom.asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="627"><span class="lineNum">     627 </span>                :            : </a>
<a name="628"><span class="lineNum">     628 </span>                :            :   // See test_qgsgeometry.py for geometry-type specific checks!</a>
<a name="629"><span class="lineNum">     629 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="630"><span class="lineNum">     630 </span>                :            : </a>
<a name="631"><span class="lineNum">     631 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::geos()</span></a>
<a name="632"><span class="lineNum">     632 </span>                :            : {</a>
<a name="633"><span class="lineNum">     633 </span>                :            :   // test GEOS conversion utils</a>
<a name="634"><span class="lineNum">     634 </span>                :            : </a>
<a name="635"><span class="lineNum">     635 </span>                :            :   // empty parts should NOT be added to a GEOS collection -- it can cause crashes in GEOS</a>
<a name="636"><span class="lineNum">     636 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon polyWithEmptyParts;</span></a>
<a name="637"><span class="lineNum">     637 </span>                :<span class="lineCov">          1 :   geos::unique_ptr asGeos( QgsGeos::asGeos( &amp;polyWithEmptyParts ) );</span></a>
<a name="638"><span class="lineNum">     638 </span>                :<span class="lineCov">          1 :   QgsGeometry res( QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="639"><span class="lineNum">     639 </span>                :<span class="lineCov">          2 :   QCOMPARE( res.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="640"><span class="lineNum">     640 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString() ) );</span></a>
<a name="641"><span class="lineNum">     641 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) ) ) );</span></a>
<a name="642"><span class="lineNum">     642 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString() ) );</span></a>
<a name="643"><span class="lineNum">     643 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 10, 1 ) &lt;&lt; QgsPoint( 11, 1 ) &lt;&lt; QgsPoint( 10, 0 ) ) ) );</span></a>
<a name="644"><span class="lineNum">     644 </span>                :<span class="lineCov">          1 :   asGeos = QgsGeos::asGeos( &amp;polyWithEmptyParts );</span></a>
<a name="645"><span class="lineNum">     645 </span>                :<span class="lineCov">          1 :   QCOMPARE( GEOSGetNumGeometries_r( QgsGeos::getGEOSHandler(), asGeos.get() ), 2 );</span></a>
<a name="646"><span class="lineNum">     646 </span>                :<span class="lineCov">          1 :   res = QgsGeometry( QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="647"><span class="lineNum">     647 </span>                :<span class="lineCov">          2 :   QCOMPARE( res.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 0 1, 1 1, 0 0)),((10 0, 10 1, 11 1, 10 0)))&quot; ) );</span></a>
<a name="648"><span class="lineNum">     648 </span>                :            : </a>
<a name="649"><span class="lineNum">     649 </span>                :            :   // Empty geometry</a>
<a name="650"><span class="lineNum">     650 </span>                :<span class="lineCov">          1 :   QgsPoint point;</span></a>
<a name="651"><span class="lineNum">     651 </span>                :<span class="lineCov">          1 :   asGeos = QgsGeos::asGeos( &amp;point );</span></a>
<a name="652"><span class="lineNum">     652 </span>                :            :   // should be treated as a null geometry, not an empty point in order to maintain api compatibility with</a>
<a name="653"><span class="lineNum">     653 </span>                :            :   // earlier QGIS 3.x releases</a>
<a name="654"><span class="lineNum">     654 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="655"><span class="lineNum">     655 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="656"><span class="lineNum">     656 </span>                :            : </a>
<a name="657"><span class="lineNum">     657 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::point()</span></a>
<a name="658"><span class="lineNum">     658 </span>                :            : {</a>
<a name="659"><span class="lineNum">     659 </span>                :            :   //test QgsPointV2</a>
<a name="660"><span class="lineNum">     660 </span>                :<span class="lineCov">          1 :   QgsPoint pEmpty;</span></a>
<a name="661"><span class="lineNum">     661 </span>                :<span class="lineCov">          1 :   QVERIFY( pEmpty.isEmpty() );</span></a>
<a name="662"><span class="lineNum">     662 </span>                :<span class="lineCov">          1 :   QCOMPARE( pEmpty.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="663"><span class="lineNum">     663 </span>                :<span class="lineCov">          2 :   QCOMPARE( pEmpty.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="664"><span class="lineNum">     664 </span>                :<span class="lineCov">          1 :   pEmpty.setX( 1.0 );</span></a>
<a name="665"><span class="lineNum">     665 </span>                :<span class="lineCov">          1 :   QVERIFY( pEmpty.isEmpty() );</span></a>
<a name="666"><span class="lineNum">     666 </span>                :<span class="lineCov">          1 :   QCOMPARE( pEmpty.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="667"><span class="lineNum">     667 </span>                :<span class="lineCov">          2 :   QCOMPARE( pEmpty.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="668"><span class="lineNum">     668 </span>                :<span class="lineCov">          1 :   pEmpty.setY( 2.0 );</span></a>
<a name="669"><span class="lineNum">     669 </span>                :<span class="lineCov">          1 :   QVERIFY( !pEmpty.isEmpty() );</span></a>
<a name="670"><span class="lineNum">     670 </span>                :<span class="lineCov">          1 :   QCOMPARE( pEmpty.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">          2 :   QCOMPARE( pEmpty.asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="672"><span class="lineNum">     672 </span>                :            : </a>
<a name="673"><span class="lineNum">     673 </span>                :            :   //test constructors</a>
<a name="674"><span class="lineNum">     674 </span>                :<span class="lineCov">          1 :   QgsPoint p1( 5.0, 6.0 );</span></a>
<a name="675"><span class="lineNum">     675 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.x(), 5.0 );</span></a>
<a name="676"><span class="lineNum">     676 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.y(), 6.0 );</span></a>
<a name="677"><span class="lineNum">     677 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isEmpty() );</span></a>
<a name="678"><span class="lineNum">     678 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.is3D() );</span></a>
<a name="679"><span class="lineNum">     679 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isMeasure() );</span></a>
<a name="680"><span class="lineNum">     680 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="681"><span class="lineNum">     681 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wktTypeStr(), QString( &quot;Point&quot; ) );</span></a>
<a name="682"><span class="lineNum">     682 </span>                :            : </a>
<a name="683"><span class="lineNum">     683 </span>                :<span class="lineCov">          1 :   QgsPoint p2( QgsPointXY( 3.0, 4.0 ) );</span></a>
<a name="684"><span class="lineNum">     684 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.x(), 3.0 );</span></a>
<a name="685"><span class="lineNum">     685 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.y(), 4.0 );</span></a>
<a name="686"><span class="lineNum">     686 </span>                :<span class="lineCov">          1 :   QVERIFY( !p2.isEmpty() );</span></a>
<a name="687"><span class="lineNum">     687 </span>                :<span class="lineCov">          1 :   QVERIFY( !p2.is3D() );</span></a>
<a name="688"><span class="lineNum">     688 </span>                :<span class="lineCov">          1 :   QVERIFY( !p2.isMeasure() );</span></a>
<a name="689"><span class="lineNum">     689 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="690"><span class="lineNum">     690 </span>                :            : </a>
<a name="691"><span class="lineNum">     691 </span>                :<span class="lineCov">          1 :   QgsPoint p3( QPointF( 7.0, 9.0 ) );</span></a>
<a name="692"><span class="lineNum">     692 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.x(), 7.0 );</span></a>
<a name="693"><span class="lineNum">     693 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.y(), 9.0 );</span></a>
<a name="694"><span class="lineNum">     694 </span>                :<span class="lineCov">          1 :   QVERIFY( !p3.isEmpty() );</span></a>
<a name="695"><span class="lineNum">     695 </span>                :<span class="lineCov">          1 :   QVERIFY( !p3.is3D() );</span></a>
<a name="696"><span class="lineNum">     696 </span>                :<span class="lineCov">          1 :   QVERIFY( !p3.isMeasure() );</span></a>
<a name="697"><span class="lineNum">     697 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="698"><span class="lineNum">     698 </span>                :            : </a>
<a name="699"><span class="lineNum">     699 </span>                :<span class="lineCov">          1 :   QgsPoint p4( QgsWkbTypes::Point, 11.0, 13.0 );</span></a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.x(), 11.0 );</span></a>
<a name="701"><span class="lineNum">     701 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.y(), 13.0 );</span></a>
<a name="702"><span class="lineNum">     702 </span>                :<span class="lineCov">          1 :   QVERIFY( !p4.isEmpty() );</span></a>
<a name="703"><span class="lineNum">     703 </span>                :<span class="lineCov">          1 :   QVERIFY( !p4.is3D() );</span></a>
<a name="704"><span class="lineNum">     704 </span>                :<span class="lineCov">          1 :   QVERIFY( !p4.isMeasure() );</span></a>
<a name="705"><span class="lineNum">     705 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="706"><span class="lineNum">     706 </span>                :            : </a>
<a name="707"><span class="lineNum">     707 </span>                :<span class="lineCov">          1 :   QgsPoint p5( QgsWkbTypes::PointZ, 11.0, 13.0, 15.0 );</span></a>
<a name="708"><span class="lineNum">     708 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.x(), 11.0 );</span></a>
<a name="709"><span class="lineNum">     709 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.y(), 13.0 );</span></a>
<a name="710"><span class="lineNum">     710 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.z(), 15.0 );</span></a>
<a name="711"><span class="lineNum">     711 </span>                :<span class="lineCov">          1 :   QVERIFY( !p5.isEmpty() );</span></a>
<a name="712"><span class="lineNum">     712 </span>                :<span class="lineCov">          1 :   QVERIFY( p5.is3D() );</span></a>
<a name="713"><span class="lineNum">     713 </span>                :<span class="lineCov">          1 :   QVERIFY( !p5.isMeasure() );</span></a>
<a name="714"><span class="lineNum">     714 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="715"><span class="lineNum">     715 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.wktTypeStr(), QString( &quot;PointZ&quot; ) );</span></a>
<a name="716"><span class="lineNum">     716 </span>                :            : </a>
<a name="717"><span class="lineNum">     717 </span>                :<span class="lineCov">          1 :   QgsPoint p6( QgsWkbTypes::PointM, 11.0, 13.0, 0.0, 17.0 );</span></a>
<a name="718"><span class="lineNum">     718 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.x(), 11.0 );</span></a>
<a name="719"><span class="lineNum">     719 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.y(), 13.0 );</span></a>
<a name="720"><span class="lineNum">     720 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.m(), 17.0 );</span></a>
<a name="721"><span class="lineNum">     721 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.isEmpty() );</span></a>
<a name="722"><span class="lineNum">     722 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.is3D() );</span></a>
<a name="723"><span class="lineNum">     723 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.isMeasure() );</span></a>
<a name="724"><span class="lineNum">     724 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wkbType(), QgsWkbTypes::PointM );</span></a>
<a name="725"><span class="lineNum">     725 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wktTypeStr(), QString( &quot;PointM&quot; ) );</span></a>
<a name="726"><span class="lineNum">     726 </span>                :            : </a>
<a name="727"><span class="lineNum">     727 </span>                :<span class="lineCov">          1 :   QgsPoint p7( QgsWkbTypes::PointZM, 11.0, 13.0, 0.0, 17.0 );</span></a>
<a name="728"><span class="lineNum">     728 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.x(), 11.0 );</span></a>
<a name="729"><span class="lineNum">     729 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.y(), 13.0 );</span></a>
<a name="730"><span class="lineNum">     730 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.m(), 17.0 );</span></a>
<a name="731"><span class="lineNum">     731 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.isEmpty() );</span></a>
<a name="732"><span class="lineNum">     732 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.is3D() );</span></a>
<a name="733"><span class="lineNum">     733 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.isMeasure() );</span></a>
<a name="734"><span class="lineNum">     734 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="735"><span class="lineNum">     735 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.wktTypeStr(), QString( &quot;PointZM&quot; ) );</span></a>
<a name="736"><span class="lineNum">     736 </span>                :            : </a>
<a name="737"><span class="lineNum">     737 </span>                :<span class="lineCov">          1 :   QgsPoint noZ( QgsWkbTypes::PointM, 11.0, 13.0, 15.0, 17.0 );</span></a>
<a name="738"><span class="lineNum">     738 </span>                :<span class="lineCov">          1 :   QCOMPARE( noZ.x(), 11.0 );</span></a>
<a name="739"><span class="lineNum">     739 </span>                :<span class="lineCov">          1 :   QCOMPARE( noZ.y(), 13.0 );</span></a>
<a name="740"><span class="lineNum">     740 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( noZ.z() ) );</span></a>
<a name="741"><span class="lineNum">     741 </span>                :<span class="lineCov">          1 :   QCOMPARE( noZ.m(), 17.0 );</span></a>
<a name="742"><span class="lineNum">     742 </span>                :<span class="lineCov">          1 :   QCOMPARE( noZ.wkbType(), QgsWkbTypes::PointM );</span></a>
<a name="743"><span class="lineNum">     743 </span>                :            : </a>
<a name="744"><span class="lineNum">     744 </span>                :<span class="lineCov">          1 :   QgsPoint noM( QgsWkbTypes::PointZ, 11.0, 13.0, 17.0, 18.0 );</span></a>
<a name="745"><span class="lineNum">     745 </span>                :<span class="lineCov">          1 :   QCOMPARE( noM.x(), 11.0 );</span></a>
<a name="746"><span class="lineNum">     746 </span>                :<span class="lineCov">          1 :   QCOMPARE( noM.y(), 13.0 );</span></a>
<a name="747"><span class="lineNum">     747 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( noM.m() ) );</span></a>
<a name="748"><span class="lineNum">     748 </span>                :<span class="lineCov">          1 :   QCOMPARE( noM.z(), 17.0 );</span></a>
<a name="749"><span class="lineNum">     749 </span>                :<span class="lineCov">          1 :   QCOMPARE( noM.wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="750"><span class="lineNum">     750 </span>                :            : </a>
<a name="751"><span class="lineNum">     751 </span>                :<span class="lineCov">          1 :   QgsPoint p8( QgsWkbTypes::Point25D, 21.0, 23.0, 25.0 );</span></a>
<a name="752"><span class="lineNum">     752 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.x(), 21.0 );</span></a>
<a name="753"><span class="lineNum">     753 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.y(), 23.0 );</span></a>
<a name="754"><span class="lineNum">     754 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.z(), 25.0 );</span></a>
<a name="755"><span class="lineNum">     755 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.isEmpty() );</span></a>
<a name="756"><span class="lineNum">     756 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.is3D() );</span></a>
<a name="757"><span class="lineNum">     757 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.isMeasure() );</span></a>
<a name="758"><span class="lineNum">     758 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.wkbType(), QgsWkbTypes::Point25D );</span></a>
<a name="759"><span class="lineNum">     759 </span>                :            : </a>
<a name="760"><span class="lineNum">     760 </span>                :<span class="lineCov">          1 :   QgsPoint pp( QgsWkbTypes::Point );</span></a>
<a name="761"><span class="lineNum">     761 </span>                :<span class="lineCov">          1 :   QVERIFY( !pp.is3D() );</span></a>
<a name="762"><span class="lineNum">     762 </span>                :<span class="lineCov">          1 :   QVERIFY( !pp.isMeasure() );</span></a>
<a name="763"><span class="lineNum">     763 </span>                :            : </a>
<a name="764"><span class="lineNum">     764 </span>                :<span class="lineCov">          1 :   QgsPoint ppz( QgsWkbTypes::PointZ );</span></a>
<a name="765"><span class="lineNum">     765 </span>                :<span class="lineCov">          1 :   QVERIFY( ppz.is3D() );</span></a>
<a name="766"><span class="lineNum">     766 </span>                :<span class="lineCov">          1 :   QVERIFY( !ppz.isMeasure() );</span></a>
<a name="767"><span class="lineNum">     767 </span>                :            : </a>
<a name="768"><span class="lineNum">     768 </span>                :<span class="lineCov">          1 :   QgsPoint ppm( QgsWkbTypes::PointM );</span></a>
<a name="769"><span class="lineNum">     769 </span>                :<span class="lineCov">          1 :   QVERIFY( !ppm.is3D() );</span></a>
<a name="770"><span class="lineNum">     770 </span>                :<span class="lineCov">          1 :   QVERIFY( ppm.isMeasure() );</span></a>
<a name="771"><span class="lineNum">     771 </span>                :            : </a>
<a name="772"><span class="lineNum">     772 </span>                :<span class="lineCov">          1 :   QgsPoint ppzm( QgsWkbTypes::PointZM );</span></a>
<a name="773"><span class="lineNum">     773 </span>                :<span class="lineCov">          1 :   QVERIFY( ppzm.is3D() );</span></a>
<a name="774"><span class="lineNum">     774 </span>                :<span class="lineCov">          1 :   QVERIFY( ppzm.isMeasure() );</span></a>
<a name="775"><span class="lineNum">     775 </span>                :            : </a>
<a name="776"><span class="lineNum">     776 </span>                :            : #if 0 //should trigger an assert</a>
<a name="777"><span class="lineNum">     777 </span>                :            :   //try creating a point with a nonsense WKB type</a>
<a name="778"><span class="lineNum">     778 </span>                :            :   QgsPoint p9( QgsWkbTypes::PolygonZM, 11.0, 13.0, 9.0, 17.0 );</a>
<a name="779"><span class="lineNum">     779 </span>                :            :   QCOMPARE( p9.wkbType(), QgsWkbTypes::Unknown );</a>
<a name="780"><span class="lineNum">     780 </span>                :            : #endif</a>
<a name="781"><span class="lineNum">     781 </span>                :            : </a>
<a name="782"><span class="lineNum">     782 </span>                :            :   //test equality operator</a>
<a name="783"><span class="lineNum">     783 </span>                :            : </a>
<a name="784"><span class="lineNum">     784 </span>                :<span class="lineCov">          1 :   QgsPoint pRight, pLeft;</span></a>
<a name="785"><span class="lineNum">     785 </span>                :<span class="lineCov">          1 :   QVERIFY( pRight.isEmpty() );</span></a>
<a name="786"><span class="lineNum">     786 </span>                :<span class="lineCov">          1 :   QVERIFY( pLeft.isEmpty() );</span></a>
<a name="787"><span class="lineNum">     787 </span>                :<span class="lineCov">          1 :   QVERIFY( pLeft == pRight );</span></a>
<a name="788"><span class="lineNum">     788 </span>                :<span class="lineCov">          1 :   pRight.setX( 1 );</span></a>
<a name="789"><span class="lineNum">     789 </span>                :<span class="lineCov">          1 :   pLeft.setY( 1 );</span></a>
<a name="790"><span class="lineNum">     790 </span>                :<span class="lineCov">          1 :   QVERIFY( pRight.isEmpty() );</span></a>
<a name="791"><span class="lineNum">     791 </span>                :<span class="lineCov">          1 :   QVERIFY( pLeft.isEmpty() );</span></a>
<a name="792"><span class="lineNum">     792 </span>                :<span class="lineCov">          1 :   QVERIFY( pLeft != pRight );</span></a>
<a name="793"><span class="lineNum">     793 </span>                :<span class="lineCov">          1 :   pRight.setY( 1 );</span></a>
<a name="794"><span class="lineNum">     794 </span>                :<span class="lineCov">          1 :   pLeft.setX( 1 );</span></a>
<a name="795"><span class="lineNum">     795 </span>                :<span class="lineCov">          1 :   QVERIFY( !pRight.isEmpty() );</span></a>
<a name="796"><span class="lineNum">     796 </span>                :<span class="lineCov">          1 :   QVERIFY( !pLeft.isEmpty() );</span></a>
<a name="797"><span class="lineNum">     797 </span>                :<span class="lineCov">          1 :   QVERIFY( pLeft == pRight );</span></a>
<a name="798"><span class="lineNum">     798 </span>                :            : </a>
<a name="799"><span class="lineNum">     799 </span>                :            : </a>
<a name="800"><span class="lineNum">     800 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) );</span></a>
<a name="801"><span class="lineNum">     801 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::PointZ, 2 / 3.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) ) );</span></a>
<a name="802"><span class="lineNum">     802 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::Point, 1 / 3.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) ) );</span></a>
<a name="803"><span class="lineNum">     803 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 2 / 3.0 ) == QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) ) );</span></a>
<a name="804"><span class="lineNum">     804 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 1 / 3.0 ) );</span></a>
<a name="805"><span class="lineNum">     805 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZM, 3.0, 4.0, 1 / 3.0 ) ) );</span></a>
<a name="806"><span class="lineNum">     806 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 2 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 1 / 3.0 ) ) );</span></a>
<a name="807"><span class="lineNum">     807 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::PointM, 3.0, 4.0, 0.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointM, 3.0, 4.0, 0.0, 1 / 3.0 ) );</span></a>
<a name="808"><span class="lineNum">     808 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::PointM, 3.0, 4.0, 0.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 0.0, 1 / 3.0 ) ) );</span></a>
<a name="809"><span class="lineNum">     809 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::PointM, 3.0, 4.0, 0.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointM, 3.0, 4.0, 0.0, 2 / 3.0 ) ) );</span></a>
<a name="810"><span class="lineNum">     810 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::PointZM, 3.0, 4.0, 2 / 3.0, 1 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZM, 3.0, 4.0, 2 / 3.0, 1 / 3.0 ) );</span></a>
<a name="811"><span class="lineNum">     811 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::Point25D, 3.0, 4.0, 2 / 3.0 ) == QgsPoint( QgsWkbTypes::Point25D, 3.0, 4.0, 2 / 3.0 ) );</span></a>
<a name="812"><span class="lineNum">     812 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::Point25D, 3.0, 4.0, 2 / 3.0 ) == QgsPoint( QgsWkbTypes::PointZ, 3.0, 4.0, 2 / 3.0 ) ) );</span></a>
<a name="813"><span class="lineNum">     813 </span>                :            :   //test inequality operator</a>
<a name="814"><span class="lineNum">     814 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) != QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) ) );</span></a>
<a name="815"><span class="lineNum">     815 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 1 / 3.0 ) != QgsPoint( QgsWkbTypes::PointZ, 2 / 3.0, 1 / 3.0 ) );</span></a>
<a name="816"><span class="lineNum">     816 </span>                :            : </a>
<a name="817"><span class="lineNum">     817 </span>                :<span class="lineCov">          1 :   QgsLineString nonPoint;</span></a>
<a name="818"><span class="lineNum">     818 </span>                :<span class="lineCov">          1 :   QVERIFY( p8 != nonPoint );</span></a>
<a name="819"><span class="lineNum">     819 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p8 == nonPoint ) );</span></a>
<a name="820"><span class="lineNum">     820 </span>                :            : </a>
<a name="821"><span class="lineNum">     821 </span>                :            :   //test setters and getters</a>
<a name="822"><span class="lineNum">     822 </span>                :            :   //x</a>
<a name="823"><span class="lineNum">     823 </span>                :<span class="lineCov">          1 :   QgsPoint p10( QgsWkbTypes::PointZM );</span></a>
<a name="824"><span class="lineNum">     824 </span>                :<span class="lineCov">          1 :   p10.setX( 5.0 );</span></a>
<a name="825"><span class="lineNum">     825 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.x(), 5.0 );</span></a>
<a name="826"><span class="lineNum">     826 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.rx(), 5.0 );</span></a>
<a name="827"><span class="lineNum">     827 </span>                :<span class="lineCov">          1 :   p10.rx() = 9.0;</span></a>
<a name="828"><span class="lineNum">     828 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.x(), 9.0 );</span></a>
<a name="829"><span class="lineNum">     829 </span>                :            :   //y</a>
<a name="830"><span class="lineNum">     830 </span>                :<span class="lineCov">          1 :   p10.setY( 7.0 );</span></a>
<a name="831"><span class="lineNum">     831 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.y(), 7.0 );</span></a>
<a name="832"><span class="lineNum">     832 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.ry(), 7.0 );</span></a>
<a name="833"><span class="lineNum">     833 </span>                :<span class="lineCov">          1 :   p10.ry() = 3.0;</span></a>
<a name="834"><span class="lineNum">     834 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.y(), 3.0 );</span></a>
<a name="835"><span class="lineNum">     835 </span>                :            :   //z</a>
<a name="836"><span class="lineNum">     836 </span>                :<span class="lineCov">          1 :   p10.setZ( 17.0 );</span></a>
<a name="837"><span class="lineNum">     837 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.is3D(), true );</span></a>
<a name="838"><span class="lineNum">     838 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.z(), 17.0 );</span></a>
<a name="839"><span class="lineNum">     839 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.rz(), 17.0 );</span></a>
<a name="840"><span class="lineNum">     840 </span>                :<span class="lineCov">          1 :   p10.rz() = 13.0;</span></a>
<a name="841"><span class="lineNum">     841 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.z(), 13.0 );</span></a>
<a name="842"><span class="lineNum">     842 </span>                :            :   //m</a>
<a name="843"><span class="lineNum">     843 </span>                :<span class="lineCov">          1 :   p10.setM( 27.0 );</span></a>
<a name="844"><span class="lineNum">     844 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.m(), 27.0 );</span></a>
<a name="845"><span class="lineNum">     845 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.rm(), 27.0 );</span></a>
<a name="846"><span class="lineNum">     846 </span>                :<span class="lineCov">          1 :   p10.rm() = 23.0;</span></a>
<a name="847"><span class="lineNum">     847 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.m(), 23.0 );</span></a>
<a name="848"><span class="lineNum">     848 </span>                :            : </a>
<a name="849"><span class="lineNum">     849 </span>                :            :   //other checks</a>
<a name="850"><span class="lineNum">     850 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.geometryType(), QString( &quot;Point&quot; ) );</span></a>
<a name="851"><span class="lineNum">     851 </span>                :<span class="lineCov">          1 :   QCOMPARE( p10.dimension(), 0 );</span></a>
<a name="852"><span class="lineNum">     852 </span>                :            : </a>
<a name="853"><span class="lineNum">     853 </span>                :            :   //clone</a>
<a name="854"><span class="lineNum">     854 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPoint &gt;clone( p10.clone() );</span></a>
<a name="855"><span class="lineNum">     855 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == *clone );</span></a>
<a name="856"><span class="lineNum">     856 </span>                :            : </a>
<a name="857"><span class="lineNum">     857 </span>                :            :   //toCurveType</a>
<a name="858"><span class="lineNum">     858 </span>                :<span class="lineCov">          1 :   clone.reset( p10.toCurveType() );</span></a>
<a name="859"><span class="lineNum">     859 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == *clone );</span></a>
<a name="860"><span class="lineNum">     860 </span>                :            : </a>
<a name="861"><span class="lineNum">     861 </span>                :            :   //assignment</a>
<a name="862"><span class="lineNum">     862 </span>                :<span class="lineCov">          1 :   QgsPoint original( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, -4.0 );</span></a>
<a name="863"><span class="lineNum">     863 </span>                :<span class="lineCov">          1 :   QgsPoint assigned( 6.0, 7.0 );</span></a>
<a name="864"><span class="lineNum">     864 </span>                :<span class="lineCov">          1 :   assigned = original;</span></a>
<a name="865"><span class="lineNum">     865 </span>                :<span class="lineCov">          1 :   QVERIFY( assigned == original );</span></a>
<a name="866"><span class="lineNum">     866 </span>                :            : </a>
<a name="867"><span class="lineNum">     867 </span>                :            :   //clear</a>
<a name="868"><span class="lineNum">     868 </span>                :<span class="lineCov">          1 :   QgsPoint p11( 5.0, 6.0 );</span></a>
<a name="869"><span class="lineNum">     869 </span>                :<span class="lineCov">          1 :   p11.clear();</span></a>
<a name="870"><span class="lineNum">     870 </span>                :<span class="lineCov">          1 :   QCOMPARE( p11.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="871"><span class="lineNum">     871 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p11.x() ) );</span></a>
<a name="872"><span class="lineNum">     872 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p11.y() ) );</span></a>
<a name="873"><span class="lineNum">     873 </span>                :            : </a>
<a name="874"><span class="lineNum">     874 </span>                :            :   //toQPointF</a>
<a name="875"><span class="lineNum">     875 </span>                :<span class="lineCov">          1 :   QgsPoint p11a( 5.0, 9.0 );</span></a>
<a name="876"><span class="lineNum">     876 </span>                :<span class="lineCov">          1 :   QPointF result = p11a.toQPointF();</span></a>
<a name="877"><span class="lineNum">     877 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( result.x(), 5.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="878"><span class="lineNum">     878 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( result.y(), 9.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="879"><span class="lineNum">     879 </span>                :            : </a>
<a name="880"><span class="lineNum">     880 </span>                :            :   //to/from WKB</a>
<a name="881"><span class="lineNum">     881 </span>                :<span class="lineCov">          1 :   QgsPoint p12( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, -4.0 );</span></a>
<a name="882"><span class="lineNum">     882 </span>                :<span class="lineCov">          1 :   QByteArray wkb12 = p12.asWkb();</span></a>
<a name="883"><span class="lineNum">     883 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb12.size(), p12.wkbSize() );</span></a>
<a name="884"><span class="lineNum">     884 </span>                :<span class="lineCov">          1 :   QgsPoint p13;</span></a>
<a name="885"><span class="lineNum">     885 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb12ptr( wkb12 );</span></a>
<a name="886"><span class="lineNum">     886 </span>                :<span class="lineCov">          1 :   p13.fromWkb( wkb12ptr );</span></a>
<a name="887"><span class="lineNum">     887 </span>                :<span class="lineCov">          1 :   QVERIFY( p13 == p12 );</span></a>
<a name="888"><span class="lineNum">     888 </span>                :            : </a>
<a name="889"><span class="lineNum">     889 </span>                :            :   //bad WKB - check for no crash</a>
<a name="890"><span class="lineNum">     890 </span>                :<span class="lineCov">          1 :   p13 = QgsPoint( 1, 2 );</span></a>
<a name="891"><span class="lineNum">     891 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="892"><span class="lineNum">     892 </span>                :<span class="lineCov">          1 :   QVERIFY( !p13.fromWkb( nullPtr ) );</span></a>
<a name="893"><span class="lineNum">     893 </span>                :<span class="lineCov">          1 :   QCOMPARE( p13.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="894"><span class="lineNum">     894 </span>                :<span class="lineCov">          1 :   QgsLineString line;</span></a>
<a name="895"><span class="lineNum">     895 </span>                :<span class="lineCov">          1 :   p13 = QgsPoint( 1, 2 );</span></a>
<a name="896"><span class="lineNum">     896 </span>                :<span class="lineCov">          1 :   QByteArray wkbLine = line.asWkb();</span></a>
<a name="897"><span class="lineNum">     897 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkbLine.size(), line.wkbSize() );</span></a>
<a name="898"><span class="lineNum">     898 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbLinePtr( wkbLine );</span></a>
<a name="899"><span class="lineNum">     899 </span>                :<span class="lineCov">          1 :   QVERIFY( !p13.fromWkb( wkbLinePtr ) );</span></a>
<a name="900"><span class="lineNum">     900 </span>                :<span class="lineCov">          1 :   QCOMPARE( p13.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="901"><span class="lineNum">     901 </span>                :            : </a>
<a name="902"><span class="lineNum">     902 </span>                :            :   //to/from WKT</a>
<a name="903"><span class="lineNum">     903 </span>                :<span class="lineCov">          1 :   p13 = QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, -4.0 );</span></a>
<a name="904"><span class="lineNum">     904 </span>                :<span class="lineCov">          1 :   QString wkt = p13.asWkt();</span></a>
<a name="905"><span class="lineNum">     905 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="906"><span class="lineNum">     906 </span>                :<span class="lineCov">          1 :   QgsPoint p14;</span></a>
<a name="907"><span class="lineNum">     907 </span>                :<span class="lineCov">          1 :   QVERIFY( p14.fromWkt( wkt ) );</span></a>
<a name="908"><span class="lineNum">     908 </span>                :<span class="lineCov">          1 :   QVERIFY( p14 == p13 );</span></a>
<a name="909"><span class="lineNum">     909 </span>                :            : </a>
<a name="910"><span class="lineNum">     910 </span>                :            :   //bad WKT</a>
<a name="911"><span class="lineNum">     911 </span>                :<span class="lineCov">          1 :   QVERIFY( !p14.fromWkt( &quot;Polygon()&quot; ) );</span></a>
<a name="912"><span class="lineNum">     912 </span>                :<span class="lineCov">          1 :   QVERIFY( !p14.fromWkt( &quot;Point(1 )&quot; ) );</span></a>
<a name="913"><span class="lineNum">     913 </span>                :            : </a>
<a name="914"><span class="lineNum">     914 </span>                :            :   //asGML2</a>
<a name="915"><span class="lineNum">     915 </span>                :<span class="lineCov">          1 :   QgsPoint exportPoint( 1, 2 );</span></a>
<a name="916"><span class="lineNum">     916 </span>                :<span class="lineCov">          1 :   QgsPoint exportPointFloat( 1 / 3.0, 2 / 3.0 );</span></a>
<a name="917"><span class="lineNum">     917 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="918"><span class="lineNum">     918 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1,2&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="919"><span class="lineNum">     919 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPoint.asGml2( doc ) ), expectedGML2 );</span></a>
<a name="920"><span class="lineNum">     920 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.333,0.667&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="921"><span class="lineNum">     921 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPointFloat.asGml2( doc, 3 ) ), expectedGML2prec3 );</span></a>
<a name="922"><span class="lineNum">     922 </span>                :            : </a>
<a name="923"><span class="lineNum">     923 </span>                :            :   //asGML3</a>
<a name="924"><span class="lineNum">     924 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1 2&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="925"><span class="lineNum">     925 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPoint.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="926"><span class="lineNum">     926 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.333 0.667&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="927"><span class="lineNum">     927 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPointFloat.asGml3( doc, 3 ) ), expectedGML3prec3 );</span></a>
<a name="928"><span class="lineNum">     928 </span>                :<span class="lineCov">          1 :   QgsPoint exportPointZ( 1, 2, 3 );</span></a>
<a name="929"><span class="lineNum">     929 </span>                :<span class="lineCov">          2 :   QString expectedGML3Z( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;1 2 3&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="930"><span class="lineNum">     930 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPointZ.asGml3( doc, 3 ) ), expectedGML3Z );</span></a>
<a name="931"><span class="lineNum">     931 </span>                :            : </a>
<a name="932"><span class="lineNum">     932 </span>                :            :   //asGML2 inverted axis</a>
<a name="933"><span class="lineNum">     933 </span>                :<span class="lineCov">          1 :   QgsPoint exportPointInvertedAxis( 1, 2 );</span></a>
<a name="934"><span class="lineNum">     934 </span>                :<span class="lineCov">          1 :   QgsPoint exportPointFloatInvertedAxis( 1 / 3.0, 2 / 3.0 );</span></a>
<a name="935"><span class="lineNum">     935 </span>                :<span class="lineCov">          2 :   QDomDocument docInvertedAxis( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="936"><span class="lineNum">     936 </span>                :<span class="lineCov">          2 :   QString expectedGML2InvertedAxis( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;2,1&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="937"><span class="lineNum">     937 </span>                :<span class="lineCov">          4 :   QGSCOMPAREGML( elemToString( exportPointInvertedAxis.asGml2( docInvertedAxis, 17, QStringLiteral( &quot;gml&quot; ), QgsAbstractGeometry::AxisOrder::YX ) ), expectedGML2InvertedAxis );</span></a>
<a name="938"><span class="lineNum">     938 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3InvertedAxis( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.667,0.333&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="939"><span class="lineNum">     939 </span>                :<span class="lineCov">          4 :   QGSCOMPAREGML( elemToString( exportPointFloatInvertedAxis.asGml2( docInvertedAxis, 3, QStringLiteral( &quot;gml&quot; ), QgsAbstractGeometry::AxisOrder::YX ) ), expectedGML2prec3InvertedAxis );</span></a>
<a name="940"><span class="lineNum">     940 </span>                :            : </a>
<a name="941"><span class="lineNum">     941 </span>                :            :   //asGML3 inverted axis</a>
<a name="942"><span class="lineNum">     942 </span>                :<span class="lineCov">          2 :   QString expectedGML3InvertedAxis( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;2 1&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="943"><span class="lineNum">     943 </span>                :<span class="lineCov">          2 :   QCOMPARE( elemToString( exportPointInvertedAxis.asGml3( docInvertedAxis, 17, QStringLiteral( &quot;gml&quot; ), QgsAbstractGeometry::AxisOrder::YX ) ), expectedGML3InvertedAxis );</span></a>
<a name="944"><span class="lineNum">     944 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3InvertedAxis( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.667 0.333&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="945"><span class="lineNum">     945 </span>                :<span class="lineCov">          2 :   QCOMPARE( elemToString( exportPointFloatInvertedAxis.asGml3( docInvertedAxis, 3, QStringLiteral( &quot;gml&quot; ), QgsAbstractGeometry::AxisOrder::YX ) ), expectedGML3prec3InvertedAxis );</span></a>
<a name="946"><span class="lineNum">     946 </span>                :<span class="lineCov">          1 :   QgsPoint exportPointZInvertedAxis( 1, 2, 3 );</span></a>
<a name="947"><span class="lineNum">     947 </span>                :<span class="lineCov">          2 :   QString expectedGML3ZInvertedAxis( QStringLiteral( &quot;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;2 1 3&lt;/pos&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="948"><span class="lineNum">     948 </span>                :<span class="lineCov">          4 :   QGSCOMPAREGML( elemToString( exportPointZInvertedAxis.asGml3( docInvertedAxis, 3, QStringLiteral( &quot;gml&quot; ), QgsAbstractGeometry::AxisOrder::YX ) ), expectedGML3ZInvertedAxis );</span></a>
<a name="949"><span class="lineNum">     949 </span>                :            : </a>
<a name="950"><span class="lineNum">     950 </span>                :            : </a>
<a name="951"><span class="lineNum">     951 </span>                :            :   //asJSON</a>
<a name="952"><span class="lineNum">     952 </span>                :<span class="lineCov">          2 :   QString expectedJson( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[1.0,2.0],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; ) );</span></a>
<a name="953"><span class="lineNum">     953 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPoint.asJson(), expectedJson );</span></a>
<a name="954"><span class="lineNum">     954 </span>                :<span class="lineCov">          2 :   QString expectedJsonPrec3( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[0.333,0.667],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; ) );</span></a>
<a name="955"><span class="lineNum">     955 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPointFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="956"><span class="lineNum">     956 </span>                :            : </a>
<a name="957"><span class="lineNum">     957 </span>                :            :   //asKML</a>
<a name="958"><span class="lineNum">     958 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;Point&gt;&lt;coordinates&gt;1,2&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="959"><span class="lineNum">     959 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPoint.asKml(), expectedKml );</span></a>
<a name="960"><span class="lineNum">     960 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;Point&gt;&lt;coordinates&gt;0.333,0.667&lt;/coordinates&gt;&lt;/Point&gt;&quot; ) );</span></a>
<a name="961"><span class="lineNum">     961 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPointFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="962"><span class="lineNum">     962 </span>                :            : </a>
<a name="963"><span class="lineNum">     963 </span>                :            :   //bounding box</a>
<a name="964"><span class="lineNum">     964 </span>                :<span class="lineCov">          1 :   QgsPoint p15( 1.0, 2.0 );</span></a>
<a name="965"><span class="lineNum">     965 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 1.0, 2.0, 1.0, 2.0 ) );</span></a>
<a name="966"><span class="lineNum">     966 </span>                :            :   //modify points and test that bounding box is updated accordingly</a>
<a name="967"><span class="lineNum">     967 </span>                :<span class="lineCov">          1 :   p15.setX( 3.0 );</span></a>
<a name="968"><span class="lineNum">     968 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 3.0, 2.0, 3.0, 2.0 ) );</span></a>
<a name="969"><span class="lineNum">     969 </span>                :<span class="lineCov">          1 :   p15.setY( 6.0 );</span></a>
<a name="970"><span class="lineNum">     970 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 3.0, 6.0, 3.0, 6.0 ) );</span></a>
<a name="971"><span class="lineNum">     971 </span>                :<span class="lineCov">          1 :   p15.rx() = 4.0;</span></a>
<a name="972"><span class="lineNum">     972 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 4.0, 6.0, 4.0, 6.0 ) );</span></a>
<a name="973"><span class="lineNum">     973 </span>                :<span class="lineCov">          1 :   p15.ry() = 9.0;</span></a>
<a name="974"><span class="lineNum">     974 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 4.0, 9.0, 4.0, 9.0 ) );</span></a>
<a name="975"><span class="lineNum">     975 </span>                :<span class="lineCov">          1 :   p15.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 11.0, 13.0 ) );</span></a>
<a name="976"><span class="lineNum">     976 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 11.0, 13.0, 11.0, 13.0 ) );</span></a>
<a name="977"><span class="lineNum">     977 </span>                :<span class="lineCov">          1 :   p15 = QgsPoint( 21.0, 23.0 );</span></a>
<a name="978"><span class="lineNum">     978 </span>                :<span class="lineCov">          1 :   QCOMPARE( p15.boundingBox(), QgsRectangle( 21.0, 23.0, 21.0, 23.0 ) );</span></a>
<a name="979"><span class="lineNum">     979 </span>                :            : </a>
<a name="980"><span class="lineNum">     980 </span>                :            :   //CRS transform</a>
<a name="981"><span class="lineNum">     981 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="982"><span class="lineNum">     982 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) ); // want a transform with ellipsoid change</span></a>
<a name="983"><span class="lineNum">     983 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="984"><span class="lineNum">     984 </span>                :<span class="lineCov">          1 :   QgsPoint p16( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 );</span></a>
<a name="985"><span class="lineNum">     985 </span>                :<span class="lineCov">          1 :   p16.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="986"><span class="lineNum">     986 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.x(), 175.771, 0.001 );</span></a>
<a name="987"><span class="lineNum">     987 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.y(), -39.724, 0.001 );</span></a>
<a name="988"><span class="lineNum">     988 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.z(), 1.0, 0.001 );</span></a>
<a name="989"><span class="lineNum">     989 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16.m(), 2.0 );</span></a>
<a name="990"><span class="lineNum">     990 </span>                :<span class="lineCov">          1 :   p16.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="991"><span class="lineNum">     991 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.x(), 6374985, 1 );</span></a>
<a name="992"><span class="lineNum">     992 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.y(), -3626584, 1 );</span></a>
<a name="993"><span class="lineNum">     993 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p16.z(), 1.0, 0.001 );</span></a>
<a name="994"><span class="lineNum">     994 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16.m(), 2.0 );</span></a>
<a name="995"><span class="lineNum">     995 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="996"><span class="lineNum">     996 </span>                :            :   //test with z transform</a>
<a name="997"><span class="lineNum">     997 </span>                :            :   p16.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="998"><span class="lineNum">     998 </span>                :            :   QGSCOMPARENEAR( p16.z(), -19.249, 0.001 );</a>
<a name="999"><span class="lineNum">     999 </span>                :            :   p16.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="1000"><span class="lineNum">    1000 </span>                :            :   QGSCOMPARENEAR( p16.z(), 1.0, 0.001 );</a>
<a name="1001"><span class="lineNum">    1001 </span>                :            : #endif</a>
<a name="1002"><span class="lineNum">    1002 </span>                :            :   //QTransform transform</a>
<a name="1003"><span class="lineNum">    1003 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="1004"><span class="lineNum">    1004 </span>                :<span class="lineCov">          1 :   QgsPoint p17( QgsWkbTypes::PointZM, 10, 20, 30, 40 );</span></a>
<a name="1005"><span class="lineNum">    1005 </span>                :<span class="lineCov">          1 :   p17.transform( qtr );</span></a>
<a name="1006"><span class="lineNum">    1006 </span>                :<span class="lineCov">          1 :   QVERIFY( p17 == QgsPoint( QgsWkbTypes::PointZM, 20, 60, 30, 40 ) );</span></a>
<a name="1007"><span class="lineNum">    1007 </span>                :<span class="lineCov">          1 :   p17.transform( QTransform::fromScale( 1, 1 ), 11, 2, 3, 4 );</span></a>
<a name="1008"><span class="lineNum">    1008 </span>                :<span class="lineCov">          1 :   QVERIFY( p17 == QgsPoint( QgsWkbTypes::PointZM, 20, 60, 71, 163 ) );</span></a>
<a name="1009"><span class="lineNum">    1009 </span>                :            : </a>
<a name="1010"><span class="lineNum">    1010 </span>                :            :   //coordinateSequence</a>
<a name="1011"><span class="lineNum">    1011 </span>                :<span class="lineCov">          1 :   QgsPoint p18( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 );</span></a>
<a name="1012"><span class="lineNum">    1012 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence coord = p18.coordinateSequence();</span></a>
<a name="1013"><span class="lineNum">    1013 </span>                :<span class="lineCov">          1 :   QCOMPARE( coord.count(), 1 );</span></a>
<a name="1014"><span class="lineNum">    1014 </span>                :<span class="lineCov">          1 :   QCOMPARE( coord.at( 0 ).count(), 1 );</span></a>
<a name="1015"><span class="lineNum">    1015 </span>                :<span class="lineCov">          1 :   QCOMPARE( coord.at( 0 ).at( 0 ).count(), 1 );</span></a>
<a name="1016"><span class="lineNum">    1016 </span>                :<span class="lineCov">          1 :   QCOMPARE( coord.at( 0 ).at( 0 ).at( 0 ), p18 );</span></a>
<a name="1017"><span class="lineNum">    1017 </span>                :            : </a>
<a name="1018"><span class="lineNum">    1018 </span>                :            :   //low level editing</a>
<a name="1019"><span class="lineNum">    1019 </span>                :            :   //insertVertex should have no effect</a>
<a name="1020"><span class="lineNum">    1020 </span>                :<span class="lineCov">          1 :   QgsPoint p19( QgsWkbTypes::PointZM, 3.0, 4.0, 6.0, 7.0 );</span></a>
<a name="1021"><span class="lineNum">    1021 </span>                :<span class="lineCov">          1 :   p19.insertVertex( QgsVertexId( 1, 2, 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="1022"><span class="lineNum">    1022 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 3.0, 4.0, 6.0, 7.0 ) );</span></a>
<a name="1023"><span class="lineNum">    1023 </span>                :            : </a>
<a name="1024"><span class="lineNum">    1024 </span>                :            :   //moveVertex</a>
<a name="1025"><span class="lineNum">    1025 </span>                :<span class="lineCov">          1 :   p19.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="1026"><span class="lineNum">    1026 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="1027"><span class="lineNum">    1027 </span>                :            :   //invalid vertex id, should not crash</a>
<a name="1028"><span class="lineNum">    1028 </span>                :<span class="lineCov">          1 :   p19.moveVertex( QgsVertexId( 1, 2, 3 ), QgsPoint( QgsWkbTypes::PointZM, 2.0, 3.0, 1.0, 2.0 ) );</span></a>
<a name="1029"><span class="lineNum">    1029 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 2.0, 3.0, 1.0, 2.0 ) );</span></a>
<a name="1030"><span class="lineNum">    1030 </span>                :            :   //move PointZM using Point</a>
<a name="1031"><span class="lineNum">    1031 </span>                :<span class="lineCov">          1 :   p19.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) );</span></a>
<a name="1032"><span class="lineNum">    1032 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 11.0, 12.0, 1.0, 2.0 ) );</span></a>
<a name="1033"><span class="lineNum">    1033 </span>                :            :   //move PointZM using PointZ</a>
<a name="1034"><span class="lineNum">    1034 </span>                :<span class="lineCov">          1 :   p19.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 21.0, 22.0, 23.0 ) );</span></a>
<a name="1035"><span class="lineNum">    1035 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 21.0, 22.0, 23.0, 2.0 ) );</span></a>
<a name="1036"><span class="lineNum">    1036 </span>                :            :   //move PointZM using PointM</a>
<a name="1037"><span class="lineNum">    1037 </span>                :<span class="lineCov">          1 :   p19.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointM, 31.0, 32.0, 0.0, 43.0 ) );</span></a>
<a name="1038"><span class="lineNum">    1038 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19, QgsPoint( QgsWkbTypes::PointZM, 31.0, 32.0, 23.0, 43.0 ) );</span></a>
<a name="1039"><span class="lineNum">    1039 </span>                :            :   //move Point using PointZM (z/m should be ignored)</a>
<a name="1040"><span class="lineNum">    1040 </span>                :<span class="lineCov">          1 :   QgsPoint p20( 3.0, 4.0 );</span></a>
<a name="1041"><span class="lineNum">    1041 </span>                :<span class="lineCov">          1 :   p20.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 2.0, 3.0, 1.0, 2.0 ) );</span></a>
<a name="1042"><span class="lineNum">    1042 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20, QgsPoint( 2.0, 3.0 ) );</span></a>
<a name="1043"><span class="lineNum">    1043 </span>                :            : </a>
<a name="1044"><span class="lineNum">    1044 </span>                :            :   //deleteVertex - should do nothing, but not crash</a>
<a name="1045"><span class="lineNum">    1045 </span>                :<span class="lineCov">          1 :   p20.deleteVertex( QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="1046"><span class="lineNum">    1046 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20, QgsPoint( 2.0, 3.0 ) );</span></a>
<a name="1047"><span class="lineNum">    1047 </span>                :            : </a>
<a name="1048"><span class="lineNum">    1048 </span>                :            :   // closestSegment</a>
<a name="1049"><span class="lineNum">    1049 </span>                :<span class="lineCov">          1 :   QgsPoint closest;</span></a>
<a name="1050"><span class="lineNum">    1050 </span>                :<span class="lineCov">          1 :   QgsVertexId after;</span></a>
<a name="1051"><span class="lineNum">    1051 </span>                :            :   // return error - points have no segments</a>
<a name="1052"><span class="lineNum">    1052 </span>                :<span class="lineCov">          1 :   QVERIFY( p20.closestSegment( QgsPoint( 4.0, 6.0 ), closest, after ) &lt; 0 );</span></a>
<a name="1053"><span class="lineNum">    1053 </span>                :            : </a>
<a name="1054"><span class="lineNum">    1054 </span>                :            :   //nextVertex</a>
<a name="1055"><span class="lineNum">    1055 </span>                :<span class="lineCov">          1 :   QgsPoint p21( 3.0, 4.0 );</span></a>
<a name="1056"><span class="lineNum">    1056 </span>                :<span class="lineCov">          1 :   QgsPoint p22;</span></a>
<a name="1057"><span class="lineNum">    1057 </span>                :<span class="lineCov">          1 :   QgsVertexId v( 0, 0, -1 );</span></a>
<a name="1058"><span class="lineNum">    1058 </span>                :<span class="lineCov">          1 :   QVERIFY( p21.nextVertex( v, p22 ) );</span></a>
<a name="1059"><span class="lineNum">    1059 </span>                :<span class="lineCov">          1 :   QCOMPARE( p22, p21 );</span></a>
<a name="1060"><span class="lineNum">    1060 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="1061"><span class="lineNum">    1061 </span>                :            :   //no more vertices</a>
<a name="1062"><span class="lineNum">    1062 </span>                :<span class="lineCov">          1 :   QVERIFY( !p21.nextVertex( v, p22 ) );</span></a>
<a name="1063"><span class="lineNum">    1063 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -1 ); //test that ring number is maintained</span></a>
<a name="1064"><span class="lineNum">    1064 </span>                :<span class="lineCov">          1 :   QVERIFY( p21.nextVertex( v, p22 ) );</span></a>
<a name="1065"><span class="lineNum">    1065 </span>                :<span class="lineCov">          1 :   QCOMPARE( p22, p21 );</span></a>
<a name="1066"><span class="lineNum">    1066 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="1067"><span class="lineNum">    1067 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, -1 ); //test that part number is maintained</span></a>
<a name="1068"><span class="lineNum">    1068 </span>                :<span class="lineCov">          1 :   QVERIFY( p21.nextVertex( v, p22 ) );</span></a>
<a name="1069"><span class="lineNum">    1069 </span>                :<span class="lineCov">          1 :   QCOMPARE( p22, p21 );</span></a>
<a name="1070"><span class="lineNum">    1070 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="1071"><span class="lineNum">    1071 </span>                :            : </a>
<a name="1072"><span class="lineNum">    1072 </span>                :            :   //adjacent vertices - both should be invalid</a>
<a name="1073"><span class="lineNum">    1073 </span>                :<span class="lineCov">          1 :   QgsVertexId prev( 1, 2, 3 ); // start with something</span></a>
<a name="1074"><span class="lineNum">    1074 </span>                :<span class="lineCov">          1 :   QgsVertexId next( 4, 5, 6 );</span></a>
<a name="1075"><span class="lineNum">    1075 </span>                :<span class="lineCov">          1 :   p21.adjacentVertices( v, prev, next );</span></a>
<a name="1076"><span class="lineNum">    1076 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="1077"><span class="lineNum">    1077 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="1078"><span class="lineNum">    1078 </span>                :            : </a>
<a name="1079"><span class="lineNum">    1079 </span>                :            :   // vertex iterator</a>
<a name="1080"><span class="lineNum">    1080 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it1 = p21.vertices_begin();</span></a>
<a name="1081"><span class="lineNum">    1081 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it1end = p21.vertices_end();</span></a>
<a name="1082"><span class="lineNum">    1082 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it1, p21 );</span></a>
<a name="1083"><span class="lineNum">    1083 </span>                :<span class="lineCov">          1 :   QCOMPARE( it1.vertexId(), QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="1084"><span class="lineNum">    1084 </span>                :<span class="lineCov">          1 :   ++it1;</span></a>
<a name="1085"><span class="lineNum">    1085 </span>                :<span class="lineCov">          1 :   QCOMPARE( it1, it1end );</span></a>
<a name="1086"><span class="lineNum">    1086 </span>                :            : </a>
<a name="1087"><span class="lineNum">    1087 </span>                :            :   // Java-style iterator</a>
<a name="1088"><span class="lineNum">    1088 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2( &amp;p21 );</span></a>
<a name="1089"><span class="lineNum">    1089 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="1090"><span class="lineNum">    1090 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), p21 );</span></a>
<a name="1091"><span class="lineNum">    1091 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="1092"><span class="lineNum">    1092 </span>                :            : </a>
<a name="1093"><span class="lineNum">    1093 </span>                :            :   //vertexAt - will always be same as point</a>
<a name="1094"><span class="lineNum">    1094 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.vertexAt( QgsVertexId() ), p21 );</span></a>
<a name="1095"><span class="lineNum">    1095 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.vertexAt( QgsVertexId( 0, 0, 0 ) ), p21 );</span></a>
<a name="1096"><span class="lineNum">    1096 </span>                :            : </a>
<a name="1097"><span class="lineNum">    1097 </span>                :            :   //vertexAngle - undefined, but check that it doesn't crash</a>
<a name="1098"><span class="lineNum">    1098 </span>                :<span class="lineCov">          1 :   ( void )p21.vertexAngle( QgsVertexId() );</span></a>
<a name="1099"><span class="lineNum">    1099 </span>                :            : </a>
<a name="1100"><span class="lineNum">    1100 </span>                :            :   //counts</a>
<a name="1101"><span class="lineNum">    1101 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.vertexCount(), 1 );</span></a>
<a name="1102"><span class="lineNum">    1102 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.ringCount(), 1 );</span></a>
<a name="1103"><span class="lineNum">    1103 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.partCount(), 1 );</span></a>
<a name="1104"><span class="lineNum">    1104 </span>                :            : </a>
<a name="1105"><span class="lineNum">    1105 </span>                :            :   //measures and other abstract geometry methods</a>
<a name="1106"><span class="lineNum">    1106 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.length(), 0.0 );</span></a>
<a name="1107"><span class="lineNum">    1107 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.perimeter(), 0.0 );</span></a>
<a name="1108"><span class="lineNum">    1108 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.area(), 0.0 );</span></a>
<a name="1109"><span class="lineNum">    1109 </span>                :<span class="lineCov">          1 :   QCOMPARE( p20.centroid(), p20 );</span></a>
<a name="1110"><span class="lineNum">    1110 </span>                :<span class="lineCov">          1 :   QVERIFY( !p20.hasCurvedSegments() );</span></a>
<a name="1111"><span class="lineNum">    1111 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPoint &gt;segmented( static_cast&lt; QgsPoint *&gt;( p20.segmentize() ) );</span></a>
<a name="1112"><span class="lineNum">    1112 </span>                :<span class="lineCov">          1 :   QCOMPARE( *segmented, p20 );</span></a>
<a name="1113"><span class="lineNum">    1113 </span>                :            : </a>
<a name="1114"><span class="lineNum">    1114 </span>                :            :   //addZValue</a>
<a name="1115"><span class="lineNum">    1115 </span>                :<span class="lineCov">          1 :   QgsPoint p23( 1.0, 2.0 );</span></a>
<a name="1116"><span class="lineNum">    1116 </span>                :<span class="lineCov">          1 :   QVERIFY( p23.addZValue( 5.0 ) );</span></a>
<a name="1117"><span class="lineNum">    1117 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23, QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 5.0 ) );</span></a>
<a name="1118"><span class="lineNum">    1118 </span>                :<span class="lineCov">          1 :   QVERIFY( !p23.addZValue( 6.0 ) );</span></a>
<a name="1119"><span class="lineNum">    1119 </span>                :            : </a>
<a name="1120"><span class="lineNum">    1120 </span>                :            :   //addMValue</a>
<a name="1121"><span class="lineNum">    1121 </span>                :<span class="lineCov">          1 :   QgsPoint p24( 1.0, 2.0 );</span></a>
<a name="1122"><span class="lineNum">    1122 </span>                :<span class="lineCov">          1 :   QVERIFY( p24.addMValue( 5.0 ) );</span></a>
<a name="1123"><span class="lineNum">    1123 </span>                :<span class="lineCov">          1 :   QCOMPARE( p24, QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 5.0 ) );</span></a>
<a name="1124"><span class="lineNum">    1124 </span>                :<span class="lineCov">          1 :   QVERIFY( !p24.addMValue( 6.0 ) );</span></a>
<a name="1125"><span class="lineNum">    1125 </span>                :            : </a>
<a name="1126"><span class="lineNum">    1126 </span>                :            :   //dropZ</a>
<a name="1127"><span class="lineNum">    1127 </span>                :<span class="lineCov">          1 :   QgsPoint p25( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 );</span></a>
<a name="1128"><span class="lineNum">    1128 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.dropZValue() );</span></a>
<a name="1129"><span class="lineNum">    1129 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25, QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="1130"><span class="lineNum">    1130 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.dropZValue() );</span></a>
<a name="1131"><span class="lineNum">    1131 </span>                :<span class="lineCov">          1 :   QgsPoint p26( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 );</span></a>
<a name="1132"><span class="lineNum">    1132 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.dropZValue() );</span></a>
<a name="1133"><span class="lineNum">    1133 </span>                :<span class="lineCov">          1 :   QCOMPARE( p26, QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 4.0 ) );</span></a>
<a name="1134"><span class="lineNum">    1134 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.dropZValue() );</span></a>
<a name="1135"><span class="lineNum">    1135 </span>                :<span class="lineCov">          1 :   QgsPoint p26a( QgsWkbTypes::Point25D, 1.0, 2.0, 3.0 );</span></a>
<a name="1136"><span class="lineNum">    1136 </span>                :<span class="lineCov">          1 :   QVERIFY( p26a.dropZValue() );</span></a>
<a name="1137"><span class="lineNum">    1137 </span>                :<span class="lineCov">          1 :   QCOMPARE( p26a, QgsPoint( QgsWkbTypes::Point, 1.0, 2.0 ) );</span></a>
<a name="1138"><span class="lineNum">    1138 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26a.dropZValue() );</span></a>
<a name="1139"><span class="lineNum">    1139 </span>                :            : </a>
<a name="1140"><span class="lineNum">    1140 </span>                :            :   //dropM</a>
<a name="1141"><span class="lineNum">    1141 </span>                :<span class="lineCov">          1 :   QgsPoint p27( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 );</span></a>
<a name="1142"><span class="lineNum">    1142 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.dropMValue() );</span></a>
<a name="1143"><span class="lineNum">    1143 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27, QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="1144"><span class="lineNum">    1144 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.dropMValue() );</span></a>
<a name="1145"><span class="lineNum">    1145 </span>                :<span class="lineCov">          1 :   QgsPoint p28( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 );</span></a>
<a name="1146"><span class="lineNum">    1146 </span>                :<span class="lineCov">          1 :   QVERIFY( p28.dropMValue() );</span></a>
<a name="1147"><span class="lineNum">    1147 </span>                :<span class="lineCov">          1 :   QCOMPARE( p28, QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0, 0.0 ) );</span></a>
<a name="1148"><span class="lineNum">    1148 </span>                :<span class="lineCov">          1 :   QVERIFY( !p28.dropMValue() );</span></a>
<a name="1149"><span class="lineNum">    1149 </span>                :            : </a>
<a name="1150"><span class="lineNum">    1150 </span>                :            :   //convertTo</a>
<a name="1151"><span class="lineNum">    1151 </span>                :<span class="lineCov">          1 :   QgsPoint p29( 1.0, 2.0 );</span></a>
<a name="1152"><span class="lineNum">    1152 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::Point ) );</span></a>
<a name="1153"><span class="lineNum">    1153 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="1154"><span class="lineNum">    1154 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::PointZ ) );</span></a>
<a name="1155"><span class="lineNum">    1155 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="1156"><span class="lineNum">    1156 </span>                :<span class="lineCov">          1 :   p29.setZ( 5.0 );</span></a>
<a name="1157"><span class="lineNum">    1157 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::Point25D ) );</span></a>
<a name="1158"><span class="lineNum">    1158 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::Point25D );</span></a>
<a name="1159"><span class="lineNum">    1159 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.z(), 5.0 );</span></a>
<a name="1160"><span class="lineNum">    1160 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::PointZM ) );</span></a>
<a name="1161"><span class="lineNum">    1161 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1162"><span class="lineNum">    1162 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.z(), 5.0 );</span></a>
<a name="1163"><span class="lineNum">    1163 </span>                :<span class="lineCov">          1 :   p29.setM( 9.0 );</span></a>
<a name="1164"><span class="lineNum">    1164 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::PointM ) );</span></a>
<a name="1165"><span class="lineNum">    1165 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::PointM );</span></a>
<a name="1166"><span class="lineNum">    1166 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p29.z() ) );</span></a>
<a name="1167"><span class="lineNum">    1167 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.m(), 9.0 );</span></a>
<a name="1168"><span class="lineNum">    1168 </span>                :<span class="lineCov">          1 :   QVERIFY( p29.convertTo( QgsWkbTypes::Point ) );</span></a>
<a name="1169"><span class="lineNum">    1169 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="1170"><span class="lineNum">    1170 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p29.z() ) );</span></a>
<a name="1171"><span class="lineNum">    1171 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p29.m() ) );</span></a>
<a name="1172"><span class="lineNum">    1172 </span>                :<span class="lineCov">          1 :   QVERIFY( !p29.convertTo( QgsWkbTypes::Polygon ) );</span></a>
<a name="1173"><span class="lineNum">    1173 </span>                :            : </a>
<a name="1174"><span class="lineNum">    1174 </span>                :            :   //boundary</a>
<a name="1175"><span class="lineNum">    1175 </span>                :<span class="lineCov">          1 :   QgsPoint p30( 1.0, 2.0 );</span></a>
<a name="1176"><span class="lineNum">    1176 </span>                :<span class="lineCov">          1 :   QVERIFY( !p30.boundary() );</span></a>
<a name="1177"><span class="lineNum">    1177 </span>                :            : </a>
<a name="1178"><span class="lineNum">    1178 </span>                :            :   // distance</a>
<a name="1179"><span class="lineNum">    1179 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( QgsPoint( 2, 2 ) ), 1.0 );</span></a>
<a name="1180"><span class="lineNum">    1180 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( 2, 2 ), 1.0 );</span></a>
<a name="1181"><span class="lineNum">    1181 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( QgsPoint( 3, 2 ) ), 2.0 );</span></a>
<a name="1182"><span class="lineNum">    1182 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( 3, 2 ), 2.0 );</span></a>
<a name="1183"><span class="lineNum">    1183 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( QgsPoint( 1, 3 ) ), 1.0 );</span></a>
<a name="1184"><span class="lineNum">    1184 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( 1, 3 ), 1.0 );</span></a>
<a name="1185"><span class="lineNum">    1185 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( QgsPoint( 1, 4 ) ), 2.0 );</span></a>
<a name="1186"><span class="lineNum">    1186 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distance( 1, 4 ), 2.0 );</span></a>
<a name="1187"><span class="lineNum">    1187 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, -2 ).distance( QgsPoint( 1, -4 ) ), 2.0 );</span></a>
<a name="1188"><span class="lineNum">    1188 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, -2 ).distance( 1, -4 ), 2.0 );</span></a>
<a name="1189"><span class="lineNum">    1189 </span>                :            : </a>
<a name="1190"><span class="lineNum">    1190 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( QgsPoint( 2, 2 ) ), 1.0 );</span></a>
<a name="1191"><span class="lineNum">    1191 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( 2, 2 ), 1.0 );</span></a>
<a name="1192"><span class="lineNum">    1192 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( QgsPoint( 3, 2 ) ), 4.0 );</span></a>
<a name="1193"><span class="lineNum">    1193 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( 3, 2 ), 4.0 );</span></a>
<a name="1194"><span class="lineNum">    1194 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( QgsPoint( 1, 3 ) ), 1.0 );</span></a>
<a name="1195"><span class="lineNum">    1195 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( 1, 3 ), 1.0 );</span></a>
<a name="1196"><span class="lineNum">    1196 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( QgsPoint( 1, 4 ) ), 4.0 );</span></a>
<a name="1197"><span class="lineNum">    1197 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).distanceSquared( 1, 4 ), 4.0 );</span></a>
<a name="1198"><span class="lineNum">    1198 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, -2 ).distanceSquared( QgsPoint( 1, -4 ) ), 4.0 );</span></a>
<a name="1199"><span class="lineNum">    1199 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, -2 ).distanceSquared( 1, -4 ), 4.0 );</span></a>
<a name="1200"><span class="lineNum">    1200 </span>                :            : </a>
<a name="1201"><span class="lineNum">    1201 </span>                :            :   // distance 3D</a>
<a name="1202"><span class="lineNum">    1202 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 0, 0 ).distanceSquared3D( QgsPoint( 1, 1 ) ), 2.0 );</span></a>
<a name="1203"><span class="lineNum">    1203 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsPoint( 0, 0 ).distanceSquared3D( 1, 1, 0 ) ) );</span></a>
<a name="1204"><span class="lineNum">    1204 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsPoint( 0, 0 ).distanceSquared3D( QgsPoint( QgsWkbTypes::PointZ, 2, 2, 2, 0 ) ) ) );</span></a>
<a name="1205"><span class="lineNum">    1205 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsPoint( 0, 0 ).distanceSquared3D( 2, 2, 2 ) ) );</span></a>
<a name="1206"><span class="lineNum">    1206 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsPoint( QgsWkbTypes::PointZ, 2, 2, 2, 0 ).distanceSquared3D( QgsPoint( 1, 1 ) ) ) );</span></a>
<a name="1207"><span class="lineNum">    1207 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 2, 2, 2, 0 ).distanceSquared3D( 1, 1, 0 ), 6.0 );</span></a>
<a name="1208"><span class="lineNum">    1208 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsPoint( QgsWkbTypes::PointZ, -2, -2, -2, 0 ).distanceSquared3D( QgsPoint( 0, 0 ) ) ) );</span></a>
<a name="1209"><span class="lineNum">    1209 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, -2, -2, -2, 0 ).distanceSquared3D( 0, 0, 0 ), 12.0 );</span></a>
<a name="1210"><span class="lineNum">    1210 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, -2, -2, -2, 0 ).distanceSquared3D( QgsPoint( QgsWkbTypes::PointZ, 2, 2, 2, 0 ) ), 48.0 );</span></a>
<a name="1211"><span class="lineNum">    1211 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, -2, -2, -2, 0 ).distanceSquared3D( 2, 2, 2 ), 48.0 );</span></a>
<a name="1212"><span class="lineNum">    1212 </span>                :            : </a>
<a name="1213"><span class="lineNum">    1213 </span>                :            : </a>
<a name="1214"><span class="lineNum">    1214 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ).distance3D( QgsPoint( QgsWkbTypes::PointZ, 1, 3, 2, 0 ) ), 2.0 );</span></a>
<a name="1215"><span class="lineNum">    1215 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ).distance3D( 1, 3, 2 ), 2.0 );</span></a>
<a name="1216"><span class="lineNum">    1216 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ).distance3D( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 4, 0 ) ), 2.0 );</span></a>
<a name="1217"><span class="lineNum">    1217 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ).distance3D( 1, 1, 4 ), 2.0 );</span></a>
<a name="1218"><span class="lineNum">    1218 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, -2, 0 ).distance3D( QgsPoint( QgsWkbTypes::PointZ, 1, 1, -4, 0 ) ), 2.0 );</span></a>
<a name="1219"><span class="lineNum">    1219 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, -2, 0 ).distance3D( 1, 1, -4 ), 2.0 );</span></a>
<a name="1220"><span class="lineNum">    1220 </span>                :            : </a>
<a name="1221"><span class="lineNum">    1221 </span>                :            :   // azimuth</a>
<a name="1222"><span class="lineNum">    1222 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).azimuth( QgsPoint( 1, 2 ) ), 0.0 );</span></a>
<a name="1223"><span class="lineNum">    1223 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).azimuth( QgsPoint( 1, 3 ) ), 0.0 );</span></a>
<a name="1224"><span class="lineNum">    1224 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).azimuth( QgsPoint( 2, 2 ) ), 90.0 );</span></a>
<a name="1225"><span class="lineNum">    1225 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).azimuth( QgsPoint( 1, 0 ) ), 180.0 );</span></a>
<a name="1226"><span class="lineNum">    1226 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).azimuth( QgsPoint( 0, 2 ) ), -90.0 );</span></a>
<a name="1227"><span class="lineNum">    1227 </span>                :            : </a>
<a name="1228"><span class="lineNum">    1228 </span>                :            :   // operators</a>
<a name="1229"><span class="lineNum">    1229 </span>                :<span class="lineCov">          1 :   QgsPoint p31( 1, 2 );</span></a>
<a name="1230"><span class="lineNum">    1230 </span>                :<span class="lineCov">          1 :   QgsPoint p32( 3, 5 );</span></a>
<a name="1231"><span class="lineNum">    1231 </span>                :<span class="lineCov">          1 :   QCOMPARE( p32 - p31, QgsVector( 2, 3 ) );</span></a>
<a name="1232"><span class="lineNum">    1232 </span>                :<span class="lineCov">          1 :   QCOMPARE( p31 - p32, QgsVector( -2, -3 ) );</span></a>
<a name="1233"><span class="lineNum">    1233 </span>                :            : </a>
<a name="1234"><span class="lineNum">    1234 </span>                :<span class="lineCov">          1 :   p31 = QgsPoint( 1, 2 );</span></a>
<a name="1235"><span class="lineNum">    1235 </span>                :<span class="lineCov">          1 :   QCOMPARE( p31 + QgsVector( 3, 5 ), QgsPoint( 4, 7 ) );</span></a>
<a name="1236"><span class="lineNum">    1236 </span>                :<span class="lineCov">          1 :   p31 += QgsVector( 3, 5 );</span></a>
<a name="1237"><span class="lineNum">    1237 </span>                :<span class="lineCov">          1 :   QCOMPARE( p31, QgsPoint( 4, 7 ) );</span></a>
<a name="1238"><span class="lineNum">    1238 </span>                :            : </a>
<a name="1239"><span class="lineNum">    1239 </span>                :<span class="lineCov">          1 :   QCOMPARE( p31 - QgsVector( 3, 5 ), QgsPoint( 1, 2 ) );</span></a>
<a name="1240"><span class="lineNum">    1240 </span>                :<span class="lineCov">          1 :   p31 -= QgsVector( 3, 5 );</span></a>
<a name="1241"><span class="lineNum">    1241 </span>                :<span class="lineCov">          1 :   QCOMPARE( p31, QgsPoint( 1, 2 ) );</span></a>
<a name="1242"><span class="lineNum">    1242 </span>                :            : </a>
<a name="1243"><span class="lineNum">    1243 </span>                :            :   // test projecting a point</a>
<a name="1244"><span class="lineNum">    1244 </span>                :            :   // 2D</a>
<a name="1245"><span class="lineNum">    1245 </span>                :<span class="lineCov">          1 :   QgsPoint p33 = QgsPoint( 1, 2 );</span></a>
<a name="1246"><span class="lineNum">    1246 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1, 0 ), QgsPoint( 1, 3 ) );</span></a>
<a name="1247"><span class="lineNum">    1247 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2 ) );</span></a>
<a name="1248"><span class="lineNum">    1248 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1.5, 90 ), QgsPoint( 2.5, 2 ) );</span></a>
<a name="1249"><span class="lineNum">    1249 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1.5, 90, 90 ), QgsPoint( 2.5, 2 ) ); // stay QgsWkbTypes::Point</span></a>
<a name="1250"><span class="lineNum">    1250 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 2, 180 ), QgsPoint( 1, 0 ) );</span></a>
<a name="1251"><span class="lineNum">    1251 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 5, 270 ), QgsPoint( -4, 2 ) );</span></a>
<a name="1252"><span class="lineNum">    1252 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 6, 360 ), QgsPoint( 1, 8 ) );</span></a>
<a name="1253"><span class="lineNum">    1253 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 5, 450 ), QgsPoint( 6, 2 ) );</span></a>
<a name="1254"><span class="lineNum">    1254 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 5, 450, 450 ), QgsPoint( 6, 2 ) );  // stay QgsWkbTypes::Point</span></a>
<a name="1255"><span class="lineNum">    1255 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( -1, 0 ), QgsPoint( 1, 1 ) );</span></a>
<a name="1256"><span class="lineNum">    1256 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1.5, -90 ), QgsPoint( -0.5, 2 ) );</span></a>
<a name="1257"><span class="lineNum">    1257 </span>                :<span class="lineCov">          1 :   p33.addZValue( 0 );</span></a>
<a name="1258"><span class="lineNum">    1258 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 1 ) );</span></a>
<a name="1259"><span class="lineNum">    1259 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 2, 180, 180 ), QgsPoint( QgsWkbTypes::PointZ,  1, 2, -2 ) );</span></a>
<a name="1260"><span class="lineNum">    1260 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 5, 270, 270 ), QgsPoint( QgsWkbTypes::PointZ,  6, 2, 0 ) );</span></a>
<a name="1261"><span class="lineNum">    1261 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 6, 360, 360 ), QgsPoint( QgsWkbTypes::PointZ,  1, 2, 6 ) );</span></a>
<a name="1262"><span class="lineNum">    1262 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( -1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, -1 ) );</span></a>
<a name="1263"><span class="lineNum">    1263 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1.5, -90, -90 ), QgsPoint( QgsWkbTypes::PointZ, 2.5, 2, 0 ) );</span></a>
<a name="1264"><span class="lineNum">    1264 </span>                :            : </a>
<a name="1265"><span class="lineNum">    1265 </span>                :            :   // PointM</a>
<a name="1266"><span class="lineNum">    1266 </span>                :<span class="lineCov">          1 :   p33.dropZValue();</span></a>
<a name="1267"><span class="lineNum">    1267 </span>                :<span class="lineCov">          1 :   p33.addMValue( 5.0 );</span></a>
<a name="1268"><span class="lineNum">    1268 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1, 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 3, 0, 5 ) );</span></a>
<a name="1269"><span class="lineNum">    1269 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 5, 450, 450 ), QgsPoint( QgsWkbTypes::PointM, 6, 2, 0, 5 ) );</span></a>
<a name="1270"><span class="lineNum">    1270 </span>                :            : </a>
<a name="1271"><span class="lineNum">    1271 </span>                :<span class="lineCov">          1 :   p33.addZValue( 0 );</span></a>
<a name="1272"><span class="lineNum">    1272 </span>                :<span class="lineCov">          1 :   QCOMPARE( p33.project( 1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 1, 5 ) );</span></a>
<a name="1273"><span class="lineNum">    1273 </span>                :            : </a>
<a name="1274"><span class="lineNum">    1274 </span>                :            :   // 3D</a>
<a name="1275"><span class="lineNum">    1275 </span>                :<span class="lineCov">          1 :   QgsPoint p34 = QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 );</span></a>
<a name="1276"><span class="lineNum">    1276 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 3, 2 ) );</span></a>
<a name="1277"><span class="lineNum">    1277 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="1278"><span class="lineNum">    1278 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1.5, 90 ), QgsPoint( QgsWkbTypes::PointZ, 2.5, 2, 2 ) );</span></a>
<a name="1279"><span class="lineNum">    1279 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1.5, 90, 90 ), QgsPoint( QgsWkbTypes::PointZ, 2.5, 2, 2 ) );</span></a>
<a name="1280"><span class="lineNum">    1280 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 2, 180 ), QgsPoint( QgsWkbTypes::PointZ, 1, 0, 2 ) );</span></a>
<a name="1281"><span class="lineNum">    1281 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 2, 180, 180 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 0 ) );</span></a>
<a name="1282"><span class="lineNum">    1282 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 270 ), QgsPoint( QgsWkbTypes::PointZ, -4, 2, 2 ) );</span></a>
<a name="1283"><span class="lineNum">    1283 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 270, 270 ), QgsPoint( QgsWkbTypes::PointZ, 6, 2, 2 ) );</span></a>
<a name="1284"><span class="lineNum">    1284 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 6, 360 ), QgsPoint( QgsWkbTypes::PointZ, 1, 8, 2 ) );</span></a>
<a name="1285"><span class="lineNum">    1285 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 6, 360, 360 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 8 ) );</span></a>
<a name="1286"><span class="lineNum">    1286 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 450 ), QgsPoint( QgsWkbTypes::PointZ, 6, 2, 2 ) );</span></a>
<a name="1287"><span class="lineNum">    1287 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 450, 450 ), QgsPoint( QgsWkbTypes::PointZ, 6, 2, 2 ) );</span></a>
<a name="1288"><span class="lineNum">    1288 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( -1, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2 ) );</span></a>
<a name="1289"><span class="lineNum">    1289 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( -1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 1 ) );</span></a>
<a name="1290"><span class="lineNum">    1290 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1.5, -90 ), QgsPoint( QgsWkbTypes::PointZ, -0.5, 2, 2 ) );</span></a>
<a name="1291"><span class="lineNum">    1291 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1.5, -90, -90 ), QgsPoint( QgsWkbTypes::PointZ, 2.5, 2, 2 ) );</span></a>
<a name="1292"><span class="lineNum">    1292 </span>                :            :   // PointM</a>
<a name="1293"><span class="lineNum">    1293 </span>                :<span class="lineCov">          1 :   p34.addMValue( 5.0 );</span></a>
<a name="1294"><span class="lineNum">    1294 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1, 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 3, 2, 5 ) );</span></a>
<a name="1295"><span class="lineNum">    1295 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 1, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 5 ) );</span></a>
<a name="1296"><span class="lineNum">    1296 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 450 ), QgsPoint( QgsWkbTypes::PointZM, 6, 2, 2, 5 ) );</span></a>
<a name="1297"><span class="lineNum">    1297 </span>                :<span class="lineCov">          1 :   QCOMPARE( p34.project( 5, 450, 450 ), QgsPoint( QgsWkbTypes::PointZM, 6, 2, 2, 5 ) );</span></a>
<a name="1298"><span class="lineNum">    1298 </span>                :            : </a>
<a name="1299"><span class="lineNum">    1299 </span>                :            :   // inclination</a>
<a name="1300"><span class="lineNum">    1300 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).inclination( QgsPoint( 1, 2 ) ), 90.0 );</span></a>
<a name="1301"><span class="lineNum">    1301 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 1, 2, 0 ) ), 90.0 );</span></a>
<a name="1302"><span class="lineNum">    1302 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 90 ) ), 90.0 );</span></a>
<a name="1303"><span class="lineNum">    1303 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, -90 ) ), 90.0 );</span></a>
<a name="1304"><span class="lineNum">    1304 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 0 ) ), 0.0 );</span></a>
<a name="1305"><span class="lineNum">    1305 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 180 ) ), 180.0 );</span></a>
<a name="1306"><span class="lineNum">    1306 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, -180 ) ), 180.0 );</span></a>
<a name="1307"><span class="lineNum">    1307 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 720 ) ), 0.0 );</span></a>
<a name="1308"><span class="lineNum">    1308 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 45 ) ), 45.0 );</span></a>
<a name="1309"><span class="lineNum">    1309 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).inclination( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ).project( 5, 90, 135 ) ), 135.0 );</span></a>
<a name="1310"><span class="lineNum">    1310 </span>                :            : </a>
<a name="1311"><span class="lineNum">    1311 </span>                :            :   // vertex number</a>
<a name="1312"><span class="lineNum">    1312 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="1313"><span class="lineNum">    1313 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), -1 );</span></a>
<a name="1314"><span class="lineNum">    1314 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="1315"><span class="lineNum">    1315 </span>                :            : </a>
<a name="1316"><span class="lineNum">    1316 </span>                :            :   //segmentLength</a>
<a name="1317"><span class="lineNum">    1317 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="1318"><span class="lineNum">    1318 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="1319"><span class="lineNum">    1319 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).segmentLength( QgsVertexId( -1, 0, 1 ) ), 0.0 );</span></a>
<a name="1320"><span class="lineNum">    1320 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="1321"><span class="lineNum">    1321 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 1, 2 ).segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="1322"><span class="lineNum">    1322 </span>                :            : </a>
<a name="1323"><span class="lineNum">    1323 </span>                :            :   // remove duplicate points</a>
<a name="1324"><span class="lineNum">    1324 </span>                :<span class="lineCov">          1 :   QgsPoint p = QgsPoint( 1, 2 );</span></a>
<a name="1325"><span class="lineNum">    1325 </span>                :<span class="lineCov">          1 :   QVERIFY( !p.removeDuplicateNodes() );</span></a>
<a name="1326"><span class="lineNum">    1326 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 1.0 );</span></a>
<a name="1327"><span class="lineNum">    1327 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 2.0 );</span></a>
<a name="1328"><span class="lineNum">    1328 </span>                :            : </a>
<a name="1329"><span class="lineNum">    1329 </span>                :            :   // swap xy</a>
<a name="1330"><span class="lineNum">    1330 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 1.1, 2.2, 3.3, 4.4, QgsWkbTypes::PointZM );</span></a>
<a name="1331"><span class="lineNum">    1331 </span>                :<span class="lineCov">          1 :   p.swapXy();</span></a>
<a name="1332"><span class="lineNum">    1332 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 2.2 );</span></a>
<a name="1333"><span class="lineNum">    1333 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 1.1 );</span></a>
<a name="1334"><span class="lineNum">    1334 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 3.3 );</span></a>
<a name="1335"><span class="lineNum">    1335 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 4.4 );</span></a>
<a name="1336"><span class="lineNum">    1336 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1337"><span class="lineNum">    1337 </span>                :            : </a>
<a name="1338"><span class="lineNum">    1338 </span>                :            :   // filter vertex</a>
<a name="1339"><span class="lineNum">    1339 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 1.1, 2.2, 3.3, 4.4, QgsWkbTypes::PointZM );</span></a>
<a name="1340"><span class="lineNum">    1340 </span>                :<span class="lineCov">          1 :   p.filterVertices( []( const QgsPoint &amp; )-&gt; bool { return false; } );</span></a>
<a name="1341"><span class="lineNum">    1341 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 1.1 );</span></a>
<a name="1342"><span class="lineNum">    1342 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 2.2 );</span></a>
<a name="1343"><span class="lineNum">    1343 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 3.3 );</span></a>
<a name="1344"><span class="lineNum">    1344 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 4.4 );</span></a>
<a name="1345"><span class="lineNum">    1345 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1346"><span class="lineNum">    1346 </span>                :            : </a>
<a name="1347"><span class="lineNum">    1347 </span>                :            :   // transform vertex</a>
<a name="1348"><span class="lineNum">    1348 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 1.1, 2.2, 3.3, 4.4, QgsWkbTypes::PointZM );</span></a>
<a name="1349"><span class="lineNum">    1349 </span>                :<span class="lineCov">          2 :   p.transformVertices( []( const QgsPoint &amp; p )-&gt; QgsPoint</span></a>
<a name="1350"><span class="lineNum">    1350 </span>                :            :   {</a>
<a name="1351"><span class="lineNum">    1351 </span>                :<span class="lineCov">          1 :     return QgsPoint( p.x() + 2, p.y() + 3, p.z() + 1, p.m() + 8 );</span></a>
<a name="1352"><span class="lineNum">    1352 </span>                :            :   } );</a>
<a name="1353"><span class="lineNum">    1353 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 3.1 );</span></a>
<a name="1354"><span class="lineNum">    1354 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 5.2 );</span></a>
<a name="1355"><span class="lineNum">    1355 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 4.3 );</span></a>
<a name="1356"><span class="lineNum">    1356 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 12.4 );</span></a>
<a name="1357"><span class="lineNum">    1357 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1358"><span class="lineNum">    1358 </span>                :            :   // no dimensionality change allowed</a>
<a name="1359"><span class="lineNum">    1359 </span>                :<span class="lineCov">          2 :   p.transformVertices( []( const QgsPoint &amp; p )-&gt; QgsPoint</span></a>
<a name="1360"><span class="lineNum">    1360 </span>                :            :   {</a>
<a name="1361"><span class="lineNum">    1361 </span>                :<span class="lineCov">          1 :     return QgsPoint( p.x() + 2, p.y() + 3 );</span></a>
<a name="1362"><span class="lineNum">    1362 </span>                :            :   } );</a>
<a name="1363"><span class="lineNum">    1363 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 5.1 );</span></a>
<a name="1364"><span class="lineNum">    1364 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 8.2 );</span></a>
<a name="1365"><span class="lineNum">    1365 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p.z() ) );</span></a>
<a name="1366"><span class="lineNum">    1366 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p.m() ) );</span></a>
<a name="1367"><span class="lineNum">    1367 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1368"><span class="lineNum">    1368 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 2, 3 );</span></a>
<a name="1369"><span class="lineNum">    1369 </span>                :<span class="lineCov">          2 :   p.transformVertices( []( const QgsPoint &amp; p )-&gt; QgsPoint</span></a>
<a name="1370"><span class="lineNum">    1370 </span>                :            :   {</a>
<a name="1371"><span class="lineNum">    1371 </span>                :<span class="lineCov">          1 :     return QgsPoint( p.x() + 2, p.y() + 3, 7, 8 );</span></a>
<a name="1372"><span class="lineNum">    1372 </span>                :            :   } );</a>
<a name="1373"><span class="lineNum">    1373 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 4.0 );</span></a>
<a name="1374"><span class="lineNum">    1374 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 6.0 );</span></a>
<a name="1375"><span class="lineNum">    1375 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p.z() ) );</span></a>
<a name="1376"><span class="lineNum">    1376 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( p.m() ) );</span></a>
<a name="1377"><span class="lineNum">    1377 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="1378"><span class="lineNum">    1378 </span>                :            : </a>
<a name="1379"><span class="lineNum">    1379 </span>                :            :   // transform using class</a>
<a name="1380"><span class="lineNum">    1380 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 1.1, 2.2, 3.3, 4.4, QgsWkbTypes::PointZM );</span></a>
<a name="1381"><span class="lineNum">    1381 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="1382"><span class="lineNum">    1382 </span>                :<span class="lineCov">          1 :   QVERIFY( p.transform( &amp;transformer ) );</span></a>
<a name="1383"><span class="lineNum">    1383 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.x(), 3.3 );</span></a>
<a name="1384"><span class="lineNum">    1384 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.y(), 16.2 );</span></a>
<a name="1385"><span class="lineNum">    1385 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 8.3 );</span></a>
<a name="1386"><span class="lineNum">    1386 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 3.4 );</span></a>
<a name="1387"><span class="lineNum">    1387 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.wkbType(), QgsWkbTypes::PointZM );</span></a>
<a name="1388"><span class="lineNum">    1388 </span>                :            : </a>
<a name="1389"><span class="lineNum">    1389 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="1390"><span class="lineNum">    1390 </span>                :<span class="lineCov">          1 :   QVERIFY( !p.transform( &amp;failTransformer ) );</span></a>
<a name="1391"><span class="lineNum">    1391 </span>                :            : </a>
<a name="1392"><span class="lineNum">    1392 </span>                :            :   // test bounding box intersects</a>
<a name="1393"><span class="lineNum">    1393 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint( 1, 2 ).boundingBoxIntersects( QgsRectangle( 0, 0.5, 1.5, 3 ) ) );</span></a>
<a name="1394"><span class="lineNum">    1394 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsPoint( 1, 2 ).boundingBoxIntersects( QgsRectangle( 3, 0.5, 3.5, 3 ) ) );</span></a>
<a name="1395"><span class="lineNum">    1395 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsPoint().boundingBoxIntersects( QgsRectangle( 0, 0.5, 3.5, 3 ) ) );</span></a>
<a name="1396"><span class="lineNum">    1396 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1397"><span class="lineNum">    1397 </span>                :            : </a>
<a name="1398"><span class="lineNum">    1398 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::circularString()</span></a>
<a name="1399"><span class="lineNum">    1399 </span>                :            : {</a>
<a name="1400"><span class="lineNum">    1400 </span>                :            :   //test constructors</a>
<a name="1401"><span class="lineNum">    1401 </span>                :<span class="lineCov">          1 :   QgsCircularString l1;</span></a>
<a name="1402"><span class="lineNum">    1402 </span>                :<span class="lineCov">          1 :   QVERIFY( l1.isEmpty() );</span></a>
<a name="1403"><span class="lineNum">    1403 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.numPoints(), 0 );</span></a>
<a name="1404"><span class="lineNum">    1404 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.vertexCount(), 0 );</span></a>
<a name="1405"><span class="lineNum">    1405 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.nCoordinates(), 0 );</span></a>
<a name="1406"><span class="lineNum">    1406 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.ringCount(), 0 );</span></a>
<a name="1407"><span class="lineNum">    1407 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.partCount(), 0 );</span></a>
<a name="1408"><span class="lineNum">    1408 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.is3D() );</span></a>
<a name="1409"><span class="lineNum">    1409 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.isMeasure() );</span></a>
<a name="1410"><span class="lineNum">    1410 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1411"><span class="lineNum">    1411 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wktTypeStr(), QString( &quot;CircularString&quot; ) );</span></a>
<a name="1412"><span class="lineNum">    1412 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.geometryType(), QString( &quot;CircularString&quot; ) );</span></a>
<a name="1413"><span class="lineNum">    1413 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.dimension(), 1 );</span></a>
<a name="1414"><span class="lineNum">    1414 </span>                :<span class="lineCov">          1 :   QVERIFY( l1.hasCurvedSegments() );</span></a>
<a name="1415"><span class="lineNum">    1415 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.area(), 0.0 );</span></a>
<a name="1416"><span class="lineNum">    1416 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.perimeter(), 0.0 );</span></a>
<a name="1417"><span class="lineNum">    1417 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts;</span></a>
<a name="1418"><span class="lineNum">    1418 </span>                :<span class="lineCov">          1 :   l1.points( pts );</span></a>
<a name="1419"><span class="lineNum">    1419 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.empty() );</span></a>
<a name="1420"><span class="lineNum">    1420 </span>                :            : </a>
<a name="1421"><span class="lineNum">    1421 </span>                :            :   // from 3 points</a>
<a name="1422"><span class="lineNum">    1422 </span>                :<span class="lineCov">          1 :   QgsCircularString from3Pts( QgsPoint( 1, 2 ), QgsPoint( 21, 22 ), QgsPoint( 31, 2 ) );</span></a>
<a name="1423"><span class="lineNum">    1423 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1424"><span class="lineNum">    1424 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1425"><span class="lineNum">    1425 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1426"><span class="lineNum">    1426 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1427"><span class="lineNum">    1427 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1428"><span class="lineNum">    1428 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1429"><span class="lineNum">    1429 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1430"><span class="lineNum">    1430 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1431"><span class="lineNum">    1431 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ), QgsPoint( QgsWkbTypes::PointZ, 21, 22, 23 ),</span></a>
<a name="1432"><span class="lineNum">    1432 </span>                :<span class="lineCov">          1 :                                 QgsPoint( QgsWkbTypes::PointZ, 31, 2, 33 ) );</span></a>
<a name="1433"><span class="lineNum">    1433 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="1434"><span class="lineNum">    1434 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1435"><span class="lineNum">    1435 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1436"><span class="lineNum">    1436 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1437"><span class="lineNum">    1437 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).z(), 3.0 );</span></a>
<a name="1438"><span class="lineNum">    1438 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1439"><span class="lineNum">    1439 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1440"><span class="lineNum">    1440 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).z(), 23.0 );</span></a>
<a name="1441"><span class="lineNum">    1441 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1442"><span class="lineNum">    1442 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1443"><span class="lineNum">    1443 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).z(), 33.0 );</span></a>
<a name="1444"><span class="lineNum">    1444 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString( QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ), QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 23 ),</span></a>
<a name="1445"><span class="lineNum">    1445 </span>                :<span class="lineCov">          1 :                                 QgsPoint( QgsWkbTypes::PointM, 31, 2, 0, 33 ) );</span></a>
<a name="1446"><span class="lineNum">    1446 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="1447"><span class="lineNum">    1447 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1448"><span class="lineNum">    1448 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1449"><span class="lineNum">    1449 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1450"><span class="lineNum">    1450 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).m(), 3.0 );</span></a>
<a name="1451"><span class="lineNum">    1451 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1452"><span class="lineNum">    1452 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1453"><span class="lineNum">    1453 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).m(), 23.0 );</span></a>
<a name="1454"><span class="lineNum">    1454 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1455"><span class="lineNum">    1455 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1456"><span class="lineNum">    1456 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).m(), 33.0 );</span></a>
<a name="1457"><span class="lineNum">    1457 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString( QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 ),</span></a>
<a name="1458"><span class="lineNum">    1458 </span>                :<span class="lineCov">          1 :                                 QgsPoint( QgsWkbTypes::PointZM, 31, 2, 33, 34 ) );</span></a>
<a name="1459"><span class="lineNum">    1459 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1460"><span class="lineNum">    1460 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1461"><span class="lineNum">    1461 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1462"><span class="lineNum">    1462 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1463"><span class="lineNum">    1463 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).z(), 3.0 );</span></a>
<a name="1464"><span class="lineNum">    1464 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).m(), 4.0 );</span></a>
<a name="1465"><span class="lineNum">    1465 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1466"><span class="lineNum">    1466 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1467"><span class="lineNum">    1467 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).z(), 23.0 );</span></a>
<a name="1468"><span class="lineNum">    1468 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).m(), 24.0 );</span></a>
<a name="1469"><span class="lineNum">    1469 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1470"><span class="lineNum">    1470 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1471"><span class="lineNum">    1471 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).z(), 33.0 );</span></a>
<a name="1472"><span class="lineNum">    1472 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).m(), 34.0 );</span></a>
<a name="1473"><span class="lineNum">    1473 </span>                :            : </a>
<a name="1474"><span class="lineNum">    1474 </span>                :            :   // from 2 points and center</a>
<a name="1475"><span class="lineNum">    1475 </span>                :<span class="lineCov">          1 :   from3Pts = QgsCircularString::fromTwoPointsAndCenter( QgsPoint( 1, 2 ), QgsPoint( 31, 2 ), QgsPoint( 21, 2 ) );</span></a>
<a name="1476"><span class="lineNum">    1476 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1477"><span class="lineNum">    1477 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1478"><span class="lineNum">    1478 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1479"><span class="lineNum">    1479 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1480"><span class="lineNum">    1480 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1481"><span class="lineNum">    1481 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1482"><span class="lineNum">    1482 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1483"><span class="lineNum">    1483 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1484"><span class="lineNum">    1484 </span>                :<span class="lineCov">          1 :   from3Pts = QgsCircularString::fromTwoPointsAndCenter( QgsPoint( 1, 2 ), QgsPoint( 31, 2 ), QgsPoint( 21, 2 ), false );</span></a>
<a name="1485"><span class="lineNum">    1485 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1486"><span class="lineNum">    1486 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1487"><span class="lineNum">    1487 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1488"><span class="lineNum">    1488 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1489"><span class="lineNum">    1489 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1490"><span class="lineNum">    1490 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), -18.0 );</span></a>
<a name="1491"><span class="lineNum">    1491 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1492"><span class="lineNum">    1492 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1493"><span class="lineNum">    1493 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString::fromTwoPointsAndCenter( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ), QgsPoint( QgsWkbTypes::PointZ, 32, 2, 33 ),</span></a>
<a name="1494"><span class="lineNum">    1494 </span>                :<span class="lineCov">          1 :              QgsPoint( QgsWkbTypes::PointZ, 21, 2, 23 ) );</span></a>
<a name="1495"><span class="lineNum">    1495 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="1496"><span class="lineNum">    1496 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1497"><span class="lineNum">    1497 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1498"><span class="lineNum">    1498 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1499"><span class="lineNum">    1499 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).z(), 3.0 );</span></a>
<a name="1500"><span class="lineNum">    1500 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1501"><span class="lineNum">    1501 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1502"><span class="lineNum">    1502 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).z(), 23.0 );</span></a>
<a name="1503"><span class="lineNum">    1503 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 32.0 );</span></a>
<a name="1504"><span class="lineNum">    1504 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1505"><span class="lineNum">    1505 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).z(), 33.0 );</span></a>
<a name="1506"><span class="lineNum">    1506 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString::fromTwoPointsAndCenter( QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ), QgsPoint( QgsWkbTypes::PointM, 31, 2, 0, 33 ),</span></a>
<a name="1507"><span class="lineNum">    1507 </span>                :<span class="lineCov">          1 :              QgsPoint( QgsWkbTypes::PointM, 21, 2, 0, 23 ) );</span></a>
<a name="1508"><span class="lineNum">    1508 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="1509"><span class="lineNum">    1509 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1510"><span class="lineNum">    1510 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1511"><span class="lineNum">    1511 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1512"><span class="lineNum">    1512 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).m(), 3.0 );</span></a>
<a name="1513"><span class="lineNum">    1513 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1514"><span class="lineNum">    1514 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1515"><span class="lineNum">    1515 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).m(), 23.0 );</span></a>
<a name="1516"><span class="lineNum">    1516 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1517"><span class="lineNum">    1517 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1518"><span class="lineNum">    1518 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).m(), 33.0 );</span></a>
<a name="1519"><span class="lineNum">    1519 </span>                :<span class="lineCov">          2 :   from3Pts = QgsCircularString::fromTwoPointsAndCenter( QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ), QgsPoint( QgsWkbTypes::PointZM, 31, 2, 33, 34 ),</span></a>
<a name="1520"><span class="lineNum">    1520 </span>                :<span class="lineCov">          1 :              QgsPoint( QgsWkbTypes::PointZM, 21, 2, 23, 24 ) );</span></a>
<a name="1521"><span class="lineNum">    1521 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1522"><span class="lineNum">    1522 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.numPoints(), 3 );</span></a>
<a name="1523"><span class="lineNum">    1523 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 0 ), 1.0 );</span></a>
<a name="1524"><span class="lineNum">    1524 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 0 ), 2.0 );</span></a>
<a name="1525"><span class="lineNum">    1525 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).z(), 3.0 );</span></a>
<a name="1526"><span class="lineNum">    1526 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 0 ).m(), 4.0 );</span></a>
<a name="1527"><span class="lineNum">    1527 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 1 ), 21.0 );</span></a>
<a name="1528"><span class="lineNum">    1528 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 1 ), 22.0 );</span></a>
<a name="1529"><span class="lineNum">    1529 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).z(), 23.0 );</span></a>
<a name="1530"><span class="lineNum">    1530 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 1 ).m(), 24.0 );</span></a>
<a name="1531"><span class="lineNum">    1531 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.xAt( 2 ), 31.0 );</span></a>
<a name="1532"><span class="lineNum">    1532 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.yAt( 2 ), 2.0 );</span></a>
<a name="1533"><span class="lineNum">    1533 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).z(), 33.0 );</span></a>
<a name="1534"><span class="lineNum">    1534 </span>                :<span class="lineCov">          1 :   QCOMPARE( from3Pts.pointN( 2 ).m(), 34.0 );</span></a>
<a name="1535"><span class="lineNum">    1535 </span>                :            : </a>
<a name="1536"><span class="lineNum">    1536 </span>                :            :   //setPoints</a>
<a name="1537"><span class="lineNum">    1537 </span>                :<span class="lineCov">          1 :   QgsCircularString l2;</span></a>
<a name="1538"><span class="lineNum">    1538 </span>                :<span class="lineCov">          1 :   l2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="1539"><span class="lineNum">    1539 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.isEmpty() );</span></a>
<a name="1540"><span class="lineNum">    1540 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.numPoints(), 1 );</span></a>
<a name="1541"><span class="lineNum">    1541 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.vertexCount(), 1 );</span></a>
<a name="1542"><span class="lineNum">    1542 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.nCoordinates(), 1 );</span></a>
<a name="1543"><span class="lineNum">    1543 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.ringCount(), 1 );</span></a>
<a name="1544"><span class="lineNum">    1544 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.partCount(), 1 );</span></a>
<a name="1545"><span class="lineNum">    1545 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.is3D() );</span></a>
<a name="1546"><span class="lineNum">    1546 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.isMeasure() );</span></a>
<a name="1547"><span class="lineNum">    1547 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1548"><span class="lineNum">    1548 </span>                :<span class="lineCov">          1 :   QVERIFY( l2.hasCurvedSegments() );</span></a>
<a name="1549"><span class="lineNum">    1549 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.area(), 0.0 );</span></a>
<a name="1550"><span class="lineNum">    1550 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.perimeter(), 0.0 );</span></a>
<a name="1551"><span class="lineNum">    1551 </span>                :<span class="lineCov">          1 :   l2.points( pts );</span></a>
<a name="1552"><span class="lineNum">    1552 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="1553"><span class="lineNum">    1553 </span>                :            : </a>
<a name="1554"><span class="lineNum">    1554 </span>                :            :   //setting first vertex should set linestring z/m type</a>
<a name="1555"><span class="lineNum">    1555 </span>                :<span class="lineCov">          1 :   QgsCircularString l3;</span></a>
<a name="1556"><span class="lineNum">    1556 </span>                :<span class="lineCov">          1 :   l3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="1557"><span class="lineNum">    1557 </span>                :<span class="lineCov">          1 :   QVERIFY( !l3.isEmpty() );</span></a>
<a name="1558"><span class="lineNum">    1558 </span>                :<span class="lineCov">          1 :   QVERIFY( l3.is3D() );</span></a>
<a name="1559"><span class="lineNum">    1559 </span>                :<span class="lineCov">          1 :   QVERIFY( !l3.isMeasure() );</span></a>
<a name="1560"><span class="lineNum">    1560 </span>                :<span class="lineCov">          1 :   QCOMPARE( l3.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="1561"><span class="lineNum">    1561 </span>                :<span class="lineCov">          1 :   QCOMPARE( l3.wktTypeStr(), QString( &quot;CircularStringZ&quot; ) );</span></a>
<a name="1562"><span class="lineNum">    1562 </span>                :<span class="lineCov">          1 :   l3.points( pts );</span></a>
<a name="1563"><span class="lineNum">    1563 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="1564"><span class="lineNum">    1564 </span>                :            : </a>
<a name="1565"><span class="lineNum">    1565 </span>                :<span class="lineCov">          1 :   QgsCircularString l4;</span></a>
<a name="1566"><span class="lineNum">    1566 </span>                :<span class="lineCov">          1 :   l4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="1567"><span class="lineNum">    1567 </span>                :<span class="lineCov">          1 :   QVERIFY( !l4.isEmpty() );</span></a>
<a name="1568"><span class="lineNum">    1568 </span>                :<span class="lineCov">          1 :   QVERIFY( !l4.is3D() );</span></a>
<a name="1569"><span class="lineNum">    1569 </span>                :<span class="lineCov">          1 :   QVERIFY( l4.isMeasure() );</span></a>
<a name="1570"><span class="lineNum">    1570 </span>                :<span class="lineCov">          1 :   QCOMPARE( l4.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="1571"><span class="lineNum">    1571 </span>                :<span class="lineCov">          1 :   QCOMPARE( l4.wktTypeStr(), QString( &quot;CircularStringM&quot; ) );</span></a>
<a name="1572"><span class="lineNum">    1572 </span>                :<span class="lineCov">          1 :   l4.points( pts );</span></a>
<a name="1573"><span class="lineNum">    1573 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="1574"><span class="lineNum">    1574 </span>                :            : </a>
<a name="1575"><span class="lineNum">    1575 </span>                :<span class="lineCov">          1 :   QgsCircularString l5;</span></a>
<a name="1576"><span class="lineNum">    1576 </span>                :<span class="lineCov">          1 :   l5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="1577"><span class="lineNum">    1577 </span>                :<span class="lineCov">          1 :   QVERIFY( !l5.isEmpty() );</span></a>
<a name="1578"><span class="lineNum">    1578 </span>                :<span class="lineCov">          1 :   QVERIFY( l5.is3D() );</span></a>
<a name="1579"><span class="lineNum">    1579 </span>                :<span class="lineCov">          1 :   QVERIFY( l5.isMeasure() );</span></a>
<a name="1580"><span class="lineNum">    1580 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1581"><span class="lineNum">    1581 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.wktTypeStr(), QString( &quot;CircularStringZM&quot; ) );</span></a>
<a name="1582"><span class="lineNum">    1582 </span>                :<span class="lineCov">          1 :   l5.points( pts );</span></a>
<a name="1583"><span class="lineNum">    1583 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="1584"><span class="lineNum">    1584 </span>                :            : </a>
<a name="1585"><span class="lineNum">    1585 </span>                :            :   //clear</a>
<a name="1586"><span class="lineNum">    1586 </span>                :<span class="lineCov">          1 :   l5.clear();</span></a>
<a name="1587"><span class="lineNum">    1587 </span>                :<span class="lineCov">          1 :   QVERIFY( l5.isEmpty() );</span></a>
<a name="1588"><span class="lineNum">    1588 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.numPoints(), 0 );</span></a>
<a name="1589"><span class="lineNum">    1589 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.vertexCount(), 0 );</span></a>
<a name="1590"><span class="lineNum">    1590 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.nCoordinates(), 0 );</span></a>
<a name="1591"><span class="lineNum">    1591 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.ringCount(), 0 );</span></a>
<a name="1592"><span class="lineNum">    1592 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.partCount(), 0 );</span></a>
<a name="1593"><span class="lineNum">    1593 </span>                :<span class="lineCov">          1 :   QVERIFY( !l5.is3D() );</span></a>
<a name="1594"><span class="lineNum">    1594 </span>                :<span class="lineCov">          1 :   QVERIFY( !l5.isMeasure() );</span></a>
<a name="1595"><span class="lineNum">    1595 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1596"><span class="lineNum">    1596 </span>                :            : </a>
<a name="1597"><span class="lineNum">    1597 </span>                :            :   //setPoints</a>
<a name="1598"><span class="lineNum">    1598 </span>                :<span class="lineCov">          1 :   QgsCircularString l8;</span></a>
<a name="1599"><span class="lineNum">    1599 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="1600"><span class="lineNum">    1600 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isEmpty() );</span></a>
<a name="1601"><span class="lineNum">    1601 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 3 );</span></a>
<a name="1602"><span class="lineNum">    1602 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.vertexCount(), 3 );</span></a>
<a name="1603"><span class="lineNum">    1603 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.nCoordinates(), 3 );</span></a>
<a name="1604"><span class="lineNum">    1604 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.ringCount(), 1 );</span></a>
<a name="1605"><span class="lineNum">    1605 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.partCount(), 1 );</span></a>
<a name="1606"><span class="lineNum">    1606 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.is3D() );</span></a>
<a name="1607"><span class="lineNum">    1607 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isMeasure() );</span></a>
<a name="1608"><span class="lineNum">    1608 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1609"><span class="lineNum">    1609 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.hasCurvedSegments() );</span></a>
<a name="1610"><span class="lineNum">    1610 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1611"><span class="lineNum">    1611 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="1612"><span class="lineNum">    1612 </span>                :            : </a>
<a name="1613"><span class="lineNum">    1613 </span>                :            :   //setPoints with empty list, should clear linestring</a>
<a name="1614"><span class="lineNum">    1614 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() );</span></a>
<a name="1615"><span class="lineNum">    1615 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isEmpty() );</span></a>
<a name="1616"><span class="lineNum">    1616 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 0 );</span></a>
<a name="1617"><span class="lineNum">    1617 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.vertexCount(), 0 );</span></a>
<a name="1618"><span class="lineNum">    1618 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.nCoordinates(), 0 );</span></a>
<a name="1619"><span class="lineNum">    1619 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.ringCount(), 0 );</span></a>
<a name="1620"><span class="lineNum">    1620 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.partCount(), 0 );</span></a>
<a name="1621"><span class="lineNum">    1621 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1622"><span class="lineNum">    1622 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1623"><span class="lineNum">    1623 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.empty() );</span></a>
<a name="1624"><span class="lineNum">    1624 </span>                :            : </a>
<a name="1625"><span class="lineNum">    1625 </span>                :            :   //setPoints with z</a>
<a name="1626"><span class="lineNum">    1626 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="1627"><span class="lineNum">    1627 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="1628"><span class="lineNum">    1628 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="1629"><span class="lineNum">    1629 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isMeasure() );</span></a>
<a name="1630"><span class="lineNum">    1630 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="1631"><span class="lineNum">    1631 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1632"><span class="lineNum">    1632 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="1633"><span class="lineNum">    1633 </span>                :            : </a>
<a name="1634"><span class="lineNum">    1634 </span>                :            :   //setPoints with m</a>
<a name="1635"><span class="lineNum">    1635 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="1636"><span class="lineNum">    1636 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="1637"><span class="lineNum">    1637 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.is3D() );</span></a>
<a name="1638"><span class="lineNum">    1638 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="1639"><span class="lineNum">    1639 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="1640"><span class="lineNum">    1640 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1641"><span class="lineNum">    1641 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="1642"><span class="lineNum">    1642 </span>                :            : </a>
<a name="1643"><span class="lineNum">    1643 </span>                :            :   //setPoints with zm</a>
<a name="1644"><span class="lineNum">    1644 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="1645"><span class="lineNum">    1645 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="1646"><span class="lineNum">    1646 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="1647"><span class="lineNum">    1647 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="1648"><span class="lineNum">    1648 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1649"><span class="lineNum">    1649 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1650"><span class="lineNum">    1650 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="1651"><span class="lineNum">    1651 </span>                :            : </a>
<a name="1652"><span class="lineNum">    1652 </span>                :            :   //setPoints with MIXED dimensionality of points</a>
<a name="1653"><span class="lineNum">    1653 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 ) );</span></a>
<a name="1654"><span class="lineNum">    1654 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="1655"><span class="lineNum">    1655 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="1656"><span class="lineNum">    1656 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="1657"><span class="lineNum">    1657 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1658"><span class="lineNum">    1658 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="1659"><span class="lineNum">    1659 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 0, 5 ) );</span></a>
<a name="1660"><span class="lineNum">    1660 </span>                :            : </a>
<a name="1661"><span class="lineNum">    1661 </span>                :            :   //test point</a>
<a name="1662"><span class="lineNum">    1662 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) );</span></a>
<a name="1663"><span class="lineNum">    1663 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 2, 3, 0, 5 ) );</span></a>
<a name="1664"><span class="lineNum">    1664 </span>                :            : </a>
<a name="1665"><span class="lineNum">    1665 </span>                :            :   //out of range - just want no crash here</a>
<a name="1666"><span class="lineNum">    1666 </span>                :<span class="lineCov">          1 :   QgsPoint bad = l8.pointN( -1 );</span></a>
<a name="1667"><span class="lineNum">    1667 </span>                :<span class="lineCov">          1 :   bad = l8.pointN( 100 );</span></a>
<a name="1668"><span class="lineNum">    1668 </span>                :            : </a>
<a name="1669"><span class="lineNum">    1669 </span>                :            :   //test getters/setters</a>
<a name="1670"><span class="lineNum">    1670 </span>                :<span class="lineCov">          1 :   QgsCircularString l9;</span></a>
<a name="1671"><span class="lineNum">    1671 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1672"><span class="lineNum">    1672 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 )</span></a>
<a name="1673"><span class="lineNum">    1673 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 ) );</span></a>
<a name="1674"><span class="lineNum">    1674 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 0 ), 1.0 );</span></a>
<a name="1675"><span class="lineNum">    1675 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 1 ), 11.0 );</span></a>
<a name="1676"><span class="lineNum">    1676 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 2 ), 21.0 );</span></a>
<a name="1677"><span class="lineNum">    1677 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( -1 ), 0.0 ); //out of range</span></a>
<a name="1678"><span class="lineNum">    1678 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 11 ), 0.0 ); //out of range</span></a>
<a name="1679"><span class="lineNum">    1679 </span>                :            : </a>
<a name="1680"><span class="lineNum">    1680 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 51.0, 2 ) );</span></a>
<a name="1681"><span class="lineNum">    1681 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 0 ), 51.0 );</span></a>
<a name="1682"><span class="lineNum">    1682 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 61.0, 12 ) );</span></a>
<a name="1683"><span class="lineNum">    1683 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 1 ), 61.0 );</span></a>
<a name="1684"><span class="lineNum">    1684 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 71.0, 2 ) ); //out of range</span></a>
<a name="1685"><span class="lineNum">    1685 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 11 ), QgsPoint( 71.0, 2 ) ); //out of range</span></a>
<a name="1686"><span class="lineNum">    1686 </span>                :            : </a>
<a name="1687"><span class="lineNum">    1687 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 0 ), 2.0 );</span></a>
<a name="1688"><span class="lineNum">    1688 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 1 ), 12.0 );</span></a>
<a name="1689"><span class="lineNum">    1689 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 2 ), 22.0 );</span></a>
<a name="1690"><span class="lineNum">    1690 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( -1 ), 0.0 ); //out of range</span></a>
<a name="1691"><span class="lineNum">    1691 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 11 ), 0.0 ); //out of range</span></a>
<a name="1692"><span class="lineNum">    1692 </span>                :            : </a>
<a name="1693"><span class="lineNum">    1693 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 51.0, 52 ) );</span></a>
<a name="1694"><span class="lineNum">    1694 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 0 ), 52.0 );</span></a>
<a name="1695"><span class="lineNum">    1695 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 61.0, 62 ) );</span></a>
<a name="1696"><span class="lineNum">    1696 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 1 ), 62.0 );</span></a>
<a name="1697"><span class="lineNum">    1697 </span>                :            : </a>
<a name="1698"><span class="lineNum">    1698 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 0 ).z(), 3.0 );</span></a>
<a name="1699"><span class="lineNum">    1699 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 1 ).z(), 13.0 );</span></a>
<a name="1700"><span class="lineNum">    1700 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 2 ).z(), 23.0 );</span></a>
<a name="1701"><span class="lineNum">    1701 </span>                :            : </a>
<a name="1702"><span class="lineNum">    1702 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 71.0, 2, 53 ) );</span></a>
<a name="1703"><span class="lineNum">    1703 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 0 ).z(), 53.0 );</span></a>
<a name="1704"><span class="lineNum">    1704 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 71.0, 2, 63 ) );</span></a>
<a name="1705"><span class="lineNum">    1705 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 1 ).z(), 63.0 );</span></a>
<a name="1706"><span class="lineNum">    1706 </span>                :            : </a>
<a name="1707"><span class="lineNum">    1707 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 0 ).m(), 4.0 );</span></a>
<a name="1708"><span class="lineNum">    1708 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 1 ).m(), 14.0 );</span></a>
<a name="1709"><span class="lineNum">    1709 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 2 ).m(), 24.0 );</span></a>
<a name="1710"><span class="lineNum">    1710 </span>                :            : </a>
<a name="1711"><span class="lineNum">    1711 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 71.0, 2, 53, 54 ) );</span></a>
<a name="1712"><span class="lineNum">    1712 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 0 ).m(), 54.0 );</span></a>
<a name="1713"><span class="lineNum">    1713 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 71.0, 2, 53, 64 ) );</span></a>
<a name="1714"><span class="lineNum">    1714 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.pointN( 1 ).m(), 64.0 );</span></a>
<a name="1715"><span class="lineNum">    1715 </span>                :            : </a>
<a name="1716"><span class="lineNum">    1716 </span>                :            :   //check zAt/setZAt with non-3d linestring</a>
<a name="1717"><span class="lineNum">    1717 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 )</span></a>
<a name="1718"><span class="lineNum">    1718 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 )</span></a>
<a name="1719"><span class="lineNum">    1719 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 24 ) );</span></a>
<a name="1720"><span class="lineNum">    1720 </span>                :            : </a>
<a name="1721"><span class="lineNum">    1721 </span>                :            :   //basically we just don't want these to crash</a>
<a name="1722"><span class="lineNum">    1722 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.pointN( 0 ).z() ) );</span></a>
<a name="1723"><span class="lineNum">    1723 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.pointN( 1 ).z() ) );</span></a>
<a name="1724"><span class="lineNum">    1724 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 71.0, 2, 53 ) );</span></a>
<a name="1725"><span class="lineNum">    1725 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 71.0, 2, 63 ) );</span></a>
<a name="1726"><span class="lineNum">    1726 </span>                :            : </a>
<a name="1727"><span class="lineNum">    1727 </span>                :            :   //check mAt/setMAt with non-measure linestring</a>
<a name="1728"><span class="lineNum">    1728 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="1729"><span class="lineNum">    1729 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="1730"><span class="lineNum">    1730 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="1731"><span class="lineNum">    1731 </span>                :            : </a>
<a name="1732"><span class="lineNum">    1732 </span>                :            :   //basically we just don't want these to crash</a>
<a name="1733"><span class="lineNum">    1733 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.pointN( 0 ).m() ) );</span></a>
<a name="1734"><span class="lineNum">    1734 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.pointN( 1 ).m() ) );</span></a>
<a name="1735"><span class="lineNum">    1735 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 71.0, 2, 0, 53 ) );</span></a>
<a name="1736"><span class="lineNum">    1736 </span>                :<span class="lineCov">          1 :   l9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 71.0, 2, 0, 63 ) );</span></a>
<a name="1737"><span class="lineNum">    1737 </span>                :            : </a>
<a name="1738"><span class="lineNum">    1738 </span>                :            :   //equality</a>
<a name="1739"><span class="lineNum">    1739 </span>                :<span class="lineCov">          1 :   QgsCircularString e1;</span></a>
<a name="1740"><span class="lineNum">    1740 </span>                :<span class="lineCov">          1 :   QgsCircularString e2;</span></a>
<a name="1741"><span class="lineNum">    1741 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="1742"><span class="lineNum">    1742 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="1743"><span class="lineNum">    1743 </span>                :<span class="lineCov">          1 :   e1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1744"><span class="lineNum">    1744 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different number of vertices</span></a>
<a name="1745"><span class="lineNum">    1745 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="1746"><span class="lineNum">    1746 </span>                :<span class="lineCov">          1 :   e2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="1747"><span class="lineNum">    1747 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="1748"><span class="lineNum">    1748 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="1749"><span class="lineNum">    1749 </span>                :<span class="lineCov">          1 :   e1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 1 / 3.0, 4 / 3.0 ) );</span></a>
<a name="1750"><span class="lineNum">    1750 </span>                :<span class="lineCov">          1 :   e2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2 / 6.0, 8 / 6.0 ) );</span></a>
<a name="1751"><span class="lineNum">    1751 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 ); //check non-integer equality</span></a>
<a name="1752"><span class="lineNum">    1752 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="1753"><span class="lineNum">    1753 </span>                :<span class="lineCov">          1 :   e1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 1 / 3.0, 4 / 3.0 ) &lt;&lt; QgsPoint( 7, 8 ) );</span></a>
<a name="1754"><span class="lineNum">    1754 </span>                :<span class="lineCov">          1 :   e2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2 / 6.0, 8 / 6.0 ) &lt;&lt; QgsPoint( 6, 9 ) );</span></a>
<a name="1755"><span class="lineNum">    1755 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different coordinates</span></a>
<a name="1756"><span class="lineNum">    1756 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="1757"><span class="lineNum">    1757 </span>                :<span class="lineCov">          1 :   QgsCircularString e3;</span></a>
<a name="1758"><span class="lineNum">    1758 </span>                :<span class="lineCov">          2 :   e3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 0 )</span></a>
<a name="1759"><span class="lineNum">    1759 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 0 )</span></a>
<a name="1760"><span class="lineNum">    1760 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 0 ) );</span></a>
<a name="1761"><span class="lineNum">    1761 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e3 ) ); //different dimension</span></a>
<a name="1762"><span class="lineNum">    1762 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e3 );</span></a>
<a name="1763"><span class="lineNum">    1763 </span>                :<span class="lineCov">          1 :   QgsCircularString e4;</span></a>
<a name="1764"><span class="lineNum">    1764 </span>                :<span class="lineCov">          2 :   e4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 )</span></a>
<a name="1765"><span class="lineNum">    1765 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 3 )</span></a>
<a name="1766"><span class="lineNum">    1766 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 4 ) );</span></a>
<a name="1767"><span class="lineNum">    1767 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e3 == e4 ) ); //different z coordinates</span></a>
<a name="1768"><span class="lineNum">    1768 </span>                :<span class="lineCov">          1 :   QVERIFY( e3 != e4 );</span></a>
<a name="1769"><span class="lineNum">    1769 </span>                :<span class="lineCov">          1 :   QgsCircularString e5;</span></a>
<a name="1770"><span class="lineNum">    1770 </span>                :<span class="lineCov">          2 :   e5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 1 )</span></a>
<a name="1771"><span class="lineNum">    1771 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 2 )</span></a>
<a name="1772"><span class="lineNum">    1772 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 3 ) );</span></a>
<a name="1773"><span class="lineNum">    1773 </span>                :<span class="lineCov">          1 :   QgsCircularString e6;</span></a>
<a name="1774"><span class="lineNum">    1774 </span>                :<span class="lineCov">          2 :   e6.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 11 )</span></a>
<a name="1775"><span class="lineNum">    1775 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 12 )</span></a>
<a name="1776"><span class="lineNum">    1776 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 13 ) );</span></a>
<a name="1777"><span class="lineNum">    1777 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e5 == e6 ) ); //different m values</span></a>
<a name="1778"><span class="lineNum">    1778 </span>                :<span class="lineCov">          1 :   QVERIFY( e5 != e6 );</span></a>
<a name="1779"><span class="lineNum">    1779 </span>                :            : </a>
<a name="1780"><span class="lineNum">    1780 </span>                :<span class="lineCov">          1 :   QVERIFY( e6 != QgsLineString() );</span></a>
<a name="1781"><span class="lineNum">    1781 </span>                :            : </a>
<a name="1782"><span class="lineNum">    1782 </span>                :            :   //isClosed</a>
<a name="1783"><span class="lineNum">    1783 </span>                :<span class="lineCov">          1 :   QgsCircularString l11;</span></a>
<a name="1784"><span class="lineNum">    1784 </span>                :<span class="lineCov">          1 :   QVERIFY( !l11.isClosed() );</span></a>
<a name="1785"><span class="lineNum">    1785 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="1786"><span class="lineNum">    1786 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="1787"><span class="lineNum">    1787 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="1788"><span class="lineNum">    1788 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="1789"><span class="lineNum">    1789 </span>                :<span class="lineCov">          1 :   QVERIFY( !l11.isClosed() );</span></a>
<a name="1790"><span class="lineNum">    1790 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.numPoints(), 4 );</span></a>
<a name="1791"><span class="lineNum">    1791 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.area(), 0.0 );</span></a>
<a name="1792"><span class="lineNum">    1792 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.perimeter(), 0.0 );</span></a>
<a name="1793"><span class="lineNum">    1793 </span>                :            : </a>
<a name="1794"><span class="lineNum">    1794 </span>                :            :   //test that m values aren't considered when testing for closedness</a>
<a name="1795"><span class="lineNum">    1795 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 )</span></a>
<a name="1796"><span class="lineNum">    1796 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 2, 0, 4 )</span></a>
<a name="1797"><span class="lineNum">    1797 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 22, 0, 5 )</span></a>
<a name="1798"><span class="lineNum">    1798 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 6 ) );</span></a>
<a name="1799"><span class="lineNum">    1799 </span>                :<span class="lineCov">          1 :   QVERIFY( l11.isClosed() );</span></a>
<a name="1800"><span class="lineNum">    1800 </span>                :            : </a>
<a name="1801"><span class="lineNum">    1801 </span>                :            :   //polygonf</a>
<a name="1802"><span class="lineNum">    1802 </span>                :<span class="lineCov">          1 :   QgsCircularString l13;</span></a>
<a name="1803"><span class="lineNum">    1803 </span>                :<span class="lineCov">          2 :   l13.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1804"><span class="lineNum">    1804 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="1805"><span class="lineNum">    1805 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 ) );</span></a>
<a name="1806"><span class="lineNum">    1806 </span>                :            : </a>
<a name="1807"><span class="lineNum">    1807 </span>                :<span class="lineCov">          1 :   QPolygonF poly = l13.asQPolygonF();</span></a>
<a name="1808"><span class="lineNum">    1808 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.count(), 181 );</span></a>
<a name="1809"><span class="lineNum">    1809 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).x(), 1.0 );</span></a>
<a name="1810"><span class="lineNum">    1810 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).y(), 2.0 );</span></a>
<a name="1811"><span class="lineNum">    1811 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 180 ).x(), 11.0 );</span></a>
<a name="1812"><span class="lineNum">    1812 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 180 ).y(), 22.0 );</span></a>
<a name="1813"><span class="lineNum">    1813 </span>                :            : </a>
<a name="1814"><span class="lineNum">    1814 </span>                :            :   // clone tests</a>
<a name="1815"><span class="lineNum">    1815 </span>                :<span class="lineCov">          1 :   QgsCircularString l14;</span></a>
<a name="1816"><span class="lineNum">    1816 </span>                :<span class="lineCov">          2 :   l14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="1817"><span class="lineNum">    1817 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="1818"><span class="lineNum">    1818 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="1819"><span class="lineNum">    1819 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="1820"><span class="lineNum">    1820 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsCircularString&gt; cloned( l14.clone() );</span></a>
<a name="1821"><span class="lineNum">    1821 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 4 );</span></a>
<a name="1822"><span class="lineNum">    1822 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;vertexCount(), 4 );</span></a>
<a name="1823"><span class="lineNum">    1823 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;ringCount(), 1 );</span></a>
<a name="1824"><span class="lineNum">    1824 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;partCount(), 1 );</span></a>
<a name="1825"><span class="lineNum">    1825 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1826"><span class="lineNum">    1826 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;is3D() );</span></a>
<a name="1827"><span class="lineNum">    1827 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;isMeasure() );</span></a>
<a name="1828"><span class="lineNum">    1828 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="1829"><span class="lineNum">    1829 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="1830"><span class="lineNum">    1830 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="1831"><span class="lineNum">    1831 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="1832"><span class="lineNum">    1832 </span>                :            : </a>
<a name="1833"><span class="lineNum">    1833 </span>                :            :   //clone with Z/M</a>
<a name="1834"><span class="lineNum">    1834 </span>                :<span class="lineCov">          2 :   l14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1835"><span class="lineNum">    1835 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="1836"><span class="lineNum">    1836 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="1837"><span class="lineNum">    1837 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="1838"><span class="lineNum">    1838 </span>                :<span class="lineCov">          1 :   cloned.reset( l14.clone() );</span></a>
<a name="1839"><span class="lineNum">    1839 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 4 );</span></a>
<a name="1840"><span class="lineNum">    1840 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1841"><span class="lineNum">    1841 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;is3D() );</span></a>
<a name="1842"><span class="lineNum">    1842 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isMeasure() );</span></a>
<a name="1843"><span class="lineNum">    1843 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="1844"><span class="lineNum">    1844 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="1845"><span class="lineNum">    1845 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="1846"><span class="lineNum">    1846 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="1847"><span class="lineNum">    1847 </span>                :            : </a>
<a name="1848"><span class="lineNum">    1848 </span>                :            :   //clone an empty line</a>
<a name="1849"><span class="lineNum">    1849 </span>                :<span class="lineCov">          1 :   l14.clear();</span></a>
<a name="1850"><span class="lineNum">    1850 </span>                :<span class="lineCov">          1 :   cloned.reset( l14.clone() );</span></a>
<a name="1851"><span class="lineNum">    1851 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="1852"><span class="lineNum">    1852 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 0 );</span></a>
<a name="1853"><span class="lineNum">    1853 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;is3D() );</span></a>
<a name="1854"><span class="lineNum">    1854 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;isMeasure() );</span></a>
<a name="1855"><span class="lineNum">    1855 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1856"><span class="lineNum">    1856 </span>                :            : </a>
<a name="1857"><span class="lineNum">    1857 </span>                :            :   //segmentize tests</a>
<a name="1858"><span class="lineNum">    1858 </span>                :<span class="lineCov">          1 :   QgsCircularString toSegment;</span></a>
<a name="1859"><span class="lineNum">    1859 </span>                :<span class="lineCov">          2 :   toSegment.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="1860"><span class="lineNum">    1860 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 21, 2 ) );</span></a>
<a name="1861"><span class="lineNum">    1861 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsLineString&gt; segmentized( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="1862"><span class="lineNum">    1862 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 156 );</span></a>
<a name="1863"><span class="lineNum">    1863 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;vertexCount(), 156 );</span></a>
<a name="1864"><span class="lineNum">    1864 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;ringCount(), 1 );</span></a>
<a name="1865"><span class="lineNum">    1865 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;partCount(), 1 );</span></a>
<a name="1866"><span class="lineNum">    1866 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1867"><span class="lineNum">    1867 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="1868"><span class="lineNum">    1868 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="1869"><span class="lineNum">    1869 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), toSegment.pointN( 0 ) );</span></a>
<a name="1870"><span class="lineNum">    1870 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), toSegment.pointN( toSegment.numPoints() - 1 ) );</span></a>
<a name="1871"><span class="lineNum">    1871 </span>                :            : </a>
<a name="1872"><span class="lineNum">    1872 </span>                :            :   //segmentize with Z/M</a>
<a name="1873"><span class="lineNum">    1873 </span>                :<span class="lineCov">          2 :   toSegment.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1874"><span class="lineNum">    1874 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 10, 11, 14 )</span></a>
<a name="1875"><span class="lineNum">    1875 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 2, 21, 24 ) );</span></a>
<a name="1876"><span class="lineNum">    1876 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="1877"><span class="lineNum">    1877 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 156 );</span></a>
<a name="1878"><span class="lineNum">    1878 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;vertexCount(), 156 );</span></a>
<a name="1879"><span class="lineNum">    1879 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;ringCount(), 1 );</span></a>
<a name="1880"><span class="lineNum">    1880 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;partCount(), 1 );</span></a>
<a name="1881"><span class="lineNum">    1881 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="1882"><span class="lineNum">    1882 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="1883"><span class="lineNum">    1883 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="1884"><span class="lineNum">    1884 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), toSegment.pointN( 0 ) );</span></a>
<a name="1885"><span class="lineNum">    1885 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), toSegment.pointN( toSegment.numPoints() - 1 ) );</span></a>
<a name="1886"><span class="lineNum">    1886 </span>                :            : </a>
<a name="1887"><span class="lineNum">    1887 </span>                :            :   //segmentize an empty line</a>
<a name="1888"><span class="lineNum">    1888 </span>                :<span class="lineCov">          1 :   toSegment.clear();</span></a>
<a name="1889"><span class="lineNum">    1889 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="1890"><span class="lineNum">    1890 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isEmpty() );</span></a>
<a name="1891"><span class="lineNum">    1891 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 0 );</span></a>
<a name="1892"><span class="lineNum">    1892 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="1893"><span class="lineNum">    1893 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="1894"><span class="lineNum">    1894 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="1895"><span class="lineNum">    1895 </span>                :            : </a>
<a name="1896"><span class="lineNum">    1896 </span>                :            :   //to/from WKB</a>
<a name="1897"><span class="lineNum">    1897 </span>                :<span class="lineCov">          1 :   QgsCircularString l15;</span></a>
<a name="1898"><span class="lineNum">    1898 </span>                :<span class="lineCov">          2 :   l15.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1899"><span class="lineNum">    1899 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="1900"><span class="lineNum">    1900 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="1901"><span class="lineNum">    1901 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="1902"><span class="lineNum">    1902 </span>                :<span class="lineCov">          1 :   QByteArray wkb15 = l15.asWkb();</span></a>
<a name="1903"><span class="lineNum">    1903 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb15.size(), l15.wkbSize() );</span></a>
<a name="1904"><span class="lineNum">    1904 </span>                :<span class="lineCov">          1 :   QgsCircularString l16;</span></a>
<a name="1905"><span class="lineNum">    1905 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb15ptr( wkb15 );</span></a>
<a name="1906"><span class="lineNum">    1906 </span>                :<span class="lineCov">          1 :   l16.fromWkb( wkb15ptr );</span></a>
<a name="1907"><span class="lineNum">    1907 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.numPoints(), 4 );</span></a>
<a name="1908"><span class="lineNum">    1908 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.vertexCount(), 4 );</span></a>
<a name="1909"><span class="lineNum">    1909 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.nCoordinates(), 4 );</span></a>
<a name="1910"><span class="lineNum">    1910 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.ringCount(), 1 );</span></a>
<a name="1911"><span class="lineNum">    1911 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.partCount(), 1 );</span></a>
<a name="1912"><span class="lineNum">    1912 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1913"><span class="lineNum">    1913 </span>                :<span class="lineCov">          1 :   QVERIFY( l16.is3D() );</span></a>
<a name="1914"><span class="lineNum">    1914 </span>                :<span class="lineCov">          1 :   QVERIFY( l16.isMeasure() );</span></a>
<a name="1915"><span class="lineNum">    1915 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 0 ), l15.pointN( 0 ) );</span></a>
<a name="1916"><span class="lineNum">    1916 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 1 ), l15.pointN( 1 ) );</span></a>
<a name="1917"><span class="lineNum">    1917 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 2 ), l15.pointN( 2 ) );</span></a>
<a name="1918"><span class="lineNum">    1918 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 3 ), l15.pointN( 3 ) );</span></a>
<a name="1919"><span class="lineNum">    1919 </span>                :            : </a>
<a name="1920"><span class="lineNum">    1920 </span>                :            :   //bad WKB - check for no crash</a>
<a name="1921"><span class="lineNum">    1921 </span>                :<span class="lineCov">          1 :   l16.clear();</span></a>
<a name="1922"><span class="lineNum">    1922 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="1923"><span class="lineNum">    1923 </span>                :<span class="lineCov">          1 :   QVERIFY( !l16.fromWkb( nullPtr ) );</span></a>
<a name="1924"><span class="lineNum">    1924 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1925"><span class="lineNum">    1925 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="1926"><span class="lineNum">    1926 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = point.asWkb();</span></a>
<a name="1927"><span class="lineNum">    1927 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="1928"><span class="lineNum">    1928 </span>                :<span class="lineCov">          1 :   QVERIFY( !l16.fromWkb( wkb16ptr ) );</span></a>
<a name="1929"><span class="lineNum">    1929 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1930"><span class="lineNum">    1930 </span>                :            : </a>
<a name="1931"><span class="lineNum">    1931 </span>                :            :   //to/from WKT</a>
<a name="1932"><span class="lineNum">    1932 </span>                :<span class="lineCov">          1 :   QgsCircularString l17;</span></a>
<a name="1933"><span class="lineNum">    1933 </span>                :<span class="lineCov">          2 :   l17.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="1934"><span class="lineNum">    1934 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="1935"><span class="lineNum">    1935 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="1936"><span class="lineNum">    1936 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="1937"><span class="lineNum">    1937 </span>                :            : </a>
<a name="1938"><span class="lineNum">    1938 </span>                :<span class="lineCov">          1 :   QString wkt = l17.asWkt();</span></a>
<a name="1939"><span class="lineNum">    1939 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="1940"><span class="lineNum">    1940 </span>                :<span class="lineCov">          1 :   QgsCircularString l18;</span></a>
<a name="1941"><span class="lineNum">    1941 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.fromWkt( wkt ) );</span></a>
<a name="1942"><span class="lineNum">    1942 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.numPoints(), 4 );</span></a>
<a name="1943"><span class="lineNum">    1943 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="1944"><span class="lineNum">    1944 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.is3D() );</span></a>
<a name="1945"><span class="lineNum">    1945 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.isMeasure() );</span></a>
<a name="1946"><span class="lineNum">    1946 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 0 ), l17.pointN( 0 ) );</span></a>
<a name="1947"><span class="lineNum">    1947 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 1 ), l17.pointN( 1 ) );</span></a>
<a name="1948"><span class="lineNum">    1948 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 2 ), l17.pointN( 2 ) );</span></a>
<a name="1949"><span class="lineNum">    1949 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 3 ), l17.pointN( 3 ) );</span></a>
<a name="1950"><span class="lineNum">    1950 </span>                :            : </a>
<a name="1951"><span class="lineNum">    1951 </span>                :            :   //bad WKT</a>
<a name="1952"><span class="lineNum">    1952 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.fromWkt( &quot;Polygon()&quot; ) );</span></a>
<a name="1953"><span class="lineNum">    1953 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.isEmpty() );</span></a>
<a name="1954"><span class="lineNum">    1954 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.numPoints(), 0 );</span></a>
<a name="1955"><span class="lineNum">    1955 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.is3D() );</span></a>
<a name="1956"><span class="lineNum">    1956 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.isMeasure() );</span></a>
<a name="1957"><span class="lineNum">    1957 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="1958"><span class="lineNum">    1958 </span>                :            : </a>
<a name="1959"><span class="lineNum">    1959 </span>                :            :   //asGML2</a>
<a name="1960"><span class="lineNum">    1960 </span>                :<span class="lineCov">          1 :   QgsCircularString exportLine;</span></a>
<a name="1961"><span class="lineNum">    1961 </span>                :<span class="lineCov">          2 :   exportLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 31, 32 )</span></a>
<a name="1962"><span class="lineNum">    1962 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 41, 42 )</span></a>
<a name="1963"><span class="lineNum">    1963 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 51, 52 ) );</span></a>
<a name="1964"><span class="lineNum">    1964 </span>                :<span class="lineCov">          1 :   QgsCircularString exportLineFloat;</span></a>
<a name="1965"><span class="lineNum">    1965 </span>                :<span class="lineCov">          2 :   exportLineFloat.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1 / 3.0, 2 / 3.0 )</span></a>
<a name="1966"><span class="lineNum">    1966 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 1 + 1 / 3.0, 1 + 2 / 3.0 )</span></a>
<a name="1967"><span class="lineNum">    1967 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 2 + 1 / 3.0, 2 + 2 / 3.0 ) );</span></a>
<a name="1968"><span class="lineNum">    1968 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="1969"><span class="lineNum">    1969 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;31,32 41,42 51,52&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="1970"><span class="lineNum">    1970 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportLine.asGml2( doc ) ), expectedGML2 );</span></a>
<a name="1971"><span class="lineNum">    1971 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.333,0.667 1.333,1.667 2.333,2.667&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="1972"><span class="lineNum">    1972 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportLineFloat.asGml2( doc, 3 ) ), expectedGML2prec3 );</span></a>
<a name="1973"><span class="lineNum">    1973 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="1974"><span class="lineNum">    1974 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCircularString().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="1975"><span class="lineNum">    1975 </span>                :            : </a>
<a name="1976"><span class="lineNum">    1976 </span>                :            :   //asGML3</a>
<a name="1977"><span class="lineNum">    1977 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;31 32 41 42 51 52&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&quot; ) );</span></a>
<a name="1978"><span class="lineNum">    1978 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportLine.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="1979"><span class="lineNum">    1979 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.333 0.667 1.333 1.667 2.333 2.667&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&quot; ) );</span></a>
<a name="1980"><span class="lineNum">    1980 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportLineFloat.asGml3( doc, 3 ) ), expectedGML3prec3 );</span></a>
<a name="1981"><span class="lineNum">    1981 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;Curve xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="1982"><span class="lineNum">    1982 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCircularString().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="1983"><span class="lineNum">    1983 </span>                :            : </a>
<a name="1984"><span class="lineNum">    1984 </span>                :            :   //asJSON</a>
<a name="1985"><span class="lineNum">    1985 </span>                :<span class="lineCov">          2 :   QString expectedJson( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[31.0,32.0],[41.0,42.0],[51.0,52.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; ) );</span></a>
<a name="1986"><span class="lineNum">    1986 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLine.asJson(), expectedJson );</span></a>
<a name="1987"><span class="lineNum">    1987 </span>                :<span class="lineCov">          2 :   QString expectedJsonPrec3( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[0.333,0.667],[1.333,1.667],[2.333,2.667]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; ) );</span></a>
<a name="1988"><span class="lineNum">    1988 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLineFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="1989"><span class="lineNum">    1989 </span>                :            : </a>
<a name="1990"><span class="lineNum">    1990 </span>                :            :   //asKML</a>
<a name="1991"><span class="lineNum">    1991 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;31,32,0 41,42,0 51,52,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="1992"><span class="lineNum">    1992 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLine.asKml(), expectedKml );</span></a>
<a name="1993"><span class="lineNum">    1993 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.333,0.667,0 1.333,1.667,0 2.333,2.667,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="1994"><span class="lineNum">    1994 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLineFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="1995"><span class="lineNum">    1995 </span>                :            : </a>
<a name="1996"><span class="lineNum">    1996 </span>                :            :   //length</a>
<a name="1997"><span class="lineNum">    1997 </span>                :<span class="lineCov">          1 :   QgsCircularString l19;</span></a>
<a name="1998"><span class="lineNum">    1998 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length(), 0.0 );</span></a>
<a name="1999"><span class="lineNum">    1999 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="2000"><span class="lineNum">    2000 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="2001"><span class="lineNum">    2001 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2002"><span class="lineNum">    2002 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l19.length(), 26.1433, 0.001 );</span></a>
<a name="2003"><span class="lineNum">    2003 </span>                :            : </a>
<a name="2004"><span class="lineNum">    2004 </span>                :            :   //startPoint</a>
<a name="2005"><span class="lineNum">    2005 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="2006"><span class="lineNum">    2006 </span>                :            : </a>
<a name="2007"><span class="lineNum">    2007 </span>                :            :   //endPoint</a>
<a name="2008"><span class="lineNum">    2008 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.endPoint(), QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2009"><span class="lineNum">    2009 </span>                :            : </a>
<a name="2010"><span class="lineNum">    2010 </span>                :            :   //bad start/end points. Test that this doesn't crash.</a>
<a name="2011"><span class="lineNum">    2011 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="2012"><span class="lineNum">    2012 </span>                :<span class="lineCov">          1 :   QVERIFY( l19.startPoint().isEmpty() );</span></a>
<a name="2013"><span class="lineNum">    2013 </span>                :<span class="lineCov">          1 :   QVERIFY( l19.endPoint().isEmpty() );</span></a>
<a name="2014"><span class="lineNum">    2014 </span>                :            : </a>
<a name="2015"><span class="lineNum">    2015 </span>                :            :   //curveToLine - no segmentation required, so should return a clone</a>
<a name="2016"><span class="lineNum">    2016 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="2017"><span class="lineNum">    2017 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="2018"><span class="lineNum">    2018 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2019"><span class="lineNum">    2019 </span>                :<span class="lineCov">          1 :   segmentized.reset( l19.curveToLine() );</span></a>
<a name="2020"><span class="lineNum">    2020 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 181 );</span></a>
<a name="2021"><span class="lineNum">    2021 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="2022"><span class="lineNum">    2022 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="2023"><span class="lineNum">    2023 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="2024"><span class="lineNum">    2024 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), l19.pointN( 0 ) );</span></a>
<a name="2025"><span class="lineNum">    2025 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), l19.pointN( l19.numPoints() - 1 ) );</span></a>
<a name="2026"><span class="lineNum">    2026 </span>                :            : </a>
<a name="2027"><span class="lineNum">    2027 </span>                :            :   // points</a>
<a name="2028"><span class="lineNum">    2028 </span>                :<span class="lineCov">          1 :   QgsCircularString l20;</span></a>
<a name="2029"><span class="lineNum">    2029 </span>                :<span class="lineCov">          1 :   QgsPointSequence points;</span></a>
<a name="2030"><span class="lineNum">    2030 </span>                :<span class="lineCov">          1 :   l20.points( points );</span></a>
<a name="2031"><span class="lineNum">    2031 </span>                :<span class="lineCov">          1 :   QVERIFY( l20.isEmpty() );</span></a>
<a name="2032"><span class="lineNum">    2032 </span>                :<span class="lineCov">          2 :   l20.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="2033"><span class="lineNum">    2033 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="2034"><span class="lineNum">    2034 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2035"><span class="lineNum">    2035 </span>                :<span class="lineCov">          1 :   l20.points( points );</span></a>
<a name="2036"><span class="lineNum">    2036 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 3 );</span></a>
<a name="2037"><span class="lineNum">    2037 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="2038"><span class="lineNum">    2038 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 ) );</span></a>
<a name="2039"><span class="lineNum">    2039 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2040"><span class="lineNum">    2040 </span>                :            : </a>
<a name="2041"><span class="lineNum">    2041 </span>                :            :   //CRS transform</a>
<a name="2042"><span class="lineNum">    2042 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="2043"><span class="lineNum">    2043 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) );// want a transform with ellipsoid change</span></a>
<a name="2044"><span class="lineNum">    2044 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="2045"><span class="lineNum">    2045 </span>                :            : </a>
<a name="2046"><span class="lineNum">    2046 </span>                :            :   // 2d CRS transform</a>
<a name="2047"><span class="lineNum">    2047 </span>                :<span class="lineCov">          1 :   QgsCircularString l21;</span></a>
<a name="2048"><span class="lineNum">    2048 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6374985, -3626584 )</span></a>
<a name="2049"><span class="lineNum">    2049 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6474985, -3526584 ) );</span></a>
<a name="2050"><span class="lineNum">    2050 </span>                :<span class="lineCov">          1 :   l21.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="2051"><span class="lineNum">    2051 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="2052"><span class="lineNum">    2052 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="2053"><span class="lineNum">    2053 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 1 ).x(), 176.959, 0.001 );</span></a>
<a name="2054"><span class="lineNum">    2054 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="2055"><span class="lineNum">    2055 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().xMinimum(), 175.771, 0.001 );</span></a>
<a name="2056"><span class="lineNum">    2056 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="2057"><span class="lineNum">    2057 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="2058"><span class="lineNum">    2058 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="2059"><span class="lineNum">    2059 </span>                :            : </a>
<a name="2060"><span class="lineNum">    2060 </span>                :            :   //3d CRS transform</a>
<a name="2061"><span class="lineNum">    2061 </span>                :<span class="lineCov">          1 :   QgsCircularString l22;</span></a>
<a name="2062"><span class="lineNum">    2062 </span>                :<span class="lineCov">          2 :   l22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 )</span></a>
<a name="2063"><span class="lineNum">    2063 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6474985, -3526584, 3, 4 ) );</span></a>
<a name="2064"><span class="lineNum">    2064 </span>                :<span class="lineCov">          1 :   l22.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="2065"><span class="lineNum">    2065 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="2066"><span class="lineNum">    2066 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="2067"><span class="lineNum">    2067 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="2068"><span class="lineNum">    2068 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 0 ).m(), 2.0 );</span></a>
<a name="2069"><span class="lineNum">    2069 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).x(), 176.959, 0.001 );</span></a>
<a name="2070"><span class="lineNum">    2070 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="2071"><span class="lineNum">    2071 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="2072"><span class="lineNum">    2072 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 1 ).m(), 4.0 );</span></a>
<a name="2073"><span class="lineNum">    2073 </span>                :            : </a>
<a name="2074"><span class="lineNum">    2074 </span>                :            :   //reverse transform</a>
<a name="2075"><span class="lineNum">    2075 </span>                :<span class="lineCov">          1 :   l22.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="2076"><span class="lineNum">    2076 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).x(), 6374985, 0.01 );</span></a>
<a name="2077"><span class="lineNum">    2077 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).y(), -3626584, 0.01 );</span></a>
<a name="2078"><span class="lineNum">    2078 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1, 0.001 );</span></a>
<a name="2079"><span class="lineNum">    2079 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 0 ).m(), 2.0 );</span></a>
<a name="2080"><span class="lineNum">    2080 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).x(), 6474985, 0.01 );</span></a>
<a name="2081"><span class="lineNum">    2081 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).y(), -3526584, 0.01 );</span></a>
<a name="2082"><span class="lineNum">    2082 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3, 0.001 );</span></a>
<a name="2083"><span class="lineNum">    2083 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 1 ).m(), 4.0 );</span></a>
<a name="2084"><span class="lineNum">    2084 </span>                :            : </a>
<a name="2085"><span class="lineNum">    2085 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="2086"><span class="lineNum">    2086 </span>                :            :   //z value transform</a>
<a name="2087"><span class="lineNum">    2087 </span>                :            :   l22.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="2088"><span class="lineNum">    2088 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="2089"><span class="lineNum">    2089 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), -21.092128, 0.001 );</a>
<a name="2090"><span class="lineNum">    2090 </span>                :            :   l22.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="2091"><span class="lineNum">    2091 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1.0, 0.001 );</a>
<a name="2092"><span class="lineNum">    2092 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3.0, 0.001 );</a>
<a name="2093"><span class="lineNum">    2093 </span>                :            : #endif</a>
<a name="2094"><span class="lineNum">    2094 </span>                :            : </a>
<a name="2095"><span class="lineNum">    2095 </span>                :            :   //QTransform transform</a>
<a name="2096"><span class="lineNum">    2096 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="2097"><span class="lineNum">    2097 </span>                :<span class="lineCov">          1 :   QgsCircularString l23;</span></a>
<a name="2098"><span class="lineNum">    2098 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="2099"><span class="lineNum">    2099 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2100"><span class="lineNum">    2100 </span>                :<span class="lineCov">          1 :   l23.transform( qtr );</span></a>
<a name="2101"><span class="lineNum">    2101 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 2, 6, 3, 4 ) );</span></a>
<a name="2102"><span class="lineNum">    2102 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 22, 36, 13, 14 ) );</span></a>
<a name="2103"><span class="lineNum">    2103 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.boundingBox(), QgsRectangle( 2, 6, 22, 36 ) );</span></a>
<a name="2104"><span class="lineNum">    2104 </span>                :            : </a>
<a name="2105"><span class="lineNum">    2105 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="2106"><span class="lineNum">    2106 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2107"><span class="lineNum">    2107 </span>                :<span class="lineCov">          1 :   l23.transform( QTransform::fromScale( 1, 1 ), 3, 2, 4, 3 );</span></a>
<a name="2108"><span class="lineNum">    2108 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 9, 16 ) );</span></a>
<a name="2109"><span class="lineNum">    2109 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 29, 46 ) );</span></a>
<a name="2110"><span class="lineNum">    2110 </span>                :            : </a>
<a name="2111"><span class="lineNum">    2111 </span>                :            :   //insert vertex</a>
<a name="2112"><span class="lineNum">    2112 </span>                :            :   //cannot insert vertex in empty line</a>
<a name="2113"><span class="lineNum">    2113 </span>                :<span class="lineCov">          1 :   QgsCircularString l24;</span></a>
<a name="2114"><span class="lineNum">    2114 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="2115"><span class="lineNum">    2115 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 0 );</span></a>
<a name="2116"><span class="lineNum">    2116 </span>                :            : </a>
<a name="2117"><span class="lineNum">    2117 </span>                :            :   //2d line</a>
<a name="2118"><span class="lineNum">    2118 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="2119"><span class="lineNum">    2119 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="2120"><span class="lineNum">    2120 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 4.0, 7.0 ) ) );</span></a>
<a name="2121"><span class="lineNum">    2121 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 5 );</span></a>
<a name="2122"><span class="lineNum">    2122 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.is3D() );</span></a>
<a name="2123"><span class="lineNum">    2123 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.isMeasure() );</span></a>
<a name="2124"><span class="lineNum">    2124 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2125"><span class="lineNum">    2125 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="2126"><span class="lineNum">    2126 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( 4.0, 7.0 ) );</span></a>
<a name="2127"><span class="lineNum">    2127 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 2 ).x(), 7.192236, 0.01 );</span></a>
<a name="2128"><span class="lineNum">    2128 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 2 ).y(), 9.930870, 0.01 );</span></a>
<a name="2129"><span class="lineNum">    2129 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="2130"><span class="lineNum">    2130 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 4 ), QgsPoint( 1.0, 22.0 ) );</span></a>
<a name="2131"><span class="lineNum">    2131 </span>                :            : </a>
<a name="2132"><span class="lineNum">    2132 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 8.0, 9.0 ) ) );</span></a>
<a name="2133"><span class="lineNum">    2133 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 18.0, 16.0 ) ) );</span></a>
<a name="2134"><span class="lineNum">    2134 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 9 );</span></a>
<a name="2135"><span class="lineNum">    2135 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="2136"><span class="lineNum">    2136 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 1 ).x(), 4.363083, 0.01 );</span></a>
<a name="2137"><span class="lineNum">    2137 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 1 ).y(), 5.636917, 0.01 );</span></a>
<a name="2138"><span class="lineNum">    2138 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 2 ), QgsPoint( 8.0, 9.0 ) );</span></a>
<a name="2139"><span class="lineNum">    2139 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 3 ), QgsPoint( 18.0, 16.0 ) );</span></a>
<a name="2140"><span class="lineNum">    2140 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 4 ).x(), 5.876894, 0.01 );</span></a>
<a name="2141"><span class="lineNum">    2141 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 4 ).y(), 8.246211, 0.01 );</span></a>
<a name="2142"><span class="lineNum">    2142 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 5 ), QgsPoint( 4.0, 7.0 ) );</span></a>
<a name="2143"><span class="lineNum">    2143 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 6 ).x(), 7.192236, 0.01 );</span></a>
<a name="2144"><span class="lineNum">    2144 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l24.pointN( 6 ).y(), 9.930870, 0.01 );</span></a>
<a name="2145"><span class="lineNum">    2145 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 7 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="2146"><span class="lineNum">    2146 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 8 ), QgsPoint( 1.0, 22.0 ) );</span></a>
<a name="2147"><span class="lineNum">    2147 </span>                :            : </a>
<a name="2148"><span class="lineNum">    2148 </span>                :            :   //insert vertex at end</a>
<a name="2149"><span class="lineNum">    2149 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 31.0, 32.0 ) ) );</span></a>
<a name="2150"><span class="lineNum">    2150 </span>                :            : </a>
<a name="2151"><span class="lineNum">    2151 </span>                :            :   //insert vertex past end</a>
<a name="2152"><span class="lineNum">    2152 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="2153"><span class="lineNum">    2153 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 9 );</span></a>
<a name="2154"><span class="lineNum">    2154 </span>                :            : </a>
<a name="2155"><span class="lineNum">    2155 </span>                :            :   //insert vertex before start</a>
<a name="2156"><span class="lineNum">    2156 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, -18 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="2157"><span class="lineNum">    2157 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 9 );</span></a>
<a name="2158"><span class="lineNum">    2158 </span>                :            : </a>
<a name="2159"><span class="lineNum">    2159 </span>                :            :   //insert 4d vertex in 4d line</a>
<a name="2160"><span class="lineNum">    2160 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="2161"><span class="lineNum">    2161 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="2162"><span class="lineNum">    2162 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2163"><span class="lineNum">    2163 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) ) );</span></a>
<a name="2164"><span class="lineNum">    2164 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 5 );</span></a>
<a name="2165"><span class="lineNum">    2165 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2166"><span class="lineNum">    2166 </span>                :            : </a>
<a name="2167"><span class="lineNum">    2167 </span>                :            :   //insert 2d vertex in 4d line</a>
<a name="2168"><span class="lineNum">    2168 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 101, 102 ) ) );</span></a>
<a name="2169"><span class="lineNum">    2169 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 7 );</span></a>
<a name="2170"><span class="lineNum">    2170 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="2171"><span class="lineNum">    2171 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 101, 102 ) );</span></a>
<a name="2172"><span class="lineNum">    2172 </span>                :            : </a>
<a name="2173"><span class="lineNum">    2173 </span>                :            :   //insert 4d vertex in 2d line</a>
<a name="2174"><span class="lineNum">    2174 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="2175"><span class="lineNum">    2175 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="2176"><span class="lineNum">    2176 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 2, 4, 103, 104 ) ) );</span></a>
<a name="2177"><span class="lineNum">    2177 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 5 );</span></a>
<a name="2178"><span class="lineNum">    2178 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2179"><span class="lineNum">    2179 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 2, 4 ) );</span></a>
<a name="2180"><span class="lineNum">    2180 </span>                :            : </a>
<a name="2181"><span class="lineNum">    2181 </span>                :            :   //move vertex</a>
<a name="2182"><span class="lineNum">    2182 </span>                :            : </a>
<a name="2183"><span class="lineNum">    2183 </span>                :            :   //empty line</a>
<a name="2184"><span class="lineNum">    2184 </span>                :<span class="lineCov">          1 :   QgsCircularString l25;</span></a>
<a name="2185"><span class="lineNum">    2185 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="2186"><span class="lineNum">    2186 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.isEmpty() );</span></a>
<a name="2187"><span class="lineNum">    2187 </span>                :            : </a>
<a name="2188"><span class="lineNum">    2188 </span>                :            :   //valid line</a>
<a name="2189"><span class="lineNum">    2189 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="2190"><span class="lineNum">    2190 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="2191"><span class="lineNum">    2191 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="2192"><span class="lineNum">    2192 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="2193"><span class="lineNum">    2193 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="2194"><span class="lineNum">    2194 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="2195"><span class="lineNum">    2195 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="2196"><span class="lineNum">    2196 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="2197"><span class="lineNum">    2197 </span>                :            : </a>
<a name="2198"><span class="lineNum">    2198 </span>                :            :   //out of range</a>
<a name="2199"><span class="lineNum">    2199 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="2200"><span class="lineNum">    2200 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="2201"><span class="lineNum">    2201 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="2202"><span class="lineNum">    2202 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="2203"><span class="lineNum">    2203 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="2204"><span class="lineNum">    2204 </span>                :            : </a>
<a name="2205"><span class="lineNum">    2205 </span>                :            :   //move 4d point in 4d line</a>
<a name="2206"><span class="lineNum">    2206 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="2207"><span class="lineNum">    2207 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="2208"><span class="lineNum">    2208 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="2209"><span class="lineNum">    2209 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) ) );</span></a>
<a name="2210"><span class="lineNum">    2210 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) );</span></a>
<a name="2211"><span class="lineNum">    2211 </span>                :            : </a>
<a name="2212"><span class="lineNum">    2212 </span>                :            :   //move 2d point in 4d line, existing z/m should be maintained</a>
<a name="2213"><span class="lineNum">    2213 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 34, 35 ) ) );</span></a>
<a name="2214"><span class="lineNum">    2214 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 34, 35, 12, 13 ) );</span></a>
<a name="2215"><span class="lineNum">    2215 </span>                :            : </a>
<a name="2216"><span class="lineNum">    2216 </span>                :            :   //move 4d point in 2d line</a>
<a name="2217"><span class="lineNum">    2217 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="2218"><span class="lineNum">    2218 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="2219"><span class="lineNum">    2219 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 3, 4, 2, 3 ) ) );</span></a>
<a name="2220"><span class="lineNum">    2220 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 3, 4 ) );</span></a>
<a name="2221"><span class="lineNum">    2221 </span>                :            : </a>
<a name="2222"><span class="lineNum">    2222 </span>                :            : </a>
<a name="2223"><span class="lineNum">    2223 </span>                :            :   //delete vertex</a>
<a name="2224"><span class="lineNum">    2224 </span>                :            : </a>
<a name="2225"><span class="lineNum">    2225 </span>                :            :   //empty line</a>
<a name="2226"><span class="lineNum">    2226 </span>                :<span class="lineCov">          1 :   QgsCircularString l26;</span></a>
<a name="2227"><span class="lineNum">    2227 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="2228"><span class="lineNum">    2228 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.isEmpty() );</span></a>
<a name="2229"><span class="lineNum">    2229 </span>                :            : </a>
<a name="2230"><span class="lineNum">    2230 </span>                :            :   //valid line</a>
<a name="2231"><span class="lineNum">    2231 </span>                :<span class="lineCov">          2 :   l26.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="2232"><span class="lineNum">    2232 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="2233"><span class="lineNum">    2233 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 )</span></a>
<a name="2234"><span class="lineNum">    2234 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 32, 6, 7 ) );</span></a>
<a name="2235"><span class="lineNum">    2235 </span>                :            :   //out of range vertices</a>
<a name="2236"><span class="lineNum">    2236 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="2237"><span class="lineNum">    2237 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="2238"><span class="lineNum">    2238 </span>                :            : </a>
<a name="2239"><span class="lineNum">    2239 </span>                :            :   //valid vertices</a>
<a name="2240"><span class="lineNum">    2240 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="2241"><span class="lineNum">    2241 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.numPoints(), 2 );</span></a>
<a name="2242"><span class="lineNum">    2242 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="2243"><span class="lineNum">    2243 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 31, 32, 6, 7 ) );</span></a>
<a name="2244"><span class="lineNum">    2244 </span>                :            : </a>
<a name="2245"><span class="lineNum">    2245 </span>                :            :   //removing the next vertex removes all remaining vertices</a>
<a name="2246"><span class="lineNum">    2246 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="2247"><span class="lineNum">    2247 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.numPoints(), 0 );</span></a>
<a name="2248"><span class="lineNum">    2248 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.isEmpty() );</span></a>
<a name="2249"><span class="lineNum">    2249 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="2250"><span class="lineNum">    2250 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.isEmpty() );</span></a>
<a name="2251"><span class="lineNum">    2251 </span>                :            : </a>
<a name="2252"><span class="lineNum">    2252 </span>                :            :   //reversed</a>
<a name="2253"><span class="lineNum">    2253 </span>                :<span class="lineCov">          1 :   QgsCircularString l27;</span></a>
<a name="2254"><span class="lineNum">    2254 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCircularString &gt; reversed( l27.reversed() );</span></a>
<a name="2255"><span class="lineNum">    2255 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isEmpty() );</span></a>
<a name="2256"><span class="lineNum">    2256 </span>                :<span class="lineCov">          2 :   l27.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="2257"><span class="lineNum">    2257 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="2258"><span class="lineNum">    2258 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="2259"><span class="lineNum">    2259 </span>                :<span class="lineCov">          1 :   reversed.reset( l27.reversed() );</span></a>
<a name="2260"><span class="lineNum">    2260 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;numPoints(), 3 );</span></a>
<a name="2261"><span class="lineNum">    2261 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="2262"><span class="lineNum">    2262 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;is3D() );</span></a>
<a name="2263"><span class="lineNum">    2263 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isMeasure() );</span></a>
<a name="2264"><span class="lineNum">    2264 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="2265"><span class="lineNum">    2265 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="2266"><span class="lineNum">    2266 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="2267"><span class="lineNum">    2267 </span>                :            : </a>
<a name="2268"><span class="lineNum">    2268 </span>                :            :   //addZValue</a>
<a name="2269"><span class="lineNum">    2269 </span>                :            : </a>
<a name="2270"><span class="lineNum">    2270 </span>                :<span class="lineCov">          1 :   QgsCircularString l28;</span></a>
<a name="2271"><span class="lineNum">    2271 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2272"><span class="lineNum">    2272 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue() );</span></a>
<a name="2273"><span class="lineNum">    2273 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2274"><span class="lineNum">    2274 </span>                :<span class="lineCov">          1 :   l28.clear();</span></a>
<a name="2275"><span class="lineNum">    2275 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue() );</span></a>
<a name="2276"><span class="lineNum">    2276 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2277"><span class="lineNum">    2277 </span>                :            :   //2d line</a>
<a name="2278"><span class="lineNum">    2278 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2279"><span class="lineNum">    2279 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue( 2 ) );</span></a>
<a name="2280"><span class="lineNum">    2280 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.is3D() );</span></a>
<a name="2281"><span class="lineNum">    2281 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2282"><span class="lineNum">    2282 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="2283"><span class="lineNum">    2283 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="2284"><span class="lineNum">    2284 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28.addZValue( 4 ) ); //already has z value, test that existing z is unchanged</span></a>
<a name="2285"><span class="lineNum">    2285 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="2286"><span class="lineNum">    2286 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="2287"><span class="lineNum">    2287 </span>                :            :   //linestring with m</a>
<a name="2288"><span class="lineNum">    2288 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="2289"><span class="lineNum">    2289 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue( 5 ) );</span></a>
<a name="2290"><span class="lineNum">    2290 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.is3D() );</span></a>
<a name="2291"><span class="lineNum">    2291 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.isMeasure() );</span></a>
<a name="2292"><span class="lineNum">    2292 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="2293"><span class="lineNum">    2293 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5, 3 ) );</span></a>
<a name="2294"><span class="lineNum">    2294 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 5, 4 ) );</span></a>
<a name="2295"><span class="lineNum">    2295 </span>                :            : </a>
<a name="2296"><span class="lineNum">    2296 </span>                :            :   //addMValue</a>
<a name="2297"><span class="lineNum">    2297 </span>                :            : </a>
<a name="2298"><span class="lineNum">    2298 </span>                :<span class="lineCov">          1 :   QgsCircularString l29;</span></a>
<a name="2299"><span class="lineNum">    2299 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2300"><span class="lineNum">    2300 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue() );</span></a>
<a name="2301"><span class="lineNum">    2301 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2302"><span class="lineNum">    2302 </span>                :<span class="lineCov">          1 :   l29.clear();</span></a>
<a name="2303"><span class="lineNum">    2303 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue() );</span></a>
<a name="2304"><span class="lineNum">    2304 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2305"><span class="lineNum">    2305 </span>                :            :   //2d line</a>
<a name="2306"><span class="lineNum">    2306 </span>                :<span class="lineCov">          1 :   l29.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2307"><span class="lineNum">    2307 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue( 2 ) );</span></a>
<a name="2308"><span class="lineNum">    2308 </span>                :<span class="lineCov">          1 :   QVERIFY( !l29.is3D() );</span></a>
<a name="2309"><span class="lineNum">    2309 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.isMeasure() );</span></a>
<a name="2310"><span class="lineNum">    2310 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2311"><span class="lineNum">    2311 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="2312"><span class="lineNum">    2312 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="2313"><span class="lineNum">    2313 </span>                :<span class="lineCov">          1 :   QVERIFY( !l29.addMValue( 4 ) ); //already has m value, test that existing m is unchanged</span></a>
<a name="2314"><span class="lineNum">    2314 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="2315"><span class="lineNum">    2315 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="2316"><span class="lineNum">    2316 </span>                :            :   //linestring with z</a>
<a name="2317"><span class="lineNum">    2317 </span>                :<span class="lineCov">          1 :   l29.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 4 ) );</span></a>
<a name="2318"><span class="lineNum">    2318 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue( 5 ) );</span></a>
<a name="2319"><span class="lineNum">    2319 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.is3D() );</span></a>
<a name="2320"><span class="lineNum">    2320 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.isMeasure() );</span></a>
<a name="2321"><span class="lineNum">    2321 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="2322"><span class="lineNum">    2322 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 5 ) );</span></a>
<a name="2323"><span class="lineNum">    2323 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="2324"><span class="lineNum">    2324 </span>                :            : </a>
<a name="2325"><span class="lineNum">    2325 </span>                :            :   //dropZValue</a>
<a name="2326"><span class="lineNum">    2326 </span>                :<span class="lineCov">          1 :   QgsCircularString l28d;</span></a>
<a name="2327"><span class="lineNum">    2327 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() );</span></a>
<a name="2328"><span class="lineNum">    2328 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2329"><span class="lineNum">    2329 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() );</span></a>
<a name="2330"><span class="lineNum">    2330 </span>                :<span class="lineCov">          1 :   l28d.addZValue( 1.0 );</span></a>
<a name="2331"><span class="lineNum">    2331 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2332"><span class="lineNum">    2332 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.is3D() );</span></a>
<a name="2333"><span class="lineNum">    2333 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropZValue() );</span></a>
<a name="2334"><span class="lineNum">    2334 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.is3D() );</span></a>
<a name="2335"><span class="lineNum">    2335 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2336"><span class="lineNum">    2336 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="2337"><span class="lineNum">    2337 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="2338"><span class="lineNum">    2338 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() ); //already dropped</span></a>
<a name="2339"><span class="lineNum">    2339 </span>                :            :   //linestring with m</a>
<a name="2340"><span class="lineNum">    2340 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="2341"><span class="lineNum">    2341 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropZValue() );</span></a>
<a name="2342"><span class="lineNum">    2342 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.is3D() );</span></a>
<a name="2343"><span class="lineNum">    2343 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.isMeasure() );</span></a>
<a name="2344"><span class="lineNum">    2344 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2345"><span class="lineNum">    2345 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="2346"><span class="lineNum">    2346 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="2347"><span class="lineNum">    2347 </span>                :            : </a>
<a name="2348"><span class="lineNum">    2348 </span>                :            :   //dropMValue</a>
<a name="2349"><span class="lineNum">    2349 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2350"><span class="lineNum">    2350 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropMValue() );</span></a>
<a name="2351"><span class="lineNum">    2351 </span>                :<span class="lineCov">          1 :   l28d.addMValue( 1.0 );</span></a>
<a name="2352"><span class="lineNum">    2352 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2353"><span class="lineNum">    2353 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.isMeasure() );</span></a>
<a name="2354"><span class="lineNum">    2354 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropMValue() );</span></a>
<a name="2355"><span class="lineNum">    2355 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.isMeasure() );</span></a>
<a name="2356"><span class="lineNum">    2356 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2357"><span class="lineNum">    2357 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="2358"><span class="lineNum">    2358 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="2359"><span class="lineNum">    2359 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropMValue() ); //already dropped</span></a>
<a name="2360"><span class="lineNum">    2360 </span>                :            :   //linestring with z</a>
<a name="2361"><span class="lineNum">    2361 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="2362"><span class="lineNum">    2362 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropMValue() );</span></a>
<a name="2363"><span class="lineNum">    2363 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.isMeasure() );</span></a>
<a name="2364"><span class="lineNum">    2364 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.is3D() );</span></a>
<a name="2365"><span class="lineNum">    2365 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2366"><span class="lineNum">    2366 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3, 0 ) );</span></a>
<a name="2367"><span class="lineNum">    2367 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 3, 0 ) );</span></a>
<a name="2368"><span class="lineNum">    2368 </span>                :            : </a>
<a name="2369"><span class="lineNum">    2369 </span>                :            :   //convertTo</a>
<a name="2370"><span class="lineNum">    2370 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2371"><span class="lineNum">    2371 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::CircularString ) );</span></a>
<a name="2372"><span class="lineNum">    2372 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2373"><span class="lineNum">    2373 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::CircularStringZ ) );</span></a>
<a name="2374"><span class="lineNum">    2374 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="2375"><span class="lineNum">    2375 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2 ) );</span></a>
<a name="2376"><span class="lineNum">    2376 </span>                :            : </a>
<a name="2377"><span class="lineNum">    2377 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::CircularStringZM ) );</span></a>
<a name="2378"><span class="lineNum">    2378 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="2379"><span class="lineNum">    2379 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2 ) );</span></a>
<a name="2380"><span class="lineNum">    2380 </span>                :<span class="lineCov">          1 :   l28d.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 1, 2, 5 ) );</span></a>
<a name="2381"><span class="lineNum">    2381 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5.0 ) );</span></a>
<a name="2382"><span class="lineNum">    2382 </span>                :            :   //l28d.setMAt( 0, 6.0 );</a>
<a name="2383"><span class="lineNum">    2383 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::CircularStringM ) );</span></a>
<a name="2384"><span class="lineNum">    2384 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularStringM );</span></a>
<a name="2385"><span class="lineNum">    2385 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2 ) );</span></a>
<a name="2386"><span class="lineNum">    2386 </span>                :<span class="lineCov">          1 :   l28d.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 1, 2, 0, 6 ) );</span></a>
<a name="2387"><span class="lineNum">    2387 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0.0, 6.0 ) );</span></a>
<a name="2388"><span class="lineNum">    2388 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::CircularString ) );</span></a>
<a name="2389"><span class="lineNum">    2389 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2390"><span class="lineNum">    2390 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="2391"><span class="lineNum">    2391 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.convertTo( QgsWkbTypes::Polygon ) );</span></a>
<a name="2392"><span class="lineNum">    2392 </span>                :            : </a>
<a name="2393"><span class="lineNum">    2393 </span>                :            :   //isRing</a>
<a name="2394"><span class="lineNum">    2394 </span>                :<span class="lineCov">          1 :   QgsCircularString l30;</span></a>
<a name="2395"><span class="lineNum">    2395 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() );</span></a>
<a name="2396"><span class="lineNum">    2396 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="2397"><span class="lineNum">    2397 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() ); //&lt;4 points</span></a>
<a name="2398"><span class="lineNum">    2398 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 31, 32 ) );</span></a>
<a name="2399"><span class="lineNum">    2399 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() ); //not closed</span></a>
<a name="2400"><span class="lineNum">    2400 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="2401"><span class="lineNum">    2401 </span>                :<span class="lineCov">          1 :   QVERIFY( l30.isRing() );</span></a>
<a name="2402"><span class="lineNum">    2402 </span>                :            : </a>
<a name="2403"><span class="lineNum">    2403 </span>                :            :   //coordinateSequence</a>
<a name="2404"><span class="lineNum">    2404 </span>                :<span class="lineCov">          1 :   QgsCircularString l31;</span></a>
<a name="2405"><span class="lineNum">    2405 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence coords = l31.coordinateSequence();</span></a>
<a name="2406"><span class="lineNum">    2406 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="2407"><span class="lineNum">    2407 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="2408"><span class="lineNum">    2408 </span>                :<span class="lineCov">          1 :   QVERIFY( coords.at( 0 ).at( 0 ).isEmpty() );</span></a>
<a name="2409"><span class="lineNum">    2409 </span>                :<span class="lineCov">          2 :   l31.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="2410"><span class="lineNum">    2410 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="2411"><span class="lineNum">    2411 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="2412"><span class="lineNum">    2412 </span>                :<span class="lineCov">          1 :   coords = l31.coordinateSequence();</span></a>
<a name="2413"><span class="lineNum">    2413 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="2414"><span class="lineNum">    2414 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="2415"><span class="lineNum">    2415 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).count(), 3 );</span></a>
<a name="2416"><span class="lineNum">    2416 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="2417"><span class="lineNum">    2417 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="2418"><span class="lineNum">    2418 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="2419"><span class="lineNum">    2419 </span>                :            : </a>
<a name="2420"><span class="lineNum">    2420 </span>                :            :   //nextVertex</a>
<a name="2421"><span class="lineNum">    2421 </span>                :            : </a>
<a name="2422"><span class="lineNum">    2422 </span>                :<span class="lineCov">          1 :   QgsCircularString l32;</span></a>
<a name="2423"><span class="lineNum">    2423 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="2424"><span class="lineNum">    2424 </span>                :<span class="lineCov">          1 :   QgsPoint p;</span></a>
<a name="2425"><span class="lineNum">    2425 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2426"><span class="lineNum">    2426 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="2427"><span class="lineNum">    2427 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2428"><span class="lineNum">    2428 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="2429"><span class="lineNum">    2429 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2430"><span class="lineNum">    2430 </span>                :            : </a>
<a name="2431"><span class="lineNum">    2431 </span>                :            :   //CircularString</a>
<a name="2432"><span class="lineNum">    2432 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="2433"><span class="lineNum">    2433 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 2 ); //out of range</span></a>
<a name="2434"><span class="lineNum">    2434 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2435"><span class="lineNum">    2435 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="2436"><span class="lineNum">    2436 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2437"><span class="lineNum">    2437 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="2438"><span class="lineNum">    2438 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2439"><span class="lineNum">    2439 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="2440"><span class="lineNum">    2440 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="2441"><span class="lineNum">    2441 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2442"><span class="lineNum">    2442 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2443"><span class="lineNum">    2443 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="2444"><span class="lineNum">    2444 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2445"><span class="lineNum">    2445 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 0 );</span></a>
<a name="2446"><span class="lineNum">    2446 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2447"><span class="lineNum">    2447 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) ); //test that ring number is maintained</span></a>
<a name="2448"><span class="lineNum">    2448 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="2449"><span class="lineNum">    2449 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="2450"><span class="lineNum">    2450 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2451"><span class="lineNum">    2451 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) ); //test that part number is maintained</span></a>
<a name="2452"><span class="lineNum">    2452 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="2453"><span class="lineNum">    2453 </span>                :            : </a>
<a name="2454"><span class="lineNum">    2454 </span>                :            :   //CircularStringZ</a>
<a name="2455"><span class="lineNum">    2455 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="2456"><span class="lineNum">    2456 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="2457"><span class="lineNum">    2457 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2458"><span class="lineNum">    2458 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="2459"><span class="lineNum">    2459 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="2460"><span class="lineNum">    2460 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2461"><span class="lineNum">    2461 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2462"><span class="lineNum">    2462 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="2463"><span class="lineNum">    2463 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2464"><span class="lineNum">    2464 </span>                :            :   //CircularStringM</a>
<a name="2465"><span class="lineNum">    2465 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="2466"><span class="lineNum">    2466 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="2467"><span class="lineNum">    2467 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2468"><span class="lineNum">    2468 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="2469"><span class="lineNum">    2469 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="2470"><span class="lineNum">    2470 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2471"><span class="lineNum">    2471 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2472"><span class="lineNum">    2472 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="2473"><span class="lineNum">    2473 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2474"><span class="lineNum">    2474 </span>                :            :   //CircularStringZM</a>
<a name="2475"><span class="lineNum">    2475 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2476"><span class="lineNum">    2476 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="2477"><span class="lineNum">    2477 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2478"><span class="lineNum">    2478 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="2479"><span class="lineNum">    2479 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="2480"><span class="lineNum">    2480 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="2481"><span class="lineNum">    2481 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2482"><span class="lineNum">    2482 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2483"><span class="lineNum">    2483 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="2484"><span class="lineNum">    2484 </span>                :            : </a>
<a name="2485"><span class="lineNum">    2485 </span>                :            :   //vertexAt and pointAt</a>
<a name="2486"><span class="lineNum">    2486 </span>                :<span class="lineCov">          1 :   QgsCircularString l33;</span></a>
<a name="2487"><span class="lineNum">    2487 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, -10 ) ); //out of bounds, check for no crash</span></a>
<a name="2488"><span class="lineNum">    2488 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="2489"><span class="lineNum">    2489 </span>                :            :   QgsVertexId::VertexType type;</a>
<a name="2490"><span class="lineNum">    2490 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( -10, p, type ) );</span></a>
<a name="2491"><span class="lineNum">    2491 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( 10, p, type ) );</span></a>
<a name="2492"><span class="lineNum">    2492 </span>                :            :   //CircularString</a>
<a name="2493"><span class="lineNum">    2493 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="2494"><span class="lineNum">    2494 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, -10 ) );</span></a>
<a name="2495"><span class="lineNum">    2495 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="2496"><span class="lineNum">    2496 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="2497"><span class="lineNum">    2497 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="2498"><span class="lineNum">    2498 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 1, 22 ) );</span></a>
<a name="2499"><span class="lineNum">    2499 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( -10, p, type ) );</span></a>
<a name="2500"><span class="lineNum">    2500 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( 10, p, type ) );</span></a>
<a name="2501"><span class="lineNum">    2501 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="2502"><span class="lineNum">    2502 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="2503"><span class="lineNum">    2503 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2504"><span class="lineNum">    2504 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="2505"><span class="lineNum">    2505 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="2506"><span class="lineNum">    2506 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="2507"><span class="lineNum">    2507 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 2, p, type ) );</span></a>
<a name="2508"><span class="lineNum">    2508 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 22 ) );</span></a>
<a name="2509"><span class="lineNum">    2509 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2510"><span class="lineNum">    2510 </span>                :            :   //CircularStringZ</a>
<a name="2511"><span class="lineNum">    2511 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 22, 23 ) );</span></a>
<a name="2512"><span class="lineNum">    2512 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="2513"><span class="lineNum">    2513 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="2514"><span class="lineNum">    2514 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 22, 23 ) );</span></a>
<a name="2515"><span class="lineNum">    2515 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="2516"><span class="lineNum">    2516 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="2517"><span class="lineNum">    2517 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2518"><span class="lineNum">    2518 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="2519"><span class="lineNum">    2519 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="2520"><span class="lineNum">    2520 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="2521"><span class="lineNum">    2521 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 2, p, type ) );</span></a>
<a name="2522"><span class="lineNum">    2522 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 22, 23 ) );</span></a>
<a name="2523"><span class="lineNum">    2523 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2524"><span class="lineNum">    2524 </span>                :            :   //CircularStringM</a>
<a name="2525"><span class="lineNum">    2525 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="2526"><span class="lineNum">    2526 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="2527"><span class="lineNum">    2527 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="2528"><span class="lineNum">    2528 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="2529"><span class="lineNum">    2529 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="2530"><span class="lineNum">    2530 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="2531"><span class="lineNum">    2531 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2532"><span class="lineNum">    2532 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="2533"><span class="lineNum">    2533 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="2534"><span class="lineNum">    2534 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="2535"><span class="lineNum">    2535 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 2, p, type ) );</span></a>
<a name="2536"><span class="lineNum">    2536 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="2537"><span class="lineNum">    2537 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2538"><span class="lineNum">    2538 </span>                :            :   //CircularStringZM</a>
<a name="2539"><span class="lineNum">    2539 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="2540"><span class="lineNum">    2540 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="2541"><span class="lineNum">    2541 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2542"><span class="lineNum">    2542 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="2543"><span class="lineNum">    2543 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="2544"><span class="lineNum">    2544 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="2545"><span class="lineNum">    2545 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2546"><span class="lineNum">    2546 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="2547"><span class="lineNum">    2547 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="2548"><span class="lineNum">    2548 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="2549"><span class="lineNum">    2549 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 2, p, type ) );</span></a>
<a name="2550"><span class="lineNum">    2550 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="2551"><span class="lineNum">    2551 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="2552"><span class="lineNum">    2552 </span>                :            : </a>
<a name="2553"><span class="lineNum">    2553 </span>                :            :   //centroid</a>
<a name="2554"><span class="lineNum">    2554 </span>                :<span class="lineCov">          1 :   QgsCircularString l34;</span></a>
<a name="2555"><span class="lineNum">    2555 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 0, 0 ) );</span></a>
<a name="2556"><span class="lineNum">    2556 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="2557"><span class="lineNum">    2557 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 5, 10 ) );</span></a>
<a name="2558"><span class="lineNum">    2558 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 20, 10 ) &lt;&lt; QgsPoint( 2, 9 ) );</span></a>
<a name="2559"><span class="lineNum">    2559 </span>                :<span class="lineCov">          1 :   QgsPoint centroid = l34.centroid();</span></a>
<a name="2560"><span class="lineNum">    2560 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.x(), 7.333, 0.001 );</span></a>
<a name="2561"><span class="lineNum">    2561 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.y(), 6.333, 0.001 );</span></a>
<a name="2562"><span class="lineNum">    2562 </span>                :            : </a>
<a name="2563"><span class="lineNum">    2563 </span>                :            :   //closest segment</a>
<a name="2564"><span class="lineNum">    2564 </span>                :<span class="lineCov">          1 :   QgsCircularString l35;</span></a>
<a name="2565"><span class="lineNum">    2565 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="2566"><span class="lineNum">    2566 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 0, 0 ); // reset all coords to zero</span></a>
<a name="2567"><span class="lineNum">    2567 </span>                :<span class="lineCov">          1 :   ( void )l35.closestSegment( QgsPoint( 1, 2 ), p, v ); //empty line, just want no crash</span></a>
<a name="2568"><span class="lineNum">    2568 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="2569"><span class="lineNum">    2569 </span>                :<span class="lineCov">          1 :   QVERIFY( l35.closestSegment( QgsPoint( 5, 10 ), p, v ) &lt; 0 );</span></a>
<a name="2570"><span class="lineNum">    2570 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 15 ) );</span></a>
<a name="2571"><span class="lineNum">    2571 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 4, 11 ), p, v, &amp;leftOf ), 2.0, 0.0001 );</span></a>
<a name="2572"><span class="lineNum">    2572 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 10 ) );</span></a>
<a name="2573"><span class="lineNum">    2573 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2574"><span class="lineNum">    2574 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="2575"><span class="lineNum">    2575 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 8, 11 ), p, v, &amp;leftOf ),  1.583512, 0.0001 );</span></a>
<a name="2576"><span class="lineNum">    2576 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.84, 0.01 );</span></a>
<a name="2577"><span class="lineNum">    2577 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 11.49, 0.01 );</span></a>
<a name="2578"><span class="lineNum">    2578 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2579"><span class="lineNum">    2579 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="2580"><span class="lineNum">    2580 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 5.5, 11.5 ), p, v, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="2581"><span class="lineNum">    2581 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="2582"><span class="lineNum">    2582 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 10.7, 0.01 );</span></a>
<a name="2583"><span class="lineNum">    2583 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2584"><span class="lineNum">    2584 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="2585"><span class="lineNum">    2585 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 7, 16 ), p, v, &amp;leftOf ), 3.068288, 0.0001 );</span></a>
<a name="2586"><span class="lineNum">    2586 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.981872, 0.01 );</span></a>
<a name="2587"><span class="lineNum">    2587 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.574621, 0.01 );</span></a>
<a name="2588"><span class="lineNum">    2588 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2589"><span class="lineNum">    2589 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="2590"><span class="lineNum">    2590 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 5.5, 13.5 ), p, v, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="2591"><span class="lineNum">    2591 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="2592"><span class="lineNum">    2592 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.3, 0.01 );</span></a>
<a name="2593"><span class="lineNum">    2593 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2594"><span class="lineNum">    2594 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="2595"><span class="lineNum">    2595 </span>                :            :   // point directly on segment</a>
<a name="2596"><span class="lineNum">    2596 </span>                :<span class="lineCov">          1 :   QCOMPARE( l35.closestSegment( QgsPoint( 5, 15 ), p, v, &amp;leftOf ), 0.0 );</span></a>
<a name="2597"><span class="lineNum">    2597 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 15 ) );</span></a>
<a name="2598"><span class="lineNum">    2598 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2599"><span class="lineNum">    2599 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="2600"><span class="lineNum">    2600 </span>                :            : </a>
<a name="2601"><span class="lineNum">    2601 </span>                :            :   //clockwise string</a>
<a name="2602"><span class="lineNum">    2602 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="2603"><span class="lineNum">    2603 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 4, 11 ), p, v, &amp;leftOf ), 2, 0.0001 );</span></a>
<a name="2604"><span class="lineNum">    2604 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5, 0.01 );</span></a>
<a name="2605"><span class="lineNum">    2605 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 10, 0.01 );</span></a>
<a name="2606"><span class="lineNum">    2606 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2607"><span class="lineNum">    2607 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="2608"><span class="lineNum">    2608 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 8, 11 ), p, v, &amp;leftOf ),  1.583512, 0.0001 );</span></a>
<a name="2609"><span class="lineNum">    2609 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.84, 0.01 );</span></a>
<a name="2610"><span class="lineNum">    2610 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 11.49, 0.01 );</span></a>
<a name="2611"><span class="lineNum">    2611 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2612"><span class="lineNum">    2612 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="2613"><span class="lineNum">    2613 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 5.5, 11.5 ), p, v, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="2614"><span class="lineNum">    2614 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="2615"><span class="lineNum">    2615 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 10.7, 0.01 );</span></a>
<a name="2616"><span class="lineNum">    2616 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2617"><span class="lineNum">    2617 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="2618"><span class="lineNum">    2618 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 7, 16 ), p, v, &amp;leftOf ), 3.068288, 0.0001 );</span></a>
<a name="2619"><span class="lineNum">    2619 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.981872, 0.01 );</span></a>
<a name="2620"><span class="lineNum">    2620 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.574621, 0.01 );</span></a>
<a name="2621"><span class="lineNum">    2621 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2622"><span class="lineNum">    2622 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="2623"><span class="lineNum">    2623 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 5.5, 13.5 ), p, v, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="2624"><span class="lineNum">    2624 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="2625"><span class="lineNum">    2625 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.3, 0.01 );</span></a>
<a name="2626"><span class="lineNum">    2626 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2627"><span class="lineNum">    2627 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="2628"><span class="lineNum">    2628 </span>                :            :   // point directly on segment</a>
<a name="2629"><span class="lineNum">    2629 </span>                :<span class="lineCov">          1 :   QCOMPARE( l35.closestSegment( QgsPoint( 5, 15 ), p, v, &amp;leftOf ), 0.0 );</span></a>
<a name="2630"><span class="lineNum">    2630 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 15 ) );</span></a>
<a name="2631"><span class="lineNum">    2631 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2632"><span class="lineNum">    2632 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="2633"><span class="lineNum">    2633 </span>                :            : </a>
<a name="2634"><span class="lineNum">    2634 </span>                :            :   //sumUpArea</a>
<a name="2635"><span class="lineNum">    2635 </span>                :<span class="lineCov">          1 :   QgsCircularString l36;</span></a>
<a name="2636"><span class="lineNum">    2636 </span>                :<span class="lineCov">          1 :   double area = 1.0; //sumUpArea adds to area, so start with non-zero value</span></a>
<a name="2637"><span class="lineNum">    2637 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2638"><span class="lineNum">    2638 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="2639"><span class="lineNum">    2639 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="2640"><span class="lineNum">    2640 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2641"><span class="lineNum">    2641 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="2642"><span class="lineNum">    2642 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="2643"><span class="lineNum">    2643 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2644"><span class="lineNum">    2644 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="2645"><span class="lineNum">    2645 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) );</span></a>
<a name="2646"><span class="lineNum">    2646 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2647"><span class="lineNum">    2647 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 4.141593, 0.0001 );</span></a>
<a name="2648"><span class="lineNum">    2648 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="2649"><span class="lineNum">    2649 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2650"><span class="lineNum">    2650 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 7.283185, 0.0001 );</span></a>
<a name="2651"><span class="lineNum">    2651 </span>                :            :   // full circle</a>
<a name="2652"><span class="lineNum">    2652 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 4, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2653"><span class="lineNum">    2653 </span>                :<span class="lineCov">          1 :   area = 0.0;</span></a>
<a name="2654"><span class="lineNum">    2654 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="2655"><span class="lineNum">    2655 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 12.566370614359172, 0.0001 );</span></a>
<a name="2656"><span class="lineNum">    2656 </span>                :            : </a>
<a name="2657"><span class="lineNum">    2657 </span>                :            :   //boundingBox - test that bounding box is updated after every modification to the circular string</a>
<a name="2658"><span class="lineNum">    2658 </span>                :<span class="lineCov">          1 :   QgsCircularString l37;</span></a>
<a name="2659"><span class="lineNum">    2659 </span>                :<span class="lineCov">          1 :   QVERIFY( l37.boundingBox().isNull() );</span></a>
<a name="2660"><span class="lineNum">    2660 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="2661"><span class="lineNum">    2661 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 5, 10, 10, 15 ) );</span></a>
<a name="2662"><span class="lineNum">    2662 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( -5, -10 ) &lt;&lt; QgsPoint( -6, -10 ) &lt;&lt; QgsPoint( -5.5, -9 ) );</span></a>
<a name="2663"><span class="lineNum">    2663 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6.125, -10.25, -5, -9 ) );</span></a>
<a name="2664"><span class="lineNum">    2664 </span>                :<span class="lineCov">          1 :   QByteArray wkbToAppend = l37.asWkb();</span></a>
<a name="2665"><span class="lineNum">    2665 </span>                :<span class="lineCov">          1 :   l37.clear();</span></a>
<a name="2666"><span class="lineNum">    2666 </span>                :<span class="lineCov">          1 :   QVERIFY( l37.boundingBox().isNull() );</span></a>
<a name="2667"><span class="lineNum">    2667 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbToAppendPtr( wkbToAppend );</span></a>
<a name="2668"><span class="lineNum">    2668 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="2669"><span class="lineNum">    2669 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 5, 10, 10, 15 ) );</span></a>
<a name="2670"><span class="lineNum">    2670 </span>                :<span class="lineCov">          1 :   l37.fromWkb( wkbToAppendPtr );</span></a>
<a name="2671"><span class="lineNum">    2671 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6.125, -10.25, -5, -9 ) );</span></a>
<a name="2672"><span class="lineNum">    2672 </span>                :<span class="lineCov">          2 :   l37.fromWkt( QStringLiteral( &quot;CircularString( 5 10, 6 10, 5.5 9 )&quot; ) );</span></a>
<a name="2673"><span class="lineNum">    2673 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 5, 9, 6.125, 10.25 ) );</span></a>
<a name="2674"><span class="lineNum">    2674 </span>                :<span class="lineCov">          1 :   l37.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -1, 7 ) );</span></a>
<a name="2675"><span class="lineNum">    2675 </span>                :<span class="lineCov">          1 :   QgsRectangle r = l37.boundingBox();</span></a>
<a name="2676"><span class="lineNum">    2676 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), -3.014, 0.01 );</span></a>
<a name="2677"><span class="lineNum">    2677 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 14.014, 0.01 );</span></a>
<a name="2678"><span class="lineNum">    2678 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), -7.0146, 0.01 );</span></a>
<a name="2679"><span class="lineNum">    2679 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 12.4988, 0.01 );</span></a>
<a name="2680"><span class="lineNum">    2680 </span>                :<span class="lineCov">          1 :   l37.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -3, 10 ) );</span></a>
<a name="2681"><span class="lineNum">    2681 </span>                :<span class="lineCov">          1 :   r = l37.boundingBox();</span></a>
<a name="2682"><span class="lineNum">    2682 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), -10.294, 0.01 );</span></a>
<a name="2683"><span class="lineNum">    2683 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 12.294, 0.01 );</span></a>
<a name="2684"><span class="lineNum">    2684 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), 9, 0.01 );</span></a>
<a name="2685"><span class="lineNum">    2685 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 31.856, 0.01 );</span></a>
<a name="2686"><span class="lineNum">    2686 </span>                :<span class="lineCov">          1 :   l37.deleteVertex( QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="2687"><span class="lineNum">    2687 </span>                :<span class="lineCov">          1 :   r = l37.boundingBox();</span></a>
<a name="2688"><span class="lineNum">    2688 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), 5, 0.01 );</span></a>
<a name="2689"><span class="lineNum">    2689 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 6.125, 0.01 );</span></a>
<a name="2690"><span class="lineNum">    2690 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), 9, 0.01 );</span></a>
<a name="2691"><span class="lineNum">    2691 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 10.25, 0.01 );</span></a>
<a name="2692"><span class="lineNum">    2692 </span>                :            : </a>
<a name="2693"><span class="lineNum">    2693 </span>                :            :   //angle</a>
<a name="2694"><span class="lineNum">    2694 </span>                :<span class="lineCov">          1 :   QgsCircularString l38;</span></a>
<a name="2695"><span class="lineNum">    2695 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="2696"><span class="lineNum">    2696 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="2697"><span class="lineNum">    2697 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2698"><span class="lineNum">    2698 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="2699"><span class="lineNum">    2699 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) );</span></a>
<a name="2700"><span class="lineNum">    2700 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="2701"><span class="lineNum">    2701 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="2702"><span class="lineNum">    2702 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="2703"><span class="lineNum">    2703 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="2704"><span class="lineNum">    2704 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0, 0.0001 );</span></a>
<a name="2705"><span class="lineNum">    2705 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="2706"><span class="lineNum">    2706 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2707"><span class="lineNum">    2707 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="2708"><span class="lineNum">    2708 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141593, 0.0001 );</span></a>
<a name="2709"><span class="lineNum">    2709 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="2710"><span class="lineNum">    2710 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 20 ) ); // no crash</span></a>
<a name="2711"><span class="lineNum">    2711 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 )</span></a>
<a name="2712"><span class="lineNum">    2712 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( -1, 3 ) &lt;&lt; QgsPoint( 0, 4 ) );</span></a>
<a name="2713"><span class="lineNum">    2713 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="2714"><span class="lineNum">    2714 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0, 0.0001 );</span></a>
<a name="2715"><span class="lineNum">    2715 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="2716"><span class="lineNum">    2716 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0, 0.0001 );</span></a>
<a name="2717"><span class="lineNum">    2717 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 1.5708, 0.0001 );</span></a>
<a name="2718"><span class="lineNum">    2718 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 4 ) &lt;&lt; QgsPoint( -1, 3 ) &lt;&lt; QgsPoint( 0, 2 )</span></a>
<a name="2719"><span class="lineNum">    2719 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2720"><span class="lineNum">    2720 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 4.712389, 0.0001 );</span></a>
<a name="2721"><span class="lineNum">    2721 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141592, 0.0001 );</span></a>
<a name="2722"><span class="lineNum">    2722 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.5708, 0.0001 );</span></a>
<a name="2723"><span class="lineNum">    2723 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 3.141592, 0.0001 );</span></a>
<a name="2724"><span class="lineNum">    2724 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 4.712389, 0.0001 );</span></a>
<a name="2725"><span class="lineNum">    2725 </span>                :            : </a>
<a name="2726"><span class="lineNum">    2726 </span>                :            :   //closed circular string</a>
<a name="2727"><span class="lineNum">    2727 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2728"><span class="lineNum">    2728 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 0, 0.00001 );</span></a>
<a name="2729"><span class="lineNum">    2729 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141592, 0.00001 );</span></a>
<a name="2730"><span class="lineNum">    2730 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 0, 0.00001 );</span></a>
<a name="2731"><span class="lineNum">    2731 </span>                :            : </a>
<a name="2732"><span class="lineNum">    2732 </span>                :            :   //removing a vertex from a 3 point circular string should remove the whole line</a>
<a name="2733"><span class="lineNum">    2733 </span>                :<span class="lineCov">          1 :   QgsCircularString l39;</span></a>
<a name="2734"><span class="lineNum">    2734 </span>                :<span class="lineCov">          1 :   l39.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="2735"><span class="lineNum">    2735 </span>                :<span class="lineCov">          1 :   QCOMPARE( l39.numPoints(), 3 );</span></a>
<a name="2736"><span class="lineNum">    2736 </span>                :<span class="lineCov">          1 :   l39.deleteVertex( QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="2737"><span class="lineNum">    2737 </span>                :<span class="lineCov">          1 :   QCOMPARE( l39.numPoints(), 0 );</span></a>
<a name="2738"><span class="lineNum">    2738 </span>                :            : </a>
<a name="2739"><span class="lineNum">    2739 </span>                :            :   //boundary</a>
<a name="2740"><span class="lineNum">    2740 </span>                :<span class="lineCov">          1 :   QgsCircularString boundary1;</span></a>
<a name="2741"><span class="lineNum">    2741 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundary1.boundary() );</span></a>
<a name="2742"><span class="lineNum">    2742 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="2743"><span class="lineNum">    2743 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = boundary1.boundary();</span></a>
<a name="2744"><span class="lineNum">    2744 </span>                :<span class="lineCov">          1 :   QgsMultiPoint *mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="2745"><span class="lineNum">    2745 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="2746"><span class="lineNum">    2746 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;x(), 0.0 );</span></a>
<a name="2747"><span class="lineNum">    2747 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;y(), 0.0 );</span></a>
<a name="2748"><span class="lineNum">    2748 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 1 )-&gt;x(), 1.0 );</span></a>
<a name="2749"><span class="lineNum">    2749 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 1 )-&gt;y(), 1.0 );</span></a>
<a name="2750"><span class="lineNum">    2750 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="2751"><span class="lineNum">    2751 </span>                :            : </a>
<a name="2752"><span class="lineNum">    2752 </span>                :            :   // closed string = no boundary</a>
<a name="2753"><span class="lineNum">    2753 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="2754"><span class="lineNum">    2754 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundary1.boundary() );</span></a>
<a name="2755"><span class="lineNum">    2755 </span>                :            : </a>
<a name="2756"><span class="lineNum">    2756 </span>                :            :   //boundary with z</a>
<a name="2757"><span class="lineNum">    2757 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="2758"><span class="lineNum">    2758 </span>                :<span class="lineCov">          1 :   boundary = boundary1.boundary();</span></a>
<a name="2759"><span class="lineNum">    2759 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="2760"><span class="lineNum">    2760 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="2761"><span class="lineNum">    2761 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="2762"><span class="lineNum">    2762 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;x(), 0.0 );</span></a>
<a name="2763"><span class="lineNum">    2763 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;y(), 0.0 );</span></a>
<a name="2764"><span class="lineNum">    2764 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 0 )-&gt;z(), 10.0 );</span></a>
<a name="2765"><span class="lineNum">    2765 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;pointN( 1 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="2766"><span class="lineNum">    2766 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="2767"><span class="lineNum">    2767 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="2768"><span class="lineNum">    2768 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;z(), 20.0 );</span></a>
<a name="2769"><span class="lineNum">    2769 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="2770"><span class="lineNum">    2770 </span>                :            : </a>
<a name="2771"><span class="lineNum">    2771 </span>                :            :   // addToPainterPath (note most tests are in test_qgsgeometry.py)</a>
<a name="2772"><span class="lineNum">    2772 </span>                :<span class="lineCov">          1 :   QgsCircularString path;</span></a>
<a name="2773"><span class="lineNum">    2773 </span>                :<span class="lineCov">          1 :   QPainterPath pPath;</span></a>
<a name="2774"><span class="lineNum">    2774 </span>                :<span class="lineCov">          1 :   path.addToPainterPath( pPath );</span></a>
<a name="2775"><span class="lineNum">    2775 </span>                :<span class="lineCov">          1 :   QVERIFY( pPath.isEmpty() );</span></a>
<a name="2776"><span class="lineNum">    2776 </span>                :<span class="lineCov">          2 :   path.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 )</span></a>
<a name="2777"><span class="lineNum">    2777 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 21, 2, 3 ) );</span></a>
<a name="2778"><span class="lineNum">    2778 </span>                :<span class="lineCov">          1 :   path.addToPainterPath( pPath );</span></a>
<a name="2779"><span class="lineNum">    2779 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().x(), 21.0, 0.01 );</span></a>
<a name="2780"><span class="lineNum">    2780 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().y(), 2.0, 0.01 );</span></a>
<a name="2781"><span class="lineNum">    2781 </span>                :<span class="lineCov">          1 :   QVERIFY( !pPath.isEmpty() );</span></a>
<a name="2782"><span class="lineNum">    2782 </span>                :            : </a>
<a name="2783"><span class="lineNum">    2783 </span>                :            :   // even number of points - should still work</a>
<a name="2784"><span class="lineNum">    2784 </span>                :<span class="lineCov">          1 :   pPath = QPainterPath();</span></a>
<a name="2785"><span class="lineNum">    2785 </span>                :<span class="lineCov">          1 :   path.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="2786"><span class="lineNum">    2786 </span>                :<span class="lineCov">          1 :   path.addToPainterPath( pPath );</span></a>
<a name="2787"><span class="lineNum">    2787 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().x(), 11.0, 0.01 );</span></a>
<a name="2788"><span class="lineNum">    2788 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().y(), 12.0, 0.01 );</span></a>
<a name="2789"><span class="lineNum">    2789 </span>                :<span class="lineCov">          1 :   QVERIFY( !pPath.isEmpty() );</span></a>
<a name="2790"><span class="lineNum">    2790 </span>                :            : </a>
<a name="2791"><span class="lineNum">    2791 </span>                :            :   // toCurveType</a>
<a name="2792"><span class="lineNum">    2792 </span>                :<span class="lineCov">          1 :   QgsCircularString curveLine1;</span></a>
<a name="2793"><span class="lineNum">    2793 </span>                :<span class="lineCov">          1 :   curveLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="2794"><span class="lineNum">    2794 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurve &gt; curveType( curveLine1.toCurveType() );</span></a>
<a name="2795"><span class="lineNum">    2795 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="2796"><span class="lineNum">    2796 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numPoints(), 3 );</span></a>
<a name="2797"><span class="lineNum">    2797 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="2798"><span class="lineNum">    2798 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="2799"><span class="lineNum">    2799 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 1, 22 ) );</span></a>
<a name="2800"><span class="lineNum">    2800 </span>                :            : </a>
<a name="2801"><span class="lineNum">    2801 </span>                :            :   //segmentLength</a>
<a name="2802"><span class="lineNum">    2802 </span>                :<span class="lineCov">          1 :   QgsCircularString curveLine2;</span></a>
<a name="2803"><span class="lineNum">    2803 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="2804"><span class="lineNum">    2804 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="2805"><span class="lineNum">    2805 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 1, 0, 0 ) ), 0.0 );</span></a>
<a name="2806"><span class="lineNum">    2806 </span>                :<span class="lineCov">          1 :   curveLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="2807"><span class="lineNum">    2807 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="2808"><span class="lineNum">    2808 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="2809"><span class="lineNum">    2809 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( curveLine2.segmentLength( QgsVertexId( 0, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="2810"><span class="lineNum">    2810 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, 1 ) ), 0.0 );</span></a>
<a name="2811"><span class="lineNum">    2811 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, 2 ) ), 0.0 );</span></a>
<a name="2812"><span class="lineNum">    2812 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="2813"><span class="lineNum">    2813 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( curveLine2.segmentLength( QgsVertexId( -1, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="2814"><span class="lineNum">    2814 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 1, 0, 1 ) ), 0.0 );</span></a>
<a name="2815"><span class="lineNum">    2815 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( curveLine2.segmentLength( QgsVertexId( 1, 1, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="2816"><span class="lineNum">    2816 </span>                :<span class="lineCov">          1 :   curveLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( -9, 32 ) &lt;&lt; QgsPoint( 1, 42 ) );</span></a>
<a name="2817"><span class="lineNum">    2817 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="2818"><span class="lineNum">    2818 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="2819"><span class="lineNum">    2819 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( curveLine2.segmentLength( QgsVertexId( 0, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="2820"><span class="lineNum">    2820 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, 1 ) ), 0.0 );</span></a>
<a name="2821"><span class="lineNum">    2821 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( curveLine2.segmentLength( QgsVertexId( 0, 0, 2 ) ), 31.4159, 0.001 );</span></a>
<a name="2822"><span class="lineNum">    2822 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveLine2.segmentLength( QgsVertexId( 0, 0, 3 ) ), 0.0 );</span></a>
<a name="2823"><span class="lineNum">    2823 </span>                :            : </a>
<a name="2824"><span class="lineNum">    2824 </span>                :            :   //removeDuplicateNodes</a>
<a name="2825"><span class="lineNum">    2825 </span>                :<span class="lineCov">          1 :   QgsCircularString nodeLine;</span></a>
<a name="2826"><span class="lineNum">    2826 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="2827"><span class="lineNum">    2827 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="2828"><span class="lineNum">    2828 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="2829"><span class="lineNum">    2829 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt(), QStringLiteral( &quot;CircularString (11 2, 11 12, 111 12)&quot; ) );</span></a>
<a name="2830"><span class="lineNum">    2830 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="2831"><span class="lineNum">    2831 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="2832"><span class="lineNum">    2832 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt(), QStringLiteral( &quot;CircularString (11 2, 11 12, 11 2)&quot; ) );</span></a>
<a name="2833"><span class="lineNum">    2833 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 10, 3 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 9, 3 )</span></a>
<a name="2834"><span class="lineNum">    2834 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="2835"><span class="lineNum">    2835 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2836"><span class="lineNum">    2836 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2, 10 3, 11.01 1.99, 9 3, 11 2)&quot; ) );</span></a>
<a name="2837"><span class="lineNum">    2837 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="2838"><span class="lineNum">    2838 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) );</span></a>
<a name="2839"><span class="lineNum">    2839 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="2840"><span class="lineNum">    2840 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2, 11.01 1.99, 11.02 2.01, 11 12, 111 12, 111.01 11.99)&quot; ) );</span></a>
<a name="2841"><span class="lineNum">    2841 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2842"><span class="lineNum">    2842 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2843"><span class="lineNum">    2843 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2, 11 12, 111 12, 111.01 11.99)&quot; ) );</span></a>
<a name="2844"><span class="lineNum">    2844 </span>                :            : </a>
<a name="2845"><span class="lineNum">    2845 </span>                :            :   // don't create degenerate lines</a>
<a name="2846"><span class="lineNum">    2846 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="2847"><span class="lineNum">    2847 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2848"><span class="lineNum">    2848 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2)&quot; ) );</span></a>
<a name="2849"><span class="lineNum">    2849 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) );</span></a>
<a name="2850"><span class="lineNum">    2850 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2851"><span class="lineNum">    2851 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2, 11.01 1.99)&quot; ) );</span></a>
<a name="2852"><span class="lineNum">    2852 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="2853"><span class="lineNum">    2853 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2854"><span class="lineNum">    2854 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularString (11 2, 11.01 1.99, 11 2)&quot; ) );</span></a>
<a name="2855"><span class="lineNum">    2855 </span>                :            : </a>
<a name="2856"><span class="lineNum">    2856 </span>                :            :   // with z</a>
<a name="2857"><span class="lineNum">    2857 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 1 ) &lt;&lt; QgsPoint( 11.01, 1.99, 2 ) &lt;&lt; QgsPoint( 11.02, 2.01, 3 )</span></a>
<a name="2858"><span class="lineNum">    2858 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12, 4 ) &lt;&lt; QgsPoint( 111, 12, 5 ) );</span></a>
<a name="2859"><span class="lineNum">    2859 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="2860"><span class="lineNum">    2860 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularStringZ (11 2 1, 11 12 4, 111 12 5)&quot; ) );</span></a>
<a name="2861"><span class="lineNum">    2861 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 1 ) &lt;&lt; QgsPoint( 11.01, 1.99, 2 ) &lt;&lt; QgsPoint( 11.02, 2.01, 3 )</span></a>
<a name="2862"><span class="lineNum">    2862 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12, 4 ) &lt;&lt; QgsPoint( 111, 12, 5 ) );</span></a>
<a name="2863"><span class="lineNum">    2863 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02, true ) );</span></a>
<a name="2864"><span class="lineNum">    2864 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;CircularStringZ (11 2 1, 11.01 1.99 2, 11.02 2.01 3, 11 12 4, 111 12 5)&quot; ) );</span></a>
<a name="2865"><span class="lineNum">    2865 </span>                :            : </a>
<a name="2866"><span class="lineNum">    2866 </span>                :            :   //swap xy</a>
<a name="2867"><span class="lineNum">    2867 </span>                :<span class="lineCov">          1 :   QgsCircularString swapLine;</span></a>
<a name="2868"><span class="lineNum">    2868 </span>                :<span class="lineCov">          1 :   swapLine.swapXy(); // no crash</span></a>
<a name="2869"><span class="lineNum">    2869 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="2870"><span class="lineNum">    2870 </span>                :<span class="lineCov">          1 :   swapLine.swapXy();</span></a>
<a name="2871"><span class="lineNum">    2871 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapLine.asWkt(), QStringLiteral( &quot;CircularStringZM (2 11 3 4, 12 11 13 14, 12 111 23 24)&quot; ) );</span></a>
<a name="2872"><span class="lineNum">    2872 </span>                :            : </a>
<a name="2873"><span class="lineNum">    2873 </span>                :            :   // filter vertex</a>
<a name="2874"><span class="lineNum">    2874 </span>                :<span class="lineCov">          1 :   QgsCircularString filterLine;</span></a>
<a name="2875"><span class="lineNum">    2875 </span>                :<span class="lineCov">          3 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="2876"><span class="lineNum">    2876 </span>                :            :   {</a>
<a name="2877"><span class="lineNum">    2877 </span>                :<span class="lineCov">          3 :     return point.x() &lt; 5;</span></a>
<a name="2878"><span class="lineNum">    2878 </span>                :            :   };</a>
<a name="2879"><span class="lineNum">    2879 </span>                :<span class="lineCov">          1 :   filterLine.filterVertices( filter ); // no crash</span></a>
<a name="2880"><span class="lineNum">    2880 </span>                :<span class="lineCov">          1 :   filterLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="2881"><span class="lineNum">    2881 </span>                :<span class="lineCov">          1 :   filterLine.filterVertices( filter );</span></a>
<a name="2882"><span class="lineNum">    2882 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterLine.asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (1 2 3 4, 4 12 13 14)&quot; ) );</span></a>
<a name="2883"><span class="lineNum">    2883 </span>                :            : </a>
<a name="2884"><span class="lineNum">    2884 </span>                :            :   // transform vertex</a>
<a name="2885"><span class="lineNum">    2885 </span>                :<span class="lineCov">          1 :   QgsCircularString transformLine;</span></a>
<a name="2886"><span class="lineNum">    2886 </span>                :<span class="lineCov">          3 :   auto transform = []( const QgsPoint &amp; point )-&gt; QgsPoint</span></a>
<a name="2887"><span class="lineNum">    2887 </span>                :            :   {</a>
<a name="2888"><span class="lineNum">    2888 </span>                :<span class="lineCov">          3 :     return QgsPoint( point.x() + 2, point.y() + 3, point.z() + 4, point.m() + 7 );</span></a>
<a name="2889"><span class="lineNum">    2889 </span>                :            :   };</a>
<a name="2890"><span class="lineNum">    2890 </span>                :<span class="lineCov">          1 :   transformLine.transformVertices( transform ); // no crash</span></a>
<a name="2891"><span class="lineNum">    2891 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="2892"><span class="lineNum">    2892 </span>                :<span class="lineCov">          1 :   transformLine.transformVertices( transform );</span></a>
<a name="2893"><span class="lineNum">    2893 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformLine.asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (3 5 7 11, 6 15 17 21, 113 15 27 31)&quot; ) );</span></a>
<a name="2894"><span class="lineNum">    2894 </span>                :            : </a>
<a name="2895"><span class="lineNum">    2895 </span>                :            :   // transform using class</a>
<a name="2896"><span class="lineNum">    2896 </span>                :<span class="lineCov">          1 :   QgsCircularString transformLine2;</span></a>
<a name="2897"><span class="lineNum">    2897 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="2898"><span class="lineNum">    2898 </span>                :            :   // no crash</a>
<a name="2899"><span class="lineNum">    2899 </span>                :<span class="lineCov">          1 :   QVERIFY( transformLine2.transform( &amp;transformer ) );</span></a>
<a name="2900"><span class="lineNum">    2900 </span>                :<span class="lineCov">          1 :   transformLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="2901"><span class="lineNum">    2901 </span>                :<span class="lineCov">          1 :   QVERIFY( transformLine2.transform( &amp;transformer ) );</span></a>
<a name="2902"><span class="lineNum">    2902 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformLine2.asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (3 16 8 3, 12 26 18 13, 333 26 28 23)&quot; ) );</span></a>
<a name="2903"><span class="lineNum">    2903 </span>                :            : </a>
<a name="2904"><span class="lineNum">    2904 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="2905"><span class="lineNum">    2905 </span>                :<span class="lineCov">          1 :   QVERIFY( !transformLine2.transform( &amp;failTransformer ) );</span></a>
<a name="2906"><span class="lineNum">    2906 </span>                :            : </a>
<a name="2907"><span class="lineNum">    2907 </span>                :            :   // substring</a>
<a name="2908"><span class="lineNum">    2908 </span>                :<span class="lineCov">          1 :   QgsCircularString substring;</span></a>
<a name="2909"><span class="lineNum">    2909 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCircularString &gt; substringResult( substring.curveSubstring( 1, 2 ) ); // no crash</span></a>
<a name="2910"><span class="lineNum">    2910 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult.get() );</span></a>
<a name="2911"><span class="lineNum">    2911 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="2912"><span class="lineNum">    2912 </span>                :            :   // CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14)</a>
<a name="2913"><span class="lineNum">    2913 </span>                :<span class="lineCov">          1 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1, 2 ) &lt;&lt;  QgsPoint( 11, 1, 3, 4 ) &lt;&lt;  QgsPoint( 12, 0, 13, 14 ) );</span></a>
<a name="2914"><span class="lineNum">    2914 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 0, 0 ) );</span></a>
<a name="2915"><span class="lineNum">    2915 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10 0 1 2, 10 0 1 2, 10 0 1 2)&quot; ) );</span></a>
<a name="2916"><span class="lineNum">    2916 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, -0.1 ) );</span></a>
<a name="2917"><span class="lineNum">    2917 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="2918"><span class="lineNum">    2918 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 100000, 10000 ) );</span></a>
<a name="2919"><span class="lineNum">    2919 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="2920"><span class="lineNum">    2920 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 1 ) );</span></a>
<a name="2921"><span class="lineNum">    2921 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10 0 1 2, 10.12 0.48 1.64 2.64, 10.46 0.84 2.27 3.27)&quot; ) );</span></a>
<a name="2922"><span class="lineNum">    2922 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, -1 ) );</span></a>
<a name="2923"><span class="lineNum">    2923 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 10.46 0.84 2.27 3.27, 10.46 0.84 2.27 3.27)&quot; ) );</span></a>
<a name="2924"><span class="lineNum">    2924 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 10000 ) );</span></a>
<a name="2925"><span class="lineNum">    2925 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14)&quot; ) );</span></a>
<a name="2926"><span class="lineNum">    2926 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 10000 ) );</span></a>
<a name="2927"><span class="lineNum">    2927 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 11.48 0.88 6.18 7.18, 12 0 13 14)&quot; ) );</span></a>
<a name="2928"><span class="lineNum">    2928 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="2929"><span class="lineNum">    2929 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 11.48 0.88 6.18 7.18, 12 0 13 14)&quot; ) );</span></a>
<a name="2930"><span class="lineNum">    2930 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 1.5 ) );</span></a>
<a name="2931"><span class="lineNum">    2931 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 10.68 0.95 2.59 3.59, 10.93 1 2.91 3.91)&quot; ) );</span></a>
<a name="2932"><span class="lineNum">    2932 </span>                :            :   // CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14, 14 -1 13 14, 16 1 23 24 )</a>
<a name="2933"><span class="lineNum">    2933 </span>                :<span class="lineCov">          2 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1, 2 ) &lt;&lt;  QgsPoint( 11, 1, 3, 4 ) &lt;&lt;  QgsPoint( 12, 0, 13, 14 )</span></a>
<a name="2934"><span class="lineNum">    2934 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPoint( 14, -1, 13, 14 ) &lt;&lt;  QgsPoint( 16, 1, 23, 24 ) );</span></a>
<a name="2935"><span class="lineNum">    2935 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 1.5 ) );</span></a>
<a name="2936"><span class="lineNum">    2936 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 10.68 0.95 2.59 3.59, 10.93 1 2.91 3.91)&quot; ) );</span></a>
<a name="2937"><span class="lineNum">    2937 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 10 ) );</span></a>
<a name="2938"><span class="lineNum">    2938 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 11.48 0.88 6.18 7.18, 12 0 13 14, 14 -1 13 14, 16 1 23 24)&quot; ) );</span></a>
<a name="2939"><span class="lineNum">    2939 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 6 ) );</span></a>
<a name="2940"><span class="lineNum">    2940 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10.46 0.84 2.27 3.27, 11.48 0.88 6.18 7.18, 12 0 13 14, 13.1 -0.88 13 14, 14.5 -0.9 14.65 15.65)&quot; ) );</span></a>
<a name="2941"><span class="lineNum">    2941 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 0, 6 ) );</span></a>
<a name="2942"><span class="lineNum">    2942 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14, 13.1 -0.88 13 14, 14.5 -0.9 14.65 15.65)&quot; ) );</span></a>
<a name="2943"><span class="lineNum">    2943 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 5, 6 ) );</span></a>
<a name="2944"><span class="lineNum">    2944 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (13.51 -0.98 13 14, 14.01 -1 13.03 14.03, 14.5 -0.9 14.65 15.65)&quot; ) );</span></a>
<a name="2945"><span class="lineNum">    2945 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 5, 1000 ) );</span></a>
<a name="2946"><span class="lineNum">    2946 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (13.51 -0.98 13 14, 15.19 -0.53 17.2 18.2, 16 1 23 24)&quot; ) );</span></a>
<a name="2947"><span class="lineNum">    2947 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( QgsGeometryUtils::distanceToVertex( substring, QgsVertexId( 0, 0, 2 ) ), QgsGeometryUtils::distanceToVertex( substring, QgsVertexId( 0, 0, 4 ) ) ) );</span></a>
<a name="2948"><span class="lineNum">    2948 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZM (12 0 13 14, 14.36 -0.94 14.19 15.19, 16 1 23 24)&quot; ) );</span></a>
<a name="2949"><span class="lineNum">    2949 </span>                :            : </a>
<a name="2950"><span class="lineNum">    2950 </span>                :<span class="lineCov">          2 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1 ) &lt;&lt;  QgsPoint( 11, 1, 3 ) &lt;&lt;  QgsPoint( 12, 0, 13 )</span></a>
<a name="2951"><span class="lineNum">    2951 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPoint( 14, -1, 13 ) &lt;&lt;  QgsPoint( 16, 1, 23 ) );</span></a>
<a name="2952"><span class="lineNum">    2952 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="2953"><span class="lineNum">    2953 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringZ (10.46 0.84 2.27, 11.48 0.88 6.18, 12 0 13, 14 -1 13, 16 1 23)&quot; ) );</span></a>
<a name="2954"><span class="lineNum">    2954 </span>                :<span class="lineCov">          2 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 1 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 11, 1, 0, 3 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 12, 0, 0, 13 )</span></a>
<a name="2955"><span class="lineNum">    2955 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 14, -1, 0, 13 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 16, 1, 0, 23 ) );</span></a>
<a name="2956"><span class="lineNum">    2956 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="2957"><span class="lineNum">    2957 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularStringM (10.46 0.84 2.27, 11.48 0.88 6.18, 12 0 13, 14 -1 13, 16 1 23)&quot; ) );</span></a>
<a name="2958"><span class="lineNum">    2958 </span>                :<span class="lineCov">          2 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt;  QgsPoint( 11, 1 ) &lt;&lt;  QgsPoint( 12, 0 )</span></a>
<a name="2959"><span class="lineNum">    2959 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPoint( 14, -1 ) &lt;&lt;  QgsPoint( 16, 1 ) );</span></a>
<a name="2960"><span class="lineNum">    2960 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="2961"><span class="lineNum">    2961 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CircularString (10.46 0.84, 11.48 0.88, 12 0, 14 -1, 16 1)&quot; ) );</span></a>
<a name="2962"><span class="lineNum">    2962 </span>                :            : </a>
<a name="2963"><span class="lineNum">    2963 </span>                :            :   // interpolate</a>
<a name="2964"><span class="lineNum">    2964 </span>                :<span class="lineCov">          1 :   QgsCircularString interpolate;</span></a>
<a name="2965"><span class="lineNum">    2965 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPoint &gt; interpolateResult( interpolate.interpolatePoint( 1 ) ); // no crash</span></a>
<a name="2966"><span class="lineNum">    2966 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="2967"><span class="lineNum">    2967 </span>                :            :   // CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14)</a>
<a name="2968"><span class="lineNum">    2968 </span>                :<span class="lineCov">          1 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1, 2 ) &lt;&lt;  QgsPoint( 11, 1, 3, 4 ) &lt;&lt;  QgsPoint( 12, 0, 13, 14 ) );</span></a>
<a name="2969"><span class="lineNum">    2969 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 0 ) );</span></a>
<a name="2970"><span class="lineNum">    2970 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (10 0 1 2)&quot; ) );</span></a>
<a name="2971"><span class="lineNum">    2971 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( -1 ) );</span></a>
<a name="2972"><span class="lineNum">    2972 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="2973"><span class="lineNum">    2973 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 100000 ) );</span></a>
<a name="2974"><span class="lineNum">    2974 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="2975"><span class="lineNum">    2975 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="2976"><span class="lineNum">    2976 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (10.46 0.84 2.27 3.27)&quot; ) );</span></a>
<a name="2977"><span class="lineNum">    2977 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1.5 ) );</span></a>
<a name="2978"><span class="lineNum">    2978 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (10.93 1 2.91 3.91)&quot; ) );</span></a>
<a name="2979"><span class="lineNum">    2979 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( interpolate.length() ) );</span></a>
<a name="2980"><span class="lineNum">    2980 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (12 0 13 14)&quot; ) );</span></a>
<a name="2981"><span class="lineNum">    2981 </span>                :            :   // CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14, 14 -1 13 14, 16 1 23 24 )</a>
<a name="2982"><span class="lineNum">    2982 </span>                :<span class="lineCov">          2 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1, 2 ) &lt;&lt;  QgsPoint( 11, 1, 3, 4 ) &lt;&lt;  QgsPoint( 12, 0, 13, 14 )</span></a>
<a name="2983"><span class="lineNum">    2983 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPoint( 14, -1, 13, 14 ) &lt;&lt;  QgsPoint( 16, 1, 23, 24 ) );</span></a>
<a name="2984"><span class="lineNum">    2984 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="2985"><span class="lineNum">    2985 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (10.46 0.84 2.27 3.27)&quot; ) );</span></a>
<a name="2986"><span class="lineNum">    2986 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1.5 ) );</span></a>
<a name="2987"><span class="lineNum">    2987 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (10.93 1 2.91 3.91)&quot; ) );</span></a>
<a name="2988"><span class="lineNum">    2988 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 10 ) );</span></a>
<a name="2989"><span class="lineNum">    2989 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="2990"><span class="lineNum">    2990 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 6 ) );</span></a>
<a name="2991"><span class="lineNum">    2991 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (14.5 -0.9 14.65 15.65)&quot; ) );</span></a>
<a name="2992"><span class="lineNum">    2992 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 5 ) );</span></a>
<a name="2993"><span class="lineNum">    2993 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (13.51 -0.98 13 14)&quot; ) );</span></a>
<a name="2994"><span class="lineNum">    2994 </span>                :            : </a>
<a name="2995"><span class="lineNum">    2995 </span>                :<span class="lineCov">          2 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0, 1 ) &lt;&lt;  QgsPoint( 11, 1, 3 ) &lt;&lt;  QgsPoint( 12, 0, 13 )</span></a>
<a name="2996"><span class="lineNum">    2996 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPoint( 14, -1, 13 ) &lt;&lt;  QgsPoint( 16, 1, 23 ) );</span></a>
<a name="2997"><span class="lineNum">    2997 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="2998"><span class="lineNum">    2998 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZ (10.46 0.84 2.27)&quot; ) );</span></a>
<a name="2999"><span class="lineNum">    2999 </span>                :<span class="lineCov">          2 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 1 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 11, 1, 0, 3 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 12, 0, 0, 13 )</span></a>
<a name="3000"><span class="lineNum">    3000 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 14, -1, 0, 13 ) &lt;&lt;  QgsPoint( QgsWkbTypes::PointM, 16, 1, 0, 23 ) );</span></a>
<a name="3001"><span class="lineNum">    3001 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="3002"><span class="lineNum">    3002 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointM (10.46 0.84 2.27)&quot; ) );</span></a>
<a name="3003"><span class="lineNum">    3003 </span>                :<span class="lineCov">          2 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt;  QgsPoint( 11, 1 ) &lt;&lt;  QgsPoint( 12, 0 )</span></a>
<a name="3004"><span class="lineNum">    3004 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPoint( 14, -1 ) &lt;&lt;  QgsPoint( 16, 1 ) );</span></a>
<a name="3005"><span class="lineNum">    3005 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="3006"><span class="lineNum">    3006 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;Point (10.46 0.84)&quot; ) );</span></a>
<a name="3007"><span class="lineNum">    3007 </span>                :            : </a>
<a name="3008"><span class="lineNum">    3008 </span>                :            :   // orientation</a>
<a name="3009"><span class="lineNum">    3009 </span>                :<span class="lineCov">          1 :   QgsCircularString orientation;</span></a>
<a name="3010"><span class="lineNum">    3010 </span>                :<span class="lineCov">          1 :   ( void )orientation.orientation(); // no crash</span></a>
<a name="3011"><span class="lineNum">    3011 </span>                :<span class="lineCov">          1 :   orientation.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="3012"><span class="lineNum">    3012 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::Clockwise );</span></a>
<a name="3013"><span class="lineNum">    3013 </span>                :<span class="lineCov">          1 :   orientation.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="3014"><span class="lineNum">    3014 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::CounterClockwise );</span></a>
<a name="3015"><span class="lineNum">    3015 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="3016"><span class="lineNum">    3016 </span>                :            : </a>
<a name="3017"><span class="lineNum">    3017 </span>                :            : </a>
<a name="3018"><span class="lineNum">    3018 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::lineString()</span></a>
<a name="3019"><span class="lineNum">    3019 </span>                :            : {</a>
<a name="3020"><span class="lineNum">    3020 </span>                :            :   //test constructors</a>
<a name="3021"><span class="lineNum">    3021 </span>                :<span class="lineCov">          1 :   QgsLineString l1;</span></a>
<a name="3022"><span class="lineNum">    3022 </span>                :<span class="lineCov">          1 :   QVERIFY( l1.isEmpty() );</span></a>
<a name="3023"><span class="lineNum">    3023 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.numPoints(), 0 );</span></a>
<a name="3024"><span class="lineNum">    3024 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.vertexCount(), 0 );</span></a>
<a name="3025"><span class="lineNum">    3025 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.nCoordinates(), 0 );</span></a>
<a name="3026"><span class="lineNum">    3026 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.ringCount(), 0 );</span></a>
<a name="3027"><span class="lineNum">    3027 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.partCount(), 0 );</span></a>
<a name="3028"><span class="lineNum">    3028 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.is3D() );</span></a>
<a name="3029"><span class="lineNum">    3029 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.isMeasure() );</span></a>
<a name="3030"><span class="lineNum">    3030 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3031"><span class="lineNum">    3031 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wktTypeStr(), QString( &quot;LineString&quot; ) );</span></a>
<a name="3032"><span class="lineNum">    3032 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.geometryType(), QString( &quot;LineString&quot; ) );</span></a>
<a name="3033"><span class="lineNum">    3033 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.dimension(), 1 );</span></a>
<a name="3034"><span class="lineNum">    3034 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.hasCurvedSegments() );</span></a>
<a name="3035"><span class="lineNum">    3035 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.area(), 0.0 );</span></a>
<a name="3036"><span class="lineNum">    3036 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.perimeter(), 0.0 );</span></a>
<a name="3037"><span class="lineNum">    3037 </span>                :            : </a>
<a name="3038"><span class="lineNum">    3038 </span>                :            :   // from array</a>
<a name="3039"><span class="lineNum">    3039 </span>                :<span class="lineCov">          1 :   QVector&lt; double &gt; xx;</span></a>
<a name="3040"><span class="lineNum">    3040 </span>                :<span class="lineCov">          1 :   xx &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;</span></a>
<a name="3041"><span class="lineNum">    3041 </span>                :<span class="lineCov">          1 :   QVector&lt; double &gt; yy;</span></a>
<a name="3042"><span class="lineNum">    3042 </span>                :<span class="lineCov">          1 :   yy &lt;&lt; 11 &lt;&lt; 12 &lt;&lt; 13;</span></a>
<a name="3043"><span class="lineNum">    3043 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray( xx, yy );</span></a>
<a name="3044"><span class="lineNum">    3044 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3045"><span class="lineNum">    3045 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.numPoints(), 3 );</span></a>
<a name="3046"><span class="lineNum">    3046 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.xAt( 0 ), 1.0 );</span></a>
<a name="3047"><span class="lineNum">    3047 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.yAt( 0 ), 11.0 );</span></a>
<a name="3048"><span class="lineNum">    3048 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.xAt( 1 ), 2.0 );</span></a>
<a name="3049"><span class="lineNum">    3049 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.yAt( 1 ), 12.0 );</span></a>
<a name="3050"><span class="lineNum">    3050 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.xAt( 2 ), 3.0 );</span></a>
<a name="3051"><span class="lineNum">    3051 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray.yAt( 2 ), 13.0 );</span></a>
<a name="3052"><span class="lineNum">    3052 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray.xData(), 1.0 );</span></a>
<a name="3053"><span class="lineNum">    3053 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray.xData() + 1 ), 2.0 );</span></a>
<a name="3054"><span class="lineNum">    3054 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray.xData() + 2 ), 3.0 );</span></a>
<a name="3055"><span class="lineNum">    3055 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray.yData(), 11.0 );</span></a>
<a name="3056"><span class="lineNum">    3056 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray.yData() + 1 ), 12.0 );</span></a>
<a name="3057"><span class="lineNum">    3057 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray.yData() + 2 ), 13.0 );</span></a>
<a name="3058"><span class="lineNum">    3058 </span>                :            : </a>
<a name="3059"><span class="lineNum">    3059 </span>                :            :   // unbalanced</a>
<a name="3060"><span class="lineNum">    3060 </span>                :<span class="lineCov">          1 :   xx = QVector&lt; double &gt;() &lt;&lt; 1 &lt;&lt; 2;</span></a>
<a name="3061"><span class="lineNum">    3061 </span>                :<span class="lineCov">          1 :   yy = QVector&lt; double &gt;() &lt;&lt; 11 &lt;&lt; 12 &lt;&lt; 13;</span></a>
<a name="3062"><span class="lineNum">    3062 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray2( xx, yy );</span></a>
<a name="3063"><span class="lineNum">    3063 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3064"><span class="lineNum">    3064 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.numPoints(), 2 );</span></a>
<a name="3065"><span class="lineNum">    3065 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.xAt( 0 ), 1.0 );</span></a>
<a name="3066"><span class="lineNum">    3066 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.yAt( 0 ), 11.0 );</span></a>
<a name="3067"><span class="lineNum">    3067 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.xAt( 1 ), 2.0 );</span></a>
<a name="3068"><span class="lineNum">    3068 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray2.yAt( 1 ), 12.0 );</span></a>
<a name="3069"><span class="lineNum">    3069 </span>                :<span class="lineCov">          1 :   xx = QVector&lt; double &gt;() &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;</span></a>
<a name="3070"><span class="lineNum">    3070 </span>                :<span class="lineCov">          1 :   yy = QVector&lt; double &gt;() &lt;&lt; 11 &lt;&lt; 12;</span></a>
<a name="3071"><span class="lineNum">    3071 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray3( xx, yy );</span></a>
<a name="3072"><span class="lineNum">    3072 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3073"><span class="lineNum">    3073 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.numPoints(), 2 );</span></a>
<a name="3074"><span class="lineNum">    3074 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.xAt( 0 ), 1.0 );</span></a>
<a name="3075"><span class="lineNum">    3075 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.yAt( 0 ), 11.0 );</span></a>
<a name="3076"><span class="lineNum">    3076 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.xAt( 1 ), 2.0 );</span></a>
<a name="3077"><span class="lineNum">    3077 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray3.yAt( 1 ), 12.0 );</span></a>
<a name="3078"><span class="lineNum">    3078 </span>                :            :   // with z</a>
<a name="3079"><span class="lineNum">    3079 </span>                :<span class="lineCov">          1 :   QVector&lt; double &gt; zz;</span></a>
<a name="3080"><span class="lineNum">    3080 </span>                :<span class="lineCov">          1 :   xx = QVector&lt; double &gt;() &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;</span></a>
<a name="3081"><span class="lineNum">    3081 </span>                :<span class="lineCov">          1 :   yy = QVector&lt; double &gt;() &lt;&lt; 11 &lt;&lt; 12 &lt;&lt; 13;</span></a>
<a name="3082"><span class="lineNum">    3082 </span>                :<span class="lineCov">          1 :   zz = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22 &lt;&lt; 23;</span></a>
<a name="3083"><span class="lineNum">    3083 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray4( xx, yy, zz );</span></a>
<a name="3084"><span class="lineNum">    3084 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3085"><span class="lineNum">    3085 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.numPoints(), 3 );</span></a>
<a name="3086"><span class="lineNum">    3086 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 0 ), 1.0 );</span></a>
<a name="3087"><span class="lineNum">    3087 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 0 ), 11.0 );</span></a>
<a name="3088"><span class="lineNum">    3088 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 0 ), 21.0 );</span></a>
<a name="3089"><span class="lineNum">    3089 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 1 ), 2.0 );</span></a>
<a name="3090"><span class="lineNum">    3090 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 1 ), 12.0 );</span></a>
<a name="3091"><span class="lineNum">    3091 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 1 ), 22.0 );</span></a>
<a name="3092"><span class="lineNum">    3092 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 2 ), 3.0 );</span></a>
<a name="3093"><span class="lineNum">    3093 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 2 ), 13.0 );</span></a>
<a name="3094"><span class="lineNum">    3094 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 2 ), 23.0 );</span></a>
<a name="3095"><span class="lineNum">    3095 </span>                :<span class="lineCov">          1 :   fromArray4 = QgsLineString( xx, yy, zz, QVector&lt; double &gt;(), true );  // LineString25D</span></a>
<a name="3096"><span class="lineNum">    3096 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3097"><span class="lineNum">    3097 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.numPoints(), 3 );</span></a>
<a name="3098"><span class="lineNum">    3098 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 0 ), 1.0 );</span></a>
<a name="3099"><span class="lineNum">    3099 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 0 ), 11.0 );</span></a>
<a name="3100"><span class="lineNum">    3100 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 0 ), 21.0 );</span></a>
<a name="3101"><span class="lineNum">    3101 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 1 ), 2.0 );</span></a>
<a name="3102"><span class="lineNum">    3102 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 1 ), 12.0 );</span></a>
<a name="3103"><span class="lineNum">    3103 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 1 ), 22.0 );</span></a>
<a name="3104"><span class="lineNum">    3104 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.xAt( 2 ), 3.0 );</span></a>
<a name="3105"><span class="lineNum">    3105 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.yAt( 2 ), 13.0 );</span></a>
<a name="3106"><span class="lineNum">    3106 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray4.zAt( 2 ), 23.0 );</span></a>
<a name="3107"><span class="lineNum">    3107 </span>                :            : </a>
<a name="3108"><span class="lineNum">    3108 </span>                :            :   // unbalanced -&gt; z ignored</a>
<a name="3109"><span class="lineNum">    3109 </span>                :<span class="lineCov">          1 :   zz = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22;</span></a>
<a name="3110"><span class="lineNum">    3110 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray5( xx, yy, zz );</span></a>
<a name="3111"><span class="lineNum">    3111 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3112"><span class="lineNum">    3112 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.numPoints(), 3 );</span></a>
<a name="3113"><span class="lineNum">    3113 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 0 ), 1.0 );</span></a>
<a name="3114"><span class="lineNum">    3114 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 0 ), 11.0 );</span></a>
<a name="3115"><span class="lineNum">    3115 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 1 ), 2.0 );</span></a>
<a name="3116"><span class="lineNum">    3116 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 1 ), 12.0 );</span></a>
<a name="3117"><span class="lineNum">    3117 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 2 ), 3.0 );</span></a>
<a name="3118"><span class="lineNum">    3118 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 2 ), 13.0 );</span></a>
<a name="3119"><span class="lineNum">    3119 </span>                :            :   // unbalanced -&gt; z truncated</a>
<a name="3120"><span class="lineNum">    3120 </span>                :<span class="lineCov">          1 :   zz = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22 &lt;&lt; 23 &lt;&lt; 24;</span></a>
<a name="3121"><span class="lineNum">    3121 </span>                :<span class="lineCov">          1 :   fromArray5 = QgsLineString( xx, yy, zz );</span></a>
<a name="3122"><span class="lineNum">    3122 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3123"><span class="lineNum">    3123 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.numPoints(), 3 );</span></a>
<a name="3124"><span class="lineNum">    3124 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 0 ), 1.0 );</span></a>
<a name="3125"><span class="lineNum">    3125 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 0 ), 11.0 );</span></a>
<a name="3126"><span class="lineNum">    3126 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.zAt( 0 ), 21.0 );</span></a>
<a name="3127"><span class="lineNum">    3127 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 1 ), 2.0 );</span></a>
<a name="3128"><span class="lineNum">    3128 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 1 ), 12.0 );</span></a>
<a name="3129"><span class="lineNum">    3129 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.zAt( 1 ), 22.0 );</span></a>
<a name="3130"><span class="lineNum">    3130 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.xAt( 2 ), 3.0 );</span></a>
<a name="3131"><span class="lineNum">    3131 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.yAt( 2 ), 13.0 );</span></a>
<a name="3132"><span class="lineNum">    3132 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray5.zAt( 2 ), 23.0 );</span></a>
<a name="3133"><span class="lineNum">    3133 </span>                :            :   // with m</a>
<a name="3134"><span class="lineNum">    3134 </span>                :<span class="lineCov">          1 :   QVector&lt; double &gt; mm;</span></a>
<a name="3135"><span class="lineNum">    3135 </span>                :<span class="lineCov">          1 :   xx = QVector&lt; double &gt;() &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;</span></a>
<a name="3136"><span class="lineNum">    3136 </span>                :<span class="lineCov">          1 :   yy = QVector&lt; double &gt;() &lt;&lt; 11 &lt;&lt; 12 &lt;&lt; 13;</span></a>
<a name="3137"><span class="lineNum">    3137 </span>                :<span class="lineCov">          1 :   mm = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22 &lt;&lt; 23;</span></a>
<a name="3138"><span class="lineNum">    3138 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray6( xx, yy, QVector&lt; double &gt;(), mm );</span></a>
<a name="3139"><span class="lineNum">    3139 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3140"><span class="lineNum">    3140 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.numPoints(), 3 );</span></a>
<a name="3141"><span class="lineNum">    3141 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.xAt( 0 ), 1.0 );</span></a>
<a name="3142"><span class="lineNum">    3142 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.yAt( 0 ), 11.0 );</span></a>
<a name="3143"><span class="lineNum">    3143 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.mAt( 0 ), 21.0 );</span></a>
<a name="3144"><span class="lineNum">    3144 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.xAt( 1 ), 2.0 );</span></a>
<a name="3145"><span class="lineNum">    3145 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.yAt( 1 ), 12.0 );</span></a>
<a name="3146"><span class="lineNum">    3146 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.mAt( 1 ), 22.0 );</span></a>
<a name="3147"><span class="lineNum">    3147 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.xAt( 2 ), 3.0 );</span></a>
<a name="3148"><span class="lineNum">    3148 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.yAt( 2 ), 13.0 );</span></a>
<a name="3149"><span class="lineNum">    3149 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray6.mAt( 2 ), 23.0 );</span></a>
<a name="3150"><span class="lineNum">    3150 </span>                :            :   // unbalanced -&gt; m ignored</a>
<a name="3151"><span class="lineNum">    3151 </span>                :<span class="lineCov">          1 :   mm = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22;</span></a>
<a name="3152"><span class="lineNum">    3152 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray7( xx, yy, QVector&lt; double &gt;(), mm );</span></a>
<a name="3153"><span class="lineNum">    3153 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3154"><span class="lineNum">    3154 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.numPoints(), 3 );</span></a>
<a name="3155"><span class="lineNum">    3155 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 0 ), 1.0 );</span></a>
<a name="3156"><span class="lineNum">    3156 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 0 ), 11.0 );</span></a>
<a name="3157"><span class="lineNum">    3157 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 1 ), 2.0 );</span></a>
<a name="3158"><span class="lineNum">    3158 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 1 ), 12.0 );</span></a>
<a name="3159"><span class="lineNum">    3159 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 2 ), 3.0 );</span></a>
<a name="3160"><span class="lineNum">    3160 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 2 ), 13.0 );</span></a>
<a name="3161"><span class="lineNum">    3161 </span>                :            :   // unbalanced -&gt; m truncated</a>
<a name="3162"><span class="lineNum">    3162 </span>                :<span class="lineCov">          1 :   mm = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22 &lt;&lt; 23 &lt;&lt; 24;</span></a>
<a name="3163"><span class="lineNum">    3163 </span>                :<span class="lineCov">          1 :   fromArray7 = QgsLineString( xx, yy, QVector&lt; double &gt;(), mm );</span></a>
<a name="3164"><span class="lineNum">    3164 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3165"><span class="lineNum">    3165 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.numPoints(), 3 );</span></a>
<a name="3166"><span class="lineNum">    3166 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 0 ), 1.0 );</span></a>
<a name="3167"><span class="lineNum">    3167 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 0 ), 11.0 );</span></a>
<a name="3168"><span class="lineNum">    3168 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.mAt( 0 ), 21.0 );</span></a>
<a name="3169"><span class="lineNum">    3169 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 1 ), 2.0 );</span></a>
<a name="3170"><span class="lineNum">    3170 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 1 ), 12.0 );</span></a>
<a name="3171"><span class="lineNum">    3171 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.mAt( 1 ), 22.0 );</span></a>
<a name="3172"><span class="lineNum">    3172 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.xAt( 2 ), 3.0 );</span></a>
<a name="3173"><span class="lineNum">    3173 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.yAt( 2 ), 13.0 );</span></a>
<a name="3174"><span class="lineNum">    3174 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray7.mAt( 2 ), 23.0 );</span></a>
<a name="3175"><span class="lineNum">    3175 </span>                :            :   // zm</a>
<a name="3176"><span class="lineNum">    3176 </span>                :<span class="lineCov">          1 :   xx = QVector&lt; double &gt;() &lt;&lt; 1 &lt;&lt; 2 &lt;&lt; 3;</span></a>
<a name="3177"><span class="lineNum">    3177 </span>                :<span class="lineCov">          1 :   yy = QVector&lt; double &gt;() &lt;&lt; 11 &lt;&lt; 12 &lt;&lt; 13;</span></a>
<a name="3178"><span class="lineNum">    3178 </span>                :<span class="lineCov">          1 :   zz = QVector&lt; double &gt;() &lt;&lt; 21 &lt;&lt; 22 &lt;&lt; 23;</span></a>
<a name="3179"><span class="lineNum">    3179 </span>                :<span class="lineCov">          1 :   mm = QVector&lt; double &gt;() &lt;&lt; 31 &lt;&lt; 32 &lt;&lt; 33;</span></a>
<a name="3180"><span class="lineNum">    3180 </span>                :<span class="lineCov">          1 :   QgsLineString fromArray8( xx, yy, zz, mm );</span></a>
<a name="3181"><span class="lineNum">    3181 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3182"><span class="lineNum">    3182 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.numPoints(), 3 );</span></a>
<a name="3183"><span class="lineNum">    3183 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.xAt( 0 ), 1.0 );</span></a>
<a name="3184"><span class="lineNum">    3184 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.yAt( 0 ), 11.0 );</span></a>
<a name="3185"><span class="lineNum">    3185 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.zAt( 0 ), 21.0 );</span></a>
<a name="3186"><span class="lineNum">    3186 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.mAt( 0 ), 31.0 );</span></a>
<a name="3187"><span class="lineNum">    3187 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.xAt( 1 ), 2.0 );</span></a>
<a name="3188"><span class="lineNum">    3188 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.yAt( 1 ), 12.0 );</span></a>
<a name="3189"><span class="lineNum">    3189 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.zAt( 1 ), 22.0 );</span></a>
<a name="3190"><span class="lineNum">    3190 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.mAt( 1 ), 32.0 );</span></a>
<a name="3191"><span class="lineNum">    3191 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.xAt( 2 ), 3.0 );</span></a>
<a name="3192"><span class="lineNum">    3192 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.yAt( 2 ), 13.0 );</span></a>
<a name="3193"><span class="lineNum">    3193 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.zAt( 2 ), 23.0 );</span></a>
<a name="3194"><span class="lineNum">    3194 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromArray8.mAt( 2 ), 33.0 );</span></a>
<a name="3195"><span class="lineNum">    3195 </span>                :            : </a>
<a name="3196"><span class="lineNum">    3196 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray8.xData(), 1.0 );</span></a>
<a name="3197"><span class="lineNum">    3197 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.xData() + 1 ), 2.0 );</span></a>
<a name="3198"><span class="lineNum">    3198 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.xData() + 2 ), 3.0 );</span></a>
<a name="3199"><span class="lineNum">    3199 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray8.yData(), 11.0 );</span></a>
<a name="3200"><span class="lineNum">    3200 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.yData() + 1 ), 12.0 );</span></a>
<a name="3201"><span class="lineNum">    3201 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.yData() + 2 ), 13.0 );</span></a>
<a name="3202"><span class="lineNum">    3202 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray8.zData(), 21.0 );</span></a>
<a name="3203"><span class="lineNum">    3203 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.zData() + 1 ), 22.0 );</span></a>
<a name="3204"><span class="lineNum">    3204 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.zData() + 2 ), 23.0 );</span></a>
<a name="3205"><span class="lineNum">    3205 </span>                :<span class="lineCov">          1 :   QCOMPARE( *fromArray8.mData(), 31.0 );</span></a>
<a name="3206"><span class="lineNum">    3206 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.mData() + 1 ), 32.0 );</span></a>
<a name="3207"><span class="lineNum">    3207 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( fromArray8.mData() + 2 ), 33.0 );</span></a>
<a name="3208"><span class="lineNum">    3208 </span>                :            : </a>
<a name="3209"><span class="lineNum">    3209 </span>                :            :   // from QList&lt;QgsPointXY&gt;</a>
<a name="3210"><span class="lineNum">    3210 </span>                :<span class="lineCov">          1 :   QgsLineString fromPtsA = QgsLineString( QgsPointSequence() );</span></a>
<a name="3211"><span class="lineNum">    3211 </span>                :<span class="lineCov">          1 :   QVERIFY( fromPtsA.isEmpty() );</span></a>
<a name="3212"><span class="lineNum">    3212 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPtsA.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3213"><span class="lineNum">    3213 </span>                :            : </a>
<a name="3214"><span class="lineNum">    3214 </span>                :<span class="lineCov">          1 :   fromPtsA = QgsLineString( QgsPointSequence()  &lt;&lt; QgsPoint( 1, 2, 0, 4, QgsWkbTypes::PointM ) );</span></a>
<a name="3215"><span class="lineNum">    3215 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPtsA.numPoints(), 1 );</span></a>
<a name="3216"><span class="lineNum">    3216 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPtsA.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3217"><span class="lineNum">    3217 </span>                :            : </a>
<a name="3218"><span class="lineNum">    3218 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsPointXY&gt; ptsA;</span></a>
<a name="3219"><span class="lineNum">    3219 </span>                :<span class="lineCov">          1 :   ptsA &lt;&lt; QgsPointXY( 1, 2 ) &lt;&lt; QgsPointXY( 11, 12 ) &lt;&lt; QgsPointXY( 21, 22 );</span></a>
<a name="3220"><span class="lineNum">    3220 </span>                :<span class="lineCov">          1 :   QgsLineString fromPts( ptsA );</span></a>
<a name="3221"><span class="lineNum">    3221 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3222"><span class="lineNum">    3222 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.numPoints(), 3 );</span></a>
<a name="3223"><span class="lineNum">    3223 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.xAt( 0 ), 1.0 );</span></a>
<a name="3224"><span class="lineNum">    3224 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.yAt( 0 ), 2.0 );</span></a>
<a name="3225"><span class="lineNum">    3225 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.xAt( 1 ), 11.0 );</span></a>
<a name="3226"><span class="lineNum">    3226 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.yAt( 1 ), 12.0 );</span></a>
<a name="3227"><span class="lineNum">    3227 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.xAt( 2 ), 21.0 );</span></a>
<a name="3228"><span class="lineNum">    3228 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPts.yAt( 2 ), 22.0 );</span></a>
<a name="3229"><span class="lineNum">    3229 </span>                :            : </a>
<a name="3230"><span class="lineNum">    3230 </span>                :            :   // from QgsPointSequence</a>
<a name="3231"><span class="lineNum">    3231 </span>                :<span class="lineCov">          1 :   QgsPointSequence ptsVector;</span></a>
<a name="3232"><span class="lineNum">    3232 </span>                :<span class="lineCov">          1 :   ptsVector &lt;&lt; QgsPoint( 10, 20 ) &lt;&lt; QgsPoint( 30, 40 );</span></a>
<a name="3233"><span class="lineNum">    3233 </span>                :<span class="lineCov">          1 :   QgsLineString fromVector( ptsVector );</span></a>
<a name="3234"><span class="lineNum">    3234 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3235"><span class="lineNum">    3235 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.numPoints(), 2 );</span></a>
<a name="3236"><span class="lineNum">    3236 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.xAt( 0 ), 10.0 );</span></a>
<a name="3237"><span class="lineNum">    3237 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.yAt( 0 ), 20.0 );</span></a>
<a name="3238"><span class="lineNum">    3238 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.xAt( 1 ), 30.0 );</span></a>
<a name="3239"><span class="lineNum">    3239 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector.yAt( 1 ), 40.0 );</span></a>
<a name="3240"><span class="lineNum">    3240 </span>                :<span class="lineCov">          1 :   QgsPointSequence ptsVector3D;</span></a>
<a name="3241"><span class="lineNum">    3241 </span>                :<span class="lineCov">          1 :   ptsVector3D &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 40, 200 );</span></a>
<a name="3242"><span class="lineNum">    3242 </span>                :<span class="lineCov">          1 :   QgsLineString fromVector3D( ptsVector3D );</span></a>
<a name="3243"><span class="lineNum">    3243 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3244"><span class="lineNum">    3244 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.numPoints(), 2 );</span></a>
<a name="3245"><span class="lineNum">    3245 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.xAt( 0 ), 10.0 );</span></a>
<a name="3246"><span class="lineNum">    3246 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.yAt( 0 ), 20.0 );</span></a>
<a name="3247"><span class="lineNum">    3247 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.zAt( 0 ), 100.0 );</span></a>
<a name="3248"><span class="lineNum">    3248 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.xAt( 1 ), 30.0 );</span></a>
<a name="3249"><span class="lineNum">    3249 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.yAt( 1 ), 40.0 );</span></a>
<a name="3250"><span class="lineNum">    3250 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVector3D.zAt( 1 ), 200.0 );</span></a>
<a name="3251"><span class="lineNum">    3251 </span>                :            : </a>
<a name="3252"><span class="lineNum">    3252 </span>                :            :   // from 2 points</a>
<a name="3253"><span class="lineNum">    3253 </span>                :<span class="lineCov">          1 :   QgsLineString from2Pts( QgsPoint( 1, 2 ), QgsPoint( 21, 22 ) );</span></a>
<a name="3254"><span class="lineNum">    3254 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3255"><span class="lineNum">    3255 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.numPoints(), 2 );</span></a>
<a name="3256"><span class="lineNum">    3256 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 0 ), 1.0 );</span></a>
<a name="3257"><span class="lineNum">    3257 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 0 ), 2.0 );</span></a>
<a name="3258"><span class="lineNum">    3258 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 1 ), 21.0 );</span></a>
<a name="3259"><span class="lineNum">    3259 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 1 ), 22.0 );</span></a>
<a name="3260"><span class="lineNum">    3260 </span>                :<span class="lineCov">          1 :   from2Pts = QgsLineString( QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ), QgsPoint( QgsWkbTypes::PointZ, 21, 22, 23 ) );</span></a>
<a name="3261"><span class="lineNum">    3261 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3262"><span class="lineNum">    3262 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.numPoints(), 2 );</span></a>
<a name="3263"><span class="lineNum">    3263 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 0 ), 1.0 );</span></a>
<a name="3264"><span class="lineNum">    3264 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 0 ), 2.0 );</span></a>
<a name="3265"><span class="lineNum">    3265 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.zAt( 0 ), 3.0 );</span></a>
<a name="3266"><span class="lineNum">    3266 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 1 ), 21.0 );</span></a>
<a name="3267"><span class="lineNum">    3267 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 1 ), 22.0 );</span></a>
<a name="3268"><span class="lineNum">    3268 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.zAt( 1 ), 23.0 );</span></a>
<a name="3269"><span class="lineNum">    3269 </span>                :<span class="lineCov">          1 :   from2Pts = QgsLineString( QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ), QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 23 ) );</span></a>
<a name="3270"><span class="lineNum">    3270 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3271"><span class="lineNum">    3271 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.numPoints(), 2 );</span></a>
<a name="3272"><span class="lineNum">    3272 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 0 ), 1.0 );</span></a>
<a name="3273"><span class="lineNum">    3273 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 0 ), 2.0 );</span></a>
<a name="3274"><span class="lineNum">    3274 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.mAt( 0 ), 3.0 );</span></a>
<a name="3275"><span class="lineNum">    3275 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 1 ), 21.0 );</span></a>
<a name="3276"><span class="lineNum">    3276 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 1 ), 22.0 );</span></a>
<a name="3277"><span class="lineNum">    3277 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.mAt( 1 ), 23.0 );</span></a>
<a name="3278"><span class="lineNum">    3278 </span>                :<span class="lineCov">          1 :   from2Pts = QgsLineString( QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 ) );</span></a>
<a name="3279"><span class="lineNum">    3279 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3280"><span class="lineNum">    3280 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.numPoints(), 2 );</span></a>
<a name="3281"><span class="lineNum">    3281 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 0 ), 1.0 );</span></a>
<a name="3282"><span class="lineNum">    3282 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 0 ), 2.0 );</span></a>
<a name="3283"><span class="lineNum">    3283 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.zAt( 0 ), 3.0 );</span></a>
<a name="3284"><span class="lineNum">    3284 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.mAt( 0 ), 4.0 );</span></a>
<a name="3285"><span class="lineNum">    3285 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.xAt( 1 ), 21.0 );</span></a>
<a name="3286"><span class="lineNum">    3286 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.yAt( 1 ), 22.0 );</span></a>
<a name="3287"><span class="lineNum">    3287 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.zAt( 1 ), 23.0 );</span></a>
<a name="3288"><span class="lineNum">    3288 </span>                :<span class="lineCov">          1 :   QCOMPARE( from2Pts.mAt( 1 ), 24.0 );</span></a>
<a name="3289"><span class="lineNum">    3289 </span>                :            : </a>
<a name="3290"><span class="lineNum">    3290 </span>                :            :   // from lineSegment</a>
<a name="3291"><span class="lineNum">    3291 </span>                :<span class="lineCov">          1 :   QgsLineString fromSegment( QgsLineSegment2D( QgsPointXY( 1, 2 ), QgsPointXY( 3, 4 ) ) );</span></a>
<a name="3292"><span class="lineNum">    3292 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3293"><span class="lineNum">    3293 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.numPoints(), 2 );</span></a>
<a name="3294"><span class="lineNum">    3294 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.xAt( 0 ), 1.0 );</span></a>
<a name="3295"><span class="lineNum">    3295 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.yAt( 0 ), 2.0 );</span></a>
<a name="3296"><span class="lineNum">    3296 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.xAt( 1 ), 3.0 );</span></a>
<a name="3297"><span class="lineNum">    3297 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromSegment.yAt( 1 ), 4.0 );</span></a>
<a name="3298"><span class="lineNum">    3298 </span>                :            : </a>
<a name="3299"><span class="lineNum">    3299 </span>                :            :   //addVertex</a>
<a name="3300"><span class="lineNum">    3300 </span>                :<span class="lineCov">          1 :   QgsLineString l2;</span></a>
<a name="3301"><span class="lineNum">    3301 </span>                :<span class="lineCov">          1 :   l2.addVertex( QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="3302"><span class="lineNum">    3302 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.isEmpty() );</span></a>
<a name="3303"><span class="lineNum">    3303 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.numPoints(), 1 );</span></a>
<a name="3304"><span class="lineNum">    3304 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.vertexCount(), 1 );</span></a>
<a name="3305"><span class="lineNum">    3305 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.nCoordinates(), 1 );</span></a>
<a name="3306"><span class="lineNum">    3306 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.ringCount(), 1 );</span></a>
<a name="3307"><span class="lineNum">    3307 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.partCount(), 1 );</span></a>
<a name="3308"><span class="lineNum">    3308 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.is3D() );</span></a>
<a name="3309"><span class="lineNum">    3309 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.isMeasure() );</span></a>
<a name="3310"><span class="lineNum">    3310 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3311"><span class="lineNum">    3311 </span>                :<span class="lineCov">          1 :   QVERIFY( !l2.hasCurvedSegments() );</span></a>
<a name="3312"><span class="lineNum">    3312 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.area(), 0.0 );</span></a>
<a name="3313"><span class="lineNum">    3313 </span>                :<span class="lineCov">          1 :   QCOMPARE( l2.perimeter(), 0.0 );</span></a>
<a name="3314"><span class="lineNum">    3314 </span>                :            : </a>
<a name="3315"><span class="lineNum">    3315 </span>                :            :   //adding first vertex should set linestring z/m type</a>
<a name="3316"><span class="lineNum">    3316 </span>                :<span class="lineCov">          1 :   QgsLineString l3;</span></a>
<a name="3317"><span class="lineNum">    3317 </span>                :<span class="lineCov">          1 :   l3.addVertex( QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="3318"><span class="lineNum">    3318 </span>                :<span class="lineCov">          1 :   QVERIFY( !l3.isEmpty() );</span></a>
<a name="3319"><span class="lineNum">    3319 </span>                :<span class="lineCov">          1 :   QVERIFY( l3.is3D() );</span></a>
<a name="3320"><span class="lineNum">    3320 </span>                :<span class="lineCov">          1 :   QVERIFY( !l3.isMeasure() );</span></a>
<a name="3321"><span class="lineNum">    3321 </span>                :<span class="lineCov">          1 :   QCOMPARE( l3.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3322"><span class="lineNum">    3322 </span>                :<span class="lineCov">          1 :   QCOMPARE( l3.wktTypeStr(), QString( &quot;LineStringZ&quot; ) );</span></a>
<a name="3323"><span class="lineNum">    3323 </span>                :            : </a>
<a name="3324"><span class="lineNum">    3324 </span>                :<span class="lineCov">          1 :   QgsLineString l4;</span></a>
<a name="3325"><span class="lineNum">    3325 </span>                :<span class="lineCov">          1 :   l4.addVertex( QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="3326"><span class="lineNum">    3326 </span>                :<span class="lineCov">          1 :   QVERIFY( !l4.isEmpty() );</span></a>
<a name="3327"><span class="lineNum">    3327 </span>                :<span class="lineCov">          1 :   QVERIFY( !l4.is3D() );</span></a>
<a name="3328"><span class="lineNum">    3328 </span>                :<span class="lineCov">          1 :   QVERIFY( l4.isMeasure() );</span></a>
<a name="3329"><span class="lineNum">    3329 </span>                :<span class="lineCov">          1 :   QCOMPARE( l4.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3330"><span class="lineNum">    3330 </span>                :<span class="lineCov">          1 :   QCOMPARE( l4.wktTypeStr(), QString( &quot;LineStringM&quot; ) );</span></a>
<a name="3331"><span class="lineNum">    3331 </span>                :            : </a>
<a name="3332"><span class="lineNum">    3332 </span>                :<span class="lineCov">          1 :   QgsLineString l5;</span></a>
<a name="3333"><span class="lineNum">    3333 </span>                :<span class="lineCov">          1 :   l5.addVertex( QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="3334"><span class="lineNum">    3334 </span>                :<span class="lineCov">          1 :   QVERIFY( !l5.isEmpty() );</span></a>
<a name="3335"><span class="lineNum">    3335 </span>                :<span class="lineCov">          1 :   QVERIFY( l5.is3D() );</span></a>
<a name="3336"><span class="lineNum">    3336 </span>                :<span class="lineCov">          1 :   QVERIFY( l5.isMeasure() );</span></a>
<a name="3337"><span class="lineNum">    3337 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3338"><span class="lineNum">    3338 </span>                :<span class="lineCov">          1 :   QCOMPARE( l5.wktTypeStr(), QString( &quot;LineStringZM&quot; ) );</span></a>
<a name="3339"><span class="lineNum">    3339 </span>                :            : </a>
<a name="3340"><span class="lineNum">    3340 </span>                :<span class="lineCov">          1 :   QgsLineString l25d;</span></a>
<a name="3341"><span class="lineNum">    3341 </span>                :<span class="lineCov">          1 :   l25d.addVertex( QgsPoint( QgsWkbTypes::Point25D, 1.0, 2.0, 3.0 ) );</span></a>
<a name="3342"><span class="lineNum">    3342 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25d.isEmpty() );</span></a>
<a name="3343"><span class="lineNum">    3343 </span>                :<span class="lineCov">          1 :   QVERIFY( l25d.is3D() );</span></a>
<a name="3344"><span class="lineNum">    3344 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25d.isMeasure() );</span></a>
<a name="3345"><span class="lineNum">    3345 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25d.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3346"><span class="lineNum">    3346 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25d.wktTypeStr(), QString( &quot;LineStringZ&quot; ) );</span></a>
<a name="3347"><span class="lineNum">    3347 </span>                :            : </a>
<a name="3348"><span class="lineNum">    3348 </span>                :            :   //adding subsequent vertices should not alter z/m type, regardless of points type</a>
<a name="3349"><span class="lineNum">    3349 </span>                :<span class="lineCov">          1 :   QgsLineString l6;</span></a>
<a name="3350"><span class="lineNum">    3350 </span>                :<span class="lineCov">          1 :   l6.addVertex( QgsPoint( QgsWkbTypes::Point, 1.0, 2.0 ) ); //2d type</span></a>
<a name="3351"><span class="lineNum">    3351 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3352"><span class="lineNum">    3352 </span>                :<span class="lineCov">          1 :   l6.addVertex( QgsPoint( QgsWkbTypes::PointZ, 11.0, 12.0, 13.0 ) ); // add 3d point</span></a>
<a name="3353"><span class="lineNum">    3353 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.numPoints(), 2 );</span></a>
<a name="3354"><span class="lineNum">    3354 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.vertexCount(), 2 );</span></a>
<a name="3355"><span class="lineNum">    3355 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.nCoordinates(), 2 );</span></a>
<a name="3356"><span class="lineNum">    3356 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.ringCount(), 1 );</span></a>
<a name="3357"><span class="lineNum">    3357 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.partCount(), 1 );</span></a>
<a name="3358"><span class="lineNum">    3358 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.wkbType(), QgsWkbTypes::LineString ); //should still be 2d</span></a>
<a name="3359"><span class="lineNum">    3359 </span>                :<span class="lineCov">          1 :   QVERIFY( !l6.is3D() );</span></a>
<a name="3360"><span class="lineNum">    3360 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.area(), 0.0 );</span></a>
<a name="3361"><span class="lineNum">    3361 </span>                :<span class="lineCov">          1 :   QCOMPARE( l6.perimeter(), 0.0 );</span></a>
<a name="3362"><span class="lineNum">    3362 </span>                :            : </a>
<a name="3363"><span class="lineNum">    3363 </span>                :<span class="lineCov">          1 :   QgsLineString l7;</span></a>
<a name="3364"><span class="lineNum">    3364 </span>                :<span class="lineCov">          1 :   l7.addVertex( QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) ); //3d type</span></a>
<a name="3365"><span class="lineNum">    3365 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3366"><span class="lineNum">    3366 </span>                :<span class="lineCov">          1 :   l7.addVertex( QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) ); //add 2d point</span></a>
<a name="3367"><span class="lineNum">    3367 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.wkbType(), QgsWkbTypes::LineStringZ ); //should still be 3d</span></a>
<a name="3368"><span class="lineNum">    3368 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11.0, 12.0 ) );</span></a>
<a name="3369"><span class="lineNum">    3369 </span>                :<span class="lineCov">          1 :   QVERIFY( l7.is3D() );</span></a>
<a name="3370"><span class="lineNum">    3370 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.numPoints(), 2 );</span></a>
<a name="3371"><span class="lineNum">    3371 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.vertexCount(), 2 );</span></a>
<a name="3372"><span class="lineNum">    3372 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.nCoordinates(), 2 );</span></a>
<a name="3373"><span class="lineNum">    3373 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.ringCount(), 1 );</span></a>
<a name="3374"><span class="lineNum">    3374 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.partCount(), 1 );</span></a>
<a name="3375"><span class="lineNum">    3375 </span>                :            : </a>
<a name="3376"><span class="lineNum">    3376 </span>                :            :   //clear</a>
<a name="3377"><span class="lineNum">    3377 </span>                :<span class="lineCov">          1 :   l7.clear();</span></a>
<a name="3378"><span class="lineNum">    3378 </span>                :<span class="lineCov">          1 :   QVERIFY( l7.isEmpty() );</span></a>
<a name="3379"><span class="lineNum">    3379 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.numPoints(), 0 );</span></a>
<a name="3380"><span class="lineNum">    3380 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.vertexCount(), 0 );</span></a>
<a name="3381"><span class="lineNum">    3381 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.nCoordinates(), 0 );</span></a>
<a name="3382"><span class="lineNum">    3382 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.ringCount(), 0 );</span></a>
<a name="3383"><span class="lineNum">    3383 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.partCount(), 0 );</span></a>
<a name="3384"><span class="lineNum">    3384 </span>                :<span class="lineCov">          1 :   QVERIFY( !l7.is3D() );</span></a>
<a name="3385"><span class="lineNum">    3385 </span>                :<span class="lineCov">          1 :   QVERIFY( !l7.isMeasure() );</span></a>
<a name="3386"><span class="lineNum">    3386 </span>                :<span class="lineCov">          1 :   QCOMPARE( l7.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3387"><span class="lineNum">    3387 </span>                :            : </a>
<a name="3388"><span class="lineNum">    3388 </span>                :            :   //setPoints</a>
<a name="3389"><span class="lineNum">    3389 </span>                :<span class="lineCov">          1 :   QgsLineString l8;</span></a>
<a name="3390"><span class="lineNum">    3390 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="3391"><span class="lineNum">    3391 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isEmpty() );</span></a>
<a name="3392"><span class="lineNum">    3392 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 3 );</span></a>
<a name="3393"><span class="lineNum">    3393 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.vertexCount(), 3 );</span></a>
<a name="3394"><span class="lineNum">    3394 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.nCoordinates(), 3 );</span></a>
<a name="3395"><span class="lineNum">    3395 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.ringCount(), 1 );</span></a>
<a name="3396"><span class="lineNum">    3396 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.partCount(), 1 );</span></a>
<a name="3397"><span class="lineNum">    3397 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.is3D() );</span></a>
<a name="3398"><span class="lineNum">    3398 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isMeasure() );</span></a>
<a name="3399"><span class="lineNum">    3399 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3400"><span class="lineNum">    3400 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.hasCurvedSegments() );</span></a>
<a name="3401"><span class="lineNum">    3401 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts;</span></a>
<a name="3402"><span class="lineNum">    3402 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3403"><span class="lineNum">    3403 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="3404"><span class="lineNum">    3404 </span>                :<span class="lineCov">          1 :   QCOMPARE( *l8.xData(), 1.0 );</span></a>
<a name="3405"><span class="lineNum">    3405 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( l8.xData() + 1 ), 2.0 );</span></a>
<a name="3406"><span class="lineNum">    3406 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( l8.xData() + 2 ), 3.0 );</span></a>
<a name="3407"><span class="lineNum">    3407 </span>                :<span class="lineCov">          1 :   QCOMPARE( *l8.yData(), 2.0 );</span></a>
<a name="3408"><span class="lineNum">    3408 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( l8.yData() + 1 ), 3.0 );</span></a>
<a name="3409"><span class="lineNum">    3409 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( l8.yData() + 2 ), 4.0 );</span></a>
<a name="3410"><span class="lineNum">    3410 </span>                :            : </a>
<a name="3411"><span class="lineNum">    3411 </span>                :            :   //setPoints with empty list, should clear linestring</a>
<a name="3412"><span class="lineNum">    3412 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() );</span></a>
<a name="3413"><span class="lineNum">    3413 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isEmpty() );</span></a>
<a name="3414"><span class="lineNum">    3414 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 0 );</span></a>
<a name="3415"><span class="lineNum">    3415 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.vertexCount(), 0 );</span></a>
<a name="3416"><span class="lineNum">    3416 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.nCoordinates(), 0 );</span></a>
<a name="3417"><span class="lineNum">    3417 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.ringCount(), 0 );</span></a>
<a name="3418"><span class="lineNum">    3418 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.partCount(), 0 );</span></a>
<a name="3419"><span class="lineNum">    3419 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3420"><span class="lineNum">    3420 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3421"><span class="lineNum">    3421 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.isEmpty() );</span></a>
<a name="3422"><span class="lineNum">    3422 </span>                :            : </a>
<a name="3423"><span class="lineNum">    3423 </span>                :            :   //setPoints with z</a>
<a name="3424"><span class="lineNum">    3424 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="3425"><span class="lineNum">    3425 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="3426"><span class="lineNum">    3426 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="3427"><span class="lineNum">    3427 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isMeasure() );</span></a>
<a name="3428"><span class="lineNum">    3428 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="3429"><span class="lineNum">    3429 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3430"><span class="lineNum">    3430 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="3431"><span class="lineNum">    3431 </span>                :            : </a>
<a name="3432"><span class="lineNum">    3432 </span>                :            :   //setPoints with 25d</a>
<a name="3433"><span class="lineNum">    3433 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 2, 3, 4 ) );</span></a>
<a name="3434"><span class="lineNum">    3434 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="3435"><span class="lineNum">    3435 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="3436"><span class="lineNum">    3436 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.isMeasure() );</span></a>
<a name="3437"><span class="lineNum">    3437 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3438"><span class="lineNum">    3438 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 1, 2, 4 ) );</span></a>
<a name="3439"><span class="lineNum">    3439 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3440"><span class="lineNum">    3440 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 2, 3, 4 ) );</span></a>
<a name="3441"><span class="lineNum">    3441 </span>                :            : </a>
<a name="3442"><span class="lineNum">    3442 </span>                :            :   //setPoints with m</a>
<a name="3443"><span class="lineNum">    3443 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="3444"><span class="lineNum">    3444 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="3445"><span class="lineNum">    3445 </span>                :<span class="lineCov">          1 :   QVERIFY( !l8.is3D() );</span></a>
<a name="3446"><span class="lineNum">    3446 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="3447"><span class="lineNum">    3447 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="3448"><span class="lineNum">    3448 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3449"><span class="lineNum">    3449 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="3450"><span class="lineNum">    3450 </span>                :            : </a>
<a name="3451"><span class="lineNum">    3451 </span>                :            :   //setPoints with zm</a>
<a name="3452"><span class="lineNum">    3452 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="3453"><span class="lineNum">    3453 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="3454"><span class="lineNum">    3454 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="3455"><span class="lineNum">    3455 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="3456"><span class="lineNum">    3456 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3457"><span class="lineNum">    3457 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3458"><span class="lineNum">    3458 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="3459"><span class="lineNum">    3459 </span>                :            : </a>
<a name="3460"><span class="lineNum">    3460 </span>                :            :   //setPoints with MIXED dimensionality of points</a>
<a name="3461"><span class="lineNum">    3461 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 ) );</span></a>
<a name="3462"><span class="lineNum">    3462 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.numPoints(), 2 );</span></a>
<a name="3463"><span class="lineNum">    3463 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.is3D() );</span></a>
<a name="3464"><span class="lineNum">    3464 </span>                :<span class="lineCov">          1 :   QVERIFY( l8.isMeasure() );</span></a>
<a name="3465"><span class="lineNum">    3465 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3466"><span class="lineNum">    3466 </span>                :<span class="lineCov">          1 :   l8.points( pts );</span></a>
<a name="3467"><span class="lineNum">    3467 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 0, 5 ) );</span></a>
<a name="3468"><span class="lineNum">    3468 </span>                :            : </a>
<a name="3469"><span class="lineNum">    3469 </span>                :            :   //test point</a>
<a name="3470"><span class="lineNum">    3470 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) );</span></a>
<a name="3471"><span class="lineNum">    3471 </span>                :<span class="lineCov">          1 :   QCOMPARE( l8.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 2, 3, 0, 5 ) );</span></a>
<a name="3472"><span class="lineNum">    3472 </span>                :            : </a>
<a name="3473"><span class="lineNum">    3473 </span>                :            :   //out of range - just want no crash here</a>
<a name="3474"><span class="lineNum">    3474 </span>                :<span class="lineCov">          1 :   QgsPoint bad = l8.pointN( -1 );</span></a>
<a name="3475"><span class="lineNum">    3475 </span>                :<span class="lineCov">          1 :   bad = l8.pointN( 100 );</span></a>
<a name="3476"><span class="lineNum">    3476 </span>                :            : </a>
<a name="3477"><span class="lineNum">    3477 </span>                :            :   //test getters/setters</a>
<a name="3478"><span class="lineNum">    3478 </span>                :<span class="lineCov">          1 :   QgsLineString l9;</span></a>
<a name="3479"><span class="lineNum">    3479 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3480"><span class="lineNum">    3480 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 )</span></a>
<a name="3481"><span class="lineNum">    3481 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 ) );</span></a>
<a name="3482"><span class="lineNum">    3482 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 0 ), 1.0 );</span></a>
<a name="3483"><span class="lineNum">    3483 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 1 ), 11.0 );</span></a>
<a name="3484"><span class="lineNum">    3484 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 2 ), 21.0 );</span></a>
<a name="3485"><span class="lineNum">    3485 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( -1 ), 0.0 ); //out of range</span></a>
<a name="3486"><span class="lineNum">    3486 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 11 ), 0.0 ); //out of range</span></a>
<a name="3487"><span class="lineNum">    3487 </span>                :            : </a>
<a name="3488"><span class="lineNum">    3488 </span>                :<span class="lineCov">          1 :   l9.setXAt( 0, 51.0 );</span></a>
<a name="3489"><span class="lineNum">    3489 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 0 ), 51.0 );</span></a>
<a name="3490"><span class="lineNum">    3490 </span>                :<span class="lineCov">          1 :   l9.setXAt( 1, 61.0 );</span></a>
<a name="3491"><span class="lineNum">    3491 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.xAt( 1 ), 61.0 );</span></a>
<a name="3492"><span class="lineNum">    3492 </span>                :<span class="lineCov">          1 :   l9.setXAt( -1, 51.0 ); //out of range</span></a>
<a name="3493"><span class="lineNum">    3493 </span>                :<span class="lineCov">          1 :   l9.setXAt( 11, 51.0 ); //out of range</span></a>
<a name="3494"><span class="lineNum">    3494 </span>                :            : </a>
<a name="3495"><span class="lineNum">    3495 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 0 ), 2.0 );</span></a>
<a name="3496"><span class="lineNum">    3496 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 1 ), 12.0 );</span></a>
<a name="3497"><span class="lineNum">    3497 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 2 ), 22.0 );</span></a>
<a name="3498"><span class="lineNum">    3498 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( -1 ), 0.0 ); //out of range</span></a>
<a name="3499"><span class="lineNum">    3499 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 11 ), 0.0 ); //out of range</span></a>
<a name="3500"><span class="lineNum">    3500 </span>                :            : </a>
<a name="3501"><span class="lineNum">    3501 </span>                :<span class="lineCov">          1 :   l9.setYAt( 0, 52.0 );</span></a>
<a name="3502"><span class="lineNum">    3502 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 0 ), 52.0 );</span></a>
<a name="3503"><span class="lineNum">    3503 </span>                :<span class="lineCov">          1 :   l9.setYAt( 1, 62.0 );</span></a>
<a name="3504"><span class="lineNum">    3504 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.yAt( 1 ), 62.0 );</span></a>
<a name="3505"><span class="lineNum">    3505 </span>                :<span class="lineCov">          1 :   l9.setYAt( -1, 52.0 ); //out of range</span></a>
<a name="3506"><span class="lineNum">    3506 </span>                :<span class="lineCov">          1 :   l9.setYAt( 11, 52.0 ); //out of range</span></a>
<a name="3507"><span class="lineNum">    3507 </span>                :            : </a>
<a name="3508"><span class="lineNum">    3508 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.zAt( 0 ), 3.0 );</span></a>
<a name="3509"><span class="lineNum">    3509 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.zAt( 1 ), 13.0 );</span></a>
<a name="3510"><span class="lineNum">    3510 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.zAt( 2 ), 23.0 );</span></a>
<a name="3511"><span class="lineNum">    3511 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.zAt( -1 ) ) ); //out of range</span></a>
<a name="3512"><span class="lineNum">    3512 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.zAt( 11 ) ) ); //out of range</span></a>
<a name="3513"><span class="lineNum">    3513 </span>                :            : </a>
<a name="3514"><span class="lineNum">    3514 </span>                :<span class="lineCov">          1 :   l9.setZAt( 0, 53.0 );</span></a>
<a name="3515"><span class="lineNum">    3515 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.zAt( 0 ), 53.0 );</span></a>
<a name="3516"><span class="lineNum">    3516 </span>                :<span class="lineCov">          1 :   l9.setZAt( 1, 63.0 );</span></a>
<a name="3517"><span class="lineNum">    3517 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.zAt( 1 ), 63.0 );</span></a>
<a name="3518"><span class="lineNum">    3518 </span>                :<span class="lineCov">          1 :   l9.setZAt( -1, 53.0 ); //out of range</span></a>
<a name="3519"><span class="lineNum">    3519 </span>                :<span class="lineCov">          1 :   l9.setZAt( 11, 53.0 ); //out of range</span></a>
<a name="3520"><span class="lineNum">    3520 </span>                :            : </a>
<a name="3521"><span class="lineNum">    3521 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.mAt( 0 ), 4.0 );</span></a>
<a name="3522"><span class="lineNum">    3522 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.mAt( 1 ), 14.0 );</span></a>
<a name="3523"><span class="lineNum">    3523 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.mAt( 2 ), 24.0 );</span></a>
<a name="3524"><span class="lineNum">    3524 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.mAt( -1 ) ) ); //out of range</span></a>
<a name="3525"><span class="lineNum">    3525 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.mAt( 11 ) ) ); //out of range</span></a>
<a name="3526"><span class="lineNum">    3526 </span>                :            : </a>
<a name="3527"><span class="lineNum">    3527 </span>                :<span class="lineCov">          1 :   l9.setMAt( 0, 54.0 );</span></a>
<a name="3528"><span class="lineNum">    3528 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.mAt( 0 ), 54.0 );</span></a>
<a name="3529"><span class="lineNum">    3529 </span>                :<span class="lineCov">          1 :   l9.setMAt( 1, 64.0 );</span></a>
<a name="3530"><span class="lineNum">    3530 </span>                :<span class="lineCov">          1 :   QCOMPARE( l9.mAt( 1 ), 64.0 );</span></a>
<a name="3531"><span class="lineNum">    3531 </span>                :<span class="lineCov">          1 :   l9.setMAt( -1, 54.0 ); //out of range</span></a>
<a name="3532"><span class="lineNum">    3532 </span>                :<span class="lineCov">          1 :   l9.setMAt( 11, 54.0 ); //out of range</span></a>
<a name="3533"><span class="lineNum">    3533 </span>                :            : </a>
<a name="3534"><span class="lineNum">    3534 </span>                :            :   //check zAt/setZAt with non-3d linestring</a>
<a name="3535"><span class="lineNum">    3535 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 )</span></a>
<a name="3536"><span class="lineNum">    3536 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 )</span></a>
<a name="3537"><span class="lineNum">    3537 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 24 ) );</span></a>
<a name="3538"><span class="lineNum">    3538 </span>                :            : </a>
<a name="3539"><span class="lineNum">    3539 </span>                :            :   //basically we just don't want these to crash</a>
<a name="3540"><span class="lineNum">    3540 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.zAt( 0 ) ) );</span></a>
<a name="3541"><span class="lineNum">    3541 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.zAt( 1 ) ) );</span></a>
<a name="3542"><span class="lineNum">    3542 </span>                :<span class="lineCov">          1 :   l9.setZAt( 0, 53.0 );</span></a>
<a name="3543"><span class="lineNum">    3543 </span>                :<span class="lineCov">          1 :   l9.setZAt( 1, 63.0 );</span></a>
<a name="3544"><span class="lineNum">    3544 </span>                :            : </a>
<a name="3545"><span class="lineNum">    3545 </span>                :            :   //check mAt/setMAt with non-measure linestring</a>
<a name="3546"><span class="lineNum">    3546 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="3547"><span class="lineNum">    3547 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="3548"><span class="lineNum">    3548 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="3549"><span class="lineNum">    3549 </span>                :            : </a>
<a name="3550"><span class="lineNum">    3550 </span>                :            :   //basically we just don't want these to crash</a>
<a name="3551"><span class="lineNum">    3551 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.mAt( 0 ) ) );</span></a>
<a name="3552"><span class="lineNum">    3552 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( l9.mAt( 1 ) ) );</span></a>
<a name="3553"><span class="lineNum">    3553 </span>                :<span class="lineCov">          1 :   l9.setMAt( 0, 53.0 );</span></a>
<a name="3554"><span class="lineNum">    3554 </span>                :<span class="lineCov">          1 :   l9.setMAt( 1, 63.0 );</span></a>
<a name="3555"><span class="lineNum">    3555 </span>                :            : </a>
<a name="3556"><span class="lineNum">    3556 </span>                :            :   //append linestring</a>
<a name="3557"><span class="lineNum">    3557 </span>                :            : </a>
<a name="3558"><span class="lineNum">    3558 </span>                :            :   //append to empty</a>
<a name="3559"><span class="lineNum">    3559 </span>                :<span class="lineCov">          1 :   QgsLineString l10;</span></a>
<a name="3560"><span class="lineNum">    3560 </span>                :<span class="lineCov">          1 :   l10.append( nullptr );</span></a>
<a name="3561"><span class="lineNum">    3561 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.isEmpty() );</span></a>
<a name="3562"><span class="lineNum">    3562 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 0 );</span></a>
<a name="3563"><span class="lineNum">    3563 </span>                :            : </a>
<a name="3564"><span class="lineNum">    3564 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsLineString&gt; toAppend( new QgsLineString() );</span></a>
<a name="3565"><span class="lineNum">    3565 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="3566"><span class="lineNum">    3566 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 11, 12 )</span></a>
<a name="3567"><span class="lineNum">    3567 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="3568"><span class="lineNum">    3568 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3569"><span class="lineNum">    3569 </span>                :<span class="lineCov">          1 :   QVERIFY( !l10.is3D() );</span></a>
<a name="3570"><span class="lineNum">    3570 </span>                :<span class="lineCov">          1 :   QVERIFY( !l10.isMeasure() );</span></a>
<a name="3571"><span class="lineNum">    3571 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 3 );</span></a>
<a name="3572"><span class="lineNum">    3572 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.vertexCount(), 3 );</span></a>
<a name="3573"><span class="lineNum">    3573 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.nCoordinates(), 3 );</span></a>
<a name="3574"><span class="lineNum">    3574 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.ringCount(), 1 );</span></a>
<a name="3575"><span class="lineNum">    3575 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.partCount(), 1 );</span></a>
<a name="3576"><span class="lineNum">    3576 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3577"><span class="lineNum">    3577 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), toAppend-&gt;pointN( 0 ) );</span></a>
<a name="3578"><span class="lineNum">    3578 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), toAppend-&gt;pointN( 1 ) );</span></a>
<a name="3579"><span class="lineNum">    3579 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 2 ), toAppend-&gt;pointN( 2 ) );</span></a>
<a name="3580"><span class="lineNum">    3580 </span>                :            : </a>
<a name="3581"><span class="lineNum">    3581 </span>                :            :   //add more points</a>
<a name="3582"><span class="lineNum">    3582 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3583"><span class="lineNum">    3583 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 31, 32 )</span></a>
<a name="3584"><span class="lineNum">    3584 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 41, 42 )</span></a>
<a name="3585"><span class="lineNum">    3585 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 51, 52 ) );</span></a>
<a name="3586"><span class="lineNum">    3586 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3587"><span class="lineNum">    3587 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 6 );</span></a>
<a name="3588"><span class="lineNum">    3588 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.vertexCount(), 6 );</span></a>
<a name="3589"><span class="lineNum">    3589 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.nCoordinates(), 6 );</span></a>
<a name="3590"><span class="lineNum">    3590 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.ringCount(), 1 );</span></a>
<a name="3591"><span class="lineNum">    3591 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.partCount(), 1 );</span></a>
<a name="3592"><span class="lineNum">    3592 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 3 ), toAppend-&gt;pointN( 0 ) );</span></a>
<a name="3593"><span class="lineNum">    3593 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 4 ), toAppend-&gt;pointN( 1 ) );</span></a>
<a name="3594"><span class="lineNum">    3594 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 5 ), toAppend-&gt;pointN( 2 ) );</span></a>
<a name="3595"><span class="lineNum">    3595 </span>                :            : </a>
<a name="3596"><span class="lineNum">    3596 </span>                :            :   //check dimensionality is inherited from append line if initially empty</a>
<a name="3597"><span class="lineNum">    3597 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3598"><span class="lineNum">    3598 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3599"><span class="lineNum">    3599 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 32, 33, 34 )</span></a>
<a name="3600"><span class="lineNum">    3600 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 41, 42, 43, 44 )</span></a>
<a name="3601"><span class="lineNum">    3601 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 51, 52, 53, 54 ) );</span></a>
<a name="3602"><span class="lineNum">    3602 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3603"><span class="lineNum">    3603 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.is3D() );</span></a>
<a name="3604"><span class="lineNum">    3604 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.isMeasure() );</span></a>
<a name="3605"><span class="lineNum">    3605 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 3 );</span></a>
<a name="3606"><span class="lineNum">    3606 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.ringCount(), 1 );</span></a>
<a name="3607"><span class="lineNum">    3607 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.partCount(), 1 );</span></a>
<a name="3608"><span class="lineNum">    3608 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3609"><span class="lineNum">    3609 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), toAppend-&gt;pointN( 0 ) );</span></a>
<a name="3610"><span class="lineNum">    3610 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), toAppend-&gt;pointN( 1 ) );</span></a>
<a name="3611"><span class="lineNum">    3611 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 2 ), toAppend-&gt;pointN( 2 ) );</span></a>
<a name="3612"><span class="lineNum">    3612 </span>                :            : </a>
<a name="3613"><span class="lineNum">    3613 </span>                :            :   //append points with z to non z linestring</a>
<a name="3614"><span class="lineNum">    3614 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3615"><span class="lineNum">    3615 </span>                :<span class="lineCov">          1 :   l10.addVertex( QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="3616"><span class="lineNum">    3616 </span>                :<span class="lineCov">          1 :   QVERIFY( !l10.is3D() );</span></a>
<a name="3617"><span class="lineNum">    3617 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3618"><span class="lineNum">    3618 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3619"><span class="lineNum">    3619 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 32, 33, 34 )</span></a>
<a name="3620"><span class="lineNum">    3620 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 41, 42, 43, 44 )</span></a>
<a name="3621"><span class="lineNum">    3621 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 51, 52, 53, 54 ) );</span></a>
<a name="3622"><span class="lineNum">    3622 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3623"><span class="lineNum">    3623 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3624"><span class="lineNum">    3624 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="3625"><span class="lineNum">    3625 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), QgsPoint( 31, 32 ) );</span></a>
<a name="3626"><span class="lineNum">    3626 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 2 ), QgsPoint( 41, 42 ) );</span></a>
<a name="3627"><span class="lineNum">    3627 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 3 ), QgsPoint( 51, 52 ) );</span></a>
<a name="3628"><span class="lineNum">    3628 </span>                :            : </a>
<a name="3629"><span class="lineNum">    3629 </span>                :            :   //append points without z/m to linestring with z &amp; m</a>
<a name="3630"><span class="lineNum">    3630 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3631"><span class="lineNum">    3631 </span>                :<span class="lineCov">          1 :   l10.addVertex( QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="3632"><span class="lineNum">    3632 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.is3D() );</span></a>
<a name="3633"><span class="lineNum">    3633 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.isMeasure() );</span></a>
<a name="3634"><span class="lineNum">    3634 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3635"><span class="lineNum">    3635 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3636"><span class="lineNum">    3636 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 31, 32 )</span></a>
<a name="3637"><span class="lineNum">    3637 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 41, 42 )</span></a>
<a name="3638"><span class="lineNum">    3638 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 51, 52 ) );</span></a>
<a name="3639"><span class="lineNum">    3639 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3640"><span class="lineNum">    3640 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3641"><span class="lineNum">    3641 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="3642"><span class="lineNum">    3642 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 31, 32 ) );</span></a>
<a name="3643"><span class="lineNum">    3643 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 41, 42 ) );</span></a>
<a name="3644"><span class="lineNum">    3644 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 3 ), QgsPoint( QgsWkbTypes::PointZM, 51, 52 ) );</span></a>
<a name="3645"><span class="lineNum">    3645 </span>                :            : </a>
<a name="3646"><span class="lineNum">    3646 </span>                :            :   //25d append</a>
<a name="3647"><span class="lineNum">    3647 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3648"><span class="lineNum">    3648 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3649"><span class="lineNum">    3649 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 31, 32, 33 )</span></a>
<a name="3650"><span class="lineNum">    3650 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 41, 42, 43 ) );</span></a>
<a name="3651"><span class="lineNum">    3651 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3652"><span class="lineNum">    3652 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.is3D() );</span></a>
<a name="3653"><span class="lineNum">    3653 </span>                :<span class="lineCov">          1 :   QVERIFY( !l10.isMeasure() );</span></a>
<a name="3654"><span class="lineNum">    3654 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3655"><span class="lineNum">    3655 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 31, 32, 33 ) );</span></a>
<a name="3656"><span class="lineNum">    3656 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), QgsPoint( QgsWkbTypes::Point25D, 41, 42, 43 ) );</span></a>
<a name="3657"><span class="lineNum">    3657 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3658"><span class="lineNum">    3658 </span>                :<span class="lineCov">          1 :   l10.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 33 ) );</span></a>
<a name="3659"><span class="lineNum">    3659 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3660"><span class="lineNum">    3660 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3661"><span class="lineNum">    3661 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.is3D() );</span></a>
<a name="3662"><span class="lineNum">    3662 </span>                :<span class="lineCov">          1 :   QVERIFY( !l10.isMeasure() );</span></a>
<a name="3663"><span class="lineNum">    3663 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="3664"><span class="lineNum">    3664 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 11, 12, 33 ) );</span></a>
<a name="3665"><span class="lineNum">    3665 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 1 ), QgsPoint( QgsWkbTypes::Point25D, 31, 32, 33 ) );</span></a>
<a name="3666"><span class="lineNum">    3666 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.pointN( 2 ), QgsPoint( QgsWkbTypes::Point25D, 41, 42, 43 ) );</span></a>
<a name="3667"><span class="lineNum">    3667 </span>                :            : </a>
<a name="3668"><span class="lineNum">    3668 </span>                :            :   //append another line the closes the original geometry.</a>
<a name="3669"><span class="lineNum">    3669 </span>                :            :   //Make sure there are not duplicit points except start and end point</a>
<a name="3670"><span class="lineNum">    3670 </span>                :<span class="lineCov">          1 :   l10.clear();</span></a>
<a name="3671"><span class="lineNum">    3671 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3672"><span class="lineNum">    3672 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence()</span></a>
<a name="3673"><span class="lineNum">    3673 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 1, 1 )</span></a>
<a name="3674"><span class="lineNum">    3674 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="3675"><span class="lineNum">    3675 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 10, 1 ) );</span></a>
<a name="3676"><span class="lineNum">    3676 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3677"><span class="lineNum">    3677 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 3 );</span></a>
<a name="3678"><span class="lineNum">    3678 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.vertexCount(), 3 );</span></a>
<a name="3679"><span class="lineNum">    3679 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="3680"><span class="lineNum">    3680 </span>                :<span class="lineCov">          2 :   toAppend-&gt;setPoints( QgsPointSequence()</span></a>
<a name="3681"><span class="lineNum">    3681 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 10, 1 )</span></a>
<a name="3682"><span class="lineNum">    3682 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="3683"><span class="lineNum">    3683 </span>                :<span class="lineCov">          1 :   l10.append( toAppend.get() );</span></a>
<a name="3684"><span class="lineNum">    3684 </span>                :            : </a>
<a name="3685"><span class="lineNum">    3685 </span>                :<span class="lineCov">          1 :   QVERIFY( l10.isClosed() );</span></a>
<a name="3686"><span class="lineNum">    3686 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.numPoints(), 4 );</span></a>
<a name="3687"><span class="lineNum">    3687 </span>                :<span class="lineCov">          1 :   QCOMPARE( l10.vertexCount(), 4 );</span></a>
<a name="3688"><span class="lineNum">    3688 </span>                :            : </a>
<a name="3689"><span class="lineNum">    3689 </span>                :            :   //equality</a>
<a name="3690"><span class="lineNum">    3690 </span>                :<span class="lineCov">          1 :   QgsLineString e1;</span></a>
<a name="3691"><span class="lineNum">    3691 </span>                :<span class="lineCov">          1 :   QgsLineString e2;</span></a>
<a name="3692"><span class="lineNum">    3692 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="3693"><span class="lineNum">    3693 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="3694"><span class="lineNum">    3694 </span>                :<span class="lineCov">          1 :   e1.addVertex( QgsPoint( 1, 2 ) );</span></a>
<a name="3695"><span class="lineNum">    3695 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different number of vertices</span></a>
<a name="3696"><span class="lineNum">    3696 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="3697"><span class="lineNum">    3697 </span>                :<span class="lineCov">          1 :   e2.addVertex( QgsPoint( 1, 2 ) );</span></a>
<a name="3698"><span class="lineNum">    3698 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="3699"><span class="lineNum">    3699 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="3700"><span class="lineNum">    3700 </span>                :<span class="lineCov">          1 :   e1.addVertex( QgsPoint( 1 / 3.0, 4 / 3.0 ) );</span></a>
<a name="3701"><span class="lineNum">    3701 </span>                :<span class="lineCov">          1 :   e2.addVertex( QgsPoint( 2 / 6.0, 8 / 6.0 ) );</span></a>
<a name="3702"><span class="lineNum">    3702 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 ); //check non-integer equality</span></a>
<a name="3703"><span class="lineNum">    3703 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="3704"><span class="lineNum">    3704 </span>                :<span class="lineCov">          1 :   e1.addVertex( QgsPoint( 7, 8 ) );</span></a>
<a name="3705"><span class="lineNum">    3705 </span>                :<span class="lineCov">          1 :   e2.addVertex( QgsPoint( 6, 9 ) );</span></a>
<a name="3706"><span class="lineNum">    3706 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different coordinates</span></a>
<a name="3707"><span class="lineNum">    3707 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="3708"><span class="lineNum">    3708 </span>                :<span class="lineCov">          1 :   QgsLineString e3;</span></a>
<a name="3709"><span class="lineNum">    3709 </span>                :<span class="lineCov">          2 :   e3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 0 )</span></a>
<a name="3710"><span class="lineNum">    3710 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 0 )</span></a>
<a name="3711"><span class="lineNum">    3711 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 0 ) );</span></a>
<a name="3712"><span class="lineNum">    3712 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e3 ) ); //different dimension</span></a>
<a name="3713"><span class="lineNum">    3713 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e3 );</span></a>
<a name="3714"><span class="lineNum">    3714 </span>                :<span class="lineCov">          1 :   QgsLineString e4;</span></a>
<a name="3715"><span class="lineNum">    3715 </span>                :<span class="lineCov">          2 :   e4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 )</span></a>
<a name="3716"><span class="lineNum">    3716 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 3 )</span></a>
<a name="3717"><span class="lineNum">    3717 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 4 ) );</span></a>
<a name="3718"><span class="lineNum">    3718 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e3 == e4 ) ); //different z coordinates</span></a>
<a name="3719"><span class="lineNum">    3719 </span>                :<span class="lineCov">          1 :   QVERIFY( e3 != e4 );</span></a>
<a name="3720"><span class="lineNum">    3720 </span>                :<span class="lineCov">          1 :   QgsLineString e5;</span></a>
<a name="3721"><span class="lineNum">    3721 </span>                :<span class="lineCov">          2 :   e5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 1 )</span></a>
<a name="3722"><span class="lineNum">    3722 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 2 )</span></a>
<a name="3723"><span class="lineNum">    3723 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 3 ) );</span></a>
<a name="3724"><span class="lineNum">    3724 </span>                :<span class="lineCov">          1 :   QgsLineString e6;</span></a>
<a name="3725"><span class="lineNum">    3725 </span>                :<span class="lineCov">          2 :   e6.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 11 )</span></a>
<a name="3726"><span class="lineNum">    3726 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 12 )</span></a>
<a name="3727"><span class="lineNum">    3727 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 13 ) );</span></a>
<a name="3728"><span class="lineNum">    3728 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e5 == e6 ) ); //different m values</span></a>
<a name="3729"><span class="lineNum">    3729 </span>                :<span class="lineCov">          1 :   QVERIFY( e5 != e6 );</span></a>
<a name="3730"><span class="lineNum">    3730 </span>                :            : </a>
<a name="3731"><span class="lineNum">    3731 </span>                :<span class="lineCov">          1 :   QVERIFY( e6 != QgsCircularString() );</span></a>
<a name="3732"><span class="lineNum">    3732 </span>                :<span class="lineCov">          1 :   QgsPoint p1;</span></a>
<a name="3733"><span class="lineNum">    3733 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e6 == p1 ) );</span></a>
<a name="3734"><span class="lineNum">    3734 </span>                :<span class="lineCov">          1 :   QVERIFY( e6 != p1 );</span></a>
<a name="3735"><span class="lineNum">    3735 </span>                :<span class="lineCov">          1 :   QVERIFY( e6 == e6 );</span></a>
<a name="3736"><span class="lineNum">    3736 </span>                :            : </a>
<a name="3737"><span class="lineNum">    3737 </span>                :            :   //close/isClosed</a>
<a name="3738"><span class="lineNum">    3738 </span>                :<span class="lineCov">          1 :   QgsLineString l11;</span></a>
<a name="3739"><span class="lineNum">    3739 </span>                :<span class="lineCov">          1 :   QVERIFY( !l11.isClosed() );</span></a>
<a name="3740"><span class="lineNum">    3740 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="3741"><span class="lineNum">    3741 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="3742"><span class="lineNum">    3742 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="3743"><span class="lineNum">    3743 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="3744"><span class="lineNum">    3744 </span>                :<span class="lineCov">          1 :   QVERIFY( !l11.isClosed() );</span></a>
<a name="3745"><span class="lineNum">    3745 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.numPoints(), 4 );</span></a>
<a name="3746"><span class="lineNum">    3746 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.area(), 0.0 );</span></a>
<a name="3747"><span class="lineNum">    3747 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.perimeter(), 0.0 );</span></a>
<a name="3748"><span class="lineNum">    3748 </span>                :<span class="lineCov">          1 :   l11.close();</span></a>
<a name="3749"><span class="lineNum">    3749 </span>                :<span class="lineCov">          1 :   QVERIFY( l11.isClosed() );</span></a>
<a name="3750"><span class="lineNum">    3750 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.numPoints(), 5 );</span></a>
<a name="3751"><span class="lineNum">    3751 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.vertexCount(), 5 );</span></a>
<a name="3752"><span class="lineNum">    3752 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.nCoordinates(), 5 );</span></a>
<a name="3753"><span class="lineNum">    3753 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.ringCount(), 1 );</span></a>
<a name="3754"><span class="lineNum">    3754 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.partCount(), 1 );</span></a>
<a name="3755"><span class="lineNum">    3755 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.pointN( 4 ), QgsPoint( 1, 2 ) );</span></a>
<a name="3756"><span class="lineNum">    3756 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.area(), 0.0 );</span></a>
<a name="3757"><span class="lineNum">    3757 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.perimeter(), 0.0 );</span></a>
<a name="3758"><span class="lineNum">    3758 </span>                :            :   //try closing already closed line, should be no change</a>
<a name="3759"><span class="lineNum">    3759 </span>                :<span class="lineCov">          1 :   l11.close();</span></a>
<a name="3760"><span class="lineNum">    3760 </span>                :<span class="lineCov">          1 :   QVERIFY( l11.isClosed() );</span></a>
<a name="3761"><span class="lineNum">    3761 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.numPoints(), 5 );</span></a>
<a name="3762"><span class="lineNum">    3762 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.pointN( 4 ), QgsPoint( 1, 2 ) );</span></a>
<a name="3763"><span class="lineNum">    3763 </span>                :            : </a>
<a name="3764"><span class="lineNum">    3764 </span>                :            :   // tiny differences</a>
<a name="3765"><span class="lineNum">    3765 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.000000000000001, 0.000000000000002 )</span></a>
<a name="3766"><span class="lineNum">    3766 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 0.000000000000011, 0.000000000000002 )</span></a>
<a name="3767"><span class="lineNum">    3767 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 0.000000000000011, 0.000000000000022 )</span></a>
<a name="3768"><span class="lineNum">    3768 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 0.000000000000001, 0.000000000000022 ) );</span></a>
<a name="3769"><span class="lineNum">    3769 </span>                :<span class="lineCov">          1 :   QVERIFY( !l11.isClosed() );</span></a>
<a name="3770"><span class="lineNum">    3770 </span>                :<span class="lineCov">          1 :   l11.close();</span></a>
<a name="3771"><span class="lineNum">    3771 </span>                :<span class="lineCov">          1 :   QVERIFY( l11.isClosed() );</span></a>
<a name="3772"><span class="lineNum">    3772 </span>                :<span class="lineCov">          1 :   QCOMPARE( l11.numPoints(), 5 );</span></a>
<a name="3773"><span class="lineNum">    3773 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l11.pointN( 4 ).x(), 0.000000000000001, 0.00000000000000001 );</span></a>
<a name="3774"><span class="lineNum">    3774 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l11.pointN( 4 ).y(), 0.000000000000002, 0.00000000000000001 );</span></a>
<a name="3775"><span class="lineNum">    3775 </span>                :            : </a>
<a name="3776"><span class="lineNum">    3776 </span>                :            :   //test that m values aren't considered when testing for closedness</a>
<a name="3777"><span class="lineNum">    3777 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 )</span></a>
<a name="3778"><span class="lineNum">    3778 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 2, 0, 4 )</span></a>
<a name="3779"><span class="lineNum">    3779 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 22, 0, 5 )</span></a>
<a name="3780"><span class="lineNum">    3780 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 6 ) );</span></a>
<a name="3781"><span class="lineNum">    3781 </span>                :<span class="lineCov">          1 :   QVERIFY( l11.isClosed() );</span></a>
<a name="3782"><span class="lineNum">    3782 </span>                :            : </a>
<a name="3783"><span class="lineNum">    3783 </span>                :            :   //close with z and m</a>
<a name="3784"><span class="lineNum">    3784 </span>                :<span class="lineCov">          1 :   QgsLineString l12;</span></a>
<a name="3785"><span class="lineNum">    3785 </span>                :<span class="lineCov">          2 :   l12.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3786"><span class="lineNum">    3786 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="3787"><span class="lineNum">    3787 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="3788"><span class="lineNum">    3788 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="3789"><span class="lineNum">    3789 </span>                :<span class="lineCov">          1 :   l12.close();</span></a>
<a name="3790"><span class="lineNum">    3790 </span>                :<span class="lineCov">          1 :   QCOMPARE( l12.pointN( 4 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="3791"><span class="lineNum">    3791 </span>                :            : </a>
<a name="3792"><span class="lineNum">    3792 </span>                :            : </a>
<a name="3793"><span class="lineNum">    3793 </span>                :            :   //polygonf</a>
<a name="3794"><span class="lineNum">    3794 </span>                :<span class="lineCov">          1 :   QgsLineString l13;</span></a>
<a name="3795"><span class="lineNum">    3795 </span>                :<span class="lineCov">          2 :   l13.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3796"><span class="lineNum">    3796 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="3797"><span class="lineNum">    3797 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="3798"><span class="lineNum">    3798 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="3799"><span class="lineNum">    3799 </span>                :            : </a>
<a name="3800"><span class="lineNum">    3800 </span>                :<span class="lineCov">          1 :   QPolygonF poly = l13.asQPolygonF();</span></a>
<a name="3801"><span class="lineNum">    3801 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.count(), 4 );</span></a>
<a name="3802"><span class="lineNum">    3802 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).x(), 1.0 );</span></a>
<a name="3803"><span class="lineNum">    3803 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).y(), 2.0 );</span></a>
<a name="3804"><span class="lineNum">    3804 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 1 ).x(), 11.0 );</span></a>
<a name="3805"><span class="lineNum">    3805 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 1 ).y(), 2.0 );</span></a>
<a name="3806"><span class="lineNum">    3806 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 2 ).x(), 11.0 );</span></a>
<a name="3807"><span class="lineNum">    3807 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 2 ).y(), 22.0 );</span></a>
<a name="3808"><span class="lineNum">    3808 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 3 ).x(), 1.0 );</span></a>
<a name="3809"><span class="lineNum">    3809 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 3 ).y(), 22.0 );</span></a>
<a name="3810"><span class="lineNum">    3810 </span>                :            : </a>
<a name="3811"><span class="lineNum">    3811 </span>                :            :   // clone tests. At the same time, check segmentize as the result should</a>
<a name="3812"><span class="lineNum">    3812 </span>                :            :   // be equal to a clone for LineStrings</a>
<a name="3813"><span class="lineNum">    3813 </span>                :<span class="lineCov">          1 :   QgsLineString l14;</span></a>
<a name="3814"><span class="lineNum">    3814 </span>                :<span class="lineCov">          2 :   l14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="3815"><span class="lineNum">    3815 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="3816"><span class="lineNum">    3816 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="3817"><span class="lineNum">    3817 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="3818"><span class="lineNum">    3818 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsLineString&gt; cloned( l14.clone() );</span></a>
<a name="3819"><span class="lineNum">    3819 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 4 );</span></a>
<a name="3820"><span class="lineNum">    3820 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;vertexCount(), 4 );</span></a>
<a name="3821"><span class="lineNum">    3821 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;ringCount(), 1 );</span></a>
<a name="3822"><span class="lineNum">    3822 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;partCount(), 1 );</span></a>
<a name="3823"><span class="lineNum">    3823 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3824"><span class="lineNum">    3824 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;is3D() );</span></a>
<a name="3825"><span class="lineNum">    3825 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;isMeasure() );</span></a>
<a name="3826"><span class="lineNum">    3826 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="3827"><span class="lineNum">    3827 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="3828"><span class="lineNum">    3828 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="3829"><span class="lineNum">    3829 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="3830"><span class="lineNum">    3830 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; segmentized( static_cast&lt; QgsLineString * &gt;( l14.segmentize() ) );</span></a>
<a name="3831"><span class="lineNum">    3831 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 4 );</span></a>
<a name="3832"><span class="lineNum">    3832 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3833"><span class="lineNum">    3833 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="3834"><span class="lineNum">    3834 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="3835"><span class="lineNum">    3835 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="3836"><span class="lineNum">    3836 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="3837"><span class="lineNum">    3837 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="3838"><span class="lineNum">    3838 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="3839"><span class="lineNum">    3839 </span>                :            : </a>
<a name="3840"><span class="lineNum">    3840 </span>                :            :   //clone with Z/M</a>
<a name="3841"><span class="lineNum">    3841 </span>                :<span class="lineCov">          2 :   l14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3842"><span class="lineNum">    3842 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="3843"><span class="lineNum">    3843 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="3844"><span class="lineNum">    3844 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="3845"><span class="lineNum">    3845 </span>                :<span class="lineCov">          1 :   cloned.reset( l14.clone() );</span></a>
<a name="3846"><span class="lineNum">    3846 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 4 );</span></a>
<a name="3847"><span class="lineNum">    3847 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3848"><span class="lineNum">    3848 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;is3D() );</span></a>
<a name="3849"><span class="lineNum">    3849 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isMeasure() );</span></a>
<a name="3850"><span class="lineNum">    3850 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="3851"><span class="lineNum">    3851 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="3852"><span class="lineNum">    3852 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="3853"><span class="lineNum">    3853 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="3854"><span class="lineNum">    3854 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( l14.segmentize() ) );</span></a>
<a name="3855"><span class="lineNum">    3855 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 4 );</span></a>
<a name="3856"><span class="lineNum">    3856 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3857"><span class="lineNum">    3857 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="3858"><span class="lineNum">    3858 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="3859"><span class="lineNum">    3859 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), l14.pointN( 0 ) );</span></a>
<a name="3860"><span class="lineNum">    3860 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 1 ), l14.pointN( 1 ) );</span></a>
<a name="3861"><span class="lineNum">    3861 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 2 ), l14.pointN( 2 ) );</span></a>
<a name="3862"><span class="lineNum">    3862 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 3 ), l14.pointN( 3 ) );</span></a>
<a name="3863"><span class="lineNum">    3863 </span>                :            : </a>
<a name="3864"><span class="lineNum">    3864 </span>                :            :   //clone an empty line</a>
<a name="3865"><span class="lineNum">    3865 </span>                :<span class="lineCov">          1 :   l14.clear();</span></a>
<a name="3866"><span class="lineNum">    3866 </span>                :<span class="lineCov">          1 :   cloned.reset( l14.clone() );</span></a>
<a name="3867"><span class="lineNum">    3867 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="3868"><span class="lineNum">    3868 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 0 );</span></a>
<a name="3869"><span class="lineNum">    3869 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;is3D() );</span></a>
<a name="3870"><span class="lineNum">    3870 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;isMeasure() );</span></a>
<a name="3871"><span class="lineNum">    3871 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3872"><span class="lineNum">    3872 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( l14.segmentize() ) );</span></a>
<a name="3873"><span class="lineNum">    3873 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isEmpty() );</span></a>
<a name="3874"><span class="lineNum">    3874 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 0 );</span></a>
<a name="3875"><span class="lineNum">    3875 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="3876"><span class="lineNum">    3876 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="3877"><span class="lineNum">    3877 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3878"><span class="lineNum">    3878 </span>                :            : </a>
<a name="3879"><span class="lineNum">    3879 </span>                :            :   //to/from WKB</a>
<a name="3880"><span class="lineNum">    3880 </span>                :<span class="lineCov">          1 :   QgsLineString l15;</span></a>
<a name="3881"><span class="lineNum">    3881 </span>                :<span class="lineCov">          2 :   l15.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3882"><span class="lineNum">    3882 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="3883"><span class="lineNum">    3883 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="3884"><span class="lineNum">    3884 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="3885"><span class="lineNum">    3885 </span>                :<span class="lineCov">          1 :   QByteArray wkb15 = l15.asWkb();</span></a>
<a name="3886"><span class="lineNum">    3886 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb15.size(), l15.wkbSize() );</span></a>
<a name="3887"><span class="lineNum">    3887 </span>                :<span class="lineCov">          1 :   QgsLineString l16;</span></a>
<a name="3888"><span class="lineNum">    3888 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb15ptr( wkb15 );</span></a>
<a name="3889"><span class="lineNum">    3889 </span>                :<span class="lineCov">          1 :   l16.fromWkb( wkb15ptr );</span></a>
<a name="3890"><span class="lineNum">    3890 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.numPoints(), 4 );</span></a>
<a name="3891"><span class="lineNum">    3891 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.vertexCount(), 4 );</span></a>
<a name="3892"><span class="lineNum">    3892 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.nCoordinates(), 4 );</span></a>
<a name="3893"><span class="lineNum">    3893 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.ringCount(), 1 );</span></a>
<a name="3894"><span class="lineNum">    3894 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.partCount(), 1 );</span></a>
<a name="3895"><span class="lineNum">    3895 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3896"><span class="lineNum">    3896 </span>                :<span class="lineCov">          1 :   QVERIFY( l16.is3D() );</span></a>
<a name="3897"><span class="lineNum">    3897 </span>                :<span class="lineCov">          1 :   QVERIFY( l16.isMeasure() );</span></a>
<a name="3898"><span class="lineNum">    3898 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 0 ), l15.pointN( 0 ) );</span></a>
<a name="3899"><span class="lineNum">    3899 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 1 ), l15.pointN( 1 ) );</span></a>
<a name="3900"><span class="lineNum">    3900 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 2 ), l15.pointN( 2 ) );</span></a>
<a name="3901"><span class="lineNum">    3901 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.pointN( 3 ), l15.pointN( 3 ) );</span></a>
<a name="3902"><span class="lineNum">    3902 </span>                :            : </a>
<a name="3903"><span class="lineNum">    3903 </span>                :            :   //bad WKB - check for no crash</a>
<a name="3904"><span class="lineNum">    3904 </span>                :<span class="lineCov">          1 :   l16.clear();</span></a>
<a name="3905"><span class="lineNum">    3905 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="3906"><span class="lineNum">    3906 </span>                :<span class="lineCov">          1 :   QVERIFY( !l16.fromWkb( nullPtr ) );</span></a>
<a name="3907"><span class="lineNum">    3907 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3908"><span class="lineNum">    3908 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="3909"><span class="lineNum">    3909 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = point.asWkb();</span></a>
<a name="3910"><span class="lineNum">    3910 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="3911"><span class="lineNum">    3911 </span>                :<span class="lineCov">          1 :   QVERIFY( !l16.fromWkb( wkb16ptr ) );</span></a>
<a name="3912"><span class="lineNum">    3912 </span>                :<span class="lineCov">          1 :   QCOMPARE( l16.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3913"><span class="lineNum">    3913 </span>                :            : </a>
<a name="3914"><span class="lineNum">    3914 </span>                :            :   //to/from WKT</a>
<a name="3915"><span class="lineNum">    3915 </span>                :<span class="lineCov">          1 :   QgsLineString l17;</span></a>
<a name="3916"><span class="lineNum">    3916 </span>                :<span class="lineCov">          2 :   l17.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="3917"><span class="lineNum">    3917 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="3918"><span class="lineNum">    3918 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="3919"><span class="lineNum">    3919 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="3920"><span class="lineNum">    3920 </span>                :            : </a>
<a name="3921"><span class="lineNum">    3921 </span>                :<span class="lineCov">          1 :   QString wkt = l17.asWkt();</span></a>
<a name="3922"><span class="lineNum">    3922 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="3923"><span class="lineNum">    3923 </span>                :<span class="lineCov">          1 :   QgsLineString l18;</span></a>
<a name="3924"><span class="lineNum">    3924 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.fromWkt( wkt ) );</span></a>
<a name="3925"><span class="lineNum">    3925 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.numPoints(), 4 );</span></a>
<a name="3926"><span class="lineNum">    3926 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="3927"><span class="lineNum">    3927 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.is3D() );</span></a>
<a name="3928"><span class="lineNum">    3928 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.isMeasure() );</span></a>
<a name="3929"><span class="lineNum">    3929 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 0 ), l17.pointN( 0 ) );</span></a>
<a name="3930"><span class="lineNum">    3930 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 1 ), l17.pointN( 1 ) );</span></a>
<a name="3931"><span class="lineNum">    3931 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 2 ), l17.pointN( 2 ) );</span></a>
<a name="3932"><span class="lineNum">    3932 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.pointN( 3 ), l17.pointN( 3 ) );</span></a>
<a name="3933"><span class="lineNum">    3933 </span>                :            : </a>
<a name="3934"><span class="lineNum">    3934 </span>                :            :   //bad WKT</a>
<a name="3935"><span class="lineNum">    3935 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.fromWkt( &quot;Polygon()&quot; ) );</span></a>
<a name="3936"><span class="lineNum">    3936 </span>                :<span class="lineCov">          1 :   QVERIFY( l18.isEmpty() );</span></a>
<a name="3937"><span class="lineNum">    3937 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.numPoints(), 0 );</span></a>
<a name="3938"><span class="lineNum">    3938 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.is3D() );</span></a>
<a name="3939"><span class="lineNum">    3939 </span>                :<span class="lineCov">          1 :   QVERIFY( !l18.isMeasure() );</span></a>
<a name="3940"><span class="lineNum">    3940 </span>                :<span class="lineCov">          1 :   QCOMPARE( l18.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="3941"><span class="lineNum">    3941 </span>                :            : </a>
<a name="3942"><span class="lineNum">    3942 </span>                :            :   //asGML2</a>
<a name="3943"><span class="lineNum">    3943 </span>                :<span class="lineCov">          1 :   QgsLineString exportLine;</span></a>
<a name="3944"><span class="lineNum">    3944 </span>                :<span class="lineCov">          2 :   exportLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 31, 32 )</span></a>
<a name="3945"><span class="lineNum">    3945 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 41, 42 )</span></a>
<a name="3946"><span class="lineNum">    3946 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 51, 52 ) );</span></a>
<a name="3947"><span class="lineNum">    3947 </span>                :<span class="lineCov">          1 :   QgsLineString exportLineFloat;</span></a>
<a name="3948"><span class="lineNum">    3948 </span>                :<span class="lineCov">          2 :   exportLineFloat.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1 / 3.0, 2 / 3.0 )</span></a>
<a name="3949"><span class="lineNum">    3949 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 1 + 1 / 3.0, 1 + 2 / 3.0 )</span></a>
<a name="3950"><span class="lineNum">    3950 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 2 + 1 / 3.0, 2 + 2 / 3.0 ) );</span></a>
<a name="3951"><span class="lineNum">    3951 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="3952"><span class="lineNum">    3952 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;31,32 41,42 51,52&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3953"><span class="lineNum">    3953 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportLine.asGml2( doc ) ), expectedGML2 );</span></a>
<a name="3954"><span class="lineNum">    3954 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.333,0.667 1.333,1.667 2.333,2.667&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3955"><span class="lineNum">    3955 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportLineFloat.asGml2( doc, 3 ) ), expectedGML2prec3 );</span></a>
<a name="3956"><span class="lineNum">    3956 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="3957"><span class="lineNum">    3957 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsLineString().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="3958"><span class="lineNum">    3958 </span>                :            : </a>
<a name="3959"><span class="lineNum">    3959 </span>                :            :   //asGML3</a>
<a name="3960"><span class="lineNum">    3960 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;31 32 41 42 51 52&lt;/posList&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3961"><span class="lineNum">    3961 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportLine.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="3962"><span class="lineNum">    3962 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.333 0.667 1.333 1.667 2.333 2.667&lt;/posList&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3963"><span class="lineNum">    3963 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportLineFloat.asGml3( doc, 3 ) ), expectedGML3prec3 );</span></a>
<a name="3964"><span class="lineNum">    3964 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="3965"><span class="lineNum">    3965 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsLineString().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="3966"><span class="lineNum">    3966 </span>                :            : </a>
<a name="3967"><span class="lineNum">    3967 </span>                :            :   //asJSON</a>
<a name="3968"><span class="lineNum">    3968 </span>                :<span class="lineCov">          1 :   QString expectedJson( &quot;{\&quot;coordinates\&quot;:[[31.0,32.0],[41.0,42.0],[51.0,52.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="3969"><span class="lineNum">    3969 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLine.asJson(), expectedJson );</span></a>
<a name="3970"><span class="lineNum">    3970 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[0.333,0.667],[1.333,1.667],[2.333,2.667]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="3971"><span class="lineNum">    3971 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLineFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="3972"><span class="lineNum">    3972 </span>                :            : </a>
<a name="3973"><span class="lineNum">    3973 </span>                :            :   //asKML</a>
<a name="3974"><span class="lineNum">    3974 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;31,32,0 41,42,0 51,52,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3975"><span class="lineNum">    3975 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLine.asKml(), expectedKml );</span></a>
<a name="3976"><span class="lineNum">    3976 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.333,0.667,0 1.333,1.667,0 2.333,2.667,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="3977"><span class="lineNum">    3977 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportLineFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="3978"><span class="lineNum">    3978 </span>                :            : </a>
<a name="3979"><span class="lineNum">    3979 </span>                :            :   //length</a>
<a name="3980"><span class="lineNum">    3980 </span>                :<span class="lineCov">          1 :   QgsLineString l19;</span></a>
<a name="3981"><span class="lineNum">    3981 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length(), 0.0 );</span></a>
<a name="3982"><span class="lineNum">    3982 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="3983"><span class="lineNum">    3983 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="3984"><span class="lineNum">    3984 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="3985"><span class="lineNum">    3985 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length(), 23.0 );</span></a>
<a name="3986"><span class="lineNum">    3986 </span>                :            : </a>
<a name="3987"><span class="lineNum">    3987 </span>                :            :   //startPoint</a>
<a name="3988"><span class="lineNum">    3988 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="3989"><span class="lineNum">    3989 </span>                :            : </a>
<a name="3990"><span class="lineNum">    3990 </span>                :            :   //endPoint</a>
<a name="3991"><span class="lineNum">    3991 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.endPoint(), QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="3992"><span class="lineNum">    3992 </span>                :            : </a>
<a name="3993"><span class="lineNum">    3993 </span>                :            :   //test 3d length</a>
<a name="3994"><span class="lineNum">    3994 </span>                :            :   // without vertices</a>
<a name="3995"><span class="lineNum">    3995 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="3996"><span class="lineNum">    3996 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length3D(), 0.0 );</span></a>
<a name="3997"><span class="lineNum">    3997 </span>                :            : </a>
<a name="3998"><span class="lineNum">    3998 </span>                :            :   // without Z</a>
<a name="3999"><span class="lineNum">    3999 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="4000"><span class="lineNum">    4000 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="4001"><span class="lineNum">    4001 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 4 )</span></a>
<a name="4002"><span class="lineNum">    4002 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 8, 16 ) );</span></a>
<a name="4003"><span class="lineNum">    4003 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length3D(), 18.0 );</span></a>
<a name="4004"><span class="lineNum">    4004 </span>                :            : </a>
<a name="4005"><span class="lineNum">    4005 </span>                :            :   // with z</a>
<a name="4006"><span class="lineNum">    4006 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="4007"><span class="lineNum">    4007 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 0 )</span></a>
<a name="4008"><span class="lineNum">    4008 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 )</span></a>
<a name="4009"><span class="lineNum">    4009 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 4, 6, 2 ) );</span></a>
<a name="4010"><span class="lineNum">    4010 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length3D(), 8.0 );</span></a>
<a name="4011"><span class="lineNum">    4011 </span>                :            : </a>
<a name="4012"><span class="lineNum">    4012 </span>                :            :   // with z and m</a>
<a name="4013"><span class="lineNum">    4013 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="4014"><span class="lineNum">    4014 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 0, 0 )</span></a>
<a name="4015"><span class="lineNum">    4015 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 13 )</span></a>
<a name="4016"><span class="lineNum">    4016 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 4, 6, 2, 7 ) );</span></a>
<a name="4017"><span class="lineNum">    4017 </span>                :<span class="lineCov">          1 :   QCOMPARE( l19.length3D(), 8.0 );</span></a>
<a name="4018"><span class="lineNum">    4018 </span>                :            : </a>
<a name="4019"><span class="lineNum">    4019 </span>                :            :   //bad start/end points. Test that this doesn't crash.</a>
<a name="4020"><span class="lineNum">    4020 </span>                :<span class="lineCov">          1 :   l19.clear();</span></a>
<a name="4021"><span class="lineNum">    4021 </span>                :<span class="lineCov">          1 :   QVERIFY( l19.startPoint().isEmpty() );</span></a>
<a name="4022"><span class="lineNum">    4022 </span>                :<span class="lineCov">          1 :   QVERIFY( l19.endPoint().isEmpty() );</span></a>
<a name="4023"><span class="lineNum">    4023 </span>                :            : </a>
<a name="4024"><span class="lineNum">    4024 </span>                :            :   //curveToLine - no segmentation required, so should return a clone</a>
<a name="4025"><span class="lineNum">    4025 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="4026"><span class="lineNum">    4026 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="4027"><span class="lineNum">    4027 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="4028"><span class="lineNum">    4028 </span>                :<span class="lineCov">          1 :   segmentized.reset( l19.curveToLine() );</span></a>
<a name="4029"><span class="lineNum">    4029 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 3 );</span></a>
<a name="4030"><span class="lineNum">    4030 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4031"><span class="lineNum">    4031 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="4032"><span class="lineNum">    4032 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="4033"><span class="lineNum">    4033 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), l19.pointN( 0 ) );</span></a>
<a name="4034"><span class="lineNum">    4034 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 1 ), l19.pointN( 1 ) );</span></a>
<a name="4035"><span class="lineNum">    4035 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 2 ), l19.pointN( 2 ) );</span></a>
<a name="4036"><span class="lineNum">    4036 </span>                :            : </a>
<a name="4037"><span class="lineNum">    4037 </span>                :            :   // points</a>
<a name="4038"><span class="lineNum">    4038 </span>                :<span class="lineCov">          1 :   QgsLineString l20;</span></a>
<a name="4039"><span class="lineNum">    4039 </span>                :<span class="lineCov">          1 :   QgsPointSequence points;</span></a>
<a name="4040"><span class="lineNum">    4040 </span>                :<span class="lineCov">          1 :   l20.points( points );</span></a>
<a name="4041"><span class="lineNum">    4041 </span>                :<span class="lineCov">          1 :   QVERIFY( l20.isEmpty() );</span></a>
<a name="4042"><span class="lineNum">    4042 </span>                :<span class="lineCov">          2 :   l20.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="4043"><span class="lineNum">    4043 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="4044"><span class="lineNum">    4044 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="4045"><span class="lineNum">    4045 </span>                :<span class="lineCov">          1 :   l20.points( points );</span></a>
<a name="4046"><span class="lineNum">    4046 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 3 );</span></a>
<a name="4047"><span class="lineNum">    4047 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="4048"><span class="lineNum">    4048 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 ) );</span></a>
<a name="4049"><span class="lineNum">    4049 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="4050"><span class="lineNum">    4050 </span>                :            : </a>
<a name="4051"><span class="lineNum">    4051 </span>                :            :   //CRS transform</a>
<a name="4052"><span class="lineNum">    4052 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="4053"><span class="lineNum">    4053 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) );// want a transform with ellipsoid change</span></a>
<a name="4054"><span class="lineNum">    4054 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="4055"><span class="lineNum">    4055 </span>                :            : </a>
<a name="4056"><span class="lineNum">    4056 </span>                :            :   // 2d CRS transform</a>
<a name="4057"><span class="lineNum">    4057 </span>                :<span class="lineCov">          1 :   QgsLineString l21;</span></a>
<a name="4058"><span class="lineNum">    4058 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6374985, -3626584 )</span></a>
<a name="4059"><span class="lineNum">    4059 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6474985, -3526584 ) );</span></a>
<a name="4060"><span class="lineNum">    4060 </span>                :<span class="lineCov">          1 :   l21.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="4061"><span class="lineNum">    4061 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="4062"><span class="lineNum">    4062 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="4063"><span class="lineNum">    4063 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 1 ).x(), 176.959, 0.001 );</span></a>
<a name="4064"><span class="lineNum">    4064 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="4065"><span class="lineNum">    4065 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().xMinimum(), 175.771, 0.001 );</span></a>
<a name="4066"><span class="lineNum">    4066 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="4067"><span class="lineNum">    4067 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="4068"><span class="lineNum">    4068 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l21.boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="4069"><span class="lineNum">    4069 </span>                :            : </a>
<a name="4070"><span class="lineNum">    4070 </span>                :            :   //3d CRS transform</a>
<a name="4071"><span class="lineNum">    4071 </span>                :<span class="lineCov">          1 :   QgsLineString l22;</span></a>
<a name="4072"><span class="lineNum">    4072 </span>                :<span class="lineCov">          2 :   l22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 )</span></a>
<a name="4073"><span class="lineNum">    4073 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6474985, -3526584, 3, 4 ) );</span></a>
<a name="4074"><span class="lineNum">    4074 </span>                :<span class="lineCov">          1 :   l22.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="4075"><span class="lineNum">    4075 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="4076"><span class="lineNum">    4076 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="4077"><span class="lineNum">    4077 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="4078"><span class="lineNum">    4078 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 0 ).m(), 2.0 );</span></a>
<a name="4079"><span class="lineNum">    4079 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).x(), 176.959, 0.001 );</span></a>
<a name="4080"><span class="lineNum">    4080 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="4081"><span class="lineNum">    4081 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="4082"><span class="lineNum">    4082 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 1 ).m(), 4.0 );</span></a>
<a name="4083"><span class="lineNum">    4083 </span>                :            : </a>
<a name="4084"><span class="lineNum">    4084 </span>                :            :   //reverse transform</a>
<a name="4085"><span class="lineNum">    4085 </span>                :<span class="lineCov">          1 :   l22.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="4086"><span class="lineNum">    4086 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).x(), 6374985, 0.01 );</span></a>
<a name="4087"><span class="lineNum">    4087 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).y(), -3626584, 0.01 );</span></a>
<a name="4088"><span class="lineNum">    4088 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1, 0.001 );</span></a>
<a name="4089"><span class="lineNum">    4089 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 0 ).m(), 2.0 );</span></a>
<a name="4090"><span class="lineNum">    4090 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).x(), 6474985, 0.01 );</span></a>
<a name="4091"><span class="lineNum">    4091 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).y(), -3526584, 0.01 );</span></a>
<a name="4092"><span class="lineNum">    4092 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3, 0.001 );</span></a>
<a name="4093"><span class="lineNum">    4093 </span>                :<span class="lineCov">          1 :   QCOMPARE( l22.pointN( 1 ).m(), 4.0 );</span></a>
<a name="4094"><span class="lineNum">    4094 </span>                :            : </a>
<a name="4095"><span class="lineNum">    4095 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="4096"><span class="lineNum">    4096 </span>                :            :   //z value transform</a>
<a name="4097"><span class="lineNum">    4097 </span>                :            :   l22.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="4098"><span class="lineNum">    4098 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="4099"><span class="lineNum">    4099 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), -21.092128, 0.001 );</a>
<a name="4100"><span class="lineNum">    4100 </span>                :            :   l22.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="4101"><span class="lineNum">    4101 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 0 ).z(), 1.0, 0.001 );</a>
<a name="4102"><span class="lineNum">    4102 </span>                :            :   QGSCOMPARENEAR( l22.pointN( 1 ).z(), 3.0, 0.001 );</a>
<a name="4103"><span class="lineNum">    4103 </span>                :            : #endif</a>
<a name="4104"><span class="lineNum">    4104 </span>                :            : </a>
<a name="4105"><span class="lineNum">    4105 </span>                :            :   //QTransform transform</a>
<a name="4106"><span class="lineNum">    4106 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="4107"><span class="lineNum">    4107 </span>                :<span class="lineCov">          1 :   QgsLineString l23;</span></a>
<a name="4108"><span class="lineNum">    4108 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="4109"><span class="lineNum">    4109 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4110"><span class="lineNum">    4110 </span>                :<span class="lineCov">          1 :   l23.transform( qtr );</span></a>
<a name="4111"><span class="lineNum">    4111 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 2, 6, 3, 4 ) );</span></a>
<a name="4112"><span class="lineNum">    4112 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 22, 36, 13, 14 ) );</span></a>
<a name="4113"><span class="lineNum">    4113 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.boundingBox(), QgsRectangle( 2, 6, 22, 36 ) );</span></a>
<a name="4114"><span class="lineNum">    4114 </span>                :            : </a>
<a name="4115"><span class="lineNum">    4115 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="4116"><span class="lineNum">    4116 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4117"><span class="lineNum">    4117 </span>                :<span class="lineCov">          1 :   l23.transform( QTransform::fromScale( 1, 1 ), 3, 2, 4, 3 );</span></a>
<a name="4118"><span class="lineNum">    4118 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 9, 16 ) );</span></a>
<a name="4119"><span class="lineNum">    4119 </span>                :<span class="lineCov">          1 :   QCOMPARE( l23.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 29, 46 ) );</span></a>
<a name="4120"><span class="lineNum">    4120 </span>                :            : </a>
<a name="4121"><span class="lineNum">    4121 </span>                :            :   //insert vertex</a>
<a name="4122"><span class="lineNum">    4122 </span>                :            : </a>
<a name="4123"><span class="lineNum">    4123 </span>                :            :   //insert vertex in empty line</a>
<a name="4124"><span class="lineNum">    4124 </span>                :<span class="lineCov">          1 :   QgsLineString l24;</span></a>
<a name="4125"><span class="lineNum">    4125 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="4126"><span class="lineNum">    4126 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 1 );</span></a>
<a name="4127"><span class="lineNum">    4127 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.is3D() );</span></a>
<a name="4128"><span class="lineNum">    4128 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.isMeasure() );</span></a>
<a name="4129"><span class="lineNum">    4129 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4130"><span class="lineNum">    4130 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="4131"><span class="lineNum">    4131 </span>                :            : </a>
<a name="4132"><span class="lineNum">    4132 </span>                :            :   //insert 4d vertex in empty line, should set line to 4d</a>
<a name="4133"><span class="lineNum">    4133 </span>                :<span class="lineCov">          1 :   l24.clear();</span></a>
<a name="4134"><span class="lineNum">    4134 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 6.0, 7.0, 1.0, 2.0 ) ) );</span></a>
<a name="4135"><span class="lineNum">    4135 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 1 );</span></a>
<a name="4136"><span class="lineNum">    4136 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.is3D() );</span></a>
<a name="4137"><span class="lineNum">    4137 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.isMeasure() );</span></a>
<a name="4138"><span class="lineNum">    4138 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4139"><span class="lineNum">    4139 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 6.0, 7.0, 1.0, 2.0 ) );</span></a>
<a name="4140"><span class="lineNum">    4140 </span>                :            : </a>
<a name="4141"><span class="lineNum">    4141 </span>                :            :   //2d line</a>
<a name="4142"><span class="lineNum">    4142 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="4143"><span class="lineNum">    4143 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="4144"><span class="lineNum">    4144 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="4145"><span class="lineNum">    4145 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 4 );</span></a>
<a name="4146"><span class="lineNum">    4146 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.is3D() );</span></a>
<a name="4147"><span class="lineNum">    4147 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.isMeasure() );</span></a>
<a name="4148"><span class="lineNum">    4148 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4149"><span class="lineNum">    4149 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 8.0, 9.0 ) ) );</span></a>
<a name="4150"><span class="lineNum">    4150 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 18.0, 19.0 ) ) );</span></a>
<a name="4151"><span class="lineNum">    4151 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="4152"><span class="lineNum">    4152 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( 8.0, 9.0 ) );</span></a>
<a name="4153"><span class="lineNum">    4153 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 2 ), QgsPoint( 18.0, 19.0 ) );</span></a>
<a name="4154"><span class="lineNum">    4154 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 3 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="4155"><span class="lineNum">    4155 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 4 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="4156"><span class="lineNum">    4156 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 5 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="4157"><span class="lineNum">    4157 </span>                :            :   //insert vertex at end</a>
<a name="4158"><span class="lineNum">    4158 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 6 ), QgsPoint( 31.0, 32.0 ) ) );</span></a>
<a name="4159"><span class="lineNum">    4159 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 6 ), QgsPoint( 31.0, 32.0 ) );</span></a>
<a name="4160"><span class="lineNum">    4160 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 7 );</span></a>
<a name="4161"><span class="lineNum">    4161 </span>                :            : </a>
<a name="4162"><span class="lineNum">    4162 </span>                :            :   //insert vertex past end</a>
<a name="4163"><span class="lineNum">    4163 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, 8 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="4164"><span class="lineNum">    4164 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 7 );</span></a>
<a name="4165"><span class="lineNum">    4165 </span>                :            : </a>
<a name="4166"><span class="lineNum">    4166 </span>                :            :   //insert vertex before start</a>
<a name="4167"><span class="lineNum">    4167 </span>                :<span class="lineCov">          1 :   QVERIFY( !l24.insertVertex( QgsVertexId( 0, 0, -18 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="4168"><span class="lineNum">    4168 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 7 );</span></a>
<a name="4169"><span class="lineNum">    4169 </span>                :            : </a>
<a name="4170"><span class="lineNum">    4170 </span>                :            :   //insert 4d vertex in 4d line</a>
<a name="4171"><span class="lineNum">    4171 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="4172"><span class="lineNum">    4172 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="4173"><span class="lineNum">    4173 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="4174"><span class="lineNum">    4174 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) ) );</span></a>
<a name="4175"><span class="lineNum">    4175 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 4 );</span></a>
<a name="4176"><span class="lineNum">    4176 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4177"><span class="lineNum">    4177 </span>                :            : </a>
<a name="4178"><span class="lineNum">    4178 </span>                :            :   //insert 2d vertex in 4d line</a>
<a name="4179"><span class="lineNum">    4179 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 101, 102 ) ) );</span></a>
<a name="4180"><span class="lineNum">    4180 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 5 );</span></a>
<a name="4181"><span class="lineNum">    4181 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4182"><span class="lineNum">    4182 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 101, 102 ) );</span></a>
<a name="4183"><span class="lineNum">    4183 </span>                :            : </a>
<a name="4184"><span class="lineNum">    4184 </span>                :            :   //insert 4d vertex in 2d line</a>
<a name="4185"><span class="lineNum">    4185 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="4186"><span class="lineNum">    4186 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="4187"><span class="lineNum">    4187 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 101, 102, 103, 104 ) ) );</span></a>
<a name="4188"><span class="lineNum">    4188 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.numPoints(), 4 );</span></a>
<a name="4189"><span class="lineNum">    4189 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4190"><span class="lineNum">    4190 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 101, 102 ) );</span></a>
<a name="4191"><span class="lineNum">    4191 </span>                :            : </a>
<a name="4192"><span class="lineNum">    4192 </span>                :            :   //insert first vertex as Point25D</a>
<a name="4193"><span class="lineNum">    4193 </span>                :<span class="lineCov">          1 :   l24.clear();</span></a>
<a name="4194"><span class="lineNum">    4194 </span>                :<span class="lineCov">          1 :   QVERIFY( l24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::Point25D, 101, 102, 103 ) ) );</span></a>
<a name="4195"><span class="lineNum">    4195 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4196"><span class="lineNum">    4196 </span>                :<span class="lineCov">          1 :   QCOMPARE( l24.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 101, 102, 103 ) );</span></a>
<a name="4197"><span class="lineNum">    4197 </span>                :            : </a>
<a name="4198"><span class="lineNum">    4198 </span>                :            :   //move vertex</a>
<a name="4199"><span class="lineNum">    4199 </span>                :            : </a>
<a name="4200"><span class="lineNum">    4200 </span>                :            :   //empty line</a>
<a name="4201"><span class="lineNum">    4201 </span>                :<span class="lineCov">          1 :   QgsLineString l25;</span></a>
<a name="4202"><span class="lineNum">    4202 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="4203"><span class="lineNum">    4203 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.isEmpty() );</span></a>
<a name="4204"><span class="lineNum">    4204 </span>                :            : </a>
<a name="4205"><span class="lineNum">    4205 </span>                :            :   //valid line</a>
<a name="4206"><span class="lineNum">    4206 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="4207"><span class="lineNum">    4207 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="4208"><span class="lineNum">    4208 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="4209"><span class="lineNum">    4209 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="4210"><span class="lineNum">    4210 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="4211"><span class="lineNum">    4211 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="4212"><span class="lineNum">    4212 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="4213"><span class="lineNum">    4213 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="4214"><span class="lineNum">    4214 </span>                :            : </a>
<a name="4215"><span class="lineNum">    4215 </span>                :            :   //out of range</a>
<a name="4216"><span class="lineNum">    4216 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="4217"><span class="lineNum">    4217 </span>                :<span class="lineCov">          1 :   QVERIFY( !l25.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="4218"><span class="lineNum">    4218 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="4219"><span class="lineNum">    4219 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="4220"><span class="lineNum">    4220 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="4221"><span class="lineNum">    4221 </span>                :            : </a>
<a name="4222"><span class="lineNum">    4222 </span>                :            :   //move 4d point in 4d line</a>
<a name="4223"><span class="lineNum">    4223 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="4224"><span class="lineNum">    4224 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="4225"><span class="lineNum">    4225 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="4226"><span class="lineNum">    4226 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) ) );</span></a>
<a name="4227"><span class="lineNum">    4227 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) );</span></a>
<a name="4228"><span class="lineNum">    4228 </span>                :            : </a>
<a name="4229"><span class="lineNum">    4229 </span>                :            :   //move 2d point in 4d line, existing z/m should be maintained</a>
<a name="4230"><span class="lineNum">    4230 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 34, 35 ) ) );</span></a>
<a name="4231"><span class="lineNum">    4231 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 34, 35, 12, 13 ) );</span></a>
<a name="4232"><span class="lineNum">    4232 </span>                :            : </a>
<a name="4233"><span class="lineNum">    4233 </span>                :            :   //move 4d point in 2d line</a>
<a name="4234"><span class="lineNum">    4234 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="4235"><span class="lineNum">    4235 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="4236"><span class="lineNum">    4236 </span>                :<span class="lineCov">          1 :   QVERIFY( l25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 3, 4, 2, 3 ) ) );</span></a>
<a name="4237"><span class="lineNum">    4237 </span>                :<span class="lineCov">          1 :   QCOMPARE( l25.pointN( 0 ), QgsPoint( 3, 4 ) );</span></a>
<a name="4238"><span class="lineNum">    4238 </span>                :            : </a>
<a name="4239"><span class="lineNum">    4239 </span>                :            : </a>
<a name="4240"><span class="lineNum">    4240 </span>                :            :   //delete vertex</a>
<a name="4241"><span class="lineNum">    4241 </span>                :            : </a>
<a name="4242"><span class="lineNum">    4242 </span>                :            :   //empty line</a>
<a name="4243"><span class="lineNum">    4243 </span>                :<span class="lineCov">          1 :   QgsLineString l26;</span></a>
<a name="4244"><span class="lineNum">    4244 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="4245"><span class="lineNum">    4245 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.isEmpty() );</span></a>
<a name="4246"><span class="lineNum">    4246 </span>                :            : </a>
<a name="4247"><span class="lineNum">    4247 </span>                :            :   //valid line</a>
<a name="4248"><span class="lineNum">    4248 </span>                :<span class="lineCov">          2 :   l26.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="4249"><span class="lineNum">    4249 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="4250"><span class="lineNum">    4250 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4251"><span class="lineNum">    4251 </span>                :            :   //out of range vertices</a>
<a name="4252"><span class="lineNum">    4252 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="4253"><span class="lineNum">    4253 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="4254"><span class="lineNum">    4254 </span>                :            : </a>
<a name="4255"><span class="lineNum">    4255 </span>                :            :   //valid vertices</a>
<a name="4256"><span class="lineNum">    4256 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="4257"><span class="lineNum">    4257 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.numPoints(), 2 );</span></a>
<a name="4258"><span class="lineNum">    4258 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="4259"><span class="lineNum">    4259 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4260"><span class="lineNum">    4260 </span>                :            :   //removing the second to last vertex removes both remaining vertices</a>
<a name="4261"><span class="lineNum">    4261 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="4262"><span class="lineNum">    4262 </span>                :<span class="lineCov">          1 :   QCOMPARE( l26.numPoints(), 0 );</span></a>
<a name="4263"><span class="lineNum">    4263 </span>                :<span class="lineCov">          1 :   QVERIFY( !l26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="4264"><span class="lineNum">    4264 </span>                :<span class="lineCov">          1 :   QVERIFY( l26.isEmpty() );</span></a>
<a name="4265"><span class="lineNum">    4265 </span>                :            : </a>
<a name="4266"><span class="lineNum">    4266 </span>                :            :   //reversed</a>
<a name="4267"><span class="lineNum">    4267 </span>                :<span class="lineCov">          1 :   QgsLineString l27;</span></a>
<a name="4268"><span class="lineNum">    4268 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; reversed( l27.reversed() );</span></a>
<a name="4269"><span class="lineNum">    4269 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isEmpty() );</span></a>
<a name="4270"><span class="lineNum">    4270 </span>                :<span class="lineCov">          2 :   l27.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="4271"><span class="lineNum">    4271 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="4272"><span class="lineNum">    4272 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4273"><span class="lineNum">    4273 </span>                :<span class="lineCov">          1 :   reversed.reset( l27.reversed() );</span></a>
<a name="4274"><span class="lineNum">    4274 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;numPoints(), 3 );</span></a>
<a name="4275"><span class="lineNum">    4275 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4276"><span class="lineNum">    4276 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;is3D() );</span></a>
<a name="4277"><span class="lineNum">    4277 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isMeasure() );</span></a>
<a name="4278"><span class="lineNum">    4278 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4279"><span class="lineNum">    4279 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="4280"><span class="lineNum">    4280 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="4281"><span class="lineNum">    4281 </span>                :            : </a>
<a name="4282"><span class="lineNum">    4282 </span>                :            :   //addZValue</a>
<a name="4283"><span class="lineNum">    4283 </span>                :            : </a>
<a name="4284"><span class="lineNum">    4284 </span>                :<span class="lineCov">          1 :   QgsLineString l28;</span></a>
<a name="4285"><span class="lineNum">    4285 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4286"><span class="lineNum">    4286 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue() );</span></a>
<a name="4287"><span class="lineNum">    4287 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4288"><span class="lineNum">    4288 </span>                :<span class="lineCov">          1 :   l28.clear();</span></a>
<a name="4289"><span class="lineNum">    4289 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue() );</span></a>
<a name="4290"><span class="lineNum">    4290 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4291"><span class="lineNum">    4291 </span>                :            :   //2d line</a>
<a name="4292"><span class="lineNum">    4292 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4293"><span class="lineNum">    4293 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue( 2 ) );</span></a>
<a name="4294"><span class="lineNum">    4294 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.is3D() );</span></a>
<a name="4295"><span class="lineNum">    4295 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4296"><span class="lineNum">    4296 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="4297"><span class="lineNum">    4297 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="4298"><span class="lineNum">    4298 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28.addZValue( 4 ) ); //already has z value, test that existing z is unchanged</span></a>
<a name="4299"><span class="lineNum">    4299 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="4300"><span class="lineNum">    4300 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="4301"><span class="lineNum">    4301 </span>                :            :   //linestring with m</a>
<a name="4302"><span class="lineNum">    4302 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="4303"><span class="lineNum">    4303 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.addZValue( 5 ) );</span></a>
<a name="4304"><span class="lineNum">    4304 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.is3D() );</span></a>
<a name="4305"><span class="lineNum">    4305 </span>                :<span class="lineCov">          1 :   QVERIFY( l28.isMeasure() );</span></a>
<a name="4306"><span class="lineNum">    4306 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4307"><span class="lineNum">    4307 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5, 3 ) );</span></a>
<a name="4308"><span class="lineNum">    4308 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 5, 4 ) );</span></a>
<a name="4309"><span class="lineNum">    4309 </span>                :            :   //linestring25d</a>
<a name="4310"><span class="lineNum">    4310 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 4 ) );</span></a>
<a name="4311"><span class="lineNum">    4311 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4312"><span class="lineNum">    4312 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28.addZValue( 5 ) );</span></a>
<a name="4313"><span class="lineNum">    4313 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4314"><span class="lineNum">    4314 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) );</span></a>
<a name="4315"><span class="lineNum">    4315 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28.pointN( 1 ), QgsPoint( QgsWkbTypes::Point25D, 11, 12, 4 ) );</span></a>
<a name="4316"><span class="lineNum">    4316 </span>                :            : </a>
<a name="4317"><span class="lineNum">    4317 </span>                :            :   //addMValue</a>
<a name="4318"><span class="lineNum">    4318 </span>                :            : </a>
<a name="4319"><span class="lineNum">    4319 </span>                :<span class="lineCov">          1 :   QgsLineString l29;</span></a>
<a name="4320"><span class="lineNum">    4320 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4321"><span class="lineNum">    4321 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue() );</span></a>
<a name="4322"><span class="lineNum">    4322 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4323"><span class="lineNum">    4323 </span>                :<span class="lineCov">          1 :   l29.clear();</span></a>
<a name="4324"><span class="lineNum">    4324 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue() );</span></a>
<a name="4325"><span class="lineNum">    4325 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4326"><span class="lineNum">    4326 </span>                :            :   //2d line</a>
<a name="4327"><span class="lineNum">    4327 </span>                :<span class="lineCov">          1 :   l29.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4328"><span class="lineNum">    4328 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue( 2 ) );</span></a>
<a name="4329"><span class="lineNum">    4329 </span>                :<span class="lineCov">          1 :   QVERIFY( !l29.is3D() );</span></a>
<a name="4330"><span class="lineNum">    4330 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.isMeasure() );</span></a>
<a name="4331"><span class="lineNum">    4331 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4332"><span class="lineNum">    4332 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="4333"><span class="lineNum">    4333 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="4334"><span class="lineNum">    4334 </span>                :<span class="lineCov">          1 :   QVERIFY( !l29.addMValue( 4 ) ); //already has m value, test that existing m is unchanged</span></a>
<a name="4335"><span class="lineNum">    4335 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="4336"><span class="lineNum">    4336 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="4337"><span class="lineNum">    4337 </span>                :            :   //linestring with z</a>
<a name="4338"><span class="lineNum">    4338 </span>                :<span class="lineCov">          1 :   l29.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 4 ) );</span></a>
<a name="4339"><span class="lineNum">    4339 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue( 5 ) );</span></a>
<a name="4340"><span class="lineNum">    4340 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.is3D() );</span></a>
<a name="4341"><span class="lineNum">    4341 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.isMeasure() );</span></a>
<a name="4342"><span class="lineNum">    4342 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4343"><span class="lineNum">    4343 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 5 ) );</span></a>
<a name="4344"><span class="lineNum">    4344 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="4345"><span class="lineNum">    4345 </span>                :            :   //linestring25d, should become LineStringZM</a>
<a name="4346"><span class="lineNum">    4346 </span>                :<span class="lineCov">          1 :   l29.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 4 ) );</span></a>
<a name="4347"><span class="lineNum">    4347 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4348"><span class="lineNum">    4348 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.addMValue( 5 ) );</span></a>
<a name="4349"><span class="lineNum">    4349 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.is3D() );</span></a>
<a name="4350"><span class="lineNum">    4350 </span>                :<span class="lineCov">          1 :   QVERIFY( l29.isMeasure() );</span></a>
<a name="4351"><span class="lineNum">    4351 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4352"><span class="lineNum">    4352 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 5 ) );</span></a>
<a name="4353"><span class="lineNum">    4353 </span>                :<span class="lineCov">          1 :   QCOMPARE( l29.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="4354"><span class="lineNum">    4354 </span>                :            : </a>
<a name="4355"><span class="lineNum">    4355 </span>                :            : </a>
<a name="4356"><span class="lineNum">    4356 </span>                :            :   //dropZValue</a>
<a name="4357"><span class="lineNum">    4357 </span>                :<span class="lineCov">          1 :   QgsLineString l28d;</span></a>
<a name="4358"><span class="lineNum">    4358 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() );</span></a>
<a name="4359"><span class="lineNum">    4359 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4360"><span class="lineNum">    4360 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() );</span></a>
<a name="4361"><span class="lineNum">    4361 </span>                :<span class="lineCov">          1 :   l28d.addZValue( 1.0 );</span></a>
<a name="4362"><span class="lineNum">    4362 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4363"><span class="lineNum">    4363 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.is3D() );</span></a>
<a name="4364"><span class="lineNum">    4364 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropZValue() );</span></a>
<a name="4365"><span class="lineNum">    4365 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.is3D() );</span></a>
<a name="4366"><span class="lineNum">    4366 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4367"><span class="lineNum">    4367 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="4368"><span class="lineNum">    4368 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="4369"><span class="lineNum">    4369 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropZValue() ); //already dropped</span></a>
<a name="4370"><span class="lineNum">    4370 </span>                :            :   //linestring with m</a>
<a name="4371"><span class="lineNum">    4371 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="4372"><span class="lineNum">    4372 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropZValue() );</span></a>
<a name="4373"><span class="lineNum">    4373 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.is3D() );</span></a>
<a name="4374"><span class="lineNum">    4374 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.isMeasure() );</span></a>
<a name="4375"><span class="lineNum">    4375 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4376"><span class="lineNum">    4376 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="4377"><span class="lineNum">    4377 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="4378"><span class="lineNum">    4378 </span>                :            :   //linestring25d</a>
<a name="4379"><span class="lineNum">    4379 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 4 ) );</span></a>
<a name="4380"><span class="lineNum">    4380 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4381"><span class="lineNum">    4381 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropZValue() );</span></a>
<a name="4382"><span class="lineNum">    4382 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4383"><span class="lineNum">    4383 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="4384"><span class="lineNum">    4384 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="4385"><span class="lineNum">    4385 </span>                :            : </a>
<a name="4386"><span class="lineNum">    4386 </span>                :            :   //dropMValue</a>
<a name="4387"><span class="lineNum">    4387 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4388"><span class="lineNum">    4388 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropMValue() );</span></a>
<a name="4389"><span class="lineNum">    4389 </span>                :<span class="lineCov">          1 :   l28d.addMValue( 1.0 );</span></a>
<a name="4390"><span class="lineNum">    4390 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4391"><span class="lineNum">    4391 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.isMeasure() );</span></a>
<a name="4392"><span class="lineNum">    4392 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropMValue() );</span></a>
<a name="4393"><span class="lineNum">    4393 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.isMeasure() );</span></a>
<a name="4394"><span class="lineNum">    4394 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4395"><span class="lineNum">    4395 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="4396"><span class="lineNum">    4396 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="4397"><span class="lineNum">    4397 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.dropMValue() ); //already dropped</span></a>
<a name="4398"><span class="lineNum">    4398 </span>                :            :   //linestring with z</a>
<a name="4399"><span class="lineNum">    4399 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="4400"><span class="lineNum">    4400 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.dropMValue() );</span></a>
<a name="4401"><span class="lineNum">    4401 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.isMeasure() );</span></a>
<a name="4402"><span class="lineNum">    4402 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.is3D() );</span></a>
<a name="4403"><span class="lineNum">    4403 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4404"><span class="lineNum">    4404 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3, 0 ) );</span></a>
<a name="4405"><span class="lineNum">    4405 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 1 ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 3, 0 ) );</span></a>
<a name="4406"><span class="lineNum">    4406 </span>                :            : </a>
<a name="4407"><span class="lineNum">    4407 </span>                :            :   //convertTo</a>
<a name="4408"><span class="lineNum">    4408 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4409"><span class="lineNum">    4409 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineString ) );</span></a>
<a name="4410"><span class="lineNum">    4410 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4411"><span class="lineNum">    4411 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineStringZ ) );</span></a>
<a name="4412"><span class="lineNum">    4412 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="4413"><span class="lineNum">    4413 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2 ) );</span></a>
<a name="4414"><span class="lineNum">    4414 </span>                :<span class="lineCov">          1 :   l28d.setZAt( 0, 5.0 );</span></a>
<a name="4415"><span class="lineNum">    4415 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineString25D ) );</span></a>
<a name="4416"><span class="lineNum">    4416 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="4417"><span class="lineNum">    4417 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::Point25D, 1, 2, 5.0 ) );</span></a>
<a name="4418"><span class="lineNum">    4418 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineStringZM ) );</span></a>
<a name="4419"><span class="lineNum">    4419 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="4420"><span class="lineNum">    4420 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5.0 ) );</span></a>
<a name="4421"><span class="lineNum">    4421 </span>                :<span class="lineCov">          1 :   l28d.setMAt( 0, 6.0 );</span></a>
<a name="4422"><span class="lineNum">    4422 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineStringM ) );</span></a>
<a name="4423"><span class="lineNum">    4423 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="4424"><span class="lineNum">    4424 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0.0, 6.0 ) );</span></a>
<a name="4425"><span class="lineNum">    4425 </span>                :<span class="lineCov">          1 :   QVERIFY( l28d.convertTo( QgsWkbTypes::LineString ) );</span></a>
<a name="4426"><span class="lineNum">    4426 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="4427"><span class="lineNum">    4427 </span>                :<span class="lineCov">          1 :   QCOMPARE( l28d.pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="4428"><span class="lineNum">    4428 </span>                :<span class="lineCov">          1 :   QVERIFY( !l28d.convertTo( QgsWkbTypes::Polygon ) );</span></a>
<a name="4429"><span class="lineNum">    4429 </span>                :            : </a>
<a name="4430"><span class="lineNum">    4430 </span>                :            :   //isRing</a>
<a name="4431"><span class="lineNum">    4431 </span>                :<span class="lineCov">          1 :   QgsLineString l30;</span></a>
<a name="4432"><span class="lineNum">    4432 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() );</span></a>
<a name="4433"><span class="lineNum">    4433 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="4434"><span class="lineNum">    4434 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() ); //&lt;4 points</span></a>
<a name="4435"><span class="lineNum">    4435 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 31, 32 ) );</span></a>
<a name="4436"><span class="lineNum">    4436 </span>                :<span class="lineCov">          1 :   QVERIFY( !l30.isRing() ); //not closed</span></a>
<a name="4437"><span class="lineNum">    4437 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="4438"><span class="lineNum">    4438 </span>                :<span class="lineCov">          1 :   QVERIFY( l30.isRing() );</span></a>
<a name="4439"><span class="lineNum">    4439 </span>                :            : </a>
<a name="4440"><span class="lineNum">    4440 </span>                :            :   //coordinateSequence</a>
<a name="4441"><span class="lineNum">    4441 </span>                :<span class="lineCov">          1 :   QgsLineString l31;</span></a>
<a name="4442"><span class="lineNum">    4442 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence coords = l31.coordinateSequence();</span></a>
<a name="4443"><span class="lineNum">    4443 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="4444"><span class="lineNum">    4444 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="4445"><span class="lineNum">    4445 </span>                :<span class="lineCov">          1 :   QVERIFY( coords.at( 0 ).at( 0 ).isEmpty() );</span></a>
<a name="4446"><span class="lineNum">    4446 </span>                :<span class="lineCov">          2 :   l31.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="4447"><span class="lineNum">    4447 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="4448"><span class="lineNum">    4448 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4449"><span class="lineNum">    4449 </span>                :<span class="lineCov">          1 :   coords = l31.coordinateSequence();</span></a>
<a name="4450"><span class="lineNum">    4450 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="4451"><span class="lineNum">    4451 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="4452"><span class="lineNum">    4452 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).count(), 3 );</span></a>
<a name="4453"><span class="lineNum">    4453 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="4454"><span class="lineNum">    4454 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="4455"><span class="lineNum">    4455 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="4456"><span class="lineNum">    4456 </span>                :            : </a>
<a name="4457"><span class="lineNum">    4457 </span>                :            :   //nextVertex</a>
<a name="4458"><span class="lineNum">    4458 </span>                :            : </a>
<a name="4459"><span class="lineNum">    4459 </span>                :<span class="lineCov">          1 :   QgsLineString l32;</span></a>
<a name="4460"><span class="lineNum">    4460 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="4461"><span class="lineNum">    4461 </span>                :<span class="lineCov">          1 :   QgsPoint p;</span></a>
<a name="4462"><span class="lineNum">    4462 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4463"><span class="lineNum">    4463 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="4464"><span class="lineNum">    4464 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4465"><span class="lineNum">    4465 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="4466"><span class="lineNum">    4466 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4467"><span class="lineNum">    4467 </span>                :            : </a>
<a name="4468"><span class="lineNum">    4468 </span>                :            :   // vertex iterator on empty linestring</a>
<a name="4469"><span class="lineNum">    4469 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it1 = l32.vertices_begin();</span></a>
<a name="4470"><span class="lineNum">    4470 </span>                :<span class="lineCov">          1 :   QCOMPARE( it1, l32.vertices_end() );</span></a>
<a name="4471"><span class="lineNum">    4471 </span>                :            : </a>
<a name="4472"><span class="lineNum">    4472 </span>                :            :   // Java-style iterator on empty linetring</a>
<a name="4473"><span class="lineNum">    4473 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it1x( &amp;l32 );</span></a>
<a name="4474"><span class="lineNum">    4474 </span>                :<span class="lineCov">          1 :   QVERIFY( !it1x.hasNext() );</span></a>
<a name="4475"><span class="lineNum">    4475 </span>                :            : </a>
<a name="4476"><span class="lineNum">    4476 </span>                :            :   //LineString</a>
<a name="4477"><span class="lineNum">    4477 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4478"><span class="lineNum">    4478 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 2 ); //out of range</span></a>
<a name="4479"><span class="lineNum">    4479 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4480"><span class="lineNum">    4480 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="4481"><span class="lineNum">    4481 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4482"><span class="lineNum">    4482 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="4483"><span class="lineNum">    4483 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4484"><span class="lineNum">    4484 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4485"><span class="lineNum">    4485 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="4486"><span class="lineNum">    4486 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4487"><span class="lineNum">    4487 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4488"><span class="lineNum">    4488 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="4489"><span class="lineNum">    4489 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4490"><span class="lineNum">    4490 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 0 );</span></a>
<a name="4491"><span class="lineNum">    4491 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4492"><span class="lineNum">    4492 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) ); //test that ring number is maintained</span></a>
<a name="4493"><span class="lineNum">    4493 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="4494"><span class="lineNum">    4494 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="4495"><span class="lineNum">    4495 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4496"><span class="lineNum">    4496 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) ); //test that part number is maintained</span></a>
<a name="4497"><span class="lineNum">    4497 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="4498"><span class="lineNum">    4498 </span>                :            : </a>
<a name="4499"><span class="lineNum">    4499 </span>                :            :   // vertex iterator</a>
<a name="4500"><span class="lineNum">    4500 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it2 = l32.vertices_begin();</span></a>
<a name="4501"><span class="lineNum">    4501 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it2, QgsPoint( 1, 2 ) );</span></a>
<a name="4502"><span class="lineNum">    4502 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.vertexId(), QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4503"><span class="lineNum">    4503 </span>                :<span class="lineCov">          1 :   ++it2;</span></a>
<a name="4504"><span class="lineNum">    4504 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it2, QgsPoint( 11, 12 ) );</span></a>
<a name="4505"><span class="lineNum">    4505 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.vertexId(), QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4506"><span class="lineNum">    4506 </span>                :<span class="lineCov">          1 :   ++it2;</span></a>
<a name="4507"><span class="lineNum">    4507 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2, l32.vertices_end() );</span></a>
<a name="4508"><span class="lineNum">    4508 </span>                :            : </a>
<a name="4509"><span class="lineNum">    4509 </span>                :            :   // Java-style iterator</a>
<a name="4510"><span class="lineNum">    4510 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2x( &amp;l32 );</span></a>
<a name="4511"><span class="lineNum">    4511 </span>                :<span class="lineCov">          1 :   QVERIFY( it2x.hasNext() );</span></a>
<a name="4512"><span class="lineNum">    4512 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2x.next(), QgsPoint( 1, 2 ) );</span></a>
<a name="4513"><span class="lineNum">    4513 </span>                :<span class="lineCov">          1 :   QVERIFY( it2x.hasNext() );</span></a>
<a name="4514"><span class="lineNum">    4514 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2x.next(), QgsPoint( 11, 12 ) );</span></a>
<a name="4515"><span class="lineNum">    4515 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2x.hasNext() );</span></a>
<a name="4516"><span class="lineNum">    4516 </span>                :            : </a>
<a name="4517"><span class="lineNum">    4517 </span>                :            :   //LineStringZ</a>
<a name="4518"><span class="lineNum">    4518 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4519"><span class="lineNum">    4519 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="4520"><span class="lineNum">    4520 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4521"><span class="lineNum">    4521 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4522"><span class="lineNum">    4522 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="4523"><span class="lineNum">    4523 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4524"><span class="lineNum">    4524 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4525"><span class="lineNum">    4525 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4526"><span class="lineNum">    4526 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4527"><span class="lineNum">    4527 </span>                :            : </a>
<a name="4528"><span class="lineNum">    4528 </span>                :            :   //LineStringM</a>
<a name="4529"><span class="lineNum">    4529 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="4530"><span class="lineNum">    4530 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="4531"><span class="lineNum">    4531 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4532"><span class="lineNum">    4532 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4533"><span class="lineNum">    4533 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="4534"><span class="lineNum">    4534 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4535"><span class="lineNum">    4535 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4536"><span class="lineNum">    4536 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="4537"><span class="lineNum">    4537 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4538"><span class="lineNum">    4538 </span>                :            :   //LineStringZM</a>
<a name="4539"><span class="lineNum">    4539 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4540"><span class="lineNum">    4540 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="4541"><span class="lineNum">    4541 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4542"><span class="lineNum">    4542 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4543"><span class="lineNum">    4543 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="4544"><span class="lineNum">    4544 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4545"><span class="lineNum">    4545 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4546"><span class="lineNum">    4546 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4547"><span class="lineNum">    4547 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4548"><span class="lineNum">    4548 </span>                :            :   //LineString25D</a>
<a name="4549"><span class="lineNum">    4549 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 13 ) );</span></a>
<a name="4550"><span class="lineNum">    4550 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="4551"><span class="lineNum">    4551 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4552"><span class="lineNum">    4552 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4553"><span class="lineNum">    4553 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) );</span></a>
<a name="4554"><span class="lineNum">    4554 </span>                :<span class="lineCov">          1 :   QVERIFY( l32.nextVertex( v, p ) );</span></a>
<a name="4555"><span class="lineNum">    4555 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4556"><span class="lineNum">    4556 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::Point25D, 11, 12, 13 ) );</span></a>
<a name="4557"><span class="lineNum">    4557 </span>                :<span class="lineCov">          1 :   QVERIFY( !l32.nextVertex( v, p ) );</span></a>
<a name="4558"><span class="lineNum">    4558 </span>                :            : </a>
<a name="4559"><span class="lineNum">    4559 </span>                :            :   //vertexAt and pointAt</a>
<a name="4560"><span class="lineNum">    4560 </span>                :<span class="lineCov">          1 :   QgsLineString l33;</span></a>
<a name="4561"><span class="lineNum">    4561 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, -10 ) ); //out of bounds, check for no crash</span></a>
<a name="4562"><span class="lineNum">    4562 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="4563"><span class="lineNum">    4563 </span>                :            :   QgsVertexId::VertexType type;</a>
<a name="4564"><span class="lineNum">    4564 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( -10, p, type ) );</span></a>
<a name="4565"><span class="lineNum">    4565 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( 10, p, type ) );</span></a>
<a name="4566"><span class="lineNum">    4566 </span>                :            :   //LineString</a>
<a name="4567"><span class="lineNum">    4567 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4568"><span class="lineNum">    4568 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, -10 ) );</span></a>
<a name="4569"><span class="lineNum">    4569 </span>                :<span class="lineCov">          1 :   l33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="4570"><span class="lineNum">    4570 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="4571"><span class="lineNum">    4571 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="4572"><span class="lineNum">    4572 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( -10, p, type ) );</span></a>
<a name="4573"><span class="lineNum">    4573 </span>                :<span class="lineCov">          1 :   QVERIFY( !l33.pointAt( 10, p, type ) );</span></a>
<a name="4574"><span class="lineNum">    4574 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="4575"><span class="lineNum">    4575 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="4576"><span class="lineNum">    4576 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4577"><span class="lineNum">    4577 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="4578"><span class="lineNum">    4578 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="4579"><span class="lineNum">    4579 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4580"><span class="lineNum">    4580 </span>                :            :   //LineStringZ</a>
<a name="4581"><span class="lineNum">    4581 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4582"><span class="lineNum">    4582 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="4583"><span class="lineNum">    4583 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4584"><span class="lineNum">    4584 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="4585"><span class="lineNum">    4585 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="4586"><span class="lineNum">    4586 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4587"><span class="lineNum">    4587 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="4588"><span class="lineNum">    4588 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4589"><span class="lineNum">    4589 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4590"><span class="lineNum">    4590 </span>                :            :   //LineStringM</a>
<a name="4591"><span class="lineNum">    4591 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="4592"><span class="lineNum">    4592 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="4593"><span class="lineNum">    4593 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="4594"><span class="lineNum">    4594 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="4595"><span class="lineNum">    4595 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="4596"><span class="lineNum">    4596 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4597"><span class="lineNum">    4597 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="4598"><span class="lineNum">    4598 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="4599"><span class="lineNum">    4599 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4600"><span class="lineNum">    4600 </span>                :            :   //LineStringZM</a>
<a name="4601"><span class="lineNum">    4601 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4602"><span class="lineNum">    4602 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="4603"><span class="lineNum">    4603 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4604"><span class="lineNum">    4604 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="4605"><span class="lineNum">    4605 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="4606"><span class="lineNum">    4606 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4607"><span class="lineNum">    4607 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="4608"><span class="lineNum">    4608 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="4609"><span class="lineNum">    4609 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4610"><span class="lineNum">    4610 </span>                :            :   //LineString25D</a>
<a name="4611"><span class="lineNum">    4611 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 11, 12, 13 ) );</span></a>
<a name="4612"><span class="lineNum">    4612 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) );</span></a>
<a name="4613"><span class="lineNum">    4613 </span>                :<span class="lineCov">          1 :   QCOMPARE( l33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::Point25D, 11, 12, 13 ) );</span></a>
<a name="4614"><span class="lineNum">    4614 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 0, p, type ) );</span></a>
<a name="4615"><span class="lineNum">    4615 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::Point25D, 1, 2, 3 ) );</span></a>
<a name="4616"><span class="lineNum">    4616 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4617"><span class="lineNum">    4617 </span>                :<span class="lineCov">          1 :   QVERIFY( l33.pointAt( 1, p, type ) );</span></a>
<a name="4618"><span class="lineNum">    4618 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::Point25D, 11, 12, 13 ) );</span></a>
<a name="4619"><span class="lineNum">    4619 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="4620"><span class="lineNum">    4620 </span>                :            : </a>
<a name="4621"><span class="lineNum">    4621 </span>                :            :   //centroid</a>
<a name="4622"><span class="lineNum">    4622 </span>                :<span class="lineCov">          1 :   QgsLineString l34;</span></a>
<a name="4623"><span class="lineNum">    4623 </span>                :<span class="lineCov">          1 :   QVERIFY( l34.centroid().isEmpty() );</span></a>
<a name="4624"><span class="lineNum">    4624 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="4625"><span class="lineNum">    4625 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 5, 10 ) );</span></a>
<a name="4626"><span class="lineNum">    4626 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 20, 10 ) );</span></a>
<a name="4627"><span class="lineNum">    4627 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 10, 5 ) );</span></a>
<a name="4628"><span class="lineNum">    4628 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 9 ) &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 2, 0 ) );</span></a>
<a name="4629"><span class="lineNum">    4629 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 1, 4.95 ) );</span></a>
<a name="4630"><span class="lineNum">    4630 </span>                :            :   //linestring with 0 length segment</a>
<a name="4631"><span class="lineNum">    4631 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 9 ) &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 2, 0 ) );</span></a>
<a name="4632"><span class="lineNum">    4632 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 1, 4.95 ) );</span></a>
<a name="4633"><span class="lineNum">    4633 </span>                :            :   //linestring with 0 total length segment</a>
<a name="4634"><span class="lineNum">    4634 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 4 ) &lt;&lt; QgsPoint( 5, 4 ) &lt;&lt; QgsPoint( 5, 4 ) );</span></a>
<a name="4635"><span class="lineNum">    4635 </span>                :<span class="lineCov">          1 :   QCOMPARE( l34.centroid(), QgsPoint( 5, 4 ) );</span></a>
<a name="4636"><span class="lineNum">    4636 </span>                :            : </a>
<a name="4637"><span class="lineNum">    4637 </span>                :            :   //closest segment</a>
<a name="4638"><span class="lineNum">    4638 </span>                :<span class="lineCov">          1 :   QgsLineString l35;</span></a>
<a name="4639"><span class="lineNum">    4639 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="4640"><span class="lineNum">    4640 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 0, 0 ); // reset all coords to zero</span></a>
<a name="4641"><span class="lineNum">    4641 </span>                :<span class="lineCov">          1 :   ( void )l35.closestSegment( QgsPoint( 1, 2 ), p, v ); //empty line, just want no crash</span></a>
<a name="4642"><span class="lineNum">    4642 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="4643"><span class="lineNum">    4643 </span>                :<span class="lineCov">          1 :   QVERIFY( l35.closestSegment( QgsPoint( 5, 10 ), p, v ) &lt; 0 );</span></a>
<a name="4644"><span class="lineNum">    4644 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="4645"><span class="lineNum">    4645 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 4, 11 ), p, v, &amp;leftOf ), 2.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4646"><span class="lineNum">    4646 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 10 ) );</span></a>
<a name="4647"><span class="lineNum">    4647 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4648"><span class="lineNum">    4648 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="4649"><span class="lineNum">    4649 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 8, 11 ), p, v, &amp;leftOf ), 1.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4650"><span class="lineNum">    4650 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 8, 10 ) );</span></a>
<a name="4651"><span class="lineNum">    4651 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4652"><span class="lineNum">    4652 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="4653"><span class="lineNum">    4653 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 8, 9 ), p, v, &amp;leftOf ), 1.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4654"><span class="lineNum">    4654 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 8, 10 ) );</span></a>
<a name="4655"><span class="lineNum">    4655 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4656"><span class="lineNum">    4656 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4657"><span class="lineNum">    4657 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 11, 9 ), p, v, &amp;leftOf ), 2.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4658"><span class="lineNum">    4658 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 10, 10 ) );</span></a>
<a name="4659"><span class="lineNum">    4659 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4660"><span class="lineNum">    4660 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4661"><span class="lineNum">    4661 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 )</span></a>
<a name="4662"><span class="lineNum">    4662 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="4663"><span class="lineNum">    4663 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="4664"><span class="lineNum">    4664 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 11, 12 ), p, v, &amp;leftOf ), 1.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4665"><span class="lineNum">    4665 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 10, 12 ) );</span></a>
<a name="4666"><span class="lineNum">    4666 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="4667"><span class="lineNum">    4667 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4668"><span class="lineNum">    4668 </span>                :            : </a>
<a name="4669"><span class="lineNum">    4669 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="4670"><span class="lineNum">    4670 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6, 4 )</span></a>
<a name="4671"><span class="lineNum">    4671 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 4, 4 )</span></a>
<a name="4672"><span class="lineNum">    4672 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 5, 5 ) );</span></a>
<a name="4673"><span class="lineNum">    4673 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 2.35, 4 ), p, v, &amp;leftOf ), 2.7225, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4674"><span class="lineNum">    4674 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 4, 4 ) );</span></a>
<a name="4675"><span class="lineNum">    4675 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="4676"><span class="lineNum">    4676 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="4677"><span class="lineNum">    4677 </span>                :            : </a>
<a name="4678"><span class="lineNum">    4678 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="4679"><span class="lineNum">    4679 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 4, 4 )</span></a>
<a name="4680"><span class="lineNum">    4680 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6, 4 )</span></a>
<a name="4681"><span class="lineNum">    4681 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 5, 5 ) );</span></a>
<a name="4682"><span class="lineNum">    4682 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 2.35, 4 ), p, v, &amp;leftOf ), 2.7225, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4683"><span class="lineNum">    4683 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 4, 4 ) );</span></a>
<a name="4684"><span class="lineNum">    4684 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4685"><span class="lineNum">    4685 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4686"><span class="lineNum">    4686 </span>                :            : </a>
<a name="4687"><span class="lineNum">    4687 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="4688"><span class="lineNum">    4688 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6, 4 )</span></a>
<a name="4689"><span class="lineNum">    4689 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 4, 4 )</span></a>
<a name="4690"><span class="lineNum">    4690 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 5, 5 ) );</span></a>
<a name="4691"><span class="lineNum">    4691 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 3.5, 2 ), p, v, &amp;leftOf ), 4.250000, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4692"><span class="lineNum">    4692 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 4, 4 ) );</span></a>
<a name="4693"><span class="lineNum">    4693 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="4694"><span class="lineNum">    4694 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="4695"><span class="lineNum">    4695 </span>                :            : </a>
<a name="4696"><span class="lineNum">    4696 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="4697"><span class="lineNum">    4697 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 4, 4 )</span></a>
<a name="4698"><span class="lineNum">    4698 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6, 4 )</span></a>
<a name="4699"><span class="lineNum">    4699 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 5, 5 ) );</span></a>
<a name="4700"><span class="lineNum">    4700 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 3.5, 2 ), p, v, &amp;leftOf ), 4.250000, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4701"><span class="lineNum">    4701 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 4, 4 ) );</span></a>
<a name="4702"><span class="lineNum">    4702 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4703"><span class="lineNum">    4703 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4704"><span class="lineNum">    4704 </span>                :            : </a>
<a name="4705"><span class="lineNum">    4705 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 )</span></a>
<a name="4706"><span class="lineNum">    4706 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 4 )</span></a>
<a name="4707"><span class="lineNum">    4707 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 2 )</span></a>
<a name="4708"><span class="lineNum">    4708 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4709"><span class="lineNum">    4709 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 1, 0 ), p, v, &amp;leftOf ), 1, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4710"><span class="lineNum">    4710 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 1 ) );</span></a>
<a name="4711"><span class="lineNum">    4711 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4712"><span class="lineNum">    4712 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="4713"><span class="lineNum">    4713 </span>                :            : </a>
<a name="4714"><span class="lineNum">    4714 </span>                :<span class="lineCov">          2 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 )</span></a>
<a name="4715"><span class="lineNum">    4715 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 2 )</span></a>
<a name="4716"><span class="lineNum">    4716 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 4 )</span></a>
<a name="4717"><span class="lineNum">    4717 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4718"><span class="lineNum">    4718 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l35.closestSegment( QgsPoint( 1, 0 ), p, v, &amp;leftOf ), 1, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4719"><span class="lineNum">    4719 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 1 ) );</span></a>
<a name="4720"><span class="lineNum">    4720 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4721"><span class="lineNum">    4721 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="4722"><span class="lineNum">    4722 </span>                :            : </a>
<a name="4723"><span class="lineNum">    4723 </span>                :            :   //sumUpArea</a>
<a name="4724"><span class="lineNum">    4724 </span>                :<span class="lineCov">          1 :   QgsLineString l36;</span></a>
<a name="4725"><span class="lineNum">    4725 </span>                :<span class="lineCov">          1 :   double area = 1.0; //sumUpArea adds to area, so start with non-zero value</span></a>
<a name="4726"><span class="lineNum">    4726 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="4727"><span class="lineNum">    4727 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="4728"><span class="lineNum">    4728 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="4729"><span class="lineNum">    4729 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="4730"><span class="lineNum">    4730 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="4731"><span class="lineNum">    4731 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="4732"><span class="lineNum">    4732 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="4733"><span class="lineNum">    4733 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, -24, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4734"><span class="lineNum">    4734 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) );</span></a>
<a name="4735"><span class="lineNum">    4735 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="4736"><span class="lineNum">    4736 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, -22, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4737"><span class="lineNum">    4737 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="4738"><span class="lineNum">    4738 </span>                :<span class="lineCov">          1 :   l36.sumUpArea( area );</span></a>
<a name="4739"><span class="lineNum">    4739 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, -18, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4740"><span class="lineNum">    4740 </span>                :            : </a>
<a name="4741"><span class="lineNum">    4741 </span>                :            :   //boundingBox - test that bounding box is updated after every modification to the line string</a>
<a name="4742"><span class="lineNum">    4742 </span>                :<span class="lineCov">          1 :   QgsLineString l37;</span></a>
<a name="4743"><span class="lineNum">    4743 </span>                :<span class="lineCov">          1 :   QVERIFY( l37.boundingBox().isNull() );</span></a>
<a name="4744"><span class="lineNum">    4744 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="4745"><span class="lineNum">    4745 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 5, 10, 10, 15 ) );</span></a>
<a name="4746"><span class="lineNum">    4746 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( -5, -10 ) &lt;&lt; QgsPoint( -6, -10 ) &lt;&lt; QgsPoint( -5.5, -9 ) );</span></a>
<a name="4747"><span class="lineNum">    4747 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6, -10, -5, -9 ) );</span></a>
<a name="4748"><span class="lineNum">    4748 </span>                :            :   //setXAt</a>
<a name="4749"><span class="lineNum">    4749 </span>                :<span class="lineCov">          1 :   l37.setXAt( 2, -4 );</span></a>
<a name="4750"><span class="lineNum">    4750 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6, -10, -4, -9 ) );</span></a>
<a name="4751"><span class="lineNum">    4751 </span>                :            :   //setYAt</a>
<a name="4752"><span class="lineNum">    4752 </span>                :<span class="lineCov">          1 :   l37.setYAt( 1, -15 );</span></a>
<a name="4753"><span class="lineNum">    4753 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6, -15, -4, -9 ) );</span></a>
<a name="4754"><span class="lineNum">    4754 </span>                :            :   //append</a>
<a name="4755"><span class="lineNum">    4755 </span>                :<span class="lineCov">          1 :   toAppend.reset( new QgsLineString() );</span></a>
<a name="4756"><span class="lineNum">    4756 </span>                :<span class="lineCov">          1 :   toAppend-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 4, 0 ) );</span></a>
<a name="4757"><span class="lineNum">    4757 </span>                :<span class="lineCov">          1 :   l37.append( toAppend.get() );</span></a>
<a name="4758"><span class="lineNum">    4758 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6, -15, 4, 2 ) );</span></a>
<a name="4759"><span class="lineNum">    4759 </span>                :<span class="lineCov">          1 :   l37.addVertex( QgsPoint( 6, 3 ) );</span></a>
<a name="4760"><span class="lineNum">    4760 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -6, -15, 6, 3 ) );</span></a>
<a name="4761"><span class="lineNum">    4761 </span>                :<span class="lineCov">          1 :   l37.clear();</span></a>
<a name="4762"><span class="lineNum">    4762 </span>                :<span class="lineCov">          1 :   QVERIFY( l37.boundingBox().isNull() );</span></a>
<a name="4763"><span class="lineNum">    4763 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="4764"><span class="lineNum">    4764 </span>                :<span class="lineCov">          1 :   QByteArray wkbToAppend = toAppend-&gt;asWkb();</span></a>
<a name="4765"><span class="lineNum">    4765 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbToAppendPtr( wkbToAppend );</span></a>
<a name="4766"><span class="lineNum">    4766 </span>                :<span class="lineCov">          1 :   l37.fromWkb( wkbToAppendPtr );</span></a>
<a name="4767"><span class="lineNum">    4767 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 1, 0, 4, 2 ) );</span></a>
<a name="4768"><span class="lineNum">    4768 </span>                :<span class="lineCov">          2 :   l37.fromWkt( QStringLiteral( &quot;LineString( 1 5, 3 4, 6 3 )&quot; ) );</span></a>
<a name="4769"><span class="lineNum">    4769 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 1, 3, 6, 5 ) );</span></a>
<a name="4770"><span class="lineNum">    4770 </span>                :<span class="lineCov">          1 :   l37.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -1, 7 ) );</span></a>
<a name="4771"><span class="lineNum">    4771 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -1, 3, 6, 7 ) );</span></a>
<a name="4772"><span class="lineNum">    4772 </span>                :<span class="lineCov">          1 :   l37.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -3, 10 ) );</span></a>
<a name="4773"><span class="lineNum">    4773 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( -3, 3, 6, 10 ) );</span></a>
<a name="4774"><span class="lineNum">    4774 </span>                :<span class="lineCov">          1 :   l37.deleteVertex( QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4775"><span class="lineNum">    4775 </span>                :<span class="lineCov">          1 :   QCOMPARE( l37.boundingBox(), QgsRectangle( 1, 3, 6, 5 ) );</span></a>
<a name="4776"><span class="lineNum">    4776 </span>                :            : </a>
<a name="4777"><span class="lineNum">    4777 </span>                :            :   //angle</a>
<a name="4778"><span class="lineNum">    4778 </span>                :<span class="lineCov">          1 :   QgsLineString l38;</span></a>
<a name="4779"><span class="lineNum">    4779 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="4780"><span class="lineNum">    4780 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="4781"><span class="lineNum">    4781 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="4782"><span class="lineNum">    4782 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="4783"><span class="lineNum">    4783 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) );</span></a>
<a name="4784"><span class="lineNum">    4784 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="4785"><span class="lineNum">    4785 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="4786"><span class="lineNum">    4786 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ); //no crash</span></a>
<a name="4787"><span class="lineNum">    4787 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 1 ) );</span></a>
<a name="4788"><span class="lineNum">    4788 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 0.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4789"><span class="lineNum">    4789 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0.0, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="4790"><span class="lineNum">    4790 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="4791"><span class="lineNum">    4791 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 4.71239, 0.0001 );</span></a>
<a name="4792"><span class="lineNum">    4792 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 4.71239, 0.0001 );</span></a>
<a name="4793"><span class="lineNum">    4793 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="4794"><span class="lineNum">    4794 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 3.1416, 0.0001 );</span></a>
<a name="4795"><span class="lineNum">    4795 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.1416, 0.0001 );</span></a>
<a name="4796"><span class="lineNum">    4796 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4797"><span class="lineNum">    4797 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="4798"><span class="lineNum">    4798 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0.7854, 0.0001 );</span></a>
<a name="4799"><span class="lineNum">    4799 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 0.0, 0.0001 );</span></a>
<a name="4800"><span class="lineNum">    4800 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="4801"><span class="lineNum">    4801 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="4802"><span class="lineNum">    4802 </span>                :<span class="lineCov">          1 :   ( void )l38.vertexAngle( QgsVertexId( 0, 0, 20 ) );</span></a>
<a name="4803"><span class="lineNum">    4803 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="4804"><span class="lineNum">    4804 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="4805"><span class="lineNum">    4805 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="4806"><span class="lineNum">    4806 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="4807"><span class="lineNum">    4807 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="4808"><span class="lineNum">    4808 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 4.71239, 0.00001 );</span></a>
<a name="4809"><span class="lineNum">    4809 </span>                :            :   //closed line string</a>
<a name="4810"><span class="lineNum">    4810 </span>                :<span class="lineCov">          1 :   l38.close();</span></a>
<a name="4811"><span class="lineNum">    4811 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="4812"><span class="lineNum">    4812 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="4813"><span class="lineNum">    4813 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l38.vertexAngle( QgsVertexId( 0, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="4814"><span class="lineNum">    4814 </span>                :            : </a>
<a name="4815"><span class="lineNum">    4815 </span>                :            :   //removing the second to last vertex should remove the whole line</a>
<a name="4816"><span class="lineNum">    4816 </span>                :<span class="lineCov">          1 :   QgsLineString l39;</span></a>
<a name="4817"><span class="lineNum">    4817 </span>                :<span class="lineCov">          1 :   l39.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4818"><span class="lineNum">    4818 </span>                :<span class="lineCov">          1 :   QVERIFY( l39.numPoints() == 2 );</span></a>
<a name="4819"><span class="lineNum">    4819 </span>                :<span class="lineCov">          1 :   l39.deleteVertex( QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4820"><span class="lineNum">    4820 </span>                :<span class="lineCov">          1 :   QVERIFY( l39.numPoints() == 0 );</span></a>
<a name="4821"><span class="lineNum">    4821 </span>                :            : </a>
<a name="4822"><span class="lineNum">    4822 </span>                :            :   //boundary</a>
<a name="4823"><span class="lineNum">    4823 </span>                :<span class="lineCov">          1 :   QgsLineString boundary1;</span></a>
<a name="4824"><span class="lineNum">    4824 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundary1.boundary() );</span></a>
<a name="4825"><span class="lineNum">    4825 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4826"><span class="lineNum">    4826 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = boundary1.boundary();</span></a>
<a name="4827"><span class="lineNum">    4827 </span>                :<span class="lineCov">          1 :   QgsMultiPoint *mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="4828"><span class="lineNum">    4828 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="4829"><span class="lineNum">    4829 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="4830"><span class="lineNum">    4830 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="4831"><span class="lineNum">    4831 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="4832"><span class="lineNum">    4832 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="4833"><span class="lineNum">    4833 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="4834"><span class="lineNum">    4834 </span>                :            : </a>
<a name="4835"><span class="lineNum">    4835 </span>                :            :   // closed string = no boundary</a>
<a name="4836"><span class="lineNum">    4836 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="4837"><span class="lineNum">    4837 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundary1.boundary() );</span></a>
<a name="4838"><span class="lineNum">    4838 </span>                :            :   \</a>
<a name="4839"><span class="lineNum">    4839 </span>                :            : </a>
<a name="4840"><span class="lineNum">    4840 </span>                :            :   //boundary with z</a>
<a name="4841"><span class="lineNum">    4841 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="4842"><span class="lineNum">    4842 </span>                :<span class="lineCov">          1 :   boundary = boundary1.boundary();</span></a>
<a name="4843"><span class="lineNum">    4843 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="4844"><span class="lineNum">    4844 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="4845"><span class="lineNum">    4845 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="4846"><span class="lineNum">    4846 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="4847"><span class="lineNum">    4847 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="4848"><span class="lineNum">    4848 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;z(), 10.0 );</span></a>
<a name="4849"><span class="lineNum">    4849 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="4850"><span class="lineNum">    4850 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="4851"><span class="lineNum">    4851 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="4852"><span class="lineNum">    4852 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;z(), 20.0 );</span></a>
<a name="4853"><span class="lineNum">    4853 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="4854"><span class="lineNum">    4854 </span>                :            : </a>
<a name="4855"><span class="lineNum">    4855 </span>                :            :   //extend</a>
<a name="4856"><span class="lineNum">    4856 </span>                :<span class="lineCov">          1 :   QgsLineString extend1;</span></a>
<a name="4857"><span class="lineNum">    4857 </span>                :<span class="lineCov">          1 :   extend1.extend( 10, 10 ); //test no crash</span></a>
<a name="4858"><span class="lineNum">    4858 </span>                :<span class="lineCov">          1 :   extend1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="4859"><span class="lineNum">    4859 </span>                :<span class="lineCov">          1 :   extend1.extend( 1, 2 );</span></a>
<a name="4860"><span class="lineNum">    4860 </span>                :<span class="lineCov">          1 :   QCOMPARE( extend1.pointN( 0 ), QgsPoint( QgsWkbTypes::Point, -1, 0 ) );</span></a>
<a name="4861"><span class="lineNum">    4861 </span>                :<span class="lineCov">          1 :   QCOMPARE( extend1.pointN( 1 ), QgsPoint( QgsWkbTypes::Point, 1, 0 ) );</span></a>
<a name="4862"><span class="lineNum">    4862 </span>                :<span class="lineCov">          1 :   QCOMPARE( extend1.pointN( 2 ), QgsPoint( QgsWkbTypes::Point, 1, 3 ) );</span></a>
<a name="4863"><span class="lineNum">    4863 </span>                :            : </a>
<a name="4864"><span class="lineNum">    4864 </span>                :            :   // addToPainterPath (note most tests are in test_qgsgeometry.py)</a>
<a name="4865"><span class="lineNum">    4865 </span>                :<span class="lineCov">          1 :   QgsLineString path;</span></a>
<a name="4866"><span class="lineNum">    4866 </span>                :<span class="lineCov">          1 :   QPainterPath pPath;</span></a>
<a name="4867"><span class="lineNum">    4867 </span>                :<span class="lineCov">          1 :   path.addToPainterPath( pPath );</span></a>
<a name="4868"><span class="lineNum">    4868 </span>                :<span class="lineCov">          1 :   QVERIFY( pPath.isEmpty() );</span></a>
<a name="4869"><span class="lineNum">    4869 </span>                :<span class="lineCov">          1 :   path.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="4870"><span class="lineNum">    4870 </span>                :<span class="lineCov">          1 :   path.addToPainterPath( pPath );</span></a>
<a name="4871"><span class="lineNum">    4871 </span>                :<span class="lineCov">          1 :   QVERIFY( !pPath.isEmpty() );</span></a>
<a name="4872"><span class="lineNum">    4872 </span>                :            : </a>
<a name="4873"><span class="lineNum">    4873 </span>                :            :   // toCurveType</a>
<a name="4874"><span class="lineNum">    4874 </span>                :<span class="lineCov">          1 :   QgsLineString curveLine1;</span></a>
<a name="4875"><span class="lineNum">    4875 </span>                :<span class="lineCov">          1 :   curveLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="4876"><span class="lineNum">    4876 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCompoundCurve &gt; curveType( curveLine1.toCurveType() );</span></a>
<a name="4877"><span class="lineNum">    4877 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="4878"><span class="lineNum">    4878 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numPoints(), 2 );</span></a>
<a name="4879"><span class="lineNum">    4879 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="4880"><span class="lineNum">    4880 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="4881"><span class="lineNum">    4881 </span>                :            : </a>
<a name="4882"><span class="lineNum">    4882 </span>                :            :   //adjacent vertices</a>
<a name="4883"><span class="lineNum">    4883 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine1;</span></a>
<a name="4884"><span class="lineNum">    4884 </span>                :<span class="lineCov">          1 :   vertexLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 112 ) );</span></a>
<a name="4885"><span class="lineNum">    4885 </span>                :<span class="lineCov">          1 :   QgsVertexId prev( 1, 2, 3 ); // start with something</span></a>
<a name="4886"><span class="lineNum">    4886 </span>                :<span class="lineCov">          1 :   QgsVertexId next( 4, 5, 6 );</span></a>
<a name="4887"><span class="lineNum">    4887 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, -1 ), prev, next );</span></a>
<a name="4888"><span class="lineNum">    4888 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="4889"><span class="lineNum">    4889 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="4890"><span class="lineNum">    4890 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 3 ), prev, next );</span></a>
<a name="4891"><span class="lineNum">    4891 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="4892"><span class="lineNum">    4892 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="4893"><span class="lineNum">    4893 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 0 ), prev, next );</span></a>
<a name="4894"><span class="lineNum">    4894 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="4895"><span class="lineNum">    4895 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4896"><span class="lineNum">    4896 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 1 ), prev, next );</span></a>
<a name="4897"><span class="lineNum">    4897 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="4898"><span class="lineNum">    4898 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="4899"><span class="lineNum">    4899 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 2 ), prev, next );</span></a>
<a name="4900"><span class="lineNum">    4900 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4901"><span class="lineNum">    4901 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="4902"><span class="lineNum">    4902 </span>                :            :   // ring, part should be maintained</a>
<a name="4903"><span class="lineNum">    4903 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 1, 0, 1 ), prev, next );</span></a>
<a name="4904"><span class="lineNum">    4904 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="4905"><span class="lineNum">    4905 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="4906"><span class="lineNum">    4906 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 1, 2, 1 ), prev, next );</span></a>
<a name="4907"><span class="lineNum">    4907 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 1, 2, 0 ) );</span></a>
<a name="4908"><span class="lineNum">    4908 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 1, 2, 2 ) );</span></a>
<a name="4909"><span class="lineNum">    4909 </span>                :            :   // closed ring</a>
<a name="4910"><span class="lineNum">    4910 </span>                :<span class="lineCov">          1 :   vertexLine1.close();</span></a>
<a name="4911"><span class="lineNum">    4911 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 0 ), prev, next );</span></a>
<a name="4912"><span class="lineNum">    4912 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="4913"><span class="lineNum">    4913 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="4914"><span class="lineNum">    4914 </span>                :<span class="lineCov">          1 :   vertexLine1.adjacentVertices( QgsVertexId( 0, 0, 3 ), prev, next );</span></a>
<a name="4915"><span class="lineNum">    4915 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="4916"><span class="lineNum">    4916 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="4917"><span class="lineNum">    4917 </span>                :            : </a>
<a name="4918"><span class="lineNum">    4918 </span>                :            :   // vertex number</a>
<a name="4919"><span class="lineNum">    4919 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine2;</span></a>
<a name="4920"><span class="lineNum">    4920 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="4921"><span class="lineNum">    4921 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), -1 );</span></a>
<a name="4922"><span class="lineNum">    4922 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="4923"><span class="lineNum">    4923 </span>                :<span class="lineCov">          1 :   vertexLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 112 ) );</span></a>
<a name="4924"><span class="lineNum">    4924 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="4925"><span class="lineNum">    4925 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="4926"><span class="lineNum">    4926 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, -1, 0 ) ), -1 );</span></a>
<a name="4927"><span class="lineNum">    4927 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="4928"><span class="lineNum">    4928 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="4929"><span class="lineNum">    4929 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="4930"><span class="lineNum">    4930 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="4931"><span class="lineNum">    4931 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="4932"><span class="lineNum">    4932 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), -1 );</span></a>
<a name="4933"><span class="lineNum">    4933 </span>                :            : </a>
<a name="4934"><span class="lineNum">    4934 </span>                :            :   //segmentLength</a>
<a name="4935"><span class="lineNum">    4935 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine3;</span></a>
<a name="4936"><span class="lineNum">    4936 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="4937"><span class="lineNum">    4937 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="4938"><span class="lineNum">    4938 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 1, 0, 0 ) ), 0.0 );</span></a>
<a name="4939"><span class="lineNum">    4939 </span>                :<span class="lineCov">          1 :   vertexLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="4940"><span class="lineNum">    4940 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="4941"><span class="lineNum">    4941 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="4942"><span class="lineNum">    4942 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 0, 0, 0 ) ), 10.0 );</span></a>
<a name="4943"><span class="lineNum">    4943 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 0, 0, 1 ) ), 100.0 );</span></a>
<a name="4944"><span class="lineNum">    4944 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 0, 0, 2 ) ), 0.0 );</span></a>
<a name="4945"><span class="lineNum">    4945 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="4946"><span class="lineNum">    4946 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( -1, 0, 0 ) ), 10.0 );</span></a>
<a name="4947"><span class="lineNum">    4947 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 1, 0, 1 ) ), 100.0 );</span></a>
<a name="4948"><span class="lineNum">    4948 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine3.segmentLength( QgsVertexId( 1, 1, 1 ) ), 100.0 );</span></a>
<a name="4949"><span class="lineNum">    4949 </span>                :            : </a>
<a name="4950"><span class="lineNum">    4950 </span>                :            :   //removeDuplicateNodes</a>
<a name="4951"><span class="lineNum">    4951 </span>                :<span class="lineCov">          1 :   QgsLineString nodeLine;</span></a>
<a name="4952"><span class="lineNum">    4952 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="4953"><span class="lineNum">    4953 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="4954"><span class="lineNum">    4954 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="4955"><span class="lineNum">    4955 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt(), QStringLiteral( &quot;LineString (11 2, 11 12, 111 12)&quot; ) );</span></a>
<a name="4956"><span class="lineNum">    4956 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="4957"><span class="lineNum">    4957 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) );</span></a>
<a name="4958"><span class="lineNum">    4958 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="4959"><span class="lineNum">    4959 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="4960"><span class="lineNum">    4960 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt(), QStringLiteral( &quot;LineString (11 2, 11 12, 111 12)&quot; ) );</span></a>
<a name="4961"><span class="lineNum">    4961 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="4962"><span class="lineNum">    4962 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) );</span></a>
<a name="4963"><span class="lineNum">    4963 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes() );</span></a>
<a name="4964"><span class="lineNum">    4964 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;LineString (11 2, 11.01 1.99, 11.02 2.01, 11 12, 111 12, 111.01 11.99)&quot; ) );</span></a>
<a name="4965"><span class="lineNum">    4965 </span>                :            :   // don't create degenerate lines</a>
<a name="4966"><span class="lineNum">    4966 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="4967"><span class="lineNum">    4967 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="4968"><span class="lineNum">    4968 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;LineString (11 2)&quot; ) );</span></a>
<a name="4969"><span class="lineNum">    4969 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) );</span></a>
<a name="4970"><span class="lineNum">    4970 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="4971"><span class="lineNum">    4971 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;LineString (11 2, 11.01 1.99)&quot; ) );</span></a>
<a name="4972"><span class="lineNum">    4972 </span>                :            :   // with z</a>
<a name="4973"><span class="lineNum">    4973 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 1 ) &lt;&lt; QgsPoint( 11.01, 1.99, 2 ) &lt;&lt; QgsPoint( 11.02, 2.01, 3 )</span></a>
<a name="4974"><span class="lineNum">    4974 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12, 4 ) &lt;&lt; QgsPoint( 111, 12, 5 ) &lt;&lt; QgsPoint( 111.01, 11.99, 6 ) );</span></a>
<a name="4975"><span class="lineNum">    4975 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeLine.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="4976"><span class="lineNum">    4976 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt(), QStringLiteral( &quot;LineStringZ (11 2 1, 11 12 4, 111 12 5)&quot; ) );</span></a>
<a name="4977"><span class="lineNum">    4977 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 1 ) &lt;&lt; QgsPoint( 11.01, 1.99, 2 ) &lt;&lt; QgsPoint( 11.02, 2.01, 3 )</span></a>
<a name="4978"><span class="lineNum">    4978 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12, 4 ) &lt;&lt; QgsPoint( 111, 12, 5 ) &lt;&lt; QgsPoint( 111.01, 11.99, 6 ) );</span></a>
<a name="4979"><span class="lineNum">    4979 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeLine.removeDuplicateNodes( 0.02, true ) );</span></a>
<a name="4980"><span class="lineNum">    4980 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeLine.asWkt( 2 ), QStringLiteral( &quot;LineStringZ (11 2 1, 11.01 1.99 2, 11.02 2.01 3, 11 12 4, 111 12 5, 111.01 11.99 6)&quot; ) );</span></a>
<a name="4981"><span class="lineNum">    4981 </span>                :            : </a>
<a name="4982"><span class="lineNum">    4982 </span>                :            :   // swap xy</a>
<a name="4983"><span class="lineNum">    4983 </span>                :<span class="lineCov">          1 :   QgsLineString swapLine;</span></a>
<a name="4984"><span class="lineNum">    4984 </span>                :<span class="lineCov">          1 :   swapLine.swapXy(); // no crash</span></a>
<a name="4985"><span class="lineNum">    4985 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="4986"><span class="lineNum">    4986 </span>                :<span class="lineCov">          1 :   swapLine.swapXy();</span></a>
<a name="4987"><span class="lineNum">    4987 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapLine.asWkt( 2 ), QStringLiteral( &quot;LineStringZM (2 11 3 4, 12 11 13 14, 12 111 23 24)&quot; ) );</span></a>
<a name="4988"><span class="lineNum">    4988 </span>                :            : </a>
<a name="4989"><span class="lineNum">    4989 </span>                :            :   // filter vertex</a>
<a name="4990"><span class="lineNum">    4990 </span>                :<span class="lineCov">          1 :   QgsLineString filterLine;</span></a>
<a name="4991"><span class="lineNum">    4991 </span>                :<span class="lineCov">          4 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="4992"><span class="lineNum">    4992 </span>                :            :   {</a>
<a name="4993"><span class="lineNum">    4993 </span>                :<span class="lineCov">          4 :     return point.x() &lt; 5;</span></a>
<a name="4994"><span class="lineNum">    4994 </span>                :            :   };</a>
<a name="4995"><span class="lineNum">    4995 </span>                :<span class="lineCov">          1 :   filterLine.filterVertices( filter ); // no crash</span></a>
<a name="4996"><span class="lineNum">    4996 </span>                :<span class="lineCov">          1 :   filterLine.setPoints( QgsPointSequence()  &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="4997"><span class="lineNum">    4997 </span>                :<span class="lineCov">          1 :   filterLine.filterVertices( filter );</span></a>
<a name="4998"><span class="lineNum">    4998 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterLine.asWkt( 2 ), QStringLiteral( &quot;LineStringZM (1 2 3 4, 4 12 13 14)&quot; ) );</span></a>
<a name="4999"><span class="lineNum">    4999 </span>                :            : </a>
<a name="5000"><span class="lineNum">    5000 </span>                :            :   // transform vertex</a>
<a name="5001"><span class="lineNum">    5001 </span>                :<span class="lineCov">          1 :   QgsLineString transformLine;</span></a>
<a name="5002"><span class="lineNum">    5002 </span>                :<span class="lineCov">          4 :   auto transform = []( const QgsPoint &amp; point )-&gt; QgsPoint</span></a>
<a name="5003"><span class="lineNum">    5003 </span>                :            :   {</a>
<a name="5004"><span class="lineNum">    5004 </span>                :<span class="lineCov">          4 :     return QgsPoint( point.x() + 5, point.y() + 6, point.z() + 7, point.m() + 8 );</span></a>
<a name="5005"><span class="lineNum">    5005 </span>                :            :   };</a>
<a name="5006"><span class="lineNum">    5006 </span>                :<span class="lineCov">          1 :   transformLine.transformVertices( transform ); // no crash</span></a>
<a name="5007"><span class="lineNum">    5007 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence()  &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="5008"><span class="lineNum">    5008 </span>                :<span class="lineCov">          1 :   transformLine.transformVertices( transform );</span></a>
<a name="5009"><span class="lineNum">    5009 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformLine.asWkt( 2 ), QStringLiteral( &quot;LineStringZM (16 8 10 12, 6 8 10 12, 9 18 20 22, 116 18 30 32)&quot; ) );</span></a>
<a name="5010"><span class="lineNum">    5010 </span>                :            : </a>
<a name="5011"><span class="lineNum">    5011 </span>                :            :   // transform using class</a>
<a name="5012"><span class="lineNum">    5012 </span>                :<span class="lineCov">          1 :   QgsLineString transformLine2;</span></a>
<a name="5013"><span class="lineNum">    5013 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="5014"><span class="lineNum">    5014 </span>                :            :   // no crash</a>
<a name="5015"><span class="lineNum">    5015 </span>                :<span class="lineCov">          1 :   QVERIFY( transformLine2.transform( &amp;transformer ) );</span></a>
<a name="5016"><span class="lineNum">    5016 </span>                :<span class="lineCov">          1 :   transformLine2.setPoints( QgsPointSequence()  &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="5017"><span class="lineNum">    5017 </span>                :<span class="lineCov">          1 :   QVERIFY( transformLine2.transform( &amp;transformer ) );</span></a>
<a name="5018"><span class="lineNum">    5018 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformLine2.asWkt( 2 ), QStringLiteral( &quot;LineStringZM (33 16 8 3, 3 16 8 3, 12 26 18 13, 333 26 28 23)&quot; ) );</span></a>
<a name="5019"><span class="lineNum">    5019 </span>                :            : </a>
<a name="5020"><span class="lineNum">    5020 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="5021"><span class="lineNum">    5021 </span>                :<span class="lineCov">          1 :   QVERIFY( !transformLine2.transform( &amp;failTransformer ) );</span></a>
<a name="5022"><span class="lineNum">    5022 </span>                :            : </a>
<a name="5023"><span class="lineNum">    5023 </span>                :            :   // substring</a>
<a name="5024"><span class="lineNum">    5024 </span>                :<span class="lineCov">          1 :   QgsLineString substring;</span></a>
<a name="5025"><span class="lineNum">    5025 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; substringResult( substring.curveSubstring( 1, 2 ) ); // no crash</span></a>
<a name="5026"><span class="lineNum">    5026 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult.get() );</span></a>
<a name="5027"><span class="lineNum">    5027 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="5028"><span class="lineNum">    5028 </span>                :<span class="lineCov">          1 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="5029"><span class="lineNum">    5029 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 0, 0 ) );</span></a>
<a name="5030"><span class="lineNum">    5030 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 2 3 4, 11 2 3 4)&quot; ) );</span></a>
<a name="5031"><span class="lineNum">    5031 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, -0.1 ) );</span></a>
<a name="5032"><span class="lineNum">    5032 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="5033"><span class="lineNum">    5033 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 100000, 10000 ) );</span></a>
<a name="5034"><span class="lineNum">    5034 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="5035"><span class="lineNum">    5035 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 1 ) );</span></a>
<a name="5036"><span class="lineNum">    5036 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 2 3 4, 11 3 4 5)&quot; ) );</span></a>
<a name="5037"><span class="lineNum">    5037 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, -1 ) );</span></a>
<a name="5038"><span class="lineNum">    5038 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 3 4 5, 11 3 4 5)&quot; ) );</span></a>
<a name="5039"><span class="lineNum">    5039 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 10000 ) );</span></a>
<a name="5040"><span class="lineNum">    5040 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 2 3 4, 11 12 13 14, 111 12 23 24)&quot; ) );</span></a>
<a name="5041"><span class="lineNum">    5041 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 10000 ) );</span></a>
<a name="5042"><span class="lineNum">    5042 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 3 4 5, 11 12 13 14, 111 12 23 24)&quot; ) );</span></a>
<a name="5043"><span class="lineNum">    5043 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="5044"><span class="lineNum">    5044 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 3 4 5, 11 12 13 14, 21 12 14 15)&quot; ) );</span></a>
<a name="5045"><span class="lineNum">    5045 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( QgsGeometryUtils::distanceToVertex( substring, QgsVertexId( 0, 0, 1 ) ), QgsGeometryUtils::distanceToVertex( substring, QgsVertexId( 0, 0, 2 ) ) ) );</span></a>
<a name="5046"><span class="lineNum">    5046 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZM (11 12 13 14, 111 12 23 24)&quot; ) );</span></a>
<a name="5047"><span class="lineNum">    5047 </span>                :<span class="lineCov">          1 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 0, QgsWkbTypes::PointZ ) &lt;&lt; QgsPoint( 11, 12, 13, 0, QgsWkbTypes::PointZ ) &lt;&lt; QgsPoint( 111, 12, 23, 0, QgsWkbTypes::PointZ ) );</span></a>
<a name="5048"><span class="lineNum">    5048 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="5049"><span class="lineNum">    5049 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringZ (11 3 4, 11 12 13, 21 12 14)&quot; ) );</span></a>
<a name="5050"><span class="lineNum">    5050 </span>                :<span class="lineCov">          1 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 0, 3, QgsWkbTypes::PointM ) &lt;&lt; QgsPoint( 11, 12, 0, 13, QgsWkbTypes::PointM ) &lt;&lt; QgsPoint( 111, 12, 0, 23, QgsWkbTypes::PointM ) );</span></a>
<a name="5051"><span class="lineNum">    5051 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="5052"><span class="lineNum">    5052 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineStringM (11 3 4, 11 12 13, 21 12 14)&quot; ) );</span></a>
<a name="5053"><span class="lineNum">    5053 </span>                :<span class="lineCov">          1 :   substring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="5054"><span class="lineNum">    5054 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 20 ) );</span></a>
<a name="5055"><span class="lineNum">    5055 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;LineString (11 3, 11 12, 21 12)&quot; ) );</span></a>
<a name="5056"><span class="lineNum">    5056 </span>                :            : </a>
<a name="5057"><span class="lineNum">    5057 </span>                :            :   //interpolate point</a>
<a name="5058"><span class="lineNum">    5058 </span>                :<span class="lineCov">          1 :   QgsLineString interpolate;</span></a>
<a name="5059"><span class="lineNum">    5059 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPoint &gt; interpolateResult( interpolate.interpolatePoint( 1 ) ); // no crash</span></a>
<a name="5060"><span class="lineNum">    5060 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="5061"><span class="lineNum">    5061 </span>                :<span class="lineCov">          1 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="5062"><span class="lineNum">    5062 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 0 ) );</span></a>
<a name="5063"><span class="lineNum">    5063 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (11 2 3 4)&quot; ) );</span></a>
<a name="5064"><span class="lineNum">    5064 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( -1 ) );</span></a>
<a name="5065"><span class="lineNum">    5065 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="5066"><span class="lineNum">    5066 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 100000 ) );</span></a>
<a name="5067"><span class="lineNum">    5067 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="5068"><span class="lineNum">    5068 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="5069"><span class="lineNum">    5069 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (11 3 4 5)&quot; ) );</span></a>
<a name="5070"><span class="lineNum">    5070 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 20 ) );</span></a>
<a name="5071"><span class="lineNum">    5071 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (21 12 14 15)&quot; ) );</span></a>
<a name="5072"><span class="lineNum">    5072 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 110 ) );</span></a>
<a name="5073"><span class="lineNum">    5073 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (111 12 23 24)&quot; ) );</span></a>
<a name="5074"><span class="lineNum">    5074 </span>                :<span class="lineCov">          1 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 0, QgsWkbTypes::PointZ ) &lt;&lt; QgsPoint( 11, 12, 13, 0, QgsWkbTypes::PointZ ) &lt;&lt; QgsPoint( 111, 12, 23, 0, QgsWkbTypes::PointZ ) );</span></a>
<a name="5075"><span class="lineNum">    5075 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="5076"><span class="lineNum">    5076 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZ (11 3 4)&quot; ) );</span></a>
<a name="5077"><span class="lineNum">    5077 </span>                :<span class="lineCov">          1 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 0, 3, QgsWkbTypes::PointM ) &lt;&lt; QgsPoint( 11, 12, 0, 13, QgsWkbTypes::PointM ) &lt;&lt; QgsPoint( 111, 12, 0, 23, QgsWkbTypes::PointM ) );</span></a>
<a name="5078"><span class="lineNum">    5078 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="5079"><span class="lineNum">    5079 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointM (11 3 4)&quot; ) );</span></a>
<a name="5080"><span class="lineNum">    5080 </span>                :<span class="lineCov">          1 :   interpolate.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="5081"><span class="lineNum">    5081 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="5082"><span class="lineNum">    5082 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;Point (11 3)&quot; ) );</span></a>
<a name="5083"><span class="lineNum">    5083 </span>                :            : </a>
<a name="5084"><span class="lineNum">    5084 </span>                :            :   // visit points</a>
<a name="5085"><span class="lineNum">    5085 </span>                :<span class="lineCov">          1 :   QgsLineString visitLine;</span></a>
<a name="5086"><span class="lineNum">    5086 </span>                :<span class="lineCov">          1 :   visitLine.visitPointsByRegularDistance( 1, [ = ]( double, double, double, double, double, double, double, double, double, double, double, double )-&gt;bool</span></a>
<a name="5087"><span class="lineNum">    5087 </span>                :            :   {</a>
<a name="5088"><span class="lineNum">    5088 </span>                :<span class="lineNoCov">          0 :     return true;</span></a>
<a name="5089"><span class="lineNum">    5089 </span>                :            :   } ); // no crash</a>
<a name="5090"><span class="lineNum">    5090 </span>                :<span class="lineCov">          1 :   visitLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="5091"><span class="lineNum">    5091 </span>                :<span class="lineCov">          1 :   int visitCount = 0;</span></a>
<a name="5092"><span class="lineNum">    5092 </span>                :<span class="lineCov">          1 :   xx.clear();</span></a>
<a name="5093"><span class="lineNum">    5093 </span>                :<span class="lineCov">          1 :   yy.clear();</span></a>
<a name="5094"><span class="lineNum">    5094 </span>                :<span class="lineCov">          1 :   zz.clear();</span></a>
<a name="5095"><span class="lineNum">    5095 </span>                :<span class="lineCov">          1 :   mm.clear();</span></a>
<a name="5096"><span class="lineNum">    5096 </span>                :<span class="lineCov">          1 :   QVector&lt;double&gt; pX, pY, pZ, pM, nX, nY, nZ, nM;</span></a>
<a name="5097"><span class="lineNum">    5097 </span>                :<span class="lineCov">          5 :   auto visitor = [ &amp; ]( double x, double y, double z, double m, double ppx, double ppy, double ppz, double ppm, double nnx, double nny, double nnz, double nnm )-&gt;bool</span></a>
<a name="5098"><span class="lineNum">    5098 </span>                :            :   {</a>
<a name="5099"><span class="lineNum">    5099 </span>                :<span class="lineCov">          4 :     xx &lt;&lt; x;</span></a>
<a name="5100"><span class="lineNum">    5100 </span>                :<span class="lineCov">          4 :     yy &lt;&lt; y;</span></a>
<a name="5101"><span class="lineNum">    5101 </span>                :<span class="lineCov">          4 :     zz &lt;&lt; z;</span></a>
<a name="5102"><span class="lineNum">    5102 </span>                :<span class="lineCov">          4 :     mm &lt;&lt; m;</span></a>
<a name="5103"><span class="lineNum">    5103 </span>                :<span class="lineCov">          4 :     pX &lt;&lt; ppx;</span></a>
<a name="5104"><span class="lineNum">    5104 </span>                :<span class="lineCov">          4 :     pY &lt;&lt; ppy;</span></a>
<a name="5105"><span class="lineNum">    5105 </span>                :<span class="lineCov">          4 :     pZ &lt;&lt; ppz;</span></a>
<a name="5106"><span class="lineNum">    5106 </span>                :<span class="lineCov">          4 :     pM &lt;&lt; ppm;</span></a>
<a name="5107"><span class="lineNum">    5107 </span>                :<span class="lineCov">          4 :     nX &lt;&lt; nnx;</span></a>
<a name="5108"><span class="lineNum">    5108 </span>                :<span class="lineCov">          4 :     nY &lt;&lt; nny;</span></a>
<a name="5109"><span class="lineNum">    5109 </span>                :<span class="lineCov">          4 :     nZ &lt;&lt; nnz;</span></a>
<a name="5110"><span class="lineNum">    5110 </span>                :<span class="lineCov">          4 :     nM &lt;&lt; nnm;</span></a>
<a name="5111"><span class="lineNum">    5111 </span>                :<span class="lineCov">          4 :     visitCount++;</span></a>
<a name="5112"><span class="lineNum">    5112 </span>                :<span class="lineCov">          4 :     return true;</span></a>
<a name="5113"><span class="lineNum">    5113 </span>                :            :   };</a>
<a name="5114"><span class="lineNum">    5114 </span>                :<span class="lineCov">          1 :   visitLine.visitPointsByRegularDistance( 0, visitor );</span></a>
<a name="5115"><span class="lineNum">    5115 </span>                :<span class="lineCov">          1 :   QCOMPARE( visitCount, 1 );</span></a>
<a name="5116"><span class="lineNum">    5116 </span>                :<span class="lineCov">          1 :   QCOMPARE( xx.at( 0 ), 11.0 );</span></a>
<a name="5117"><span class="lineNum">    5117 </span>                :<span class="lineCov">          1 :   QCOMPARE( yy.at( 0 ), 2.0 );</span></a>
<a name="5118"><span class="lineNum">    5118 </span>                :<span class="lineCov">          1 :   QCOMPARE( zz.at( 0 ), 3.0 );</span></a>
<a name="5119"><span class="lineNum">    5119 </span>                :<span class="lineCov">          1 :   QCOMPARE( mm.at( 0 ), 4.0 );</span></a>
<a name="5120"><span class="lineNum">    5120 </span>                :<span class="lineCov">          1 :   xx.clear();</span></a>
<a name="5121"><span class="lineNum">    5121 </span>                :<span class="lineCov">          1 :   yy.clear();</span></a>
<a name="5122"><span class="lineNum">    5122 </span>                :<span class="lineCov">          1 :   zz.clear();</span></a>
<a name="5123"><span class="lineNum">    5123 </span>                :<span class="lineCov">          1 :   mm.clear();</span></a>
<a name="5124"><span class="lineNum">    5124 </span>                :<span class="lineCov">          1 :   pX.clear();</span></a>
<a name="5125"><span class="lineNum">    5125 </span>                :<span class="lineCov">          1 :   pY.clear();</span></a>
<a name="5126"><span class="lineNum">    5126 </span>                :<span class="lineCov">          1 :   pZ.clear();</span></a>
<a name="5127"><span class="lineNum">    5127 </span>                :<span class="lineCov">          1 :   pM.clear();</span></a>
<a name="5128"><span class="lineNum">    5128 </span>                :<span class="lineCov">          1 :   nX.clear();</span></a>
<a name="5129"><span class="lineNum">    5129 </span>                :<span class="lineCov">          1 :   nY.clear();</span></a>
<a name="5130"><span class="lineNum">    5130 </span>                :<span class="lineCov">          1 :   nZ.clear();</span></a>
<a name="5131"><span class="lineNum">    5131 </span>                :<span class="lineCov">          1 :   nM.clear();</span></a>
<a name="5132"><span class="lineNum">    5132 </span>                :<span class="lineCov">          1 :   visitCount = 0;</span></a>
<a name="5133"><span class="lineNum">    5133 </span>                :<span class="lineCov">          1 :   visitLine.visitPointsByRegularDistance( -1, visitor );</span></a>
<a name="5134"><span class="lineNum">    5134 </span>                :<span class="lineCov">          1 :   QCOMPARE( visitCount, 0 );</span></a>
<a name="5135"><span class="lineNum">    5135 </span>                :<span class="lineCov">          1 :   visitLine.visitPointsByRegularDistance( 10000, visitor );</span></a>
<a name="5136"><span class="lineNum">    5136 </span>                :<span class="lineCov">          1 :   QCOMPARE( visitCount, 0 );</span></a>
<a name="5137"><span class="lineNum">    5137 </span>                :<span class="lineCov">          1 :   visitLine.visitPointsByRegularDistance( 30, visitor );</span></a>
<a name="5138"><span class="lineNum">    5138 </span>                :<span class="lineCov">          1 :   QCOMPARE( visitCount, 3 );</span></a>
<a name="5139"><span class="lineNum">    5139 </span>                :<span class="lineCov">          1 :   QCOMPARE( xx.at( 0 ), 31.0 );</span></a>
<a name="5140"><span class="lineNum">    5140 </span>                :<span class="lineCov">          1 :   QCOMPARE( yy.at( 0 ), 12.0 );</span></a>
<a name="5141"><span class="lineNum">    5141 </span>                :<span class="lineCov">          1 :   QCOMPARE( zz.at( 0 ), 15.0 );</span></a>
<a name="5142"><span class="lineNum">    5142 </span>                :<span class="lineCov">          1 :   QCOMPARE( mm.at( 0 ), 16.0 );</span></a>
<a name="5143"><span class="lineNum">    5143 </span>                :<span class="lineCov">          1 :   QCOMPARE( pX.at( 0 ), 11.0 );</span></a>
<a name="5144"><span class="lineNum">    5144 </span>                :<span class="lineCov">          1 :   QCOMPARE( pY.at( 0 ), 12.0 );</span></a>
<a name="5145"><span class="lineNum">    5145 </span>                :<span class="lineCov">          1 :   QCOMPARE( pZ.at( 0 ), 13.0 );</span></a>
<a name="5146"><span class="lineNum">    5146 </span>                :<span class="lineCov">          1 :   QCOMPARE( pM.at( 0 ), 14.0 );</span></a>
<a name="5147"><span class="lineNum">    5147 </span>                :<span class="lineCov">          1 :   QCOMPARE( nX.at( 0 ), 111.0 );</span></a>
<a name="5148"><span class="lineNum">    5148 </span>                :<span class="lineCov">          1 :   QCOMPARE( nY.at( 0 ), 12.0 );</span></a>
<a name="5149"><span class="lineNum">    5149 </span>                :<span class="lineCov">          1 :   QCOMPARE( nZ.at( 0 ), 23.0 );</span></a>
<a name="5150"><span class="lineNum">    5150 </span>                :<span class="lineCov">          1 :   QCOMPARE( nM.at( 0 ), 24.0 );</span></a>
<a name="5151"><span class="lineNum">    5151 </span>                :<span class="lineCov">          1 :   QCOMPARE( xx.at( 1 ), 61.0 );</span></a>
<a name="5152"><span class="lineNum">    5152 </span>                :<span class="lineCov">          1 :   QCOMPARE( yy.at( 1 ), 12.0 );</span></a>
<a name="5153"><span class="lineNum">    5153 </span>                :<span class="lineCov">          1 :   QCOMPARE( zz.at( 1 ), 18.0 );</span></a>
<a name="5154"><span class="lineNum">    5154 </span>                :<span class="lineCov">          1 :   QCOMPARE( mm.at( 1 ), 19.0 );</span></a>
<a name="5155"><span class="lineNum">    5155 </span>                :<span class="lineCov">          1 :   QCOMPARE( pX.at( 1 ), 11.0 );</span></a>
<a name="5156"><span class="lineNum">    5156 </span>                :<span class="lineCov">          1 :   QCOMPARE( pY.at( 1 ), 12.0 );</span></a>
<a name="5157"><span class="lineNum">    5157 </span>                :<span class="lineCov">          1 :   QCOMPARE( pZ.at( 1 ), 13.0 );</span></a>
<a name="5158"><span class="lineNum">    5158 </span>                :<span class="lineCov">          1 :   QCOMPARE( pM.at( 1 ), 14.0 );</span></a>
<a name="5159"><span class="lineNum">    5159 </span>                :<span class="lineCov">          1 :   QCOMPARE( nX.at( 1 ), 111.0 );</span></a>
<a name="5160"><span class="lineNum">    5160 </span>                :<span class="lineCov">          1 :   QCOMPARE( nY.at( 1 ), 12.0 );</span></a>
<a name="5161"><span class="lineNum">    5161 </span>                :<span class="lineCov">          1 :   QCOMPARE( nZ.at( 1 ), 23.0 );</span></a>
<a name="5162"><span class="lineNum">    5162 </span>                :<span class="lineCov">          1 :   QCOMPARE( nM.at( 1 ), 24.0 );</span></a>
<a name="5163"><span class="lineNum">    5163 </span>                :<span class="lineCov">          1 :   QCOMPARE( xx.at( 2 ), 91.0 );</span></a>
<a name="5164"><span class="lineNum">    5164 </span>                :<span class="lineCov">          1 :   QCOMPARE( yy.at( 2 ), 12.0 );</span></a>
<a name="5165"><span class="lineNum">    5165 </span>                :<span class="lineCov">          1 :   QCOMPARE( zz.at( 2 ), 21.0 );</span></a>
<a name="5166"><span class="lineNum">    5166 </span>                :<span class="lineCov">          1 :   QCOMPARE( mm.at( 2 ), 22.0 );</span></a>
<a name="5167"><span class="lineNum">    5167 </span>                :<span class="lineCov">          1 :   QCOMPARE( pX.at( 2 ), 11.0 );</span></a>
<a name="5168"><span class="lineNum">    5168 </span>                :<span class="lineCov">          1 :   QCOMPARE( pY.at( 2 ), 12.0 );</span></a>
<a name="5169"><span class="lineNum">    5169 </span>                :<span class="lineCov">          1 :   QCOMPARE( pZ.at( 2 ), 13.0 );</span></a>
<a name="5170"><span class="lineNum">    5170 </span>                :<span class="lineCov">          1 :   QCOMPARE( pM.at( 2 ), 14.0 );</span></a>
<a name="5171"><span class="lineNum">    5171 </span>                :<span class="lineCov">          1 :   QCOMPARE( nX.at( 2 ), 111.0 );</span></a>
<a name="5172"><span class="lineNum">    5172 </span>                :<span class="lineCov">          1 :   QCOMPARE( nY.at( 2 ), 12.0 );</span></a>
<a name="5173"><span class="lineNum">    5173 </span>                :<span class="lineCov">          1 :   QCOMPARE( nZ.at( 2 ), 23.0 );</span></a>
<a name="5174"><span class="lineNum">    5174 </span>                :<span class="lineCov">          1 :   QCOMPARE( nM.at( 2 ), 24.0 );</span></a>
<a name="5175"><span class="lineNum">    5175 </span>                :            : </a>
<a name="5176"><span class="lineNum">    5176 </span>                :            :   // orientation</a>
<a name="5177"><span class="lineNum">    5177 </span>                :<span class="lineCov">          1 :   QgsLineString orientation;</span></a>
<a name="5178"><span class="lineNum">    5178 </span>                :<span class="lineCov">          1 :   ( void )orientation.orientation(); // no crash</span></a>
<a name="5179"><span class="lineNum">    5179 </span>                :<span class="lineCov">          1 :   orientation.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5180"><span class="lineNum">    5180 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::Clockwise );</span></a>
<a name="5181"><span class="lineNum">    5181 </span>                :<span class="lineCov">          1 :   orientation.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5182"><span class="lineNum">    5182 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::CounterClockwise );</span></a>
<a name="5183"><span class="lineNum">    5183 </span>                :            : </a>
<a name="5184"><span class="lineNum">    5184 </span>                :            :   // test bounding box intersects</a>
<a name="5185"><span class="lineNum">    5185 </span>                :<span class="lineCov">          1 :   QgsLineString bb;</span></a>
<a name="5186"><span class="lineNum">    5186 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="5187"><span class="lineNum">    5187 </span>                :<span class="lineCov">          1 :   bb.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 13, -10 ) );</span></a>
<a name="5188"><span class="lineNum">    5188 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 12, 3, 16, 9 ) ) );</span></a>
<a name="5189"><span class="lineNum">    5189 </span>                :            :   // double test because of cache</a>
<a name="5190"><span class="lineNum">    5190 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 12, 3, 16, 9 ) ) );</span></a>
<a name="5191"><span class="lineNum">    5191 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="5192"><span class="lineNum">    5192 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="5193"><span class="lineNum">    5193 </span>                :<span class="lineCov">          1 :   QCOMPARE( bb.boundingBox(), QgsRectangle( 11, -10, 13, 12 ) );</span></a>
<a name="5194"><span class="lineNum">    5194 </span>                :            :   // clear cache</a>
<a name="5195"><span class="lineNum">    5195 </span>                :<span class="lineCov">          1 :   bb.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 13, -10 ) );</span></a>
<a name="5196"><span class="lineNum">    5196 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="5197"><span class="lineNum">    5197 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="5198"><span class="lineNum">    5198 </span>                :<span class="lineCov">          1 :   QCOMPARE( bb.boundingBox(), QgsRectangle( 11, -10, 13, 12 ) );</span></a>
<a name="5199"><span class="lineNum">    5199 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 12, 3, 16, 9 ) ) );</span></a>
<a name="5200"><span class="lineNum">    5200 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="5201"><span class="lineNum">    5201 </span>                :            : </a>
<a name="5202"><span class="lineNum">    5202 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::polygon()</span></a>
<a name="5203"><span class="lineNum">    5203 </span>                :            : {</a>
<a name="5204"><span class="lineNum">    5204 </span>                :            :   //test constructor</a>
<a name="5205"><span class="lineNum">    5205 </span>                :<span class="lineCov">          1 :   QgsPolygon p1;</span></a>
<a name="5206"><span class="lineNum">    5206 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="5207"><span class="lineNum">    5207 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="5208"><span class="lineNum">    5208 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="5209"><span class="lineNum">    5209 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 0 );</span></a>
<a name="5210"><span class="lineNum">    5210 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 0 );</span></a>
<a name="5211"><span class="lineNum">    5211 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.is3D() );</span></a>
<a name="5212"><span class="lineNum">    5212 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isMeasure() );</span></a>
<a name="5213"><span class="lineNum">    5213 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5214"><span class="lineNum">    5214 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wktTypeStr(), QString( &quot;Polygon&quot; ) );</span></a>
<a name="5215"><span class="lineNum">    5215 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.geometryType(), QString( &quot;Polygon&quot; ) );</span></a>
<a name="5216"><span class="lineNum">    5216 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.dimension(), 2 );</span></a>
<a name="5217"><span class="lineNum">    5217 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.hasCurvedSegments() );</span></a>
<a name="5218"><span class="lineNum">    5218 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.area(), 0.0 );</span></a>
<a name="5219"><span class="lineNum">    5219 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.perimeter(), 0.0 );</span></a>
<a name="5220"><span class="lineNum">    5220 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.exteriorRing() );</span></a>
<a name="5221"><span class="lineNum">    5221 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="5222"><span class="lineNum">    5222 </span>                :            : </a>
<a name="5223"><span class="lineNum">    5223 </span>                :            :   //set exterior ring</a>
<a name="5224"><span class="lineNum">    5224 </span>                :            : </a>
<a name="5225"><span class="lineNum">    5225 </span>                :            :   //try with no ring</a>
<a name="5226"><span class="lineNum">    5226 </span>                :<span class="lineCov">          1 :   QgsLineString *ext = nullptr;</span></a>
<a name="5227"><span class="lineNum">    5227 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="5228"><span class="lineNum">    5228 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="5229"><span class="lineNum">    5229 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="5230"><span class="lineNum">    5230 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="5231"><span class="lineNum">    5231 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 0 );</span></a>
<a name="5232"><span class="lineNum">    5232 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 0 );</span></a>
<a name="5233"><span class="lineNum">    5233 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.exteriorRing() );</span></a>
<a name="5234"><span class="lineNum">    5234 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="5235"><span class="lineNum">    5235 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5236"><span class="lineNum">    5236 </span>                :            : </a>
<a name="5237"><span class="lineNum">    5237 </span>                :            :   // empty exterior ring</a>
<a name="5238"><span class="lineNum">    5238 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5239"><span class="lineNum">    5239 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="5240"><span class="lineNum">    5240 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="5241"><span class="lineNum">    5241 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="5242"><span class="lineNum">    5242 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="5243"><span class="lineNum">    5243 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 1 );</span></a>
<a name="5244"><span class="lineNum">    5244 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 1 );</span></a>
<a name="5245"><span class="lineNum">    5245 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.exteriorRing() );</span></a>
<a name="5246"><span class="lineNum">    5246 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="5247"><span class="lineNum">    5247 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5248"><span class="lineNum">    5248 </span>                :            : </a>
<a name="5249"><span class="lineNum">    5249 </span>                :            :   //valid exterior ring</a>
<a name="5250"><span class="lineNum">    5250 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5251"><span class="lineNum">    5251 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5252"><span class="lineNum">    5252 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5253"><span class="lineNum">    5253 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="5254"><span class="lineNum">    5254 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isEmpty() );</span></a>
<a name="5255"><span class="lineNum">    5255 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="5256"><span class="lineNum">    5256 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 5 );</span></a>
<a name="5257"><span class="lineNum">    5257 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 1 );</span></a>
<a name="5258"><span class="lineNum">    5258 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 1 );</span></a>
<a name="5259"><span class="lineNum">    5259 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.is3D() );</span></a>
<a name="5260"><span class="lineNum">    5260 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isMeasure() );</span></a>
<a name="5261"><span class="lineNum">    5261 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5262"><span class="lineNum">    5262 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wktTypeStr(), QString( &quot;Polygon&quot; ) );</span></a>
<a name="5263"><span class="lineNum">    5263 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.geometryType(), QString( &quot;Polygon&quot; ) );</span></a>
<a name="5264"><span class="lineNum">    5264 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.dimension(), 2 );</span></a>
<a name="5265"><span class="lineNum">    5265 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.hasCurvedSegments() );</span></a>
<a name="5266"><span class="lineNum">    5266 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.area(), 100.0 );</span></a>
<a name="5267"><span class="lineNum">    5267 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.perimeter(), 40.0 );</span></a>
<a name="5268"><span class="lineNum">    5268 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.exteriorRing() );</span></a>
<a name="5269"><span class="lineNum">    5269 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="5270"><span class="lineNum">    5270 </span>                :            : </a>
<a name="5271"><span class="lineNum">    5271 </span>                :            :   //retrieve exterior ring and check</a>
<a name="5272"><span class="lineNum">    5272 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( p1.exteriorRing() ) ), *ext );</span></a>
<a name="5273"><span class="lineNum">    5273 </span>                :            : </a>
<a name="5274"><span class="lineNum">    5274 </span>                :            :   //test that a non closed exterior ring will be automatically closed</a>
<a name="5275"><span class="lineNum">    5275 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5276"><span class="lineNum">    5276 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5277"><span class="lineNum">    5277 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) );</span></a>
<a name="5278"><span class="lineNum">    5278 </span>                :<span class="lineCov">          1 :   QVERIFY( !ext-&gt;isClosed() );</span></a>
<a name="5279"><span class="lineNum">    5279 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="5280"><span class="lineNum">    5280 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isEmpty() );</span></a>
<a name="5281"><span class="lineNum">    5281 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.exteriorRing()-&gt;isClosed() );</span></a>
<a name="5282"><span class="lineNum">    5282 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 5 );</span></a>
<a name="5283"><span class="lineNum">    5283 </span>                :            : </a>
<a name="5284"><span class="lineNum">    5284 </span>                :            :   //initial setting of exterior ring should set z/m type</a>
<a name="5285"><span class="lineNum">    5285 </span>                :<span class="lineCov">          1 :   QgsPolygon p2;</span></a>
<a name="5286"><span class="lineNum">    5286 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5287"><span class="lineNum">    5287 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="5288"><span class="lineNum">    5288 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="5289"><span class="lineNum">    5289 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="5290"><span class="lineNum">    5290 </span>                :<span class="lineCov">          1 :   p2.setExteriorRing( ext );</span></a>
<a name="5291"><span class="lineNum">    5291 </span>                :<span class="lineCov">          1 :   QVERIFY( p2.is3D() );</span></a>
<a name="5292"><span class="lineNum">    5292 </span>                :<span class="lineCov">          1 :   QVERIFY( !p2.isMeasure() );</span></a>
<a name="5293"><span class="lineNum">    5293 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.wkbType(), QgsWkbTypes::PolygonZ );</span></a>
<a name="5294"><span class="lineNum">    5294 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.wktTypeStr(), QString( &quot;PolygonZ&quot; ) );</span></a>
<a name="5295"><span class="lineNum">    5295 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.geometryType(), QString( &quot;Polygon&quot; ) );</span></a>
<a name="5296"><span class="lineNum">    5296 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( p2.exteriorRing() ) ), *ext );</span></a>
<a name="5297"><span class="lineNum">    5297 </span>                :<span class="lineCov">          1 :   QgsPolygon p3;</span></a>
<a name="5298"><span class="lineNum">    5298 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5299"><span class="lineNum">    5299 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="5300"><span class="lineNum">    5300 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="5301"><span class="lineNum">    5301 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="5302"><span class="lineNum">    5302 </span>                :<span class="lineCov">          1 :   p3.setExteriorRing( ext );</span></a>
<a name="5303"><span class="lineNum">    5303 </span>                :<span class="lineCov">          1 :   QVERIFY( !p3.is3D() );</span></a>
<a name="5304"><span class="lineNum">    5304 </span>                :<span class="lineCov">          1 :   QVERIFY( p3.isMeasure() );</span></a>
<a name="5305"><span class="lineNum">    5305 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.wkbType(), QgsWkbTypes::PolygonM );</span></a>
<a name="5306"><span class="lineNum">    5306 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.wktTypeStr(), QString( &quot;PolygonM&quot; ) );</span></a>
<a name="5307"><span class="lineNum">    5307 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( p3.exteriorRing() ) ), *ext );</span></a>
<a name="5308"><span class="lineNum">    5308 </span>                :<span class="lineCov">          1 :   QgsPolygon p4;</span></a>
<a name="5309"><span class="lineNum">    5309 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5310"><span class="lineNum">    5310 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 )</span></a>
<a name="5311"><span class="lineNum">    5311 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 3, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 5, 3 )</span></a>
<a name="5312"><span class="lineNum">    5312 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 ) );</span></a>
<a name="5313"><span class="lineNum">    5313 </span>                :<span class="lineCov">          1 :   p4.setExteriorRing( ext );</span></a>
<a name="5314"><span class="lineNum">    5314 </span>                :<span class="lineCov">          1 :   QVERIFY( p4.is3D() );</span></a>
<a name="5315"><span class="lineNum">    5315 </span>                :<span class="lineCov">          1 :   QVERIFY( p4.isMeasure() );</span></a>
<a name="5316"><span class="lineNum">    5316 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.wkbType(), QgsWkbTypes::PolygonZM );</span></a>
<a name="5317"><span class="lineNum">    5317 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.wktTypeStr(), QString( &quot;PolygonZM&quot; ) );</span></a>
<a name="5318"><span class="lineNum">    5318 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( p4.exteriorRing() ) ), *ext );</span></a>
<a name="5319"><span class="lineNum">    5319 </span>                :<span class="lineCov">          1 :   QgsPolygon p5;</span></a>
<a name="5320"><span class="lineNum">    5320 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5321"><span class="lineNum">    5321 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 )</span></a>
<a name="5322"><span class="lineNum">    5322 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 10, 3 )</span></a>
<a name="5323"><span class="lineNum">    5323 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 ) );</span></a>
<a name="5324"><span class="lineNum">    5324 </span>                :<span class="lineCov">          1 :   p5.setExteriorRing( ext );</span></a>
<a name="5325"><span class="lineNum">    5325 </span>                :<span class="lineCov">          1 :   QVERIFY( p5.is3D() );</span></a>
<a name="5326"><span class="lineNum">    5326 </span>                :<span class="lineCov">          1 :   QVERIFY( !p5.isMeasure() );</span></a>
<a name="5327"><span class="lineNum">    5327 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.wkbType(), QgsWkbTypes::Polygon25D );</span></a>
<a name="5328"><span class="lineNum">    5328 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.wktTypeStr(), QString( &quot;PolygonZ&quot; ) );</span></a>
<a name="5329"><span class="lineNum">    5329 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( p5.exteriorRing() ) ), *ext );</span></a>
<a name="5330"><span class="lineNum">    5330 </span>                :            : </a>
<a name="5331"><span class="lineNum">    5331 </span>                :            :   //setting curved exterior ring should be segmentized</a>
<a name="5332"><span class="lineNum">    5332 </span>                :<span class="lineCov">          1 :   QgsCircularString *circularRing = new QgsCircularString();</span></a>
<a name="5333"><span class="lineNum">    5333 </span>                :<span class="lineCov">          2 :   circularRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5334"><span class="lineNum">    5334 </span>                :<span class="lineCov">          1 :                            &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5335"><span class="lineNum">    5335 </span>                :<span class="lineCov">          1 :   QVERIFY( circularRing-&gt;hasCurvedSegments() );</span></a>
<a name="5336"><span class="lineNum">    5336 </span>                :<span class="lineCov">          1 :   p5.setExteriorRing( circularRing );</span></a>
<a name="5337"><span class="lineNum">    5337 </span>                :<span class="lineCov">          1 :   QVERIFY( !p5.exteriorRing()-&gt;hasCurvedSegments() );</span></a>
<a name="5338"><span class="lineNum">    5338 </span>                :<span class="lineCov">          1 :   QCOMPARE( p5.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5339"><span class="lineNum">    5339 </span>                :            : </a>
<a name="5340"><span class="lineNum">    5340 </span>                :            :   //addInteriorRing</a>
<a name="5341"><span class="lineNum">    5341 </span>                :<span class="lineCov">          1 :   QgsPolygon p6;</span></a>
<a name="5342"><span class="lineNum">    5342 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5343"><span class="lineNum">    5343 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5344"><span class="lineNum">    5344 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5345"><span class="lineNum">    5345 </span>                :<span class="lineCov">          1 :   p6.setExteriorRing( ext );</span></a>
<a name="5346"><span class="lineNum">    5346 </span>                :            :   //empty ring</a>
<a name="5347"><span class="lineNum">    5347 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 0 );</span></a>
<a name="5348"><span class="lineNum">    5348 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( -1 ) );</span></a>
<a name="5349"><span class="lineNum">    5349 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 0 ) );</span></a>
<a name="5350"><span class="lineNum">    5350 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( nullptr );</span></a>
<a name="5351"><span class="lineNum">    5351 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 0 );</span></a>
<a name="5352"><span class="lineNum">    5352 </span>                :<span class="lineCov">          1 :   QgsLineString *ring = new QgsLineString();</span></a>
<a name="5353"><span class="lineNum">    5353 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="5354"><span class="lineNum">    5354 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="5355"><span class="lineNum">    5355 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="5356"><span class="lineNum">    5356 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 1 );</span></a>
<a name="5357"><span class="lineNum">    5357 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 0 ), ring );</span></a>
<a name="5358"><span class="lineNum">    5358 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 1 ) );</span></a>
<a name="5359"><span class="lineNum">    5359 </span>                :            : </a>
<a name="5360"><span class="lineNum">    5360 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence seq = p6.coordinateSequence();</span></a>
<a name="5361"><span class="lineNum">    5361 </span>                :<span class="lineCov">          1 :   QCOMPARE( seq, QgsCoordinateSequence() &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5362"><span class="lineNum">    5362 </span>                :            :             &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) )</a>
<a name="5363"><span class="lineNum">    5363 </span>                :            :             &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</a>
<a name="5364"><span class="lineNum">    5364 </span>                :            :                  &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) ) ) );</a>
<a name="5365"><span class="lineNum">    5365 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.nCoordinates(), 10 );</span></a>
<a name="5366"><span class="lineNum">    5366 </span>                :            : </a>
<a name="5367"><span class="lineNum">    5367 </span>                :            :   //add non-closed interior ring, should be closed automatically</a>
<a name="5368"><span class="lineNum">    5368 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5369"><span class="lineNum">    5369 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.1, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="5370"><span class="lineNum">    5370 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 0.9, 0.1 ) );</span></a>
<a name="5371"><span class="lineNum">    5371 </span>                :<span class="lineCov">          1 :   QVERIFY( !ring-&gt;isClosed() );</span></a>
<a name="5372"><span class="lineNum">    5372 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="5373"><span class="lineNum">    5373 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 2 );</span></a>
<a name="5374"><span class="lineNum">    5374 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.interiorRing( 1 )-&gt;isClosed() );</span></a>
<a name="5375"><span class="lineNum">    5375 </span>                :            : </a>
<a name="5376"><span class="lineNum">    5376 </span>                :            :   //try adding an interior ring with z to a 2d polygon, z should be dropped</a>
<a name="5377"><span class="lineNum">    5377 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5378"><span class="lineNum">    5378 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="5379"><span class="lineNum">    5379 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="5380"><span class="lineNum">    5380 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="5381"><span class="lineNum">    5381 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="5382"><span class="lineNum">    5382 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 3 );</span></a>
<a name="5383"><span class="lineNum">    5383 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.is3D() );</span></a>
<a name="5384"><span class="lineNum">    5384 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.isMeasure() );</span></a>
<a name="5385"><span class="lineNum">    5385 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5386"><span class="lineNum">    5386 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.interiorRing( 2 ) );</span></a>
<a name="5387"><span class="lineNum">    5387 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="5388"><span class="lineNum">    5388 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="5389"><span class="lineNum">    5389 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5390"><span class="lineNum">    5390 </span>                :            : </a>
<a name="5391"><span class="lineNum">    5391 </span>                :            :   //try adding an interior ring with m to a 2d polygon, m should be dropped</a>
<a name="5392"><span class="lineNum">    5392 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5393"><span class="lineNum">    5393 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 )</span></a>
<a name="5394"><span class="lineNum">    5394 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.2, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.2, 0, 3 )</span></a>
<a name="5395"><span class="lineNum">    5395 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 ) );</span></a>
<a name="5396"><span class="lineNum">    5396 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="5397"><span class="lineNum">    5397 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 4 );</span></a>
<a name="5398"><span class="lineNum">    5398 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.is3D() );</span></a>
<a name="5399"><span class="lineNum">    5399 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.isMeasure() );</span></a>
<a name="5400"><span class="lineNum">    5400 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5401"><span class="lineNum">    5401 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.interiorRing( 3 ) );</span></a>
<a name="5402"><span class="lineNum">    5402 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 3 )-&gt;is3D() );</span></a>
<a name="5403"><span class="lineNum">    5403 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 3 )-&gt;isMeasure() );</span></a>
<a name="5404"><span class="lineNum">    5404 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 3 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5405"><span class="lineNum">    5405 </span>                :            : </a>
<a name="5406"><span class="lineNum">    5406 </span>                :            :   //addInteriorRing without z/m to PolygonZM</a>
<a name="5407"><span class="lineNum">    5407 </span>                :<span class="lineCov">          1 :   QgsPolygon p6b;</span></a>
<a name="5408"><span class="lineNum">    5408 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5409"><span class="lineNum">    5409 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 )</span></a>
<a name="5410"><span class="lineNum">    5410 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3 )</span></a>
<a name="5411"><span class="lineNum">    5411 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 ) );</span></a>
<a name="5412"><span class="lineNum">    5412 </span>                :<span class="lineCov">          1 :   p6b.setExteriorRing( ext );</span></a>
<a name="5413"><span class="lineNum">    5413 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.is3D() );</span></a>
<a name="5414"><span class="lineNum">    5414 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.isMeasure() );</span></a>
<a name="5415"><span class="lineNum">    5415 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.wkbType(), QgsWkbTypes::PolygonZM );</span></a>
<a name="5416"><span class="lineNum">    5416 </span>                :            :   //ring has no z</a>
<a name="5417"><span class="lineNum">    5417 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5418"><span class="lineNum">    5418 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 9 )</span></a>
<a name="5419"><span class="lineNum">    5419 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1 ) );</span></a>
<a name="5420"><span class="lineNum">    5420 </span>                :<span class="lineCov">          1 :   p6b.addInteriorRing( ring );</span></a>
<a name="5421"><span class="lineNum">    5421 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 ) );</span></a>
<a name="5422"><span class="lineNum">    5422 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="5423"><span class="lineNum">    5423 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5424"><span class="lineNum">    5424 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="5425"><span class="lineNum">    5425 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 0, 2 ) );</span></a>
<a name="5426"><span class="lineNum">    5426 </span>                :            :   //ring has no m</a>
<a name="5427"><span class="lineNum">    5427 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5428"><span class="lineNum">    5428 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="5429"><span class="lineNum">    5429 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="5430"><span class="lineNum">    5430 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="5431"><span class="lineNum">    5431 </span>                :<span class="lineCov">          1 :   p6b.addInteriorRing( ring );</span></a>
<a name="5432"><span class="lineNum">    5432 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 ) );</span></a>
<a name="5433"><span class="lineNum">    5433 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5434"><span class="lineNum">    5434 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5435"><span class="lineNum">    5435 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="5436"><span class="lineNum">    5436 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.1, 1, 0 ) );</span></a>
<a name="5437"><span class="lineNum">    5437 </span>                :            :   //test handling of 25D rings/polygons</a>
<a name="5438"><span class="lineNum">    5438 </span>                :<span class="lineCov">          1 :   QgsPolygon p6c;</span></a>
<a name="5439"><span class="lineNum">    5439 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5440"><span class="lineNum">    5440 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 )</span></a>
<a name="5441"><span class="lineNum">    5441 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 10, 3 )</span></a>
<a name="5442"><span class="lineNum">    5442 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 ) );</span></a>
<a name="5443"><span class="lineNum">    5443 </span>                :<span class="lineCov">          1 :   p6c.setExteriorRing( ext );</span></a>
<a name="5444"><span class="lineNum">    5444 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.is3D() );</span></a>
<a name="5445"><span class="lineNum">    5445 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6c.isMeasure() );</span></a>
<a name="5446"><span class="lineNum">    5446 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.wkbType(), QgsWkbTypes::Polygon25D );</span></a>
<a name="5447"><span class="lineNum">    5447 </span>                :            :   //adding a LineStringZ, should become LineString25D</a>
<a name="5448"><span class="lineNum">    5448 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5449"><span class="lineNum">    5449 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="5450"><span class="lineNum">    5450 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="5451"><span class="lineNum">    5451 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="5452"><span class="lineNum">    5452 </span>                :<span class="lineCov">          1 :   QCOMPARE( ring-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="5453"><span class="lineNum">    5453 </span>                :<span class="lineCov">          1 :   p6c.addInteriorRing( ring );</span></a>
<a name="5454"><span class="lineNum">    5454 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 0 ) );</span></a>
<a name="5455"><span class="lineNum">    5455 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="5456"><span class="lineNum">    5456 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6c.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5457"><span class="lineNum">    5457 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="5458"><span class="lineNum">    5458 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point25D, 0.1, 0.1, 1 ) );</span></a>
<a name="5459"><span class="lineNum">    5459 </span>                :            :   //add a LineStringM, should become LineString25D</a>
<a name="5460"><span class="lineNum">    5460 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5461"><span class="lineNum">    5461 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 )</span></a>
<a name="5462"><span class="lineNum">    5462 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.2, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.2, 0, 3 )</span></a>
<a name="5463"><span class="lineNum">    5463 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 ) );</span></a>
<a name="5464"><span class="lineNum">    5464 </span>                :<span class="lineCov">          1 :   QCOMPARE( ring-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="5465"><span class="lineNum">    5465 </span>                :<span class="lineCov">          1 :   p6c.addInteriorRing( ring );</span></a>
<a name="5466"><span class="lineNum">    5466 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 1 ) );</span></a>
<a name="5467"><span class="lineNum">    5467 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5468"><span class="lineNum">    5468 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6c.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5469"><span class="lineNum">    5469 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="5470"><span class="lineNum">    5470 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point25D, 0.1, 0.1 ) );</span></a>
<a name="5471"><span class="lineNum">    5471 </span>                :            : </a>
<a name="5472"><span class="lineNum">    5472 </span>                :            :   //add curved ring to polygon</a>
<a name="5473"><span class="lineNum">    5473 </span>                :<span class="lineCov">          1 :   circularRing = new QgsCircularString();</span></a>
<a name="5474"><span class="lineNum">    5474 </span>                :<span class="lineCov">          2 :   circularRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5475"><span class="lineNum">    5475 </span>                :<span class="lineCov">          1 :                            &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5476"><span class="lineNum">    5476 </span>                :<span class="lineCov">          1 :   QVERIFY( circularRing-&gt;hasCurvedSegments() );</span></a>
<a name="5477"><span class="lineNum">    5477 </span>                :<span class="lineCov">          1 :   p6c.addInteriorRing( circularRing );</span></a>
<a name="5478"><span class="lineNum">    5478 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 2 ) );</span></a>
<a name="5479"><span class="lineNum">    5479 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6c.interiorRing( 2 )-&gt;hasCurvedSegments() );</span></a>
<a name="5480"><span class="lineNum">    5480 </span>                :<span class="lineCov">          1 :   QVERIFY( p6c.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="5481"><span class="lineNum">    5481 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6c.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="5482"><span class="lineNum">    5482 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6c.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="5483"><span class="lineNum">    5483 </span>                :            : </a>
<a name="5484"><span class="lineNum">    5484 </span>                :            :   // alternate constructor</a>
<a name="5485"><span class="lineNum">    5485 </span>                :<span class="lineCov">          2 :   QgsPolygon pc6( new QgsLineString( QVector&lt;QgsPoint&gt;() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) ),</span></a>
<a name="5486"><span class="lineNum">    5486 </span>                :<span class="lineCov">          1 :                   QList&lt; QgsLineString *&gt;() &lt;&lt; new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 1, 1 ) )</span></a>
<a name="5487"><span class="lineNum">    5487 </span>                :<span class="lineCov">          1 :                   &lt;&lt; new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 3, 1 ) &lt;&lt; QgsPoint( 4, 1 ) &lt;&lt; QgsPoint( 4, 2 ) &lt;&lt; QgsPoint( 3, 2 ) &lt;&lt; QgsPoint( 3, 1 ) ) );</span></a>
<a name="5488"><span class="lineNum">    5488 </span>                :<span class="lineCov">          2 :   QCOMPARE( pc6.asWkt(), QStringLiteral( &quot;Polygon ((0 0, 0 10, 10 10, 10 0, 0 0),(1 1, 2 1, 2 2, 1 2, 1 1),(3 1, 4 1, 4 2, 3 2, 3 1))&quot; ) );</span></a>
<a name="5489"><span class="lineNum">    5489 </span>                :            : </a>
<a name="5490"><span class="lineNum">    5490 </span>                :            :   //set interior rings</a>
<a name="5491"><span class="lineNum">    5491 </span>                :<span class="lineCov">          1 :   QgsPolygon p7;</span></a>
<a name="5492"><span class="lineNum">    5492 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5493"><span class="lineNum">    5493 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5494"><span class="lineNum">    5494 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5495"><span class="lineNum">    5495 </span>                :<span class="lineCov">          1 :   p7.setExteriorRing( ext );</span></a>
<a name="5496"><span class="lineNum">    5496 </span>                :            :   //add a list of rings with mixed types</a>
<a name="5497"><span class="lineNum">    5497 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsCurve * &gt; rings;</span></a>
<a name="5498"><span class="lineNum">    5498 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5499"><span class="lineNum">    5499 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="5500"><span class="lineNum">    5500 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="5501"><span class="lineNum">    5501 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="5502"><span class="lineNum">    5502 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5503"><span class="lineNum">    5503 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 )</span></a>
<a name="5504"><span class="lineNum">    5504 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.4, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.4, 0, 3 )</span></a>
<a name="5505"><span class="lineNum">    5505 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.3, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 ) );</span></a>
<a name="5506"><span class="lineNum">    5506 </span>                :            :   //throw an empty ring in too</a>
<a name="5507"><span class="lineNum">    5507 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; 0;</span></a>
<a name="5508"><span class="lineNum">    5508 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="5509"><span class="lineNum">    5509 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[3] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5510"><span class="lineNum">    5510 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5511"><span class="lineNum">    5511 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="5512"><span class="lineNum">    5512 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 3 );</span></a>
<a name="5513"><span class="lineNum">    5513 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 0 ) );</span></a>
<a name="5514"><span class="lineNum">    5514 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="5515"><span class="lineNum">    5515 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5516"><span class="lineNum">    5516 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5517"><span class="lineNum">    5517 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.1, 0.1 ) );</span></a>
<a name="5518"><span class="lineNum">    5518 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 1 ) );</span></a>
<a name="5519"><span class="lineNum">    5519 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5520"><span class="lineNum">    5520 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5521"><span class="lineNum">    5521 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5522"><span class="lineNum">    5522 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.3, 0.3 ) );</span></a>
<a name="5523"><span class="lineNum">    5523 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 2 ) );</span></a>
<a name="5524"><span class="lineNum">    5524 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="5525"><span class="lineNum">    5525 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="5526"><span class="lineNum">    5526 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5527"><span class="lineNum">    5527 </span>                :            : </a>
<a name="5528"><span class="lineNum">    5528 </span>                :            :   //set rings with existing</a>
<a name="5529"><span class="lineNum">    5529 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="5530"><span class="lineNum">    5530 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5531"><span class="lineNum">    5531 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="5532"><span class="lineNum">    5532 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="5533"><span class="lineNum">    5533 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="5534"><span class="lineNum">    5534 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="5535"><span class="lineNum">    5535 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 1 );</span></a>
<a name="5536"><span class="lineNum">    5536 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 0 ) );</span></a>
<a name="5537"><span class="lineNum">    5537 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="5538"><span class="lineNum">    5538 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5539"><span class="lineNum">    5539 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="5540"><span class="lineNum">    5540 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.8, 0.8 ) );</span></a>
<a name="5541"><span class="lineNum">    5541 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="5542"><span class="lineNum">    5542 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="5543"><span class="lineNum">    5543 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 0 );</span></a>
<a name="5544"><span class="lineNum">    5544 </span>                :            : </a>
<a name="5545"><span class="lineNum">    5545 </span>                :            :   //change dimensionality of interior rings using setExteriorRing</a>
<a name="5546"><span class="lineNum">    5546 </span>                :<span class="lineCov">          1 :   QgsPolygon p7a;</span></a>
<a name="5547"><span class="lineNum">    5547 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5548"><span class="lineNum">    5548 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 )</span></a>
<a name="5549"><span class="lineNum">    5549 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="5550"><span class="lineNum">    5550 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="5551"><span class="lineNum">    5551 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="5552"><span class="lineNum">    5552 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5553"><span class="lineNum">    5553 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="5554"><span class="lineNum">    5554 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="5555"><span class="lineNum">    5555 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="5556"><span class="lineNum">    5556 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5557"><span class="lineNum">    5557 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3, 1 )</span></a>
<a name="5558"><span class="lineNum">    5558 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.4, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.4, 3 )</span></a>
<a name="5559"><span class="lineNum">    5559 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3,  1 ) );</span></a>
<a name="5560"><span class="lineNum">    5560 </span>                :<span class="lineCov">          1 :   p7a.setInteriorRings( rings );</span></a>
<a name="5561"><span class="lineNum">    5561 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.is3D() );</span></a>
<a name="5562"><span class="lineNum">    5562 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.isMeasure() );</span></a>
<a name="5563"><span class="lineNum">    5563 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="5564"><span class="lineNum">    5564 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5565"><span class="lineNum">    5565 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5566"><span class="lineNum">    5566 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5567"><span class="lineNum">    5567 </span>                :            :   //reset exterior ring to 2d</a>
<a name="5568"><span class="lineNum">    5568 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5569"><span class="lineNum">    5569 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="5570"><span class="lineNum">    5570 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5571"><span class="lineNum">    5571 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="5572"><span class="lineNum">    5572 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.is3D() );</span></a>
<a name="5573"><span class="lineNum">    5573 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 0 )-&gt;is3D() ); //rings should also be made 2D</span></a>
<a name="5574"><span class="lineNum">    5574 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5575"><span class="lineNum">    5575 </span>                :            :   //reset exterior ring to LineStringM</a>
<a name="5576"><span class="lineNum">    5576 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5577"><span class="lineNum">    5577 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10 )</span></a>
<a name="5578"><span class="lineNum">    5578 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 ) );</span></a>
<a name="5579"><span class="lineNum">    5579 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="5580"><span class="lineNum">    5580 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.isMeasure() );</span></a>
<a name="5581"><span class="lineNum">    5581 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 0 )-&gt;isMeasure() ); //rings should also gain measure</span></a>
<a name="5582"><span class="lineNum">    5582 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5583"><span class="lineNum">    5583 </span>                :            :   //25D exterior ring</a>
<a name="5584"><span class="lineNum">    5584 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5585"><span class="lineNum">    5585 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 10 )</span></a>
<a name="5586"><span class="lineNum">    5586 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0 ) );</span></a>
<a name="5587"><span class="lineNum">    5587 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="5588"><span class="lineNum">    5588 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.is3D() );</span></a>
<a name="5589"><span class="lineNum">    5589 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.isMeasure() );</span></a>
<a name="5590"><span class="lineNum">    5590 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 0 )-&gt;is3D() ); //rings should also be made 25D</span></a>
<a name="5591"><span class="lineNum">    5591 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="5592"><span class="lineNum">    5592 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="5593"><span class="lineNum">    5593 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="5594"><span class="lineNum">    5594 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7a.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="5595"><span class="lineNum">    5595 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7a.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::LineString25D );</span></a>
<a name="5596"><span class="lineNum">    5596 </span>                :            : </a>
<a name="5597"><span class="lineNum">    5597 </span>                :            : </a>
<a name="5598"><span class="lineNum">    5598 </span>                :            :   //removeInteriorRing</a>
<a name="5599"><span class="lineNum">    5599 </span>                :<span class="lineCov">          1 :   QgsPolygon p8;</span></a>
<a name="5600"><span class="lineNum">    5600 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5601"><span class="lineNum">    5601 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5602"><span class="lineNum">    5602 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5603"><span class="lineNum">    5603 </span>                :<span class="lineCov">          1 :   p8.setExteriorRing( ext );</span></a>
<a name="5604"><span class="lineNum">    5604 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( -1 ) );</span></a>
<a name="5605"><span class="lineNum">    5605 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( 0 ) );</span></a>
<a name="5606"><span class="lineNum">    5606 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="5607"><span class="lineNum">    5607 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5608"><span class="lineNum">    5608 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 )</span></a>
<a name="5609"><span class="lineNum">    5609 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.1, 0.2 ) &lt;&lt; QgsPoint( 0.2, 0.2 )</span></a>
<a name="5610"><span class="lineNum">    5610 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="5611"><span class="lineNum">    5611 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5612"><span class="lineNum">    5612 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.3, 0.3 )</span></a>
<a name="5613"><span class="lineNum">    5613 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.3, 0.4 ) &lt;&lt; QgsPoint( 0.4, 0.4 )</span></a>
<a name="5614"><span class="lineNum">    5614 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.4, 0.3 ) &lt;&lt; QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="5615"><span class="lineNum">    5615 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsLineString();</span></a>
<a name="5616"><span class="lineNum">    5616 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsLineString *&gt;( rings[2] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="5617"><span class="lineNum">    5617 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="5618"><span class="lineNum">    5618 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="5619"><span class="lineNum">    5619 </span>                :<span class="lineCov">          1 :   p8.setInteriorRings( rings );</span></a>
<a name="5620"><span class="lineNum">    5620 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 3 );</span></a>
<a name="5621"><span class="lineNum">    5621 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 0 ) );</span></a>
<a name="5622"><span class="lineNum">    5622 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 2 );</span></a>
<a name="5623"><span class="lineNum">    5623 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="5624"><span class="lineNum">    5624 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="5625"><span class="lineNum">    5625 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 1 ) );</span></a>
<a name="5626"><span class="lineNum">    5626 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 1 );</span></a>
<a name="5627"><span class="lineNum">    5627 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="5628"><span class="lineNum">    5628 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 0 ) );</span></a>
<a name="5629"><span class="lineNum">    5629 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 0 );</span></a>
<a name="5630"><span class="lineNum">    5630 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( 0 ) );</span></a>
<a name="5631"><span class="lineNum">    5631 </span>                :            : </a>
<a name="5632"><span class="lineNum">    5632 </span>                :            :   //clear</a>
<a name="5633"><span class="lineNum">    5633 </span>                :<span class="lineCov">          1 :   QgsPolygon p9;</span></a>
<a name="5634"><span class="lineNum">    5634 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5635"><span class="lineNum">    5635 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="5636"><span class="lineNum">    5636 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="5637"><span class="lineNum">    5637 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="5638"><span class="lineNum">    5638 </span>                :<span class="lineCov">          1 :   p9.setExteriorRing( ext );</span></a>
<a name="5639"><span class="lineNum">    5639 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5640"><span class="lineNum">    5640 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="5641"><span class="lineNum">    5641 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="5642"><span class="lineNum">    5642 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="5643"><span class="lineNum">    5643 </span>                :<span class="lineCov">          1 :   p9.addInteriorRing( ring );</span></a>
<a name="5644"><span class="lineNum">    5644 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.numInteriorRings(), 1 );</span></a>
<a name="5645"><span class="lineNum">    5645 </span>                :<span class="lineCov">          1 :   p9.clear();</span></a>
<a name="5646"><span class="lineNum">    5646 </span>                :<span class="lineCov">          1 :   QVERIFY( p9.isEmpty() );</span></a>
<a name="5647"><span class="lineNum">    5647 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.numInteriorRings(), 0 );</span></a>
<a name="5648"><span class="lineNum">    5648 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.nCoordinates(), 0 );</span></a>
<a name="5649"><span class="lineNum">    5649 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.ringCount(), 0 );</span></a>
<a name="5650"><span class="lineNum">    5650 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.partCount(), 0 );</span></a>
<a name="5651"><span class="lineNum">    5651 </span>                :<span class="lineCov">          1 :   QVERIFY( !p9.is3D() );</span></a>
<a name="5652"><span class="lineNum">    5652 </span>                :<span class="lineCov">          1 :   QVERIFY( !p9.isMeasure() );</span></a>
<a name="5653"><span class="lineNum">    5653 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5654"><span class="lineNum">    5654 </span>                :            : </a>
<a name="5655"><span class="lineNum">    5655 </span>                :            :   //equality operator</a>
<a name="5656"><span class="lineNum">    5656 </span>                :<span class="lineCov">          1 :   QgsPolygon p10;</span></a>
<a name="5657"><span class="lineNum">    5657 </span>                :<span class="lineCov">          1 :   QgsPolygon p10b;</span></a>
<a name="5658"><span class="lineNum">    5658 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="5659"><span class="lineNum">    5659 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="5660"><span class="lineNum">    5660 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5661"><span class="lineNum">    5661 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5662"><span class="lineNum">    5662 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5663"><span class="lineNum">    5663 </span>                :<span class="lineCov">          1 :   p10.setExteriorRing( ext );</span></a>
<a name="5664"><span class="lineNum">    5664 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="5665"><span class="lineNum">    5665 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="5666"><span class="lineNum">    5666 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5667"><span class="lineNum">    5667 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="5668"><span class="lineNum">    5668 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5669"><span class="lineNum">    5669 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="5670"><span class="lineNum">    5670 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="5671"><span class="lineNum">    5671 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="5672"><span class="lineNum">    5672 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5673"><span class="lineNum">    5673 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="5674"><span class="lineNum">    5674 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 9, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5675"><span class="lineNum">    5675 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="5676"><span class="lineNum">    5676 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="5677"><span class="lineNum">    5677 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="5678"><span class="lineNum">    5678 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5679"><span class="lineNum">    5679 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 )</span></a>
<a name="5680"><span class="lineNum">    5680 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="5681"><span class="lineNum">    5681 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="5682"><span class="lineNum">    5682 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="5683"><span class="lineNum">    5683 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="5684"><span class="lineNum">    5684 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( p10.exteriorRing()-&gt;clone() );</span></a>
<a name="5685"><span class="lineNum">    5685 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="5686"><span class="lineNum">    5686 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="5687"><span class="lineNum">    5687 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5688"><span class="lineNum">    5688 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 )</span></a>
<a name="5689"><span class="lineNum">    5689 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="5690"><span class="lineNum">    5690 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="5691"><span class="lineNum">    5691 </span>                :<span class="lineCov">          1 :   p10.addInteriorRing( ring );</span></a>
<a name="5692"><span class="lineNum">    5692 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="5693"><span class="lineNum">    5693 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="5694"><span class="lineNum">    5694 </span>                :            : </a>
<a name="5695"><span class="lineNum">    5695 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5696"><span class="lineNum">    5696 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 1 )</span></a>
<a name="5697"><span class="lineNum">    5697 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="5698"><span class="lineNum">    5698 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 2, 1 ) );</span></a>
<a name="5699"><span class="lineNum">    5699 </span>                :<span class="lineCov">          1 :   p10b.addInteriorRing( ring );</span></a>
<a name="5700"><span class="lineNum">    5700 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="5701"><span class="lineNum">    5701 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="5702"><span class="lineNum">    5702 </span>                :<span class="lineCov">          1 :   p10b.removeInteriorRing( 0 );</span></a>
<a name="5703"><span class="lineNum">    5703 </span>                :<span class="lineCov">          1 :   p10b.addInteriorRing( p10.interiorRing( 0 )-&gt;clone() );</span></a>
<a name="5704"><span class="lineNum">    5704 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="5705"><span class="lineNum">    5705 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="5706"><span class="lineNum">    5706 </span>                :            : </a>
<a name="5707"><span class="lineNum">    5707 </span>                :<span class="lineCov">          1 :   QgsLineString nonPolygon;</span></a>
<a name="5708"><span class="lineNum">    5708 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != nonPolygon );</span></a>
<a name="5709"><span class="lineNum">    5709 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == nonPolygon ) );</span></a>
<a name="5710"><span class="lineNum">    5710 </span>                :            : </a>
<a name="5711"><span class="lineNum">    5711 </span>                :            :   //clone</a>
<a name="5712"><span class="lineNum">    5712 </span>                :            : </a>
<a name="5713"><span class="lineNum">    5713 </span>                :<span class="lineCov">          1 :   QgsPolygon p11;</span></a>
<a name="5714"><span class="lineNum">    5714 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt;cloned( p11.clone() );</span></a>
<a name="5715"><span class="lineNum">    5715 </span>                :<span class="lineCov">          1 :   QCOMPARE( p11, *cloned );</span></a>
<a name="5716"><span class="lineNum">    5716 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5717"><span class="lineNum">    5717 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="5718"><span class="lineNum">    5718 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="5719"><span class="lineNum">    5719 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="5720"><span class="lineNum">    5720 </span>                :<span class="lineCov">          1 :   p11.setExteriorRing( ext );</span></a>
<a name="5721"><span class="lineNum">    5721 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5722"><span class="lineNum">    5722 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="5723"><span class="lineNum">    5723 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="5724"><span class="lineNum">    5724 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="5725"><span class="lineNum">    5725 </span>                :<span class="lineCov">          1 :   p11.addInteriorRing( ring );</span></a>
<a name="5726"><span class="lineNum">    5726 </span>                :<span class="lineCov">          1 :   cloned.reset( p11.clone() );</span></a>
<a name="5727"><span class="lineNum">    5727 </span>                :<span class="lineCov">          1 :   QCOMPARE( p11, *cloned );</span></a>
<a name="5728"><span class="lineNum">    5728 </span>                :            : </a>
<a name="5729"><span class="lineNum">    5729 </span>                :            :   //copy constructor</a>
<a name="5730"><span class="lineNum">    5730 </span>                :<span class="lineCov">          1 :   QgsPolygon p12;</span></a>
<a name="5731"><span class="lineNum">    5731 </span>                :<span class="lineCov">          1 :   QgsPolygon p13( p12 );</span></a>
<a name="5732"><span class="lineNum">    5732 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p13 );</span></a>
<a name="5733"><span class="lineNum">    5733 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5734"><span class="lineNum">    5734 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="5735"><span class="lineNum">    5735 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="5736"><span class="lineNum">    5736 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="5737"><span class="lineNum">    5737 </span>                :<span class="lineCov">          1 :   p12.setExteriorRing( ext );</span></a>
<a name="5738"><span class="lineNum">    5738 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5739"><span class="lineNum">    5739 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="5740"><span class="lineNum">    5740 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="5741"><span class="lineNum">    5741 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="5742"><span class="lineNum">    5742 </span>                :<span class="lineCov">          1 :   p12.addInteriorRing( ring );</span></a>
<a name="5743"><span class="lineNum">    5743 </span>                :<span class="lineCov">          1 :   QgsPolygon p14( p12 );</span></a>
<a name="5744"><span class="lineNum">    5744 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p14 );</span></a>
<a name="5745"><span class="lineNum">    5745 </span>                :            : </a>
<a name="5746"><span class="lineNum">    5746 </span>                :            :   //assignment operator</a>
<a name="5747"><span class="lineNum">    5747 </span>                :<span class="lineCov">          1 :   QgsPolygon p15;</span></a>
<a name="5748"><span class="lineNum">    5748 </span>                :<span class="lineCov">          1 :   p15 = p13;</span></a>
<a name="5749"><span class="lineNum">    5749 </span>                :<span class="lineCov">          1 :   QCOMPARE( p13, p15 );</span></a>
<a name="5750"><span class="lineNum">    5750 </span>                :<span class="lineCov">          1 :   p15 = p12;</span></a>
<a name="5751"><span class="lineNum">    5751 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p15 );</span></a>
<a name="5752"><span class="lineNum">    5752 </span>                :            : </a>
<a name="5753"><span class="lineNum">    5753 </span>                :            :   //surfaceToPolygon - should be identical given polygon has no curves</a>
<a name="5754"><span class="lineNum">    5754 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; surface( p12.surfaceToPolygon() );</span></a>
<a name="5755"><span class="lineNum">    5755 </span>                :<span class="lineCov">          1 :   QCOMPARE( *surface, p12 );</span></a>
<a name="5756"><span class="lineNum">    5756 </span>                :            :   //toPolygon - should be identical given polygon has no curves</a>
<a name="5757"><span class="lineNum">    5757 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; toP( p12.toPolygon() );</span></a>
<a name="5758"><span class="lineNum">    5758 </span>                :<span class="lineCov">          1 :   QCOMPARE( *toP, p12 );</span></a>
<a name="5759"><span class="lineNum">    5759 </span>                :            : </a>
<a name="5760"><span class="lineNum">    5760 </span>                :            :   //toCurveType</a>
<a name="5761"><span class="lineNum">    5761 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt; curveType( p12.toCurveType() );</span></a>
<a name="5762"><span class="lineNum">    5762 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="5763"><span class="lineNum">    5763 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="5764"><span class="lineNum">    5764 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 ) );</span></a>
<a name="5765"><span class="lineNum">    5765 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) );</span></a>
<a name="5766"><span class="lineNum">    5766 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 ) );</span></a>
<a name="5767"><span class="lineNum">    5767 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="5768"><span class="lineNum">    5768 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="5769"><span class="lineNum">    5769 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numInteriorRings(), 1 );</span></a>
<a name="5770"><span class="lineNum">    5770 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;numPoints(), 5 );</span></a>
<a name="5771"><span class="lineNum">    5771 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 ) );</span></a>
<a name="5772"><span class="lineNum">    5772 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) );</span></a>
<a name="5773"><span class="lineNum">    5773 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 ) );</span></a>
<a name="5774"><span class="lineNum">    5774 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="5775"><span class="lineNum">    5775 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="5776"><span class="lineNum">    5776 </span>                :            : </a>
<a name="5777"><span class="lineNum">    5777 </span>                :            :   //to/fromWKB</a>
<a name="5778"><span class="lineNum">    5778 </span>                :<span class="lineCov">          1 :   QgsPolygon p16;</span></a>
<a name="5779"><span class="lineNum">    5779 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5780"><span class="lineNum">    5780 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="5781"><span class="lineNum">    5781 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 10 )</span></a>
<a name="5782"><span class="lineNum">    5782 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 ) );</span></a>
<a name="5783"><span class="lineNum">    5783 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="5784"><span class="lineNum">    5784 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5785"><span class="lineNum">    5785 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 )</span></a>
<a name="5786"><span class="lineNum">    5786 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 9 )</span></a>
<a name="5787"><span class="lineNum">    5787 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 ) );</span></a>
<a name="5788"><span class="lineNum">    5788 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="5789"><span class="lineNum">    5789 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = p16.asWkb();</span></a>
<a name="5790"><span class="lineNum">    5790 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), p16.wkbSize() );</span></a>
<a name="5791"><span class="lineNum">    5791 </span>                :<span class="lineCov">          1 :   QgsPolygon p17;</span></a>
<a name="5792"><span class="lineNum">    5792 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="5793"><span class="lineNum">    5793 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr );</span></a>
<a name="5794"><span class="lineNum">    5794 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="5795"><span class="lineNum">    5795 </span>                :            :   //PolygonZ</a>
<a name="5796"><span class="lineNum">    5796 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="5797"><span class="lineNum">    5797 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5798"><span class="lineNum">    5798 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5799"><span class="lineNum">    5799 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="5800"><span class="lineNum">    5800 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="5801"><span class="lineNum">    5801 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="5802"><span class="lineNum">    5802 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="5803"><span class="lineNum">    5803 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5804"><span class="lineNum">    5804 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="5805"><span class="lineNum">    5805 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="5806"><span class="lineNum">    5806 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="5807"><span class="lineNum">    5807 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="5808"><span class="lineNum">    5808 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="5809"><span class="lineNum">    5809 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), p16.wkbSize() );</span></a>
<a name="5810"><span class="lineNum">    5810 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="5811"><span class="lineNum">    5811 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr2 );</span></a>
<a name="5812"><span class="lineNum">    5812 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="5813"><span class="lineNum">    5813 </span>                :            :   //PolygonM</a>
<a name="5814"><span class="lineNum">    5814 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="5815"><span class="lineNum">    5815 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5816"><span class="lineNum">    5816 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5817"><span class="lineNum">    5817 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="5818"><span class="lineNum">    5818 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10,  0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="5819"><span class="lineNum">    5819 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0,  0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="5820"><span class="lineNum">    5820 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="5821"><span class="lineNum">    5821 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5822"><span class="lineNum">    5822 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 1 )</span></a>
<a name="5823"><span class="lineNum">    5823 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 9, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 9, 0, 3 )</span></a>
<a name="5824"><span class="lineNum">    5824 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 1 ) );</span></a>
<a name="5825"><span class="lineNum">    5825 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="5826"><span class="lineNum">    5826 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="5827"><span class="lineNum">    5827 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="5828"><span class="lineNum">    5828 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr3 );</span></a>
<a name="5829"><span class="lineNum">    5829 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="5830"><span class="lineNum">    5830 </span>                :            :   //PolygonZM</a>
<a name="5831"><span class="lineNum">    5831 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="5832"><span class="lineNum">    5832 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5833"><span class="lineNum">    5833 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5834"><span class="lineNum">    5834 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="5835"><span class="lineNum">    5835 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="5836"><span class="lineNum">    5836 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="5837"><span class="lineNum">    5837 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="5838"><span class="lineNum">    5838 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5839"><span class="lineNum">    5839 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="5840"><span class="lineNum">    5840 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="5841"><span class="lineNum">    5841 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="5842"><span class="lineNum">    5842 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="5843"><span class="lineNum">    5843 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="5844"><span class="lineNum">    5844 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="5845"><span class="lineNum">    5845 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr4 );</span></a>
<a name="5846"><span class="lineNum">    5846 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="5847"><span class="lineNum">    5847 </span>                :            :   //Polygon25D</a>
<a name="5848"><span class="lineNum">    5848 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="5849"><span class="lineNum">    5849 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5850"><span class="lineNum">    5850 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5851"><span class="lineNum">    5851 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 )</span></a>
<a name="5852"><span class="lineNum">    5852 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 10, 3 )</span></a>
<a name="5853"><span class="lineNum">    5853 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 0, 0, 1 ) );</span></a>
<a name="5854"><span class="lineNum">    5854 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="5855"><span class="lineNum">    5855 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5856"><span class="lineNum">    5856 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 1, 1 )</span></a>
<a name="5857"><span class="lineNum">    5857 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 9, 9, 3 )</span></a>
<a name="5858"><span class="lineNum">    5858 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point25D, 1, 1, 1 ) );</span></a>
<a name="5859"><span class="lineNum">    5859 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="5860"><span class="lineNum">    5860 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="5861"><span class="lineNum">    5861 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5862"><span class="lineNum">    5862 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr5( wkb16 );</span></a>
<a name="5863"><span class="lineNum">    5863 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr5 );</span></a>
<a name="5864"><span class="lineNum">    5864 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="5865"><span class="lineNum">    5865 </span>                :            : </a>
<a name="5866"><span class="lineNum">    5866 </span>                :            :   //bad WKB - check for no crash</a>
<a name="5867"><span class="lineNum">    5867 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="5868"><span class="lineNum">    5868 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="5869"><span class="lineNum">    5869 </span>                :<span class="lineCov">          1 :   QVERIFY( !p17.fromWkb( nullPtr ) );</span></a>
<a name="5870"><span class="lineNum">    5870 </span>                :<span class="lineCov">          1 :   QCOMPARE( p17.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5871"><span class="lineNum">    5871 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="5872"><span class="lineNum">    5872 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="5873"><span class="lineNum">    5873 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="5874"><span class="lineNum">    5874 </span>                :<span class="lineCov">          1 :   QVERIFY( !p17.fromWkb( wkbPointPtr ) );</span></a>
<a name="5875"><span class="lineNum">    5875 </span>                :<span class="lineCov">          1 :   QCOMPARE( p17.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5876"><span class="lineNum">    5876 </span>                :            : </a>
<a name="5877"><span class="lineNum">    5877 </span>                :            :   //to/from WKT</a>
<a name="5878"><span class="lineNum">    5878 </span>                :<span class="lineCov">          1 :   QgsPolygon p18;</span></a>
<a name="5879"><span class="lineNum">    5879 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5880"><span class="lineNum">    5880 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="5881"><span class="lineNum">    5881 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="5882"><span class="lineNum">    5882 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="5883"><span class="lineNum">    5883 </span>                :<span class="lineCov">          1 :   p18.setExteriorRing( ext );</span></a>
<a name="5884"><span class="lineNum">    5884 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5885"><span class="lineNum">    5885 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="5886"><span class="lineNum">    5886 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="5887"><span class="lineNum">    5887 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="5888"><span class="lineNum">    5888 </span>                :<span class="lineCov">          1 :   p18.addInteriorRing( ring );</span></a>
<a name="5889"><span class="lineNum">    5889 </span>                :            : </a>
<a name="5890"><span class="lineNum">    5890 </span>                :<span class="lineCov">          1 :   QString wkt = p18.asWkt();</span></a>
<a name="5891"><span class="lineNum">    5891 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="5892"><span class="lineNum">    5892 </span>                :<span class="lineCov">          1 :   QgsPolygon p19;</span></a>
<a name="5893"><span class="lineNum">    5893 </span>                :<span class="lineCov">          1 :   QVERIFY( p19.fromWkt( wkt ) );</span></a>
<a name="5894"><span class="lineNum">    5894 </span>                :<span class="lineCov">          1 :   QCOMPARE( p18, p19 );</span></a>
<a name="5895"><span class="lineNum">    5895 </span>                :            : </a>
<a name="5896"><span class="lineNum">    5896 </span>                :            :   //bad WKT</a>
<a name="5897"><span class="lineNum">    5897 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="5898"><span class="lineNum">    5898 </span>                :<span class="lineCov">          1 :   QVERIFY( p19.isEmpty() );</span></a>
<a name="5899"><span class="lineNum">    5899 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.exteriorRing() );</span></a>
<a name="5900"><span class="lineNum">    5900 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19.numInteriorRings(), 0 );</span></a>
<a name="5901"><span class="lineNum">    5901 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.is3D() );</span></a>
<a name="5902"><span class="lineNum">    5902 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.isMeasure() );</span></a>
<a name="5903"><span class="lineNum">    5903 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="5904"><span class="lineNum">    5904 </span>                :            : </a>
<a name="5905"><span class="lineNum">    5905 </span>                :            :   //as JSON</a>
<a name="5906"><span class="lineNum">    5906 </span>                :<span class="lineCov">          1 :   QgsPolygon exportPolygon;</span></a>
<a name="5907"><span class="lineNum">    5907 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5908"><span class="lineNum">    5908 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="5909"><span class="lineNum">    5909 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 10 )</span></a>
<a name="5910"><span class="lineNum">    5910 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 ) );</span></a>
<a name="5911"><span class="lineNum">    5911 </span>                :<span class="lineCov">          1 :   exportPolygon.setExteriorRing( ext );</span></a>
<a name="5912"><span class="lineNum">    5912 </span>                :            : </a>
<a name="5913"><span class="lineNum">    5913 </span>                :            :   // GML document for compare</a>
<a name="5914"><span class="lineNum">    5914 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="5915"><span class="lineNum">    5915 </span>                :            : </a>
<a name="5916"><span class="lineNum">    5916 </span>                :            :   // as GML2</a>
<a name="5917"><span class="lineNum">    5917 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0,10 10,10 10,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="5918"><span class="lineNum">    5918 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPolygon.asGml2( doc ) ), expectedSimpleGML2 );</span></a>
<a name="5919"><span class="lineNum">    5919 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="5920"><span class="lineNum">    5920 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsPolygon().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="5921"><span class="lineNum">    5921 </span>                :            : </a>
<a name="5922"><span class="lineNum">    5922 </span>                :            :   //as GML3</a>
<a name="5923"><span class="lineNum">    5923 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0 0 0 10 10 10 10 0 0 0&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="5924"><span class="lineNum">    5924 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPolygon.asGml3( doc ) ), expectedSimpleGML3 );</span></a>
<a name="5925"><span class="lineNum">    5925 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="5926"><span class="lineNum">    5926 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsPolygon().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="5927"><span class="lineNum">    5927 </span>                :            : </a>
<a name="5928"><span class="lineNum">    5928 </span>                :            :   // as JSON</a>
<a name="5929"><span class="lineNum">    5929 </span>                :<span class="lineCov">          2 :   QString expectedSimpleJson( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[0.0,10.0],[10.0,10.0],[10.0,0.0],[0.0,0.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; ) );</span></a>
<a name="5930"><span class="lineNum">    5930 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygon.asJson(), expectedSimpleJson );</span></a>
<a name="5931"><span class="lineNum">    5931 </span>                :            : </a>
<a name="5932"><span class="lineNum">    5932 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5933"><span class="lineNum">    5933 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 )</span></a>
<a name="5934"><span class="lineNum">    5934 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 9 )</span></a>
<a name="5935"><span class="lineNum">    5935 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 ) );</span></a>
<a name="5936"><span class="lineNum">    5936 </span>                :<span class="lineCov">          1 :   exportPolygon.addInteriorRing( ring );</span></a>
<a name="5937"><span class="lineNum">    5937 </span>                :            : </a>
<a name="5938"><span class="lineNum">    5938 </span>                :<span class="lineCov">          2 :   QString expectedJson( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[0.0,10.0],[10.0,10.0],[10.0,0.0],[0.0,0.0]],[[1.0,1.0],[1.0,9.0],[9.0,9.0],[9.0,1.0],[1.0,1.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; ) );</span></a>
<a name="5939"><span class="lineNum">    5939 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygon.asJson(), expectedJson );</span></a>
<a name="5940"><span class="lineNum">    5940 </span>                :            : </a>
<a name="5941"><span class="lineNum">    5941 </span>                :<span class="lineCov">          1 :   QgsPolygon exportPolygonFloat;</span></a>
<a name="5942"><span class="lineNum">    5942 </span>                :<span class="lineCov">          1 :   ext = new QgsLineString();</span></a>
<a name="5943"><span class="lineNum">    5943 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 10 / 9.0 )</span></a>
<a name="5944"><span class="lineNum">    5944 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 100 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 100 / 9.0, 100 / 9.0 )</span></a>
<a name="5945"><span class="lineNum">    5945 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 100 / 9.0, 10 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 10 / 9.0 ) );</span></a>
<a name="5946"><span class="lineNum">    5946 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.setExteriorRing( ext );</span></a>
<a name="5947"><span class="lineNum">    5947 </span>                :<span class="lineCov">          1 :   ring = new QgsLineString();</span></a>
<a name="5948"><span class="lineNum">    5948 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 2 / 3.0 )</span></a>
<a name="5949"><span class="lineNum">    5949 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 4 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 4 / 3.0, 4 / 3.0 )</span></a>
<a name="5950"><span class="lineNum">    5950 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 4 / 3.0, 2 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 2 / 3.0 ) );</span></a>
<a name="5951"><span class="lineNum">    5951 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.addInteriorRing( ring );</span></a>
<a name="5952"><span class="lineNum">    5952 </span>                :            : </a>
<a name="5953"><span class="lineNum">    5953 </span>                :<span class="lineCov">          2 :   QString expectedJsonPrec3( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[1.111,1.111],[1.111,11.111],[11.111,11.111],[11.111,1.111],[1.111,1.111]],[[0.667,0.667],[0.667,1.333],[1.333,1.333],[1.333,0.667],[0.667,0.667]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; ) );</span></a>
<a name="5954"><span class="lineNum">    5954 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygonFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="5955"><span class="lineNum">    5955 </span>                :            : </a>
<a name="5956"><span class="lineNum">    5956 </span>                :            :   // as GML2</a>
<a name="5957"><span class="lineNum">    5957 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0,10 10,10 10,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&quot; ) );</span></a>
<a name="5958"><span class="lineNum">    5958 </span>                :<span class="lineCov">          1 :   expectedGML2 += QLatin1String( &quot;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1,1 1,9 9,9 9,1 1,1&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; );</span></a>
<a name="5959"><span class="lineNum">    5959 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPolygon.asGml2( doc ) ), expectedGML2 );</span></a>
<a name="5960"><span class="lineNum">    5960 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1.111,1.111 1.111,11.111 11.111,11.111 11.111,1.111 1.111,1.111&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&quot; ) );</span></a>
<a name="5961"><span class="lineNum">    5961 </span>                :<span class="lineCov">          1 :   expectedGML2prec3 += QLatin1String( &quot;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.667,0.667 0.667,1.333 1.333,1.333 1.333,0.667 0.667,0.667&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; );</span></a>
<a name="5962"><span class="lineNum">    5962 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportPolygonFloat.asGml2( doc, 3 ) ), expectedGML2prec3 );</span></a>
<a name="5963"><span class="lineNum">    5963 </span>                :            : </a>
<a name="5964"><span class="lineNum">    5964 </span>                :            :   //as GML3</a>
<a name="5965"><span class="lineNum">    5965 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0 0 0 10 10 10 10 0 0 0&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&quot; ) );</span></a>
<a name="5966"><span class="lineNum">    5966 </span>                :<span class="lineCov">          1 :   expectedGML3 += QLatin1String( &quot;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1 1 1 9 9 9 9 1 1 1&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; );</span></a>
<a name="5967"><span class="lineNum">    5967 </span>                :            : </a>
<a name="5968"><span class="lineNum">    5968 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPolygon.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="5969"><span class="lineNum">    5969 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1.111 1.111 1.111 11.111 11.111 11.111 11.111 1.111 1.111 1.111&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&quot; ) );</span></a>
<a name="5970"><span class="lineNum">    5970 </span>                :<span class="lineCov">          1 :   expectedGML3prec3 += QLatin1String( &quot;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.667 0.667 0.667 1.333 1.333 1.333 1.333 0.667 0.667 0.667&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; );</span></a>
<a name="5971"><span class="lineNum">    5971 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPolygonFloat.asGml3( doc, 3 ) ), expectedGML3prec3 );</span></a>
<a name="5972"><span class="lineNum">    5972 </span>                :            : </a>
<a name="5973"><span class="lineNum">    5973 </span>                :            :   //asKML</a>
<a name="5974"><span class="lineNum">    5974 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,0 0,10,0 10,10,0 10,0,0 0,0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;1,1,0 1,9,0 9,9,0 9,1,0 1,1,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="5975"><span class="lineNum">    5975 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygon.asKml(), expectedKml );</span></a>
<a name="5976"><span class="lineNum">    5976 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;1.111,1.111,0 1.111,11.111,0 11.111,11.111,0 11.111,1.111,0 1.111,1.111,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.667,0.667,0 0.667,1.333,0 1.333,1.333,0 1.333,0.667,0 0.667,0.667,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="5977"><span class="lineNum">    5977 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygonFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="5978"><span class="lineNum">    5978 </span>                :            : </a>
<a name="5979"><span class="lineNum">    5979 </span>                :            :   //removing the fourth to last vertex removes the whole ring</a>
<a name="5980"><span class="lineNum">    5980 </span>                :<span class="lineCov">          1 :   QgsPolygon p20;</span></a>
<a name="5981"><span class="lineNum">    5981 </span>                :<span class="lineCov">          1 :   QgsLineString *p20ExteriorRing = new QgsLineString();</span></a>
<a name="5982"><span class="lineNum">    5982 </span>                :<span class="lineCov">          1 :   p20ExteriorRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5983"><span class="lineNum">    5983 </span>                :<span class="lineCov">          1 :   p20.setExteriorRing( p20ExteriorRing );</span></a>
<a name="5984"><span class="lineNum">    5984 </span>                :<span class="lineCov">          1 :   QVERIFY( p20.exteriorRing() );</span></a>
<a name="5985"><span class="lineNum">    5985 </span>                :<span class="lineCov">          1 :   p20.deleteVertex( QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="5986"><span class="lineNum">    5986 </span>                :<span class="lineCov">          1 :   QVERIFY( !p20.exteriorRing() );</span></a>
<a name="5987"><span class="lineNum">    5987 </span>                :            : </a>
<a name="5988"><span class="lineNum">    5988 </span>                :            :   //boundary</a>
<a name="5989"><span class="lineNum">    5989 </span>                :<span class="lineCov">          1 :   QgsLineString boundary1;</span></a>
<a name="5990"><span class="lineNum">    5990 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 )  &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="5991"><span class="lineNum">    5991 </span>                :<span class="lineCov">          1 :   QgsPolygon boundaryPolygon;</span></a>
<a name="5992"><span class="lineNum">    5992 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryPolygon.boundary() );</span></a>
<a name="5993"><span class="lineNum">    5993 </span>                :            : </a>
<a name="5994"><span class="lineNum">    5994 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setExteriorRing( boundary1.clone() );</span></a>
<a name="5995"><span class="lineNum">    5995 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = boundaryPolygon.boundary();</span></a>
<a name="5996"><span class="lineNum">    5996 </span>                :<span class="lineCov">          1 :   QgsLineString *lineBoundary = dynamic_cast&lt; QgsLineString * &gt;( boundary );</span></a>
<a name="5997"><span class="lineNum">    5997 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="5998"><span class="lineNum">    5998 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 4 );</span></a>
<a name="5999"><span class="lineNum">    5999 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="6000"><span class="lineNum">    6000 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="6001"><span class="lineNum">    6001 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 2 ), 1.0 );</span></a>
<a name="6002"><span class="lineNum">    6002 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 3 ), 0.0 );</span></a>
<a name="6003"><span class="lineNum">    6003 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="6004"><span class="lineNum">    6004 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="6005"><span class="lineNum">    6005 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 2 ), 1.0 );</span></a>
<a name="6006"><span class="lineNum">    6006 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 3 ), 0.0 );</span></a>
<a name="6007"><span class="lineNum">    6007 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="6008"><span class="lineNum">    6008 </span>                :            : </a>
<a name="6009"><span class="lineNum">    6009 </span>                :            :   // add interior rings</a>
<a name="6010"><span class="lineNum">    6010 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryRing1;</span></a>
<a name="6011"><span class="lineNum">    6011 </span>                :<span class="lineCov">          1 :   boundaryRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.2 )  &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6012"><span class="lineNum">    6012 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryRing2;</span></a>
<a name="6013"><span class="lineNum">    6013 </span>                :<span class="lineCov">          1 :   boundaryRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.9 )  &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="6014"><span class="lineNum">    6014 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; boundaryRing1.clone() &lt;&lt; boundaryRing2.clone() );</span></a>
<a name="6015"><span class="lineNum">    6015 </span>                :<span class="lineCov">          1 :   boundary = boundaryPolygon.boundary();</span></a>
<a name="6016"><span class="lineNum">    6016 </span>                :<span class="lineCov">          1 :   QgsMultiLineString *multiLineBoundary = dynamic_cast&lt; QgsMultiLineString * &gt;( boundary );</span></a>
<a name="6017"><span class="lineNum">    6017 </span>                :<span class="lineCov">          1 :   QVERIFY( multiLineBoundary );</span></a>
<a name="6018"><span class="lineNum">    6018 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLineBoundary-&gt;numGeometries(), 3 );</span></a>
<a name="6019"><span class="lineNum">    6019 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;numPoints(), 4 );</span></a>
<a name="6020"><span class="lineNum">    6020 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="6021"><span class="lineNum">    6021 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="6022"><span class="lineNum">    6022 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 2 ), 1.0 );</span></a>
<a name="6023"><span class="lineNum">    6023 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 3 ), 0.0 );</span></a>
<a name="6024"><span class="lineNum">    6024 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="6025"><span class="lineNum">    6025 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="6026"><span class="lineNum">    6026 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 2 ), 1.0 );</span></a>
<a name="6027"><span class="lineNum">    6027 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 3 ), 0.0 );</span></a>
<a name="6028"><span class="lineNum">    6028 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;numPoints(), 4 );</span></a>
<a name="6029"><span class="lineNum">    6029 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 0 ), 0.1 );</span></a>
<a name="6030"><span class="lineNum">    6030 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 1 ), 0.2 );</span></a>
<a name="6031"><span class="lineNum">    6031 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 2 ), 0.2 );</span></a>
<a name="6032"><span class="lineNum">    6032 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 3 ), 0.1 );</span></a>
<a name="6033"><span class="lineNum">    6033 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 0 ), 0.1 );</span></a>
<a name="6034"><span class="lineNum">    6034 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 1 ), 0.1 );</span></a>
<a name="6035"><span class="lineNum">    6035 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 2 ), 0.2 );</span></a>
<a name="6036"><span class="lineNum">    6036 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 3 ), 0.1 );</span></a>
<a name="6037"><span class="lineNum">    6037 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;numPoints(), 4 );</span></a>
<a name="6038"><span class="lineNum">    6038 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 0 ), 0.8 );</span></a>
<a name="6039"><span class="lineNum">    6039 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 1 ), 0.9 );</span></a>
<a name="6040"><span class="lineNum">    6040 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 2 ), 0.9 );</span></a>
<a name="6041"><span class="lineNum">    6041 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 3 ), 0.8 );</span></a>
<a name="6042"><span class="lineNum">    6042 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 0 ), 0.8 );</span></a>
<a name="6043"><span class="lineNum">    6043 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 1 ), 0.8 );</span></a>
<a name="6044"><span class="lineNum">    6044 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 2 ), 0.9 );</span></a>
<a name="6045"><span class="lineNum">    6045 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 3 ), 0.8 );</span></a>
<a name="6046"><span class="lineNum">    6046 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setInteriorRings( QVector&lt; QgsCurve * &gt;() );</span></a>
<a name="6047"><span class="lineNum">    6047 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="6048"><span class="lineNum">    6048 </span>                :            : </a>
<a name="6049"><span class="lineNum">    6049 </span>                :            :   //test boundary with z</a>
<a name="6050"><span class="lineNum">    6050 </span>                :<span class="lineCov">          2 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 )</span></a>
<a name="6051"><span class="lineNum">    6051 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) );</span></a>
<a name="6052"><span class="lineNum">    6052 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setExteriorRing( boundary1.clone() );</span></a>
<a name="6053"><span class="lineNum">    6053 </span>                :<span class="lineCov">          1 :   boundary = boundaryPolygon.boundary();</span></a>
<a name="6054"><span class="lineNum">    6054 </span>                :<span class="lineCov">          1 :   lineBoundary = dynamic_cast&lt; QgsLineString * &gt;( boundary );</span></a>
<a name="6055"><span class="lineNum">    6055 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="6056"><span class="lineNum">    6056 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 4 );</span></a>
<a name="6057"><span class="lineNum">    6057 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="6058"><span class="lineNum">    6058 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;zAt( 0 ), 10.0 );</span></a>
<a name="6059"><span class="lineNum">    6059 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;zAt( 1 ), 15.0 );</span></a>
<a name="6060"><span class="lineNum">    6060 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;zAt( 2 ), 20.0 );</span></a>
<a name="6061"><span class="lineNum">    6061 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;zAt( 3 ), 10.0 );</span></a>
<a name="6062"><span class="lineNum">    6062 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="6063"><span class="lineNum">    6063 </span>                :            : </a>
<a name="6064"><span class="lineNum">    6064 </span>                :            :   // point distance to boundary</a>
<a name="6065"><span class="lineNum">    6065 </span>                :            : </a>
<a name="6066"><span class="lineNum">    6066 </span>                :<span class="lineCov">          1 :   QgsLineString pd1;</span></a>
<a name="6067"><span class="lineNum">    6067 </span>                :<span class="lineCov">          1 :   pd1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="6068"><span class="lineNum">    6068 </span>                :<span class="lineCov">          1 :   QgsPolygon pd;</span></a>
<a name="6069"><span class="lineNum">    6069 </span>                :            :   // no meaning, but let's not crash</a>
<a name="6070"><span class="lineNum">    6070 </span>                :<span class="lineCov">          1 :   ( void )pd.pointDistanceToBoundary( 0, 0 );</span></a>
<a name="6071"><span class="lineNum">    6071 </span>                :            : </a>
<a name="6072"><span class="lineNum">    6072 </span>                :<span class="lineCov">          1 :   pd.setExteriorRing( pd1.clone() );</span></a>
<a name="6073"><span class="lineNum">    6073 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0, 0.5 ), 0.0, 0.0000000001 );</span></a>
<a name="6074"><span class="lineNum">    6074 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0.1, 0.5 ), 0.1, 0.0000000001 );</span></a>
<a name="6075"><span class="lineNum">    6075 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( -0.1, 0.5 ), -0.1, 0.0000000001 );</span></a>
<a name="6076"><span class="lineNum">    6076 </span>                :            :   // with a ring</a>
<a name="6077"><span class="lineNum">    6077 </span>                :<span class="lineCov">          1 :   QgsLineString pdRing1;</span></a>
<a name="6078"><span class="lineNum">    6078 </span>                :<span class="lineCov">          1 :   pdRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.6 )  &lt;&lt; QgsPoint( 0.1, 0.6 ) &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6079"><span class="lineNum">    6079 </span>                :<span class="lineCov">          1 :   pd.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; pdRing1.clone() );</span></a>
<a name="6080"><span class="lineNum">    6080 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0, 0.5 ), 0.0, 0.0000000001 );</span></a>
<a name="6081"><span class="lineNum">    6081 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0.1, 0.5 ), 0.0, 0.0000000001 );</span></a>
<a name="6082"><span class="lineNum">    6082 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0.01, 0.5 ), 0.01, 0.0000000001 );</span></a>
<a name="6083"><span class="lineNum">    6083 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0.08, 0.5 ), 0.02, 0.0000000001 );</span></a>
<a name="6084"><span class="lineNum">    6084 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( 0.12, 0.5 ), -0.02, 0.0000000001 );</span></a>
<a name="6085"><span class="lineNum">    6085 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pd.pointDistanceToBoundary( -0.1, 0.5 ), -0.1, 0.0000000001 );</span></a>
<a name="6086"><span class="lineNum">    6086 </span>                :            : </a>
<a name="6087"><span class="lineNum">    6087 </span>                :            :   // remove interior rings</a>
<a name="6088"><span class="lineNum">    6088 </span>                :<span class="lineCov">          1 :   QgsLineString removeRingsExt;</span></a>
<a name="6089"><span class="lineNum">    6089 </span>                :<span class="lineCov">          1 :   removeRingsExt.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 )  &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="6090"><span class="lineNum">    6090 </span>                :<span class="lineCov">          1 :   QgsPolygon removeRings1;</span></a>
<a name="6091"><span class="lineNum">    6091 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="6092"><span class="lineNum">    6092 </span>                :            : </a>
<a name="6093"><span class="lineNum">    6093 </span>                :<span class="lineCov">          1 :   removeRings1.setExteriorRing( boundary1.clone() );</span></a>
<a name="6094"><span class="lineNum">    6094 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="6095"><span class="lineNum">    6095 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="6096"><span class="lineNum">    6096 </span>                :            : </a>
<a name="6097"><span class="lineNum">    6097 </span>                :            :   // add interior rings</a>
<a name="6098"><span class="lineNum">    6098 </span>                :<span class="lineCov">          1 :   QgsLineString removeRingsRing1;</span></a>
<a name="6099"><span class="lineNum">    6099 </span>                :<span class="lineCov">          1 :   removeRingsRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.2 )  &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6100"><span class="lineNum">    6100 </span>                :<span class="lineCov">          1 :   QgsLineString removeRingsRing2;</span></a>
<a name="6101"><span class="lineNum">    6101 </span>                :<span class="lineCov">          1 :   removeRingsRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.6, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.9 )  &lt;&lt; QgsPoint( 0.6, 0.8 ) );</span></a>
<a name="6102"><span class="lineNum">    6102 </span>                :<span class="lineCov">          1 :   removeRings1.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; removeRingsRing1.clone() &lt;&lt; removeRingsRing2.clone() );</span></a>
<a name="6103"><span class="lineNum">    6103 </span>                :            : </a>
<a name="6104"><span class="lineNum">    6104 </span>                :            :   // remove ring with size filter</a>
<a name="6105"><span class="lineNum">    6105 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings( 0.0075 );</span></a>
<a name="6106"><span class="lineNum">    6106 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 1 );</span></a>
<a name="6107"><span class="lineNum">    6107 </span>                :            : </a>
<a name="6108"><span class="lineNum">    6108 </span>                :            :   // remove ring with no size filter</a>
<a name="6109"><span class="lineNum">    6109 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="6110"><span class="lineNum">    6110 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="6111"><span class="lineNum">    6111 </span>                :            : </a>
<a name="6112"><span class="lineNum">    6112 </span>                :            :   // cast</a>
<a name="6113"><span class="lineNum">    6113 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsPolygon().cast( nullptr ) );</span></a>
<a name="6114"><span class="lineNum">    6114 </span>                :<span class="lineCov">          1 :   QgsPolygon pCast;</span></a>
<a name="6115"><span class="lineNum">    6115 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast ) );</span></a>
<a name="6116"><span class="lineNum">    6116 </span>                :<span class="lineCov">          1 :   QgsPolygon pCast2;</span></a>
<a name="6117"><span class="lineNum">    6117 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;PolygonZ((0 0 0, 0 1 1, 1 0 2, 0 0 0))&quot; ) );</span></a>
<a name="6118"><span class="lineNum">    6118 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="6119"><span class="lineNum">    6119 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;PolygonM((0 0 1, 0 1 2, 1 0 3, 0 0 1))&quot; ) );</span></a>
<a name="6120"><span class="lineNum">    6120 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="6121"><span class="lineNum">    6121 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;PolygonZM((0 0 0 1, 0 1 1 2, 1 0 2 3, 0 0 0 1))&quot; ) );</span></a>
<a name="6122"><span class="lineNum">    6122 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="6123"><span class="lineNum">    6123 </span>                :            : </a>
<a name="6124"><span class="lineNum">    6124 </span>                :            :   //transform</a>
<a name="6125"><span class="lineNum">    6125 </span>                :            :   //CRS transform</a>
<a name="6126"><span class="lineNum">    6126 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="6127"><span class="lineNum">    6127 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) ); // want a transform with ellipsoid change</span></a>
<a name="6128"><span class="lineNum">    6128 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="6129"><span class="lineNum">    6129 </span>                :            : </a>
<a name="6130"><span class="lineNum">    6130 </span>                :            :   // 2d CRS transform</a>
<a name="6131"><span class="lineNum">    6131 </span>                :<span class="lineCov">          1 :   QgsPolygon pTransform;</span></a>
<a name="6132"><span class="lineNum">    6132 </span>                :<span class="lineCov">          1 :   QgsLineString l21;</span></a>
<a name="6133"><span class="lineNum">    6133 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6374985, -3626584 )</span></a>
<a name="6134"><span class="lineNum">    6134 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6274985, -3526584 )</span></a>
<a name="6135"><span class="lineNum">    6135 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6474985, -3526584 )</span></a>
<a name="6136"><span class="lineNum">    6136 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6374985, -3626584 ) );</span></a>
<a name="6137"><span class="lineNum">    6137 </span>                :<span class="lineCov">          1 :   pTransform.setExteriorRing( l21.clone() );</span></a>
<a name="6138"><span class="lineNum">    6138 </span>                :<span class="lineCov">          1 :   pTransform.addInteriorRing( l21.clone() );</span></a>
<a name="6139"><span class="lineNum">    6139 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="6140"><span class="lineNum">    6140 </span>                :<span class="lineCov">          1 :   const QgsLineString *extR = static_cast&lt; const QgsLineString * &gt;( pTransform.exteriorRing() );</span></a>
<a name="6141"><span class="lineNum">    6141 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="6142"><span class="lineNum">    6142 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="6143"><span class="lineNum">    6143 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="6144"><span class="lineNum">    6144 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="6145"><span class="lineNum">    6145 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="6146"><span class="lineNum">    6146 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="6147"><span class="lineNum">    6147 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="6148"><span class="lineNum">    6148 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="6149"><span class="lineNum">    6149 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="6150"><span class="lineNum">    6150 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="6151"><span class="lineNum">    6151 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="6152"><span class="lineNum">    6152 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="6153"><span class="lineNum">    6153 </span>                :<span class="lineCov">          1 :   const QgsLineString *intR = static_cast&lt; const QgsLineString * &gt;( pTransform.interiorRing( 0 ) );</span></a>
<a name="6154"><span class="lineNum">    6154 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="6155"><span class="lineNum">    6155 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="6156"><span class="lineNum">    6156 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="6157"><span class="lineNum">    6157 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="6158"><span class="lineNum">    6158 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="6159"><span class="lineNum">    6159 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="6160"><span class="lineNum">    6160 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="6161"><span class="lineNum">    6161 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="6162"><span class="lineNum">    6162 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="6163"><span class="lineNum">    6163 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="6164"><span class="lineNum">    6164 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="6165"><span class="lineNum">    6165 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="6166"><span class="lineNum">    6166 </span>                :            : </a>
<a name="6167"><span class="lineNum">    6167 </span>                :            :   //3d CRS transform</a>
<a name="6168"><span class="lineNum">    6168 </span>                :<span class="lineCov">          1 :   QgsLineString l22;</span></a>
<a name="6169"><span class="lineNum">    6169 </span>                :<span class="lineCov">          2 :   l22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 )</span></a>
<a name="6170"><span class="lineNum">    6170 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6274985, -3526584, 3, 4 )</span></a>
<a name="6171"><span class="lineNum">    6171 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6474985, -3526584, 5, 6 )</span></a>
<a name="6172"><span class="lineNum">    6172 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 ) );</span></a>
<a name="6173"><span class="lineNum">    6173 </span>                :<span class="lineCov">          1 :   pTransform.clear();</span></a>
<a name="6174"><span class="lineNum">    6174 </span>                :<span class="lineCov">          1 :   pTransform.setExteriorRing( l22.clone() );</span></a>
<a name="6175"><span class="lineNum">    6175 </span>                :<span class="lineCov">          1 :   pTransform.addInteriorRing( l22.clone() );</span></a>
<a name="6176"><span class="lineNum">    6176 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="6177"><span class="lineNum">    6177 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.exteriorRing() );</span></a>
<a name="6178"><span class="lineNum">    6178 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="6179"><span class="lineNum">    6179 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="6180"><span class="lineNum">    6180 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="6181"><span class="lineNum">    6181 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="6182"><span class="lineNum">    6182 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="6183"><span class="lineNum">    6183 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="6184"><span class="lineNum">    6184 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="6185"><span class="lineNum">    6185 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="6186"><span class="lineNum">    6186 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="6187"><span class="lineNum">    6187 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="6188"><span class="lineNum">    6188 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="6189"><span class="lineNum">    6189 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="6190"><span class="lineNum">    6190 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="6191"><span class="lineNum">    6191 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="6192"><span class="lineNum">    6192 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="6193"><span class="lineNum">    6193 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="6194"><span class="lineNum">    6194 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="6195"><span class="lineNum">    6195 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="6196"><span class="lineNum">    6196 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="6197"><span class="lineNum">    6197 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="6198"><span class="lineNum">    6198 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.interiorRing( 0 ) );</span></a>
<a name="6199"><span class="lineNum">    6199 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="6200"><span class="lineNum">    6200 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="6201"><span class="lineNum">    6201 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="6202"><span class="lineNum">    6202 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="6203"><span class="lineNum">    6203 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="6204"><span class="lineNum">    6204 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="6205"><span class="lineNum">    6205 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="6206"><span class="lineNum">    6206 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="6207"><span class="lineNum">    6207 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="6208"><span class="lineNum">    6208 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="6209"><span class="lineNum">    6209 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="6210"><span class="lineNum">    6210 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="6211"><span class="lineNum">    6211 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="6212"><span class="lineNum">    6212 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="6213"><span class="lineNum">    6213 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="6214"><span class="lineNum">    6214 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="6215"><span class="lineNum">    6215 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="6216"><span class="lineNum">    6216 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="6217"><span class="lineNum">    6217 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="6218"><span class="lineNum">    6218 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.interiorRing( 0 )-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="6219"><span class="lineNum">    6219 </span>                :            : </a>
<a name="6220"><span class="lineNum">    6220 </span>                :            :   //reverse transform</a>
<a name="6221"><span class="lineNum">    6221 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="6222"><span class="lineNum">    6222 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.exteriorRing() );</span></a>
<a name="6223"><span class="lineNum">    6223 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 6374984, 100 );</span></a>
<a name="6224"><span class="lineNum">    6224 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -3626584, 100 );</span></a>
<a name="6225"><span class="lineNum">    6225 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="6226"><span class="lineNum">    6226 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="6227"><span class="lineNum">    6227 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(), 6274984, 100 );</span></a>
<a name="6228"><span class="lineNum">    6228 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -3526584, 100 );</span></a>
<a name="6229"><span class="lineNum">    6229 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="6230"><span class="lineNum">    6230 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="6231"><span class="lineNum">    6231 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  6474984, 100 );</span></a>
<a name="6232"><span class="lineNum">    6232 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -3526584, 100 );</span></a>
<a name="6233"><span class="lineNum">    6233 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="6234"><span class="lineNum">    6234 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="6235"><span class="lineNum">    6235 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  6374984, 100 );</span></a>
<a name="6236"><span class="lineNum">    6236 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -3626584, 100 );</span></a>
<a name="6237"><span class="lineNum">    6237 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="6238"><span class="lineNum">    6238 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="6239"><span class="lineNum">    6239 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMinimum(), 6274984, 100 );</span></a>
<a name="6240"><span class="lineNum">    6240 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMinimum(), -3626584, 100 );</span></a>
<a name="6241"><span class="lineNum">    6241 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().xMaximum(), 6474984, 100 );</span></a>
<a name="6242"><span class="lineNum">    6242 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform.exteriorRing()-&gt;boundingBox().yMaximum(), -3526584, 100 );</span></a>
<a name="6243"><span class="lineNum">    6243 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.interiorRing( 0 ) );</span></a>
<a name="6244"><span class="lineNum">    6244 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 6374984, 100 );</span></a>
<a name="6245"><span class="lineNum">    6245 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -3626584, 100 );</span></a>
<a name="6246"><span class="lineNum">    6246 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="6247"><span class="lineNum">    6247 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="6248"><span class="lineNum">    6248 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(), 6274984, 100 );</span></a>
<a name="6249"><span class="lineNum">    6249 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -3526584, 100 );</span></a>
<a name="6250"><span class="lineNum">    6250 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="6251"><span class="lineNum">    6251 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="6252"><span class="lineNum">    6252 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  6474984, 100 );</span></a>
<a name="6253"><span class="lineNum">    6253 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -3526584, 100 );</span></a>
<a name="6254"><span class="lineNum">    6254 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="6255"><span class="lineNum">    6255 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="6256"><span class="lineNum">    6256 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  6374984, 100 );</span></a>
<a name="6257"><span class="lineNum">    6257 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -3626584, 100 );</span></a>
<a name="6258"><span class="lineNum">    6258 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="6259"><span class="lineNum">    6259 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="6260"><span class="lineNum">    6260 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 6274984, 100 );</span></a>
<a name="6261"><span class="lineNum">    6261 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), -3626584, 100 );</span></a>
<a name="6262"><span class="lineNum">    6262 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 6474984, 100 );</span></a>
<a name="6263"><span class="lineNum">    6263 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), -3526584, 100 );</span></a>
<a name="6264"><span class="lineNum">    6264 </span>                :            : </a>
<a name="6265"><span class="lineNum">    6265 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="6266"><span class="lineNum">    6266 </span>                :            :   //z value transform</a>
<a name="6267"><span class="lineNum">    6267 </span>                :            :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="6268"><span class="lineNum">    6268 </span>                :            :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.exteriorRing() );</a>
<a name="6269"><span class="lineNum">    6269 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="6270"><span class="lineNum">    6270 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), -19.148357, 0.001 );</a>
<a name="6271"><span class="lineNum">    6271 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), -19.092128, 0.001 );</a>
<a name="6272"><span class="lineNum">    6272 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), -19.249066, 0.001 );</a>
<a name="6273"><span class="lineNum">    6273 </span>                :            :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.interiorRing( 0 ) );</a>
<a name="6274"><span class="lineNum">    6274 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="6275"><span class="lineNum">    6275 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), -19.148357, 0.001 );</a>
<a name="6276"><span class="lineNum">    6276 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), -19.092128, 0.001 );</a>
<a name="6277"><span class="lineNum">    6277 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), -19.249066, 0.001 );</a>
<a name="6278"><span class="lineNum">    6278 </span>                :            :   pTransform.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="6279"><span class="lineNum">    6279 </span>                :            :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.exteriorRing() );</a>
<a name="6280"><span class="lineNum">    6280 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1, 0.001 );</a>
<a name="6281"><span class="lineNum">    6281 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3, 0.001 );</a>
<a name="6282"><span class="lineNum">    6282 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5, 0.001 );</a>
<a name="6283"><span class="lineNum">    6283 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1, 0.001 );</a>
<a name="6284"><span class="lineNum">    6284 </span>                :            :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.interiorRing( 0 ) );</a>
<a name="6285"><span class="lineNum">    6285 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1, 0.001 );</a>
<a name="6286"><span class="lineNum">    6286 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3, 0.001 );</a>
<a name="6287"><span class="lineNum">    6287 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5, 0.001 );</a>
<a name="6288"><span class="lineNum">    6288 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1, 0.001 );</a>
<a name="6289"><span class="lineNum">    6289 </span>                :            : #endif</a>
<a name="6290"><span class="lineNum">    6290 </span>                :            : </a>
<a name="6291"><span class="lineNum">    6291 </span>                :            :   //QTransform transform</a>
<a name="6292"><span class="lineNum">    6292 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="6293"><span class="lineNum">    6293 </span>                :<span class="lineCov">          1 :   QgsLineString l23;</span></a>
<a name="6294"><span class="lineNum">    6294 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="6295"><span class="lineNum">    6295 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 )</span></a>
<a name="6296"><span class="lineNum">    6296 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 12, 23, 24 )</span></a>
<a name="6297"><span class="lineNum">    6297 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="6298"><span class="lineNum">    6298 </span>                :<span class="lineCov">          1 :   QgsPolygon pTransform2;</span></a>
<a name="6299"><span class="lineNum">    6299 </span>                :<span class="lineCov">          1 :   pTransform2.setExteriorRing( l23.clone() );</span></a>
<a name="6300"><span class="lineNum">    6300 </span>                :<span class="lineCov">          1 :   pTransform2.addInteriorRing( l23.clone() );</span></a>
<a name="6301"><span class="lineNum">    6301 </span>                :<span class="lineCov">          1 :   pTransform2.transform( qtr, 2, 3, 4, 5 );</span></a>
<a name="6302"><span class="lineNum">    6302 </span>                :            : </a>
<a name="6303"><span class="lineNum">    6303 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform2.exteriorRing() );</span></a>
<a name="6304"><span class="lineNum">    6304 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 2, 100 );</span></a>
<a name="6305"><span class="lineNum">    6305 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), 6, 100 );</span></a>
<a name="6306"><span class="lineNum">    6306 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 11.0, 0.001 );</span></a>
<a name="6307"><span class="lineNum">    6307 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 24.0, 0.001 );</span></a>
<a name="6308"><span class="lineNum">    6308 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(), 22, 100 );</span></a>
<a name="6309"><span class="lineNum">    6309 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), 36, 100 );</span></a>
<a name="6310"><span class="lineNum">    6310 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 41.0, 0.001 );</span></a>
<a name="6311"><span class="lineNum">    6311 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 74.0, 0.001 );</span></a>
<a name="6312"><span class="lineNum">    6312 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  2, 100 );</span></a>
<a name="6313"><span class="lineNum">    6313 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), 36, 100 );</span></a>
<a name="6314"><span class="lineNum">    6314 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 71.0, 0.001 );</span></a>
<a name="6315"><span class="lineNum">    6315 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 124.0, 0.001 );</span></a>
<a name="6316"><span class="lineNum">    6316 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(), 2, 100 );</span></a>
<a name="6317"><span class="lineNum">    6317 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), 6, 100 );</span></a>
<a name="6318"><span class="lineNum">    6318 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 11.0, 0.001 );</span></a>
<a name="6319"><span class="lineNum">    6319 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 24.0, 0.001 );</span></a>
<a name="6320"><span class="lineNum">    6320 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform2.exteriorRing()-&gt;boundingBox().xMinimum(), 2, 0.001 );</span></a>
<a name="6321"><span class="lineNum">    6321 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform2.exteriorRing()-&gt;boundingBox().yMinimum(), 6, 0.001 );</span></a>
<a name="6322"><span class="lineNum">    6322 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform2.exteriorRing()-&gt;boundingBox().xMaximum(), 22, 0.001 );</span></a>
<a name="6323"><span class="lineNum">    6323 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pTransform2.exteriorRing()-&gt;boundingBox().yMaximum(), 36, 0.001 );</span></a>
<a name="6324"><span class="lineNum">    6324 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform2.interiorRing( 0 ) );</span></a>
<a name="6325"><span class="lineNum">    6325 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 2, 100 );</span></a>
<a name="6326"><span class="lineNum">    6326 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), 6, 100 );</span></a>
<a name="6327"><span class="lineNum">    6327 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 11.0, 0.001 );</span></a>
<a name="6328"><span class="lineNum">    6328 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 24.0, 0.001 );</span></a>
<a name="6329"><span class="lineNum">    6329 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(), 22, 100 );</span></a>
<a name="6330"><span class="lineNum">    6330 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), 36, 100 );</span></a>
<a name="6331"><span class="lineNum">    6331 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 41.0, 0.001 );</span></a>
<a name="6332"><span class="lineNum">    6332 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 74.0, 0.001 );</span></a>
<a name="6333"><span class="lineNum">    6333 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  2, 100 );</span></a>
<a name="6334"><span class="lineNum">    6334 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), 36, 100 );</span></a>
<a name="6335"><span class="lineNum">    6335 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 71.0, 0.001 );</span></a>
<a name="6336"><span class="lineNum">    6336 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 124.0, 0.001 );</span></a>
<a name="6337"><span class="lineNum">    6337 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(), 2, 100 );</span></a>
<a name="6338"><span class="lineNum">    6338 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), 6, 100 );</span></a>
<a name="6339"><span class="lineNum">    6339 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 11.0, 0.001 );</span></a>
<a name="6340"><span class="lineNum">    6340 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 24.0, 0.001 );</span></a>
<a name="6341"><span class="lineNum">    6341 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 2, 0.001 );</span></a>
<a name="6342"><span class="lineNum">    6342 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), 6, 0.001 );</span></a>
<a name="6343"><span class="lineNum">    6343 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 22, 0.001 );</span></a>
<a name="6344"><span class="lineNum">    6344 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), 36, 0.001 );</span></a>
<a name="6345"><span class="lineNum">    6345 </span>                :            : </a>
<a name="6346"><span class="lineNum">    6346 </span>                :            :   // closestSegment</a>
<a name="6347"><span class="lineNum">    6347 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="6348"><span class="lineNum">    6348 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="6349"><span class="lineNum">    6349 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="6350"><span class="lineNum">    6350 </span>                :<span class="lineCov">          1 :   QgsPolygon empty;</span></a>
<a name="6351"><span class="lineNum">    6351 </span>                :<span class="lineCov">          1 :   ( void )empty.closestSegment( QgsPoint( 1, 2 ), pt, v ); // empty polygon, just want no crash</span></a>
<a name="6352"><span class="lineNum">    6352 </span>                :            : </a>
<a name="6353"><span class="lineNum">    6353 </span>                :<span class="lineCov">          1 :   QgsPolygon p21;</span></a>
<a name="6354"><span class="lineNum">    6354 </span>                :<span class="lineCov">          1 :   QgsLineString p21ls;</span></a>
<a name="6355"><span class="lineNum">    6355 </span>                :<span class="lineCov">          1 :   p21ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="6356"><span class="lineNum">    6356 </span>                :<span class="lineCov">          1 :   p21.setExteriorRing( p21ls.clone() );</span></a>
<a name="6357"><span class="lineNum">    6357 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="6358"><span class="lineNum">    6358 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="6359"><span class="lineNum">    6359 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="6360"><span class="lineNum">    6360 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6361"><span class="lineNum">    6361 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6362"><span class="lineNum">    6362 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="6363"><span class="lineNum">    6363 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="6364"><span class="lineNum">    6364 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="6365"><span class="lineNum">    6365 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6366"><span class="lineNum">    6366 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6367"><span class="lineNum">    6367 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 6, 11.5 ), pt, v, &amp;leftOf ), 0.125000, 0.0001 );</span></a>
<a name="6368"><span class="lineNum">    6368 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.25, 0.01 );</span></a>
<a name="6369"><span class="lineNum">    6369 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.25, 0.01 );</span></a>
<a name="6370"><span class="lineNum">    6370 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6371"><span class="lineNum">    6371 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="6372"><span class="lineNum">    6372 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="6373"><span class="lineNum">    6373 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="6374"><span class="lineNum">    6374 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="6375"><span class="lineNum">    6375 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6376"><span class="lineNum">    6376 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6377"><span class="lineNum">    6377 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="6378"><span class="lineNum">    6378 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="6379"><span class="lineNum">    6379 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="6380"><span class="lineNum">    6380 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6381"><span class="lineNum">    6381 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="6382"><span class="lineNum">    6382 </span>                :            :   // point directly on segment</a>
<a name="6383"><span class="lineNum">    6383 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.closestSegment( QgsPoint( 5, 15 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="6384"><span class="lineNum">    6384 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 5, 15 ) );</span></a>
<a name="6385"><span class="lineNum">    6385 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6386"><span class="lineNum">    6386 </span>                :            :   // with interior ring</a>
<a name="6387"><span class="lineNum">    6387 </span>                :<span class="lineCov">          1 :   p21ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6, 11.5 ) &lt;&lt; QgsPoint( 6.5, 12 ) &lt;&lt; QgsPoint( 6, 13 ) &lt;&lt; QgsPoint( 6, 11.5 ) );</span></a>
<a name="6388"><span class="lineNum">    6388 </span>                :<span class="lineCov">          1 :   p21.addInteriorRing( p21ls.clone() );</span></a>
<a name="6389"><span class="lineNum">    6389 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="6390"><span class="lineNum">    6390 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="6391"><span class="lineNum">    6391 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="6392"><span class="lineNum">    6392 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6393"><span class="lineNum">    6393 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6394"><span class="lineNum">    6394 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="6395"><span class="lineNum">    6395 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="6396"><span class="lineNum">    6396 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="6397"><span class="lineNum">    6397 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6398"><span class="lineNum">    6398 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6399"><span class="lineNum">    6399 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 6, 11.4 ), pt, v, &amp;leftOf ), 0.01, 0.0001 );</span></a>
<a name="6400"><span class="lineNum">    6400 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.0, 0.01 );</span></a>
<a name="6401"><span class="lineNum">    6401 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.5, 0.01 );</span></a>
<a name="6402"><span class="lineNum">    6402 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="6403"><span class="lineNum">    6403 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6404"><span class="lineNum">    6404 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="6405"><span class="lineNum">    6405 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="6406"><span class="lineNum">    6406 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="6407"><span class="lineNum">    6407 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6408"><span class="lineNum">    6408 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="6409"><span class="lineNum">    6409 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="6410"><span class="lineNum">    6410 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="6411"><span class="lineNum">    6411 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="6412"><span class="lineNum">    6412 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6413"><span class="lineNum">    6413 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="6414"><span class="lineNum">    6414 </span>                :            :   // point directly on segment</a>
<a name="6415"><span class="lineNum">    6415 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.closestSegment( QgsPoint( 6, 13 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="6416"><span class="lineNum">    6416 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6, 13 ) );</span></a>
<a name="6417"><span class="lineNum">    6417 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="6418"><span class="lineNum">    6418 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="6419"><span class="lineNum">    6419 </span>                :            : </a>
<a name="6420"><span class="lineNum">    6420 </span>                :            :   //nextVertex</a>
<a name="6421"><span class="lineNum">    6421 </span>                :<span class="lineCov">          1 :   QgsPolygon p22;</span></a>
<a name="6422"><span class="lineNum">    6422 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6423"><span class="lineNum">    6423 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="6424"><span class="lineNum">    6424 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6425"><span class="lineNum">    6425 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="6426"><span class="lineNum">    6426 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6427"><span class="lineNum">    6427 </span>                :<span class="lineCov">          1 :   QgsLineString lp22;</span></a>
<a name="6428"><span class="lineNum">    6428 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="6429"><span class="lineNum">    6429 </span>                :<span class="lineCov">          1 :   p22.setExteriorRing( lp22.clone() );</span></a>
<a name="6430"><span class="lineNum">    6430 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 4 ); //out of range</span></a>
<a name="6431"><span class="lineNum">    6431 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6432"><span class="lineNum">    6432 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="6433"><span class="lineNum">    6433 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6434"><span class="lineNum">    6434 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="6435"><span class="lineNum">    6435 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6436"><span class="lineNum">    6436 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="6437"><span class="lineNum">    6437 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="6438"><span class="lineNum">    6438 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6439"><span class="lineNum">    6439 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6440"><span class="lineNum">    6440 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="6441"><span class="lineNum">    6441 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6442"><span class="lineNum">    6442 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6443"><span class="lineNum">    6443 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 12 ) );</span></a>
<a name="6444"><span class="lineNum">    6444 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6445"><span class="lineNum">    6445 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6446"><span class="lineNum">    6446 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="6447"><span class="lineNum">    6447 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 0 );</span></a>
<a name="6448"><span class="lineNum">    6448 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6449"><span class="lineNum">    6449 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="6450"><span class="lineNum">    6450 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6451"><span class="lineNum">    6451 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) ); //test that part number is maintained</span></a>
<a name="6452"><span class="lineNum">    6452 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="6453"><span class="lineNum">    6453 </span>                :            :   // add interior ring</a>
<a name="6454"><span class="lineNum">    6454 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="6455"><span class="lineNum">    6455 </span>                :<span class="lineCov">          1 :   p22.addInteriorRing( lp22.clone() );</span></a>
<a name="6456"><span class="lineNum">    6456 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 4 ); //out of range</span></a>
<a name="6457"><span class="lineNum">    6457 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6458"><span class="lineNum">    6458 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -5 );</span></a>
<a name="6459"><span class="lineNum">    6459 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6460"><span class="lineNum">    6460 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -1 );</span></a>
<a name="6461"><span class="lineNum">    6461 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6462"><span class="lineNum">    6462 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="6463"><span class="lineNum">    6463 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="6464"><span class="lineNum">    6464 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6465"><span class="lineNum">    6465 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="6466"><span class="lineNum">    6466 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="6467"><span class="lineNum">    6467 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6468"><span class="lineNum">    6468 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="6469"><span class="lineNum">    6469 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 22 ) );</span></a>
<a name="6470"><span class="lineNum">    6470 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6471"><span class="lineNum">    6471 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="6472"><span class="lineNum">    6472 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="6473"><span class="lineNum">    6473 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 2, 0 );</span></a>
<a name="6474"><span class="lineNum">    6474 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="6475"><span class="lineNum">    6475 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 1, 0 );</span></a>
<a name="6476"><span class="lineNum">    6476 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="6477"><span class="lineNum">    6477 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 1, 1 ) ); //test that part number is maintained</span></a>
<a name="6478"><span class="lineNum">    6478 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="6479"><span class="lineNum">    6479 </span>                :            : </a>
<a name="6480"><span class="lineNum">    6480 </span>                :            :   // dropZValue</a>
<a name="6481"><span class="lineNum">    6481 </span>                :<span class="lineCov">          1 :   QgsPolygon p23;</span></a>
<a name="6482"><span class="lineNum">    6482 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="6483"><span class="lineNum">    6483 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6484"><span class="lineNum">    6484 </span>                :<span class="lineCov">          1 :   QgsLineString lp23;</span></a>
<a name="6485"><span class="lineNum">    6485 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="6486"><span class="lineNum">    6486 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6487"><span class="lineNum">    6487 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6488"><span class="lineNum">    6488 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6489"><span class="lineNum">    6489 </span>                :<span class="lineCov">          1 :   p23.dropZValue(); // not z</span></a>
<a name="6490"><span class="lineNum">    6490 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6491"><span class="lineNum">    6491 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6492"><span class="lineNum">    6492 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6493"><span class="lineNum">    6493 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6494"><span class="lineNum">    6494 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6495"><span class="lineNum">    6495 </span>                :            :   // with z</a>
<a name="6496"><span class="lineNum">    6496 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3 ) &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 1, 12, 23 ) &lt;&lt; QgsPoint( 1, 2, 3 ) );</span></a>
<a name="6497"><span class="lineNum">    6497 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="6498"><span class="lineNum">    6498 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6499"><span class="lineNum">    6499 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6500"><span class="lineNum">    6500 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonZ );</span></a>
<a name="6501"><span class="lineNum">    6501 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="6502"><span class="lineNum">    6502 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6503"><span class="lineNum">    6503 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6504"><span class="lineNum">    6504 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6505"><span class="lineNum">    6505 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6506"><span class="lineNum">    6506 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6507"><span class="lineNum">    6507 </span>                :            :   // with zm</a>
<a name="6508"><span class="lineNum">    6508 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="6509"><span class="lineNum">    6509 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="6510"><span class="lineNum">    6510 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6511"><span class="lineNum">    6511 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6512"><span class="lineNum">    6512 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonZM );</span></a>
<a name="6513"><span class="lineNum">    6513 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="6514"><span class="lineNum">    6514 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonM );</span></a>
<a name="6515"><span class="lineNum">    6515 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="6516"><span class="lineNum">    6516 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="6517"><span class="lineNum">    6517 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="6518"><span class="lineNum">    6518 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="6519"><span class="lineNum">    6519 </span>                :            : </a>
<a name="6520"><span class="lineNum">    6520 </span>                :            :   // dropMValue</a>
<a name="6521"><span class="lineNum">    6521 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="6522"><span class="lineNum">    6522 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="6523"><span class="lineNum">    6523 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6524"><span class="lineNum">    6524 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="6525"><span class="lineNum">    6525 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6526"><span class="lineNum">    6526 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6527"><span class="lineNum">    6527 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6528"><span class="lineNum">    6528 </span>                :<span class="lineCov">          1 :   p23.dropMValue(); // not zm</span></a>
<a name="6529"><span class="lineNum">    6529 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6530"><span class="lineNum">    6530 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6531"><span class="lineNum">    6531 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6532"><span class="lineNum">    6532 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6533"><span class="lineNum">    6533 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6534"><span class="lineNum">    6534 </span>                :            :   // with m</a>
<a name="6535"><span class="lineNum">    6535 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 12, 0, 23 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) );</span></a>
<a name="6536"><span class="lineNum">    6536 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="6537"><span class="lineNum">    6537 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6538"><span class="lineNum">    6538 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6539"><span class="lineNum">    6539 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonM );</span></a>
<a name="6540"><span class="lineNum">    6540 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="6541"><span class="lineNum">    6541 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="6542"><span class="lineNum">    6542 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6543"><span class="lineNum">    6543 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6544"><span class="lineNum">    6544 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="6545"><span class="lineNum">    6545 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="6546"><span class="lineNum">    6546 </span>                :            :   // with zm</a>
<a name="6547"><span class="lineNum">    6547 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="6548"><span class="lineNum">    6548 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="6549"><span class="lineNum">    6549 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="6550"><span class="lineNum">    6550 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="6551"><span class="lineNum">    6551 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonZM );</span></a>
<a name="6552"><span class="lineNum">    6552 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="6553"><span class="lineNum">    6553 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::PolygonZ );</span></a>
<a name="6554"><span class="lineNum">    6554 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="6555"><span class="lineNum">    6555 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="6556"><span class="lineNum">    6556 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="6557"><span class="lineNum">    6557 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="6558"><span class="lineNum">    6558 </span>                :            : </a>
<a name="6559"><span class="lineNum">    6559 </span>                :            :   //vertexAngle</a>
<a name="6560"><span class="lineNum">    6560 </span>                :<span class="lineCov">          1 :   QgsPolygon p24;</span></a>
<a name="6561"><span class="lineNum">    6561 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="6562"><span class="lineNum">    6562 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="6563"><span class="lineNum">    6563 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( 0, 1, 0 ) ); //just want no crash</span></a>
<a name="6564"><span class="lineNum">    6564 </span>                :<span class="lineCov">          1 :   QgsLineString l38;</span></a>
<a name="6565"><span class="lineNum">    6565 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="6566"><span class="lineNum">    6566 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="6567"><span class="lineNum">    6567 </span>                :<span class="lineCov">          1 :   p24.setExteriorRing( l38.clone() );</span></a>
<a name="6568"><span class="lineNum">    6568 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="6569"><span class="lineNum">    6569 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="6570"><span class="lineNum">    6570 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="6571"><span class="lineNum">    6571 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="6572"><span class="lineNum">    6572 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="6573"><span class="lineNum">    6573 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="6574"><span class="lineNum">    6574 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="6575"><span class="lineNum">    6575 </span>                :<span class="lineCov">          1 :   p24.addInteriorRing( l38.clone() );</span></a>
<a name="6576"><span class="lineNum">    6576 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="6577"><span class="lineNum">    6577 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="6578"><span class="lineNum">    6578 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="6579"><span class="lineNum">    6579 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="6580"><span class="lineNum">    6580 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="6581"><span class="lineNum">    6581 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="6582"><span class="lineNum">    6582 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 1, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="6583"><span class="lineNum">    6583 </span>                :            : </a>
<a name="6584"><span class="lineNum">    6584 </span>                :            :   //insert vertex</a>
<a name="6585"><span class="lineNum">    6585 </span>                :            : </a>
<a name="6586"><span class="lineNum">    6586 </span>                :            :   //insert vertex in empty polygon</a>
<a name="6587"><span class="lineNum">    6587 </span>                :<span class="lineCov">          1 :   QgsPolygon p25;</span></a>
<a name="6588"><span class="lineNum">    6588 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6589"><span class="lineNum">    6589 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6590"><span class="lineNum">    6590 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6591"><span class="lineNum">    6591 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6592"><span class="lineNum">    6592 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.isEmpty() );</span></a>
<a name="6593"><span class="lineNum">    6593 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="6594"><span class="lineNum">    6594 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="6595"><span class="lineNum">    6595 </span>                :<span class="lineCov">          1 :   p25.setExteriorRing( l38.clone() );</span></a>
<a name="6596"><span class="lineNum">    6596 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="6597"><span class="lineNum">    6597 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 8 );</span></a>
<a name="6598"><span class="lineNum">    6598 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6599"><span class="lineNum">    6599 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6600"><span class="lineNum">    6600 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6601"><span class="lineNum">    6601 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6602"><span class="lineNum">    6602 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6603"><span class="lineNum">    6603 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6604"><span class="lineNum">    6604 </span>                :            :   // first vertex</a>
<a name="6605"><span class="lineNum">    6605 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="6606"><span class="lineNum">    6606 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 9 );</span></a>
<a name="6607"><span class="lineNum">    6607 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6608"><span class="lineNum">    6608 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6609"><span class="lineNum">    6609 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6610"><span class="lineNum">    6610 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6611"><span class="lineNum">    6611 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="6612"><span class="lineNum">    6612 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6613"><span class="lineNum">    6613 </span>                :            :   // last vertex</a>
<a name="6614"><span class="lineNum">    6614 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="6615"><span class="lineNum">    6615 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 10 );</span></a>
<a name="6616"><span class="lineNum">    6616 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6617"><span class="lineNum">    6617 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6618"><span class="lineNum">    6618 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6619"><span class="lineNum">    6619 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6620"><span class="lineNum">    6620 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6621"><span class="lineNum">    6621 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6622"><span class="lineNum">    6622 </span>                :            :   // with interior ring</a>
<a name="6623"><span class="lineNum">    6623 </span>                :<span class="lineCov">          1 :   p25.addInteriorRing( l38.clone() );</span></a>
<a name="6624"><span class="lineNum">    6624 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 17 );</span></a>
<a name="6625"><span class="lineNum">    6625 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="6626"><span class="lineNum">    6626 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 18 );</span></a>
<a name="6627"><span class="lineNum">    6627 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6628"><span class="lineNum">    6628 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6629"><span class="lineNum">    6629 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6630"><span class="lineNum">    6630 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6631"><span class="lineNum">    6631 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6632"><span class="lineNum">    6632 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6633"><span class="lineNum">    6633 </span>                :            :   // first vertex in interior ring</a>
<a name="6634"><span class="lineNum">    6634 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="6635"><span class="lineNum">    6635 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 19 );</span></a>
<a name="6636"><span class="lineNum">    6636 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6637"><span class="lineNum">    6637 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6638"><span class="lineNum">    6638 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6639"><span class="lineNum">    6639 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6640"><span class="lineNum">    6640 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="6641"><span class="lineNum">    6641 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6642"><span class="lineNum">    6642 </span>                :            :   // last vertex in interior ring</a>
<a name="6643"><span class="lineNum">    6643 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="6644"><span class="lineNum">    6644 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 20 );</span></a>
<a name="6645"><span class="lineNum">    6645 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6646"><span class="lineNum">    6646 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="6647"><span class="lineNum">    6647 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="6648"><span class="lineNum">    6648 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="6649"><span class="lineNum">    6649 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="6650"><span class="lineNum">    6650 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="6651"><span class="lineNum">    6651 </span>                :            : </a>
<a name="6652"><span class="lineNum">    6652 </span>                :            :   //move vertex</a>
<a name="6653"><span class="lineNum">    6653 </span>                :            : </a>
<a name="6654"><span class="lineNum">    6654 </span>                :            :   //empty polygon</a>
<a name="6655"><span class="lineNum">    6655 </span>                :<span class="lineCov">          1 :   QgsPolygon p26;</span></a>
<a name="6656"><span class="lineNum">    6656 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6657"><span class="lineNum">    6657 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.isEmpty() );</span></a>
<a name="6658"><span class="lineNum">    6658 </span>                :            : </a>
<a name="6659"><span class="lineNum">    6659 </span>                :            :   //valid polygon</a>
<a name="6660"><span class="lineNum">    6660 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="6661"><span class="lineNum">    6661 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="6662"><span class="lineNum">    6662 </span>                :<span class="lineCov">          1 :   p26.setExteriorRing( l38.clone() );</span></a>
<a name="6663"><span class="lineNum">    6663 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6664"><span class="lineNum">    6664 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="6665"><span class="lineNum">    6665 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="6666"><span class="lineNum">    6666 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6667"><span class="lineNum">    6667 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="6668"><span class="lineNum">    6668 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="6669"><span class="lineNum">    6669 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6670"><span class="lineNum">    6670 </span>                :            : </a>
<a name="6671"><span class="lineNum">    6671 </span>                :            :   //out of range</a>
<a name="6672"><span class="lineNum">    6672 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6673"><span class="lineNum">    6673 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6674"><span class="lineNum">    6674 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6675"><span class="lineNum">    6675 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6676"><span class="lineNum">    6676 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="6677"><span class="lineNum">    6677 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="6678"><span class="lineNum">    6678 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6679"><span class="lineNum">    6679 </span>                :            : </a>
<a name="6680"><span class="lineNum">    6680 </span>                :            :   // with interior ring</a>
<a name="6681"><span class="lineNum">    6681 </span>                :<span class="lineCov">          1 :   p26.addInteriorRing( l38.clone() );</span></a>
<a name="6682"><span class="lineNum">    6682 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="6683"><span class="lineNum">    6683 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="6684"><span class="lineNum">    6684 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="6685"><span class="lineNum">    6685 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6686"><span class="lineNum">    6686 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="6687"><span class="lineNum">    6687 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="6688"><span class="lineNum">    6688 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="6689"><span class="lineNum">    6689 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6690"><span class="lineNum">    6690 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6691"><span class="lineNum">    6691 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="6692"><span class="lineNum">    6692 </span>                :            : </a>
<a name="6693"><span class="lineNum">    6693 </span>                :            :   //delete vertex</a>
<a name="6694"><span class="lineNum">    6694 </span>                :            : </a>
<a name="6695"><span class="lineNum">    6695 </span>                :            :   //empty polygon</a>
<a name="6696"><span class="lineNum">    6696 </span>                :<span class="lineCov">          1 :   QgsPolygon p27;</span></a>
<a name="6697"><span class="lineNum">    6697 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6698"><span class="lineNum">    6698 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="6699"><span class="lineNum">    6699 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.isEmpty() );</span></a>
<a name="6700"><span class="lineNum">    6700 </span>                :            : </a>
<a name="6701"><span class="lineNum">    6701 </span>                :            :   //valid polygon</a>
<a name="6702"><span class="lineNum">    6702 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 5, 2 ) &lt;&lt; QgsPoint( 6, 2 ) &lt;&lt; QgsPoint( 7, 2 )</span></a>
<a name="6703"><span class="lineNum">    6703 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="6704"><span class="lineNum">    6704 </span>                :            : </a>
<a name="6705"><span class="lineNum">    6705 </span>                :<span class="lineCov">          1 :   p27.setExteriorRing( l38.clone() );</span></a>
<a name="6706"><span class="lineNum">    6706 </span>                :            :   //out of range vertices</a>
<a name="6707"><span class="lineNum">    6707 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="6708"><span class="lineNum">    6708 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="6709"><span class="lineNum">    6709 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="6710"><span class="lineNum">    6710 </span>                :            : </a>
<a name="6711"><span class="lineNum">    6711 </span>                :            :   //valid vertices</a>
<a name="6712"><span class="lineNum">    6712 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="6713"><span class="lineNum">    6713 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="6714"><span class="lineNum">    6714 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6715"><span class="lineNum">    6715 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6716"><span class="lineNum">    6716 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6717"><span class="lineNum">    6717 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="6718"><span class="lineNum">    6718 </span>                :            : </a>
<a name="6719"><span class="lineNum">    6719 </span>                :            :   // delete first vertex</a>
<a name="6720"><span class="lineNum">    6720 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6721"><span class="lineNum">    6721 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6722"><span class="lineNum">    6722 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6723"><span class="lineNum">    6723 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6724"><span class="lineNum">    6724 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6725"><span class="lineNum">    6725 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6726"><span class="lineNum">    6726 </span>                :            : </a>
<a name="6727"><span class="lineNum">    6727 </span>                :            :   // delete last vertex</a>
<a name="6728"><span class="lineNum">    6728 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 4 ) ) );</span></a>
<a name="6729"><span class="lineNum">    6729 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6730"><span class="lineNum">    6730 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6731"><span class="lineNum">    6731 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6732"><span class="lineNum">    6732 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6733"><span class="lineNum">    6733 </span>                :            : </a>
<a name="6734"><span class="lineNum">    6734 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="6735"><span class="lineNum">    6735 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="6736"><span class="lineNum">    6736 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.exteriorRing() );</span></a>
<a name="6737"><span class="lineNum">    6737 </span>                :            : </a>
<a name="6738"><span class="lineNum">    6738 </span>                :            :   // with interior ring</a>
<a name="6739"><span class="lineNum">    6739 </span>                :<span class="lineCov">          1 :   p27.setExteriorRing( l38.clone() );</span></a>
<a name="6740"><span class="lineNum">    6740 </span>                :<span class="lineCov">          1 :   p27.addInteriorRing( l38.clone() );</span></a>
<a name="6741"><span class="lineNum">    6741 </span>                :            : </a>
<a name="6742"><span class="lineNum">    6742 </span>                :            :   //out of range vertices</a>
<a name="6743"><span class="lineNum">    6743 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, -1 ) ) );</span></a>
<a name="6744"><span class="lineNum">    6744 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 100 ) ) );</span></a>
<a name="6745"><span class="lineNum">    6745 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 2, 1 ) ) );</span></a>
<a name="6746"><span class="lineNum">    6746 </span>                :            : </a>
<a name="6747"><span class="lineNum">    6747 </span>                :            :   //valid vertices</a>
<a name="6748"><span class="lineNum">    6748 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="6749"><span class="lineNum">    6749 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="6750"><span class="lineNum">    6750 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6751"><span class="lineNum">    6751 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6752"><span class="lineNum">    6752 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6753"><span class="lineNum">    6753 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="6754"><span class="lineNum">    6754 </span>                :            : </a>
<a name="6755"><span class="lineNum">    6755 </span>                :            :   // delete first vertex</a>
<a name="6756"><span class="lineNum">    6756 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="6757"><span class="lineNum">    6757 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6758"><span class="lineNum">    6758 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6759"><span class="lineNum">    6759 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6760"><span class="lineNum">    6760 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6761"><span class="lineNum">    6761 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="6762"><span class="lineNum">    6762 </span>                :            : </a>
<a name="6763"><span class="lineNum">    6763 </span>                :            :   // delete last vertex</a>
<a name="6764"><span class="lineNum">    6764 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 4 ) ) );</span></a>
<a name="6765"><span class="lineNum">    6765 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6766"><span class="lineNum">    6766 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="6767"><span class="lineNum">    6767 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="6768"><span class="lineNum">    6768 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="6769"><span class="lineNum">    6769 </span>                :            : </a>
<a name="6770"><span class="lineNum">    6770 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="6771"><span class="lineNum">    6771 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="6772"><span class="lineNum">    6772 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 0 );</span></a>
<a name="6773"><span class="lineNum">    6773 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.exteriorRing() );</span></a>
<a name="6774"><span class="lineNum">    6774 </span>                :            : </a>
<a name="6775"><span class="lineNum">    6775 </span>                :            :   // test that interior ring is &quot;promoted&quot; when exterior is removed</a>
<a name="6776"><span class="lineNum">    6776 </span>                :<span class="lineCov">          1 :   p27.addInteriorRing( l38.clone() );</span></a>
<a name="6777"><span class="lineNum">    6777 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6778"><span class="lineNum">    6778 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="6779"><span class="lineNum">    6779 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6780"><span class="lineNum">    6780 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="6781"><span class="lineNum">    6781 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6782"><span class="lineNum">    6782 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="6783"><span class="lineNum">    6783 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="6784"><span class="lineNum">    6784 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 0 );</span></a>
<a name="6785"><span class="lineNum">    6785 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.exteriorRing() );</span></a>
<a name="6786"><span class="lineNum">    6786 </span>                :            : </a>
<a name="6787"><span class="lineNum">    6787 </span>                :            :   // test adjacent vertices - should wrap around!</a>
<a name="6788"><span class="lineNum">    6788 </span>                :<span class="lineCov">          1 :   QgsLineString *closedRing1 = new QgsLineString();</span></a>
<a name="6789"><span class="lineNum">    6789 </span>                :<span class="lineCov">          1 :   closedRing1-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="6790"><span class="lineNum">    6790 </span>                :<span class="lineCov">          1 :   QgsPolygon p28;</span></a>
<a name="6791"><span class="lineNum">    6791 </span>                :<span class="lineCov">          1 :   QgsVertexId previous( 1, 2, 3 );</span></a>
<a name="6792"><span class="lineNum">    6792 </span>                :<span class="lineCov">          1 :   QgsVertexId next( 4, 5, 6 );</span></a>
<a name="6793"><span class="lineNum">    6793 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 0 ), previous, next );</span></a>
<a name="6794"><span class="lineNum">    6794 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( ) );</span></a>
<a name="6795"><span class="lineNum">    6795 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( ) );</span></a>
<a name="6796"><span class="lineNum">    6796 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 0 ), previous, next );</span></a>
<a name="6797"><span class="lineNum">    6797 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( ) );</span></a>
<a name="6798"><span class="lineNum">    6798 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( ) );</span></a>
<a name="6799"><span class="lineNum">    6799 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 1 ), previous, next );</span></a>
<a name="6800"><span class="lineNum">    6800 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( ) );</span></a>
<a name="6801"><span class="lineNum">    6801 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( ) );</span></a>
<a name="6802"><span class="lineNum">    6802 </span>                :            : </a>
<a name="6803"><span class="lineNum">    6803 </span>                :<span class="lineCov">          1 :   p28.setExteriorRing( closedRing1 );</span></a>
<a name="6804"><span class="lineNum">    6804 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 0 ), previous, next );</span></a>
<a name="6805"><span class="lineNum">    6805 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6806"><span class="lineNum">    6806 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6807"><span class="lineNum">    6807 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 1 ), previous, next );</span></a>
<a name="6808"><span class="lineNum">    6808 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="6809"><span class="lineNum">    6809 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6810"><span class="lineNum">    6810 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 2 ), previous, next );</span></a>
<a name="6811"><span class="lineNum">    6811 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6812"><span class="lineNum">    6812 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6813"><span class="lineNum">    6813 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 3 ), previous, next );</span></a>
<a name="6814"><span class="lineNum">    6814 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="6815"><span class="lineNum">    6815 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 4 ) );</span></a>
<a name="6816"><span class="lineNum">    6816 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 0, 4 ), previous, next );</span></a>
<a name="6817"><span class="lineNum">    6817 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="6818"><span class="lineNum">    6818 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="6819"><span class="lineNum">    6819 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 0 ), previous, next );</span></a>
<a name="6820"><span class="lineNum">    6820 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( ) );</span></a>
<a name="6821"><span class="lineNum">    6821 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( ) );</span></a>
<a name="6822"><span class="lineNum">    6822 </span>                :            :   // part number should be retained</a>
<a name="6823"><span class="lineNum">    6823 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 1, 0, 0 ), previous, next );</span></a>
<a name="6824"><span class="lineNum">    6824 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 1, 0, 3 ) );</span></a>
<a name="6825"><span class="lineNum">    6825 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 1, 0, 1 ) );</span></a>
<a name="6826"><span class="lineNum">    6826 </span>                :            : </a>
<a name="6827"><span class="lineNum">    6827 </span>                :            :   // interior ring</a>
<a name="6828"><span class="lineNum">    6828 </span>                :<span class="lineCov">          1 :   p28.addInteriorRing( closedRing1-&gt;clone() );</span></a>
<a name="6829"><span class="lineNum">    6829 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 0 ), previous, next );</span></a>
<a name="6830"><span class="lineNum">    6830 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="6831"><span class="lineNum">    6831 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="6832"><span class="lineNum">    6832 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 1 ), previous, next );</span></a>
<a name="6833"><span class="lineNum">    6833 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="6834"><span class="lineNum">    6834 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="6835"><span class="lineNum">    6835 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 2 ), previous, next );</span></a>
<a name="6836"><span class="lineNum">    6836 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="6837"><span class="lineNum">    6837 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="6838"><span class="lineNum">    6838 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 3 ), previous, next );</span></a>
<a name="6839"><span class="lineNum">    6839 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="6840"><span class="lineNum">    6840 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 1, 4 ) );</span></a>
<a name="6841"><span class="lineNum">    6841 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 1, 4 ), previous, next );</span></a>
<a name="6842"><span class="lineNum">    6842 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="6843"><span class="lineNum">    6843 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="6844"><span class="lineNum">    6844 </span>                :<span class="lineCov">          1 :   p28.adjacentVertices( QgsVertexId( 0, 2, 0 ), previous, next );</span></a>
<a name="6845"><span class="lineNum">    6845 </span>                :<span class="lineCov">          1 :   QCOMPARE( previous, QgsVertexId( ) );</span></a>
<a name="6846"><span class="lineNum">    6846 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( ) );</span></a>
<a name="6847"><span class="lineNum">    6847 </span>                :            : </a>
<a name="6848"><span class="lineNum">    6848 </span>                :            :   // vertex number</a>
<a name="6849"><span class="lineNum">    6849 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine2;</span></a>
<a name="6850"><span class="lineNum">    6850 </span>                :<span class="lineCov">          1 :   QCOMPARE( vertexLine2.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="6851"><span class="lineNum">    6851 </span>                :            : </a>
<a name="6852"><span class="lineNum">    6852 </span>                :<span class="lineCov">          1 :   QgsLineString *closedRing2 = new QgsLineString();</span></a>
<a name="6853"><span class="lineNum">    6853 </span>                :<span class="lineCov">          1 :   closedRing2-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="6854"><span class="lineNum">    6854 </span>                :<span class="lineCov">          1 :   QgsPolygon p29;</span></a>
<a name="6855"><span class="lineNum">    6855 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="6856"><span class="lineNum">    6856 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="6857"><span class="lineNum">    6857 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, -1, 0 ) ), -1 );</span></a>
<a name="6858"><span class="lineNum">    6858 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="6859"><span class="lineNum">    6859 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="6860"><span class="lineNum">    6860 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), -1 );</span></a>
<a name="6861"><span class="lineNum">    6861 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), -1 );</span></a>
<a name="6862"><span class="lineNum">    6862 </span>                :<span class="lineCov">          1 :   p29.setExteriorRing( closedRing2 );</span></a>
<a name="6863"><span class="lineNum">    6863 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="6864"><span class="lineNum">    6864 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="6865"><span class="lineNum">    6865 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, -1, 0 ) ), -1 );</span></a>
<a name="6866"><span class="lineNum">    6866 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="6867"><span class="lineNum">    6867 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="6868"><span class="lineNum">    6868 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="6869"><span class="lineNum">    6869 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="6870"><span class="lineNum">    6870 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="6871"><span class="lineNum">    6871 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), 3 );</span></a>
<a name="6872"><span class="lineNum">    6872 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 4 ) ), 4 );</span></a>
<a name="6873"><span class="lineNum">    6873 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 5 ) ), -1 );</span></a>
<a name="6874"><span class="lineNum">    6874 </span>                :<span class="lineCov">          1 :   p29.addInteriorRing( closedRing2-&gt;clone() );</span></a>
<a name="6875"><span class="lineNum">    6875 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="6876"><span class="lineNum">    6876 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="6877"><span class="lineNum">    6877 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="6878"><span class="lineNum">    6878 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), 3 );</span></a>
<a name="6879"><span class="lineNum">    6879 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 4 ) ), 4 );</span></a>
<a name="6880"><span class="lineNum">    6880 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 0, 5 ) ), -1 );</span></a>
<a name="6881"><span class="lineNum">    6881 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), 5 );</span></a>
<a name="6882"><span class="lineNum">    6882 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 1 ) ), 6 );</span></a>
<a name="6883"><span class="lineNum">    6883 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 2 ) ), 7 );</span></a>
<a name="6884"><span class="lineNum">    6884 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 3 ) ), 8 );</span></a>
<a name="6885"><span class="lineNum">    6885 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 4 ) ), 9 );</span></a>
<a name="6886"><span class="lineNum">    6886 </span>                :<span class="lineCov">          1 :   QCOMPARE( p29.vertexNumberFromVertexId( QgsVertexId( 0, 1, 5 ) ), -1 );</span></a>
<a name="6887"><span class="lineNum">    6887 </span>                :            : </a>
<a name="6888"><span class="lineNum">    6888 </span>                :            : </a>
<a name="6889"><span class="lineNum">    6889 </span>                :            :   //segmentLength</a>
<a name="6890"><span class="lineNum">    6890 </span>                :<span class="lineCov">          1 :   QgsPolygon p30;</span></a>
<a name="6891"><span class="lineNum">    6891 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine3;</span></a>
<a name="6892"><span class="lineNum">    6892 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="6893"><span class="lineNum">    6893 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="6894"><span class="lineNum">    6894 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 1, 0, 0 ) ), 0.0 );</span></a>
<a name="6895"><span class="lineNum">    6895 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, -1, 0 ) ), 0.0 );</span></a>
<a name="6896"><span class="lineNum">    6896 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 0 ) ), 0.0 );</span></a>
<a name="6897"><span class="lineNum">    6897 </span>                :<span class="lineCov">          2 :   vertexLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 )</span></a>
<a name="6898"><span class="lineNum">    6898 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( 111, 2 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="6899"><span class="lineNum">    6899 </span>                :<span class="lineCov">          1 :   p30.setExteriorRing( vertexLine3.clone() );</span></a>
<a name="6900"><span class="lineNum">    6900 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="6901"><span class="lineNum">    6901 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="6902"><span class="lineNum">    6902 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 0 ) ), 10.0 );</span></a>
<a name="6903"><span class="lineNum">    6903 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 1 ) ), 100.0 );</span></a>
<a name="6904"><span class="lineNum">    6904 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 2 ) ), 10.0 );</span></a>
<a name="6905"><span class="lineNum">    6905 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 3 ) ), 100.0 );</span></a>
<a name="6906"><span class="lineNum">    6906 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 4 ) ), 0.0 );</span></a>
<a name="6907"><span class="lineNum">    6907 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="6908"><span class="lineNum">    6908 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( -1, 0, 0 ) ), 10.0 );</span></a>
<a name="6909"><span class="lineNum">    6909 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, -1, 0 ) ), 0.0 );</span></a>
<a name="6910"><span class="lineNum">    6910 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 0 ) ), 0.0 );</span></a>
<a name="6911"><span class="lineNum">    6911 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 1 ) ), 0.0 );</span></a>
<a name="6912"><span class="lineNum">    6912 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 1, 0, 1 ) ), 100.0 );</span></a>
<a name="6913"><span class="lineNum">    6913 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 1, 1, 1 ) ), 0.0 );</span></a>
<a name="6914"><span class="lineNum">    6914 </span>                :            : </a>
<a name="6915"><span class="lineNum">    6915 </span>                :            :   // add interior ring</a>
<a name="6916"><span class="lineNum">    6916 </span>                :<span class="lineCov">          2 :   vertexLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 30, 6 ) &lt;&lt; QgsPoint( 34, 6 ) &lt;&lt; QgsPoint( 34, 8 )</span></a>
<a name="6917"><span class="lineNum">    6917 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( 30, 8 ) &lt;&lt; QgsPoint( 30, 6 ) );</span></a>
<a name="6918"><span class="lineNum">    6918 </span>                :<span class="lineCov">          1 :   p30.addInteriorRing( vertexLine3.clone() );</span></a>
<a name="6919"><span class="lineNum">    6919 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="6920"><span class="lineNum">    6920 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="6921"><span class="lineNum">    6921 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 0 ) ), 10.0 );</span></a>
<a name="6922"><span class="lineNum">    6922 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 1 ) ), 100.0 );</span></a>
<a name="6923"><span class="lineNum">    6923 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 2 ) ), 10.0 );</span></a>
<a name="6924"><span class="lineNum">    6924 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 3 ) ), 100.0 );</span></a>
<a name="6925"><span class="lineNum">    6925 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 0, 4 ) ), 0.0 );</span></a>
<a name="6926"><span class="lineNum">    6926 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="6927"><span class="lineNum">    6927 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( -1, 0, 0 ) ), 10.0 );</span></a>
<a name="6928"><span class="lineNum">    6928 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, -1, 0 ) ), 0.0 );</span></a>
<a name="6929"><span class="lineNum">    6929 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, -1 ) ), 0.0 );</span></a>
<a name="6930"><span class="lineNum">    6930 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 0 ) ), 4.0 );</span></a>
<a name="6931"><span class="lineNum">    6931 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 1 ) ), 2.0 );</span></a>
<a name="6932"><span class="lineNum">    6932 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 2 ) ), 4.0 );</span></a>
<a name="6933"><span class="lineNum">    6933 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 3 ) ), 2.0 );</span></a>
<a name="6934"><span class="lineNum">    6934 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 0, 1, 4 ) ), 0.0 );</span></a>
<a name="6935"><span class="lineNum">    6935 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 1, 0, 1 ) ), 100.0 );</span></a>
<a name="6936"><span class="lineNum">    6936 </span>                :<span class="lineCov">          1 :   QCOMPARE( p30.segmentLength( QgsVertexId( 1, 1, 1 ) ), 2.0 );</span></a>
<a name="6937"><span class="lineNum">    6937 </span>                :            : </a>
<a name="6938"><span class="lineNum">    6938 </span>                :            :   //removeDuplicateNodes</a>
<a name="6939"><span class="lineNum">    6939 </span>                :<span class="lineCov">          1 :   QgsPolygon nodePolygon;</span></a>
<a name="6940"><span class="lineNum">    6940 </span>                :<span class="lineCov">          1 :   QgsLineString nodeLine;</span></a>
<a name="6941"><span class="lineNum">    6941 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodePolygon.removeDuplicateNodes() );</span></a>
<a name="6942"><span class="lineNum">    6942 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="6943"><span class="lineNum">    6943 </span>                :<span class="lineCov">          1 :   nodePolygon.setExteriorRing( nodeLine.clone() );</span></a>
<a name="6944"><span class="lineNum">    6944 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodePolygon.removeDuplicateNodes() );</span></a>
<a name="6945"><span class="lineNum">    6945 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodePolygon.asWkt(), QStringLiteral( &quot;Polygon ((11 2, 11 12, 11 22, 11 2))&quot; ) );</span></a>
<a name="6946"><span class="lineNum">    6946 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="6947"><span class="lineNum">    6947 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11.01, 21.99 ) &lt;&lt; QgsPoint( 10.99, 1.99 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="6948"><span class="lineNum">    6948 </span>                :<span class="lineCov">          1 :   nodePolygon.setExteriorRing( nodeLine.clone() );</span></a>
<a name="6949"><span class="lineNum">    6949 </span>                :<span class="lineCov">          1 :   QVERIFY( nodePolygon.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="6950"><span class="lineNum">    6950 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodePolygon.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="6951"><span class="lineNum">    6951 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodePolygon.asWkt( 2 ), QStringLiteral( &quot;Polygon ((11 2, 11 12, 11 22, 11 2))&quot; ) );</span></a>
<a name="6952"><span class="lineNum">    6952 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="6953"><span class="lineNum">    6953 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11.01, 21.99 ) &lt;&lt; QgsPoint( 10.99, 1.99 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="6954"><span class="lineNum">    6954 </span>                :<span class="lineCov">          1 :   nodePolygon.setExteriorRing( nodeLine.clone() );</span></a>
<a name="6955"><span class="lineNum">    6955 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodePolygon.removeDuplicateNodes() );</span></a>
<a name="6956"><span class="lineNum">    6956 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodePolygon.asWkt( 2 ), QStringLiteral( &quot;Polygon ((11 2, 11.01 1.99, 11.02 2.01, 11 12, 11 22, 11.01 21.99, 10.99 1.99, 11 2))&quot; ) );</span></a>
<a name="6957"><span class="lineNum">    6957 </span>                :            :   // don't create degenerate rings</a>
<a name="6958"><span class="lineNum">    6958 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 2.01 ) &lt;&lt; QgsPoint( 11, 2.01 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="6959"><span class="lineNum">    6959 </span>                :<span class="lineCov">          1 :   nodePolygon.addInteriorRing( nodeLine.clone() );</span></a>
<a name="6960"><span class="lineNum">    6960 </span>                :<span class="lineCov">          1 :   QVERIFY( nodePolygon.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="6961"><span class="lineNum">    6961 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodePolygon.asWkt( 2 ), QStringLiteral( &quot;Polygon ((11 2, 11 12, 11 22, 11 2),(11 2, 11.01 2.01, 11 2.01, 11 2))&quot; ) );</span></a>
<a name="6962"><span class="lineNum">    6962 </span>                :            : </a>
<a name="6963"><span class="lineNum">    6963 </span>                :            :   // swap XY</a>
<a name="6964"><span class="lineNum">    6964 </span>                :<span class="lineCov">          1 :   QgsPolygon swapPolygon;</span></a>
<a name="6965"><span class="lineNum">    6965 </span>                :<span class="lineCov">          1 :   swapPolygon.swapXy(); //no crash</span></a>
<a name="6966"><span class="lineNum">    6966 </span>                :<span class="lineCov">          1 :   QgsLineString swapLine;</span></a>
<a name="6967"><span class="lineNum">    6967 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 22, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="6968"><span class="lineNum">    6968 </span>                :<span class="lineCov">          1 :   swapPolygon.setExteriorRing( swapLine.clone() );</span></a>
<a name="6969"><span class="lineNum">    6969 </span>                :<span class="lineCov">          1 :   swapPolygon.swapXy();</span></a>
<a name="6970"><span class="lineNum">    6970 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapPolygon.asWkt(), QStringLiteral( &quot;PolygonZM ((2 11 3 4, 12 11 13 14, 22 11 23 24, 2 11 3 4))&quot; ) );</span></a>
<a name="6971"><span class="lineNum">    6971 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="6972"><span class="lineNum">    6972 </span>                :<span class="lineCov">          1 :   swapPolygon.addInteriorRing( swapLine.clone() );</span></a>
<a name="6973"><span class="lineNum">    6973 </span>                :<span class="lineCov">          1 :   swapPolygon.swapXy();</span></a>
<a name="6974"><span class="lineNum">    6974 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapPolygon.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((11 2 3 4, 11 12 13 14, 11 22 23 24, 11 2 3 4),(2 1 5 6, 2.01 11.01 15 16, 2.01 11 25 26, 2 11 5 6, 2 1 5 6))&quot; ) );</span></a>
<a name="6975"><span class="lineNum">    6975 </span>                :            : </a>
<a name="6976"><span class="lineNum">    6976 </span>                :            :   // filter vertex</a>
<a name="6977"><span class="lineNum">    6977 </span>                :<span class="lineCov">          1 :   QgsPolygon filterPolygon;</span></a>
<a name="6978"><span class="lineNum">    6978 </span>                :<span class="lineCov">         19 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="6979"><span class="lineNum">    6979 </span>                :            :   {</a>
<a name="6980"><span class="lineNum">    6980 </span>                :<span class="lineCov">         19 :     return point.x() &gt; 5;</span></a>
<a name="6981"><span class="lineNum">    6981 </span>                :            :   };</a>
<a name="6982"><span class="lineNum">    6982 </span>                :<span class="lineCov">          1 :   filterPolygon.filterVertices( filter ); // no crash</span></a>
<a name="6983"><span class="lineNum">    6983 </span>                :<span class="lineCov">          1 :   QgsLineString filterPolygonRing;</span></a>
<a name="6984"><span class="lineNum">    6984 </span>                :<span class="lineCov">          1 :   filterPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 22, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="6985"><span class="lineNum">    6985 </span>                :<span class="lineCov">          1 :   filterPolygon.setExteriorRing( filterPolygonRing.clone() );</span></a>
<a name="6986"><span class="lineNum">    6986 </span>                :<span class="lineCov">          1 :   filterPolygon.filterVertices( filter );</span></a>
<a name="6987"><span class="lineNum">    6987 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterPolygon.asWkt(), QStringLiteral( &quot;PolygonZM ((11 2 3 4, 11 12 13 14, 11 22 23 24, 11 2 3 4))&quot; ) );</span></a>
<a name="6988"><span class="lineNum">    6988 </span>                :<span class="lineCov">          1 :   filterPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="6989"><span class="lineNum">    6989 </span>                :<span class="lineCov">          1 :   filterPolygon.addInteriorRing( filterPolygonRing.clone() );</span></a>
<a name="6990"><span class="lineNum">    6990 </span>                :<span class="lineCov">          1 :   filterPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="6991"><span class="lineNum">    6991 </span>                :<span class="lineCov">          1 :   filterPolygon.addInteriorRing( filterPolygonRing.clone() );</span></a>
<a name="6992"><span class="lineNum">    6992 </span>                :<span class="lineCov">          1 :   filterPolygon.filterVertices( filter );</span></a>
<a name="6993"><span class="lineNum">    6993 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterPolygon.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((11 2 3 4, 11 12 13 14, 11 22 23 24, 11 2 3 4),(10 2 5 6, 11.01 2.01 15 16, 11 2.01 25 26, 11 2 5 6, 10 2 5 6),(11.01 2.01 15 16, 11 2.01 25 26))&quot; ) );</span></a>
<a name="6994"><span class="lineNum">    6994 </span>                :            : </a>
<a name="6995"><span class="lineNum">    6995 </span>                :            :   // transform vertex</a>
<a name="6996"><span class="lineNum">    6996 </span>                :<span class="lineCov">          1 :   QgsPolygon transformPolygon;</span></a>
<a name="6997"><span class="lineNum">    6997 </span>                :<span class="lineCov">         20 :   auto transform = []( const QgsPoint &amp; point )-&gt; QgsPoint</span></a>
<a name="6998"><span class="lineNum">    6998 </span>                :            :   {</a>
<a name="6999"><span class="lineNum">    6999 </span>                :<span class="lineCov">         20 :     return QgsPoint( point.x() + 2, point.y() + 3, point.z() + 4, point.m() + 5 );</span></a>
<a name="7000"><span class="lineNum">    7000 </span>                :            :   };</a>
<a name="7001"><span class="lineNum">    7001 </span>                :<span class="lineCov">          1 :   transformPolygon.transformVertices( transform ); // no crash</span></a>
<a name="7002"><span class="lineNum">    7002 </span>                :<span class="lineCov">          1 :   QgsLineString transformPolygonRing;</span></a>
<a name="7003"><span class="lineNum">    7003 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 22, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="7004"><span class="lineNum">    7004 </span>                :<span class="lineCov">          1 :   transformPolygon.setExteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7005"><span class="lineNum">    7005 </span>                :<span class="lineCov">          1 :   transformPolygon.transformVertices( transform );</span></a>
<a name="7006"><span class="lineNum">    7006 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformPolygon.asWkt(), QStringLiteral( &quot;PolygonZM ((13 5 7 9, 6 15 17 19, 13 15 17 19, 13 25 27 29, 13 5 7 9))&quot; ) );</span></a>
<a name="7007"><span class="lineNum">    7007 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7008"><span class="lineNum">    7008 </span>                :<span class="lineCov">          1 :   transformPolygon.addInteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7009"><span class="lineNum">    7009 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7010"><span class="lineNum">    7010 </span>                :<span class="lineCov">          1 :   transformPolygon.addInteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7011"><span class="lineNum">    7011 </span>                :<span class="lineCov">          1 :   transformPolygon.transformVertices( transform );</span></a>
<a name="7012"><span class="lineNum">    7012 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformPolygon.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((15 8 11 14, 8 18 21 24, 15 18 21 24, 15 28 31 34, 15 8 11 14),(12 5 9 11, 6 15 17 19, 13.01 5.01 19 21, 13 5.01 29 31, 13 5 9 11, 12 5 9 11),(3 5 9 11, 13.01 5.01 19 21, 13 5.01 29 31, 3 5 9 11))&quot; ) );</span></a>
<a name="7013"><span class="lineNum">    7013 </span>                :            : </a>
<a name="7014"><span class="lineNum">    7014 </span>                :            :   // transform using class</a>
<a name="7015"><span class="lineNum">    7015 </span>                :<span class="lineCov">          1 :   QgsPolygon transformPolygon2;</span></a>
<a name="7016"><span class="lineNum">    7016 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="7017"><span class="lineNum">    7017 </span>                :            :   // no crash</a>
<a name="7018"><span class="lineNum">    7018 </span>                :<span class="lineCov">          1 :   QVERIFY( transformPolygon2.transform( &amp;transformer ) );</span></a>
<a name="7019"><span class="lineNum">    7019 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 22, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="7020"><span class="lineNum">    7020 </span>                :<span class="lineCov">          1 :   transformPolygon2.setExteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7021"><span class="lineNum">    7021 </span>                :<span class="lineCov">          1 :   QVERIFY( transformPolygon2.transform( &amp;transformer ) );</span></a>
<a name="7022"><span class="lineNum">    7022 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformPolygon2.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((33 16 8 3, 12 26 18 13, 33 26 18 13, 33 36 28 23, 33 16 8 3))&quot; ) );</span></a>
<a name="7023"><span class="lineNum">    7023 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7024"><span class="lineNum">    7024 </span>                :<span class="lineCov">          1 :   transformPolygon2.addInteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7025"><span class="lineNum">    7025 </span>                :<span class="lineCov">          1 :   transformPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7026"><span class="lineNum">    7026 </span>                :<span class="lineCov">          1 :   transformPolygon2.addInteriorRing( transformPolygonRing.clone() );</span></a>
<a name="7027"><span class="lineNum">    7027 </span>                :<span class="lineCov">          1 :   QVERIFY( transformPolygon2.transform( &amp;transformer ) );</span></a>
<a name="7028"><span class="lineNum">    7028 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformPolygon2.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((99 30 13 2, 36 40 23 12, 99 40 23 12, 99 50 33 22, 99 30 13 2),(30 16 10 5, 12 26 18 13, 33.03 16.01 20 15, 33 16.01 30 25, 33 16 10 5, 30 16 10 5),(3 16 10 5, 33.03 16.01 20 15, 33 16.01 30 25, 3 16 10 5))&quot; ) );</span></a>
<a name="7029"><span class="lineNum">    7029 </span>                :            : </a>
<a name="7030"><span class="lineNum">    7030 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="7031"><span class="lineNum">    7031 </span>                :<span class="lineCov">          1 :   QVERIFY( !transformPolygon2.transform( &amp;failTransformer ) );</span></a>
<a name="7032"><span class="lineNum">    7032 </span>                :            : </a>
<a name="7033"><span class="lineNum">    7033 </span>                :            :   // remove invalid rings</a>
<a name="7034"><span class="lineNum">    7034 </span>                :<span class="lineCov">          1 :   QgsPolygon invalidRingPolygon;</span></a>
<a name="7035"><span class="lineNum">    7035 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.removeInvalidRings(); // no crash</span></a>
<a name="7036"><span class="lineNum">    7036 </span>                :<span class="lineCov">          1 :   QgsLineString removeInvalidPolygonRing;</span></a>
<a name="7037"><span class="lineNum">    7037 </span>                :<span class="lineCov">          1 :   removeInvalidPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 4, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 22, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="7038"><span class="lineNum">    7038 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.setExteriorRing( removeInvalidPolygonRing.clone() );</span></a>
<a name="7039"><span class="lineNum">    7039 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.removeInvalidRings();</span></a>
<a name="7040"><span class="lineNum">    7040 </span>                :<span class="lineCov">          2 :   QCOMPARE( invalidRingPolygon.asWkt(), QStringLiteral( &quot;PolygonZM ((11 2 3 4, 4 12 13 14, 11 12 13 14, 11 22 23 24, 11 2 3 4))&quot; ) );</span></a>
<a name="7041"><span class="lineNum">    7041 </span>                :<span class="lineCov">          1 :   removeInvalidPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM )  &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 10, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7042"><span class="lineNum">    7042 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.addInteriorRing( removeInvalidPolygonRing.clone() );</span></a>
<a name="7043"><span class="lineNum">    7043 </span>                :<span class="lineCov">          1 :   removeInvalidPolygonRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 2.01, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2.01, 25, 26, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 2, 5, 6, QgsWkbTypes::PointZM ) );</span></a>
<a name="7044"><span class="lineNum">    7044 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.addInteriorRing( removeInvalidPolygonRing.clone() );</span></a>
<a name="7045"><span class="lineNum">    7045 </span>                :<span class="lineCov">          1 :   invalidRingPolygon.removeInvalidRings();</span></a>
<a name="7046"><span class="lineNum">    7046 </span>                :<span class="lineCov">          2 :   QCOMPARE( invalidRingPolygon.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((11 2 3 4, 4 12 13 14, 11 12 13 14, 11 22 23 24, 11 2 3 4),(1 2 5 6, 11.01 2.01 15 16, 11 2.01 25 26, 1 2 5 6))&quot; ) );</span></a>
<a name="7047"><span class="lineNum">    7047 </span>                :            : </a>
<a name="7048"><span class="lineNum">    7048 </span>                :            :   // force RHR</a>
<a name="7049"><span class="lineNum">    7049 </span>                :<span class="lineCov">          1 :   QgsPolygon rhr;</span></a>
<a name="7050"><span class="lineNum">    7050 </span>                :<span class="lineCov">          1 :   rhr.forceRHR(); // no crash</span></a>
<a name="7051"><span class="lineNum">    7051 </span>                :<span class="lineCov">          2 :   rhr.fromWkt( QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4))&quot; ) );</span></a>
<a name="7052"><span class="lineNum">    7052 </span>                :<span class="lineCov">          1 :   rhr.forceRHR();</span></a>
<a name="7053"><span class="lineNum">    7053 </span>                :<span class="lineCov">          2 :   QCOMPARE( rhr.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4))&quot; ) );</span></a>
<a name="7054"><span class="lineNum">    7054 </span>                :<span class="lineCov">          2 :   rhr.fromWkt( QStringLiteral( &quot;PolygonZM ((0 0 3 4, 100 0 13 14, 100 100 23 24, 0 100 23 24, 0 0 3 4))&quot; ) );</span></a>
<a name="7055"><span class="lineNum">    7055 </span>                :<span class="lineCov">          1 :   rhr.forceRHR();</span></a>
<a name="7056"><span class="lineNum">    7056 </span>                :<span class="lineCov">          2 :   QCOMPARE( rhr.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 23 24, 100 100 23 24, 100 0 13 14, 0 0 3 4))&quot; ) );</span></a>
<a name="7057"><span class="lineNum">    7057 </span>                :<span class="lineCov">          2 :   rhr.fromWkt( QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4),(10 10 1 2, 20 10 3 4, 20 20 4, 5, 10 20 6 8, 10 10 1 2))&quot; ) );</span></a>
<a name="7058"><span class="lineNum">    7058 </span>                :<span class="lineCov">          1 :   rhr.forceRHR();</span></a>
<a name="7059"><span class="lineNum">    7059 </span>                :<span class="lineCov">          2 :   QCOMPARE( rhr.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4),(10 10 1 2, 20 10 3 4, 10 20 6 8, 10 10 1 2))&quot; ) );</span></a>
<a name="7060"><span class="lineNum">    7060 </span>                :<span class="lineCov">          2 :   rhr.fromWkt( QStringLiteral( &quot;PolygonZM ((0 0 3 4, 100 0 13 14, 100 100 13 14, 0 100 23 24, 0 0 3 4),(10 10 1 2, 20 10 3 4, 20 20 4, 5, 10 20 6 8, 10 10 1 2))&quot; ) );</span></a>
<a name="7061"><span class="lineNum">    7061 </span>                :<span class="lineCov">          1 :   rhr.forceRHR();</span></a>
<a name="7062"><span class="lineNum">    7062 </span>                :<span class="lineCov">          2 :   QCOMPARE( rhr.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 23 24, 100 100 13 14, 100 0 13 14, 0 0 3 4),(10 10 1 2, 20 10 3 4, 10 20 6 8, 10 10 1 2))&quot; ) );</span></a>
<a name="7063"><span class="lineNum">    7063 </span>                :<span class="lineCov">          2 :   rhr.fromWkt( QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4),(10 10 1 2, 10 20 3 4, 20 10 6 8, 10 10 1 2))&quot; ) );</span></a>
<a name="7064"><span class="lineNum">    7064 </span>                :<span class="lineCov">          1 :   rhr.forceRHR();</span></a>
<a name="7065"><span class="lineNum">    7065 </span>                :<span class="lineCov">          2 :   QCOMPARE( rhr.asWkt( 2 ), QStringLiteral( &quot;PolygonZM ((0 0 3 4, 0 100 13 14, 100 100 13 14, 100 0 23 24, 0 0 3 4),(10 10 1 2, 20 10 6 8, 10 20 3 4, 10 10 1 2))&quot; ) );</span></a>
<a name="7066"><span class="lineNum">    7066 </span>                :            : </a>
<a name="7067"><span class="lineNum">    7067 </span>                :            :   // test bounding box intersects</a>
<a name="7068"><span class="lineNum">    7068 </span>                :<span class="lineCov">          1 :   QgsPolygon bb;</span></a>
<a name="7069"><span class="lineNum">    7069 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7070"><span class="lineNum">    7070 </span>                :<span class="lineCov">          1 :   QgsLineString bbR;</span></a>
<a name="7071"><span class="lineNum">    7071 </span>                :<span class="lineCov">          1 :   bbR.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 4, 2 ) &lt;&lt; QgsPoint( 4, 4 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="7072"><span class="lineNum">    7072 </span>                :<span class="lineCov">          1 :   bb.setExteriorRing( bbR.clone() );</span></a>
<a name="7073"><span class="lineNum">    7073 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7074"><span class="lineNum">    7074 </span>                :            :   // double test because of cache</a>
<a name="7075"><span class="lineNum">    7075 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7076"><span class="lineNum">    7076 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 11, 3, 6, 9 ) ) );</span></a>
<a name="7077"><span class="lineNum">    7077 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 11, 3, 6, 9 ) ) );</span></a>
<a name="7078"><span class="lineNum">    7078 </span>                :<span class="lineCov">          1 :   QCOMPARE( bb.boundingBox(), QgsRectangle( 0, 2, 4, 4 ) );</span></a>
<a name="7079"><span class="lineNum">    7079 </span>                :            :   // clear cache</a>
<a name="7080"><span class="lineNum">    7080 </span>                :<span class="lineCov">          1 :   bbR.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 2 ) &lt;&lt; QgsPoint( 14, 2 ) &lt;&lt; QgsPoint( 15, 4 ) &lt;&lt; QgsPoint( 10, 2 ) );</span></a>
<a name="7081"><span class="lineNum">    7081 </span>                :<span class="lineCov">          1 :   bb.setExteriorRing( bbR.clone() );</span></a>
<a name="7082"><span class="lineNum">    7082 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7083"><span class="lineNum">    7083 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7084"><span class="lineNum">    7084 </span>                :<span class="lineCov">          1 :   QCOMPARE( bb.boundingBox(), QgsRectangle( 10, 2, 15, 4 ) );</span></a>
<a name="7085"><span class="lineNum">    7085 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 11, 3, 16, 9 ) ) );</span></a>
<a name="7086"><span class="lineNum">    7086 </span>                :            :   // technically invalid -- the interior ring is outside the exterior, but we want boundingBoxIntersects to be tolerant to</a>
<a name="7087"><span class="lineNum">    7087 </span>                :            :   // cases like this!</a>
<a name="7088"><span class="lineNum">    7088 </span>                :<span class="lineCov">          1 :   bbR.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 4, 2 ) &lt;&lt; QgsPoint( 5, 4 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="7089"><span class="lineNum">    7089 </span>                :<span class="lineCov">          1 :   bb.addInteriorRing( bbR.clone() );</span></a>
<a name="7090"><span class="lineNum">    7090 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7091"><span class="lineNum">    7091 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 1, 3, 6, 9 ) ) );</span></a>
<a name="7092"><span class="lineNum">    7092 </span>                :<span class="lineCov">          1 :   QVERIFY( bb.boundingBoxIntersects( QgsRectangle( 11, 3, 16, 9 ) ) );</span></a>
<a name="7093"><span class="lineNum">    7093 </span>                :<span class="lineCov">          1 :   QVERIFY( !bb.boundingBoxIntersects( QgsRectangle( 21, 3, 26, 9 ) ) );</span></a>
<a name="7094"><span class="lineNum">    7094 </span>                :<span class="lineCov">          1 :   QCOMPARE( bb.boundingBox(), QgsRectangle( 10, 2, 15, 4 ) );</span></a>
<a name="7095"><span class="lineNum">    7095 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="7096"><span class="lineNum">    7096 </span>                :            : </a>
<a name="7097"><span class="lineNum">    7097 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::triangle()</span></a>
<a name="7098"><span class="lineNum">    7098 </span>                :            : {</a>
<a name="7099"><span class="lineNum">    7099 </span>                :            :   //test constructor</a>
<a name="7100"><span class="lineNum">    7100 </span>                :<span class="lineCov">          1 :   QgsTriangle t1;</span></a>
<a name="7101"><span class="lineNum">    7101 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.isEmpty() );</span></a>
<a name="7102"><span class="lineNum">    7102 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.numInteriorRings(), 0 );</span></a>
<a name="7103"><span class="lineNum">    7103 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.nCoordinates(), 0 );</span></a>
<a name="7104"><span class="lineNum">    7104 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.ringCount(), 0 );</span></a>
<a name="7105"><span class="lineNum">    7105 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.partCount(), 0 );</span></a>
<a name="7106"><span class="lineNum">    7106 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.is3D() );</span></a>
<a name="7107"><span class="lineNum">    7107 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isMeasure() );</span></a>
<a name="7108"><span class="lineNum">    7108 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7109"><span class="lineNum">    7109 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7110"><span class="lineNum">    7110 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7111"><span class="lineNum">    7111 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7112"><span class="lineNum">    7112 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.hasCurvedSegments() );</span></a>
<a name="7113"><span class="lineNum">    7113 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.area(), 0.0 );</span></a>
<a name="7114"><span class="lineNum">    7114 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.perimeter(), 0.0 );</span></a>
<a name="7115"><span class="lineNum">    7115 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.exteriorRing() );</span></a>
<a name="7116"><span class="lineNum">    7116 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.interiorRing( 0 ) );</span></a>
<a name="7117"><span class="lineNum">    7117 </span>                :            : </a>
<a name="7118"><span class="lineNum">    7118 </span>                :            :   // degenerate triangles</a>
<a name="7119"><span class="lineNum">    7119 </span>                :<span class="lineCov">          1 :   QgsTriangle invalid( QgsPointXY( 0, 0 ), QgsPointXY( 0, 0 ), QgsPointXY( 10, 10 ) );</span></a>
<a name="7120"><span class="lineNum">    7120 </span>                :<span class="lineCov">          1 :   QVERIFY( !invalid.isEmpty() );</span></a>
<a name="7121"><span class="lineNum">    7121 </span>                :<span class="lineCov">          1 :   invalid = QgsTriangle( QPointF( 0, 0 ), QPointF( 0, 0 ), QPointF( 10, 10 ) );</span></a>
<a name="7122"><span class="lineNum">    7122 </span>                :<span class="lineCov">          1 :   QVERIFY( !invalid.isEmpty() );</span></a>
<a name="7123"><span class="lineNum">    7123 </span>                :            :   //set exterior ring</a>
<a name="7124"><span class="lineNum">    7124 </span>                :            : </a>
<a name="7125"><span class="lineNum">    7125 </span>                :            :   //try with no ring</a>
<a name="7126"><span class="lineNum">    7126 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; ext;</span></a>
<a name="7127"><span class="lineNum">    7127 </span>                :<span class="lineCov">          1 :   t1.setExteriorRing( nullptr );</span></a>
<a name="7128"><span class="lineNum">    7128 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.isEmpty() );</span></a>
<a name="7129"><span class="lineNum">    7129 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.numInteriorRings(), 0 );</span></a>
<a name="7130"><span class="lineNum">    7130 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.nCoordinates(), 0 );</span></a>
<a name="7131"><span class="lineNum">    7131 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.ringCount(), 0 );</span></a>
<a name="7132"><span class="lineNum">    7132 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.partCount(), 0 );</span></a>
<a name="7133"><span class="lineNum">    7133 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.exteriorRing() );</span></a>
<a name="7134"><span class="lineNum">    7134 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.interiorRing( 0 ) );</span></a>
<a name="7135"><span class="lineNum">    7135 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7136"><span class="lineNum">    7136 </span>                :            : </a>
<a name="7137"><span class="lineNum">    7137 </span>                :            :   //valid exterior ring</a>
<a name="7138"><span class="lineNum">    7138 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7139"><span class="lineNum">    7139 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="7140"><span class="lineNum">    7140 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="7141"><span class="lineNum">    7141 </span>                :<span class="lineCov">          1 :   QVERIFY( ext-&gt;isClosed() );</span></a>
<a name="7142"><span class="lineNum">    7142 </span>                :<span class="lineCov">          1 :   t1.setExteriorRing( ext-&gt;clone() );</span></a>
<a name="7143"><span class="lineNum">    7143 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isEmpty() );</span></a>
<a name="7144"><span class="lineNum">    7144 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.numInteriorRings(), 0 );</span></a>
<a name="7145"><span class="lineNum">    7145 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.nCoordinates(), 4 );</span></a>
<a name="7146"><span class="lineNum">    7146 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.ringCount(), 1 );</span></a>
<a name="7147"><span class="lineNum">    7147 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.partCount(), 1 );</span></a>
<a name="7148"><span class="lineNum">    7148 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.is3D() );</span></a>
<a name="7149"><span class="lineNum">    7149 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isMeasure() );</span></a>
<a name="7150"><span class="lineNum">    7150 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7151"><span class="lineNum">    7151 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7152"><span class="lineNum">    7152 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7153"><span class="lineNum">    7153 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7154"><span class="lineNum">    7154 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.hasCurvedSegments() );</span></a>
<a name="7155"><span class="lineNum">    7155 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.area(), 50.0 );</span></a>
<a name="7156"><span class="lineNum">    7156 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t1.perimeter(), 34.1421, 0.001 );</span></a>
<a name="7157"><span class="lineNum">    7157 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.exteriorRing() );</span></a>
<a name="7158"><span class="lineNum">    7158 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.interiorRing( 0 ) );</span></a>
<a name="7159"><span class="lineNum">    7159 </span>                :            : </a>
<a name="7160"><span class="lineNum">    7160 </span>                :            :   //retrieve exterior ring and check</a>
<a name="7161"><span class="lineNum">    7161 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( t1.exteriorRing() ) ), *ext );</span></a>
<a name="7162"><span class="lineNum">    7162 </span>                :            : </a>
<a name="7163"><span class="lineNum">    7163 </span>                :            :   //set new ExteriorRing</a>
<a name="7164"><span class="lineNum">    7164 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7165"><span class="lineNum">    7165 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 5, 5 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="7166"><span class="lineNum">    7166 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 0, 10 ) );</span></a>
<a name="7167"><span class="lineNum">    7167 </span>                :<span class="lineCov">          1 :   QVERIFY( ext-&gt;isClosed() );</span></a>
<a name="7168"><span class="lineNum">    7168 </span>                :<span class="lineCov">          1 :   t1.setExteriorRing( ext-&gt;clone() );</span></a>
<a name="7169"><span class="lineNum">    7169 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isEmpty() );</span></a>
<a name="7170"><span class="lineNum">    7170 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.numInteriorRings(), 0 );</span></a>
<a name="7171"><span class="lineNum">    7171 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.nCoordinates(), 4 );</span></a>
<a name="7172"><span class="lineNum">    7172 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.ringCount(), 1 );</span></a>
<a name="7173"><span class="lineNum">    7173 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.partCount(), 1 );</span></a>
<a name="7174"><span class="lineNum">    7174 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.is3D() );</span></a>
<a name="7175"><span class="lineNum">    7175 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isMeasure() );</span></a>
<a name="7176"><span class="lineNum">    7176 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7177"><span class="lineNum">    7177 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7178"><span class="lineNum">    7178 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7179"><span class="lineNum">    7179 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7180"><span class="lineNum">    7180 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.hasCurvedSegments() );</span></a>
<a name="7181"><span class="lineNum">    7181 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.area(), 25.0 );</span></a>
<a name="7182"><span class="lineNum">    7182 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t1.perimeter(), 24.1421, 0.001 );</span></a>
<a name="7183"><span class="lineNum">    7183 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.exteriorRing() );</span></a>
<a name="7184"><span class="lineNum">    7184 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.interiorRing( 0 ) );</span></a>
<a name="7185"><span class="lineNum">    7185 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( t1.exteriorRing() ) ), *ext );</span></a>
<a name="7186"><span class="lineNum">    7186 </span>                :            : </a>
<a name="7187"><span class="lineNum">    7187 </span>                :            :   // AddZ</a>
<a name="7188"><span class="lineNum">    7188 </span>                :<span class="lineCov">          1 :   QgsLineString lz;</span></a>
<a name="7189"><span class="lineNum">    7189 </span>                :<span class="lineCov">          1 :   lz.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3 ) &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 1, 12, 23 ) &lt;&lt; QgsPoint( 1, 2, 3 ) );</span></a>
<a name="7190"><span class="lineNum">    7190 </span>                :<span class="lineCov">          1 :   t1.setExteriorRing( lz.clone() );</span></a>
<a name="7191"><span class="lineNum">    7191 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.is3D() );</span></a>
<a name="7192"><span class="lineNum">    7192 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isMeasure() );</span></a>
<a name="7193"><span class="lineNum">    7193 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::TriangleZ );</span></a>
<a name="7194"><span class="lineNum">    7194 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;TriangleZ&quot; ) );</span></a>
<a name="7195"><span class="lineNum">    7195 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7196"><span class="lineNum">    7196 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7197"><span class="lineNum">    7197 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 0 ).z(),  3.0 );</span></a>
<a name="7198"><span class="lineNum">    7198 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 1 ).z(), 13.0 );</span></a>
<a name="7199"><span class="lineNum">    7199 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 2 ).z(), 23.0 );</span></a>
<a name="7200"><span class="lineNum">    7200 </span>                :            :   // AddM</a>
<a name="7201"><span class="lineNum">    7201 </span>                :<span class="lineCov">          1 :   QgsLineString lzm;</span></a>
<a name="7202"><span class="lineNum">    7202 </span>                :<span class="lineCov">          1 :   lzm.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="7203"><span class="lineNum">    7203 </span>                :<span class="lineCov">          1 :   t1.setExteriorRing( lzm.clone() );</span></a>
<a name="7204"><span class="lineNum">    7204 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.is3D() );</span></a>
<a name="7205"><span class="lineNum">    7205 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.isMeasure() );</span></a>
<a name="7206"><span class="lineNum">    7206 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::TriangleZM );</span></a>
<a name="7207"><span class="lineNum">    7207 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;TriangleZM&quot; ) );</span></a>
<a name="7208"><span class="lineNum">    7208 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7209"><span class="lineNum">    7209 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7210"><span class="lineNum">    7210 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 0 ).m(),  4.0 );</span></a>
<a name="7211"><span class="lineNum">    7211 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 1 ).m(), 14.0 );</span></a>
<a name="7212"><span class="lineNum">    7212 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.vertexAt( 2 ).m(), 24.0 );</span></a>
<a name="7213"><span class="lineNum">    7213 </span>                :            :   // dropZ</a>
<a name="7214"><span class="lineNum">    7214 </span>                :<span class="lineCov">          1 :   t1.dropZValue();</span></a>
<a name="7215"><span class="lineNum">    7215 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.is3D() );</span></a>
<a name="7216"><span class="lineNum">    7216 </span>                :<span class="lineCov">          1 :   QVERIFY( t1.isMeasure() );</span></a>
<a name="7217"><span class="lineNum">    7217 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::TriangleM );</span></a>
<a name="7218"><span class="lineNum">    7218 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;TriangleM&quot; ) );</span></a>
<a name="7219"><span class="lineNum">    7219 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7220"><span class="lineNum">    7220 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7221"><span class="lineNum">    7221 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 0 ).z() ) );</span></a>
<a name="7222"><span class="lineNum">    7222 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 1 ).z() ) );</span></a>
<a name="7223"><span class="lineNum">    7223 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 2 ).z() ) );</span></a>
<a name="7224"><span class="lineNum">    7224 </span>                :            :   // dropM</a>
<a name="7225"><span class="lineNum">    7225 </span>                :<span class="lineCov">          1 :   t1.dropMValue();</span></a>
<a name="7226"><span class="lineNum">    7226 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.is3D() );</span></a>
<a name="7227"><span class="lineNum">    7227 </span>                :<span class="lineCov">          1 :   QVERIFY( !t1.isMeasure() );</span></a>
<a name="7228"><span class="lineNum">    7228 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7229"><span class="lineNum">    7229 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7230"><span class="lineNum">    7230 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7231"><span class="lineNum">    7231 </span>                :<span class="lineCov">          1 :   QCOMPARE( t1.dimension(), 2 );</span></a>
<a name="7232"><span class="lineNum">    7232 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 0 ).m() ) );</span></a>
<a name="7233"><span class="lineNum">    7233 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 1 ).m() ) );</span></a>
<a name="7234"><span class="lineNum">    7234 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( t1.vertexAt( 2 ).m() ) );</span></a>
<a name="7235"><span class="lineNum">    7235 </span>                :            : </a>
<a name="7236"><span class="lineNum">    7236 </span>                :            :   //test that a non closed exterior ring will be automatically closed</a>
<a name="7237"><span class="lineNum">    7237 </span>                :<span class="lineCov">          1 :   QgsTriangle t2;</span></a>
<a name="7238"><span class="lineNum">    7238 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7239"><span class="lineNum">    7239 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="7240"><span class="lineNum">    7240 </span>                :<span class="lineCov">          1 :   QVERIFY( !ext-&gt;isClosed() );</span></a>
<a name="7241"><span class="lineNum">    7241 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7242"><span class="lineNum">    7242 </span>                :<span class="lineCov">          1 :   QVERIFY( !t2.isEmpty() );</span></a>
<a name="7243"><span class="lineNum">    7243 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.exteriorRing()-&gt;isClosed() );</span></a>
<a name="7244"><span class="lineNum">    7244 </span>                :<span class="lineCov">          1 :   QCOMPARE( t2.nCoordinates(), 4 );</span></a>
<a name="7245"><span class="lineNum">    7245 </span>                :            : </a>
<a name="7246"><span class="lineNum">    7246 </span>                :            :   // invalid number of points</a>
<a name="7247"><span class="lineNum">    7247 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7248"><span class="lineNum">    7248 </span>                :<span class="lineCov">          1 :   t2.clear();</span></a>
<a name="7249"><span class="lineNum">    7249 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) );</span></a>
<a name="7250"><span class="lineNum">    7250 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7251"><span class="lineNum">    7251 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.isEmpty() );</span></a>
<a name="7252"><span class="lineNum">    7252 </span>                :            : </a>
<a name="7253"><span class="lineNum">    7253 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7254"><span class="lineNum">    7254 </span>                :<span class="lineCov">          1 :   t2.clear();</span></a>
<a name="7255"><span class="lineNum">    7255 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 8, 10 ) );</span></a>
<a name="7256"><span class="lineNum">    7256 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7257"><span class="lineNum">    7257 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.isEmpty() );</span></a>
<a name="7258"><span class="lineNum">    7258 </span>                :            : </a>
<a name="7259"><span class="lineNum">    7259 </span>                :            :   // invalid exterior ring</a>
<a name="7260"><span class="lineNum">    7260 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7261"><span class="lineNum">    7261 </span>                :<span class="lineCov">          1 :   t2.clear();</span></a>
<a name="7262"><span class="lineNum">    7262 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="7263"><span class="lineNum">    7263 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7264"><span class="lineNum">    7264 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.isEmpty() );</span></a>
<a name="7265"><span class="lineNum">    7265 </span>                :            : </a>
<a name="7266"><span class="lineNum">    7266 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7267"><span class="lineNum">    7267 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="7268"><span class="lineNum">    7268 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7269"><span class="lineNum">    7269 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.isEmpty() );</span></a>
<a name="7270"><span class="lineNum">    7270 </span>                :            : </a>
<a name="7271"><span class="lineNum">    7271 </span>                :            :   // degenerate case</a>
<a name="7272"><span class="lineNum">    7272 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7273"><span class="lineNum">    7273 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="7274"><span class="lineNum">    7274 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( ext.release() );</span></a>
<a name="7275"><span class="lineNum">    7275 </span>                :<span class="lineCov">          1 :   QVERIFY( !t2.isEmpty() );</span></a>
<a name="7276"><span class="lineNum">    7276 </span>                :            : </a>
<a name="7277"><span class="lineNum">    7277 </span>                :            :   // circular ring</a>
<a name="7278"><span class="lineNum">    7278 </span>                :<span class="lineCov">          1 :   QgsCircularString *circularRing = new QgsCircularString();</span></a>
<a name="7279"><span class="lineNum">    7279 </span>                :<span class="lineCov">          1 :   t2.clear();</span></a>
<a name="7280"><span class="lineNum">    7280 </span>                :<span class="lineCov">          1 :   circularRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="7281"><span class="lineNum">    7281 </span>                :<span class="lineCov">          1 :   QVERIFY( circularRing-&gt;hasCurvedSegments() );</span></a>
<a name="7282"><span class="lineNum">    7282 </span>                :<span class="lineCov">          1 :   t2.setExteriorRing( circularRing );</span></a>
<a name="7283"><span class="lineNum">    7283 </span>                :<span class="lineCov">          1 :   QVERIFY( t2.isEmpty() );</span></a>
<a name="7284"><span class="lineNum">    7284 </span>                :            : </a>
<a name="7285"><span class="lineNum">    7285 </span>                :            :   //constructor with 3 points</a>
<a name="7286"><span class="lineNum">    7286 </span>                :            :   // double points</a>
<a name="7287"><span class="lineNum">    7287 </span>                :<span class="lineCov">          1 :   QgsTriangle t3( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ), QgsPoint( 10, 10 ) );</span></a>
<a name="7288"><span class="lineNum">    7288 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7289"><span class="lineNum">    7289 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.numInteriorRings(), 0 );</span></a>
<a name="7290"><span class="lineNum">    7290 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.nCoordinates(), 4 );</span></a>
<a name="7291"><span class="lineNum">    7291 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.ringCount(), 1 );</span></a>
<a name="7292"><span class="lineNum">    7292 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.partCount(), 1 );</span></a>
<a name="7293"><span class="lineNum">    7293 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.is3D() );</span></a>
<a name="7294"><span class="lineNum">    7294 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isMeasure() );</span></a>
<a name="7295"><span class="lineNum">    7295 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7296"><span class="lineNum">    7296 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7297"><span class="lineNum">    7297 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7298"><span class="lineNum">    7298 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.dimension(), 2 );</span></a>
<a name="7299"><span class="lineNum">    7299 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.hasCurvedSegments() );</span></a>
<a name="7300"><span class="lineNum">    7300 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.area(), 0.0 );</span></a>
<a name="7301"><span class="lineNum">    7301 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t3.perimeter(), 28.284271, 0.001 );</span></a>
<a name="7302"><span class="lineNum">    7302 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.exteriorRing() );</span></a>
<a name="7303"><span class="lineNum">    7303 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.interiorRing( 0 ) );</span></a>
<a name="7304"><span class="lineNum">    7304 </span>                :            : </a>
<a name="7305"><span class="lineNum">    7305 </span>                :            :   // colinear</a>
<a name="7306"><span class="lineNum">    7306 </span>                :<span class="lineCov">          1 :   t3 = QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 10 ) );</span></a>
<a name="7307"><span class="lineNum">    7307 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7308"><span class="lineNum">    7308 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.numInteriorRings(), 0 );</span></a>
<a name="7309"><span class="lineNum">    7309 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.nCoordinates(), 4 );</span></a>
<a name="7310"><span class="lineNum">    7310 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.ringCount(), 1 );</span></a>
<a name="7311"><span class="lineNum">    7311 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.partCount(), 1 );</span></a>
<a name="7312"><span class="lineNum">    7312 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.is3D() );</span></a>
<a name="7313"><span class="lineNum">    7313 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isMeasure() );</span></a>
<a name="7314"><span class="lineNum">    7314 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7315"><span class="lineNum">    7315 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7316"><span class="lineNum">    7316 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7317"><span class="lineNum">    7317 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.dimension(), 2 );</span></a>
<a name="7318"><span class="lineNum">    7318 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.hasCurvedSegments() );</span></a>
<a name="7319"><span class="lineNum">    7319 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.area(), 0.0 );</span></a>
<a name="7320"><span class="lineNum">    7320 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t3.perimeter(), 10.0 * 2, 0.001 );</span></a>
<a name="7321"><span class="lineNum">    7321 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.exteriorRing() );</span></a>
<a name="7322"><span class="lineNum">    7322 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.interiorRing( 0 ) );</span></a>
<a name="7323"><span class="lineNum">    7323 </span>                :            : </a>
<a name="7324"><span class="lineNum">    7324 </span>                :<span class="lineCov">          1 :   t3 = QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 0, 10 ), QgsPoint( 10, 10 ) );</span></a>
<a name="7325"><span class="lineNum">    7325 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7326"><span class="lineNum">    7326 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.numInteriorRings(), 0 );</span></a>
<a name="7327"><span class="lineNum">    7327 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.nCoordinates(), 4 );</span></a>
<a name="7328"><span class="lineNum">    7328 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.ringCount(), 1 );</span></a>
<a name="7329"><span class="lineNum">    7329 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.partCount(), 1 );</span></a>
<a name="7330"><span class="lineNum">    7330 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.is3D() );</span></a>
<a name="7331"><span class="lineNum">    7331 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isMeasure() );</span></a>
<a name="7332"><span class="lineNum">    7332 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7333"><span class="lineNum">    7333 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7334"><span class="lineNum">    7334 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7335"><span class="lineNum">    7335 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.dimension(), 2 );</span></a>
<a name="7336"><span class="lineNum">    7336 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.hasCurvedSegments() );</span></a>
<a name="7337"><span class="lineNum">    7337 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.area(), 50.0 );</span></a>
<a name="7338"><span class="lineNum">    7338 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t3.perimeter(), 34.1421, 0.001 );</span></a>
<a name="7339"><span class="lineNum">    7339 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.exteriorRing() );</span></a>
<a name="7340"><span class="lineNum">    7340 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.interiorRing( 0 ) );</span></a>
<a name="7341"><span class="lineNum">    7341 </span>                :            : </a>
<a name="7342"><span class="lineNum">    7342 </span>                :            :   // equality</a>
<a name="7343"><span class="lineNum">    7343 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle() == QgsTriangle() ); // empty</span></a>
<a name="7344"><span class="lineNum">    7344 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle() != QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 10 ) ) ); // empty</span></a>
<a name="7345"><span class="lineNum">    7345 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 10 ) ) != QgsTriangle() ); // empty</span></a>
<a name="7346"><span class="lineNum">    7346 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle() != QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ), QgsPoint( 0, 10 ) ) );</span></a>
<a name="7347"><span class="lineNum">    7347 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ), QgsPoint( 0, 10 ) ) != QgsTriangle() );</span></a>
<a name="7348"><span class="lineNum">    7348 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ), QgsPoint( 0, 10 ) ) != QgsTriangle( QgsPoint( 0, 10 ), QgsPoint( 5, 5 ), QgsPoint( 0, 0 ) ) );</span></a>
<a name="7349"><span class="lineNum">    7349 </span>                :            : </a>
<a name="7350"><span class="lineNum">    7350 </span>                :            :   // clone</a>
<a name="7351"><span class="lineNum">    7351 </span>                :<span class="lineCov">          1 :   QgsTriangle *t4 = t3.clone();</span></a>
<a name="7352"><span class="lineNum">    7352 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3, *t4 );</span></a>
<a name="7353"><span class="lineNum">    7353 </span>                :<span class="lineCov">          1 :   delete t4;</span></a>
<a name="7354"><span class="lineNum">    7354 </span>                :            : </a>
<a name="7355"><span class="lineNum">    7355 </span>                :            :   // constructor from QgsPointXY and QPointF</a>
<a name="7356"><span class="lineNum">    7356 </span>                :<span class="lineCov">          1 :   QgsTriangle t_qgspoint = QgsTriangle( QgsPointXY( 0, 0 ), QgsPointXY( 0, 10 ), QgsPointXY( 10, 10 ) );</span></a>
<a name="7357"><span class="lineNum">    7357 </span>                :<span class="lineCov">          1 :   QVERIFY( t3 == t_qgspoint );</span></a>
<a name="7358"><span class="lineNum">    7358 </span>                :<span class="lineCov">          1 :   QgsTriangle t_pointf = QgsTriangle( QPointF( 0, 0 ), QPointF( 0, 10 ), QPointF( 10, 10 ) );</span></a>
<a name="7359"><span class="lineNum">    7359 </span>                :<span class="lineCov">          1 :   QVERIFY( t3 == t_pointf );</span></a>
<a name="7360"><span class="lineNum">    7360 </span>                :            : </a>
<a name="7361"><span class="lineNum">    7361 </span>                :            :   // Z</a>
<a name="7362"><span class="lineNum">    7362 </span>                :<span class="lineCov">          1 :   t3 = QgsTriangle( QgsPoint( QgsWkbTypes::PointZ, 0, 5, 1 ), QgsPoint( QgsWkbTypes::PointZ, 0, 0, 2 ), QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 ) );</span></a>
<a name="7363"><span class="lineNum">    7363 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7364"><span class="lineNum">    7364 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.is3D() );</span></a>
<a name="7365"><span class="lineNum">    7365 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isMeasure() );</span></a>
<a name="7366"><span class="lineNum">    7366 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::TriangleZ );</span></a>
<a name="7367"><span class="lineNum">    7367 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;TriangleZ&quot; ) );</span></a>
<a name="7368"><span class="lineNum">    7368 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7369"><span class="lineNum">    7369 </span>                :            :   // M</a>
<a name="7370"><span class="lineNum">    7370 </span>                :<span class="lineCov">          1 :   t3 = QgsTriangle( QgsPoint( QgsWkbTypes::PointM, 0, 5, 0, 1 ), QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 2 ), QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 ) );</span></a>
<a name="7371"><span class="lineNum">    7371 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7372"><span class="lineNum">    7372 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.is3D() );</span></a>
<a name="7373"><span class="lineNum">    7373 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.isMeasure() );</span></a>
<a name="7374"><span class="lineNum">    7374 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::TriangleM );</span></a>
<a name="7375"><span class="lineNum">    7375 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;TriangleM&quot; ) );</span></a>
<a name="7376"><span class="lineNum">    7376 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7377"><span class="lineNum">    7377 </span>                :            :   // ZM</a>
<a name="7378"><span class="lineNum">    7378 </span>                :<span class="lineCov">          1 :   t3 = QgsTriangle( QgsPoint( QgsWkbTypes::PointZM, 0, 5, 8, 1 ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 5, 2 ), QgsPoint( QgsWkbTypes::PointZM, 10, 10, 2, 3 ) );</span></a>
<a name="7379"><span class="lineNum">    7379 </span>                :<span class="lineCov">          1 :   QVERIFY( !t3.isEmpty() );</span></a>
<a name="7380"><span class="lineNum">    7380 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.is3D() );</span></a>
<a name="7381"><span class="lineNum">    7381 </span>                :<span class="lineCov">          1 :   QVERIFY( t3.isMeasure() );</span></a>
<a name="7382"><span class="lineNum">    7382 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wkbType(), QgsWkbTypes::TriangleZM );</span></a>
<a name="7383"><span class="lineNum">    7383 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.wktTypeStr(), QString( &quot;TriangleZM&quot; ) );</span></a>
<a name="7384"><span class="lineNum">    7384 </span>                :<span class="lineCov">          1 :   QCOMPARE( t3.geometryType(), QString( &quot;Triangle&quot; ) );</span></a>
<a name="7385"><span class="lineNum">    7385 </span>                :            : </a>
<a name="7386"><span class="lineNum">    7386 </span>                :            :   // fromWkt</a>
<a name="7387"><span class="lineNum">    7387 </span>                :<span class="lineCov">          1 :   QgsTriangle t5;</span></a>
<a name="7388"><span class="lineNum">    7388 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7389"><span class="lineNum">    7389 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="7390"><span class="lineNum">    7390 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 ) );</span></a>
<a name="7391"><span class="lineNum">    7391 </span>                :<span class="lineCov">          1 :   t5.setExteriorRing( ext.release() );</span></a>
<a name="7392"><span class="lineNum">    7392 </span>                :<span class="lineCov">          1 :   QString wkt = t5.asWkt();</span></a>
<a name="7393"><span class="lineNum">    7393 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="7394"><span class="lineNum">    7394 </span>                :<span class="lineCov">          1 :   QgsTriangle t6;</span></a>
<a name="7395"><span class="lineNum">    7395 </span>                :<span class="lineCov">          1 :   QVERIFY( t6.fromWkt( wkt ) );</span></a>
<a name="7396"><span class="lineNum">    7396 </span>                :<span class="lineCov">          1 :   QCOMPARE( t5, t6 );</span></a>
<a name="7397"><span class="lineNum">    7397 </span>                :            : </a>
<a name="7398"><span class="lineNum">    7398 </span>                :            :   // conversion</a>
<a name="7399"><span class="lineNum">    7399 </span>                :<span class="lineCov">          1 :   QgsPolygon p1;</span></a>
<a name="7400"><span class="lineNum">    7400 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7401"><span class="lineNum">    7401 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="7402"><span class="lineNum">    7402 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 ) );</span></a>
<a name="7403"><span class="lineNum">    7403 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext.release() );</span></a>
<a name="7404"><span class="lineNum">    7404 </span>                :            :   //toPolygon</a>
<a name="7405"><span class="lineNum">    7405 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; poly( t5.toPolygon() );</span></a>
<a name="7406"><span class="lineNum">    7406 </span>                :<span class="lineCov">          1 :   QCOMPARE( *poly, p1 );</span></a>
<a name="7407"><span class="lineNum">    7407 </span>                :            :   //surfaceToPolygon</a>
<a name="7408"><span class="lineNum">    7408 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; surface( t5.surfaceToPolygon() );</span></a>
<a name="7409"><span class="lineNum">    7409 </span>                :<span class="lineCov">          1 :   QCOMPARE( *surface, p1 );</span></a>
<a name="7410"><span class="lineNum">    7410 </span>                :            : </a>
<a name="7411"><span class="lineNum">    7411 </span>                :            :   //bad WKT</a>
<a name="7412"><span class="lineNum">    7412 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="7413"><span class="lineNum">    7413 </span>                :<span class="lineCov">          1 :   QVERIFY( t6.isEmpty() );</span></a>
<a name="7414"><span class="lineNum">    7414 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.exteriorRing() );</span></a>
<a name="7415"><span class="lineNum">    7415 </span>                :<span class="lineCov">          1 :   QCOMPARE( t6.numInteriorRings(), 0 );</span></a>
<a name="7416"><span class="lineNum">    7416 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.is3D() );</span></a>
<a name="7417"><span class="lineNum">    7417 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.isMeasure() );</span></a>
<a name="7418"><span class="lineNum">    7418 </span>                :<span class="lineCov">          1 :   QCOMPARE( t6.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7419"><span class="lineNum">    7419 </span>                :            : </a>
<a name="7420"><span class="lineNum">    7420 </span>                :            :   // WKB</a>
<a name="7421"><span class="lineNum">    7421 </span>                :<span class="lineCov">          1 :   QByteArray wkb = t5.asWkb();</span></a>
<a name="7422"><span class="lineNum">    7422 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb.size(), t5.wkbSize() );</span></a>
<a name="7423"><span class="lineNum">    7423 </span>                :<span class="lineCov">          1 :   t6.clear();</span></a>
<a name="7424"><span class="lineNum">    7424 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr5( wkb );</span></a>
<a name="7425"><span class="lineNum">    7425 </span>                :<span class="lineCov">          1 :   t6.fromWkb( wkb16ptr5 );</span></a>
<a name="7426"><span class="lineNum">    7426 </span>                :<span class="lineCov">          1 :   QCOMPARE( t5.wkbType(), QgsWkbTypes::TriangleZM );</span></a>
<a name="7427"><span class="lineNum">    7427 </span>                :<span class="lineCov">          1 :   QCOMPARE( t5, t6 );</span></a>
<a name="7428"><span class="lineNum">    7428 </span>                :            : </a>
<a name="7429"><span class="lineNum">    7429 </span>                :            :   //bad WKB - check for no crash</a>
<a name="7430"><span class="lineNum">    7430 </span>                :<span class="lineCov">          1 :   t6.clear();</span></a>
<a name="7431"><span class="lineNum">    7431 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="7432"><span class="lineNum">    7432 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.fromWkb( nullPtr ) );</span></a>
<a name="7433"><span class="lineNum">    7433 </span>                :<span class="lineCov">          1 :   QCOMPARE( t6.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7434"><span class="lineNum">    7434 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="7435"><span class="lineNum">    7435 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="7436"><span class="lineNum">    7436 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="7437"><span class="lineNum">    7437 </span>                :<span class="lineCov">          1 :   QVERIFY( !t6.fromWkb( wkbPointPtr ) );</span></a>
<a name="7438"><span class="lineNum">    7438 </span>                :<span class="lineCov">          1 :   QCOMPARE( t6.wkbType(), QgsWkbTypes::Triangle );</span></a>
<a name="7439"><span class="lineNum">    7439 </span>                :            : </a>
<a name="7440"><span class="lineNum">    7440 </span>                :            :   //asGML2</a>
<a name="7441"><span class="lineNum">    7441 </span>                :<span class="lineCov">          2 :   QgsTriangle exportTriangle( QgsPoint( 1, 2 ),</span></a>
<a name="7442"><span class="lineNum">    7442 </span>                :<span class="lineCov">          1 :                               QgsPoint( 3, 4 ),</span></a>
<a name="7443"><span class="lineNum">    7443 </span>                :<span class="lineCov">          1 :                               QgsPoint( 6, 5 ) );</span></a>
<a name="7444"><span class="lineNum">    7444 </span>                :<span class="lineCov">          2 :   QgsTriangle exportTriangleZ( QgsPoint( 1, 2, 3 ),</span></a>
<a name="7445"><span class="lineNum">    7445 </span>                :<span class="lineCov">          1 :                                QgsPoint( 11, 12, 13 ),</span></a>
<a name="7446"><span class="lineNum">    7446 </span>                :<span class="lineCov">          1 :                                QgsPoint( 1, 12, 23 ) );</span></a>
<a name="7447"><span class="lineNum">    7447 </span>                :<span class="lineCov">          2 :   QgsTriangle exportTriangleFloat( QgsPoint( 1 + 1 / 3.0, 2 + 2 / 3.0 ),</span></a>
<a name="7448"><span class="lineNum">    7448 </span>                :<span class="lineCov">          1 :                                    QgsPoint( 3 + 1 / 3.0, 4 + 2 / 3.0 ),</span></a>
<a name="7449"><span class="lineNum">    7449 </span>                :<span class="lineCov">          1 :                                    QgsPoint( 6 + 1 / 3.0, 5 + 2 / 3.0 ) );</span></a>
<a name="7450"><span class="lineNum">    7450 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="7451"><span class="lineNum">    7451 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1,2 3,4 6,5 1,2&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="7452"><span class="lineNum">    7452 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportTriangle.asGml2( doc ) ), expectedGML2 );</span></a>
<a name="7453"><span class="lineNum">    7453 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1.333,2.667 3.333,4.667 6.333,5.667 1.333,2.667&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="7454"><span class="lineNum">    7454 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportTriangleFloat.asGml2( doc, 3 ) ), expectedGML2prec3 );</span></a>
<a name="7455"><span class="lineNum">    7455 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="7456"><span class="lineNum">    7456 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsTriangle().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="7457"><span class="lineNum">    7457 </span>                :            : </a>
<a name="7458"><span class="lineNum">    7458 </span>                :            :   //asGML3</a>
<a name="7459"><span class="lineNum">    7459 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Triangle xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1 2 3 4 6 5 1 2&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Triangle&gt;&quot; ) );</span></a>
<a name="7460"><span class="lineNum">    7460 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportTriangle.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="7461"><span class="lineNum">    7461 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Triangle xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1.333 2.667 3.333 4.667 6.333 5.667 1.333 2.667&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Triangle&gt;&quot; ) );</span></a>
<a name="7462"><span class="lineNum">    7462 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportTriangleFloat.asGml3( doc, 3 ) ), expectedGML3prec3 );</span></a>
<a name="7463"><span class="lineNum">    7463 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;Triangle xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="7464"><span class="lineNum">    7464 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsTriangle().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="7465"><span class="lineNum">    7465 </span>                :<span class="lineCov">          2 :   QString expectedGML3Z( QStringLiteral( &quot;&lt;Triangle xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;1 2 3 11 12 13 1 12 23 1 2 3&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Triangle&gt;&quot; ) );</span></a>
<a name="7466"><span class="lineNum">    7466 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportTriangleZ.asGml3( doc ) ), expectedGML3Z );</span></a>
<a name="7467"><span class="lineNum">    7467 </span>                :            : </a>
<a name="7468"><span class="lineNum">    7468 </span>                :            : </a>
<a name="7469"><span class="lineNum">    7469 </span>                :            :   // lengths and angles</a>
<a name="7470"><span class="lineNum">    7470 </span>                :<span class="lineCov">          1 :   QgsTriangle t7( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ) );</span></a>
<a name="7471"><span class="lineNum">    7471 </span>                :            : </a>
<a name="7472"><span class="lineNum">    7472 </span>                :<span class="lineCov">          1 :   QVector&lt;double&gt; a_tested, a_t7 = t7.angles();</span></a>
<a name="7473"><span class="lineNum">    7473 </span>                :<span class="lineCov">          1 :   a_tested.append( M_PI / 4.0 );</span></a>
<a name="7474"><span class="lineNum">    7474 </span>                :<span class="lineCov">          1 :   a_tested.append( M_PI / 2.0 );</span></a>
<a name="7475"><span class="lineNum">    7475 </span>                :<span class="lineCov">          1 :   a_tested.append( M_PI / 4.0 );</span></a>
<a name="7476"><span class="lineNum">    7476 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( a_tested.at( 0 ), a_t7.at( 0 ), 0.0001 );</span></a>
<a name="7477"><span class="lineNum">    7477 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( a_tested.at( 1 ), a_t7.at( 1 ), 0.0001 );</span></a>
<a name="7478"><span class="lineNum">    7478 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( a_tested.at( 2 ), a_t7.at( 2 ), 0.0001 );</span></a>
<a name="7479"><span class="lineNum">    7479 </span>                :<span class="lineCov">          1 :   QVector&lt;double&gt; a_empty = QgsTriangle().angles();</span></a>
<a name="7480"><span class="lineNum">    7480 </span>                :<span class="lineCov">          1 :   QVERIFY( a_empty.isEmpty() );</span></a>
<a name="7481"><span class="lineNum">    7481 </span>                :            : </a>
<a name="7482"><span class="lineNum">    7482 </span>                :<span class="lineCov">          1 :   QVector&lt;double&gt; l_tested, l_t7 = t7.lengths();</span></a>
<a name="7483"><span class="lineNum">    7483 </span>                :<span class="lineCov">          1 :   l_tested.append( 5 );</span></a>
<a name="7484"><span class="lineNum">    7484 </span>                :<span class="lineCov">          1 :   l_tested.append( 5 );</span></a>
<a name="7485"><span class="lineNum">    7485 </span>                :<span class="lineCov">          1 :   l_tested.append( std::sqrt( 5 * 5 + 5 * 5 ) );</span></a>
<a name="7486"><span class="lineNum">    7486 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l_tested.at( 0 ), l_t7.at( 0 ), 0.0001 );</span></a>
<a name="7487"><span class="lineNum">    7487 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l_tested.at( 1 ), l_t7.at( 1 ), 0.0001 );</span></a>
<a name="7488"><span class="lineNum">    7488 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l_tested.at( 2 ), l_t7.at( 2 ), 0.0001 );</span></a>
<a name="7489"><span class="lineNum">    7489 </span>                :<span class="lineCov">          1 :   QVector&lt;double&gt; l_empty = QgsTriangle().lengths();</span></a>
<a name="7490"><span class="lineNum">    7490 </span>                :<span class="lineCov">          1 :   QVERIFY( l_empty.isEmpty() );</span></a>
<a name="7491"><span class="lineNum">    7491 </span>                :            : </a>
<a name="7492"><span class="lineNum">    7492 </span>                :            :   // type of triangle</a>
<a name="7493"><span class="lineNum">    7493 </span>                :            :   // Empty triangle returns always false for the types, except isDegenerate</a>
<a name="7494"><span class="lineNum">    7494 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().isDegenerate() );</span></a>
<a name="7495"><span class="lineNum">    7495 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsTriangle().isRight() );</span></a>
<a name="7496"><span class="lineNum">    7496 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsTriangle().isIsocele() );</span></a>
<a name="7497"><span class="lineNum">    7497 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsTriangle().isScalene() );</span></a>
<a name="7498"><span class="lineNum">    7498 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsTriangle().isEquilateral() );</span></a>
<a name="7499"><span class="lineNum">    7499 </span>                :            : </a>
<a name="7500"><span class="lineNum">    7500 </span>                :            :   // type of triangle</a>
<a name="7501"><span class="lineNum">    7501 </span>                :<span class="lineCov">          1 :   QVERIFY( !t7.isDegenerate() );</span></a>
<a name="7502"><span class="lineNum">    7502 </span>                :<span class="lineCov">          1 :   QVERIFY( t7.isRight() );</span></a>
<a name="7503"><span class="lineNum">    7503 </span>                :<span class="lineCov">          1 :   QVERIFY( t7.isIsocele() );</span></a>
<a name="7504"><span class="lineNum">    7504 </span>                :<span class="lineCov">          1 :   QVERIFY( !t7.isScalene() );</span></a>
<a name="7505"><span class="lineNum">    7505 </span>                :<span class="lineCov">          1 :   QVERIFY( !t7.isEquilateral() );</span></a>
<a name="7506"><span class="lineNum">    7506 </span>                :            : </a>
<a name="7507"><span class="lineNum">    7507 </span>                :<span class="lineCov">          1 :   QgsTriangle t8( QgsPoint( 7.2825, 4.2368 ), QgsPoint( 13.0058, 3.3218 ), QgsPoint( 9.2145, 6.5242 ) );</span></a>
<a name="7508"><span class="lineNum">    7508 </span>                :            :   // angles in radians 58.8978;31.1036;89.9985</a>
<a name="7509"><span class="lineNum">    7509 </span>                :            :   // length 5.79598;4.96279;2.99413</a>
<a name="7510"><span class="lineNum">    7510 </span>                :<span class="lineCov">          1 :   QVERIFY( !t8.isDegenerate() );</span></a>
<a name="7511"><span class="lineNum">    7511 </span>                :<span class="lineCov">          1 :   QVERIFY( t8.isRight() );</span></a>
<a name="7512"><span class="lineNum">    7512 </span>                :<span class="lineCov">          1 :   QVERIFY( !t8.isIsocele() );</span></a>
<a name="7513"><span class="lineNum">    7513 </span>                :<span class="lineCov">          1 :   QVERIFY( t8.isScalene() );</span></a>
<a name="7514"><span class="lineNum">    7514 </span>                :<span class="lineCov">          1 :   QVERIFY( !t8.isEquilateral() );</span></a>
<a name="7515"><span class="lineNum">    7515 </span>                :            : </a>
<a name="7516"><span class="lineNum">    7516 </span>                :<span class="lineCov">          1 :   QgsTriangle t9( QgsPoint( 10, 10 ), QgsPoint( 16, 10 ), QgsPoint( 13, 15.1962 ) );</span></a>
<a name="7517"><span class="lineNum">    7517 </span>                :<span class="lineCov">          1 :   QVERIFY( !t9.isDegenerate() );</span></a>
<a name="7518"><span class="lineNum">    7518 </span>                :<span class="lineCov">          1 :   QVERIFY( !t9.isRight() );</span></a>
<a name="7519"><span class="lineNum">    7519 </span>                :<span class="lineCov">          1 :   QVERIFY( t9.isIsocele() );</span></a>
<a name="7520"><span class="lineNum">    7520 </span>                :<span class="lineCov">          1 :   QVERIFY( !t9.isScalene() );</span></a>
<a name="7521"><span class="lineNum">    7521 </span>                :<span class="lineCov">          1 :   QVERIFY( t9.isEquilateral() );</span></a>
<a name="7522"><span class="lineNum">    7522 </span>                :            : </a>
<a name="7523"><span class="lineNum">    7523 </span>                :            :   // vertex</a>
<a name="7524"><span class="lineNum">    7524 </span>                :<span class="lineCov">          1 :   QVERIFY( t9.vertexAt( -1 ).isEmpty() );</span></a>
<a name="7525"><span class="lineNum">    7525 </span>                :<span class="lineCov">          1 :   QCOMPARE( t9.vertexAt( 0 ), QgsPoint( 10, 10 ) );</span></a>
<a name="7526"><span class="lineNum">    7526 </span>                :<span class="lineCov">          1 :   QCOMPARE( t9.vertexAt( 1 ), QgsPoint( 16, 10 ) );</span></a>
<a name="7527"><span class="lineNum">    7527 </span>                :<span class="lineCov">          1 :   QCOMPARE( t9.vertexAt( 2 ), QgsPoint( 13, 15.1962 ) );</span></a>
<a name="7528"><span class="lineNum">    7528 </span>                :<span class="lineCov">          1 :   QCOMPARE( t9.vertexAt( 3 ), QgsPoint( 10, 10 ) );</span></a>
<a name="7529"><span class="lineNum">    7529 </span>                :<span class="lineCov">          1 :   QVERIFY( t9.vertexAt( 4 ).isEmpty() );</span></a>
<a name="7530"><span class="lineNum">    7530 </span>                :            : </a>
<a name="7531"><span class="lineNum">    7531 </span>                :            :   // altitudes</a>
<a name="7532"><span class="lineNum">    7532 </span>                :<span class="lineCov">          1 :   QgsTriangle t10( QgsPoint( 20, 2 ), QgsPoint( 16, 6 ), QgsPoint( 26, 2 ) );</span></a>
<a name="7533"><span class="lineNum">    7533 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsLineString&gt; alt = QgsTriangle().altitudes();</span></a>
<a name="7534"><span class="lineNum">    7534 </span>                :<span class="lineCov">          1 :   QVERIFY( alt.isEmpty() );</span></a>
<a name="7535"><span class="lineNum">    7535 </span>                :<span class="lineCov">          1 :   alt = t10.altitudes();</span></a>
<a name="7536"><span class="lineNum">    7536 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( alt.at( 0 ).pointN( 1 ), QgsPoint( 20.8276, 4.0690 ), 0.0001 );</span></a>
<a name="7537"><span class="lineNum">    7537 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( alt.at( 1 ).pointN( 1 ), QgsPoint( 16, 2 ), 0.0001 );</span></a>
<a name="7538"><span class="lineNum">    7538 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( alt.at( 2 ).pointN( 1 ), QgsPoint( 23, -1 ), 0.0001 );</span></a>
<a name="7539"><span class="lineNum">    7539 </span>                :            : </a>
<a name="7540"><span class="lineNum">    7540 </span>                :            :   // orthocenter</a>
<a name="7541"><span class="lineNum">    7541 </span>                :            : </a>
<a name="7542"><span class="lineNum">    7542 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().orthocenter().isEmpty() );</span></a>
<a name="7543"><span class="lineNum">    7543 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 16, -8 ), t10.orthocenter() );</span></a>
<a name="7544"><span class="lineNum">    7544 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 0, 5 ), t7.orthocenter() );</span></a>
<a name="7545"><span class="lineNum">    7545 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 13, 11.7321 ), t9.orthocenter(), 0.0001 );</span></a>
<a name="7546"><span class="lineNum">    7546 </span>                :            : </a>
<a name="7547"><span class="lineNum">    7547 </span>                :            :   // circumscribed circle</a>
<a name="7548"><span class="lineNum">    7548 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().circumscribedCenter().isEmpty() );</span></a>
<a name="7549"><span class="lineNum">    7549 </span>                :<span class="lineCov">          1 :   QCOMPARE( 0.0, QgsTriangle().circumscribedRadius() );</span></a>
<a name="7550"><span class="lineNum">    7550 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 2.5, 2.5 ), t7.circumscribedCenter() );</span></a>
<a name="7551"><span class="lineNum">    7551 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 3.5355, t7.circumscribedRadius(), 0.0001 );</span></a>
<a name="7552"><span class="lineNum">    7552 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint( 23, 9 ), t10.circumscribedCenter() );</span></a>
<a name="7553"><span class="lineNum">    7553 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 7.6158, t10.circumscribedRadius(), 0.0001 );</span></a>
<a name="7554"><span class="lineNum">    7554 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 13, 11.7321 ), t9.circumscribedCenter(), 0.0001 );</span></a>
<a name="7555"><span class="lineNum">    7555 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 3.4641, t9.circumscribedRadius(), 0.0001 );</span></a>
<a name="7556"><span class="lineNum">    7556 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 13, 11.7321 ), t9.circumscribedCircle().center(), 0.0001 );</span></a>
<a name="7557"><span class="lineNum">    7557 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 3.4641, t9.circumscribedCircle().radius(), 0.0001 );</span></a>
<a name="7558"><span class="lineNum">    7558 </span>                :            : </a>
<a name="7559"><span class="lineNum">    7559 </span>                :            :   // inscribed circle</a>
<a name="7560"><span class="lineNum">    7560 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().inscribedCenter().isEmpty() );</span></a>
<a name="7561"><span class="lineNum">    7561 </span>                :<span class="lineCov">          1 :   QCOMPARE( 0.0, QgsTriangle().inscribedRadius() );</span></a>
<a name="7562"><span class="lineNum">    7562 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 1.4645, 3.5355 ), t7.inscribedCenter(), 0.001 );</span></a>
<a name="7563"><span class="lineNum">    7563 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 1.4645, t7.inscribedRadius(), 0.0001 );</span></a>
<a name="7564"><span class="lineNum">    7564 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 20.4433, 3.0701 ), t10.inscribedCenter(), 0.001 );</span></a>
<a name="7565"><span class="lineNum">    7565 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 1.0701, t10.inscribedRadius(), 0.0001 );</span></a>
<a name="7566"><span class="lineNum">    7566 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 13, 11.7321 ), t9.inscribedCenter(), 0.0001 );</span></a>
<a name="7567"><span class="lineNum">    7567 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 1.7321, t9.inscribedRadius(), 0.0001 );</span></a>
<a name="7568"><span class="lineNum">    7568 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 13, 11.7321 ), t9.inscribedCircle().center(), 0.0001 );</span></a>
<a name="7569"><span class="lineNum">    7569 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 1.7321, t9.inscribedCircle().radius(), 0.0001 );</span></a>
<a name="7570"><span class="lineNum">    7570 </span>                :            : </a>
<a name="7571"><span class="lineNum">    7571 </span>                :            :   // medians</a>
<a name="7572"><span class="lineNum">    7572 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsLineString&gt; med = QgsTriangle().medians();</span></a>
<a name="7573"><span class="lineNum">    7573 </span>                :<span class="lineCov">          1 :   QVERIFY( med.isEmpty() );</span></a>
<a name="7574"><span class="lineNum">    7574 </span>                :<span class="lineCov">          1 :   med = t7.medians();</span></a>
<a name="7575"><span class="lineNum">    7575 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 0 ).pointN( 0 ), t7.vertexAt( 0 ) );</span></a>
<a name="7576"><span class="lineNum">    7576 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 0 ).pointN( 1 ), QgsPoint( 2.5, 5 ), 0.0001 );</span></a>
<a name="7577"><span class="lineNum">    7577 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 1 ).pointN( 0 ), t7.vertexAt( 1 ) );</span></a>
<a name="7578"><span class="lineNum">    7578 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 1 ).pointN( 1 ), QgsPoint( 2.5, 2.5 ), 0.0001 );</span></a>
<a name="7579"><span class="lineNum">    7579 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 2 ).pointN( 0 ), t7.vertexAt( 2 ) );</span></a>
<a name="7580"><span class="lineNum">    7580 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 2 ).pointN( 1 ), QgsPoint( 0, 2.5 ), 0.0001 );</span></a>
<a name="7581"><span class="lineNum">    7581 </span>                :<span class="lineCov">          1 :   med.clear();</span></a>
<a name="7582"><span class="lineNum">    7582 </span>                :            : </a>
<a name="7583"><span class="lineNum">    7583 </span>                :<span class="lineCov">          1 :   med = t10.medians();</span></a>
<a name="7584"><span class="lineNum">    7584 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 0 ).pointN( 0 ), t10.vertexAt( 0 ) );</span></a>
<a name="7585"><span class="lineNum">    7585 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 0 ).pointN( 1 ), QgsPoint( 21, 4 ), 0.0001 );</span></a>
<a name="7586"><span class="lineNum">    7586 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 1 ).pointN( 0 ), t10.vertexAt( 1 ) );</span></a>
<a name="7587"><span class="lineNum">    7587 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 1 ).pointN( 1 ), QgsPoint( 23, 2 ), 0.0001 );</span></a>
<a name="7588"><span class="lineNum">    7588 </span>                :<span class="lineCov">          1 :   QCOMPARE( med.at( 2 ).pointN( 0 ), t10.vertexAt( 2 ) );</span></a>
<a name="7589"><span class="lineNum">    7589 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 2 ).pointN( 1 ), QgsPoint( 18, 4 ), 0.0001 );</span></a>
<a name="7590"><span class="lineNum">    7590 </span>                :<span class="lineCov">          1 :   med.clear();</span></a>
<a name="7591"><span class="lineNum">    7591 </span>                :<span class="lineCov">          1 :   alt.clear();</span></a>
<a name="7592"><span class="lineNum">    7592 </span>                :            : </a>
<a name="7593"><span class="lineNum">    7593 </span>                :<span class="lineCov">          1 :   med = t9.medians();</span></a>
<a name="7594"><span class="lineNum">    7594 </span>                :<span class="lineCov">          1 :   alt = t9.altitudes();</span></a>
<a name="7595"><span class="lineNum">    7595 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 0 ).pointN( 0 ), alt.at( 0 ).pointN( 0 ), 0.0001 );</span></a>
<a name="7596"><span class="lineNum">    7596 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 0 ).pointN( 1 ), alt.at( 0 ).pointN( 1 ), 0.0001 );</span></a>
<a name="7597"><span class="lineNum">    7597 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 1 ).pointN( 0 ), alt.at( 1 ).pointN( 0 ), 0.0001 );</span></a>
<a name="7598"><span class="lineNum">    7598 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 1 ).pointN( 1 ), alt.at( 1 ).pointN( 1 ), 0.0001 );</span></a>
<a name="7599"><span class="lineNum">    7599 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 2 ).pointN( 0 ), alt.at( 2 ).pointN( 0 ), 0.0001 );</span></a>
<a name="7600"><span class="lineNum">    7600 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( med.at( 2 ).pointN( 1 ), alt.at( 2 ).pointN( 1 ), 0.0001 );</span></a>
<a name="7601"><span class="lineNum">    7601 </span>                :            : </a>
<a name="7602"><span class="lineNum">    7602 </span>                :            :   // medial</a>
<a name="7603"><span class="lineNum">    7603 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsTriangle().medial(), QgsTriangle() );</span></a>
<a name="7604"><span class="lineNum">    7604 </span>                :<span class="lineCov">          1 :   QCOMPARE( t7.medial(), QgsTriangle( QgsPoint( 0, 2.5 ), QgsPoint( 2.5, 5 ), QgsPoint( 2.5, 2.5 ) ) );</span></a>
<a name="7605"><span class="lineNum">    7605 </span>                :<span class="lineCov">          1 :   QCOMPARE( t9.medial(), QgsTriangle( QgsGeometryUtils::midpoint( t9.vertexAt( 0 ), t9.vertexAt( 1 ) ),</span></a>
<a name="7606"><span class="lineNum">    7606 </span>                :            :                                       QgsGeometryUtils::midpoint( t9.vertexAt( 1 ), t9.vertexAt( 2 ) ),</a>
<a name="7607"><span class="lineNum">    7607 </span>                :            :                                       QgsGeometryUtils::midpoint( t9.vertexAt( 2 ), t9.vertexAt( 0 ) ) ) );</a>
<a name="7608"><span class="lineNum">    7608 </span>                :            : </a>
<a name="7609"><span class="lineNum">    7609 </span>                :            :   // bisectors</a>
<a name="7610"><span class="lineNum">    7610 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsLineString&gt; bis = QgsTriangle().bisectors();</span></a>
<a name="7611"><span class="lineNum">    7611 </span>                :<span class="lineCov">          1 :   QVERIFY( bis.isEmpty() );</span></a>
<a name="7612"><span class="lineNum">    7612 </span>                :<span class="lineCov">          1 :   bis = t7.bisectors();</span></a>
<a name="7613"><span class="lineNum">    7613 </span>                :<span class="lineCov">          1 :   QCOMPARE( bis.at( 0 ).pointN( 0 ), t7.vertexAt( 0 ) );</span></a>
<a name="7614"><span class="lineNum">    7614 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( bis.at( 0 ).pointN( 1 ), QgsPoint( 2.0711, 5 ), 0.0001 );</span></a>
<a name="7615"><span class="lineNum">    7615 </span>                :<span class="lineCov">          1 :   QCOMPARE( bis.at( 1 ).pointN( 0 ), t7.vertexAt( 1 ) );</span></a>
<a name="7616"><span class="lineNum">    7616 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( bis.at( 1 ).pointN( 1 ), QgsPoint( 2.5, 2.5 ), 0.0001 );</span></a>
<a name="7617"><span class="lineNum">    7617 </span>                :<span class="lineCov">          1 :   QCOMPARE( bis.at( 2 ).pointN( 0 ), t7.vertexAt( 2 ) );</span></a>
<a name="7618"><span class="lineNum">    7618 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( bis.at( 2 ).pointN( 1 ), QgsPoint( 0, 2.9289 ), 0.0001 );</span></a>
<a name="7619"><span class="lineNum">    7619 </span>                :            : </a>
<a name="7620"><span class="lineNum">    7620 </span>                :            :   // &quot;deleted&quot; method</a>
<a name="7621"><span class="lineNum">    7621 </span>                :<span class="lineCov">          1 :   ext.reset( new QgsLineString() );</span></a>
<a name="7622"><span class="lineNum">    7622 </span>                :<span class="lineCov">          1 :   QgsTriangle t11( QgsPoint( 0, 0 ), QgsPoint( 100, 100 ), QgsPoint( 0, 200 ) );</span></a>
<a name="7623"><span class="lineNum">    7623 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 5 )</span></a>
<a name="7624"><span class="lineNum">    7624 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 50, 50 ) &lt;&lt; QgsPoint( 0, 25 )</span></a>
<a name="7625"><span class="lineNum">    7625 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 5, 5 ) );</span></a>
<a name="7626"><span class="lineNum">    7626 </span>                :<span class="lineCov">          1 :   t11.addInteriorRing( ext.release() );</span></a>
<a name="7627"><span class="lineNum">    7627 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );</span></a>
<a name="7628"><span class="lineNum">    7628 </span>                :            : </a>
<a name="7629"><span class="lineNum">    7629 </span>                :            :   /* QList&lt;QgsCurve *&gt; lc;</a>
<a name="7630"><span class="lineNum">    7630 </span>                :            :    lc.append(ext);</a>
<a name="7631"><span class="lineNum">    7631 </span>                :            :    t11.setInteriorRings( lc );</a>
<a name="7632"><span class="lineNum">    7632 </span>                :            :    QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );*/</a>
<a name="7633"><span class="lineNum">    7633 </span>                :            : </a>
<a name="7634"><span class="lineNum">    7634 </span>                :<span class="lineCov">          1 :   QgsVertexId id( 0, 0, 1 );</span></a>
<a name="7635"><span class="lineNum">    7635 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.deleteVertex( id ) );</span></a>
<a name="7636"><span class="lineNum">    7636 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );</span></a>
<a name="7637"><span class="lineNum">    7637 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.insertVertex( id, QgsPoint( 5, 5 ) ) );</span></a>
<a name="7638"><span class="lineNum">    7638 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );</span></a>
<a name="7639"><span class="lineNum">    7639 </span>                :            : </a>
<a name="7640"><span class="lineNum">    7640 </span>                :            :   //move vertex</a>
<a name="7641"><span class="lineNum">    7641 </span>                :<span class="lineCov">          1 :   QgsPoint pt1( 5, 5 );</span></a>
<a name="7642"><span class="lineNum">    7642 </span>                :            :   // invalid part</a>
<a name="7643"><span class="lineNum">    7643 </span>                :<span class="lineCov">          1 :   id.part = -1;</span></a>
<a name="7644"><span class="lineNum">    7644 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7645"><span class="lineNum">    7645 </span>                :<span class="lineCov">          1 :   id.part = 1;</span></a>
<a name="7646"><span class="lineNum">    7646 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7647"><span class="lineNum">    7647 </span>                :            :   // invalid ring</a>
<a name="7648"><span class="lineNum">    7648 </span>                :<span class="lineCov">          1 :   id.part = 0;</span></a>
<a name="7649"><span class="lineNum">    7649 </span>                :<span class="lineCov">          1 :   id.ring = -1;</span></a>
<a name="7650"><span class="lineNum">    7650 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7651"><span class="lineNum">    7651 </span>                :<span class="lineCov">          1 :   id.ring = 1;</span></a>
<a name="7652"><span class="lineNum">    7652 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7653"><span class="lineNum">    7653 </span>                :<span class="lineCov">          1 :   id.ring = 0;</span></a>
<a name="7654"><span class="lineNum">    7654 </span>                :<span class="lineCov">          1 :   id.vertex = -1;</span></a>
<a name="7655"><span class="lineNum">    7655 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7656"><span class="lineNum">    7656 </span>                :<span class="lineCov">          1 :   id.vertex = 5;</span></a>
<a name="7657"><span class="lineNum">    7657 </span>                :<span class="lineCov">          1 :   QVERIFY( !t11.moveVertex( id, pt1 ) );</span></a>
<a name="7658"><span class="lineNum">    7658 </span>                :            : </a>
<a name="7659"><span class="lineNum">    7659 </span>                :            :   // valid vertex</a>
<a name="7660"><span class="lineNum">    7660 </span>                :<span class="lineCov">          1 :   id.vertex = 0;</span></a>
<a name="7661"><span class="lineNum">    7661 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7662"><span class="lineNum">    7662 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((5 5, 100 100, 0 200, 5 5))&quot; ) );</span></a>
<a name="7663"><span class="lineNum">    7663 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 0, 0 );</span></a>
<a name="7664"><span class="lineNum">    7664 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7665"><span class="lineNum">    7665 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );</span></a>
<a name="7666"><span class="lineNum">    7666 </span>                :<span class="lineCov">          1 :   id.vertex = 4;</span></a>
<a name="7667"><span class="lineNum">    7667 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 5, 5 );</span></a>
<a name="7668"><span class="lineNum">    7668 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7669"><span class="lineNum">    7669 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((5 5, 100 100, 0 200, 5 5))&quot; ) );</span></a>
<a name="7670"><span class="lineNum">    7670 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 0, 0 );</span></a>
<a name="7671"><span class="lineNum">    7671 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7672"><span class="lineNum">    7672 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 100 100, 0 200, 0 0))&quot; ) );</span></a>
<a name="7673"><span class="lineNum">    7673 </span>                :<span class="lineCov">          1 :   id.vertex = 1;</span></a>
<a name="7674"><span class="lineNum">    7674 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 5, 5 );</span></a>
<a name="7675"><span class="lineNum">    7675 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7676"><span class="lineNum">    7676 </span>                :<span class="lineCov">          1 :   QCOMPARE( t11.asWkt(), QString( &quot;Triangle ((0 0, 5 5, 0 200, 0 0))&quot; ) );</span></a>
<a name="7677"><span class="lineNum">    7677 </span>                :            :   // colinear</a>
<a name="7678"><span class="lineNum">    7678 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 0, 100 );</span></a>
<a name="7679"><span class="lineNum">    7679 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7680"><span class="lineNum">    7680 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 5, 5 );</span></a>
<a name="7681"><span class="lineNum">    7681 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7682"><span class="lineNum">    7682 </span>                :            :   // duplicate point</a>
<a name="7683"><span class="lineNum">    7683 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 0, 0 );</span></a>
<a name="7684"><span class="lineNum">    7684 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7685"><span class="lineNum">    7685 </span>                :<span class="lineCov">          1 :   pt1 = QgsPoint( 5, 5 );</span></a>
<a name="7686"><span class="lineNum">    7686 </span>                :<span class="lineCov">          1 :   QVERIFY( t11.moveVertex( id, pt1 ) );</span></a>
<a name="7687"><span class="lineNum">    7687 </span>                :            : </a>
<a name="7688"><span class="lineNum">    7688 </span>                :            :   //toCurveType</a>
<a name="7689"><span class="lineNum">    7689 </span>                :<span class="lineCov">          1 :   QgsTriangle t12( QgsPoint( 7, 4 ), QgsPoint( 13, 3 ), QgsPoint( 9, 6 ) );</span></a>
<a name="7690"><span class="lineNum">    7690 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt; curveType( t12.toCurveType() );</span></a>
<a name="7691"><span class="lineNum">    7691 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="7692"><span class="lineNum">    7692 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;numPoints(), 4 );</span></a>
<a name="7693"><span class="lineNum">    7693 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 7, 4 ) );</span></a>
<a name="7694"><span class="lineNum">    7694 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 13, 3 ) );</span></a>
<a name="7695"><span class="lineNum">    7695 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 9, 6 ) );</span></a>
<a name="7696"><span class="lineNum">    7696 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( 7, 4 ) );</span></a>
<a name="7697"><span class="lineNum">    7697 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numInteriorRings(), 0 );</span></a>
<a name="7698"><span class="lineNum">    7698 </span>                :            : </a>
<a name="7699"><span class="lineNum">    7699 </span>                :            :   // boundary</a>
<a name="7700"><span class="lineNum">    7700 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsTriangle().boundary() );</span></a>
<a name="7701"><span class="lineNum">    7701 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurve &gt; boundary( QgsTriangle( QgsPoint( 7, 4 ), QgsPoint( 13, 3 ), QgsPoint( 9, 6 ) ).boundary() );</span></a>
<a name="7702"><span class="lineNum">    7702 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="7703"><span class="lineNum">    7703 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;numPoints(), 4 );</span></a>
<a name="7704"><span class="lineNum">    7704 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 7, 4 ) );</span></a>
<a name="7705"><span class="lineNum">    7705 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 13, 3 ) );</span></a>
<a name="7706"><span class="lineNum">    7706 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 9, 6 ) );</span></a>
<a name="7707"><span class="lineNum">    7707 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundary-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( 7, 4 ) );</span></a>
<a name="7708"><span class="lineNum">    7708 </span>                :            : </a>
<a name="7709"><span class="lineNum">    7709 </span>                :            :   // cast</a>
<a name="7710"><span class="lineNum">    7710 </span>                :<span class="lineCov">          1 :   QgsTriangle pCast;</span></a>
<a name="7711"><span class="lineNum">    7711 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast ) );</span></a>
<a name="7712"><span class="lineNum">    7712 </span>                :<span class="lineCov">          1 :   QgsTriangle pCast2( QgsPoint( 7, 4 ), QgsPoint( 13, 3 ), QgsPoint( 9, 6 ) );</span></a>
<a name="7713"><span class="lineNum">    7713 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="7714"><span class="lineNum">    7714 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="7715"><span class="lineNum">    7715 </span>                :            : </a>
<a name="7716"><span class="lineNum">    7716 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::ellipse()</span></a>
<a name="7717"><span class="lineNum">    7717 </span>                :            : {</a>
<a name="7718"><span class="lineNum">    7718 </span>                :            :   //test constructors</a>
<a name="7719"><span class="lineNum">    7719 </span>                :<span class="lineCov">          1 :   QgsEllipse elp1;</span></a>
<a name="7720"><span class="lineNum">    7720 </span>                :<span class="lineCov">          1 :   QVERIFY( elp1.center().isEmpty() );</span></a>
<a name="7721"><span class="lineNum">    7721 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMajorAxis(), 0.0 );</span></a>
<a name="7722"><span class="lineNum">    7722 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMinorAxis(), 0.0 );</span></a>
<a name="7723"><span class="lineNum">    7723 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.azimuth(), 90.0 );</span></a>
<a name="7724"><span class="lineNum">    7724 </span>                :<span class="lineCov">          1 :   QVERIFY( elp1.isEmpty() );</span></a>
<a name="7725"><span class="lineNum">    7725 </span>                :            : </a>
<a name="7726"><span class="lineNum">    7726 </span>                :<span class="lineCov">          1 :   QgsEllipse elp2( QgsPoint( 5, 10 ), 3, 2 );</span></a>
<a name="7727"><span class="lineNum">    7727 </span>                :<span class="lineCov">          1 :   QVERIFY( elp2.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="7728"><span class="lineNum">    7728 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp2.semiMajorAxis(), 3.0 );</span></a>
<a name="7729"><span class="lineNum">    7729 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp2.semiMinorAxis(), 2.0 );</span></a>
<a name="7730"><span class="lineNum">    7730 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp2.azimuth(), 90.0 );</span></a>
<a name="7731"><span class="lineNum">    7731 </span>                :<span class="lineCov">          1 :   QVERIFY( !elp2.isEmpty() );</span></a>
<a name="7732"><span class="lineNum">    7732 </span>                :            : </a>
<a name="7733"><span class="lineNum">    7733 </span>                :<span class="lineCov">          1 :   QgsEllipse elp3( QgsPoint( 5, 10 ), 3, 2, 45 );</span></a>
<a name="7734"><span class="lineNum">    7734 </span>                :<span class="lineCov">          1 :   QVERIFY( elp3.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="7735"><span class="lineNum">    7735 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp3.semiMajorAxis(), 3.0 );</span></a>
<a name="7736"><span class="lineNum">    7736 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp3.semiMinorAxis(), 2.0 );</span></a>
<a name="7737"><span class="lineNum">    7737 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp3.azimuth(), 45.0 );</span></a>
<a name="7738"><span class="lineNum">    7738 </span>                :<span class="lineCov">          1 :   QVERIFY( !elp3.isEmpty() );</span></a>
<a name="7739"><span class="lineNum">    7739 </span>                :            : </a>
<a name="7740"><span class="lineNum">    7740 </span>                :<span class="lineCov">          1 :   QgsEllipse elp4( QgsPoint( 5, 10 ), 2, 3, 45 );</span></a>
<a name="7741"><span class="lineNum">    7741 </span>                :<span class="lineCov">          1 :   QVERIFY( elp4.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="7742"><span class="lineNum">    7742 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp4.semiMajorAxis(), 3.0 );</span></a>
<a name="7743"><span class="lineNum">    7743 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp4.semiMinorAxis(), 2.0 );</span></a>
<a name="7744"><span class="lineNum">    7744 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp4.azimuth(), 135.0 );</span></a>
<a name="7745"><span class="lineNum">    7745 </span>                :<span class="lineCov">          1 :   QVERIFY( !elp4.isEmpty() );</span></a>
<a name="7746"><span class="lineNum">    7746 </span>                :            : </a>
<a name="7747"><span class="lineNum">    7747 </span>                :            :   //test toString</a>
<a name="7748"><span class="lineNum">    7748 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.toString(), QString( &quot;Empty&quot; ) );</span></a>
<a name="7749"><span class="lineNum">    7749 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp2.toString(), QString( &quot;Ellipse (Center: Point (5 10), Semi-Major Axis: 3, Semi-Minor Axis: 2, Azimuth: 90)&quot; ) );</span></a>
<a name="7750"><span class="lineNum">    7750 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp3.toString(), QString( &quot;Ellipse (Center: Point (5 10), Semi-Major Axis: 3, Semi-Minor Axis: 2, Azimuth: 45)&quot; ) );</span></a>
<a name="7751"><span class="lineNum">    7751 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp4.toString(), QString( &quot;Ellipse (Center: Point (5 10), Semi-Major Axis: 3, Semi-Minor Axis: 2, Azimuth: 135)&quot; ) );</span></a>
<a name="7752"><span class="lineNum">    7752 </span>                :            : </a>
<a name="7753"><span class="lineNum">    7753 </span>                :            :   //test equality operator</a>
<a name="7754"><span class="lineNum">    7754 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse().isEmpty(), QgsEllipse( QgsPoint(), 0, 0, 90 ).isEmpty() );</span></a>
<a name="7755"><span class="lineNum">    7755 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsEllipse() == QgsEllipse( QgsPoint( 0, 0 ), 0, 0, 0.0005 ) ) );</span></a>
<a name="7756"><span class="lineNum">    7756 </span>                :<span class="lineCov">          1 :   QVERIFY( elp2 == QgsEllipse( QgsPoint( 5, 10 ), 2, 3, 0 ) );</span></a>
<a name="7757"><span class="lineNum">    7757 </span>                :<span class="lineCov">          1 :   QVERIFY( elp2 != elp3 );</span></a>
<a name="7758"><span class="lineNum">    7758 </span>                :<span class="lineCov">          1 :   QVERIFY( elp3 != elp4 );</span></a>
<a name="7759"><span class="lineNum">    7759 </span>                :<span class="lineCov">          1 :   QVERIFY( elp4 == QgsEllipse( QgsPoint( 5, 10 ), 3, 2, 90 + 45 ) );</span></a>
<a name="7760"><span class="lineNum">    7760 </span>                :            : </a>
<a name="7761"><span class="lineNum">    7761 </span>                :            :   //test setter and getter</a>
<a name="7762"><span class="lineNum">    7762 </span>                :<span class="lineCov">          1 :   elp1.setAzimuth( 45 );</span></a>
<a name="7763"><span class="lineNum">    7763 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.azimuth(), 45.0 );</span></a>
<a name="7764"><span class="lineNum">    7764 </span>                :            : </a>
<a name="7765"><span class="lineNum">    7765 </span>                :<span class="lineCov">          1 :   elp1.setSemiMajorAxis( 50 );</span></a>
<a name="7766"><span class="lineNum">    7766 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMajorAxis(), 50.0 );</span></a>
<a name="7767"><span class="lineNum">    7767 </span>                :            : </a>
<a name="7768"><span class="lineNum">    7768 </span>                :            :   // axis_b &gt; axis_a</a>
<a name="7769"><span class="lineNum">    7769 </span>                :<span class="lineCov">          1 :   elp1.setSemiMinorAxis( 70 );</span></a>
<a name="7770"><span class="lineNum">    7770 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMajorAxis(), 70.0 );</span></a>
<a name="7771"><span class="lineNum">    7771 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMinorAxis(), 50.0 );</span></a>
<a name="7772"><span class="lineNum">    7772 </span>                :            :   // axis_b &lt; axis_a</a>
<a name="7773"><span class="lineNum">    7773 </span>                :<span class="lineCov">          1 :   elp1.setSemiMinorAxis( 3 );</span></a>
<a name="7774"><span class="lineNum">    7774 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMinorAxis(), 3.0 );</span></a>
<a name="7775"><span class="lineNum">    7775 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMajorAxis(), 70.0 );</span></a>
<a name="7776"><span class="lineNum">    7776 </span>                :            : </a>
<a name="7777"><span class="lineNum">    7777 </span>                :<span class="lineCov">          1 :   elp1.setSemiMajorAxis( 2 );</span></a>
<a name="7778"><span class="lineNum">    7778 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMinorAxis(), 2.0 );</span></a>
<a name="7779"><span class="lineNum">    7779 </span>                :<span class="lineCov">          1 :   QCOMPARE( elp1.semiMajorAxis(), 3.0 );</span></a>
<a name="7780"><span class="lineNum">    7780 </span>                :            : </a>
<a name="7781"><span class="lineNum">    7781 </span>                :<span class="lineCov">          1 :   elp1.setCenter( QgsPoint( 5, 10 ) );</span></a>
<a name="7782"><span class="lineNum">    7782 </span>                :<span class="lineCov">          1 :   QVERIFY( elp1.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="7783"><span class="lineNum">    7783 </span>                :<span class="lineCov">          1 :   QVERIFY( elp1.rcenter() == QgsPoint( 5, 10 ) );</span></a>
<a name="7784"><span class="lineNum">    7784 </span>                :<span class="lineCov">          1 :   elp1.rcenter() = QgsPoint( 25, 310 );</span></a>
<a name="7785"><span class="lineNum">    7785 </span>                :<span class="lineCov">          1 :   QVERIFY( elp1.center() == QgsPoint( 25, 310 ) );</span></a>
<a name="7786"><span class="lineNum">    7786 </span>                :            : </a>
<a name="7787"><span class="lineNum">    7787 </span>                :            :   //test &quot;alt&quot; constructors</a>
<a name="7788"><span class="lineNum">    7788 </span>                :            :   // fromExtent</a>
<a name="7789"><span class="lineNum">    7789 </span>                :<span class="lineCov">          1 :   QgsEllipse elp_alt = QgsEllipse( QgsPoint( 2.5, 5 ), 2.5, 5 );</span></a>
<a name="7790"><span class="lineNum">    7790 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromExtent( QgsPoint( 0, 0 ), QgsPoint( 5, 10 ) ) == elp_alt );</span></a>
<a name="7791"><span class="lineNum">    7791 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromExtent( QgsPoint( 5, 10 ), QgsPoint( 0, 0 ) ) == elp_alt );</span></a>
<a name="7792"><span class="lineNum">    7792 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromExtent( QgsPoint( 5, 0 ), QgsPoint( 0, 10 ) ) == elp_alt );</span></a>
<a name="7793"><span class="lineNum">    7793 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromExtent( QgsPoint( -5, 0 ), QgsPoint( 0, 10 ) ) != elp_alt );</span></a>
<a name="7794"><span class="lineNum">    7794 </span>                :            :   // fromCenterPoint</a>
<a name="7795"><span class="lineNum">    7795 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenterPoint( QgsPoint( 2.5, 5 ), QgsPoint( 5, 10 ) ) == elp_alt );</span></a>
<a name="7796"><span class="lineNum">    7796 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenterPoint( QgsPoint( 2.5, 5 ), QgsPoint( -0, 0 ) ) == elp_alt );</span></a>
<a name="7797"><span class="lineNum">    7797 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenterPoint( QgsPoint( 2.5, 5 ), QgsPoint( 0, -10 ) ) != elp_alt );</span></a>
<a name="7798"><span class="lineNum">    7798 </span>                :            :   // fromCenter2Points</a>
<a name="7799"><span class="lineNum">    7799 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenter2Points( QgsPoint( 2.5, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ) ) ==</span></a>
<a name="7800"><span class="lineNum">    7800 </span>                :            :            QgsEllipse( QgsPoint( 2.5, 5 ), 5, 5, 180 ) );</a>
<a name="7801"><span class="lineNum">    7801 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenter2Points( QgsPoint( 2.5, 5 ), QgsPoint( 2.5, 7.5 ), QgsPoint( 7.5, 5 ) ) != elp_alt ); //same ellipse with different azimuth</span></a>
<a name="7802"><span class="lineNum">    7802 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenter2Points( QgsPoint( 2.5, 5 ), QgsPoint( 2.5, 2.5 ), QgsPoint( 7.5, 5 ) ) != elp_alt ); //same ellipse with different azimuth</span></a>
<a name="7803"><span class="lineNum">    7803 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenter2Points( QgsPoint( 2.5, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 5, 5 ) ) == elp_alt );</span></a>
<a name="7804"><span class="lineNum">    7804 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse().fromCenter2Points( QgsPoint( 5, 10 ), QgsPoint( 5, 10 ).project( 3, 45 ), QgsPoint( 5, 10 ).project( 2, 90 + 45 ) ) ==</span></a>
<a name="7805"><span class="lineNum">    7805 </span>                :            :            QgsEllipse( QgsPoint( 5, 10 ), 3, 2, 45 ) );</a>
<a name="7806"><span class="lineNum">    7806 </span>                :            : </a>
<a name="7807"><span class="lineNum">    7807 </span>                :            :   // fromFoci</a>
<a name="7808"><span class="lineNum">    7808 </span>                :            :   // horizontal</a>
<a name="7809"><span class="lineNum">    7809 </span>                :<span class="lineCov">          1 :   QgsEllipse elp_hor = QgsEllipse().fromFoci( QgsPoint( -4, 0 ), QgsPoint( 4, 0 ), QgsPoint( 0, 4 ) );</span></a>
<a name="7810"><span class="lineNum">    7810 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 0, 0 ), std::sqrt( 32.0 ), std::sqrt( 16.0 ), 90.0 ) == elp_hor );</span></a>
<a name="7811"><span class="lineNum">    7811 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 4, 0 ), elp_hor.foci().at( 0 ), 1e-8 );</span></a>
<a name="7812"><span class="lineNum">    7812 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( -4, 0 ), elp_hor.foci().at( 1 ), 1e-8 );</span></a>
<a name="7813"><span class="lineNum">    7813 </span>                :<span class="lineCov">          1 :   elp_hor = QgsEllipse().fromFoci( QgsPoint( 4, 0 ), QgsPoint( -4, 0 ), QgsPoint( 0, 4 ) );</span></a>
<a name="7814"><span class="lineNum">    7814 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 0, 0 ), std::sqrt( 32.0 ), std::sqrt( 16.0 ), 270.0 ) == elp_hor );</span></a>
<a name="7815"><span class="lineNum">    7815 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( -4, 0 ), elp_hor.foci().at( 0 ), 1e-8 );</span></a>
<a name="7816"><span class="lineNum">    7816 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 4, 0 ), elp_hor.foci().at( 1 ), 1e-8 );</span></a>
<a name="7817"><span class="lineNum">    7817 </span>                :            : </a>
<a name="7818"><span class="lineNum">    7818 </span>                :            :   // vertical</a>
<a name="7819"><span class="lineNum">    7819 </span>                :<span class="lineCov">          1 :   QgsEllipse elp_ver = QgsEllipse().fromFoci( QgsPoint( 45, -15 ), QgsPoint( 45, 10 ), QgsPoint( 55, 0 ) );</span></a>
<a name="7820"><span class="lineNum">    7820 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 45, -2.5 ), 16.084946, 10.123017725, 0.0 ) == elp_ver );</span></a>
<a name="7821"><span class="lineNum">    7821 </span>                :<span class="lineCov">          1 :   elp_ver = QgsEllipse().fromFoci( QgsPoint( 45, 10 ), QgsPoint( 45, -15 ), QgsPoint( 55, 0 ) );</span></a>
<a name="7822"><span class="lineNum">    7822 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 45, -2.5 ), 16.084946, 10.123017725, 180.0 ) == elp_ver );</span></a>
<a name="7823"><span class="lineNum">    7823 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 45, -15 ), elp_ver.foci().at( 0 ), 1e-8 );</span></a>
<a name="7824"><span class="lineNum">    7824 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 45, 10 ), elp_ver.foci().at( 1 ), 1e-8 );</span></a>
<a name="7825"><span class="lineNum">    7825 </span>                :            :   // oriented</a>
<a name="7826"><span class="lineNum">    7826 </span>                :            :   // first quadrant</a>
<a name="7827"><span class="lineNum">    7827 </span>                :<span class="lineCov">          1 :   QgsEllipse elp_ori = QgsEllipse().fromFoci( QgsPoint( 10, 10 ), QgsPoint( 25, 20 ), QgsPoint( 15, 20 ) );</span></a>
<a name="7828"><span class="lineNum">    7828 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 17.5, 15.0 ), 10.5901699437, 5.55892970251, 90.0 - 33.690067526 ) == elp_ori );</span></a>
<a name="7829"><span class="lineNum">    7829 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 25, 20 ), elp_ori.foci().at( 0 ), 1e-8 );</span></a>
<a name="7830"><span class="lineNum">    7830 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 10, 10 ), elp_ori.foci().at( 1 ), 1e-8 );</span></a>
<a name="7831"><span class="lineNum">    7831 </span>                :            :   // second quadrant</a>
<a name="7832"><span class="lineNum">    7832 </span>                :<span class="lineCov">          1 :   elp_ori = QgsEllipse().fromFoci( QgsPoint( 10, 10 ), QgsPoint( 5, 20 ), QgsPoint( 15, 20 ) );</span></a>
<a name="7833"><span class="lineNum">    7833 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 7.5, 15.0 ), 10.5901699437, 8.99453719974, 360 - 26.56505117 ) == elp_ori );</span></a>
<a name="7834"><span class="lineNum">    7834 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 5, 20 ), elp_ori.foci().at( 0 ), 1e-8 );</span></a>
<a name="7835"><span class="lineNum">    7835 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 10, 10 ), elp_ori.foci().at( 1 ), 1e-8 );</span></a>
<a name="7836"><span class="lineNum">    7836 </span>                :            :   // third quadrant</a>
<a name="7837"><span class="lineNum">    7837 </span>                :<span class="lineCov">          1 :   elp_ori = QgsEllipse().fromFoci( QgsPoint( 10, 10 ), QgsPoint( 5, -5 ), QgsPoint( 15, 20 ) );</span></a>
<a name="7838"><span class="lineNum">    7838 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 7.5, 2.5 ), 19.0530819616, 17.3355107289893, 198.434948822922 ) == elp_ori );</span></a>
<a name="7839"><span class="lineNum">    7839 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 10, 10 ), elp_ori.foci().at( 1 ), 1e-8 );</span></a>
<a name="7840"><span class="lineNum">    7840 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 5, -5 ), elp_ori.foci().at( 0 ), 1e-8 );</span></a>
<a name="7841"><span class="lineNum">    7841 </span>                :            :   // fourth quadrant</a>
<a name="7842"><span class="lineNum">    7842 </span>                :<span class="lineCov">          1 :   elp_ori = QgsEllipse().fromFoci( QgsPoint( 10, 10 ), QgsPoint( 25, -5 ), QgsPoint( 15, 20 ) );</span></a>
<a name="7843"><span class="lineNum">    7843 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 17.5, 2.5 ), 19.0530819616, 15.82782146, 135 ) == elp_ori );</span></a>
<a name="7844"><span class="lineNum">    7844 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 25, -5 ), elp_ori.foci().at( 0 ), 1e-8 );</span></a>
<a name="7845"><span class="lineNum">    7845 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( QgsPoint( 10, 10 ), elp_ori.foci().at( 1 ), 1e-8 );</span></a>
<a name="7846"><span class="lineNum">    7846 </span>                :            : </a>
<a name="7847"><span class="lineNum">    7847 </span>                :            :   // test quadrant</a>
<a name="7848"><span class="lineNum">    7848 </span>                :<span class="lineCov">          1 :   QgsEllipse elpq( QgsPoint( 5, 10 ), 3, 2, 45 );</span></a>
<a name="7849"><span class="lineNum">    7849 </span>                :<span class="lineCov">          1 :   QgsPointSequence q = elpq.quadrant();</span></a>
<a name="7850"><span class="lineNum">    7850 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 0 ), QgsPoint( 7.1213, 12.1213 ), 0.001 );</span></a>
<a name="7851"><span class="lineNum">    7851 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 3 ), QgsPoint( 3.5858, 11.4142 ), 0.001 );</span></a>
<a name="7852"><span class="lineNum">    7852 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 2 ), QgsPoint( 2.8787, 7.8787 ), 0.001 );</span></a>
<a name="7853"><span class="lineNum">    7853 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 1 ), QgsPoint( 6.4142, 8.5858 ), 0.001 );</span></a>
<a name="7854"><span class="lineNum">    7854 </span>                :            : </a>
<a name="7855"><span class="lineNum">    7855 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 90 );</span></a>
<a name="7856"><span class="lineNum">    7856 </span>                :<span class="lineCov">          1 :   q.clear();</span></a>
<a name="7857"><span class="lineNum">    7857 </span>                :<span class="lineCov">          1 :   q = elpq.quadrant();</span></a>
<a name="7858"><span class="lineNum">    7858 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 3 ), QgsPoint( 0, 2 ) );</span></a>
<a name="7859"><span class="lineNum">    7859 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 0 ), QgsPoint( 5, 0 ) );</span></a>
<a name="7860"><span class="lineNum">    7860 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 1 ), QgsPoint( 0, -2 ) );</span></a>
<a name="7861"><span class="lineNum">    7861 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 2 ), QgsPoint( -5, 0 ) );</span></a>
<a name="7862"><span class="lineNum">    7862 </span>                :            : </a>
<a name="7863"><span class="lineNum">    7863 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( QgsWkbTypes::PointZM, 0, 0, 123, 321 ), 5, 2, 0 );</span></a>
<a name="7864"><span class="lineNum">    7864 </span>                :<span class="lineCov">          1 :   q.clear();</span></a>
<a name="7865"><span class="lineNum">    7865 </span>                :<span class="lineCov">          1 :   q = elpq.quadrant();</span></a>
<a name="7866"><span class="lineNum">    7866 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 0, 5, 123, 321 ) );</span></a>
<a name="7867"><span class="lineNum">    7867 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 3 ), QgsPoint( QgsWkbTypes::PointZM, -2, 0, 123, 321 ) );</span></a>
<a name="7868"><span class="lineNum">    7868 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 0, -5, 123, 321 ) );</span></a>
<a name="7869"><span class="lineNum">    7869 </span>                :<span class="lineCov">          1 :   QCOMPARE( q.at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 2, 0, 123, 321 ) );</span></a>
<a name="7870"><span class="lineNum">    7870 </span>                :            : </a>
<a name="7871"><span class="lineNum">    7871 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 2.5, 2, 315 );</span></a>
<a name="7872"><span class="lineNum">    7872 </span>                :<span class="lineCov">          1 :   q.clear();</span></a>
<a name="7873"><span class="lineNum">    7873 </span>                :<span class="lineCov">          1 :   q = elpq.quadrant();</span></a>
<a name="7874"><span class="lineNum">    7874 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 1 ), QgsPoint( 1.4142, 1.4142 ), 0.001 );</span></a>
<a name="7875"><span class="lineNum">    7875 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 2 ), QgsPoint( 1.7678, -1.7678 ), 0.001 );</span></a>
<a name="7876"><span class="lineNum">    7876 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 3 ), QgsPoint( -1.4142, -1.4142 ), 0.001 );</span></a>
<a name="7877"><span class="lineNum">    7877 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 0 ), QgsPoint( -1.7678, 1.7678 ), 0.001 );</span></a>
<a name="7878"><span class="lineNum">    7878 </span>                :            : </a>
<a name="7879"><span class="lineNum">    7879 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 5, 2.5, 45 );</span></a>
<a name="7880"><span class="lineNum">    7880 </span>                :<span class="lineCov">          1 :   q.clear();</span></a>
<a name="7881"><span class="lineNum">    7881 </span>                :<span class="lineCov">          1 :   q = elpq.quadrant();</span></a>
<a name="7882"><span class="lineNum">    7882 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 3 ), QgsPoint( -1.7678, 1.7678 ), 0.001 );</span></a>
<a name="7883"><span class="lineNum">    7883 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 0 ), QgsPoint( 3.5355, 3.5355 ), 0.001 );</span></a>
<a name="7884"><span class="lineNum">    7884 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 1 ), QgsPoint( 1.7678, -1.7678 ), 0.001 );</span></a>
<a name="7885"><span class="lineNum">    7885 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 2 ), QgsPoint( -3.5355, -3.5355 ), 0.001 );</span></a>
<a name="7886"><span class="lineNum">    7886 </span>                :            : </a>
<a name="7887"><span class="lineNum">    7887 </span>                :            :   //test conversion</a>
<a name="7888"><span class="lineNum">    7888 </span>                :            :   // points</a>
<a name="7889"><span class="lineNum">    7889 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts;</span></a>
<a name="7890"><span class="lineNum">    7890 </span>                :<span class="lineCov">          1 :   pts = QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).points( 4 );</span></a>
<a name="7891"><span class="lineNum">    7891 </span>                :<span class="lineCov">          1 :   q = QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).quadrant();</span></a>
<a name="7892"><span class="lineNum">    7892 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.length(), 4 );</span></a>
<a name="7893"><span class="lineNum">    7893 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 0 ), pts.at( 0 ), 2 );</span></a>
<a name="7894"><span class="lineNum">    7894 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 1 ), pts.at( 1 ), 2 );</span></a>
<a name="7895"><span class="lineNum">    7895 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 2 ), pts.at( 2 ), 2 );</span></a>
<a name="7896"><span class="lineNum">    7896 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( q.at( 3 ), pts.at( 3 ), 2 );</span></a>
<a name="7897"><span class="lineNum">    7897 </span>                :            : </a>
<a name="7898"><span class="lineNum">    7898 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).points( 2 ).isEmpty() ); // segments too low</span></a>
<a name="7899"><span class="lineNum">    7899 </span>                :            : </a>
<a name="7900"><span class="lineNum">    7900 </span>                :            :   // linestring</a>
<a name="7901"><span class="lineNum">    7901 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; l( new QgsLineString() );</span></a>
<a name="7902"><span class="lineNum">    7902 </span>                :            : </a>
<a name="7903"><span class="lineNum">    7903 </span>                :<span class="lineCov">          1 :   l.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).toLineString( 2 ) );</span></a>
<a name="7904"><span class="lineNum">    7904 </span>                :<span class="lineCov">          1 :   QVERIFY( l-&gt;isEmpty() ); // segments too low</span></a>
<a name="7905"><span class="lineNum">    7905 </span>                :            : </a>
<a name="7906"><span class="lineNum">    7906 </span>                :<span class="lineCov">          1 :   l.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).toLineString( 4 ) );</span></a>
<a name="7907"><span class="lineNum">    7907 </span>                :<span class="lineCov">          1 :   QCOMPARE( l-&gt;numPoints(), 5 ); // closed linestring</span></a>
<a name="7908"><span class="lineNum">    7908 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts_l;</span></a>
<a name="7909"><span class="lineNum">    7909 </span>                :<span class="lineCov">          1 :   l-&gt;points( pts_l );</span></a>
<a name="7910"><span class="lineNum">    7910 </span>                :<span class="lineCov">          1 :   pts_l.pop_back();</span></a>
<a name="7911"><span class="lineNum">    7911 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, pts_l );</span></a>
<a name="7912"><span class="lineNum">    7912 </span>                :            : </a>
<a name="7913"><span class="lineNum">    7913 </span>                :            :   // polygon</a>
<a name="7914"><span class="lineNum">    7914 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; p1( new QgsPolygon() );</span></a>
<a name="7915"><span class="lineNum">    7915 </span>                :            : </a>
<a name="7916"><span class="lineNum">    7916 </span>                :<span class="lineCov">          1 :   p1.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).toPolygon( 2 ) );</span></a>
<a name="7917"><span class="lineNum">    7917 </span>                :<span class="lineCov">          1 :   QVERIFY( p1-&gt;isEmpty() ); // segments too low</span></a>
<a name="7918"><span class="lineNum">    7918 </span>                :            : </a>
<a name="7919"><span class="lineNum">    7919 </span>                :<span class="lineCov">          1 :   p1.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).toPolygon( 4 ) );</span></a>
<a name="7920"><span class="lineNum">    7920 </span>                :<span class="lineCov">          1 :   q = QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).quadrant();</span></a>
<a name="7921"><span class="lineNum">    7921 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), q.at( 0 ) );</span></a>
<a name="7922"><span class="lineNum">    7922 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), q.at( 1 ) );</span></a>
<a name="7923"><span class="lineNum">    7923 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), q.at( 2 ) );</span></a>
<a name="7924"><span class="lineNum">    7924 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), q.at( 3 ) );</span></a>
<a name="7925"><span class="lineNum">    7925 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), q.at( 0 ) );</span></a>
<a name="7926"><span class="lineNum">    7926 </span>                :<span class="lineCov">          1 :   QCOMPARE( 0, p1-&gt;numInteriorRings() );</span></a>
<a name="7927"><span class="lineNum">    7927 </span>                :<span class="lineCov">          1 :   QCOMPARE( 5, p1-&gt;exteriorRing()-&gt;numPoints() );</span></a>
<a name="7928"><span class="lineNum">    7928 </span>                :            : </a>
<a name="7929"><span class="lineNum">    7929 </span>                :<span class="lineCov">          1 :   p1.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 90 ).toPolygon( 4 ) );</span></a>
<a name="7930"><span class="lineNum">    7930 </span>                :<span class="lineCov">          1 :   q = QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 90 ).quadrant();</span></a>
<a name="7931"><span class="lineNum">    7931 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), q.at( 0 ) );</span></a>
<a name="7932"><span class="lineNum">    7932 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), q.at( 1 ) );</span></a>
<a name="7933"><span class="lineNum">    7933 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), q.at( 2 ) );</span></a>
<a name="7934"><span class="lineNum">    7934 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), q.at( 3 ) );</span></a>
<a name="7935"><span class="lineNum">    7935 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), q.at( 0 ) );</span></a>
<a name="7936"><span class="lineNum">    7936 </span>                :<span class="lineCov">          1 :   QCOMPARE( 0, p1-&gt;numInteriorRings() );</span></a>
<a name="7937"><span class="lineNum">    7937 </span>                :<span class="lineCov">          1 :   QCOMPARE( 5, p1-&gt;exteriorRing()-&gt;numPoints() );</span></a>
<a name="7938"><span class="lineNum">    7938 </span>                :            : </a>
<a name="7939"><span class="lineNum">    7939 </span>                :<span class="lineCov">          1 :   p1.reset( elpq.toPolygon( 4 ) );</span></a>
<a name="7940"><span class="lineNum">    7940 </span>                :<span class="lineCov">          1 :   q = elpq.quadrant();</span></a>
<a name="7941"><span class="lineNum">    7941 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), q.at( 0 ) );</span></a>
<a name="7942"><span class="lineNum">    7942 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), q.at( 1 ) );</span></a>
<a name="7943"><span class="lineNum">    7943 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), q.at( 2 ) );</span></a>
<a name="7944"><span class="lineNum">    7944 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), q.at( 3 ) );</span></a>
<a name="7945"><span class="lineNum">    7945 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), q.at( 0 ) );</span></a>
<a name="7946"><span class="lineNum">    7946 </span>                :<span class="lineCov">          1 :   QCOMPARE( 0, p1-&gt;numInteriorRings() );</span></a>
<a name="7947"><span class="lineNum">    7947 </span>                :<span class="lineCov">          1 :   QCOMPARE( 5, p1-&gt;exteriorRing()-&gt;numPoints() );</span></a>
<a name="7948"><span class="lineNum">    7948 </span>                :            : </a>
<a name="7949"><span class="lineNum">    7949 </span>                :            :   // oriented bounding box</a>
<a name="7950"><span class="lineNum">    7950 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; ombb( QgsEllipse().orientedBoundingBox() );</span></a>
<a name="7951"><span class="lineNum">    7951 </span>                :<span class="lineCov">          1 :   QVERIFY( ombb-&gt;isEmpty() );</span></a>
<a name="7952"><span class="lineNum">    7952 </span>                :            : </a>
<a name="7953"><span class="lineNum">    7953 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 5, 2 );</span></a>
<a name="7954"><span class="lineNum">    7954 </span>                :<span class="lineCov">          1 :   ombb.reset( new QgsPolygon() );</span></a>
<a name="7955"><span class="lineNum">    7955 </span>                :<span class="lineCov">          1 :   QgsLineString *ext = new QgsLineString();</span></a>
<a name="7956"><span class="lineNum">    7956 </span>                :<span class="lineCov">          1 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 2 ) &lt;&lt; QgsPoint( 5, -2 ) &lt;&lt; QgsPoint( -5, -2 ) &lt;&lt; QgsPoint( -5, 2 ) );</span></a>
<a name="7957"><span class="lineNum">    7957 </span>                :<span class="lineCov">          1 :   ombb-&gt;setExteriorRing( ext );</span></a>
<a name="7958"><span class="lineNum">    7958 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt;ombb2( elpq.orientedBoundingBox() );</span></a>
<a name="7959"><span class="lineNum">    7959 </span>                :<span class="lineCov">          1 :   QCOMPARE( ombb-&gt;asWkt( 2 ), ombb2-&gt;asWkt( 2 ) );</span></a>
<a name="7960"><span class="lineNum">    7960 </span>                :            : </a>
<a name="7961"><span class="lineNum">    7961 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 5, 2.5, 45 );</span></a>
<a name="7962"><span class="lineNum">    7962 </span>                :<span class="lineCov">          1 :   ombb.reset( elpq.orientedBoundingBox() );</span></a>
<a name="7963"><span class="lineNum">    7963 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1.7678, 5.3033 ), 0.0001 );</span></a>
<a name="7964"><span class="lineNum">    7964 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 5.3033, 1.7678 ), 0.0001 );</span></a>
<a name="7965"><span class="lineNum">    7965 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( -1.7678, -5.3033 ), 0.0001 );</span></a>
<a name="7966"><span class="lineNum">    7966 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( -5.3033, -1.7678 ), 0.0001 );</span></a>
<a name="7967"><span class="lineNum">    7967 </span>                :            : </a>
<a name="7968"><span class="lineNum">    7968 </span>                :<span class="lineCov">          1 :   elpq = QgsEllipse( QgsPoint( 0, 0 ), 5, 2.5, 315 );</span></a>
<a name="7969"><span class="lineNum">    7969 </span>                :<span class="lineCov">          1 :   ombb.reset( elpq.orientedBoundingBox() );</span></a>
<a name="7970"><span class="lineNum">    7970 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( -5.3033, 1.7678 ), 0.0001 );</span></a>
<a name="7971"><span class="lineNum">    7971 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( -1.7678, 5.3033 ), 0.0001 );</span></a>
<a name="7972"><span class="lineNum">    7972 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 5.3033, -1.7678 ), 0.0001 );</span></a>
<a name="7973"><span class="lineNum">    7973 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( ombb-&gt;exteriorRing()-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( 1.7678, -5.3033 ), 0.0001 );</span></a>
<a name="7974"><span class="lineNum">    7974 </span>                :            : </a>
<a name="7975"><span class="lineNum">    7975 </span>                :            :   // bounding box</a>
<a name="7976"><span class="lineNum">    7976 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse().boundingBox(), QgsRectangle() );</span></a>
<a name="7977"><span class="lineNum">    7977 </span>                :<span class="lineCov">          1 :   ombb.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2 ).orientedBoundingBox() );</span></a>
<a name="7978"><span class="lineNum">    7978 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 5, 2 ).boundingBox(), ombb-&gt;boundingBox() );</span></a>
<a name="7979"><span class="lineNum">    7979 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 5, 5 ).boundingBox(), QgsRectangle( QgsPointXY( -5, -5 ), QgsPointXY( 5, 5 ) ) );</span></a>
<a name="7980"><span class="lineNum">    7980 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 5, 5, 60 ).boundingBox(), QgsRectangle( QgsPointXY( -5, -5 ), QgsPointXY( 5, 5 ) ) );</span></a>
<a name="7981"><span class="lineNum">    7981 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 13, 9, 45 ).boundingBox().toString( 4 ).toStdString(), QgsRectangle( QgsPointXY( -11.1803, -11.1803 ), QgsPointXY( 11.1803, 11.1803 ) ).toString( 4 ).toStdString() );</span></a>
<a name="7982"><span class="lineNum">    7982 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 13, 9, 60 ).boundingBox().toString( 4 ).toStdString(), QgsRectangle( QgsPointXY( -12.12436, -10.14889 ), QgsPointXY( 12.12436, 10.14889 ) ).toString( 4 ).toStdString() );</span></a>
<a name="7983"><span class="lineNum">    7983 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 13, 9, 60 + 90 ).boundingBox().toString( 4 ).toStdString(), QgsRectangle( QgsPointXY( -10.14889, -12.12436 ), QgsPointXY( 10.14889, 12.12436 ) ).toString( 4 ).toStdString() );</span></a>
<a name="7984"><span class="lineNum">    7984 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 13, 9, 300 ).boundingBox().toString( 4 ).toStdString(), QgsRectangle( QgsPointXY( -12.12436, -10.14889 ), QgsPointXY( 12.12436, 10.14889 ) ).toString( 4 ).toStdString() );</span></a>
<a name="7985"><span class="lineNum">    7985 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 13, 9, 300 - 90 ).boundingBox().toString( 4 ).toStdString(), QgsRectangle( QgsPointXY( -10.14889, -12.12436 ), QgsPointXY( 10.14889, 12.12436 ) ).toString( 4 ).toStdString() );</span></a>
<a name="7986"><span class="lineNum">    7986 </span>                :            : </a>
<a name="7987"><span class="lineNum">    7987 </span>                :            :   // focus</a>
<a name="7988"><span class="lineNum">    7988 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse().fromFoci( QgsPoint( -4, 0 ), QgsPoint( 4, 0 ), QgsPoint( 0, 4 ) ).focusDistance(), 4.0 );</span></a>
<a name="7989"><span class="lineNum">    7989 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( QgsEllipse().fromFoci( QgsPoint( 10, 10 ), QgsPoint( 25, 20 ), QgsPoint( 15, 20 ) ).focusDistance(), 9.01388, 0.0001 );</span></a>
<a name="7990"><span class="lineNum">    7990 </span>                :            : </a>
<a name="7991"><span class="lineNum">    7991 </span>                :            :   // eccentricity</a>
<a name="7992"><span class="lineNum">    7992 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse().fromFoci( QgsPoint( -4, 0 ), QgsPoint( 4, 0 ), QgsPoint( 0, 4 ) ).eccentricity(), 0.7071067811865475 );</span></a>
<a name="7993"><span class="lineNum">    7993 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsEllipse( QgsPoint( 0, 0 ), 3, 3 ).eccentricity(), 0.0 );</span></a>
<a name="7994"><span class="lineNum">    7994 </span>                :<span class="lineCov">          1 :   QVERIFY( std::isnan( QgsEllipse().eccentricity() ) );</span></a>
<a name="7995"><span class="lineNum">    7995 </span>                :            : </a>
<a name="7996"><span class="lineNum">    7996 </span>                :            :   // area</a>
<a name="7997"><span class="lineNum">    7997 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 31.4159, QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 0 ).area(), 0.0001 );</span></a>
<a name="7998"><span class="lineNum">    7998 </span>                :            :   // perimeter</a>
<a name="7999"><span class="lineNum">    7999 </span>                :<span class="lineCov">          1 :   p1.reset( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 45 ).toPolygon( 10000 ) );</span></a>
<a name="8000"><span class="lineNum">    8000 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( QgsEllipse( QgsPoint( 0, 0 ), 5, 2, 45 ).perimeter(), p1-&gt;perimeter(), 0.001 );</span></a>
<a name="8001"><span class="lineNum">    8001 </span>                :            : </a>
<a name="8002"><span class="lineNum">    8002 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="8003"><span class="lineNum">    8003 </span>                :            : </a>
<a name="8004"><span class="lineNum">    8004 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::circle()</span></a>
<a name="8005"><span class="lineNum">    8005 </span>                :            : {</a>
<a name="8006"><span class="lineNum">    8006 </span>                :            :   //test constructors</a>
<a name="8007"><span class="lineNum">    8007 </span>                :<span class="lineCov">          1 :   QgsCircle circ1;</span></a>
<a name="8008"><span class="lineNum">    8008 </span>                :<span class="lineCov">          1 :   QVERIFY( circ1.center().isEmpty() );</span></a>
<a name="8009"><span class="lineNum">    8009 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.radius(), 0.0 );</span></a>
<a name="8010"><span class="lineNum">    8010 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.azimuth(), 0.0 );</span></a>
<a name="8011"><span class="lineNum">    8011 </span>                :<span class="lineCov">          1 :   QVERIFY( circ1.isEmpty() );</span></a>
<a name="8012"><span class="lineNum">    8012 </span>                :            : </a>
<a name="8013"><span class="lineNum">    8013 </span>                :<span class="lineCov">          1 :   QgsCircle circ2( QgsPoint( 5, 10 ), 3 );</span></a>
<a name="8014"><span class="lineNum">    8014 </span>                :<span class="lineCov">          1 :   QVERIFY( circ2.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="8015"><span class="lineNum">    8015 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ2.radius(), 3.0 );</span></a>
<a name="8016"><span class="lineNum">    8016 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ2.azimuth(), 0.0 );</span></a>
<a name="8017"><span class="lineNum">    8017 </span>                :<span class="lineCov">          1 :   QVERIFY( !circ2.isEmpty() );</span></a>
<a name="8018"><span class="lineNum">    8018 </span>                :            : </a>
<a name="8019"><span class="lineNum">    8019 </span>                :<span class="lineCov">          1 :   QgsCircle circ3( QgsPoint( 5, 10 ), 3, 45 );</span></a>
<a name="8020"><span class="lineNum">    8020 </span>                :<span class="lineCov">          1 :   QVERIFY( circ3.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="8021"><span class="lineNum">    8021 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ3.radius(), 3.0 );</span></a>
<a name="8022"><span class="lineNum">    8022 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ3.azimuth(), 45.0 );</span></a>
<a name="8023"><span class="lineNum">    8023 </span>                :<span class="lineCov">          1 :   QVERIFY( !circ3.isEmpty() );</span></a>
<a name="8024"><span class="lineNum">    8024 </span>                :            : </a>
<a name="8025"><span class="lineNum">    8025 </span>                :            :   //test toString</a>
<a name="8026"><span class="lineNum">    8026 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.toString(), QString( &quot;Empty&quot; ) );</span></a>
<a name="8027"><span class="lineNum">    8027 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ2.toString(), QString( &quot;Circle (Center: Point (5 10), Radius: 3, Azimuth: 0)&quot; ) );</span></a>
<a name="8028"><span class="lineNum">    8028 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ3.toString(), QString( &quot;Circle (Center: Point (5 10), Radius: 3, Azimuth: 45)&quot; ) );</span></a>
<a name="8029"><span class="lineNum">    8029 </span>                :            : </a>
<a name="8030"><span class="lineNum">    8030 </span>                :            : //test equality operator</a>
<a name="8031"><span class="lineNum">    8031 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle().isEmpty(), QgsCircle( QgsPoint(), 0, 0 ).isEmpty() );</span></a>
<a name="8032"><span class="lineNum">    8032 </span>                :<span class="lineCov">          1 :   QVERIFY( !( QgsCircle() == QgsCircle( QgsPoint( 0, 0 ), 0, 0.0005 ) ) );</span></a>
<a name="8033"><span class="lineNum">    8033 </span>                :<span class="lineCov">          1 :   QVERIFY( circ2 == QgsCircle( QgsPoint( 5, 10 ), 3, 0 ) );</span></a>
<a name="8034"><span class="lineNum">    8034 </span>                :<span class="lineCov">          1 :   QVERIFY( circ2 != circ3 );</span></a>
<a name="8035"><span class="lineNum">    8035 </span>                :            : </a>
<a name="8036"><span class="lineNum">    8036 </span>                :            : //test setter and getter</a>
<a name="8037"><span class="lineNum">    8037 </span>                :<span class="lineCov">          1 :   circ1.setAzimuth( 45 );</span></a>
<a name="8038"><span class="lineNum">    8038 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.azimuth(), 45.0 );</span></a>
<a name="8039"><span class="lineNum">    8039 </span>                :            : </a>
<a name="8040"><span class="lineNum">    8040 </span>                :<span class="lineCov">          1 :   circ1.setRadius( 50 );</span></a>
<a name="8041"><span class="lineNum">    8041 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.radius(), 50.0 );</span></a>
<a name="8042"><span class="lineNum">    8042 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMajorAxis(), 50.0 );</span></a>
<a name="8043"><span class="lineNum">    8043 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMinorAxis(), 50.0 );</span></a>
<a name="8044"><span class="lineNum">    8044 </span>                :            : </a>
<a name="8045"><span class="lineNum">    8045 </span>                :<span class="lineCov">          1 :   circ1.setSemiMajorAxis( 250 );</span></a>
<a name="8046"><span class="lineNum">    8046 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.radius(), 250.0 );</span></a>
<a name="8047"><span class="lineNum">    8047 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMajorAxis(), 250.0 );</span></a>
<a name="8048"><span class="lineNum">    8048 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMinorAxis(), 250.0 );</span></a>
<a name="8049"><span class="lineNum">    8049 </span>                :            : </a>
<a name="8050"><span class="lineNum">    8050 </span>                :<span class="lineCov">          1 :   circ1.setSemiMinorAxis( 8250 );</span></a>
<a name="8051"><span class="lineNum">    8051 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.radius(), 8250.0 );</span></a>
<a name="8052"><span class="lineNum">    8052 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMajorAxis(), 8250.0 );</span></a>
<a name="8053"><span class="lineNum">    8053 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ1.semiMinorAxis(), 8250.0 );</span></a>
<a name="8054"><span class="lineNum">    8054 </span>                :            : </a>
<a name="8055"><span class="lineNum">    8055 </span>                :<span class="lineCov">          1 :   circ1.setCenter( QgsPoint( 5, 10 ) );</span></a>
<a name="8056"><span class="lineNum">    8056 </span>                :<span class="lineCov">          1 :   QVERIFY( circ1.center() == QgsPoint( 5, 10 ) );</span></a>
<a name="8057"><span class="lineNum">    8057 </span>                :<span class="lineCov">          1 :   QVERIFY( circ1.rcenter() == QgsPoint( 5, 10 ) );</span></a>
<a name="8058"><span class="lineNum">    8058 </span>                :<span class="lineCov">          1 :   circ1.rcenter() = QgsPoint( 25, 310 );</span></a>
<a name="8059"><span class="lineNum">    8059 </span>                :<span class="lineCov">          1 :   QVERIFY( circ1.center() == QgsPoint( 25, 310 ) );</span></a>
<a name="8060"><span class="lineNum">    8060 </span>                :            : </a>
<a name="8061"><span class="lineNum">    8061 </span>                :            : //test &quot;alt&quot; constructors</a>
<a name="8062"><span class="lineNum">    8062 </span>                :            : // by2Points</a>
<a name="8063"><span class="lineNum">    8063 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().from2Points( QgsPoint( -5, 0 ), QgsPoint( 5, 0 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 90 ) );</span></a>
<a name="8064"><span class="lineNum">    8064 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().from2Points( QgsPoint( 0, -5 ), QgsPoint( 0, 5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 0 ) );</span></a>
<a name="8065"><span class="lineNum">    8065 </span>                :            : // byExtent</a>
<a name="8066"><span class="lineNum">    8066 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromExtent( QgsPoint( -5, -5 ), QgsPoint( 5, 5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 0 ) );</span></a>
<a name="8067"><span class="lineNum">    8067 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromExtent( QgsPoint( -7.5, -2.5 ), QgsPoint( 2.5, 200.5 ) ).isEmpty() );</span></a>
<a name="8068"><span class="lineNum">    8068 </span>                :            : // by3Points</a>
<a name="8069"><span class="lineNum">    8069 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().from3Points( QgsPoint( -5, 0 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5 ) );</span></a>
<a name="8070"><span class="lineNum">    8070 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().from3Points( QgsPoint( 5, 0 ), QgsPoint( 6, 0 ), QgsPoint( 7, 0 ) ).isEmpty() );</span></a>
<a name="8071"><span class="lineNum">    8071 </span>                :            : // byCenterDiameter</a>
<a name="8072"><span class="lineNum">    8072 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterDiameter( QgsPoint( 0, 0 ), 10 ) == QgsCircle( QgsPoint( 0, 0 ), 5, 0 ) );</span></a>
<a name="8073"><span class="lineNum">    8073 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterDiameter( QgsPoint( 2, 100 ), -10 ) == QgsCircle( QgsPoint( 2, 100 ), 5, 0 ) );</span></a>
<a name="8074"><span class="lineNum">    8074 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterDiameter( QgsPoint( 2, 100 ), -10, 45 ) == QgsCircle( QgsPoint( 2, 100 ), 5, 45 ) );</span></a>
<a name="8075"><span class="lineNum">    8075 </span>                :            : // byCenterPoint</a>
<a name="8076"><span class="lineNum">    8076 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterPoint( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 90 ) );</span></a>
<a name="8077"><span class="lineNum">    8077 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterPoint( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 0 ) );</span></a>
<a name="8078"><span class="lineNum">    8078 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle().fromCenterPoint( QgsPoint( 0, 0 ), QgsPoint( 5 * std::cos( 45 * M_PI / 180.0 ), 5 * std::sin( 45 * M_PI / 180.0 ) ) ) == QgsCircle( QgsPoint( 0, 0 ), 5, 45 ) );</span></a>
<a name="8079"><span class="lineNum">    8079 </span>                :            : // by3Tangents</a>
<a name="8080"><span class="lineNum">    8080 </span>                :            : // Tangents from triangle tri1( 0,0 ; 0,5 ), tri2( 0,0 ; 5,0 ), tri3( 5,0 ; 0,5 )</a>
<a name="8081"><span class="lineNum">    8081 </span>                :<span class="lineCov">          1 :   QgsCircle circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 0, 1 ), QgsPoint( 2, 0 ), QgsPoint( 3, 0 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8082"><span class="lineNum">    8082 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 1.4645, 1.4645 ), 0.0001 );</span></a>
<a name="8083"><span class="lineNum">    8083 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 1.4645, 0.0001 );</span></a>
<a name="8084"><span class="lineNum">    8084 </span>                :            :   // with parallels</a>
<a name="8085"><span class="lineNum">    8085 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 1, 0 ), QgsPoint( 1, 5 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8086"><span class="lineNum">    8086 </span>                :<span class="lineCov">          1 :   QVERIFY( circ_tgt.isEmpty() );</span></a>
<a name="8087"><span class="lineNum">    8087 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ), QgsPoint( 1, 0 ), QgsPoint( 1, 5 ) );</span></a>
<a name="8088"><span class="lineNum">    8088 </span>                :<span class="lineCov">          1 :   QVERIFY( circ_tgt.isEmpty() );</span></a>
<a name="8089"><span class="lineNum">    8089 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 5, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 1, 0 ), QgsPoint( 1, 5 ) );</span></a>
<a name="8090"><span class="lineNum">    8090 </span>                :<span class="lineCov">          1 :   QVERIFY( circ_tgt.isEmpty() );</span></a>
<a name="8091"><span class="lineNum">    8091 </span>                :            :   // with 2 parallels</a>
<a name="8092"><span class="lineNum">    8092 </span>                :<span class="lineCov">          1 :   const double epsilon = 1e-8;</span></a>
<a name="8093"><span class="lineNum">    8093 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ) );</span></a>
<a name="8094"><span class="lineNum">    8094 </span>                :<span class="lineCov">          1 :   QVERIFY( circ_tgt.isEmpty() );</span></a>
<a name="8095"><span class="lineNum">    8095 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ), epsilon, QgsPoint( 2, 0 ) );</span></a>
<a name="8096"><span class="lineNum">    8096 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 1.4645, 2.5000 ), 0.0001 );</span></a>
<a name="8097"><span class="lineNum">    8097 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 2.5, 0.0001 );</span></a>
<a name="8098"><span class="lineNum">    8098 </span>                :<span class="lineCov">          1 :   circ_tgt = QgsCircle().from3Tangents( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ), epsilon, QgsPoint( 3, 0 ) );</span></a>
<a name="8099"><span class="lineNum">    8099 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 8.5355, 2.5000 ), 0.0001 );</span></a>
<a name="8100"><span class="lineNum">    8100 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 2.5, 0.0001 );</span></a>
<a name="8101"><span class="lineNum">    8101 </span>                :            : // from3tangentsMulti</a>
<a name="8102"><span class="lineNum">    8102 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsCircle&gt; circles_tgt;</span></a>
<a name="8103"><span class="lineNum">    8103 </span>                :<span class="lineCov">          1 :   circles_tgt = QgsCircle().from3TangentsMulti( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ) );</span></a>
<a name="8104"><span class="lineNum">    8104 </span>                :<span class="lineCov">          1 :   QCOMPARE( circles_tgt.count(), 2 );</span></a>
<a name="8105"><span class="lineNum">    8105 </span>                :<span class="lineCov">          1 :   circ_tgt = circles_tgt.at( 0 );</span></a>
<a name="8106"><span class="lineNum">    8106 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 8.5355, 2.5000 ), 0.0001 );</span></a>
<a name="8107"><span class="lineNum">    8107 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 2.5, 0.0001 );</span></a>
<a name="8108"><span class="lineNum">    8108 </span>                :<span class="lineCov">          1 :   circ_tgt = circles_tgt.at( 1 );</span></a>
<a name="8109"><span class="lineNum">    8109 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 1.4645, 2.5000 ), 0.0001 );</span></a>
<a name="8110"><span class="lineNum">    8110 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 2.5, 0.0001 );</span></a>
<a name="8111"><span class="lineNum">    8111 </span>                :<span class="lineCov">          1 :   circles_tgt = QgsCircle().from3TangentsMulti( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ), epsilon, QgsPoint( 2, 0 ) );</span></a>
<a name="8112"><span class="lineNum">    8112 </span>                :<span class="lineCov">          1 :   QCOMPARE( circles_tgt.count(), 1 );</span></a>
<a name="8113"><span class="lineNum">    8113 </span>                :<span class="lineCov">          1 :   circ_tgt = circles_tgt.at( 0 );</span></a>
<a name="8114"><span class="lineNum">    8114 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( circ_tgt.center(), QgsPoint( 1.4645, 2.5000 ), 0.0001 );</span></a>
<a name="8115"><span class="lineNum">    8115 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( circ_tgt.radius(), 2.5, 0.0001 );</span></a>
<a name="8116"><span class="lineNum">    8116 </span>                :<span class="lineCov">          1 :   circles_tgt = QgsCircle().from3TangentsMulti( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 2.5, 0 ), QgsPoint( 7.5, 5 ), epsilon, QgsPoint( 3, 0 ) );</span></a>
<a name="8117"><span class="lineNum">    8117 </span>                :<span class="lineCov">          1 :   QCOMPARE( circles_tgt.count(), 1 );</span></a>
<a name="8118"><span class="lineNum">    8118 </span>                :<span class="lineCov">          1 :   circles_tgt = QgsCircle().from3TangentsMulti( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), QgsPoint( 5, 5 ), QgsPoint( 10, 5 ), QgsPoint( 15, 5 ), QgsPoint( 20, 5 ) );</span></a>
<a name="8119"><span class="lineNum">    8119 </span>                :<span class="lineCov">          1 :   QVERIFY( circles_tgt.isEmpty() );</span></a>
<a name="8120"><span class="lineNum">    8120 </span>                :            :   // check that Z dimension is ignored in case of using tangents</a>
<a name="8121"><span class="lineNum">    8121 </span>                :<span class="lineCov">          1 :   QgsCircle circ_tgt_z = QgsCircle().from3Tangents( QgsPoint( 0, 0, 333 ), QgsPoint( 0, 1, 1 ), QgsPoint( 2, 0, 2 ), QgsPoint( 3, 0, 3 ), QgsPoint( 5, 0, 4 ), QgsPoint( 0, 5, 5 ) );</span></a>
<a name="8122"><span class="lineNum">    8122 </span>                :<span class="lineCov">          1 :   QCOMPARE( circ_tgt_z.center().is3D(), false );</span></a>
<a name="8123"><span class="lineNum">    8123 </span>                :            : </a>
<a name="8124"><span class="lineNum">    8124 </span>                :            :   // minimalCircleFrom3points</a>
<a name="8125"><span class="lineNum">    8125 </span>                :<span class="lineCov">          1 :   QgsCircle minCircle3Points = QgsCircle().minimalCircleFrom3Points( QgsPoint( 0, 5 ), QgsPoint( 0, -5 ), QgsPoint( 1, 2 ) );</span></a>
<a name="8126"><span class="lineNum">    8126 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( minCircle3Points.center(), QgsPoint( 0, 0 ), 0.0001 );</span></a>
<a name="8127"><span class="lineNum">    8127 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( minCircle3Points.radius(), 5.0, 0.0001 );</span></a>
<a name="8128"><span class="lineNum">    8128 </span>                :<span class="lineCov">          1 :   minCircle3Points = QgsCircle().minimalCircleFrom3Points( QgsPoint( 0, 5 ), QgsPoint( 5, 0 ), QgsPoint( -5, 0 ) );</span></a>
<a name="8129"><span class="lineNum">    8129 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( minCircle3Points.center(), QgsPoint( 0, 0 ), 0.0001 );</span></a>
<a name="8130"><span class="lineNum">    8130 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( minCircle3Points.radius(), 5.0, 0.0001 );</span></a>
<a name="8131"><span class="lineNum">    8131 </span>                :            : </a>
<a name="8132"><span class="lineNum">    8132 </span>                :            : </a>
<a name="8133"><span class="lineNum">    8133 </span>                :            : </a>
<a name="8134"><span class="lineNum">    8134 </span>                :            : // test quadrant</a>
<a name="8135"><span class="lineNum">    8135 </span>                :<span class="lineCov">          1 :   QgsPointSequence quad = QgsCircle( QgsPoint( 0, 0 ), 5 ).northQuadrant();</span></a>
<a name="8136"><span class="lineNum">    8136 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 0 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8137"><span class="lineNum">    8137 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 1 ) == QgsPoint( 5, 0 ) );</span></a>
<a name="8138"><span class="lineNum">    8138 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 2 ) == QgsPoint( 0, -5 ) );</span></a>
<a name="8139"><span class="lineNum">    8139 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 3 ) == QgsPoint( -5, 0 ) );</span></a>
<a name="8140"><span class="lineNum">    8140 </span>                :            : </a>
<a name="8141"><span class="lineNum">    8141 </span>                :<span class="lineCov">          1 :   quad = QgsCircle( QgsPoint( 0, 0 ), 5, 123 ).northQuadrant();</span></a>
<a name="8142"><span class="lineNum">    8142 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 0 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8143"><span class="lineNum">    8143 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 1 ) == QgsPoint( 5, 0 ) );</span></a>
<a name="8144"><span class="lineNum">    8144 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 2 ) == QgsPoint( 0, -5 ) );</span></a>
<a name="8145"><span class="lineNum">    8145 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 3 ) == QgsPoint( -5, 0 ) );</span></a>
<a name="8146"><span class="lineNum">    8146 </span>                :            : </a>
<a name="8147"><span class="lineNum">    8147 </span>                :<span class="lineCov">          1 :   quad = QgsCircle( QgsPoint( 0, 0 ), 5, 456 ).northQuadrant();</span></a>
<a name="8148"><span class="lineNum">    8148 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 0 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8149"><span class="lineNum">    8149 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 1 ) == QgsPoint( 5, 0 ) );</span></a>
<a name="8150"><span class="lineNum">    8150 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 2 ) == QgsPoint( 0, -5 ) );</span></a>
<a name="8151"><span class="lineNum">    8151 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 3 ) == QgsPoint( -5, 0 ) );</span></a>
<a name="8152"><span class="lineNum">    8152 </span>                :            : </a>
<a name="8153"><span class="lineNum">    8153 </span>                :<span class="lineCov">          1 :   quad = QgsCircle( QgsPoint( 0, 0 ), 5, -789l ).northQuadrant();</span></a>
<a name="8154"><span class="lineNum">    8154 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 0 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8155"><span class="lineNum">    8155 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 1 ) == QgsPoint( 5, 0 ) );</span></a>
<a name="8156"><span class="lineNum">    8156 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 2 ) == QgsPoint( 0, -5 ) );</span></a>
<a name="8157"><span class="lineNum">    8157 </span>                :<span class="lineCov">          1 :   QVERIFY( quad.at( 3 ) == QgsPoint( -5, 0 ) );</span></a>
<a name="8158"><span class="lineNum">    8158 </span>                :            : </a>
<a name="8159"><span class="lineNum">    8159 </span>                :            : </a>
<a name="8160"><span class="lineNum">    8160 </span>                :            : //test conversion</a>
<a name="8161"><span class="lineNum">    8161 </span>                :<span class="lineCov">          1 :   QgsPointSequence ptsPol;</span></a>
<a name="8162"><span class="lineNum">    8162 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; pol( new QgsPolygon() );</span></a>
<a name="8163"><span class="lineNum">    8163 </span>                :            : // polygon</a>
<a name="8164"><span class="lineNum">    8164 </span>                :<span class="lineCov">          1 :   pol.reset( QgsCircle( QgsPoint( 0, 0 ), 5 ).toPolygon( 4 ) );</span></a>
<a name="8165"><span class="lineNum">    8165 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8166"><span class="lineNum">    8166 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8167"><span class="lineNum">    8167 </span>                :            : </a>
<a name="8168"><span class="lineNum">    8168 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8169"><span class="lineNum">    8169 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8170"><span class="lineNum">    8170 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8171"><span class="lineNum">    8171 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( 5, 0 ) );</span></a>
<a name="8172"><span class="lineNum">    8172 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( 0, -5 ) );</span></a>
<a name="8173"><span class="lineNum">    8173 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( -5, 0 ) );</span></a>
<a name="8174"><span class="lineNum">    8174 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( 0, 5 ) );</span></a>
<a name="8175"><span class="lineNum">    8175 </span>                :            : </a>
<a name="8176"><span class="lineNum">    8176 </span>                :            : // oriented</a>
<a name="8177"><span class="lineNum">    8177 </span>                :            : //45</a>
<a name="8178"><span class="lineNum">    8178 </span>                :<span class="lineCov">          1 :   double val = 5 * std::sin( M_PI / 4 );</span></a>
<a name="8179"><span class="lineNum">    8179 </span>                :<span class="lineCov">          1 :   pol.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 45 ).toPolygon( 4 ) );</span></a>
<a name="8180"><span class="lineNum">    8180 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8181"><span class="lineNum">    8181 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8182"><span class="lineNum">    8182 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8183"><span class="lineNum">    8183 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8184"><span class="lineNum">    8184 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( val, val ) );</span></a>
<a name="8185"><span class="lineNum">    8185 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( val, -val ) );</span></a>
<a name="8186"><span class="lineNum">    8186 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( -val, -val ) );</span></a>
<a name="8187"><span class="lineNum">    8187 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( -val, val ) );</span></a>
<a name="8188"><span class="lineNum">    8188 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( val, val ) );</span></a>
<a name="8189"><span class="lineNum">    8189 </span>                :            : //135</a>
<a name="8190"><span class="lineNum">    8190 </span>                :<span class="lineCov">          1 :   pol.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 135 ).toPolygon( 4 ) );</span></a>
<a name="8191"><span class="lineNum">    8191 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8192"><span class="lineNum">    8192 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8193"><span class="lineNum">    8193 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8194"><span class="lineNum">    8194 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8195"><span class="lineNum">    8195 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( val, -val ) );</span></a>
<a name="8196"><span class="lineNum">    8196 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( -val, -val ) );</span></a>
<a name="8197"><span class="lineNum">    8197 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( -val, val ) );</span></a>
<a name="8198"><span class="lineNum">    8198 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( val, val ) );</span></a>
<a name="8199"><span class="lineNum">    8199 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( val, -val ) );</span></a>
<a name="8200"><span class="lineNum">    8200 </span>                :            : //225</a>
<a name="8201"><span class="lineNum">    8201 </span>                :<span class="lineCov">          1 :   pol.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 225 ).toPolygon( 4 ) );</span></a>
<a name="8202"><span class="lineNum">    8202 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8203"><span class="lineNum">    8203 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8204"><span class="lineNum">    8204 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8205"><span class="lineNum">    8205 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8206"><span class="lineNum">    8206 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( -val, -val ) );</span></a>
<a name="8207"><span class="lineNum">    8207 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( -val, val ) );</span></a>
<a name="8208"><span class="lineNum">    8208 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( val, val ) );</span></a>
<a name="8209"><span class="lineNum">    8209 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( val, -val ) );</span></a>
<a name="8210"><span class="lineNum">    8210 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( -val, -val ) );</span></a>
<a name="8211"><span class="lineNum">    8211 </span>                :            : //315</a>
<a name="8212"><span class="lineNum">    8212 </span>                :<span class="lineCov">          1 :   pol.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 315 ).toPolygon( 4 ) );</span></a>
<a name="8213"><span class="lineNum">    8213 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8214"><span class="lineNum">    8214 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8215"><span class="lineNum">    8215 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8216"><span class="lineNum">    8216 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8217"><span class="lineNum">    8217 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( -val, val ) );</span></a>
<a name="8218"><span class="lineNum">    8218 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( val, val ) );</span></a>
<a name="8219"><span class="lineNum">    8219 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( val, -val ) );</span></a>
<a name="8220"><span class="lineNum">    8220 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( -val, -val ) );</span></a>
<a name="8221"><span class="lineNum">    8221 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( -val, val ) );</span></a>
<a name="8222"><span class="lineNum">    8222 </span>                :            : </a>
<a name="8223"><span class="lineNum">    8223 </span>                :            : // circular arc</a>
<a name="8224"><span class="lineNum">    8224 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCircularString &gt; cs( QgsCircle( QgsPoint( 0, 0 ), 5 ).toCircularString() );</span></a>
<a name="8225"><span class="lineNum">    8225 </span>                :<span class="lineCov">          1 :   QCOMPARE( cs-&gt;asWkt( 2 ), QString( &quot;CircularString (0 5, 5 0, 0 -5, -5 0, 0 5)&quot; ) );</span></a>
<a name="8226"><span class="lineNum">    8226 </span>                :<span class="lineCov">          1 :   cs.reset( QgsCircle( QgsPoint( 0, 0 ), 5 ).toCircularString( true ) );</span></a>
<a name="8227"><span class="lineNum">    8227 </span>                :<span class="lineCov">          1 :   QCOMPARE( cs-&gt;asWkt( 2 ), QString( &quot;CircularString (0 5, 5 0, 0 -5, -5 0, 0 5)&quot; ) );</span></a>
<a name="8228"><span class="lineNum">    8228 </span>                :<span class="lineCov">          1 :   cs.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 315 ).toCircularString() );</span></a>
<a name="8229"><span class="lineNum">    8229 </span>                :<span class="lineCov">          1 :   QCOMPARE( cs-&gt;asWkt( 2 ), QString( &quot;CircularString (0 5, 5 0, 0 -5, -5 0, 0 5)&quot; ) );</span></a>
<a name="8230"><span class="lineNum">    8230 </span>                :<span class="lineCov">          1 :   cs.reset( QgsCircle( QgsPoint( 0, 0 ), 5, 315 ).toCircularString( true ) );</span></a>
<a name="8231"><span class="lineNum">    8231 </span>                :<span class="lineCov">          1 :   QCOMPARE( cs-&gt;asWkt( 2 ), QString( &quot;CircularString (-3.54 3.54, 3.54 3.54, 3.54 -3.54, -3.54 -3.54, -3.54 3.54)&quot; ) );</span></a>
<a name="8232"><span class="lineNum">    8232 </span>                :            : </a>
<a name="8233"><span class="lineNum">    8233 </span>                :            : // bounding box</a>
<a name="8234"><span class="lineNum">    8234 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsRectangle( QgsPointXY( -2.5, -2.5 ), QgsPointXY( 2.5, 2.5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 2.5, 0 ).boundingBox() );</span></a>
<a name="8235"><span class="lineNum">    8235 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsRectangle( QgsPointXY( -2.5, -2.5 ), QgsPointXY( 2.5, 2.5 ) ) == QgsCircle( QgsPoint( 0, 0 ), 2.5, 45 ).boundingBox() );</span></a>
<a name="8236"><span class="lineNum">    8236 </span>                :            : </a>
<a name="8237"><span class="lineNum">    8237 </span>                :            :   // area</a>
<a name="8238"><span class="lineNum">    8238 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 314.1593, QgsCircle( QgsPoint( 0, 0 ), 10 ).area(), 0.0001 );</span></a>
<a name="8239"><span class="lineNum">    8239 </span>                :            :   // perimeter</a>
<a name="8240"><span class="lineNum">    8240 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( 31.4159, QgsCircle( QgsPoint( 0, 0 ), 5 ).perimeter(), 0.0001 );</span></a>
<a name="8241"><span class="lineNum">    8241 </span>                :            : </a>
<a name="8242"><span class="lineNum">    8242 </span>                :            :   // contains</a>
<a name="8243"><span class="lineNum">    8243 </span>                :<span class="lineCov">          1 :   QgsPoint pc;</span></a>
<a name="8244"><span class="lineNum">    8244 </span>                :<span class="lineCov">          1 :   pc = QgsPoint( 1, 1 );</span></a>
<a name="8245"><span class="lineNum">    8245 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle( QgsPoint( 0, 0 ), 5 ).contains( pc ) );</span></a>
<a name="8246"><span class="lineNum">    8246 </span>                :<span class="lineCov">          1 :   pc = QgsPoint( 0, 5 );</span></a>
<a name="8247"><span class="lineNum">    8247 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle( QgsPoint( 0, 0 ), 5 ).contains( pc ) );</span></a>
<a name="8248"><span class="lineNum">    8248 </span>                :<span class="lineCov">          1 :   pc = QgsPoint( 6, 1 );</span></a>
<a name="8249"><span class="lineNum">    8249 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsCircle( QgsPoint( 0, 0 ), 5 ).contains( pc ) );</span></a>
<a name="8250"><span class="lineNum">    8250 </span>                :            : </a>
<a name="8251"><span class="lineNum">    8251 </span>                :            :   // intersections</a>
<a name="8252"><span class="lineNum">    8252 </span>                :<span class="lineCov">          1 :   QgsCircle ci1( QgsPoint( 0, 0 ), 1 );</span></a>
<a name="8253"><span class="lineNum">    8253 </span>                :<span class="lineCov">          1 :   QgsPoint int1;</span></a>
<a name="8254"><span class="lineNum">    8254 </span>                :<span class="lineCov">          1 :   QgsPoint int2;</span></a>
<a name="8255"><span class="lineNum">    8255 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 2, 0 ), 0.5 ), int1, int2 ), 0 );</span></a>
<a name="8256"><span class="lineNum">    8256 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 0.5, 0.1 ), 0.2 ), int1, int2 ), 0 );</span></a>
<a name="8257"><span class="lineNum">    8257 </span>                :            :   // one intersection</a>
<a name="8258"><span class="lineNum">    8258 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 3, 0 ), 2 ), int1, int2 ), 1 );</span></a>
<a name="8259"><span class="lineNum">    8259 </span>                :<span class="lineCov">          1 :   QCOMPARE( int1, QgsPoint( 1, 0 ) );</span></a>
<a name="8260"><span class="lineNum">    8260 </span>                :<span class="lineCov">          1 :   QCOMPARE( int2, QgsPoint( 1, 0 ) );</span></a>
<a name="8261"><span class="lineNum">    8261 </span>                :            :   // two intersections</a>
<a name="8262"><span class="lineNum">    8262 </span>                :<span class="lineCov">          1 :   ci1 = QgsCircle( QgsPoint( 5, 3 ), 2 );</span></a>
<a name="8263"><span class="lineNum">    8263 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 7, -1 ), 4 ), int1, int2 ), 2 );</span></a>
<a name="8264"><span class="lineNum">    8264 </span>                :<span class="lineCov">          1 :   QCOMPARE( int1.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="8265"><span class="lineNum">    8265 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int1.x(), 3.8, 0.001 );</span></a>
<a name="8266"><span class="lineNum">    8266 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int1.y(), 1.4, 0.001 );</span></a>
<a name="8267"><span class="lineNum">    8267 </span>                :<span class="lineCov">          1 :   QCOMPARE( int2.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="8268"><span class="lineNum">    8268 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int2.x(), 7.0, 0.001 );</span></a>
<a name="8269"><span class="lineNum">    8269 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int2.y(), 3.0, 0.001 );</span></a>
<a name="8270"><span class="lineNum">    8270 </span>                :            :   // with z</a>
<a name="8271"><span class="lineNum">    8271 </span>                :<span class="lineCov">          1 :   ci1 = QgsCircle( QgsPoint( 5, 3, 11 ), 2 );</span></a>
<a name="8272"><span class="lineNum">    8272 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 7, -1, 5 ), 4 ), int1, int2, true ), 0 );</span></a>
<a name="8273"><span class="lineNum">    8273 </span>                :<span class="lineCov">          1 :   QCOMPARE( ci1.intersections( QgsCircle( QgsPoint( 7, -1, 11 ), 4 ), int1, int2, true ), 2 );</span></a>
<a name="8274"><span class="lineNum">    8274 </span>                :<span class="lineCov">          1 :   QCOMPARE( int1.wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="8275"><span class="lineNum">    8275 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int1.x(), 3.8, 0.001 );</span></a>
<a name="8276"><span class="lineNum">    8276 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int1.y(), 1.4, 0.001 );</span></a>
<a name="8277"><span class="lineNum">    8277 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int1.z(), 11.0, 0.001 );</span></a>
<a name="8278"><span class="lineNum">    8278 </span>                :<span class="lineCov">          1 :   QCOMPARE( int2.wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="8279"><span class="lineNum">    8279 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int2.x(), 7.0, 0.001 );</span></a>
<a name="8280"><span class="lineNum">    8280 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int2.y(), 3.0, 0.001 );</span></a>
<a name="8281"><span class="lineNum">    8281 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( int2.z(), 11.0, 0.001 );</span></a>
<a name="8282"><span class="lineNum">    8282 </span>                :            : </a>
<a name="8283"><span class="lineNum">    8283 </span>                :            :   // tangent to point</a>
<a name="8284"><span class="lineNum">    8284 </span>                :<span class="lineCov">          1 :   QgsPointXY t1;</span></a>
<a name="8285"><span class="lineNum">    8285 </span>                :<span class="lineCov">          1 :   QgsPointXY t2;</span></a>
<a name="8286"><span class="lineNum">    8286 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsCircle( QgsPoint( 1, 2 ), 4 ).tangentToPoint( QgsPointXY( 1, 2 ), t1, t2 ) );</span></a>
<a name="8287"><span class="lineNum">    8287 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle( QgsPoint( 1, 2 ), 4 ).tangentToPoint( QgsPointXY( 8, 4 ), t1, t2 ) );</span></a>
<a name="8288"><span class="lineNum">    8288 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t1.x(), 4.03, 0.01 );</span></a>
<a name="8289"><span class="lineNum">    8289 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t1.y(), -0.61, 0.01 );</span></a>
<a name="8290"><span class="lineNum">    8290 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t2.x(), 2.2, 0.01 );</span></a>
<a name="8291"><span class="lineNum">    8291 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( t2.y(), 5.82, 0.01 );</span></a>
<a name="8292"><span class="lineNum">    8292 </span>                :            : </a>
<a name="8293"><span class="lineNum">    8293 </span>                :            :   // two outer circle tangents</a>
<a name="8294"><span class="lineNum">    8294 </span>                :<span class="lineCov">          1 :   QgsPointXY l1p1, l1p2, l2p1, l2p2;</span></a>
<a name="8295"><span class="lineNum">    8295 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 1, 2 ), 4 ).outerTangents( QgsCircle( QgsPoint( 2, 3 ), 1 ), l1p1, l1p2, l2p1, l2p2 ), 0 );</span></a>
<a name="8296"><span class="lineNum">    8296 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 1, 2 ), 1 ).outerTangents( QgsCircle( QgsPoint( 10, 3 ), 4 ), l1p1, l1p2, l2p1, l2p2 ), 2 );</span></a>
<a name="8297"><span class="lineNum">    8297 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p1.x(), 0.566, 0.01 );</span></a>
<a name="8298"><span class="lineNum">    8298 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p1.y(), 2.901, 0.01 );</span></a>
<a name="8299"><span class="lineNum">    8299 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p2.x(), 8.266, 0.01 );</span></a>
<a name="8300"><span class="lineNum">    8300 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p2.y(), 6.604, 0.01 );</span></a>
<a name="8301"><span class="lineNum">    8301 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p1.x(), 0.7749, 0.01 );</span></a>
<a name="8302"><span class="lineNum">    8302 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p1.y(), 1.025, 0.01 );</span></a>
<a name="8303"><span class="lineNum">    8303 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p2.x(), 9.099, 0.01 );</span></a>
<a name="8304"><span class="lineNum">    8304 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p2.y(), -0.897, 0.01 );</span></a>
<a name="8305"><span class="lineNum">    8305 </span>                :            : </a>
<a name="8306"><span class="lineNum">    8306 </span>                :            :   // two inner circle tangents</a>
<a name="8307"><span class="lineNum">    8307 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 1, 2 ), 4 ).innerTangents( QgsCircle( QgsPoint( 2, 3 ), 1 ), l1p1, l1p2, l2p1, l2p2 ), 0 );</span></a>
<a name="8308"><span class="lineNum">    8308 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 0, 0 ), 4 ).innerTangents( QgsCircle( QgsPoint( 8, 0 ), 5 ), l1p1, l1p2, l2p1, l2p2 ), 0 );</span></a>
<a name="8309"><span class="lineNum">    8309 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 0, 0 ), 4 ).innerTangents( QgsCircle( QgsPoint( 8, 0 ), 4 ), l1p1, l1p2, l2p1, l2p2 ), 0 );</span></a>
<a name="8310"><span class="lineNum">    8310 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircle( QgsPoint( 1, 2 ), 1 ).innerTangents( QgsCircle( QgsPoint( 10, 3 ), 4 ), l1p1, l1p2, l2p1, l2p2 ), 2 );</span></a>
<a name="8311"><span class="lineNum">    8311 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p1.x(), 7.437, 0.01 );</span></a>
<a name="8312"><span class="lineNum">    8312 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p1.y(), 6.071, 0.01 );</span></a>
<a name="8313"><span class="lineNum">    8313 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p2.x(), 1.641, 0.01 );</span></a>
<a name="8314"><span class="lineNum">    8314 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l1p2.y(), 1.232, 0.01 );</span></a>
<a name="8315"><span class="lineNum">    8315 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p1.x(), 8.173, 0.01 );</span></a>
<a name="8316"><span class="lineNum">    8316 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p1.y(), -0.558, 0.01 );</span></a>
<a name="8317"><span class="lineNum">    8317 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p2.x(), 1.457, 0.01 );</span></a>
<a name="8318"><span class="lineNum">    8318 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( l2p2.y(), 2.89, 0.01 );</span></a>
<a name="8319"><span class="lineNum">    8319 </span>                :            : </a>
<a name="8320"><span class="lineNum">    8320 </span>                :            :   // asGML3</a>
<a name="8321"><span class="lineNum">    8321 </span>                :<span class="lineCov">          1 :   QgsCircle exportCircle( QgsPoint( 1, 1 ), 3 );</span></a>
<a name="8322"><span class="lineNum">    8322 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="8323"><span class="lineNum">    8323 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Circle xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1 4 4 1 1 -2&lt;/posList&gt;&lt;/Circle&gt;&quot; ) );</span></a>
<a name="8324"><span class="lineNum">    8324 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportCircle.asGml3( doc ) ), expectedGML3 );</span></a>
<a name="8325"><span class="lineNum">    8325 </span>                :            :   // asGML2</a>
<a name="8326"><span class="lineNum">    8326 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1,4 1.05,4 1.1,4 1.16,4 1.21,3.99 1.26,3.99 1.31,3.98 1.37,3.98 1.42,3.97 1.47,3.96 1.52,3.95 1.57,3.94 1.62,3.93 1.67,3.92 1.73,3.91 1.78,3.9 1.83,3.88 1.88,3.87 1.93,3.85 1.98,3.84 2.03,3.82 2.08,3.8 2.12,3.78 2.17,3.76 2.22,3.74 2.27,3.72 2.32,3.7 2.36,3.67 2.41,3.65 2.45,3.62 2.5,3.6 2.55,3.57 2.59,3.54 2.63,3.52 2.68,3.49 2.72,3.46 2.76,3.43 2.81,3.4 2.85,3.36 2.89,3.33 2.93,3.3 2.97,3.26 3.01,3.23 3.05,3.19 3.08,3.16 3.12,3.12 3.16,3.08 3.19,3.05 3.23,3.01 3.26,2.97 3.3,2.93 3.33,2.89 3.36,2.85 3.4,2.81 3.43,2.76 3.46,2.72 3.49,2.68 3.52,2.63 3.54,2.59 3.57,2.55 3.6,2.5 3.62,2.45 3.65,2.41 3.67,2.36 3.7,2.32 3.72,2.27 3.74,2.22 3.76,2.17 3.78,2.12 3.8,2.08 3.82,2.03 3.84,1.98 3.85,1.93 3.87,1.88 3.88,1.83 3.9,1.78 3.91,1.73 3.92,1.67 3.93,1.62 3.94,1.57 3.95,1.52 3.96,1.47 3.97,1.42 3.98,1.37 3.98,1.31 3.99,1.26 3.99,1.21 4,1.16 4,1.1 4,1.05 4,1 4,0.95 4,0.9 4,0.84 3.99,0.79 3.99,0.74 3.98,0.69 3.98,0.63 3.97,0.58 3.96,0.53 3.95,0.48 3.94,0.43 3.93,0.38 3.92,0.33 3.91,0.27 3.9,0.22 3.88,0.17 3.87,0.12 3.85,0.07 3.84,0.02 3.82,-0.03 3.8,-0.08 3.78,-0.12 3.76,-0.17 3.74,-0.22 3.72,-0.27 3.7,-0.32 3.67,-0.36 3.65,-0.41 3.62,-0.45 3.6,-0.5 3.57,-0.55 3.54,-0.59 3.52,-0.63 3.49,-0.68 3.46,-0.72 3.43,-0.76 3.4,-0.81 3.36,-0.85 3.33,-0.89 3.3,-0.93 3.26,-0.97 3.23,-1.01 3.19,-1.05 3.16,-1.08 3.12,-1.12 3.08,-1.16 3.05,-1.19 3.01,-1.23 2.97,-1.26 2.93,-1.3 2.89,-1.33 2.85,-1.36 2.81,-1.4 2.76,-1.43 2.72,-1.46 2.68,-1.49 2.63,-1.52 2.59,-1.54 2.55,-1.57 2.5,-1.6 2.45,-1.62 2.41,-1.65 2.36,-1.67 2.32,-1.7 2.27,-1.72 2.22,-1.74 2.17,-1.76 2.12,-1.78 2.08,-1.8 2.03,-1.82 1.98,-1.84 1.93,-1.85 1.88,-1.87 1.83,-1.88 1.78,-1.9 1.73,-1.91 1.67,-1.92 1.62,-1.93 1.57,-1.94 1.52,-1.95 1.47,-1.96 1.42,-1.97 1.37,-1.98 1.31,-1.98 1.26,-1.99 1.21,-1.99 1.16,-2 1.1,-2 1.05,-2 1,-2 0.95,-2 0.9,-2 0.84,-2 0.79,-1.99 0.74,-1.99 0.69,-1.98 0.63,-1.98 0.58,-1.97 0.53,-1.96 0.48,-1.95 0.43,-1.94 0.38,-1.93 0.33,-1.92 0.27,-1.91 0.22,-1.9 0.17,-1.88 0.12,-1.87 0.07,-1.85 0.02,-1.84 -0.03,-1.82 -0.08,-1.8 -0.12,-1.78 -0.17,-1.76 -0.22,-1.74 -0.27,-1.72 -0.32,-1.7 -0.36,-1.67 -0.41,-1.65 -0.45,-1.62 -0.5,-1.6 -0.55,-1.57 -0.59,-1.54 -0.63,-1.52 -0.68,-1.49 -0.72,-1.46 -0.76,-1.43 -0.81,-1.4 -0.85,-1.36 -0.89,-1.33 -0.93,-1.3 -0.97,-1.26 -1.01,-1.23 -1.05,-1.19 -1.08,-1.16 -1.12,-1.12 -1.16,-1.08 -1.19,-1.05 -1.23,-1.01 -1.26,-0.97 -1.3,-0.93 -1.33,-0.89 -1.36,-0.85 -1.4,-0.81 -1.43,-0.76 -1.46,-0.72 -1.49,-0.68 -1.52,-0.63 -1.54,-0.59 -1.57,-0.55 -1.6,-0.5 -1.62,-0.45 -1.65,-0.41 -1.67,-0.36 -1.7,-0.32 -1.72,-0.27 -1.74,-0.22 -1.76,-0.17 -1.78,-0.12 -1.8,-0.08 -1.82,-0.03 -1.84,0.02 -1.85,0.07 -1.87,0.12 -1.88,0.17 -1.9,0.22 -1.91,0.27 -1.92,0.33 -1.93,0.38 -1.94,0.43 -1.95,0.48 -1.96,0.53 -1.97,0.58 -1.98,0.63 -1.98,0.69 -1.99,0.74 -1.99,0.79 -2,0.84 -2,0.9 -2,0.95 -2,1 -2,1.05 -2,1.1 -2,1.16 -1.99,1.21 -1.99,1.26 -1.98,1.31 -1.98,1.37 -1.97,1.42 -1.96,1.47 -1.95,1.52 -1.94,1.57 -1.93,1.62 -1.92,1.67 -1.91,1.73 -1.9,1.78 -1.88,1.83 -1.87,1.88 -1.85,1.93 -1.84,1.98 -1.82,2.03 -1.8,2.08 -1.78,2.12 -1.76,2.17 -1.74,2.22 -1.72,2.27 -1.7,2.32 -1.67,2.36 -1.65,2.41 -1.62,2.45 -1.6,2.5 -1.57,2.55 -1.54,2.59 -1.52,2.63 -1.49,2.68 -1.46,2.72 -1.43,2.76 -1.4,2.81 -1.36,2.85 -1.33,2.89 -1.3,2.93 -1.26,2.97 -1.23,3.01 -1.19,3.05 -1.16,3.08 -1.12,3.12 -1.08,3.16 -1.05,3.19 -1.01,3.23 -0.97,3.26 -0.93,3.3 -0.89,3.33 -0.85,3.36 -0.81,3.4 -0.76,3.43 -0.72,3.46 -0.68,3.49 -0.63,3.52 -0.59,3.54 -0.55,3.57 -0.5,3.6 -0.45,3.62 -0.41,3.65 -0.36,3.67 -0.32,3.7 -0.27,3.72 -0.22,3.74 -0.17,3.76 -0.12,3.78 -0.08,3.8 -0.03,3.82 0.02,3.84 0.07,3.85 0.12,3.87 0.17,3.88 0.22,3.9 0.27,3.91 0.33,3.92 0.38,3.93 0.43,3.94 0.48,3.95 0.53,3.96 0.58,3.97 0.63,3.98 0.69,3.98 0.74,3.99 0.79,3.99 0.84,4 0.9,4 0.95,4 1,4&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="8327"><span class="lineNum">    8327 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( exportCircle.asGml2( doc, 2 ) ), expectedGML2 );</span></a>
<a name="8328"><span class="lineNum">    8328 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="8329"><span class="lineNum">    8329 </span>                :            : </a>
<a name="8330"><span class="lineNum">    8330 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::quadrilateral()</span></a>
<a name="8331"><span class="lineNum">    8331 </span>                :            : {</a>
<a name="8332"><span class="lineNum">    8332 </span>                :            : </a>
<a name="8333"><span class="lineNum">    8333 </span>                :            :   // default</a>
<a name="8334"><span class="lineNum">    8334 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad_init;</span></a>
<a name="8335"><span class="lineNum">    8335 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts = quad_init.points();</span></a>
<a name="8336"><span class="lineNum">    8336 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 0 ).isEmpty() );</span></a>
<a name="8337"><span class="lineNum">    8337 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 1 ).isEmpty() );</span></a>
<a name="8338"><span class="lineNum">    8338 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 2 ).isEmpty() );</span></a>
<a name="8339"><span class="lineNum">    8339 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 3 ).isEmpty() );</span></a>
<a name="8340"><span class="lineNum">    8340 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad_init.isValid() );</span></a>
<a name="8341"><span class="lineNum">    8341 </span>                :            : </a>
<a name="8342"><span class="lineNum">    8342 </span>                :            :   // colinear</a>
<a name="8343"><span class="lineNum">    8343 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad4points_col( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 10 ), QgsPoint( 10, 10 ) );</span></a>
<a name="8344"><span class="lineNum">    8344 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_col.isValid() );</span></a>
<a name="8345"><span class="lineNum">    8345 </span>                :<span class="lineCov">          1 :   pts = quad4points_col.points();</span></a>
<a name="8346"><span class="lineNum">    8346 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 0 ).isEmpty() );</span></a>
<a name="8347"><span class="lineNum">    8347 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 1 ).isEmpty() );</span></a>
<a name="8348"><span class="lineNum">    8348 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 2 ).isEmpty() );</span></a>
<a name="8349"><span class="lineNum">    8349 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 3 ).isEmpty() );</span></a>
<a name="8350"><span class="lineNum">    8350 </span>                :            : </a>
<a name="8351"><span class="lineNum">    8351 </span>                :            : </a>
<a name="8352"><span class="lineNum">    8352 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad4pointsXY_col( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 10 ), QgsPoint( 10, 10 ) );</span></a>
<a name="8353"><span class="lineNum">    8353 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4pointsXY_col.isValid() );</span></a>
<a name="8354"><span class="lineNum">    8354 </span>                :<span class="lineCov">          1 :   pts = quad4pointsXY_col.points();</span></a>
<a name="8355"><span class="lineNum">    8355 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 0 ).isEmpty() );</span></a>
<a name="8356"><span class="lineNum">    8356 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 1 ).isEmpty() );</span></a>
<a name="8357"><span class="lineNum">    8357 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 2 ).isEmpty() );</span></a>
<a name="8358"><span class="lineNum">    8358 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 3 ).isEmpty() );</span></a>
<a name="8359"><span class="lineNum">    8359 </span>                :            : </a>
<a name="8360"><span class="lineNum">    8360 </span>                :            : </a>
<a name="8361"><span class="lineNum">    8361 </span>                :            :   // anti parallelogram</a>
<a name="8362"><span class="lineNum">    8362 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad4points_anti( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8363"><span class="lineNum">    8363 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_anti.isValid() );</span></a>
<a name="8364"><span class="lineNum">    8364 </span>                :<span class="lineCov">          1 :   pts = quad4points_anti.points();</span></a>
<a name="8365"><span class="lineNum">    8365 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 0 ).isEmpty() );</span></a>
<a name="8366"><span class="lineNum">    8366 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 1 ).isEmpty() );</span></a>
<a name="8367"><span class="lineNum">    8367 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 2 ).isEmpty() );</span></a>
<a name="8368"><span class="lineNum">    8368 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 3 ).isEmpty() );</span></a>
<a name="8369"><span class="lineNum">    8369 </span>                :            : </a>
<a name="8370"><span class="lineNum">    8370 </span>                :            : </a>
<a name="8371"><span class="lineNum">    8371 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad4pointsXY_anti( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8372"><span class="lineNum">    8372 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4pointsXY_anti.isValid() );</span></a>
<a name="8373"><span class="lineNum">    8373 </span>                :<span class="lineCov">          1 :   pts = quad4pointsXY_anti.points();</span></a>
<a name="8374"><span class="lineNum">    8374 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 0 ).isEmpty() );</span></a>
<a name="8375"><span class="lineNum">    8375 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 1 ).isEmpty() );</span></a>
<a name="8376"><span class="lineNum">    8376 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 2 ).isEmpty() );</span></a>
<a name="8377"><span class="lineNum">    8377 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.at( 3 ).isEmpty() );</span></a>
<a name="8378"><span class="lineNum">    8378 </span>                :            : </a>
<a name="8379"><span class="lineNum">    8379 </span>                :            :   // valid</a>
<a name="8380"><span class="lineNum">    8380 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad4points_valid( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8381"><span class="lineNum">    8381 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.isValid() );</span></a>
<a name="8382"><span class="lineNum">    8382 </span>                :<span class="lineCov">          1 :   pts = quad4points_valid.points();</span></a>
<a name="8383"><span class="lineNum">    8383 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="8384"><span class="lineNum">    8384 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 1 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8385"><span class="lineNum">    8385 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 2 ), QgsPoint( 5, 5 ) );</span></a>
<a name="8386"><span class="lineNum">    8386 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 3 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8387"><span class="lineNum">    8387 </span>                :            : </a>
<a name="8388"><span class="lineNum">    8388 </span>                :            :   // setPoint</a>
<a name="8389"><span class="lineNum">    8389 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.setPoint( QgsPoint( -1, -1 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8390"><span class="lineNum">    8390 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.setPoint( QgsPoint( -1, 6 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8391"><span class="lineNum">    8391 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.setPoint( QgsPoint( 6, 6 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8392"><span class="lineNum">    8392 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.setPoint( QgsPoint( 6, -1 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8393"><span class="lineNum">    8393 </span>                :<span class="lineCov">          1 :   QVERIFY( quad4points_valid.isValid() );</span></a>
<a name="8394"><span class="lineNum">    8394 </span>                :<span class="lineCov">          1 :   pts = quad4points_valid.points();</span></a>
<a name="8395"><span class="lineNum">    8395 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 0 ), QgsPoint( -1, -1 ) );</span></a>
<a name="8396"><span class="lineNum">    8396 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 1 ), QgsPoint( -1, 6 ) );</span></a>
<a name="8397"><span class="lineNum">    8397 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 2 ), QgsPoint( 6, 6 ) );</span></a>
<a name="8398"><span class="lineNum">    8398 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts.at( 3 ), QgsPoint( 6, -1 ) );</span></a>
<a name="8399"><span class="lineNum">    8399 </span>                :            : </a>
<a name="8400"><span class="lineNum">    8400 </span>                :            :   // invalid: must have same type</a>
<a name="8401"><span class="lineNum">    8401 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -1, -1, 10 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8402"><span class="lineNum">    8402 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -1, 6, 10 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8403"><span class="lineNum">    8403 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 6, 6, 10 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8404"><span class="lineNum">    8404 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 6, -1, 10 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8405"><span class="lineNum">    8405 </span>                :            : </a>
<a name="8406"><span class="lineNum">    8406 </span>                :            :   // invalid self-intersection</a>
<a name="8407"><span class="lineNum">    8407 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 7, 3 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8408"><span class="lineNum">    8408 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 3, 7 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8409"><span class="lineNum">    8409 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 3, -7 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8410"><span class="lineNum">    8410 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 7, 3 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8411"><span class="lineNum">    8411 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 3, -7 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8412"><span class="lineNum">    8412 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -7, 3 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8413"><span class="lineNum">    8413 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 3, 7 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8414"><span class="lineNum">    8414 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -7, 3 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8415"><span class="lineNum">    8415 </span>                :            : </a>
<a name="8416"><span class="lineNum">    8416 </span>                :            :   // invalid colinear</a>
<a name="8417"><span class="lineNum">    8417 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 6, -2 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8418"><span class="lineNum">    8418 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -2, 6 ), QgsQuadrilateral::Point1 ) );</span></a>
<a name="8419"><span class="lineNum">    8419 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 6, 7 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8420"><span class="lineNum">    8420 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -2, -1 ), QgsQuadrilateral::Point2 ) );</span></a>
<a name="8421"><span class="lineNum">    8421 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 7, -1 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8422"><span class="lineNum">    8422 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -1, 7 ), QgsQuadrilateral::Point3 ) );</span></a>
<a name="8423"><span class="lineNum">    8423 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( -1, -2 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8424"><span class="lineNum">    8424 </span>                :<span class="lineCov">          1 :   QVERIFY( !quad4points_valid.setPoint( QgsPoint( 7, 6 ), QgsQuadrilateral::Point4 ) );</span></a>
<a name="8425"><span class="lineNum">    8425 </span>                :            : </a>
<a name="8426"><span class="lineNum">    8426 </span>                :            : //equals</a>
<a name="8427"><span class="lineNum">    8427 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) ) !=</span></a>
<a name="8428"><span class="lineNum">    8428 </span>                :            :            QgsQuadrilateral( QgsPoint( 0.01, 0.01 ), QgsPoint( 0.01, 5.01 ), QgsPoint( 5.01, 5.01 ), QgsPoint( 5.01, 0.01 ) ) );</a>
<a name="8429"><span class="lineNum">    8429 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) ).equals(</span></a>
<a name="8430"><span class="lineNum">    8430 </span>                :            :              QgsQuadrilateral( QgsPoint( 0.01, 0.01 ), QgsPoint( 0.01, 5.01 ), QgsPoint( 5.01, 5.01 ), QgsPoint( 5.01, 0.01 ) ), 1e-1 ) );</a>
<a name="8431"><span class="lineNum">    8431 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral( QgsPoint( 0, 0, 0 ), QgsPoint( 0, 5, -0.02 ), QgsPoint( 5, 5, 0 ), QgsPoint( 5, 0, -0.02 ) ).equals(</span></a>
<a name="8432"><span class="lineNum">    8432 </span>                :            :              QgsQuadrilateral( QgsPoint( 0.01, 0.01, 0.01 ), QgsPoint( 0.01, 5.01, 0 ), QgsPoint( 5.01, 5.01, -0.01 ), QgsPoint( 5.01, 0.01, 0.04 ) ), 1e-1 ) );</a>
<a name="8433"><span class="lineNum">    8433 </span>                :            : </a>
<a name="8434"><span class="lineNum">    8434 </span>                :            : // rectangleFromExtent</a>
<a name="8435"><span class="lineNum">    8435 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8436"><span class="lineNum">    8436 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral rectangleFromExtentZ( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 5, 10 ), QgsPoint( 5, 0, 10 ) );</span></a>
<a name="8437"><span class="lineNum">    8437 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ) ), QgsQuadrilateral() );</span></a>
<a name="8438"><span class="lineNum">    8438 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 0, 10 ) ), QgsQuadrilateral() );</span></a>
<a name="8439"><span class="lineNum">    8439 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ) ), rectangleFromExtent );</span></a>
<a name="8440"><span class="lineNum">    8440 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 5, 5 ), QgsPoint( 0, 0 ) ), rectangleFromExtent );</span></a>
<a name="8441"><span class="lineNum">    8441 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0, 10 ), QgsPoint( 5, 5 ) ), rectangleFromExtentZ );</span></a>
<a name="8442"><span class="lineNum">    8442 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 5, 5, 10 ) ) != rectangleFromExtentZ );</span></a>
<a name="8443"><span class="lineNum">    8443 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromExtent( QgsPoint( 0, 0 ), QgsPoint( 5, 5, 10 ) ), rectangleFromExtent );</span></a>
<a name="8444"><span class="lineNum">    8444 </span>                :            : </a>
<a name="8445"><span class="lineNum">    8445 </span>                :            : // squareFromDiagonal</a>
<a name="8446"><span class="lineNum">    8446 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral squareFromDiagonal( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8447"><span class="lineNum">    8447 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral squareFromDiagonalZ( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 5, 10 ), QgsPoint( 5, 0, 10 ) );</span></a>
<a name="8448"><span class="lineNum">    8448 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral squareFromDiagonalInv( QgsPoint( 5, 5 ), QgsPoint( 5, 0 ), QgsPoint( 0, 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8449"><span class="lineNum">    8449 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ) ), QgsQuadrilateral() );</span></a>
<a name="8450"><span class="lineNum">    8450 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 0, 0 ), QgsPoint( 5, 5 ) ), squareFromDiagonal );</span></a>
<a name="8451"><span class="lineNum">    8451 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 5, 5 ), QgsPoint( 0, 0 ) ) != squareFromDiagonal );</span></a>
<a name="8452"><span class="lineNum">    8452 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 5, 5 ), QgsPoint( 0, 0 ) ).equals( squareFromDiagonalInv, 1E-8 ) );</span></a>
<a name="8453"><span class="lineNum">    8453 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 0, 0, 10 ), QgsPoint( 5, 5 ) ), squareFromDiagonalZ );</span></a>
<a name="8454"><span class="lineNum">    8454 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 0, 0 ), QgsPoint( 5, 5, 10 ) ) != squareFromDiagonalZ );</span></a>
<a name="8455"><span class="lineNum">    8455 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::squareFromDiagonal( QgsPoint( 0, 0 ), QgsPoint( 5, 5, 10 ) ), squareFromDiagonal );</span></a>
<a name="8456"><span class="lineNum">    8456 </span>                :            : </a>
<a name="8457"><span class="lineNum">    8457 </span>                :            : // rectangleFromCenterPoint</a>
<a name="8458"><span class="lineNum">    8458 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral rectangleFromCenterPoint( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8459"><span class="lineNum">    8459 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral rectangleFromCenterPointZ( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 5, 10 ), QgsPoint( 5, 0, 10 ) );</span></a>
<a name="8460"><span class="lineNum">    8460 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 2.5, 2.5 ) ), QgsQuadrilateral() ) ;</span></a>
<a name="8461"><span class="lineNum">    8461 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 5, 5 ) ), rectangleFromCenterPoint ) ;</span></a>
<a name="8462"><span class="lineNum">    8462 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 5, 0 ) ), rectangleFromCenterPoint ) ;</span></a>
<a name="8463"><span class="lineNum">    8463 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 0, 5 ) ), rectangleFromCenterPoint ) ;</span></a>
<a name="8464"><span class="lineNum">    8464 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 0, 0 ) ), rectangleFromCenterPoint ) ;</span></a>
<a name="8465"><span class="lineNum">    8465 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5, 10 ), QgsPoint( 5, 5 ) ), rectangleFromCenterPointZ ) ;</span></a>
<a name="8466"><span class="lineNum">    8466 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5, 10 ), QgsPoint( 5, 0 ) ), rectangleFromCenterPointZ ) ;</span></a>
<a name="8467"><span class="lineNum">    8467 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5, 10 ), QgsPoint( 0, 5 ) ), rectangleFromCenterPointZ ) ;</span></a>
<a name="8468"><span class="lineNum">    8468 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5, 10 ), QgsPoint( 0, 0 ) ), rectangleFromCenterPointZ ) ;</span></a>
<a name="8469"><span class="lineNum">    8469 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 0, 0, 10 ) ), rectangleFromCenterPoint ) ;</span></a>
<a name="8470"><span class="lineNum">    8470 </span>                :            : </a>
<a name="8471"><span class="lineNum">    8471 </span>                :            : // fromRectangle</a>
<a name="8472"><span class="lineNum">    8472 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral fromRectangle( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8473"><span class="lineNum">    8473 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::fromRectangle( QgsRectangle( QgsPointXY( 0, 0 ), QgsPointXY( 0, 0 ) ) ), QgsQuadrilateral() );</span></a>
<a name="8474"><span class="lineNum">    8474 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::fromRectangle( QgsRectangle( QgsPointXY( 0, 0 ), QgsPointXY( 5, 5 ) ) ), fromRectangle ) ;</span></a>
<a name="8475"><span class="lineNum">    8475 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::fromRectangle( QgsRectangle( QgsPointXY( 5, 5 ), QgsPointXY( 0, 0 ) ) ), fromRectangle ) ;</span></a>
<a name="8476"><span class="lineNum">    8476 </span>                :            : // rectangleFrom3points</a>
<a name="8477"><span class="lineNum">    8477 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8478"><span class="lineNum">    8478 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 5 ), QgsQuadrilateral::Distance ), QgsQuadrilateral() );</span></a>
<a name="8479"><span class="lineNum">    8479 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 0, 5 ), QgsQuadrilateral::Projected ), QgsQuadrilateral() );</span></a>
<a name="8480"><span class="lineNum">    8480 </span>                :            : </a>
<a name="8481"><span class="lineNum">    8481 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsQuadrilateral::Distance ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8482"><span class="lineNum">    8482 </span>                :            :             QString( &quot;LineString (0 0, 0 5, 5 5, 5 0, 0 0)&quot; ) );</a>
<a name="8483"><span class="lineNum">    8483 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsQuadrilateral::Distance ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8484"><span class="lineNum">    8484 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8485"><span class="lineNum">    8485 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 5 ), QgsQuadrilateral::Distance ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8486"><span class="lineNum">    8486 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8487"><span class="lineNum">    8487 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5, 10 ), QgsQuadrilateral::Distance ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8488"><span class="lineNum">    8488 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8489"><span class="lineNum">    8489 </span>                :            : </a>
<a name="8490"><span class="lineNum">    8490 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 4 ), QgsQuadrilateral::Projected ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8491"><span class="lineNum">    8491 </span>                :            :             QString( &quot;LineString (0 0, 0 5, 5 5, 5 0, 0 0)&quot; ) );</a>
<a name="8492"><span class="lineNum">    8492 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5 ), QgsPoint( 5, 4 ), QgsQuadrilateral::Projected ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8493"><span class="lineNum">    8493 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8494"><span class="lineNum">    8494 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 4 ), QgsQuadrilateral::Projected ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8495"><span class="lineNum">    8495 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8496"><span class="lineNum">    8496 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 4, 10 ), QgsQuadrilateral::Projected ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8497"><span class="lineNum">    8497 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8498"><span class="lineNum">    8498 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 4, 10 ), QgsQuadrilateral::Projected ).toLineString()-&gt;asWkt( 0 ),</span></a>
<a name="8499"><span class="lineNum">    8499 </span>                :            :             QString( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; ) );</a>
<a name="8500"><span class="lineNum">    8500 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 5 ), QgsPoint( 0, 5, 5 ), QgsPoint( 5, 5, 0 ), QgsQuadrilateral::Projected ).toString( 2 ),</span></a>
<a name="8501"><span class="lineNum">    8501 </span>                :            :             QString( &quot;Quadrilateral (Point 1: PointZ (0 0 5), Point 2: PointZ (0 5 5), Point 3: PointZ (5 5 0), Point 4: PointZ (5 0 0))&quot; ) );</a>
<a name="8502"><span class="lineNum">    8502 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 5 ), QgsPoint( 0, 5, 5 ), QgsPoint( 5, 5, 10 ), QgsQuadrilateral::Projected ).toString( 2 ),</span></a>
<a name="8503"><span class="lineNum">    8503 </span>                :            :             QString( &quot;Quadrilateral (Point 1: PointZ (0 0 5), Point 2: PointZ (0 5 5), Point 3: PointZ (5 5 10), Point 4: PointZ (5 0 10))&quot; ) );</a>
<a name="8504"><span class="lineNum">    8504 </span>                :            : // toString</a>
<a name="8505"><span class="lineNum">    8505 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral( ).toString(), QString( &quot;Empty&quot; ) );</span></a>
<a name="8506"><span class="lineNum">    8506 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 2.5, 2.5 ) ).toString(), QString( &quot;Empty&quot; ) );</span></a>
<a name="8507"><span class="lineNum">    8507 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5 ), QgsPoint( 5, 0 ) ).toString(), QString( &quot;Quadrilateral (Point 1: Point (0 0), Point 2: Point (0 5), Point 3: Point (5 5), Point 4: Point (5 0))&quot; ) );</span></a>
<a name="8508"><span class="lineNum">    8508 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral::rectangleFromCenterPoint( QgsPoint( 2.5, 2.5, 10 ), QgsPoint( 5, 0 ) ).toString(), QString( &quot;Quadrilateral (Point 1: PointZ (0 0 10), Point 2: PointZ (0 5 10), Point 3: PointZ (5 5 10), Point 4: PointZ (5 0 10))&quot; ) );</span></a>
<a name="8509"><span class="lineNum">    8509 </span>                :            : </a>
<a name="8510"><span class="lineNum">    8510 </span>                :            : // toPolygon / toLineString</a>
<a name="8511"><span class="lineNum">    8511 </span>                :<span class="lineCov">          1 :   QCOMPARE( quad_init.toPolygon()-&gt;asWkt(), QgsPolygon().asWkt() );</span></a>
<a name="8512"><span class="lineNum">    8512 </span>                :<span class="lineCov">          1 :   QCOMPARE( quad_init.toLineString()-&gt;asWkt(), QgsLineString().asWkt() );</span></a>
<a name="8513"><span class="lineNum">    8513 </span>                :<span class="lineCov">          1 :   QgsLineString ext, extZ;</span></a>
<a name="8514"><span class="lineNum">    8514 </span>                :<span class="lineCov">          1 :   QgsPolygon polyg, polygZ;</span></a>
<a name="8515"><span class="lineNum">    8515 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quad( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), QgsPoint( 5, 5 ), QgsPoint( 5, 0 ) );</span></a>
<a name="8516"><span class="lineNum">    8516 </span>                :<span class="lineCov">          1 :   QgsQuadrilateral quadZ( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5, 10 ), QgsPoint( 5, 5, 10 ), QgsPoint( 5, 0, 10 ) );</span></a>
<a name="8517"><span class="lineNum">    8517 </span>                :<span class="lineCov">          1 :   ext.fromWkt( &quot;LineString (0 0, 0 5, 5 5, 5 0, 0 0)&quot; );</span></a>
<a name="8518"><span class="lineNum">    8518 </span>                :<span class="lineCov">          1 :   QCOMPARE( quad.toLineString()-&gt;asWkt(), ext.asWkt() );</span></a>
<a name="8519"><span class="lineNum">    8519 </span>                :<span class="lineCov">          1 :   polyg.fromWkt( &quot;Polygon ((0 0, 0 5, 5 5, 5 0, 0 0))&quot; );</span></a>
<a name="8520"><span class="lineNum">    8520 </span>                :<span class="lineCov">          1 :   QCOMPARE( quad.toPolygon()-&gt;asWkt(), polyg.asWkt() );</span></a>
<a name="8521"><span class="lineNum">    8521 </span>                :            : </a>
<a name="8522"><span class="lineNum">    8522 </span>                :<span class="lineCov">          1 :   extZ.fromWkt( &quot;LineStringZ (0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10)&quot; );</span></a>
<a name="8523"><span class="lineNum">    8523 </span>                :<span class="lineCov">          1 :   QCOMPARE( quadZ.toLineString()-&gt;asWkt(), extZ.asWkt() );</span></a>
<a name="8524"><span class="lineNum">    8524 </span>                :<span class="lineCov">          1 :   QCOMPARE( quadZ.toLineString( true )-&gt;asWkt(), ext.asWkt() );</span></a>
<a name="8525"><span class="lineNum">    8525 </span>                :<span class="lineCov">          1 :   polygZ.fromWkt( &quot;PolygonZ ((0 0 10, 0 5 10, 5 5 10, 5 0 10, 0 0 10))&quot; );</span></a>
<a name="8526"><span class="lineNum">    8526 </span>                :<span class="lineCov">          1 :   QCOMPARE( quadZ.toPolygon()-&gt;asWkt(), polygZ.asWkt() );</span></a>
<a name="8527"><span class="lineNum">    8527 </span>                :<span class="lineCov">          1 :   QCOMPARE( quadZ.toPolygon( true )-&gt;asWkt(), polyg.asWkt() );</span></a>
<a name="8528"><span class="lineNum">    8528 </span>                :            : </a>
<a name="8529"><span class="lineNum">    8529 </span>                :            : </a>
<a name="8530"><span class="lineNum">    8530 </span>                :            : // area / perimeter</a>
<a name="8531"><span class="lineNum">    8531 </span>                :            : </a>
<a name="8532"><span class="lineNum">    8532 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral().area(), 0.0 );</span></a>
<a name="8533"><span class="lineNum">    8533 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsQuadrilateral().perimeter(), 0.0 );</span></a>
<a name="8534"><span class="lineNum">    8534 </span>                :            : </a>
<a name="8535"><span class="lineNum">    8535 </span>                :<span class="lineCov">          1 :   QVERIFY( qgsDoubleNear( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5 ), QgsPoint( 5, 4 ), QgsQuadrilateral::Projected ).area(), 25.0 ) );</span></a>
<a name="8536"><span class="lineNum">    8536 </span>                :<span class="lineCov">          1 :   QVERIFY( qgsDoubleNear( QgsQuadrilateral::rectangleFrom3Points( QgsPoint( 0, 0, 10 ), QgsPoint( 0, 5 ), QgsPoint( 5, 4 ), QgsQuadrilateral::Projected ).perimeter(), 20 ) );</span></a>
<a name="8537"><span class="lineNum">    8537 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="8538"><span class="lineNum">    8538 </span>                :            : </a>
<a name="8539"><span class="lineNum">    8539 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::regularPolygon()</span></a>
<a name="8540"><span class="lineNum">    8540 </span>                :            : {</a>
<a name="8541"><span class="lineNum">    8541 </span>                :            :   // constructors</a>
<a name="8542"><span class="lineNum">    8542 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp1 = QgsRegularPolygon();</span></a>
<a name="8543"><span class="lineNum">    8543 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1.center().isEmpty() );</span></a>
<a name="8544"><span class="lineNum">    8544 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1.firstVertex().isEmpty() );</span></a>
<a name="8545"><span class="lineNum">    8545 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp1.numberSides(), static_cast&lt; unsigned int &gt;( 0 ) );</span></a>
<a name="8546"><span class="lineNum">    8546 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp1.radius(), 0.0 );</span></a>
<a name="8547"><span class="lineNum">    8547 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1.isEmpty() );</span></a>
<a name="8548"><span class="lineNum">    8548 </span>                :            : </a>
<a name="8549"><span class="lineNum">    8549 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp2;</span></a>
<a name="8550"><span class="lineNum">    8550 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 0, 2, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8551"><span class="lineNum">    8551 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2.isEmpty() );</span></a>
<a name="8552"><span class="lineNum">    8552 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 0, 5, static_cast&lt; QgsRegularPolygon::ConstructionOption &gt;( 4 ) );</span></a>
<a name="8553"><span class="lineNum">    8553 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2.isEmpty() );</span></a>
<a name="8554"><span class="lineNum">    8554 </span>                :            : </a>
<a name="8555"><span class="lineNum">    8555 </span>                :<span class="lineCov">          1 :   rp2 = QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 0, 5, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8556"><span class="lineNum">    8556 </span>                :<span class="lineCov">          1 :   QVERIFY( !rp2.isEmpty() );</span></a>
<a name="8557"><span class="lineNum">    8557 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.center(), QgsPoint( 0, 0 ) );</span></a>
<a name="8558"><span class="lineNum">    8558 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.firstVertex(), QgsPoint( 0, 5 ) );</span></a>
<a name="8559"><span class="lineNum">    8559 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.numberSides(), static_cast&lt; unsigned int&gt;( 5 ) );</span></a>
<a name="8560"><span class="lineNum">    8560 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.radius(), 5.0 );</span></a>
<a name="8561"><span class="lineNum">    8561 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp2.apothem(), 4.0451, 10E-4 );</span></a>
<a name="8562"><span class="lineNum">    8562 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2 ==  QgsRegularPolygon( QgsPoint( 0, 0 ), -5, 0, 5, QgsRegularPolygon::InscribedCircle ) );</span></a>
<a name="8563"><span class="lineNum">    8563 </span>                :            : </a>
<a name="8564"><span class="lineNum">    8564 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp3 = QgsRegularPolygon( QgsPoint( 0, 0 ), rp2.apothem(), 36.0, 5, QgsRegularPolygon::CircumscribedCircle );</span></a>
<a name="8565"><span class="lineNum">    8565 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2 == rp3 );</span></a>
<a name="8566"><span class="lineNum">    8566 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2 == QgsRegularPolygon( QgsPoint( 0, 0 ), -rp2.apothem(), 36.0, 5, QgsRegularPolygon::CircumscribedCircle ) );</span></a>
<a name="8567"><span class="lineNum">    8567 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1 != rp3 );</span></a>
<a name="8568"><span class="lineNum">    8568 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1 != QgsRegularPolygon( QgsPoint( 5, 5 ), rp2.apothem(), 36.0, 5, QgsRegularPolygon::CircumscribedCircle ) );</span></a>
<a name="8569"><span class="lineNum">    8569 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1 != QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 36.0, 5, QgsRegularPolygon::CircumscribedCircle ) );</span></a>
<a name="8570"><span class="lineNum">    8570 </span>                :<span class="lineCov">          1 :   QVERIFY( rp1 != QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 36.0, 5, QgsRegularPolygon::InscribedCircle ) );</span></a>
<a name="8571"><span class="lineNum">    8571 </span>                :            : </a>
<a name="8572"><span class="lineNum">    8572 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp4 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), 2, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8573"><span class="lineNum">    8573 </span>                :<span class="lineCov">          1 :   QVERIFY( rp4.isEmpty() );</span></a>
<a name="8574"><span class="lineNum">    8574 </span>                :<span class="lineCov">          1 :   rp4 = QgsRegularPolygon( QgsPoint(), QgsPoint( 0, 5 ), 5, static_cast&lt; QgsRegularPolygon::ConstructionOption &gt;( 4 ) );</span></a>
<a name="8575"><span class="lineNum">    8575 </span>                :<span class="lineCov">          1 :   QVERIFY( rp4.isEmpty() );</span></a>
<a name="8576"><span class="lineNum">    8576 </span>                :<span class="lineCov">          1 :   rp4 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), 5, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8577"><span class="lineNum">    8577 </span>                :<span class="lineCov">          1 :   QVERIFY( rp4 == rp2 );</span></a>
<a name="8578"><span class="lineNum">    8578 </span>                :            : </a>
<a name="8579"><span class="lineNum">    8579 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp5 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ).project( rp2.apothem(), 36.0 ), 2, QgsRegularPolygon::CircumscribedCircle );</span></a>
<a name="8580"><span class="lineNum">    8580 </span>                :<span class="lineCov">          1 :   QVERIFY( rp5.isEmpty() );</span></a>
<a name="8581"><span class="lineNum">    8581 </span>                :<span class="lineCov">          1 :   rp5 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ).project( rp2.apothem(), 36.0 ), 5, static_cast&lt; QgsRegularPolygon::ConstructionOption &gt;( 4 ) );</span></a>
<a name="8582"><span class="lineNum">    8582 </span>                :<span class="lineCov">          1 :   QVERIFY( rp5.isEmpty() );</span></a>
<a name="8583"><span class="lineNum">    8583 </span>                :<span class="lineCov">          1 :   rp5 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 0 ).project( rp2.apothem(), 36.0 ), 5, QgsRegularPolygon::CircumscribedCircle );</span></a>
<a name="8584"><span class="lineNum">    8584 </span>                :<span class="lineCov">          1 :   QVERIFY( rp5 == rp2 );</span></a>
<a name="8585"><span class="lineNum">    8585 </span>                :            : </a>
<a name="8586"><span class="lineNum">    8586 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp6 = QgsRegularPolygon( QgsPoint( 0, 5 ), QgsPoint( 0, 0 ).project( 5.0, 72 ), 5 );</span></a>
<a name="8587"><span class="lineNum">    8587 </span>                :<span class="lineCov">          1 :   QVERIFY( rp6 == rp2 );</span></a>
<a name="8588"><span class="lineNum">    8588 </span>                :            : </a>
<a name="8589"><span class="lineNum">    8589 </span>                :            : </a>
<a name="8590"><span class="lineNum">    8590 </span>                :            :   // setters and getters</a>
<a name="8591"><span class="lineNum">    8591 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp7 = QgsRegularPolygon();</span></a>
<a name="8592"><span class="lineNum">    8592 </span>                :            : </a>
<a name="8593"><span class="lineNum">    8593 </span>                :<span class="lineCov">          1 :   rp7.setCenter( QgsPoint( 5, 5 ) );</span></a>
<a name="8594"><span class="lineNum">    8594 </span>                :<span class="lineCov">          1 :   QVERIFY( rp7.isEmpty() );</span></a>
<a name="8595"><span class="lineNum">    8595 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.center(), QgsPoint( 5, 5 ) );</span></a>
<a name="8596"><span class="lineNum">    8596 </span>                :            : </a>
<a name="8597"><span class="lineNum">    8597 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 2 );</span></a>
<a name="8598"><span class="lineNum">    8598 </span>                :<span class="lineCov">          1 :   QVERIFY( rp7.isEmpty() );</span></a>
<a name="8599"><span class="lineNum">    8599 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.numberSides(), static_cast&lt; unsigned int &gt;( 0 ) );</span></a>
<a name="8600"><span class="lineNum">    8600 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 5 );</span></a>
<a name="8601"><span class="lineNum">    8601 </span>                :<span class="lineCov">          1 :   QVERIFY( rp7.isEmpty() );</span></a>
<a name="8602"><span class="lineNum">    8602 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.numberSides(), static_cast&lt; unsigned int &gt;( 5 ) );</span></a>
<a name="8603"><span class="lineNum">    8603 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 2 );</span></a>
<a name="8604"><span class="lineNum">    8604 </span>                :<span class="lineCov">          1 :   QVERIFY( rp7.isEmpty() );</span></a>
<a name="8605"><span class="lineNum">    8605 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.numberSides(), static_cast&lt; unsigned int &gt;( 5 ) );</span></a>
<a name="8606"><span class="lineNum">    8606 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 3 );</span></a>
<a name="8607"><span class="lineNum">    8607 </span>                :<span class="lineCov">          1 :   QVERIFY( rp7.isEmpty() );</span></a>
<a name="8608"><span class="lineNum">    8608 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.numberSides(), static_cast&lt; unsigned int &gt;( 3 ) );</span></a>
<a name="8609"><span class="lineNum">    8609 </span>                :            : </a>
<a name="8610"><span class="lineNum">    8610 </span>                :<span class="lineCov">          1 :   rp7.setRadius( -6 );</span></a>
<a name="8611"><span class="lineNum">    8611 </span>                :<span class="lineCov">          1 :   QVERIFY( !rp7.isEmpty() );</span></a>
<a name="8612"><span class="lineNum">    8612 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.radius(), 6.0 );</span></a>
<a name="8613"><span class="lineNum">    8613 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.firstVertex(), rp7.center().project( 6, 0 ) );</span></a>
<a name="8614"><span class="lineNum">    8614 </span>                :            : </a>
<a name="8615"><span class="lineNum">    8615 </span>                :<span class="lineCov">          1 :   rp7.setFirstVertex( QgsPoint( 4, 4 ) );</span></a>
<a name="8616"><span class="lineNum">    8616 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.firstVertex(), QgsPoint( 4, 4 ) );</span></a>
<a name="8617"><span class="lineNum">    8617 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.radius(), rp7.center().distance3D( QgsPoint( 4, 4 ) ) );</span></a>
<a name="8618"><span class="lineNum">    8618 </span>                :            : </a>
<a name="8619"><span class="lineNum">    8619 </span>                :<span class="lineCov">          1 :   rp7 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), 5, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8620"><span class="lineNum">    8620 </span>                :<span class="lineCov">          1 :   rp7.setCenter( QgsPoint( 5, 5 ) );</span></a>
<a name="8621"><span class="lineNum">    8621 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.radius(), 5.0 );</span></a>
<a name="8622"><span class="lineNum">    8622 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.firstVertex(), QgsPoint( 5, 10 ) );</span></a>
<a name="8623"><span class="lineNum">    8623 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 3 );</span></a>
<a name="8624"><span class="lineNum">    8624 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.radius(), 5.0 );</span></a>
<a name="8625"><span class="lineNum">    8625 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.firstVertex(), QgsPoint( 5, 10 ) );</span></a>
<a name="8626"><span class="lineNum">    8626 </span>                :<span class="lineCov">          1 :   rp7.setNumberSides( 2 );</span></a>
<a name="8627"><span class="lineNum">    8627 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.radius(), 5.0 );</span></a>
<a name="8628"><span class="lineNum">    8628 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp7.firstVertex(), QgsPoint( 5, 10 ) );</span></a>
<a name="8629"><span class="lineNum">    8629 </span>                :            : </a>
<a name="8630"><span class="lineNum">    8630 </span>                :            :   // measures</a>
<a name="8631"><span class="lineNum">    8631 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp1.length(), 0.0, 10e-4 );</span></a>
<a name="8632"><span class="lineNum">    8632 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp1.area(), 0.0, 10e-4 );</span></a>
<a name="8633"><span class="lineNum">    8633 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp1.perimeter(), 0.0, 10e-4 );</span></a>
<a name="8634"><span class="lineNum">    8634 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp2.length(), 5.8779, 10e-4 );</span></a>
<a name="8635"><span class="lineNum">    8635 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp2.area(), 59.4410, 10e-4 );</span></a>
<a name="8636"><span class="lineNum">    8636 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp2.perimeter(), 29.3893, 10e-4 );</span></a>
<a name="8637"><span class="lineNum">    8637 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.interiorAngle(), 108.0 );</span></a>
<a name="8638"><span class="lineNum">    8638 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.centralAngle(), 72.0 );</span></a>
<a name="8639"><span class="lineNum">    8639 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp8 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 5, 0 ), 5 );</span></a>
<a name="8640"><span class="lineNum">    8640 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( rp8.area(), 43.0119, 10e-4 );</span></a>
<a name="8641"><span class="lineNum">    8641 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.perimeter(), 25.0 );</span></a>
<a name="8642"><span class="lineNum">    8642 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.length(), 5.0 );</span></a>
<a name="8643"><span class="lineNum">    8643 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.interiorAngle(), 108.0 );</span></a>
<a name="8644"><span class="lineNum">    8644 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.centralAngle(), 72.0 );</span></a>
<a name="8645"><span class="lineNum">    8645 </span>                :<span class="lineCov">          1 :   rp8.setNumberSides( 4 );</span></a>
<a name="8646"><span class="lineNum">    8646 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.interiorAngle(), 90.0 );</span></a>
<a name="8647"><span class="lineNum">    8647 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.centralAngle(), 90.0 );</span></a>
<a name="8648"><span class="lineNum">    8648 </span>                :<span class="lineCov">          1 :   rp8.setNumberSides( 3 );</span></a>
<a name="8649"><span class="lineNum">    8649 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.interiorAngle(), 60.0 );</span></a>
<a name="8650"><span class="lineNum">    8650 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp8.centralAngle(), 120.0 );</span></a>
<a name="8651"><span class="lineNum">    8651 </span>                :            : </a>
<a name="8652"><span class="lineNum">    8652 </span>                :            :   //points</a>
<a name="8653"><span class="lineNum">    8653 </span>                :<span class="lineCov">          1 :   rp8 = QgsRegularPolygon(); // empty</span></a>
<a name="8654"><span class="lineNum">    8654 </span>                :<span class="lineCov">          1 :   QgsPointSequence points = rp8.points();</span></a>
<a name="8655"><span class="lineNum">    8655 </span>                :<span class="lineCov">          1 :   QVERIFY( points.isEmpty() );</span></a>
<a name="8656"><span class="lineNum">    8656 </span>                :<span class="lineCov">          1 :   rp8 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), 3, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8657"><span class="lineNum">    8657 </span>                :<span class="lineCov">          1 :   points = rp8.points();</span></a>
<a name="8658"><span class="lineNum">    8658 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 3 );</span></a>
<a name="8659"><span class="lineNum">    8659 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 0 ), QgsPoint( 0, 5 ) );</span></a>
<a name="8660"><span class="lineNum">    8660 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( points.at( 1 ).x(), 4.33, 0.01 );</span></a>
<a name="8661"><span class="lineNum">    8661 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( points.at( 1 ).y(), -2.4999, 0.01 );</span></a>
<a name="8662"><span class="lineNum">    8662 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( points.at( 2 ).x(), -4.33, 0.01 );</span></a>
<a name="8663"><span class="lineNum">    8663 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( points.at( 2 ).y(), -2.4999, 0.01 );</span></a>
<a name="8664"><span class="lineNum">    8664 </span>                :            : </a>
<a name="8665"><span class="lineNum">    8665 </span>                :            :   //test conversions</a>
<a name="8666"><span class="lineNum">    8666 </span>                :            :   // circle</a>
<a name="8667"><span class="lineNum">    8667 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle( QgsPoint( 0, 0 ), 5 ) == rp2.circumscribedCircle() );</span></a>
<a name="8668"><span class="lineNum">    8668 </span>                :<span class="lineCov">          1 :   QVERIFY( rp2.inscribedCircle() == QgsRegularPolygon( QgsPoint( 0, 0 ), rp2.apothem(), 36.0, 5, QgsRegularPolygon::InscribedCircle ).circumscribedCircle() );</span></a>
<a name="8669"><span class="lineNum">    8669 </span>                :            : </a>
<a name="8670"><span class="lineNum">    8670 </span>                :            :   // triangle</a>
<a name="8671"><span class="lineNum">    8671 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsTriangle(), rp2.toTriangle() );</span></a>
<a name="8672"><span class="lineNum">    8672 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsTriangle(), QgsRegularPolygon().toTriangle() );</span></a>
<a name="8673"><span class="lineNum">    8673 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp9 = QgsRegularPolygon( QgsPoint( 0, 0 ), 5, 0, 3, QgsRegularPolygon::InscribedCircle );</span></a>
<a name="8674"><span class="lineNum">    8674 </span>                :            : </a>
<a name="8675"><span class="lineNum">    8675 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircle( QgsPoint( 0, 0 ), 5 ) == rp9.toTriangle().circumscribedCircle() );</span></a>
<a name="8676"><span class="lineNum">    8676 </span>                :            : </a>
<a name="8677"><span class="lineNum">    8677 </span>                :<span class="lineCov">          1 :   QgsRegularPolygon rp10 = QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 4 ), 4 );</span></a>
<a name="8678"><span class="lineNum">    8678 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsTriangle&gt; rp10_tri = rp10.triangulate();</span></a>
<a name="8679"><span class="lineNum">    8679 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp10_tri.length(), static_cast&lt; int &gt;( rp10.numberSides() ) );</span></a>
<a name="8680"><span class="lineNum">    8680 </span>                :<span class="lineCov">          1 :   QVERIFY( rp10_tri.at( 0 ) == QgsTriangle( QgsPoint( 0, 0 ), QgsPoint( 0, 4 ), rp10.center() ) );</span></a>
<a name="8681"><span class="lineNum">    8681 </span>                :<span class="lineCov">          1 :   QVERIFY( rp10_tri.at( 1 ) == QgsTriangle( QgsPoint( 0, 4 ), QgsPoint( 4, 4 ), rp10.center() ) );</span></a>
<a name="8682"><span class="lineNum">    8682 </span>                :<span class="lineCov">          1 :   QVERIFY( rp10_tri.at( 2 ) == QgsTriangle( QgsPoint( 4, 4 ), QgsPoint( 4, 0 ), rp10.center() ) );</span></a>
<a name="8683"><span class="lineNum">    8683 </span>                :<span class="lineCov">          1 :   QVERIFY( rp10_tri.at( 3 ) == QgsTriangle( QgsPoint( 4, 0 ), QgsPoint( 0, 0 ), rp10.center() ) );</span></a>
<a name="8684"><span class="lineNum">    8684 </span>                :            : </a>
<a name="8685"><span class="lineNum">    8685 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsRegularPolygon().triangulate().isEmpty() );</span></a>
<a name="8686"><span class="lineNum">    8686 </span>                :            : </a>
<a name="8687"><span class="lineNum">    8687 </span>                :            :   // polygon</a>
<a name="8688"><span class="lineNum">    8688 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; toP( QgsRegularPolygon().toPolygon() );</span></a>
<a name="8689"><span class="lineNum">    8689 </span>                :<span class="lineCov">          1 :   QVERIFY( toP-&gt;isEmpty() );</span></a>
<a name="8690"><span class="lineNum">    8690 </span>                :            : </a>
<a name="8691"><span class="lineNum">    8691 </span>                :<span class="lineCov">          1 :   QgsPointSequence ptsPol;</span></a>
<a name="8692"><span class="lineNum">    8692 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; pol( new QgsPolygon() );</span></a>
<a name="8693"><span class="lineNum">    8693 </span>                :<span class="lineCov">          1 :   pol.reset( rp10.toPolygon() );</span></a>
<a name="8694"><span class="lineNum">    8694 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;numInteriorRings(), 0 );</span></a>
<a name="8695"><span class="lineNum">    8695 </span>                :<span class="lineCov">          1 :   QCOMPARE( pol-&gt;exteriorRing()-&gt;numPoints(), 5 );</span></a>
<a name="8696"><span class="lineNum">    8696 </span>                :            : </a>
<a name="8697"><span class="lineNum">    8697 </span>                :<span class="lineCov">          1 :   pol-&gt;exteriorRing()-&gt;points( ptsPol );</span></a>
<a name="8698"><span class="lineNum">    8698 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol.length(), 5 );</span></a>
<a name="8699"><span class="lineNum">    8699 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 0 ) == QgsPoint( 0, 0 ) );</span></a>
<a name="8700"><span class="lineNum">    8700 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 1 ) == QgsPoint( 0, 4 ) );</span></a>
<a name="8701"><span class="lineNum">    8701 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 2 ) == QgsPoint( 4, 4 ) );</span></a>
<a name="8702"><span class="lineNum">    8702 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 3 ) == QgsPoint( 4, 0 ) );</span></a>
<a name="8703"><span class="lineNum">    8703 </span>                :<span class="lineCov">          1 :   QVERIFY( ptsPol.at( 4 ) == QgsPoint( 0, 0 ) );</span></a>
<a name="8704"><span class="lineNum">    8704 </span>                :<span class="lineCov">          1 :   ptsPol.pop_back();</span></a>
<a name="8705"><span class="lineNum">    8705 </span>                :            : </a>
<a name="8706"><span class="lineNum">    8706 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsLineString &gt; l( QgsRegularPolygon( QgsPoint( 0, 0 ), QgsPoint( 0, 5 ), 1, QgsRegularPolygon::InscribedCircle ).toLineString() );</span></a>
<a name="8707"><span class="lineNum">    8707 </span>                :<span class="lineCov">          1 :   QVERIFY( l-&gt;isEmpty() );</span></a>
<a name="8708"><span class="lineNum">    8708 </span>                :<span class="lineCov">          1 :   l.reset( rp10.toLineString( ) );</span></a>
<a name="8709"><span class="lineNum">    8709 </span>                :<span class="lineCov">          1 :   QCOMPARE( l-&gt;numPoints(), 5 );</span></a>
<a name="8710"><span class="lineNum">    8710 </span>                :<span class="lineCov">          1 :   QCOMPARE( l-&gt;pointN( 0 ), l-&gt;pointN( 4 ) );</span></a>
<a name="8711"><span class="lineNum">    8711 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts_l;</span></a>
<a name="8712"><span class="lineNum">    8712 </span>                :<span class="lineCov">          1 :   l-&gt;points( pts_l );</span></a>
<a name="8713"><span class="lineNum">    8713 </span>                :<span class="lineCov">          1 :   pts_l.pop_back();</span></a>
<a name="8714"><span class="lineNum">    8714 </span>                :<span class="lineCov">          1 :   QCOMPARE( ptsPol, pts_l );</span></a>
<a name="8715"><span class="lineNum">    8715 </span>                :            : </a>
<a name="8716"><span class="lineNum">    8716 </span>                :            :   //test toString</a>
<a name="8717"><span class="lineNum">    8717 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp1.toString(), QString( &quot;Empty&quot; ) );</span></a>
<a name="8718"><span class="lineNum">    8718 </span>                :<span class="lineCov">          1 :   QCOMPARE( rp2.toString(), QString( &quot;RegularPolygon (Center: Point (0 0), First Vertex: Point (0 5), Radius: 5, Azimuth: 0)&quot; ) );</span></a>
<a name="8719"><span class="lineNum">    8719 </span>                :            : </a>
<a name="8720"><span class="lineNum">    8720 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="8721"><span class="lineNum">    8721 </span>                :            : </a>
<a name="8722"><span class="lineNum">    8722 </span>                :            : </a>
<a name="8723"><span class="lineNum">    8723 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::curvePolygon()</span></a>
<a name="8724"><span class="lineNum">    8724 </span>                :            : {</a>
<a name="8725"><span class="lineNum">    8725 </span>                :            :   //test constructor</a>
<a name="8726"><span class="lineNum">    8726 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p1;</span></a>
<a name="8727"><span class="lineNum">    8727 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="8728"><span class="lineNum">    8728 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="8729"><span class="lineNum">    8729 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="8730"><span class="lineNum">    8730 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 0 );</span></a>
<a name="8731"><span class="lineNum">    8731 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 0 );</span></a>
<a name="8732"><span class="lineNum">    8732 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.is3D() );</span></a>
<a name="8733"><span class="lineNum">    8733 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isMeasure() );</span></a>
<a name="8734"><span class="lineNum">    8734 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8735"><span class="lineNum">    8735 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wktTypeStr(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="8736"><span class="lineNum">    8736 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="8737"><span class="lineNum">    8737 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.dimension(), 2 );</span></a>
<a name="8738"><span class="lineNum">    8738 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.hasCurvedSegments() );</span></a>
<a name="8739"><span class="lineNum">    8739 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.area(), 0.0 );</span></a>
<a name="8740"><span class="lineNum">    8740 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.perimeter(), 0.0 );</span></a>
<a name="8741"><span class="lineNum">    8741 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.exteriorRing() );</span></a>
<a name="8742"><span class="lineNum">    8742 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="8743"><span class="lineNum">    8743 </span>                :            : </a>
<a name="8744"><span class="lineNum">    8744 </span>                :            :   //set exterior ring</a>
<a name="8745"><span class="lineNum">    8745 </span>                :            : </a>
<a name="8746"><span class="lineNum">    8746 </span>                :            :   //try with no ring</a>
<a name="8747"><span class="lineNum">    8747 </span>                :<span class="lineCov">          1 :   QgsCircularString *ext = nullptr;</span></a>
<a name="8748"><span class="lineNum">    8748 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="8749"><span class="lineNum">    8749 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="8750"><span class="lineNum">    8750 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="8751"><span class="lineNum">    8751 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="8752"><span class="lineNum">    8752 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 0 );</span></a>
<a name="8753"><span class="lineNum">    8753 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 0 );</span></a>
<a name="8754"><span class="lineNum">    8754 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.exteriorRing() );</span></a>
<a name="8755"><span class="lineNum">    8755 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="8756"><span class="lineNum">    8756 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8757"><span class="lineNum">    8757 </span>                :            : </a>
<a name="8758"><span class="lineNum">    8758 </span>                :            :   // empty exterior ring</a>
<a name="8759"><span class="lineNum">    8759 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8760"><span class="lineNum">    8760 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="8761"><span class="lineNum">    8761 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.isEmpty() );</span></a>
<a name="8762"><span class="lineNum">    8762 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="8763"><span class="lineNum">    8763 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 0 );</span></a>
<a name="8764"><span class="lineNum">    8764 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 1 );</span></a>
<a name="8765"><span class="lineNum">    8765 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 1 );</span></a>
<a name="8766"><span class="lineNum">    8766 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.exteriorRing() );</span></a>
<a name="8767"><span class="lineNum">    8767 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="8768"><span class="lineNum">    8768 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8769"><span class="lineNum">    8769 </span>                :            : </a>
<a name="8770"><span class="lineNum">    8770 </span>                :            :   //valid exterior ring</a>
<a name="8771"><span class="lineNum">    8771 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8772"><span class="lineNum">    8772 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="8773"><span class="lineNum">    8773 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="8774"><span class="lineNum">    8774 </span>                :<span class="lineCov">          1 :   p1.setExteriorRing( ext );</span></a>
<a name="8775"><span class="lineNum">    8775 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isEmpty() );</span></a>
<a name="8776"><span class="lineNum">    8776 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.numInteriorRings(), 0 );</span></a>
<a name="8777"><span class="lineNum">    8777 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.nCoordinates(), 5 );</span></a>
<a name="8778"><span class="lineNum">    8778 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.ringCount(), 1 );</span></a>
<a name="8779"><span class="lineNum">    8779 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.partCount(), 1 );</span></a>
<a name="8780"><span class="lineNum">    8780 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.is3D() );</span></a>
<a name="8781"><span class="lineNum">    8781 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.isMeasure() );</span></a>
<a name="8782"><span class="lineNum">    8782 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8783"><span class="lineNum">    8783 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.wktTypeStr(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="8784"><span class="lineNum">    8784 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="8785"><span class="lineNum">    8785 </span>                :<span class="lineCov">          1 :   QCOMPARE( p1.dimension(), 2 );</span></a>
<a name="8786"><span class="lineNum">    8786 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.hasCurvedSegments() );</span></a>
<a name="8787"><span class="lineNum">    8787 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p1.area(), 157.08, 0.01 );</span></a>
<a name="8788"><span class="lineNum">    8788 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p1.perimeter(), 44.4288, 0.01 );</span></a>
<a name="8789"><span class="lineNum">    8789 </span>                :<span class="lineCov">          1 :   QVERIFY( p1.exteriorRing() );</span></a>
<a name="8790"><span class="lineNum">    8790 </span>                :<span class="lineCov">          1 :   QVERIFY( !p1.interiorRing( 0 ) );</span></a>
<a name="8791"><span class="lineNum">    8791 </span>                :            : </a>
<a name="8792"><span class="lineNum">    8792 </span>                :            :   //retrieve exterior ring and check</a>
<a name="8793"><span class="lineNum">    8793 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( p1.exteriorRing() ) ), *ext );</span></a>
<a name="8794"><span class="lineNum">    8794 </span>                :            : </a>
<a name="8795"><span class="lineNum">    8795 </span>                :            :   //initial setting of exterior ring should set z/m type</a>
<a name="8796"><span class="lineNum">    8796 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p2;</span></a>
<a name="8797"><span class="lineNum">    8797 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8798"><span class="lineNum">    8798 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="8799"><span class="lineNum">    8799 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="8800"><span class="lineNum">    8800 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="8801"><span class="lineNum">    8801 </span>                :<span class="lineCov">          1 :   p2.setExteriorRing( ext );</span></a>
<a name="8802"><span class="lineNum">    8802 </span>                :<span class="lineCov">          1 :   QVERIFY( p2.is3D() );</span></a>
<a name="8803"><span class="lineNum">    8803 </span>                :<span class="lineCov">          1 :   QVERIFY( !p2.isMeasure() );</span></a>
<a name="8804"><span class="lineNum">    8804 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="8805"><span class="lineNum">    8805 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.wktTypeStr(), QString( &quot;CurvePolygonZ&quot; ) );</span></a>
<a name="8806"><span class="lineNum">    8806 </span>                :<span class="lineCov">          1 :   QCOMPARE( p2.geometryType(), QString( &quot;CurvePolygon&quot; ) );</span></a>
<a name="8807"><span class="lineNum">    8807 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( p2.exteriorRing() ) ), *ext );</span></a>
<a name="8808"><span class="lineNum">    8808 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p3;</span></a>
<a name="8809"><span class="lineNum">    8809 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8810"><span class="lineNum">    8810 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="8811"><span class="lineNum">    8811 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="8812"><span class="lineNum">    8812 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="8813"><span class="lineNum">    8813 </span>                :<span class="lineCov">          1 :   p3.setExteriorRing( ext );</span></a>
<a name="8814"><span class="lineNum">    8814 </span>                :<span class="lineCov">          1 :   QVERIFY( !p3.is3D() );</span></a>
<a name="8815"><span class="lineNum">    8815 </span>                :<span class="lineCov">          1 :   QVERIFY( p3.isMeasure() );</span></a>
<a name="8816"><span class="lineNum">    8816 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="8817"><span class="lineNum">    8817 </span>                :<span class="lineCov">          1 :   QCOMPARE( p3.wktTypeStr(), QString( &quot;CurvePolygonM&quot; ) );</span></a>
<a name="8818"><span class="lineNum">    8818 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( p3.exteriorRing() ) ), *ext );</span></a>
<a name="8819"><span class="lineNum">    8819 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p4;</span></a>
<a name="8820"><span class="lineNum">    8820 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8821"><span class="lineNum">    8821 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 )</span></a>
<a name="8822"><span class="lineNum">    8822 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 3, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 5, 3 )</span></a>
<a name="8823"><span class="lineNum">    8823 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 ) );</span></a>
<a name="8824"><span class="lineNum">    8824 </span>                :<span class="lineCov">          1 :   p4.setExteriorRing( ext );</span></a>
<a name="8825"><span class="lineNum">    8825 </span>                :<span class="lineCov">          1 :   QVERIFY( p4.is3D() );</span></a>
<a name="8826"><span class="lineNum">    8826 </span>                :<span class="lineCov">          1 :   QVERIFY( p4.isMeasure() );</span></a>
<a name="8827"><span class="lineNum">    8827 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="8828"><span class="lineNum">    8828 </span>                :<span class="lineCov">          1 :   QCOMPARE( p4.wktTypeStr(), QString( &quot;CurvePolygonZM&quot; ) );</span></a>
<a name="8829"><span class="lineNum">    8829 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( p4.exteriorRing() ) ), *ext );</span></a>
<a name="8830"><span class="lineNum">    8830 </span>                :            : </a>
<a name="8831"><span class="lineNum">    8831 </span>                :            :   //addInteriorRing</a>
<a name="8832"><span class="lineNum">    8832 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p6;</span></a>
<a name="8833"><span class="lineNum">    8833 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8834"><span class="lineNum">    8834 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="8835"><span class="lineNum">    8835 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="8836"><span class="lineNum">    8836 </span>                :<span class="lineCov">          1 :   p6.setExteriorRing( ext );</span></a>
<a name="8837"><span class="lineNum">    8837 </span>                :            :   //empty ring</a>
<a name="8838"><span class="lineNum">    8838 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 0 );</span></a>
<a name="8839"><span class="lineNum">    8839 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( -1 ) );</span></a>
<a name="8840"><span class="lineNum">    8840 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 0 ) );</span></a>
<a name="8841"><span class="lineNum">    8841 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( nullptr );</span></a>
<a name="8842"><span class="lineNum">    8842 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 0 );</span></a>
<a name="8843"><span class="lineNum">    8843 </span>                :<span class="lineCov">          1 :   QgsCircularString *ring = new QgsCircularString();</span></a>
<a name="8844"><span class="lineNum">    8844 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="8845"><span class="lineNum">    8845 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="8846"><span class="lineNum">    8846 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="8847"><span class="lineNum">    8847 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 1 );</span></a>
<a name="8848"><span class="lineNum">    8848 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 0 ), ring );</span></a>
<a name="8849"><span class="lineNum">    8849 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 1 ) );</span></a>
<a name="8850"><span class="lineNum">    8850 </span>                :            : </a>
<a name="8851"><span class="lineNum">    8851 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence seq = p6.coordinateSequence();</span></a>
<a name="8852"><span class="lineNum">    8852 </span>                :<span class="lineCov">          1 :   QCOMPARE( seq, QgsCoordinateSequence() &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="8853"><span class="lineNum">    8853 </span>                :            :             &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) )</a>
<a name="8854"><span class="lineNum">    8854 </span>                :            :             &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</a>
<a name="8855"><span class="lineNum">    8855 </span>                :            :                  &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) ) ) );</a>
<a name="8856"><span class="lineNum">    8856 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.nCoordinates(), 10 );</span></a>
<a name="8857"><span class="lineNum">    8857 </span>                :            : </a>
<a name="8858"><span class="lineNum">    8858 </span>                :            :   //try adding an interior ring with z to a 2d polygon, z should be dropped</a>
<a name="8859"><span class="lineNum">    8859 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="8860"><span class="lineNum">    8860 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="8861"><span class="lineNum">    8861 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="8862"><span class="lineNum">    8862 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="8863"><span class="lineNum">    8863 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="8864"><span class="lineNum">    8864 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 2 );</span></a>
<a name="8865"><span class="lineNum">    8865 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.is3D() );</span></a>
<a name="8866"><span class="lineNum">    8866 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.isMeasure() );</span></a>
<a name="8867"><span class="lineNum">    8867 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8868"><span class="lineNum">    8868 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.interiorRing( 1 ) );</span></a>
<a name="8869"><span class="lineNum">    8869 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="8870"><span class="lineNum">    8870 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="8871"><span class="lineNum">    8871 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8872"><span class="lineNum">    8872 </span>                :            : </a>
<a name="8873"><span class="lineNum">    8873 </span>                :            :   //try adding an interior ring with m to a 2d polygon, m should be dropped</a>
<a name="8874"><span class="lineNum">    8874 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="8875"><span class="lineNum">    8875 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 )</span></a>
<a name="8876"><span class="lineNum">    8876 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.2, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.2, 0, 3 )</span></a>
<a name="8877"><span class="lineNum">    8877 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0.1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.1, 0, 1 ) );</span></a>
<a name="8878"><span class="lineNum">    8878 </span>                :<span class="lineCov">          1 :   p6.addInteriorRing( ring );</span></a>
<a name="8879"><span class="lineNum">    8879 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.numInteriorRings(), 3 );</span></a>
<a name="8880"><span class="lineNum">    8880 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.is3D() );</span></a>
<a name="8881"><span class="lineNum">    8881 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.isMeasure() );</span></a>
<a name="8882"><span class="lineNum">    8882 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="8883"><span class="lineNum">    8883 </span>                :<span class="lineCov">          1 :   QVERIFY( p6.interiorRing( 2 ) );</span></a>
<a name="8884"><span class="lineNum">    8884 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="8885"><span class="lineNum">    8885 </span>                :<span class="lineCov">          1 :   QVERIFY( !p6.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="8886"><span class="lineNum">    8886 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8887"><span class="lineNum">    8887 </span>                :            : </a>
<a name="8888"><span class="lineNum">    8888 </span>                :            : </a>
<a name="8889"><span class="lineNum">    8889 </span>                :            :   //addInteriorRing without z/m to PolygonZM</a>
<a name="8890"><span class="lineNum">    8890 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p6b;</span></a>
<a name="8891"><span class="lineNum">    8891 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8892"><span class="lineNum">    8892 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 )</span></a>
<a name="8893"><span class="lineNum">    8893 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3 )</span></a>
<a name="8894"><span class="lineNum">    8894 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1 ) );</span></a>
<a name="8895"><span class="lineNum">    8895 </span>                :<span class="lineCov">          1 :   p6b.setExteriorRing( ext );</span></a>
<a name="8896"><span class="lineNum">    8896 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.is3D() );</span></a>
<a name="8897"><span class="lineNum">    8897 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.isMeasure() );</span></a>
<a name="8898"><span class="lineNum">    8898 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="8899"><span class="lineNum">    8899 </span>                :            :   //ring has no z</a>
<a name="8900"><span class="lineNum">    8900 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="8901"><span class="lineNum">    8901 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 9 )</span></a>
<a name="8902"><span class="lineNum">    8902 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1 ) );</span></a>
<a name="8903"><span class="lineNum">    8903 </span>                :<span class="lineCov">          1 :   p6b.addInteriorRing( ring );</span></a>
<a name="8904"><span class="lineNum">    8904 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 ) );</span></a>
<a name="8905"><span class="lineNum">    8905 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="8906"><span class="lineNum">    8906 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="8907"><span class="lineNum">    8907 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="8908"><span class="lineNum">    8908 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 0, 2 ) );</span></a>
<a name="8909"><span class="lineNum">    8909 </span>                :            :   //ring has no m</a>
<a name="8910"><span class="lineNum">    8910 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="8911"><span class="lineNum">    8911 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="8912"><span class="lineNum">    8912 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="8913"><span class="lineNum">    8913 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="8914"><span class="lineNum">    8914 </span>                :<span class="lineCov">          1 :   p6b.addInteriorRing( ring );</span></a>
<a name="8915"><span class="lineNum">    8915 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 ) );</span></a>
<a name="8916"><span class="lineNum">    8916 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="8917"><span class="lineNum">    8917 </span>                :<span class="lineCov">          1 :   QVERIFY( p6b.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="8918"><span class="lineNum">    8918 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularStringZM );</span></a>
<a name="8919"><span class="lineNum">    8919 </span>                :<span class="lineCov">          1 :   QCOMPARE( p6b.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.1, 1, 0 ) );</span></a>
<a name="8920"><span class="lineNum">    8920 </span>                :            : </a>
<a name="8921"><span class="lineNum">    8921 </span>                :            :   //set interior rings</a>
<a name="8922"><span class="lineNum">    8922 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p7;</span></a>
<a name="8923"><span class="lineNum">    8923 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8924"><span class="lineNum">    8924 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="8925"><span class="lineNum">    8925 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="8926"><span class="lineNum">    8926 </span>                :<span class="lineCov">          1 :   p7.setExteriorRing( ext );</span></a>
<a name="8927"><span class="lineNum">    8927 </span>                :            :   //add a list of rings with mixed types</a>
<a name="8928"><span class="lineNum">    8928 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsCurve * &gt; rings;</span></a>
<a name="8929"><span class="lineNum">    8929 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8930"><span class="lineNum">    8930 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="8931"><span class="lineNum">    8931 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="8932"><span class="lineNum">    8932 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="8933"><span class="lineNum">    8933 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8934"><span class="lineNum">    8934 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 )</span></a>
<a name="8935"><span class="lineNum">    8935 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.4, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.4, 0, 3 )</span></a>
<a name="8936"><span class="lineNum">    8936 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.4, 0.3, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.3, 0.3, 0, 1 ) );</span></a>
<a name="8937"><span class="lineNum">    8937 </span>                :            :   //throw an empty ring in too</a>
<a name="8938"><span class="lineNum">    8938 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; 0;</span></a>
<a name="8939"><span class="lineNum">    8939 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8940"><span class="lineNum">    8940 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[3] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="8941"><span class="lineNum">    8941 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="8942"><span class="lineNum">    8942 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="8943"><span class="lineNum">    8943 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 3 );</span></a>
<a name="8944"><span class="lineNum">    8944 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 0 ) );</span></a>
<a name="8945"><span class="lineNum">    8945 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="8946"><span class="lineNum">    8946 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="8947"><span class="lineNum">    8947 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8948"><span class="lineNum">    8948 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.1, 0.1 ) );</span></a>
<a name="8949"><span class="lineNum">    8949 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 1 ) );</span></a>
<a name="8950"><span class="lineNum">    8950 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="8951"><span class="lineNum">    8951 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="8952"><span class="lineNum">    8952 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 1 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8953"><span class="lineNum">    8953 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.3, 0.3 ) );</span></a>
<a name="8954"><span class="lineNum">    8954 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 2 ) );</span></a>
<a name="8955"><span class="lineNum">    8955 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 2 )-&gt;is3D() );</span></a>
<a name="8956"><span class="lineNum">    8956 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 2 )-&gt;isMeasure() );</span></a>
<a name="8957"><span class="lineNum">    8957 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 2 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8958"><span class="lineNum">    8958 </span>                :            : </a>
<a name="8959"><span class="lineNum">    8959 </span>                :            :   //set rings with existing</a>
<a name="8960"><span class="lineNum">    8960 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="8961"><span class="lineNum">    8961 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8962"><span class="lineNum">    8962 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="8963"><span class="lineNum">    8963 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="8964"><span class="lineNum">    8964 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="8965"><span class="lineNum">    8965 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="8966"><span class="lineNum">    8966 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 1 );</span></a>
<a name="8967"><span class="lineNum">    8967 </span>                :<span class="lineCov">          1 :   QVERIFY( p7.interiorRing( 0 ) );</span></a>
<a name="8968"><span class="lineNum">    8968 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="8969"><span class="lineNum">    8969 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="8970"><span class="lineNum">    8970 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::CircularString );</span></a>
<a name="8971"><span class="lineNum">    8971 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::Point, 0.8, 0.8 ) );</span></a>
<a name="8972"><span class="lineNum">    8972 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="8973"><span class="lineNum">    8973 </span>                :<span class="lineCov">          1 :   p7.setInteriorRings( rings );</span></a>
<a name="8974"><span class="lineNum">    8974 </span>                :<span class="lineCov">          1 :   QCOMPARE( p7.numInteriorRings(), 0 );</span></a>
<a name="8975"><span class="lineNum">    8975 </span>                :            : </a>
<a name="8976"><span class="lineNum">    8976 </span>                :            :   //change dimensionality of interior rings using setExteriorRing</a>
<a name="8977"><span class="lineNum">    8977 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p7a;</span></a>
<a name="8978"><span class="lineNum">    8978 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="8979"><span class="lineNum">    8979 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 )</span></a>
<a name="8980"><span class="lineNum">    8980 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="8981"><span class="lineNum">    8981 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="8982"><span class="lineNum">    8982 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="8983"><span class="lineNum">    8983 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8984"><span class="lineNum">    8984 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 )</span></a>
<a name="8985"><span class="lineNum">    8985 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.2, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.2, 3 )</span></a>
<a name="8986"><span class="lineNum">    8986 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.2, 0.1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.1, 0.1, 1 ) );</span></a>
<a name="8987"><span class="lineNum">    8987 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="8988"><span class="lineNum">    8988 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3, 1 )</span></a>
<a name="8989"><span class="lineNum">    8989 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.4, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.4, 3 )</span></a>
<a name="8990"><span class="lineNum">    8990 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.4, 0.3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0.3, 0.3,  1 ) );</span></a>
<a name="8991"><span class="lineNum">    8991 </span>                :<span class="lineCov">          1 :   p7a.setInteriorRings( rings );</span></a>
<a name="8992"><span class="lineNum">    8992 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.is3D() );</span></a>
<a name="8993"><span class="lineNum">    8993 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.isMeasure() );</span></a>
<a name="8994"><span class="lineNum">    8994 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 0 )-&gt;is3D() );</span></a>
<a name="8995"><span class="lineNum">    8995 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 0 )-&gt;isMeasure() );</span></a>
<a name="8996"><span class="lineNum">    8996 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="8997"><span class="lineNum">    8997 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="8998"><span class="lineNum">    8998 </span>                :            :   //reset exterior ring to 2d</a>
<a name="8999"><span class="lineNum">    8999 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9000"><span class="lineNum">    9000 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 )</span></a>
<a name="9001"><span class="lineNum">    9001 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9002"><span class="lineNum">    9002 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="9003"><span class="lineNum">    9003 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.is3D() );</span></a>
<a name="9004"><span class="lineNum">    9004 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 0 )-&gt;is3D() ); //rings should also be made 2D</span></a>
<a name="9005"><span class="lineNum">    9005 </span>                :<span class="lineCov">          1 :   QVERIFY( !p7a.interiorRing( 1 )-&gt;is3D() );</span></a>
<a name="9006"><span class="lineNum">    9006 </span>                :            :   //reset exterior ring to LineStringM</a>
<a name="9007"><span class="lineNum">    9007 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9008"><span class="lineNum">    9008 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10 )</span></a>
<a name="9009"><span class="lineNum">    9009 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0 ) );</span></a>
<a name="9010"><span class="lineNum">    9010 </span>                :<span class="lineCov">          1 :   p7a.setExteriorRing( ext );</span></a>
<a name="9011"><span class="lineNum">    9011 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.isMeasure() );</span></a>
<a name="9012"><span class="lineNum">    9012 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 0 )-&gt;isMeasure() ); //rings should also gain measure</span></a>
<a name="9013"><span class="lineNum">    9013 </span>                :<span class="lineCov">          1 :   QVERIFY( p7a.interiorRing( 1 )-&gt;isMeasure() );</span></a>
<a name="9014"><span class="lineNum">    9014 </span>                :            : </a>
<a name="9015"><span class="lineNum">    9015 </span>                :            :   //removeInteriorRing</a>
<a name="9016"><span class="lineNum">    9016 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p8;</span></a>
<a name="9017"><span class="lineNum">    9017 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9018"><span class="lineNum">    9018 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="9019"><span class="lineNum">    9019 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9020"><span class="lineNum">    9020 </span>                :<span class="lineCov">          1 :   p8.setExteriorRing( ext );</span></a>
<a name="9021"><span class="lineNum">    9021 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( -1 ) );</span></a>
<a name="9022"><span class="lineNum">    9022 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( 0 ) );</span></a>
<a name="9023"><span class="lineNum">    9023 </span>                :<span class="lineCov">          1 :   rings.clear();</span></a>
<a name="9024"><span class="lineNum">    9024 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="9025"><span class="lineNum">    9025 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[0] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 )</span></a>
<a name="9026"><span class="lineNum">    9026 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.1, 0.2 ) &lt;&lt; QgsPoint( 0.2, 0.2 )</span></a>
<a name="9027"><span class="lineNum">    9027 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="9028"><span class="lineNum">    9028 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="9029"><span class="lineNum">    9029 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[1] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.3, 0.3 )</span></a>
<a name="9030"><span class="lineNum">    9030 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.3, 0.4 ) &lt;&lt; QgsPoint( 0.4, 0.4 )</span></a>
<a name="9031"><span class="lineNum">    9031 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.4, 0.3 ) &lt;&lt; QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="9032"><span class="lineNum">    9032 </span>                :<span class="lineCov">          1 :   rings &lt;&lt; new QgsCircularString();</span></a>
<a name="9033"><span class="lineNum">    9033 </span>                :<span class="lineCov">          2 :   static_cast&lt; QgsCircularString *&gt;( rings[2] )-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 )</span></a>
<a name="9034"><span class="lineNum">    9034 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.8, 0.9 ) &lt;&lt; QgsPoint( 0.9, 0.9 )</span></a>
<a name="9035"><span class="lineNum">    9035 </span>                :<span class="lineCov">          1 :       &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="9036"><span class="lineNum">    9036 </span>                :<span class="lineCov">          1 :   p8.setInteriorRings( rings );</span></a>
<a name="9037"><span class="lineNum">    9037 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 3 );</span></a>
<a name="9038"><span class="lineNum">    9038 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 0 ) );</span></a>
<a name="9039"><span class="lineNum">    9039 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 2 );</span></a>
<a name="9040"><span class="lineNum">    9040 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="9041"><span class="lineNum">    9041 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 1 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.8, 0.8 ) );</span></a>
<a name="9042"><span class="lineNum">    9042 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 1 ) );</span></a>
<a name="9043"><span class="lineNum">    9043 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 1 );</span></a>
<a name="9044"><span class="lineNum">    9044 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.interiorRing( 0 )-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 0.3, 0.3 ) );</span></a>
<a name="9045"><span class="lineNum">    9045 </span>                :<span class="lineCov">          1 :   QVERIFY( p8.removeInteriorRing( 0 ) );</span></a>
<a name="9046"><span class="lineNum">    9046 </span>                :<span class="lineCov">          1 :   QCOMPARE( p8.numInteriorRings(), 0 );</span></a>
<a name="9047"><span class="lineNum">    9047 </span>                :<span class="lineCov">          1 :   QVERIFY( !p8.removeInteriorRing( 0 ) );</span></a>
<a name="9048"><span class="lineNum">    9048 </span>                :            : </a>
<a name="9049"><span class="lineNum">    9049 </span>                :            :   //clear</a>
<a name="9050"><span class="lineNum">    9050 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p9;</span></a>
<a name="9051"><span class="lineNum">    9051 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9052"><span class="lineNum">    9052 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="9053"><span class="lineNum">    9053 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="9054"><span class="lineNum">    9054 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="9055"><span class="lineNum">    9055 </span>                :<span class="lineCov">          1 :   p9.setExteriorRing( ext );</span></a>
<a name="9056"><span class="lineNum">    9056 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9057"><span class="lineNum">    9057 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="9058"><span class="lineNum">    9058 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="9059"><span class="lineNum">    9059 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="9060"><span class="lineNum">    9060 </span>                :<span class="lineCov">          1 :   p9.addInteriorRing( ring );</span></a>
<a name="9061"><span class="lineNum">    9061 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.numInteriorRings(), 1 );</span></a>
<a name="9062"><span class="lineNum">    9062 </span>                :<span class="lineCov">          1 :   p9.clear();</span></a>
<a name="9063"><span class="lineNum">    9063 </span>                :<span class="lineCov">          1 :   QVERIFY( p9.isEmpty() );</span></a>
<a name="9064"><span class="lineNum">    9064 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.numInteriorRings(), 0 );</span></a>
<a name="9065"><span class="lineNum">    9065 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.nCoordinates(), 0 );</span></a>
<a name="9066"><span class="lineNum">    9066 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.ringCount(), 0 );</span></a>
<a name="9067"><span class="lineNum">    9067 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.partCount(), 0 );</span></a>
<a name="9068"><span class="lineNum">    9068 </span>                :<span class="lineCov">          1 :   QVERIFY( !p9.is3D() );</span></a>
<a name="9069"><span class="lineNum">    9069 </span>                :<span class="lineCov">          1 :   QVERIFY( !p9.isMeasure() );</span></a>
<a name="9070"><span class="lineNum">    9070 </span>                :<span class="lineCov">          1 :   QCOMPARE( p9.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9071"><span class="lineNum">    9071 </span>                :            : </a>
<a name="9072"><span class="lineNum">    9072 </span>                :            :   //equality operator</a>
<a name="9073"><span class="lineNum">    9073 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p10;</span></a>
<a name="9074"><span class="lineNum">    9074 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p10b;</span></a>
<a name="9075"><span class="lineNum">    9075 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="9076"><span class="lineNum">    9076 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="9077"><span class="lineNum">    9077 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9078"><span class="lineNum">    9078 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="9079"><span class="lineNum">    9079 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9080"><span class="lineNum">    9080 </span>                :<span class="lineCov">          1 :   p10.setExteriorRing( ext );</span></a>
<a name="9081"><span class="lineNum">    9081 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="9082"><span class="lineNum">    9082 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="9083"><span class="lineNum">    9083 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9084"><span class="lineNum">    9084 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="9085"><span class="lineNum">    9085 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9086"><span class="lineNum">    9086 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="9087"><span class="lineNum">    9087 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="9088"><span class="lineNum">    9088 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="9089"><span class="lineNum">    9089 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9090"><span class="lineNum">    9090 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="9091"><span class="lineNum">    9091 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 9, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9092"><span class="lineNum">    9092 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="9093"><span class="lineNum">    9093 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="9094"><span class="lineNum">    9094 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="9095"><span class="lineNum">    9095 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9096"><span class="lineNum">    9096 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 )</span></a>
<a name="9097"><span class="lineNum">    9097 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="9098"><span class="lineNum">    9098 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( ext );</span></a>
<a name="9099"><span class="lineNum">    9099 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="9100"><span class="lineNum">    9100 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="9101"><span class="lineNum">    9101 </span>                :<span class="lineCov">          1 :   p10b.setExteriorRing( p10.exteriorRing()-&gt;clone() );</span></a>
<a name="9102"><span class="lineNum">    9102 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="9103"><span class="lineNum">    9103 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="9104"><span class="lineNum">    9104 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9105"><span class="lineNum">    9105 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 )</span></a>
<a name="9106"><span class="lineNum">    9106 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="9107"><span class="lineNum">    9107 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="9108"><span class="lineNum">    9108 </span>                :<span class="lineCov">          1 :   p10.addInteriorRing( ring );</span></a>
<a name="9109"><span class="lineNum">    9109 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="9110"><span class="lineNum">    9110 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="9111"><span class="lineNum">    9111 </span>                :            : </a>
<a name="9112"><span class="lineNum">    9112 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9113"><span class="lineNum">    9113 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 1 )</span></a>
<a name="9114"><span class="lineNum">    9114 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="9115"><span class="lineNum">    9115 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 2, 1 ) );</span></a>
<a name="9116"><span class="lineNum">    9116 </span>                :<span class="lineCov">          1 :   p10b.addInteriorRing( ring );</span></a>
<a name="9117"><span class="lineNum">    9117 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 == p10b ) );</span></a>
<a name="9118"><span class="lineNum">    9118 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 != p10b );</span></a>
<a name="9119"><span class="lineNum">    9119 </span>                :<span class="lineCov">          1 :   p10b.removeInteriorRing( 0 );</span></a>
<a name="9120"><span class="lineNum">    9120 </span>                :<span class="lineCov">          1 :   p10b.addInteriorRing( p10.interiorRing( 0 )-&gt;clone() );</span></a>
<a name="9121"><span class="lineNum">    9121 </span>                :<span class="lineCov">          1 :   QVERIFY( p10 == p10b );</span></a>
<a name="9122"><span class="lineNum">    9122 </span>                :<span class="lineCov">          1 :   QVERIFY( !( p10 != p10b ) );</span></a>
<a name="9123"><span class="lineNum">    9123 </span>                :            : </a>
<a name="9124"><span class="lineNum">    9124 </span>                :            :   //clone</a>
<a name="9125"><span class="lineNum">    9125 </span>                :            : </a>
<a name="9126"><span class="lineNum">    9126 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p11;</span></a>
<a name="9127"><span class="lineNum">    9127 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt;cloned( p11.clone() );</span></a>
<a name="9128"><span class="lineNum">    9128 </span>                :<span class="lineCov">          1 :   QCOMPARE( p11, *cloned );</span></a>
<a name="9129"><span class="lineNum">    9129 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9130"><span class="lineNum">    9130 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="9131"><span class="lineNum">    9131 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="9132"><span class="lineNum">    9132 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="9133"><span class="lineNum">    9133 </span>                :<span class="lineCov">          1 :   p11.setExteriorRing( ext );</span></a>
<a name="9134"><span class="lineNum">    9134 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9135"><span class="lineNum">    9135 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="9136"><span class="lineNum">    9136 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="9137"><span class="lineNum">    9137 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="9138"><span class="lineNum">    9138 </span>                :<span class="lineCov">          1 :   p11.addInteriorRing( ring );</span></a>
<a name="9139"><span class="lineNum">    9139 </span>                :<span class="lineCov">          1 :   cloned.reset( p11.clone() );</span></a>
<a name="9140"><span class="lineNum">    9140 </span>                :<span class="lineCov">          1 :   QCOMPARE( p11, *cloned );</span></a>
<a name="9141"><span class="lineNum">    9141 </span>                :            : </a>
<a name="9142"><span class="lineNum">    9142 </span>                :            :   //copy constructor</a>
<a name="9143"><span class="lineNum">    9143 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p12;</span></a>
<a name="9144"><span class="lineNum">    9144 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p13( p12 );</span></a>
<a name="9145"><span class="lineNum">    9145 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p13 );</span></a>
<a name="9146"><span class="lineNum">    9146 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9147"><span class="lineNum">    9147 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="9148"><span class="lineNum">    9148 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="9149"><span class="lineNum">    9149 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="9150"><span class="lineNum">    9150 </span>                :<span class="lineCov">          1 :   p12.setExteriorRing( ext );</span></a>
<a name="9151"><span class="lineNum">    9151 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9152"><span class="lineNum">    9152 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="9153"><span class="lineNum">    9153 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="9154"><span class="lineNum">    9154 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="9155"><span class="lineNum">    9155 </span>                :<span class="lineCov">          1 :   p12.addInteriorRing( ring );</span></a>
<a name="9156"><span class="lineNum">    9156 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p14( p12 );</span></a>
<a name="9157"><span class="lineNum">    9157 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p14 );</span></a>
<a name="9158"><span class="lineNum">    9158 </span>                :            : </a>
<a name="9159"><span class="lineNum">    9159 </span>                :            :   //assignment operator</a>
<a name="9160"><span class="lineNum">    9160 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p15;</span></a>
<a name="9161"><span class="lineNum">    9161 </span>                :<span class="lineCov">          1 :   p15 = p13;</span></a>
<a name="9162"><span class="lineNum">    9162 </span>                :<span class="lineCov">          1 :   QCOMPARE( p13, p15 );</span></a>
<a name="9163"><span class="lineNum">    9163 </span>                :<span class="lineCov">          1 :   p15 = p12;</span></a>
<a name="9164"><span class="lineNum">    9164 </span>                :<span class="lineCov">          1 :   QCOMPARE( p12, p15 );</span></a>
<a name="9165"><span class="lineNum">    9165 </span>                :            : </a>
<a name="9166"><span class="lineNum">    9166 </span>                :            :   // bounding box</a>
<a name="9167"><span class="lineNum">    9167 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon boundingBoxPoly;</span></a>
<a name="9168"><span class="lineNum">    9168 </span>                :<span class="lineCov">          1 :   QgsRectangle bBox = boundingBoxPoly.boundingBox(); //no crash!</span></a>
<a name="9169"><span class="lineNum">    9169 </span>                :            : </a>
<a name="9170"><span class="lineNum">    9170 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9171"><span class="lineNum">    9171 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 0, 18, 3 )</span></a>
<a name="9172"><span class="lineNum">    9172 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( -1, 4, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9173"><span class="lineNum">    9173 </span>                :<span class="lineCov">          1 :   boundingBoxPoly.setExteriorRing( ext );</span></a>
<a name="9174"><span class="lineNum">    9174 </span>                :<span class="lineCov">          1 :   bBox = boundingBoxPoly.boundingBox();</span></a>
<a name="9175"><span class="lineNum">    9175 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.xMinimum(), -1.435273, 0.001 );</span></a>
<a name="9176"><span class="lineNum">    9176 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.xMaximum(), 1.012344, 0.001 );</span></a>
<a name="9177"><span class="lineNum">    9177 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.yMinimum(), 0.000000, 0.001 );</span></a>
<a name="9178"><span class="lineNum">    9178 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( bBox.yMaximum(), 18, 0.001 );</span></a>
<a name="9179"><span class="lineNum">    9179 </span>                :            : </a>
<a name="9180"><span class="lineNum">    9180 </span>                :            :   //surfaceToPolygon</a>
<a name="9181"><span class="lineNum">    9181 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p12a;</span></a>
<a name="9182"><span class="lineNum">    9182 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPolygon &gt; surface( p12a.surfaceToPolygon() );</span></a>
<a name="9183"><span class="lineNum">    9183 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;isEmpty() );</span></a>
<a name="9184"><span class="lineNum">    9184 </span>                :            : </a>
<a name="9185"><span class="lineNum">    9185 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9186"><span class="lineNum">    9186 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 3 ) &lt;&lt; QgsPoint( 2, 4 )</span></a>
<a name="9187"><span class="lineNum">    9187 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( -1, 5 ) &lt;&lt; QgsPoint( 0, 6 ) );</span></a>
<a name="9188"><span class="lineNum">    9188 </span>                :<span class="lineCov">          1 :   p12a.setExteriorRing( ext );</span></a>
<a name="9189"><span class="lineNum">    9189 </span>                :<span class="lineCov">          1 :   surface.reset( p12a.surfaceToPolygon() );</span></a>
<a name="9190"><span class="lineNum">    9190 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="9191"><span class="lineNum">    9191 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 );</span></a>
<a name="9192"><span class="lineNum">    9192 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 ); // nCoordinates is cached, so check twice</span></a>
<a name="9193"><span class="lineNum">    9193 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="9194"><span class="lineNum">    9194 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="9195"><span class="lineNum">    9195 </span>                :<span class="lineCov">          1 :   QgsRectangle r1 = ext-&gt;boundingBox();</span></a>
<a name="9196"><span class="lineNum">    9196 </span>                :<span class="lineCov">          1 :   QgsRectangle r2 = surface-&gt;exteriorRing()-&gt;boundingBox();</span></a>
<a name="9197"><span class="lineNum">    9197 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="9198"><span class="lineNum">    9198 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="9199"><span class="lineNum">    9199 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="9200"><span class="lineNum">    9200 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="9201"><span class="lineNum">    9201 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9202"><span class="lineNum">    9202 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="9203"><span class="lineNum">    9203 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="9204"><span class="lineNum">    9204 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="9205"><span class="lineNum">    9205 </span>                :<span class="lineCov">          1 :   p12a.addInteriorRing( ring );</span></a>
<a name="9206"><span class="lineNum">    9206 </span>                :<span class="lineCov">          1 :   surface.reset( p12a.surfaceToPolygon() );</span></a>
<a name="9207"><span class="lineNum">    9207 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="9208"><span class="lineNum">    9208 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 );</span></a>
<a name="9209"><span class="lineNum">    9209 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 290 ); // nCoordinates is cached, so check twice</span></a>
<a name="9210"><span class="lineNum">    9210 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="9211"><span class="lineNum">    9211 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;numInteriorRings(), 1 );</span></a>
<a name="9212"><span class="lineNum">    9212 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="9213"><span class="lineNum">    9213 </span>                :<span class="lineCov">          1 :   r1 = ring-&gt;boundingBox();</span></a>
<a name="9214"><span class="lineNum">    9214 </span>                :<span class="lineCov">          1 :   r2 = surface-&gt;interiorRing( 0 )-&gt;boundingBox();</span></a>
<a name="9215"><span class="lineNum">    9215 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="9216"><span class="lineNum">    9216 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="9217"><span class="lineNum">    9217 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="9218"><span class="lineNum">    9218 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="9219"><span class="lineNum">    9219 </span>                :            : </a>
<a name="9220"><span class="lineNum">    9220 </span>                :            :   //toPolygon</a>
<a name="9221"><span class="lineNum">    9221 </span>                :<span class="lineCov">          1 :   p12a = QgsCurvePolygon();</span></a>
<a name="9222"><span class="lineNum">    9222 </span>                :<span class="lineCov">          1 :   surface.reset( p12a.toPolygon() );</span></a>
<a name="9223"><span class="lineNum">    9223 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;isEmpty() );</span></a>
<a name="9224"><span class="lineNum">    9224 </span>                :            : </a>
<a name="9225"><span class="lineNum">    9225 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9226"><span class="lineNum">    9226 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 0, 18 )</span></a>
<a name="9227"><span class="lineNum">    9227 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( -1, 4 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9228"><span class="lineNum">    9228 </span>                :<span class="lineCov">          1 :   p12a.setExteriorRing( ext );</span></a>
<a name="9229"><span class="lineNum">    9229 </span>                :<span class="lineCov">          1 :   surface.reset( p12a.toPolygon() );</span></a>
<a name="9230"><span class="lineNum">    9230 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="9231"><span class="lineNum">    9231 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 );</span></a>
<a name="9232"><span class="lineNum">    9232 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 ); // ncoordinates is cached, so check twice</span></a>
<a name="9233"><span class="lineNum">    9233 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="9234"><span class="lineNum">    9234 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="9235"><span class="lineNum">    9235 </span>                :<span class="lineCov">          1 :   r1 = ext-&gt;boundingBox();</span></a>
<a name="9236"><span class="lineNum">    9236 </span>                :<span class="lineCov">          1 :   r2 = surface-&gt;exteriorRing()-&gt;boundingBox();</span></a>
<a name="9237"><span class="lineNum">    9237 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.01 );</span></a>
<a name="9238"><span class="lineNum">    9238 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.01 );</span></a>
<a name="9239"><span class="lineNum">    9239 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.01 );</span></a>
<a name="9240"><span class="lineNum">    9240 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.01 );</span></a>
<a name="9241"><span class="lineNum">    9241 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9242"><span class="lineNum">    9242 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="9243"><span class="lineNum">    9243 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="9244"><span class="lineNum">    9244 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="9245"><span class="lineNum">    9245 </span>                :<span class="lineCov">          1 :   p12a.addInteriorRing( ring );</span></a>
<a name="9246"><span class="lineNum">    9246 </span>                :<span class="lineCov">          1 :   surface.reset( p12a.toPolygon() );</span></a>
<a name="9247"><span class="lineNum">    9247 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="9248"><span class="lineNum">    9248 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 );</span></a>
<a name="9249"><span class="lineNum">    9249 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;exteriorRing()-&gt;nCoordinates(), 64 ); //ncoordinates is cached, so check twice</span></a>
<a name="9250"><span class="lineNum">    9250 </span>                :<span class="lineCov">          1 :   QVERIFY( surface-&gt;exteriorRing()-&gt;isClosed() );</span></a>
<a name="9251"><span class="lineNum">    9251 </span>                :<span class="lineCov">          1 :   QCOMPARE( surface-&gt;numInteriorRings(), 1 );</span></a>
<a name="9252"><span class="lineNum">    9252 </span>                :            :   // too many vertices to actually check the result, let's just make sure the bounding boxes are similar</a>
<a name="9253"><span class="lineNum">    9253 </span>                :<span class="lineCov">          1 :   r1 = ring-&gt;boundingBox();</span></a>
<a name="9254"><span class="lineNum">    9254 </span>                :<span class="lineCov">          1 :   r2 = surface-&gt;interiorRing( 0 )-&gt;boundingBox();</span></a>
<a name="9255"><span class="lineNum">    9255 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMinimum(), r2.xMinimum(), 0.0001 );</span></a>
<a name="9256"><span class="lineNum">    9256 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.xMaximum(), r2.xMaximum(), 0.0001 );</span></a>
<a name="9257"><span class="lineNum">    9257 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMinimum(), r2.yMinimum(), 0.0001 );</span></a>
<a name="9258"><span class="lineNum">    9258 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r1.yMaximum(), r2.yMaximum(), 0.0001 );</span></a>
<a name="9259"><span class="lineNum">    9259 </span>                :            : </a>
<a name="9260"><span class="lineNum">    9260 </span>                :            :   //toCurveType - should be identical since it's already a curve</a>
<a name="9261"><span class="lineNum">    9261 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurvePolygon &gt; curveType( p12a.toCurveType() );</span></a>
<a name="9262"><span class="lineNum">    9262 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curveType, p12a );</span></a>
<a name="9263"><span class="lineNum">    9263 </span>                :            : </a>
<a name="9264"><span class="lineNum">    9264 </span>                :            :   //to/fromWKB</a>
<a name="9265"><span class="lineNum">    9265 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p16;</span></a>
<a name="9266"><span class="lineNum">    9266 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9267"><span class="lineNum">    9267 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 2, 0 )</span></a>
<a name="9268"><span class="lineNum">    9268 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 0.5 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9269"><span class="lineNum">    9269 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="9270"><span class="lineNum">    9270 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9271"><span class="lineNum">    9271 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.1, 0 ) &lt;&lt; QgsPoint( 0.2, 0 )</span></a>
<a name="9272"><span class="lineNum">    9272 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 0.1, 0.05 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9273"><span class="lineNum">    9273 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="9274"><span class="lineNum">    9274 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = p16.asWkb();</span></a>
<a name="9275"><span class="lineNum">    9275 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), p16.wkbSize() );</span></a>
<a name="9276"><span class="lineNum">    9276 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p17;</span></a>
<a name="9277"><span class="lineNum">    9277 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="9278"><span class="lineNum">    9278 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr );</span></a>
<a name="9279"><span class="lineNum">    9279 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="9280"><span class="lineNum">    9280 </span>                :            :   //CurvePolygonZ</a>
<a name="9281"><span class="lineNum">    9281 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="9282"><span class="lineNum">    9282 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="9283"><span class="lineNum">    9283 </span>                :            : </a>
<a name="9284"><span class="lineNum">    9284 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9285"><span class="lineNum">    9285 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 ) &lt;&lt; QgsPoint( 2, 0, 3 )</span></a>
<a name="9286"><span class="lineNum">    9286 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9287"><span class="lineNum">    9287 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="9288"><span class="lineNum">    9288 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9289"><span class="lineNum">    9289 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 0.1, 0, 2 ) &lt;&lt; QgsPoint( 0.2, 0, 3 )</span></a>
<a name="9290"><span class="lineNum">    9290 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( 0.1, 0.05, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9291"><span class="lineNum">    9291 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="9292"><span class="lineNum">    9292 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="9293"><span class="lineNum">    9293 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="9294"><span class="lineNum">    9294 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr2 );</span></a>
<a name="9295"><span class="lineNum">    9295 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="9296"><span class="lineNum">    9296 </span>                :            : </a>
<a name="9297"><span class="lineNum">    9297 </span>                :            :   // compound curve</a>
<a name="9298"><span class="lineNum">    9298 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve *cCurve = new QgsCompoundCurve();</span></a>
<a name="9299"><span class="lineNum">    9299 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9300"><span class="lineNum">    9300 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 ) &lt;&lt; QgsPoint( 2, 0, 3 )</span></a>
<a name="9301"><span class="lineNum">    9301 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9302"><span class="lineNum">    9302 </span>                :<span class="lineCov">          1 :   cCurve-&gt;addCurve( ext );</span></a>
<a name="9303"><span class="lineNum">    9303 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( cCurve );</span></a>
<a name="9304"><span class="lineNum">    9304 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="9305"><span class="lineNum">    9305 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), p16.wkbSize() );</span></a>
<a name="9306"><span class="lineNum">    9306 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="9307"><span class="lineNum">    9307 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr3 );</span></a>
<a name="9308"><span class="lineNum">    9308 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="9309"><span class="lineNum">    9309 </span>                :            : </a>
<a name="9310"><span class="lineNum">    9310 </span>                :            :   //CurvePolygonM</a>
<a name="9311"><span class="lineNum">    9311 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="9312"><span class="lineNum">    9312 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="9313"><span class="lineNum">    9313 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9314"><span class="lineNum">    9314 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 0, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 0, 0, 3 )</span></a>
<a name="9315"><span class="lineNum">    9315 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 0.5, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="9316"><span class="lineNum">    9316 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="9317"><span class="lineNum">    9317 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9318"><span class="lineNum">    9318 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.2, 0, 0, 3 )</span></a>
<a name="9319"><span class="lineNum">    9319 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0.1, 0.05, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="9320"><span class="lineNum">    9320 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="9321"><span class="lineNum">    9321 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="9322"><span class="lineNum">    9322 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr8( wkb16 );</span></a>
<a name="9323"><span class="lineNum">    9323 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr8 );</span></a>
<a name="9324"><span class="lineNum">    9324 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="9325"><span class="lineNum">    9325 </span>                :            : </a>
<a name="9326"><span class="lineNum">    9326 </span>                :            :   //CurvePolygonZM</a>
<a name="9327"><span class="lineNum">    9327 </span>                :<span class="lineCov">          1 :   p16.clear();</span></a>
<a name="9328"><span class="lineNum">    9328 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="9329"><span class="lineNum">    9329 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9330"><span class="lineNum">    9330 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="9331"><span class="lineNum">    9331 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9332"><span class="lineNum">    9332 </span>                :<span class="lineCov">          1 :   p16.setExteriorRing( ext );</span></a>
<a name="9333"><span class="lineNum">    9333 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9334"><span class="lineNum">    9334 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="9335"><span class="lineNum">    9335 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9336"><span class="lineNum">    9336 </span>                :<span class="lineCov">          1 :   p16.addInteriorRing( ring );</span></a>
<a name="9337"><span class="lineNum">    9337 </span>                :<span class="lineCov">          1 :   wkb16 = p16.asWkb();</span></a>
<a name="9338"><span class="lineNum">    9338 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="9339"><span class="lineNum">    9339 </span>                :<span class="lineCov">          1 :   p17.fromWkb( wkb16ptr4 );</span></a>
<a name="9340"><span class="lineNum">    9340 </span>                :<span class="lineCov">          1 :   QCOMPARE( p16, p17 );</span></a>
<a name="9341"><span class="lineNum">    9341 </span>                :            : </a>
<a name="9342"><span class="lineNum">    9342 </span>                :            :   //bad WKB - check for no crash</a>
<a name="9343"><span class="lineNum">    9343 </span>                :<span class="lineCov">          1 :   p17.clear();</span></a>
<a name="9344"><span class="lineNum">    9344 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="9345"><span class="lineNum">    9345 </span>                :<span class="lineCov">          1 :   QVERIFY( !p17.fromWkb( nullPtr ) );</span></a>
<a name="9346"><span class="lineNum">    9346 </span>                :<span class="lineCov">          1 :   QCOMPARE( p17.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9347"><span class="lineNum">    9347 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="9348"><span class="lineNum">    9348 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="9349"><span class="lineNum">    9349 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="9350"><span class="lineNum">    9350 </span>                :<span class="lineCov">          1 :   QVERIFY( !p17.fromWkb( wkbPointPtr ) );</span></a>
<a name="9351"><span class="lineNum">    9351 </span>                :<span class="lineCov">          1 :   QCOMPARE( p17.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9352"><span class="lineNum">    9352 </span>                :            : </a>
<a name="9353"><span class="lineNum">    9353 </span>                :            :   //to/from WKT</a>
<a name="9354"><span class="lineNum">    9354 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p18;</span></a>
<a name="9355"><span class="lineNum">    9355 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9356"><span class="lineNum">    9356 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="9357"><span class="lineNum">    9357 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9358"><span class="lineNum">    9358 </span>                :<span class="lineCov">          1 :   p18.setExteriorRing( ext );</span></a>
<a name="9359"><span class="lineNum">    9359 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9360"><span class="lineNum">    9360 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="9361"><span class="lineNum">    9361 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9362"><span class="lineNum">    9362 </span>                :<span class="lineCov">          1 :   p18.addInteriorRing( ring );</span></a>
<a name="9363"><span class="lineNum">    9363 </span>                :            : </a>
<a name="9364"><span class="lineNum">    9364 </span>                :<span class="lineCov">          1 :   QString wkt = p18.asWkt();</span></a>
<a name="9365"><span class="lineNum">    9365 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="9366"><span class="lineNum">    9366 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p19;</span></a>
<a name="9367"><span class="lineNum">    9367 </span>                :<span class="lineCov">          1 :   QVERIFY( p19.fromWkt( wkt ) );</span></a>
<a name="9368"><span class="lineNum">    9368 </span>                :<span class="lineCov">          1 :   QCOMPARE( p18, p19 );</span></a>
<a name="9369"><span class="lineNum">    9369 </span>                :            : </a>
<a name="9370"><span class="lineNum">    9370 </span>                :            :   //bad WKT</a>
<a name="9371"><span class="lineNum">    9371 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="9372"><span class="lineNum">    9372 </span>                :<span class="lineCov">          1 :   QVERIFY( p19.isEmpty() );</span></a>
<a name="9373"><span class="lineNum">    9373 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.exteriorRing() );</span></a>
<a name="9374"><span class="lineNum">    9374 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19.numInteriorRings(), 0 );</span></a>
<a name="9375"><span class="lineNum">    9375 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.is3D() );</span></a>
<a name="9376"><span class="lineNum">    9376 </span>                :<span class="lineCov">          1 :   QVERIFY( !p19.isMeasure() );</span></a>
<a name="9377"><span class="lineNum">    9377 </span>                :<span class="lineCov">          1 :   QCOMPARE( p19.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9378"><span class="lineNum">    9378 </span>                :            : </a>
<a name="9379"><span class="lineNum">    9379 </span>                :            : </a>
<a name="9380"><span class="lineNum">    9380 </span>                :            :   //as JSON</a>
<a name="9381"><span class="lineNum">    9381 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon exportPolygon;</span></a>
<a name="9382"><span class="lineNum">    9382 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9383"><span class="lineNum">    9383 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 0, 12, 3 )</span></a>
<a name="9384"><span class="lineNum">    9384 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9385"><span class="lineNum">    9385 </span>                :<span class="lineCov">          1 :   exportPolygon.setExteriorRing( ext );</span></a>
<a name="9386"><span class="lineNum">    9386 </span>                :            : </a>
<a name="9387"><span class="lineNum">    9387 </span>                :            : </a>
<a name="9388"><span class="lineNum">    9388 </span>                :            :   // GML document for compare</a>
<a name="9389"><span class="lineNum">    9389 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="9390"><span class="lineNum">    9390 </span>                :            : </a>
<a name="9391"><span class="lineNum">    9391 </span>                :            :   // as GML2</a>
<a name="9392"><span class="lineNum">    9392 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 2,0 2,0 2,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.1 1.9,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.8,0.2 1.7,0.3 1.7,0.3 1.7,0.3 1.7,0.3 1.7,0.3 1.6,0.3 1.6,0.3 1.6,0.3 1.6,0.4 1.6,0.4 1.6,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.5,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.4,0.4 1.3,0.5 1.3,0.5 1.3,0.5 1.3,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.2,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1.1,0.5 1,0.5 1,0.5 1,0.5 1,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.9,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.8,0.5 0.7,0.5 0.7,0.5 0.7,0.5 0.7,0.5 0.6,0.4 0.6,0.4 0.6,0.4 0.6,0.4 0.6,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.5,0.4 0.4,0.4 0.4,0.4 0.4,0.4 0.4,0.3 0.4,0.3 0.4,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.3,0.3 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.2,0.2 0.1,0.2 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0.1,0.1 0,0.1 0,0 0,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9393"><span class="lineNum">    9393 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportPolygon.asGml2( doc, 1 ) );</span></a>
<a name="9394"><span class="lineNum">    9394 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="9395"><span class="lineNum">    9395 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="9396"><span class="lineNum">    9396 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCurvePolygon().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="9397"><span class="lineNum">    9397 </span>                :            : </a>
<a name="9398"><span class="lineNum">    9398 </span>                :            :   //as GML3</a>
<a name="9399"><span class="lineNum">    9399 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9400"><span class="lineNum">    9400 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc, 2 ) );</span></a>
<a name="9401"><span class="lineNum">    9401 </span>                :<span class="lineCov">          1 :   QCOMPARE( elemToString( exportPolygon.asGml3( doc ) ), expectedSimpleGML3 );</span></a>
<a name="9402"><span class="lineNum">    9402 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="9403"><span class="lineNum">    9403 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCurvePolygon().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="9404"><span class="lineNum">    9404 </span>                :            : </a>
<a name="9405"><span class="lineNum">    9405 </span>                :            :   // as JSON</a>
<a name="9406"><span class="lineNum">    9406 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[1.0,0.0,11.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.2],[1.9,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.7,0.3,12.3],[1.7,0.3,12.3],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,12.9],[0.9,0.5,12.9],[0.9,0.5,12.8],[0.9,0.5,12.7],[0.9,0.5,12.7],[0.9,0.5,12.6],[0.8,0.5,12.6],[0.8,0.5,12.5],[0.8,0.5,12.5],[0.8,0.5,12.4],[0.8,0.5,12.4],[0.7,0.5,12.3],[0.7,0.5,12.2],[0.7,0.5,12.2],[0.7,0.5,12.1],[0.6,0.4,12.1],[0.6,0.4,12.0],[0.6,0.4,12.0],[0.6,0.4,11.9],[0.6,0.4,11.9],[0.5,0.4,11.8],[0.5,0.4,11.7],[0.5,0.4,11.7],[0.5,0.4,11.6],[0.5,0.4,11.6],[0.4,0.4,11.5],[0.4,0.4,11.5],[0.4,0.4,11.4],[0.4,0.3,11.3],[0.4,0.3,11.3],[0.4,0.3,11.2],[0.3,0.3,11.2],[0.3,0.3,11.1],[0.3,0.3,11.1],[0.3,0.3,11.0],[0.3,0.3,11.0],[0.2,0.2,10.9],[0.2,0.2,10.8],[0.2,0.2,10.8],[0.2,0.2,10.7],[0.2,0.2,10.7],[0.2,0.2,10.6],[0.1,0.2,10.6],[0.1,0.1,10.5],[0.1,0.1,10.4],[0.1,0.1,10.4],[0.1,0.1,10.3],[0.1,0.1,10.3],[0.1,0.1,10.2],[0.0,0.1,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="9407"><span class="lineNum">    9407 </span>                :<span class="lineCov">          1 :   res = exportPolygon.asJson( 1 );</span></a>
<a name="9408"><span class="lineNum">    9408 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="9409"><span class="lineNum">    9409 </span>                :            : </a>
<a name="9410"><span class="lineNum">    9410 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9411"><span class="lineNum">    9411 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2, 0, 12, 3 )</span></a>
<a name="9412"><span class="lineNum">    9412 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1, 0.05, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9413"><span class="lineNum">    9413 </span>                :<span class="lineCov">          1 :   exportPolygon.addInteriorRing( ring );</span></a>
<a name="9414"><span class="lineNum">    9414 </span>                :            : </a>
<a name="9415"><span class="lineNum">    9415 </span>                :<span class="lineCov">          1 :   QString expectedJson( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[1.0,0.0,11.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.0,12.0],[2.0,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.1],[1.9,0.1,12.2],[1.9,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.2],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.8,0.2,12.3],[1.7,0.3,12.3],[1.7,0.3,12.3],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.7,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.3,12.4],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.6,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.5],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.5,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.6],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.4,0.4,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.7],[1.3,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.8],[1.2,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,12.9],[1.1,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,13.0],[1.0,0.5,12.9],[0.9,0.5,12.9],[0.9,0.5,12.8],[0.9,0.5,12.7],[0.9,0.5,12.7],[0.9,0.5,12.6],[0.8,0.5,12.6],[0.8,0.5,12.5],[0.8,0.5,12.5],[0.8,0.5,12.4],[0.8,0.5,12.4],[0.7,0.5,12.3],[0.7,0.5,12.2],[0.7,0.5,12.2],[0.7,0.5,12.1],[0.6,0.4,12.1],[0.6,0.4,12.0],[0.6,0.4,12.0],[0.6,0.4,11.9],[0.6,0.4,11.9],[0.5,0.4,11.8],[0.5,0.4,11.7],[0.5,0.4,11.7],[0.5,0.4,11.6],[0.5,0.4,11.6],[0.4,0.4,11.5],[0.4,0.4,11.5],[0.4,0.4,11.4],[0.4,0.3,11.3],[0.4,0.3,11.3],[0.4,0.3,11.2],[0.3,0.3,11.2],[0.3,0.3,11.1],[0.3,0.3,11.1],[0.3,0.3,11.0],[0.3,0.3,11.0],[0.2,0.2,10.9],[0.2,0.2,10.8],[0.2,0.2,10.8],[0.2,0.2,10.7],[0.2,0.2,10.7],[0.2,0.2,10.6],[0.1,0.2,10.6],[0.1,0.1,10.5],[0.1,0.1,10.4],[0.1,0.1,10.4],[0.1,0.1,10.3],[0.1,0.1,10.3],[0.1,0.1,10.2],[0.0,0.1,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]],[[0.0,0.0,10.0],[0.1,0.0,11.0],[0.2,0.0,12.0],[0.2,0.0,12.0],[0.2,0.0,12.0],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.1],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.2],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.3],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.4],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.2,0.0,12.5],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.8],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,13.0],[0.1,0.0,12.9],[0.1,0.0,12.9],[0.1,0.0,12.8],[0.1,0.0,12.7],[0.1,0.0,12.7],[0.1,0.0,12.6],[0.1,0.0,12.6],[0.1,0.0,12.5],[0.1,0.0,12.5],[0.1,0.0,12.4],[0.1,0.0,12.4],[0.1,0.0,12.3],[0.1,0.0,12.2],[0.1,0.0,12.2],[0.1,0.0,12.1],[0.1,0.0,12.1],[0.1,0.0,12.0],[0.1,0.0,12.0],[0.1,0.0,11.9],[0.1,0.0,11.9],[0.1,0.0,11.8],[0.1,0.0,11.7],[0.1,0.0,11.7],[0.0,0.0,11.6],[0.0,0.0,11.6],[0.0,0.0,11.5],[0.0,0.0,11.5],[0.0,0.0,11.4],[0.0,0.0,11.3],[0.0,0.0,11.3],[0.0,0.0,11.2],[0.0,0.0,11.2],[0.0,0.0,11.1],[0.0,0.0,11.1],[0.0,0.0,11.0],[0.0,0.0,11.0],[0.0,0.0,10.9],[0.0,0.0,10.8],[0.0,0.0,10.8],[0.0,0.0,10.7],[0.0,0.0,10.7],[0.0,0.0,10.6],[0.0,0.0,10.6],[0.0,0.0,10.5],[0.0,0.0,10.4],[0.0,0.0,10.4],[0.0,0.0,10.3],[0.0,0.0,10.3],[0.0,0.0,10.2],[0.0,0.0,10.2],[0.0,0.0,10.1],[0.0,0.0,10.1],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="9416"><span class="lineNum">    9416 </span>                :<span class="lineCov">          1 :   res = exportPolygon.asJson( 1 );</span></a>
<a name="9417"><span class="lineNum">    9417 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJson );</span></a>
<a name="9418"><span class="lineNum">    9418 </span>                :            : </a>
<a name="9419"><span class="lineNum">    9419 </span>                :            :   //asKML</a>
<a name="9420"><span class="lineNum">    9420 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;absolute&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,10 1,0,11 2,0,12 2,0,12 2,0,12 2,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.1 1.9,0.1,12.2 1.9,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.2 1.8,0.2,12.3 1.8,0.2,12.3 1.8,0.2,12.3 1.7,0.3,12.3 1.7,0.3,12.3 1.7,0.3,12.4 1.7,0.3,12.4 1.7,0.3,12.4 1.6,0.3,12.4 1.6,0.3,12.4 1.6,0.3,12.4 1.6,0.4,12.5 1.6,0.4,12.5 1.6,0.4,12.5 1.5,0.4,12.5 1.5,0.4,12.5 1.5,0.4,12.6 1.5,0.4,12.6 1.5,0.4,12.6 1.4,0.4,12.6 1.4,0.4,12.6 1.4,0.4,12.7 1.4,0.4,12.7 1.4,0.4,12.7 1.3,0.5,12.7 1.3,0.5,12.7 1.3,0.5,12.7 1.3,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.8 1.2,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,12.9 1.1,0.5,13 1,0.5,13 1,0.5,13 1,0.5,13 1,0.5,12.9 0.9,0.5,12.9 0.9,0.5,12.8 0.9,0.5,12.7 0.9,0.5,12.7 0.9,0.5,12.6 0.8,0.5,12.6 0.8,0.5,12.5 0.8,0.5,12.5 0.8,0.5,12.4 0.8,0.5,12.4 0.7,0.5,12.3 0.7,0.5,12.2 0.7,0.5,12.2 0.7,0.5,12.1 0.6,0.4,12.1 0.6,0.4,12 0.6,0.4,12 0.6,0.4,11.9 0.6,0.4,11.9 0.5,0.4,11.8 0.5,0.4,11.7 0.5,0.4,11.7 0.5,0.4,11.6 0.5,0.4,11.6 0.4,0.4,11.5 0.4,0.4,11.5 0.4,0.4,11.4 0.4,0.3,11.3 0.4,0.3,11.3 0.4,0.3,11.2 0.3,0.3,11.2 0.3,0.3,11.1 0.3,0.3,11.1 0.3,0.3,11 0.3,0.3,11 0.2,0.2,10.9 0.2,0.2,10.8 0.2,0.2,10.8 0.2,0.2,10.7 0.2,0.2,10.7 0.2,0.2,10.6 0.1,0.2,10.6 0.1,0.1,10.5 0.1,0.1,10.4 0.1,0.1,10.4 0.1,0.1,10.3 0.1,0.1,10.3 0.1,0.1,10.2 0,0.1,10.2 0,0,10.1 0,0,10.1 0,0,10&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;absolute&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,10 0.1,0,11 0.2,0,12 0.2,0,12 0.2,0,12 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.1 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.2 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.3 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.4 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.2,0,12.5 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.6 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.7 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.8 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,12.9 0.1,0,13 0.1,0,13 0.1,0,13 0.1,0,13 0.1,0,12.9 0.1,0,12.9 0.1,0,12.8 0.1,0,12.7 0.1,0,12.7 0.1,0,12.6 0.1,0,12.6 0.1,0,12.5 0.1,0,12.5 0.1,0,12.4 0.1,0,12.4 0.1,0,12.3 0.1,0,12.2 0.1,0,12.2 0.1,0,12.1 0.1,0,12.1 0.1,0,12 0.1,0,12 0.1,0,11.9 0.1,0,11.9 0.1,0,11.8 0.1,0,11.7 0.1,0,11.7 0,0,11.6 0,0,11.6 0,0,11.5 0,0,11.5 0,0,11.4 0,0,11.3 0,0,11.3 0,0,11.2 0,0,11.2 0,0,11.1 0,0,11.1 0,0,11 0,0,11 0,0,10.9 0,0,10.8 0,0,10.8 0,0,10.7 0,0,10.7 0,0,10.6 0,0,10.6 0,0,10.5 0,0,10.4 0,0,10.4 0,0,10.3 0,0,10.3 0,0,10.2 0,0,10.2 0,0,10.1 0,0,10.1 0,0,10&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9421"><span class="lineNum">    9421 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygon.asKml( 1 ), expectedKml );</span></a>
<a name="9422"><span class="lineNum">    9422 </span>                :            : </a>
<a name="9423"><span class="lineNum">    9423 </span>                :            : </a>
<a name="9424"><span class="lineNum">    9424 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon exportPolygonFloat;</span></a>
<a name="9425"><span class="lineNum">    9425 </span>                :<span class="lineCov">          1 :   ext = new QgsCircularString();</span></a>
<a name="9426"><span class="lineNum">    9426 </span>                :<span class="lineCov">          2 :   ext-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1 / 3.0, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2 / 3.0, 0, 12, 3 )</span></a>
<a name="9427"><span class="lineNum">    9427 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1 / 3.0, 0.5, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9428"><span class="lineNum">    9428 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.setExteriorRing( ext );</span></a>
<a name="9429"><span class="lineNum">    9429 </span>                :<span class="lineCov">          1 :   ring = new QgsCircularString();</span></a>
<a name="9430"><span class="lineNum">    9430 </span>                :<span class="lineCov">          2 :   ring-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1 / 3.0, 0, 11, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.2 / 3.0, 0, 12, 3 )</span></a>
<a name="9431"><span class="lineNum">    9431 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0.1 / 3.0, 0.05 / 3.0, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 10, 1 ) );</span></a>
<a name="9432"><span class="lineNum">    9432 </span>                :<span class="lineCov">          1 :   exportPolygonFloat.addInteriorRing( ring );</span></a>
<a name="9433"><span class="lineNum">    9433 </span>                :            : </a>
<a name="9434"><span class="lineNum">    9434 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0,10.0],[0.333,0.0,11.0],[0.667,0.0,12.0],[0.669,0.006,12.009],[0.671,0.012,12.018],[0.673,0.018,12.027],[0.676,0.024,12.035],[0.677,0.029,12.044],[0.679,0.035,12.053],[0.681,0.042,12.062],[0.683,0.048,12.071],[0.684,0.054,12.08],[0.686,0.06,12.088],[0.687,0.066,12.097],[0.688,0.072,12.106],[0.689,0.078,12.115],[0.69,0.084,12.124],[0.691,0.091,12.133],[0.692,0.097,12.142],[0.693,0.103,12.15],[0.693,0.109,12.159],[0.694,0.116,12.168],[0.694,0.122,12.177],[0.694,0.128,12.186],[0.694,0.135,12.195],[0.694,0.141,12.204],[0.694,0.147,12.212],[0.694,0.153,12.221],[0.694,0.16,12.23],[0.693,0.166,12.239],[0.693,0.172,12.248],[0.692,0.178,12.257],[0.692,0.185,12.265],[0.691,0.191,12.274],[0.69,0.197,12.283],[0.689,0.203,12.292],[0.687,0.209,12.301],[0.686,0.216,12.31],[0.685,0.222,12.319],[0.683,0.228,12.327],[0.682,0.234,12.336],[0.68,0.24,12.345],[0.678,0.246,12.354],[0.676,0.252,12.363],[0.674,0.258,12.372],[0.672,0.264,12.381],[0.67,0.27,12.389],[0.668,0.275,12.398],[0.665,0.281,12.407],[0.663,0.287,12.416],[0.66,0.293,12.425],[0.657,0.298,12.434],[0.654,0.304,12.442],[0.652,0.31,12.451],[0.649,0.315,12.46],[0.645,0.321,12.469],[0.642,0.326,12.478],[0.639,0.331,12.487],[0.636,0.337,12.496],[0.632,0.342,12.504],[0.628,0.347,12.513],[0.625,0.352,12.522],[0.621,0.357,12.531],[0.617,0.362,12.54],[0.613,0.367,12.549],[0.609,0.372,12.558],[0.605,0.377,12.566],[0.601,0.381,12.575],[0.597,0.386,12.584],[0.592,0.39,12.593],[0.588,0.395,12.602],[0.584,0.399,12.611],[0.579,0.404,12.619],[0.574,0.408,12.628],[0.57,0.412,12.637],[0.565,0.416,12.646],[0.56,0.42,12.655],[0.555,0.424,12.664],[0.55,0.428,12.673],[0.545,0.431,12.681],[0.54,0.435,12.69],[0.535,0.439,12.699],[0.529,0.442,12.708],[0.524,0.445,12.717],[0.519,0.449,12.726],[0.513,0.452,12.735],[0.508,0.455,12.743],[0.502,0.458,12.752],[0.497,0.461,12.761],[0.491,0.464,12.77],[0.485,0.466,12.779],[0.48,0.469,12.788],[0.474,0.471,12.796],[0.468,0.474,12.805],[0.462,0.476,12.814],[0.456,0.478,12.823],[0.451,0.48,12.832],[0.445,0.482,12.841],[0.439,0.484,12.85],[0.433,0.486,12.858],[0.426,0.488,12.867],[0.42,0.489,12.876],[0.414,0.491,12.885],[0.408,0.492,12.894],[0.402,0.493,12.903],[0.396,0.495,12.912],[0.39,0.496,12.92],[0.383,0.497,12.929],[0.377,0.497,12.938],[0.371,0.498,12.947],[0.365,0.499,12.956],[0.358,0.499,12.965],[0.352,0.5,12.973],[0.346,0.5,12.982],[0.34,0.5,12.991],[0.333,0.5,13.0],[0.327,0.5,12.973],[0.321,0.5,12.947],[0.314,0.5,12.92],[0.308,0.499,12.894],[0.302,0.499,12.867],[0.296,0.498,12.841],[0.289,0.497,12.814],[0.283,0.497,12.788],[0.277,0.496,12.761],[0.271,0.495,12.735],[0.265,0.493,12.708],[0.259,0.492,12.681],[0.252,0.491,12.655],[0.246,0.489,12.628],[0.24,0.488,12.602],[0.234,0.486,12.575],[0.228,0.484,12.549],[0.222,0.482,12.522],[0.216,0.48,12.496],[0.21,0.478,12.469],[0.204,0.476,12.442],[0.198,0.474,12.416],[0.193,0.471,12.389],[0.187,0.469,12.363],[0.181,0.466,12.336],[0.176,0.464,12.31],[0.17,0.461,12.283],[0.164,0.458,12.257],[0.159,0.455,12.23],[0.153,0.452,12.204],[0.148,0.449,12.177],[0.143,0.445,12.15],[0.137,0.442,12.124],[0.132,0.439,12.097],[0.127,0.435,12.071],[0.122,0.431,12.044],[0.117,0.428,12.018],[0.112,0.424,11.991],[0.107,0.42,11.965],[0.102,0.416,11.938],[0.097,0.412,11.912],[0.092,0.408,11.885],[0.088,0.404,11.858],[0.083,0.399,11.832],[0.079,0.395,11.805],[0.074,0.39,11.779],[0.07,0.386,11.752],[0.066,0.381,11.726],[0.061,0.377,11.699],[0.057,0.372,11.673],[0.053,0.367,11.646],[0.049,0.362,11.619],[0.046,0.357,11.593],[0.042,0.352,11.566],[0.038,0.347,11.54],[0.035,0.342,11.513],[0.031,0.337,11.487],[0.028,0.331,11.46],[0.024,0.326,11.434],[0.021,0.321,11.407],[0.018,0.315,11.381],[0.015,0.31,11.354],[0.012,0.304,11.327],[0.009,0.298,11.301],[0.007,0.293,11.274],[0.004,0.287,11.248],[0.001,0.281,11.221],[-0.001,0.275,11.195],[-0.003,0.27,11.168],[-0.005,0.264,11.142],[-0.008,0.258,11.115],[-0.01,0.252,11.088],[-0.012,0.246,11.062],[-0.013,0.24,11.035],[-0.015,0.234,11.009],[-0.017,0.228,10.982],[-0.018,0.222,10.956],[-0.02,0.216,10.929],[-0.021,0.209,10.903],[-0.022,0.203,10.876],[-0.023,0.197,10.85],[-0.024,0.191,10.823],[-0.025,0.185,10.796],[-0.026,0.178,10.77],[-0.026,0.172,10.743],[-0.027,0.166,10.717],[-0.027,0.16,10.69],[-0.027,0.153,10.664],[-0.028,0.147,10.637],[-0.028,0.141,10.611],[-0.028,0.135,10.584],[-0.028,0.128,10.558],[-0.027,0.122,10.531],[-0.027,0.116,10.504],[-0.027,0.109,10.478],[-0.026,0.103,10.451],[-0.025,0.097,10.425],[-0.025,0.091,10.398],[-0.024,0.084,10.372],[-0.023,0.078,10.345],[-0.022,0.072,10.319],[-0.02,0.066,10.292],[-0.019,0.06,10.265],[-0.018,0.054,10.239],[-0.016,0.048,10.212],[-0.014,0.042,10.186],[-0.013,0.035,10.159],[-0.011,0.029,10.133],[-0.009,0.024,10.106],[-0.007,0.018,10.08],[-0.005,0.012,10.053],[-0.002,0.006,10.027],[0.0,0.0,10.0]],[[0.0,0.0,10.0],[0.033,0.0,11.0],[0.067,0.0,12.0],[0.066,0.001,12.019],[0.066,0.001,12.037],[0.065,0.002,12.056],[0.065,0.002,12.075],[0.064,0.003,12.093],[0.064,0.003,12.112],[0.063,0.004,12.131],[0.063,0.004,12.15],[0.062,0.005,12.168],[0.062,0.005,12.187],[0.061,0.006,12.206],[0.061,0.006,12.224],[0.06,0.007,12.243],[0.06,0.007,12.262],[0.059,0.008,12.28],[0.059,0.008,12.299],[0.058,0.009,12.318],[0.057,0.009,12.336],[0.057,0.009,12.355],[0.056,0.01,12.374],[0.056,0.01,12.393],[0.055,0.011,12.411],[0.054,0.011,12.43],[0.054,0.011,12.449],[0.053,0.012,12.467],[0.052,0.012,12.486],[0.052,0.012,12.505],[0.051,0.013,12.523],[0.051,0.013,12.542],[0.05,0.013,12.561],[0.049,0.014,12.579],[0.049,0.014,12.598],[0.048,0.014,12.617],[0.047,0.014,12.636],[0.046,0.015,12.654],[0.046,0.015,12.673],[0.045,0.015,12.692],[0.044,0.015,12.71],[0.044,0.015,12.729],[0.043,0.016,12.748],[0.042,0.016,12.766],[0.042,0.016,12.785],[0.041,0.016,12.804],[0.04,0.016,12.822],[0.039,0.016,12.841],[0.039,0.016,12.86],[0.038,0.016,12.879],[0.037,0.016,12.897],[0.037,0.017,12.916],[0.036,0.017,12.935],[0.035,0.017,12.953],[0.034,0.017,12.972],[0.034,0.017,12.991],[0.033,0.017,12.972],[0.032,0.017,12.916],[0.032,0.017,12.86],[0.031,0.017,12.804],[0.03,0.017,12.748],[0.029,0.016,12.692],[0.029,0.016,12.636],[0.028,0.016,12.579],[0.027,0.016,12.523],[0.027,0.016,12.467],[0.026,0.016,12.411],[0.025,0.016,12.355],[0.024,0.016,12.299],[0.024,0.016,12.243],[0.023,0.015,12.187],[0.022,0.015,12.131],[0.022,0.015,12.075],[0.021,0.015,12.019],[0.02,0.015,11.963],[0.02,0.014,11.907],[0.019,0.014,11.85],[0.018,0.014,11.794],[0.017,0.014,11.738],[0.017,0.013,11.682],[0.016,0.013,11.626],[0.016,0.013,11.57],[0.015,0.012,11.514],[0.014,0.012,11.458],[0.014,0.012,11.402],[0.013,0.011,11.346],[0.012,0.011,11.29],[0.012,0.011,11.234],[0.011,0.01,11.178],[0.01,0.01,11.121],[0.01,0.009,11.065],[0.009,0.009,11.009],[0.009,0.009,10.953],[0.008,0.008,10.897],[0.008,0.008,10.841],[0.007,0.007,10.785],[0.006,0.007,10.729],[0.006,0.006,10.673],[0.005,0.006,10.617],[0.005,0.005,10.561],[0.004,0.005,10.505],[0.004,0.004,10.449],[0.003,0.004,10.393],[0.003,0.003,10.336],[0.002,0.003,10.28],[0.002,0.002,10.224],[0.001,0.002,10.168],[0.001,0.001,10.112],[0.0,0.001,10.056],[0.0,0.0,10.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="9435"><span class="lineNum">    9435 </span>                :<span class="lineCov">          1 :   res = exportPolygonFloat.asJson( 3 );</span></a>
<a name="9436"><span class="lineNum">    9436 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportPolygonFloat.asJson( 3 ), expectedJsonPrec3 );</span></a>
<a name="9437"><span class="lineNum">    9437 </span>                :            : </a>
<a name="9438"><span class="lineNum">    9438 </span>                :            :   // as GML2</a>
<a name="9439"><span class="lineNum">    9439 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 1.98685,0.01722 1.97341,0.03421 1.95967,0.05096 1.94564,0.06747 1.93133,0.08374 1.91674,0.09976 1.90188,0.11552 1.88674,0.13102 1.87134,0.14625 1.85567,0.16122 1.83975,0.17592 1.82358,0.19033 1.80716,0.20446 1.79049,0.21831 1.77359,0.23186 1.75646,0.24512 1.7391,0.25809 1.72151,0.27074 1.70371,0.2831 1.6857,0.29514 1.66748,0.30687 1.64907,0.31828 1.63045,0.32936 1.61165,0.34013 1.59267,0.35057 1.5735,0.36067 1.55417,0.37045 1.53466,0.37988 1.515,0.38898 1.49518,0.39773 1.47522,0.40614 1.45511,0.41421 1.43486,0.42192 1.41448,0.42928 1.39398,0.43629 1.37336,0.44294 1.35263,0.44923 1.33179,0.45516 1.31086,0.46073 1.28983,0.46594 1.26871,0.47078 1.24751,0.47525 1.22624,0.47936 1.2049,0.48309 1.18349,0.48646 1.16204,0.48945 1.14053,0.49208 1.11898,0.49432 1.0974,0.4962 1.07578,0.4977 1.05415,0.49883 1.0325,0.49958 1.01083,0.49995 0.98917,0.49995 0.9675,0.49958 0.94585,0.49883 0.92422,0.4977 0.9026,0.4962 0.88102,0.49432 0.85947,0.49208 0.83796,0.48945 0.81651,0.48646 0.7951,0.48309 0.77376,0.47936 0.75249,0.47525 0.73129,0.47078 0.71017,0.46594 0.68914,0.46073 0.66821,0.45516 0.64737,0.44923 0.62664,0.44294 0.60602,0.43629 0.58552,0.42928 0.56514,0.42192 0.54489,0.41421 0.52478,0.40614 0.50482,0.39773 0.485,0.38898 0.46534,0.37988 0.44583,0.37045 0.4265,0.36067 0.40733,0.35057 0.38835,0.34013 0.36955,0.32936 0.35093,0.31828 0.33252,0.30687 0.3143,0.29514 0.29629,0.2831 0.27849,0.27074 0.2609,0.25809 0.24354,0.24512 0.22641,0.23186 0.20951,0.21831 0.19284,0.20446 0.17642,0.19033 0.16025,0.17592 0.14433,0.16122 0.12866,0.14625 0.11326,0.13102 0.09812,0.11552 0.08326,0.09976 0.06867,0.08374 0.05436,0.06747 0.04033,0.05096 0.02659,0.03421 0.01315,0.01722 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0.1,0 0.2,0 0.19869,0.00172 0.19734,0.00342 0.19597,0.0051 0.19456,0.00675 0.19313,0.00837 0.19167,0.00998 0.19019,0.01155 0.18867,0.0131 0.18713,0.01463 0.18557,0.01612 0.18398,0.01759 0.18236,0.01903 0.18072,0.02045 0.17905,0.02183 0.17736,0.02319 0.17565,0.02451 0.17391,0.02581 0.17215,0.02707 0.17037,0.02831 0.16857,0.02951 0.16675,0.03069 0.16491,0.03183 0.16305,0.03294 0.16117,0.03401 0.15927,0.03506 0.15735,0.03607 0.15542,0.03704 0.15347,0.03799 0.1515,0.0389 0.14952,0.03977 0.14752,0.04061 0.14551,0.04142 0.14349,0.04219 0.14145,0.04293 0.1394,0.04363 0.13734,0.04429 0.13526,0.04492 0.13318,0.04552 0.13109,0.04607 0.12898,0.04659 0.12687,0.04708 0.12475,0.04753 0.12262,0.04794 0.12049,0.04831 0.11835,0.04865 0.1162,0.04895 0.11405,0.04921 0.1119,0.04943 0.10974,0.04962 0.10758,0.04977 0.10541,0.04988 0.10325,0.04996 0.10108,0.05 0.09892,0.05 0.09675,0.04996 0.09459,0.04988 0.09242,0.04977 0.09026,0.04962 0.0881,0.04943 0.08595,0.04921 0.0838,0.04895 0.08165,0.04865 0.07951,0.04831 0.07738,0.04794 0.07525,0.04753 0.07313,0.04708 0.07102,0.04659 0.06891,0.04607 0.06682,0.04552 0.06474,0.04492 0.06266,0.04429 0.0606,0.04363 0.05855,0.04293 0.05651,0.04219 0.05449,0.04142 0.05248,0.04061 0.05048,0.03977 0.0485,0.0389 0.04653,0.03799 0.04458,0.03704 0.04265,0.03607 0.04073,0.03506 0.03883,0.03401 0.03695,0.03294 0.03509,0.03183 0.03325,0.03069 0.03143,0.02951 0.02963,0.02831 0.02785,0.02707 0.02609,0.02581 0.02435,0.02451 0.02264,0.02319 0.02095,0.02183 0.01928,0.02045 0.01764,0.01903 0.01602,0.01759 0.01443,0.01612 0.01287,0.01463 0.01133,0.0131 0.00981,0.01155 0.00833,0.00998 0.00687,0.00837 0.00544,0.00675 0.00403,0.0051 0.00266,0.00342 0.00131,0.00172 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9440"><span class="lineNum">    9440 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml2( doc, 5 ) );</span></a>
<a name="9441"><span class="lineNum">    9441 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2 );</span></a>
<a name="9442"><span class="lineNum">    9442 </span>                :            : </a>
<a name="9443"><span class="lineNum">    9443 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec2( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 1,0 2,0 1.99,0.02 1.97,0.03 1.96,0.05 1.95,0.07 1.93,0.08 1.92,0.1 1.9,0.12 1.89,0.13 1.87,0.15 1.86,0.16 1.84,0.18 1.82,0.19 1.81,0.2 1.79,0.22 1.77,0.23 1.76,0.25 1.74,0.26 1.72,0.27 1.7,0.28 1.69,0.3 1.67,0.31 1.65,0.32 1.63,0.33 1.61,0.34 1.59,0.35 1.57,0.36 1.55,0.37 1.53,0.38 1.52,0.39 1.5,0.4 1.48,0.41 1.46,0.41 1.43,0.42 1.41,0.43 1.39,0.44 1.37,0.44 1.35,0.45 1.33,0.46 1.31,0.46 1.29,0.47 1.27,0.47 1.25,0.48 1.23,0.48 1.2,0.48 1.18,0.49 1.16,0.49 1.14,0.49 1.12,0.49 1.1,0.5 1.08,0.5 1.05,0.5 1.03,0.5 1.01,0.5 0.99,0.5 0.97,0.5 0.95,0.5 0.92,0.5 0.9,0.5 0.88,0.49 0.86,0.49 0.84,0.49 0.82,0.49 0.8,0.48 0.77,0.48 0.75,0.48 0.73,0.47 0.71,0.47 0.69,0.46 0.67,0.46 0.65,0.45 0.63,0.44 0.61,0.44 0.59,0.43 0.57,0.42 0.54,0.41 0.52,0.41 0.5,0.4 0.48,0.39 0.47,0.38 0.45,0.37 0.43,0.36 0.41,0.35 0.39,0.34 0.37,0.33 0.35,0.32 0.33,0.31 0.31,0.3 0.3,0.28 0.28,0.27 0.26,0.26 0.24,0.25 0.23,0.23 0.21,0.22 0.19,0.2 0.18,0.19 0.16,0.18 0.14,0.16 0.13,0.15 0.11,0.13 0.1,0.12 0.08,0.1 0.07,0.08 0.05,0.07 0.04,0.05 0.03,0.03 0.01,0.02 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;innerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0.1,0 0.2,0 0.2,0 0.2,0 0.2,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.01 0.19,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.18,0.02 0.17,0.03 0.17,0.03 0.17,0.03 0.17,0.03 0.17,0.03 0.16,0.03 0.16,0.03 0.16,0.03 0.16,0.04 0.16,0.04 0.16,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.15,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.14,0.04 0.13,0.05 0.13,0.05 0.13,0.05 0.13,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.12,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.11,0.05 0.1,0.05 0.1,0.05 0.1,0.05 0.1,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.09,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.08,0.05 0.07,0.05 0.07,0.05 0.07,0.05 0.07,0.05 0.06,0.04 0.06,0.04 0.06,0.04 0.06,0.04 0.06,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.05,0.04 0.04,0.04 0.04,0.04 0.04,0.04 0.04,0.03 0.04,0.03 0.04,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.03,0.03 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.02,0.02 0.01,0.02 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0.01,0.01 0,0.01 0,0 0,0 0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/innerBoundaryIs&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9444"><span class="lineNum">    9444 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml2( doc, 2 ) );</span></a>
<a name="9445"><span class="lineNum">    9445 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec2 );</span></a>
<a name="9446"><span class="lineNum">    9446 </span>                :            : </a>
<a name="9447"><span class="lineNum">    9447 </span>                :            :   //as GML3</a>
<a name="9448"><span class="lineNum">    9448 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 0.10000000000000001 0 11 0.20000000000000001 0 12 0.10000000000000001 0.05 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9449"><span class="lineNum">    9449 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc ) );</span></a>
<a name="9450"><span class="lineNum">    9450 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3 );</span></a>
<a name="9451"><span class="lineNum">    9451 </span>                :            : </a>
<a name="9452"><span class="lineNum">    9452 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 1 0 11 2 0 12 1 0.5 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/exterior&gt;&lt;interior xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;3\&quot;&gt;0 0 10 0.1 0 11 0.2 0 12 0.1 0.05 13 0 0 10&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/interior&gt;&lt;/Polygon&gt;&quot; ) );</span></a>
<a name="9453"><span class="lineNum">    9453 </span>                :<span class="lineCov">          1 :   res = elemToString( exportPolygon.asGml3( doc, 3 ) );</span></a>
<a name="9454"><span class="lineNum">    9454 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="9455"><span class="lineNum">    9455 </span>                :            : </a>
<a name="9456"><span class="lineNum">    9456 </span>                :            :   //removing the fourth to last vertex removes the whole ring</a>
<a name="9457"><span class="lineNum">    9457 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p20;</span></a>
<a name="9458"><span class="lineNum">    9458 </span>                :<span class="lineCov">          1 :   QgsCircularString *p20ExteriorRing = new QgsCircularString();</span></a>
<a name="9459"><span class="lineNum">    9459 </span>                :<span class="lineCov">          1 :   p20ExteriorRing-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9460"><span class="lineNum">    9460 </span>                :<span class="lineCov">          1 :   p20.setExteriorRing( p20ExteriorRing );</span></a>
<a name="9461"><span class="lineNum">    9461 </span>                :<span class="lineCov">          1 :   QVERIFY( p20.exteriorRing() );</span></a>
<a name="9462"><span class="lineNum">    9462 </span>                :<span class="lineCov">          1 :   p20.deleteVertex( QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9463"><span class="lineNum">    9463 </span>                :<span class="lineCov">          1 :   QVERIFY( !p20.exteriorRing() );</span></a>
<a name="9464"><span class="lineNum">    9464 </span>                :            : </a>
<a name="9465"><span class="lineNum">    9465 </span>                :            :   //boundary</a>
<a name="9466"><span class="lineNum">    9466 </span>                :<span class="lineCov">          1 :   QgsCircularString boundary1;</span></a>
<a name="9467"><span class="lineNum">    9467 </span>                :<span class="lineCov">          2 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 1, 0, 2 ) &lt;&lt; QgsPoint( 2, 0, 3 )</span></a>
<a name="9468"><span class="lineNum">    9468 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 1, 0.5, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9469"><span class="lineNum">    9469 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon boundaryPolygon;</span></a>
<a name="9470"><span class="lineNum">    9470 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryPolygon.boundary() );</span></a>
<a name="9471"><span class="lineNum">    9471 </span>                :            : </a>
<a name="9472"><span class="lineNum">    9472 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setExteriorRing( boundary1.clone() );</span></a>
<a name="9473"><span class="lineNum">    9473 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = boundaryPolygon.boundary();</span></a>
<a name="9474"><span class="lineNum">    9474 </span>                :<span class="lineCov">          1 :   QgsCircularString *lineBoundary = dynamic_cast&lt; QgsCircularString * &gt;( boundary );</span></a>
<a name="9475"><span class="lineNum">    9475 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="9476"><span class="lineNum">    9476 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 5 );</span></a>
<a name="9477"><span class="lineNum">    9477 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="9478"><span class="lineNum">    9478 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="9479"><span class="lineNum">    9479 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 2 ), 2.0 );</span></a>
<a name="9480"><span class="lineNum">    9480 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 3 ), 1.0 );</span></a>
<a name="9481"><span class="lineNum">    9481 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;xAt( 4 ), 0.0 );</span></a>
<a name="9482"><span class="lineNum">    9482 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="9483"><span class="lineNum">    9483 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="9484"><span class="lineNum">    9484 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 2 ), 0.0 );</span></a>
<a name="9485"><span class="lineNum">    9485 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 3 ), 0.5 );</span></a>
<a name="9486"><span class="lineNum">    9486 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;yAt( 4 ), 0.0 );</span></a>
<a name="9487"><span class="lineNum">    9487 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="9488"><span class="lineNum">    9488 </span>                :            : </a>
<a name="9489"><span class="lineNum">    9489 </span>                :            :   // add interior rings</a>
<a name="9490"><span class="lineNum">    9490 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryRing1;</span></a>
<a name="9491"><span class="lineNum">    9491 </span>                :<span class="lineCov">          1 :   boundaryRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.1, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.1 ) &lt;&lt; QgsPoint( 0.2, 0.2 ) );</span></a>
<a name="9492"><span class="lineNum">    9492 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryRing2;</span></a>
<a name="9493"><span class="lineNum">    9493 </span>                :<span class="lineCov">          1 :   boundaryRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0.8, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.8 ) &lt;&lt; QgsPoint( 0.9, 0.9 ) );</span></a>
<a name="9494"><span class="lineNum">    9494 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; boundaryRing1.clone() &lt;&lt; boundaryRing2.clone() );</span></a>
<a name="9495"><span class="lineNum">    9495 </span>                :<span class="lineCov">          1 :   boundary = boundaryPolygon.boundary();</span></a>
<a name="9496"><span class="lineNum">    9496 </span>                :<span class="lineCov">          1 :   QgsMultiCurve *multiLineBoundary = dynamic_cast&lt; QgsMultiCurve * &gt;( boundary );</span></a>
<a name="9497"><span class="lineNum">    9497 </span>                :<span class="lineCov">          1 :   QVERIFY( multiLineBoundary );</span></a>
<a name="9498"><span class="lineNum">    9498 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLineBoundary-&gt;numGeometries(), 3 );</span></a>
<a name="9499"><span class="lineNum">    9499 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;numPoints(), 5 );</span></a>
<a name="9500"><span class="lineNum">    9500 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="9501"><span class="lineNum">    9501 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="9502"><span class="lineNum">    9502 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 2 ), 2.0 );</span></a>
<a name="9503"><span class="lineNum">    9503 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 3 ), 1.0 );</span></a>
<a name="9504"><span class="lineNum">    9504 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 4 ), 0.0 );</span></a>
<a name="9505"><span class="lineNum">    9505 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="9506"><span class="lineNum">    9506 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="9507"><span class="lineNum">    9507 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 2 ), 0.0 );</span></a>
<a name="9508"><span class="lineNum">    9508 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 3 ), 0.5 );</span></a>
<a name="9509"><span class="lineNum">    9509 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 4 ), 0.0 );</span></a>
<a name="9510"><span class="lineNum">    9510 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;numPoints(), 3 );</span></a>
<a name="9511"><span class="lineNum">    9511 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 0 ), 0.1 );</span></a>
<a name="9512"><span class="lineNum">    9512 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 1 ), 0.2 );</span></a>
<a name="9513"><span class="lineNum">    9513 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 2 ), 0.2 );</span></a>
<a name="9514"><span class="lineNum">    9514 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 0 ), 0.1 );</span></a>
<a name="9515"><span class="lineNum">    9515 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 1 ), 0.1 );</span></a>
<a name="9516"><span class="lineNum">    9516 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 2 ), 0.2 );</span></a>
<a name="9517"><span class="lineNum">    9517 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;numPoints(), 3 );</span></a>
<a name="9518"><span class="lineNum">    9518 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 0 ), 0.8 );</span></a>
<a name="9519"><span class="lineNum">    9519 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 1 ), 0.9 );</span></a>
<a name="9520"><span class="lineNum">    9520 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 2 ), 0.9 );</span></a>
<a name="9521"><span class="lineNum">    9521 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 0 ), 0.8 );</span></a>
<a name="9522"><span class="lineNum">    9522 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 1 ), 0.8 );</span></a>
<a name="9523"><span class="lineNum">    9523 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsCircularString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 2 ), 0.9 );</span></a>
<a name="9524"><span class="lineNum">    9524 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setInteriorRings( QVector&lt; QgsCurve * &gt;() );</span></a>
<a name="9525"><span class="lineNum">    9525 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="9526"><span class="lineNum">    9526 </span>                :            : </a>
<a name="9527"><span class="lineNum">    9527 </span>                :            :   //test boundary with z</a>
<a name="9528"><span class="lineNum">    9528 </span>                :<span class="lineCov">          2 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 )</span></a>
<a name="9529"><span class="lineNum">    9529 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="9530"><span class="lineNum">    9530 </span>                :<span class="lineCov">          1 :   boundaryPolygon.setExteriorRing( boundary1.clone() );</span></a>
<a name="9531"><span class="lineNum">    9531 </span>                :<span class="lineCov">          1 :   boundary = boundaryPolygon.boundary();</span></a>
<a name="9532"><span class="lineNum">    9532 </span>                :<span class="lineCov">          1 :   lineBoundary = dynamic_cast&lt; QgsCircularString * &gt;( boundary );</span></a>
<a name="9533"><span class="lineNum">    9533 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="9534"><span class="lineNum">    9534 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numPoints(), 3 );</span></a>
<a name="9535"><span class="lineNum">    9535 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;wkbType(), QgsWkbTypes::CircularStringZ );</span></a>
<a name="9536"><span class="lineNum">    9536 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 0 ).z(), 10.0 );</span></a>
<a name="9537"><span class="lineNum">    9537 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 1 ).z(), 15.0 );</span></a>
<a name="9538"><span class="lineNum">    9538 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;pointN( 2 ).z(), 20.0 );</span></a>
<a name="9539"><span class="lineNum">    9539 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="9540"><span class="lineNum">    9540 </span>                :            : </a>
<a name="9541"><span class="lineNum">    9541 </span>                :            :   // remove interior rings</a>
<a name="9542"><span class="lineNum">    9542 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsExt;</span></a>
<a name="9543"><span class="lineNum">    9543 </span>                :<span class="lineCov">          1 :   removeRingsExt.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 )  &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9544"><span class="lineNum">    9544 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon removeRings1;</span></a>
<a name="9545"><span class="lineNum">    9545 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="9546"><span class="lineNum">    9546 </span>                :            : </a>
<a name="9547"><span class="lineNum">    9547 </span>                :<span class="lineCov">          1 :   removeRings1.setExteriorRing( boundary1.clone() );</span></a>
<a name="9548"><span class="lineNum">    9548 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="9549"><span class="lineNum">    9549 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="9550"><span class="lineNum">    9550 </span>                :            : </a>
<a name="9551"><span class="lineNum">    9551 </span>                :            :   // add interior rings</a>
<a name="9552"><span class="lineNum">    9552 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsRing1;</span></a>
<a name="9553"><span class="lineNum">    9553 </span>                :<span class="lineCov">          2 :   removeRingsRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 0.1, 1, 2 ) &lt;&lt; QgsPoint( 0, 2, 3 )</span></a>
<a name="9554"><span class="lineNum">    9554 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( -0.1, 1.2, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9555"><span class="lineNum">    9555 </span>                :<span class="lineCov">          1 :   QgsCircularString removeRingsRing2;</span></a>
<a name="9556"><span class="lineNum">    9556 </span>                :<span class="lineCov">          2 :   removeRingsRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0, 1 ) &lt;&lt; QgsPoint( 0.01, 0.1, 2 ) &lt;&lt; QgsPoint( 0, 0.2, 3 )</span></a>
<a name="9557"><span class="lineNum">    9557 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( -0.01, 0.12, 4 ) &lt;&lt; QgsPoint( 0, 0, 1 ) );</span></a>
<a name="9558"><span class="lineNum">    9558 </span>                :<span class="lineCov">          1 :   removeRings1.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; removeRingsRing1.clone() &lt;&lt; removeRingsRing2.clone() );</span></a>
<a name="9559"><span class="lineNum">    9559 </span>                :            : </a>
<a name="9560"><span class="lineNum">    9560 </span>                :            :   // remove ring with size filter</a>
<a name="9561"><span class="lineNum">    9561 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings( 0.05 );</span></a>
<a name="9562"><span class="lineNum">    9562 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 1 );</span></a>
<a name="9563"><span class="lineNum">    9563 </span>                :            : </a>
<a name="9564"><span class="lineNum">    9564 </span>                :            :   // remove ring with no size filter</a>
<a name="9565"><span class="lineNum">    9565 </span>                :<span class="lineCov">          1 :   removeRings1.removeInteriorRings();</span></a>
<a name="9566"><span class="lineNum">    9566 </span>                :<span class="lineCov">          1 :   QCOMPARE( removeRings1.numInteriorRings(), 0 );</span></a>
<a name="9567"><span class="lineNum">    9567 </span>                :            : </a>
<a name="9568"><span class="lineNum">    9568 </span>                :            :   // cast</a>
<a name="9569"><span class="lineNum">    9569 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsCurvePolygon().cast( nullptr ) );</span></a>
<a name="9570"><span class="lineNum">    9570 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon pCast;</span></a>
<a name="9571"><span class="lineNum">    9571 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast ) );</span></a>
<a name="9572"><span class="lineNum">    9572 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon pCast2;</span></a>
<a name="9573"><span class="lineNum">    9573 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonZ((0 0 0, 0 1 1, 1 0 2, 0 0 0))&quot; ) );</span></a>
<a name="9574"><span class="lineNum">    9574 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="9575"><span class="lineNum">    9575 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonM((0 0 1, 0 1 2, 1 0 3, 0 0 1))&quot; ) );</span></a>
<a name="9576"><span class="lineNum">    9576 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="9577"><span class="lineNum">    9577 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;CurvePolygonZM((0 0 0 1, 0 1 1 2, 1 0 2 3, 0 0 0 1))&quot; ) );</span></a>
<a name="9578"><span class="lineNum">    9578 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCurvePolygon().cast( &amp;pCast2 ) );</span></a>
<a name="9579"><span class="lineNum">    9579 </span>                :            : </a>
<a name="9580"><span class="lineNum">    9580 </span>                :            :   // draw - most tests are in test_qgsgeometry.py</a>
<a name="9581"><span class="lineNum">    9581 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon empty;</span></a>
<a name="9582"><span class="lineNum">    9582 </span>                :<span class="lineCov">          1 :   QPainter p;</span></a>
<a name="9583"><span class="lineNum">    9583 </span>                :<span class="lineCov">          1 :   empty.draw( p ); //no crash!</span></a>
<a name="9584"><span class="lineNum">    9584 </span>                :            : </a>
<a name="9585"><span class="lineNum">    9585 </span>                :            : </a>
<a name="9586"><span class="lineNum">    9586 </span>                :            :   // closestSegment</a>
<a name="9587"><span class="lineNum">    9587 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="9588"><span class="lineNum">    9588 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="9589"><span class="lineNum">    9589 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="9590"><span class="lineNum">    9590 </span>                :<span class="lineCov">          1 :   ( void )empty.closestSegment( QgsPoint( 1, 2 ), pt, v ); // empty curve, just want no crash</span></a>
<a name="9591"><span class="lineNum">    9591 </span>                :            : </a>
<a name="9592"><span class="lineNum">    9592 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon cp12;</span></a>
<a name="9593"><span class="lineNum">    9593 </span>                :<span class="lineCov">          1 :   QgsLineString cp12ls;</span></a>
<a name="9594"><span class="lineNum">    9594 </span>                :<span class="lineCov">          1 :   cp12ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="9595"><span class="lineNum">    9595 </span>                :<span class="lineCov">          1 :   cp12.setExteriorRing( cp12ls.clone() );</span></a>
<a name="9596"><span class="lineNum">    9596 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="9597"><span class="lineNum">    9597 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="9598"><span class="lineNum">    9598 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="9599"><span class="lineNum">    9599 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="9600"><span class="lineNum">    9600 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9601"><span class="lineNum">    9601 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="9602"><span class="lineNum">    9602 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="9603"><span class="lineNum">    9603 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="9604"><span class="lineNum">    9604 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="9605"><span class="lineNum">    9605 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9606"><span class="lineNum">    9606 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 6, 11.5 ), pt, v, &amp;leftOf ), 0.125000, 0.0001 );</span></a>
<a name="9607"><span class="lineNum">    9607 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.25, 0.01 );</span></a>
<a name="9608"><span class="lineNum">    9608 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.25, 0.01 );</span></a>
<a name="9609"><span class="lineNum">    9609 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="9610"><span class="lineNum">    9610 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="9611"><span class="lineNum">    9611 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="9612"><span class="lineNum">    9612 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="9613"><span class="lineNum">    9613 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="9614"><span class="lineNum">    9614 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9615"><span class="lineNum">    9615 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9616"><span class="lineNum">    9616 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="9617"><span class="lineNum">    9617 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="9618"><span class="lineNum">    9618 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="9619"><span class="lineNum">    9619 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9620"><span class="lineNum">    9620 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="9621"><span class="lineNum">    9621 </span>                :            :   // point directly on segment</a>
<a name="9622"><span class="lineNum">    9622 </span>                :<span class="lineCov">          1 :   QCOMPARE( cp12.closestSegment( QgsPoint( 5, 15 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="9623"><span class="lineNum">    9623 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 5, 15 ) );</span></a>
<a name="9624"><span class="lineNum">    9624 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9625"><span class="lineNum">    9625 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="9626"><span class="lineNum">    9626 </span>                :            : </a>
<a name="9627"><span class="lineNum">    9627 </span>                :            :   // with interior ring</a>
<a name="9628"><span class="lineNum">    9628 </span>                :<span class="lineCov">          1 :   cp12ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6, 11.5 ) &lt;&lt; QgsPoint( 6.5, 12 ) &lt;&lt; QgsPoint( 6, 13 ) &lt;&lt; QgsPoint( 6, 11.5 ) );</span></a>
<a name="9629"><span class="lineNum">    9629 </span>                :<span class="lineCov">          1 :   cp12.addInteriorRing( cp12ls.clone() );</span></a>
<a name="9630"><span class="lineNum">    9630 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="9631"><span class="lineNum">    9631 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="9632"><span class="lineNum">    9632 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="9633"><span class="lineNum">    9633 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="9634"><span class="lineNum">    9634 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9635"><span class="lineNum">    9635 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="9636"><span class="lineNum">    9636 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="9637"><span class="lineNum">    9637 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="9638"><span class="lineNum">    9638 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="9639"><span class="lineNum">    9639 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9640"><span class="lineNum">    9640 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 6, 11.4 ), pt, v, &amp;leftOf ), 0.01, 0.0001 );</span></a>
<a name="9641"><span class="lineNum">    9641 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.0, 0.01 );</span></a>
<a name="9642"><span class="lineNum">    9642 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.5, 0.01 );</span></a>
<a name="9643"><span class="lineNum">    9643 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="9644"><span class="lineNum">    9644 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9645"><span class="lineNum">    9645 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="9646"><span class="lineNum">    9646 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="9647"><span class="lineNum">    9647 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="9648"><span class="lineNum">    9648 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9649"><span class="lineNum">    9649 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="9650"><span class="lineNum">    9650 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( cp12.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="9651"><span class="lineNum">    9651 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="9652"><span class="lineNum">    9652 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="9653"><span class="lineNum">    9653 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9654"><span class="lineNum">    9654 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="9655"><span class="lineNum">    9655 </span>                :            :   // point directly on segment</a>
<a name="9656"><span class="lineNum">    9656 </span>                :<span class="lineCov">          1 :   QCOMPARE( cp12.closestSegment( QgsPoint( 6, 13 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="9657"><span class="lineNum">    9657 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6, 13 ) );</span></a>
<a name="9658"><span class="lineNum">    9658 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="9659"><span class="lineNum">    9659 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="9660"><span class="lineNum">    9660 </span>                :            : </a>
<a name="9661"><span class="lineNum">    9661 </span>                :            :   //nextVertex</a>
<a name="9662"><span class="lineNum">    9662 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon cp13;</span></a>
<a name="9663"><span class="lineNum">    9663 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9664"><span class="lineNum">    9664 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="9665"><span class="lineNum">    9665 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9666"><span class="lineNum">    9666 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="9667"><span class="lineNum">    9667 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9668"><span class="lineNum">    9668 </span>                :<span class="lineCov">          1 :   QgsLineString lp22;</span></a>
<a name="9669"><span class="lineNum">    9669 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9670"><span class="lineNum">    9670 </span>                :<span class="lineCov">          1 :   cp13.setExteriorRing( lp22.clone() );</span></a>
<a name="9671"><span class="lineNum">    9671 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 4 ); //out of range</span></a>
<a name="9672"><span class="lineNum">    9672 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9673"><span class="lineNum">    9673 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="9674"><span class="lineNum">    9674 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9675"><span class="lineNum">    9675 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="9676"><span class="lineNum">    9676 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9677"><span class="lineNum">    9677 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="9678"><span class="lineNum">    9678 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="9679"><span class="lineNum">    9679 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9680"><span class="lineNum">    9680 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="9681"><span class="lineNum">    9681 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="9682"><span class="lineNum">    9682 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9683"><span class="lineNum">    9683 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="9684"><span class="lineNum">    9684 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 12 ) );</span></a>
<a name="9685"><span class="lineNum">    9685 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9686"><span class="lineNum">    9686 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="9687"><span class="lineNum">    9687 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="9688"><span class="lineNum">    9688 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 0 );</span></a>
<a name="9689"><span class="lineNum">    9689 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9690"><span class="lineNum">    9690 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="9691"><span class="lineNum">    9691 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9692"><span class="lineNum">    9692 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) ); //test that part number is maintained</span></a>
<a name="9693"><span class="lineNum">    9693 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="9694"><span class="lineNum">    9694 </span>                :            :   // add interior ring</a>
<a name="9695"><span class="lineNum">    9695 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="9696"><span class="lineNum">    9696 </span>                :<span class="lineCov">          1 :   cp13.addInteriorRing( lp22.clone() );</span></a>
<a name="9697"><span class="lineNum">    9697 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, 4 ); //out of range</span></a>
<a name="9698"><span class="lineNum">    9698 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9699"><span class="lineNum">    9699 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -5 );</span></a>
<a name="9700"><span class="lineNum">    9700 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9701"><span class="lineNum">    9701 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 1, -1 );</span></a>
<a name="9702"><span class="lineNum">    9702 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9703"><span class="lineNum">    9703 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 0 ) );</span></a>
<a name="9704"><span class="lineNum">    9704 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="9705"><span class="lineNum">    9705 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9706"><span class="lineNum">    9706 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 1 ) );</span></a>
<a name="9707"><span class="lineNum">    9707 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="9708"><span class="lineNum">    9708 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9709"><span class="lineNum">    9709 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 2 ) );</span></a>
<a name="9710"><span class="lineNum">    9710 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 22 ) );</span></a>
<a name="9711"><span class="lineNum">    9711 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9712"><span class="lineNum">    9712 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 1, 3 ) );</span></a>
<a name="9713"><span class="lineNum">    9713 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="9714"><span class="lineNum">    9714 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 2, 0 );</span></a>
<a name="9715"><span class="lineNum">    9715 </span>                :<span class="lineCov">          1 :   QVERIFY( !cp13.nextVertex( v, pt ) );</span></a>
<a name="9716"><span class="lineNum">    9716 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 1, 0 );</span></a>
<a name="9717"><span class="lineNum">    9717 </span>                :<span class="lineCov">          1 :   QVERIFY( cp13.nextVertex( v, pt ) );</span></a>
<a name="9718"><span class="lineNum">    9718 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 1, 1 ) ); //test that part number is maintained</span></a>
<a name="9719"><span class="lineNum">    9719 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="9720"><span class="lineNum">    9720 </span>                :            : </a>
<a name="9721"><span class="lineNum">    9721 </span>                :            :   // dropZValue</a>
<a name="9722"><span class="lineNum">    9722 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p23;</span></a>
<a name="9723"><span class="lineNum">    9723 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="9724"><span class="lineNum">    9724 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9725"><span class="lineNum">    9725 </span>                :<span class="lineCov">          1 :   QgsLineString lp23;</span></a>
<a name="9726"><span class="lineNum">    9726 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9727"><span class="lineNum">    9727 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9728"><span class="lineNum">    9728 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9729"><span class="lineNum">    9729 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9730"><span class="lineNum">    9730 </span>                :<span class="lineCov">          1 :   p23.dropZValue(); // not z</span></a>
<a name="9731"><span class="lineNum">    9731 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9732"><span class="lineNum">    9732 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9733"><span class="lineNum">    9733 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9734"><span class="lineNum">    9734 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9735"><span class="lineNum">    9735 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9736"><span class="lineNum">    9736 </span>                :            :   // with z</a>
<a name="9737"><span class="lineNum">    9737 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3 ) &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 1, 12, 23 ) &lt;&lt; QgsPoint( 1, 2, 3 ) );</span></a>
<a name="9738"><span class="lineNum">    9738 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="9739"><span class="lineNum">    9739 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9740"><span class="lineNum">    9740 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9741"><span class="lineNum">    9741 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="9742"><span class="lineNum">    9742 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="9743"><span class="lineNum">    9743 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9744"><span class="lineNum">    9744 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9745"><span class="lineNum">    9745 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9746"><span class="lineNum">    9746 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9747"><span class="lineNum">    9747 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9748"><span class="lineNum">    9748 </span>                :            :   // with zm</a>
<a name="9749"><span class="lineNum">    9749 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="9750"><span class="lineNum">    9750 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="9751"><span class="lineNum">    9751 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9752"><span class="lineNum">    9752 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9753"><span class="lineNum">    9753 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="9754"><span class="lineNum">    9754 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="9755"><span class="lineNum">    9755 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="9756"><span class="lineNum">    9756 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="9757"><span class="lineNum">    9757 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="9758"><span class="lineNum">    9758 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="9759"><span class="lineNum">    9759 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="9760"><span class="lineNum">    9760 </span>                :            : </a>
<a name="9761"><span class="lineNum">    9761 </span>                :            :   // dropMValue</a>
<a name="9762"><span class="lineNum">    9762 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="9763"><span class="lineNum">    9763 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="9764"><span class="lineNum">    9764 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9765"><span class="lineNum">    9765 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9766"><span class="lineNum">    9766 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9767"><span class="lineNum">    9767 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9768"><span class="lineNum">    9768 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9769"><span class="lineNum">    9769 </span>                :<span class="lineCov">          1 :   p23.dropMValue(); // not zm</span></a>
<a name="9770"><span class="lineNum">    9770 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9771"><span class="lineNum">    9771 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9772"><span class="lineNum">    9772 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9773"><span class="lineNum">    9773 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9774"><span class="lineNum">    9774 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9775"><span class="lineNum">    9775 </span>                :            :   // with m</a>
<a name="9776"><span class="lineNum">    9776 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 12, 0, 23 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) );</span></a>
<a name="9777"><span class="lineNum">    9777 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="9778"><span class="lineNum">    9778 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9779"><span class="lineNum">    9779 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9780"><span class="lineNum">    9780 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonM );</span></a>
<a name="9781"><span class="lineNum">    9781 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="9782"><span class="lineNum">    9782 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygon );</span></a>
<a name="9783"><span class="lineNum">    9783 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9784"><span class="lineNum">    9784 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9785"><span class="lineNum">    9785 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="9786"><span class="lineNum">    9786 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="9787"><span class="lineNum">    9787 </span>                :            :   // with zm</a>
<a name="9788"><span class="lineNum">    9788 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="9789"><span class="lineNum">    9789 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="9790"><span class="lineNum">    9790 </span>                :<span class="lineCov">          1 :   p23.setExteriorRing( lp23.clone() );</span></a>
<a name="9791"><span class="lineNum">    9791 </span>                :<span class="lineCov">          1 :   p23.addInteriorRing( lp23.clone() );</span></a>
<a name="9792"><span class="lineNum">    9792 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonZM );</span></a>
<a name="9793"><span class="lineNum">    9793 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="9794"><span class="lineNum">    9794 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::CurvePolygonZ );</span></a>
<a name="9795"><span class="lineNum">    9795 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.exteriorRing()-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="9796"><span class="lineNum">    9796 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="9797"><span class="lineNum">    9797 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.interiorRing( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="9798"><span class="lineNum">    9798 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="9799"><span class="lineNum">    9799 </span>                :            : </a>
<a name="9800"><span class="lineNum">    9800 </span>                :            : </a>
<a name="9801"><span class="lineNum">    9801 </span>                :            :   // hasCurvedSegments</a>
<a name="9802"><span class="lineNum">    9802 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p24;</span></a>
<a name="9803"><span class="lineNum">    9803 </span>                :<span class="lineCov">          1 :   QVERIFY( !p24.hasCurvedSegments() );</span></a>
<a name="9804"><span class="lineNum">    9804 </span>                :<span class="lineCov">          1 :   QgsLineString lp24;</span></a>
<a name="9805"><span class="lineNum">    9805 </span>                :<span class="lineCov">          1 :   lp24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9806"><span class="lineNum">    9806 </span>                :<span class="lineCov">          1 :   p24.setExteriorRing( lp23.clone() );</span></a>
<a name="9807"><span class="lineNum">    9807 </span>                :<span class="lineCov">          1 :   QVERIFY( !p24.hasCurvedSegments() );</span></a>
<a name="9808"><span class="lineNum">    9808 </span>                :<span class="lineCov">          1 :   QgsCircularString cs24;</span></a>
<a name="9809"><span class="lineNum">    9809 </span>                :<span class="lineCov">          1 :   cs24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9810"><span class="lineNum">    9810 </span>                :<span class="lineCov">          1 :   p24.addInteriorRing( cs24.clone() );</span></a>
<a name="9811"><span class="lineNum">    9811 </span>                :<span class="lineCov">          1 :   QVERIFY( p24.hasCurvedSegments() );</span></a>
<a name="9812"><span class="lineNum">    9812 </span>                :            : </a>
<a name="9813"><span class="lineNum">    9813 </span>                :            :   //vertexAngle</a>
<a name="9814"><span class="lineNum">    9814 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p25;</span></a>
<a name="9815"><span class="lineNum">    9815 </span>                :<span class="lineCov">          1 :   ( void )p25.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="9816"><span class="lineNum">    9816 </span>                :<span class="lineCov">          1 :   ( void )p25.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="9817"><span class="lineNum">    9817 </span>                :<span class="lineCov">          1 :   ( void )p25.vertexAngle( QgsVertexId( 0, 1, 0 ) ); //just want no crash</span></a>
<a name="9818"><span class="lineNum">    9818 </span>                :<span class="lineCov">          1 :   QgsLineString l38;</span></a>
<a name="9819"><span class="lineNum">    9819 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="9820"><span class="lineNum">    9820 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9821"><span class="lineNum">    9821 </span>                :<span class="lineCov">          1 :   p25.setExteriorRing( l38.clone() );</span></a>
<a name="9822"><span class="lineNum">    9822 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="9823"><span class="lineNum">    9823 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="9824"><span class="lineNum">    9824 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="9825"><span class="lineNum">    9825 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="9826"><span class="lineNum">    9826 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="9827"><span class="lineNum">    9827 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="9828"><span class="lineNum">    9828 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="9829"><span class="lineNum">    9829 </span>                :<span class="lineCov">          1 :   p25.addInteriorRing( l38.clone() );</span></a>
<a name="9830"><span class="lineNum">    9830 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="9831"><span class="lineNum">    9831 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="9832"><span class="lineNum">    9832 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="9833"><span class="lineNum">    9833 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="9834"><span class="lineNum">    9834 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="9835"><span class="lineNum">    9835 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="9836"><span class="lineNum">    9836 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p25.vertexAngle( QgsVertexId( 0, 1, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="9837"><span class="lineNum">    9837 </span>                :            : </a>
<a name="9838"><span class="lineNum">    9838 </span>                :            : </a>
<a name="9839"><span class="lineNum">    9839 </span>                :            :   //insert vertex</a>
<a name="9840"><span class="lineNum">    9840 </span>                :            : </a>
<a name="9841"><span class="lineNum">    9841 </span>                :            :   //insert vertex in empty polygon</a>
<a name="9842"><span class="lineNum">    9842 </span>                :<span class="lineCov">          1 :   p25.clear();</span></a>
<a name="9843"><span class="lineNum">    9843 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9844"><span class="lineNum">    9844 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9845"><span class="lineNum">    9845 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9846"><span class="lineNum">    9846 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9847"><span class="lineNum">    9847 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.isEmpty() );</span></a>
<a name="9848"><span class="lineNum">    9848 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="9849"><span class="lineNum">    9849 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="9850"><span class="lineNum">    9850 </span>                :<span class="lineCov">          1 :   p25.setExteriorRing( l38.clone() );</span></a>
<a name="9851"><span class="lineNum">    9851 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="9852"><span class="lineNum">    9852 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 8 );</span></a>
<a name="9853"><span class="lineNum">    9853 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9854"><span class="lineNum">    9854 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9855"><span class="lineNum">    9855 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9856"><span class="lineNum">    9856 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9857"><span class="lineNum">    9857 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9858"><span class="lineNum">    9858 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9859"><span class="lineNum">    9859 </span>                :            :   // first vertex</a>
<a name="9860"><span class="lineNum">    9860 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="9861"><span class="lineNum">    9861 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 9 );</span></a>
<a name="9862"><span class="lineNum">    9862 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9863"><span class="lineNum">    9863 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9864"><span class="lineNum">    9864 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9865"><span class="lineNum">    9865 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9866"><span class="lineNum">    9866 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="9867"><span class="lineNum">    9867 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9868"><span class="lineNum">    9868 </span>                :            :   // last vertex</a>
<a name="9869"><span class="lineNum">    9869 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="9870"><span class="lineNum">    9870 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 10 );</span></a>
<a name="9871"><span class="lineNum">    9871 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="9872"><span class="lineNum">    9872 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9873"><span class="lineNum">    9873 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9874"><span class="lineNum">    9874 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9875"><span class="lineNum">    9875 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9876"><span class="lineNum">    9876 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.exteriorRing() )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="9877"><span class="lineNum">    9877 </span>                :            :   // with interior ring</a>
<a name="9878"><span class="lineNum">    9878 </span>                :<span class="lineCov">          1 :   p25.addInteriorRing( l38.clone() );</span></a>
<a name="9879"><span class="lineNum">    9879 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 17 );</span></a>
<a name="9880"><span class="lineNum">    9880 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="9881"><span class="lineNum">    9881 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 18 );</span></a>
<a name="9882"><span class="lineNum">    9882 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9883"><span class="lineNum">    9883 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9884"><span class="lineNum">    9884 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9885"><span class="lineNum">    9885 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9886"><span class="lineNum">    9886 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9887"><span class="lineNum">    9887 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9888"><span class="lineNum">    9888 </span>                :            :   // first vertex in interior ring</a>
<a name="9889"><span class="lineNum">    9889 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="9890"><span class="lineNum">    9890 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 19 );</span></a>
<a name="9891"><span class="lineNum">    9891 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9892"><span class="lineNum">    9892 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9893"><span class="lineNum">    9893 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9894"><span class="lineNum">    9894 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9895"><span class="lineNum">    9895 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="9896"><span class="lineNum">    9896 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9897"><span class="lineNum">    9897 </span>                :            :   // last vertex in interior ring</a>
<a name="9898"><span class="lineNum">    9898 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 1, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="9899"><span class="lineNum">    9899 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 20 );</span></a>
<a name="9900"><span class="lineNum">    9900 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="9901"><span class="lineNum">    9901 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="9902"><span class="lineNum">    9902 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="9903"><span class="lineNum">    9903 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="9904"><span class="lineNum">    9904 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="9905"><span class="lineNum">    9905 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.interiorRing( 0 ) )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="9906"><span class="lineNum">    9906 </span>                :            : </a>
<a name="9907"><span class="lineNum">    9907 </span>                :            :   //move vertex</a>
<a name="9908"><span class="lineNum">    9908 </span>                :            : </a>
<a name="9909"><span class="lineNum">    9909 </span>                :            :   //empty polygon</a>
<a name="9910"><span class="lineNum">    9910 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p26;</span></a>
<a name="9911"><span class="lineNum">    9911 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9912"><span class="lineNum">    9912 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.isEmpty() );</span></a>
<a name="9913"><span class="lineNum">    9913 </span>                :            : </a>
<a name="9914"><span class="lineNum">    9914 </span>                :            :   //valid polygon</a>
<a name="9915"><span class="lineNum">    9915 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="9916"><span class="lineNum">    9916 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9917"><span class="lineNum">    9917 </span>                :<span class="lineCov">          1 :   p26.setExteriorRing( l38.clone() );</span></a>
<a name="9918"><span class="lineNum">    9918 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9919"><span class="lineNum">    9919 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="9920"><span class="lineNum">    9920 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="9921"><span class="lineNum">    9921 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9922"><span class="lineNum">    9922 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="9923"><span class="lineNum">    9923 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="9924"><span class="lineNum">    9924 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9925"><span class="lineNum">    9925 </span>                :            : </a>
<a name="9926"><span class="lineNum">    9926 </span>                :            :   //out of range</a>
<a name="9927"><span class="lineNum">    9927 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9928"><span class="lineNum">    9928 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9929"><span class="lineNum">    9929 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9930"><span class="lineNum">    9930 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9931"><span class="lineNum">    9931 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="9932"><span class="lineNum">    9932 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="9933"><span class="lineNum">    9933 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9934"><span class="lineNum">    9934 </span>                :            : </a>
<a name="9935"><span class="lineNum">    9935 </span>                :            :   // with interior ring</a>
<a name="9936"><span class="lineNum">    9936 </span>                :<span class="lineCov">          1 :   p26.addInteriorRing( l38.clone() );</span></a>
<a name="9937"><span class="lineNum">    9937 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="9938"><span class="lineNum">    9938 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="9939"><span class="lineNum">    9939 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 1, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="9940"><span class="lineNum">    9940 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9941"><span class="lineNum">    9941 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="9942"><span class="lineNum">    9942 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="9943"><span class="lineNum">    9943 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="9944"><span class="lineNum">    9944 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9945"><span class="lineNum">    9945 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 1, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9946"><span class="lineNum">    9946 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 2, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="9947"><span class="lineNum">    9947 </span>                :            : </a>
<a name="9948"><span class="lineNum">    9948 </span>                :            :   //delete vertex</a>
<a name="9949"><span class="lineNum">    9949 </span>                :            : </a>
<a name="9950"><span class="lineNum">    9950 </span>                :            :   //empty polygon</a>
<a name="9951"><span class="lineNum">    9951 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon p27;</span></a>
<a name="9952"><span class="lineNum">    9952 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="9953"><span class="lineNum">    9953 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="9954"><span class="lineNum">    9954 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.isEmpty() );</span></a>
<a name="9955"><span class="lineNum">    9955 </span>                :            : </a>
<a name="9956"><span class="lineNum">    9956 </span>                :            :   //valid polygon</a>
<a name="9957"><span class="lineNum">    9957 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 5, 2 ) &lt;&lt; QgsPoint( 6, 2 ) &lt;&lt; QgsPoint( 7, 2 )</span></a>
<a name="9958"><span class="lineNum">    9958 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="9959"><span class="lineNum">    9959 </span>                :            : </a>
<a name="9960"><span class="lineNum">    9960 </span>                :<span class="lineCov">          1 :   p27.setExteriorRing( l38.clone() );</span></a>
<a name="9961"><span class="lineNum">    9961 </span>                :            :   //out of range vertices</a>
<a name="9962"><span class="lineNum">    9962 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="9963"><span class="lineNum">    9963 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="9964"><span class="lineNum">    9964 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="9965"><span class="lineNum">    9965 </span>                :            : </a>
<a name="9966"><span class="lineNum">    9966 </span>                :            :   //valid vertices</a>
<a name="9967"><span class="lineNum">    9967 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="9968"><span class="lineNum">    9968 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="9969"><span class="lineNum">    9969 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="9970"><span class="lineNum">    9970 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="9971"><span class="lineNum">    9971 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="9972"><span class="lineNum">    9972 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="9973"><span class="lineNum">    9973 </span>                :            : </a>
<a name="9974"><span class="lineNum">    9974 </span>                :            :   // delete first vertex</a>
<a name="9975"><span class="lineNum">    9975 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="9976"><span class="lineNum">    9976 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="9977"><span class="lineNum">    9977 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="9978"><span class="lineNum">    9978 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="9979"><span class="lineNum">    9979 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="9980"><span class="lineNum">    9980 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="9981"><span class="lineNum">    9981 </span>                :            : </a>
<a name="9982"><span class="lineNum">    9982 </span>                :            :   // delete last vertex</a>
<a name="9983"><span class="lineNum">    9983 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 4 ) ) );</span></a>
<a name="9984"><span class="lineNum">    9984 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="9985"><span class="lineNum">    9985 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="9986"><span class="lineNum">    9986 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="9987"><span class="lineNum">    9987 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="9988"><span class="lineNum">    9988 </span>                :            : </a>
<a name="9989"><span class="lineNum">    9989 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="9990"><span class="lineNum">    9990 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="9991"><span class="lineNum">    9991 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.exteriorRing() );</span></a>
<a name="9992"><span class="lineNum">    9992 </span>                :            : </a>
<a name="9993"><span class="lineNum">    9993 </span>                :            :   // with interior ring</a>
<a name="9994"><span class="lineNum">    9994 </span>                :<span class="lineCov">          1 :   p27.setExteriorRing( l38.clone() );</span></a>
<a name="9995"><span class="lineNum">    9995 </span>                :<span class="lineCov">          1 :   p27.addInteriorRing( l38.clone() );</span></a>
<a name="9996"><span class="lineNum">    9996 </span>                :            : </a>
<a name="9997"><span class="lineNum">    9997 </span>                :            :   //out of range vertices</a>
<a name="9998"><span class="lineNum">    9998 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, -1 ) ) );</span></a>
<a name="9999"><span class="lineNum">    9999 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 100 ) ) );</span></a>
<a name="10000"><span class="lineNum">   10000 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 2, 1 ) ) );</span></a>
<a name="10001"><span class="lineNum">   10001 </span>                :            : </a>
<a name="10002"><span class="lineNum">   10002 </span>                :            :   //valid vertices</a>
<a name="10003"><span class="lineNum">   10003 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="10004"><span class="lineNum">   10004 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="10005"><span class="lineNum">   10005 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="10006"><span class="lineNum">   10006 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="10007"><span class="lineNum">   10007 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="10008"><span class="lineNum">   10008 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="10009"><span class="lineNum">   10009 </span>                :            : </a>
<a name="10010"><span class="lineNum">   10010 </span>                :            :   // delete first vertex</a>
<a name="10011"><span class="lineNum">   10011 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="10012"><span class="lineNum">   10012 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="10013"><span class="lineNum">   10013 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="10014"><span class="lineNum">   10014 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="10015"><span class="lineNum">   10015 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="10016"><span class="lineNum">   10016 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 4 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="10017"><span class="lineNum">   10017 </span>                :            : </a>
<a name="10018"><span class="lineNum">   10018 </span>                :            :   // delete last vertex</a>
<a name="10019"><span class="lineNum">   10019 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 4 ) ) );</span></a>
<a name="10020"><span class="lineNum">   10020 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 0 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="10021"><span class="lineNum">   10021 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="10022"><span class="lineNum">   10022 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="10023"><span class="lineNum">   10023 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.interiorRing( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="10024"><span class="lineNum">   10024 </span>                :            : </a>
<a name="10025"><span class="lineNum">   10025 </span>                :            :   // delete another vertex - should remove ring</a>
<a name="10026"><span class="lineNum">   10026 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 1, 1 ) ) );</span></a>
<a name="10027"><span class="lineNum">   10027 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 0 );</span></a>
<a name="10028"><span class="lineNum">   10028 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.exteriorRing() );</span></a>
<a name="10029"><span class="lineNum">   10029 </span>                :            : </a>
<a name="10030"><span class="lineNum">   10030 </span>                :            :   // test that interior ring is &quot;promoted&quot; when exterior is removed</a>
<a name="10031"><span class="lineNum">   10031 </span>                :<span class="lineCov">          1 :   p27.addInteriorRing( l38.clone() );</span></a>
<a name="10032"><span class="lineNum">   10032 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="10033"><span class="lineNum">   10033 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="10034"><span class="lineNum">   10034 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="10035"><span class="lineNum">   10035 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="10036"><span class="lineNum">   10036 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="10037"><span class="lineNum">   10037 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 1 );</span></a>
<a name="10038"><span class="lineNum">   10038 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="10039"><span class="lineNum">   10039 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numInteriorRings(), 0 );</span></a>
<a name="10040"><span class="lineNum">   10040 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.exteriorRing() );</span></a>
<a name="10041"><span class="lineNum">   10041 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="10042"><span class="lineNum">   10042 </span>                :            : </a>
<a name="10043"><span class="lineNum">   10043 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::compoundCurve()</span></a>
<a name="10044"><span class="lineNum">   10044 </span>                :            : {</a>
<a name="10045"><span class="lineNum">   10045 </span>                :            :   //test constructors</a>
<a name="10046"><span class="lineNum">   10046 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve l1;</span></a>
<a name="10047"><span class="lineNum">   10047 </span>                :<span class="lineCov">          1 :   QVERIFY( l1.isEmpty() );</span></a>
<a name="10048"><span class="lineNum">   10048 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.numPoints(), 0 );</span></a>
<a name="10049"><span class="lineNum">   10049 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.vertexCount(), 0 );</span></a>
<a name="10050"><span class="lineNum">   10050 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.nCoordinates(), 0 );</span></a>
<a name="10051"><span class="lineNum">   10051 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.ringCount(), 0 );</span></a>
<a name="10052"><span class="lineNum">   10052 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.partCount(), 0 );</span></a>
<a name="10053"><span class="lineNum">   10053 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.is3D() );</span></a>
<a name="10054"><span class="lineNum">   10054 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.isMeasure() );</span></a>
<a name="10055"><span class="lineNum">   10055 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10056"><span class="lineNum">   10056 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.wktTypeStr(), QString( &quot;CompoundCurve&quot; ) );</span></a>
<a name="10057"><span class="lineNum">   10057 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.geometryType(), QString( &quot;CompoundCurve&quot; ) );</span></a>
<a name="10058"><span class="lineNum">   10058 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.dimension(), 1 );</span></a>
<a name="10059"><span class="lineNum">   10059 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.hasCurvedSegments() );</span></a>
<a name="10060"><span class="lineNum">   10060 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.area(), 0.0 );</span></a>
<a name="10061"><span class="lineNum">   10061 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.perimeter(), 0.0 );</span></a>
<a name="10062"><span class="lineNum">   10062 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts;</span></a>
<a name="10063"><span class="lineNum">   10063 </span>                :<span class="lineCov">          1 :   l1.points( pts );</span></a>
<a name="10064"><span class="lineNum">   10064 </span>                :<span class="lineCov">          1 :   QVERIFY( pts.empty() );</span></a>
<a name="10065"><span class="lineNum">   10065 </span>                :            : </a>
<a name="10066"><span class="lineNum">   10066 </span>                :            :   // empty, test some methods to make sure they don't crash</a>
<a name="10067"><span class="lineNum">   10067 </span>                :<span class="lineCov">          1 :   QCOMPARE( l1.nCurves(), 0 );</span></a>
<a name="10068"><span class="lineNum">   10068 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.curveAt( -1 ) );</span></a>
<a name="10069"><span class="lineNum">   10069 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.curveAt( 0 ) );</span></a>
<a name="10070"><span class="lineNum">   10070 </span>                :<span class="lineCov">          1 :   QVERIFY( !l1.curveAt( 100 ) );</span></a>
<a name="10071"><span class="lineNum">   10071 </span>                :<span class="lineCov">          1 :   l1.removeCurve( -1 );</span></a>
<a name="10072"><span class="lineNum">   10072 </span>                :<span class="lineCov">          1 :   l1.removeCurve( 0 );</span></a>
<a name="10073"><span class="lineNum">   10073 </span>                :<span class="lineCov">          1 :   l1.removeCurve( 100 );</span></a>
<a name="10074"><span class="lineNum">   10074 </span>                :            : </a>
<a name="10075"><span class="lineNum">   10075 </span>                :            :   //addCurve</a>
<a name="10076"><span class="lineNum">   10076 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c1;</span></a>
<a name="10077"><span class="lineNum">   10077 </span>                :            :   //try to add null curve</a>
<a name="10078"><span class="lineNum">   10078 </span>                :<span class="lineCov">          1 :   c1.addCurve( nullptr );</span></a>
<a name="10079"><span class="lineNum">   10079 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCurves(), 0 );</span></a>
<a name="10080"><span class="lineNum">   10080 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.curveAt( 0 ) );</span></a>
<a name="10081"><span class="lineNum">   10081 </span>                :            : </a>
<a name="10082"><span class="lineNum">   10082 </span>                :<span class="lineCov">          1 :   QgsCircularString l2;</span></a>
<a name="10083"><span class="lineNum">   10083 </span>                :<span class="lineCov">          1 :   l2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="10084"><span class="lineNum">   10084 </span>                :<span class="lineCov">          1 :   c1.addCurve( l2.clone() );</span></a>
<a name="10085"><span class="lineNum">   10085 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="10086"><span class="lineNum">   10086 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numPoints(), 1 );</span></a>
<a name="10087"><span class="lineNum">   10087 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount(), 1 );</span></a>
<a name="10088"><span class="lineNum">   10088 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 1 );</span></a>
<a name="10089"><span class="lineNum">   10089 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="10090"><span class="lineNum">   10090 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="10091"><span class="lineNum">   10091 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="10092"><span class="lineNum">   10092 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="10093"><span class="lineNum">   10093 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10094"><span class="lineNum">   10094 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.hasCurvedSegments() );</span></a>
<a name="10095"><span class="lineNum">   10095 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="10096"><span class="lineNum">   10096 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="10097"><span class="lineNum">   10097 </span>                :<span class="lineCov">          1 :   c1.points( pts );</span></a>
<a name="10098"><span class="lineNum">   10098 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="10099"><span class="lineNum">   10099 </span>                :            : </a>
<a name="10100"><span class="lineNum">   10100 </span>                :            :   //adding first curve should set linestring z/m type</a>
<a name="10101"><span class="lineNum">   10101 </span>                :<span class="lineCov">          1 :   QgsCircularString l3;</span></a>
<a name="10102"><span class="lineNum">   10102 </span>                :<span class="lineCov">          1 :   l3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="10103"><span class="lineNum">   10103 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c2;</span></a>
<a name="10104"><span class="lineNum">   10104 </span>                :<span class="lineCov">          1 :   c2.addCurve( l3.clone() );</span></a>
<a name="10105"><span class="lineNum">   10105 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isEmpty() );</span></a>
<a name="10106"><span class="lineNum">   10106 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="10107"><span class="lineNum">   10107 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="10108"><span class="lineNum">   10108 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10109"><span class="lineNum">   10109 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;CompoundCurveZ&quot; ) );</span></a>
<a name="10110"><span class="lineNum">   10110 </span>                :<span class="lineCov">          1 :   c2.points( pts );</span></a>
<a name="10111"><span class="lineNum">   10111 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="10112"><span class="lineNum">   10112 </span>                :            : </a>
<a name="10113"><span class="lineNum">   10113 </span>                :<span class="lineCov">          1 :   QgsCircularString l4;</span></a>
<a name="10114"><span class="lineNum">   10114 </span>                :<span class="lineCov">          1 :   l4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="10115"><span class="lineNum">   10115 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c4;</span></a>
<a name="10116"><span class="lineNum">   10116 </span>                :<span class="lineCov">          1 :   c4.addCurve( l4.clone() );</span></a>
<a name="10117"><span class="lineNum">   10117 </span>                :<span class="lineCov">          1 :   QVERIFY( !c4.isEmpty() );</span></a>
<a name="10118"><span class="lineNum">   10118 </span>                :<span class="lineCov">          1 :   QVERIFY( !c4.is3D() );</span></a>
<a name="10119"><span class="lineNum">   10119 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="10120"><span class="lineNum">   10120 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10121"><span class="lineNum">   10121 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;CompoundCurveM&quot; ) );</span></a>
<a name="10122"><span class="lineNum">   10122 </span>                :<span class="lineCov">          1 :   c4.points( pts );</span></a>
<a name="10123"><span class="lineNum">   10123 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="10124"><span class="lineNum">   10124 </span>                :            : </a>
<a name="10125"><span class="lineNum">   10125 </span>                :<span class="lineCov">          1 :   QgsCircularString l5;</span></a>
<a name="10126"><span class="lineNum">   10126 </span>                :<span class="lineCov">          1 :   l5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="10127"><span class="lineNum">   10127 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c5;</span></a>
<a name="10128"><span class="lineNum">   10128 </span>                :<span class="lineCov">          1 :   c5.addCurve( l5.clone() );</span></a>
<a name="10129"><span class="lineNum">   10129 </span>                :<span class="lineCov">          1 :   QVERIFY( !c5.isEmpty() );</span></a>
<a name="10130"><span class="lineNum">   10130 </span>                :<span class="lineCov">          1 :   QVERIFY( c5.is3D() );</span></a>
<a name="10131"><span class="lineNum">   10131 </span>                :<span class="lineCov">          1 :   QVERIFY( c5.isMeasure() );</span></a>
<a name="10132"><span class="lineNum">   10132 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="10133"><span class="lineNum">   10133 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.wktTypeStr(), QString( &quot;CompoundCurveZM&quot; ) );</span></a>
<a name="10134"><span class="lineNum">   10134 </span>                :<span class="lineCov">          1 :   c5.points( pts );</span></a>
<a name="10135"><span class="lineNum">   10135 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="10136"><span class="lineNum">   10136 </span>                :            : </a>
<a name="10137"><span class="lineNum">   10137 </span>                :            :   //clear</a>
<a name="10138"><span class="lineNum">   10138 </span>                :<span class="lineCov">          1 :   c5.clear();</span></a>
<a name="10139"><span class="lineNum">   10139 </span>                :<span class="lineCov">          1 :   QVERIFY( c5.isEmpty() );</span></a>
<a name="10140"><span class="lineNum">   10140 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.nCurves(), 0 );</span></a>
<a name="10141"><span class="lineNum">   10141 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.numPoints(), 0 );</span></a>
<a name="10142"><span class="lineNum">   10142 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.vertexCount(), 0 );</span></a>
<a name="10143"><span class="lineNum">   10143 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.nCoordinates(), 0 );</span></a>
<a name="10144"><span class="lineNum">   10144 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.ringCount(), 0 );</span></a>
<a name="10145"><span class="lineNum">   10145 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.partCount(), 0 );</span></a>
<a name="10146"><span class="lineNum">   10146 </span>                :<span class="lineCov">          1 :   QVERIFY( !c5.is3D() );</span></a>
<a name="10147"><span class="lineNum">   10147 </span>                :<span class="lineCov">          1 :   QVERIFY( !c5.isMeasure() );</span></a>
<a name="10148"><span class="lineNum">   10148 </span>                :<span class="lineCov">          1 :   QCOMPARE( c5.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10149"><span class="lineNum">   10149 </span>                :            : </a>
<a name="10150"><span class="lineNum">   10150 </span>                :            :   //addCurve</a>
<a name="10151"><span class="lineNum">   10151 </span>                :<span class="lineCov">          1 :   QgsCircularString l8;</span></a>
<a name="10152"><span class="lineNum">   10152 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c8;</span></a>
<a name="10153"><span class="lineNum">   10153 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="10154"><span class="lineNum">   10154 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10155"><span class="lineNum">   10155 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isEmpty() );</span></a>
<a name="10156"><span class="lineNum">   10156 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 3 );</span></a>
<a name="10157"><span class="lineNum">   10157 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.vertexCount(), 3 );</span></a>
<a name="10158"><span class="lineNum">   10158 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCoordinates(), 3 );</span></a>
<a name="10159"><span class="lineNum">   10159 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.ringCount(), 1 );</span></a>
<a name="10160"><span class="lineNum">   10160 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.partCount(), 1 );</span></a>
<a name="10161"><span class="lineNum">   10161 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 1 );</span></a>
<a name="10162"><span class="lineNum">   10162 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10163"><span class="lineNum">   10163 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10164"><span class="lineNum">   10164 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10165"><span class="lineNum">   10165 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.hasCurvedSegments() );</span></a>
<a name="10166"><span class="lineNum">   10166 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10167"><span class="lineNum">   10167 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="10168"><span class="lineNum">   10168 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 0 ) ), l8 );</span></a>
<a name="10169"><span class="lineNum">   10169 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( -1 ) );</span></a>
<a name="10170"><span class="lineNum">   10170 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( 1 ) );</span></a>
<a name="10171"><span class="lineNum">   10171 </span>                :            : </a>
<a name="10172"><span class="lineNum">   10172 </span>                :<span class="lineCov">          1 :   QgsCircularString l8a;</span></a>
<a name="10173"><span class="lineNum">   10173 </span>                :<span class="lineCov">          1 :   l8a.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 3, 4 ) &lt;&lt; QgsPoint( 4, 5 ) &lt;&lt; QgsPoint( 3, 6 ) );</span></a>
<a name="10174"><span class="lineNum">   10174 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8a.clone() );</span></a>
<a name="10175"><span class="lineNum">   10175 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 5 );</span></a>
<a name="10176"><span class="lineNum">   10176 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.vertexCount(), 5 );</span></a>
<a name="10177"><span class="lineNum">   10177 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCoordinates(), 5 );</span></a>
<a name="10178"><span class="lineNum">   10178 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.ringCount(), 1 );</span></a>
<a name="10179"><span class="lineNum">   10179 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.partCount(), 1 );</span></a>
<a name="10180"><span class="lineNum">   10180 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 2 );</span></a>
<a name="10181"><span class="lineNum">   10181 </span>                :<span class="lineCov">          1 :   pts.clear();</span></a>
<a name="10182"><span class="lineNum">   10182 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10183"><span class="lineNum">   10183 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 )</span></a>
<a name="10184"><span class="lineNum">   10184 </span>                :            :             &lt;&lt; QgsPoint( 4, 5 ) &lt;&lt; QgsPoint( 3, 6 ) );</a>
<a name="10185"><span class="lineNum">   10185 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 0 ) ), l8 );</span></a>
<a name="10186"><span class="lineNum">   10186 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 1 ) ), l8a );</span></a>
<a name="10187"><span class="lineNum">   10187 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( -1 ) );</span></a>
<a name="10188"><span class="lineNum">   10188 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( 2 ) );</span></a>
<a name="10189"><span class="lineNum">   10189 </span>                :            : </a>
<a name="10190"><span class="lineNum">   10190 </span>                :<span class="lineCov">          1 :   QgsLineString l8b;</span></a>
<a name="10191"><span class="lineNum">   10191 </span>                :<span class="lineCov">          1 :   l8b.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 3, 6 ) &lt;&lt; QgsPoint( 4, 6 ) );</span></a>
<a name="10192"><span class="lineNum">   10192 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8b.clone() );</span></a>
<a name="10193"><span class="lineNum">   10193 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 6 );</span></a>
<a name="10194"><span class="lineNum">   10194 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.vertexCount(), 6 );</span></a>
<a name="10195"><span class="lineNum">   10195 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCoordinates(), 6 );</span></a>
<a name="10196"><span class="lineNum">   10196 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.ringCount(), 1 );</span></a>
<a name="10197"><span class="lineNum">   10197 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.partCount(), 1 );</span></a>
<a name="10198"><span class="lineNum">   10198 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 3 );</span></a>
<a name="10199"><span class="lineNum">   10199 </span>                :<span class="lineCov">          1 :   pts.clear();</span></a>
<a name="10200"><span class="lineNum">   10200 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10201"><span class="lineNum">   10201 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 )</span></a>
<a name="10202"><span class="lineNum">   10202 </span>                :            :             &lt;&lt; QgsPoint( 4, 5 ) &lt;&lt; QgsPoint( 3, 6 )</a>
<a name="10203"><span class="lineNum">   10203 </span>                :            :             &lt;&lt; QgsPoint( 4, 6 ) );</a>
<a name="10204"><span class="lineNum">   10204 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 0 ) ), l8 );</span></a>
<a name="10205"><span class="lineNum">   10205 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 1 ) ), l8a );</span></a>
<a name="10206"><span class="lineNum">   10206 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsLineString *&gt;( c8.curveAt( 2 ) ), l8b );</span></a>
<a name="10207"><span class="lineNum">   10207 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( -1 ) );</span></a>
<a name="10208"><span class="lineNum">   10208 </span>                :<span class="lineCov">          1 :   QVERIFY( ! c8.curveAt( 3 ) );</span></a>
<a name="10209"><span class="lineNum">   10209 </span>                :            : </a>
<a name="10210"><span class="lineNum">   10210 </span>                :            :   //removeCurve</a>
<a name="10211"><span class="lineNum">   10211 </span>                :<span class="lineCov">          1 :   c8.removeCurve( -1 );</span></a>
<a name="10212"><span class="lineNum">   10212 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 3 );</span></a>
<a name="10213"><span class="lineNum">   10213 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 3 );</span></a>
<a name="10214"><span class="lineNum">   10214 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 0 ) ), l8 );</span></a>
<a name="10215"><span class="lineNum">   10215 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 1 ) ), l8a );</span></a>
<a name="10216"><span class="lineNum">   10216 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsLineString *&gt;( c8.curveAt( 2 ) ), l8b );</span></a>
<a name="10217"><span class="lineNum">   10217 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10218"><span class="lineNum">   10218 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 2 );</span></a>
<a name="10219"><span class="lineNum">   10219 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsCircularString *&gt;( c8.curveAt( 0 ) ), l8 );</span></a>
<a name="10220"><span class="lineNum">   10220 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsLineString *&gt;( c8.curveAt( 1 ) ), l8b );</span></a>
<a name="10221"><span class="lineNum">   10221 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 0 );</span></a>
<a name="10222"><span class="lineNum">   10222 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 1 );</span></a>
<a name="10223"><span class="lineNum">   10223 </span>                :<span class="lineCov">          1 :   QCOMPARE( *dynamic_cast&lt; const QgsLineString *&gt;( c8.curveAt( 0 ) ), l8b );</span></a>
<a name="10224"><span class="lineNum">   10224 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 0 );</span></a>
<a name="10225"><span class="lineNum">   10225 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.nCurves(), 0 );</span></a>
<a name="10226"><span class="lineNum">   10226 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isEmpty() );</span></a>
<a name="10227"><span class="lineNum">   10227 </span>                :            : </a>
<a name="10228"><span class="lineNum">   10228 </span>                :            :   //addCurve with z</a>
<a name="10229"><span class="lineNum">   10229 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10230"><span class="lineNum">   10230 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="10231"><span class="lineNum">   10231 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10232"><span class="lineNum">   10232 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 2 );</span></a>
<a name="10233"><span class="lineNum">   10233 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.is3D() );</span></a>
<a name="10234"><span class="lineNum">   10234 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10235"><span class="lineNum">   10235 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10236"><span class="lineNum">   10236 </span>                :<span class="lineCov">          1 :   pts.clear();</span></a>
<a name="10237"><span class="lineNum">   10237 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10238"><span class="lineNum">   10238 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) );</span></a>
<a name="10239"><span class="lineNum">   10239 </span>                :            : </a>
<a name="10240"><span class="lineNum">   10240 </span>                :            :   //addCurve with m</a>
<a name="10241"><span class="lineNum">   10241 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10242"><span class="lineNum">   10242 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="10243"><span class="lineNum">   10243 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10244"><span class="lineNum">   10244 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 2 );</span></a>
<a name="10245"><span class="lineNum">   10245 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10246"><span class="lineNum">   10246 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isMeasure() );</span></a>
<a name="10247"><span class="lineNum">   10247 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10248"><span class="lineNum">   10248 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10249"><span class="lineNum">   10249 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) );</span></a>
<a name="10250"><span class="lineNum">   10250 </span>                :            : </a>
<a name="10251"><span class="lineNum">   10251 </span>                :            :   //addCurve with zm</a>
<a name="10252"><span class="lineNum">   10252 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10253"><span class="lineNum">   10253 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="10254"><span class="lineNum">   10254 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10255"><span class="lineNum">   10255 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.numPoints(), 2 );</span></a>
<a name="10256"><span class="lineNum">   10256 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.is3D() );</span></a>
<a name="10257"><span class="lineNum">   10257 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isMeasure() );</span></a>
<a name="10258"><span class="lineNum">   10258 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="10259"><span class="lineNum">   10259 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10260"><span class="lineNum">   10260 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 4, 5 ) );</span></a>
<a name="10261"><span class="lineNum">   10261 </span>                :            : </a>
<a name="10262"><span class="lineNum">   10262 </span>                :            :   //addCurve with z to non z compound curve</a>
<a name="10263"><span class="lineNum">   10263 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10264"><span class="lineNum">   10264 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 ) );</span></a>
<a name="10265"><span class="lineNum">   10265 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10266"><span class="lineNum">   10266 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10267"><span class="lineNum">   10267 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 3, 5 ) );</span></a>
<a name="10268"><span class="lineNum">   10268 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10269"><span class="lineNum">   10269 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10270"><span class="lineNum">   10270 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10271"><span class="lineNum">   10271 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10272"><span class="lineNum">   10272 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10273"><span class="lineNum">   10273 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 )</span></a>
<a name="10274"><span class="lineNum">   10274 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 3 ) );</a>
<a name="10275"><span class="lineNum">   10275 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10276"><span class="lineNum">   10276 </span>                :            : </a>
<a name="10277"><span class="lineNum">   10277 </span>                :            :   //addCurve with m to non m compound curve</a>
<a name="10278"><span class="lineNum">   10278 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 3, 0, 5 ) );</span></a>
<a name="10279"><span class="lineNum">   10279 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10280"><span class="lineNum">   10280 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10281"><span class="lineNum">   10281 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10282"><span class="lineNum">   10282 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10283"><span class="lineNum">   10283 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10284"><span class="lineNum">   10284 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 )</span></a>
<a name="10285"><span class="lineNum">   10285 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 3 ) );</a>
<a name="10286"><span class="lineNum">   10286 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10287"><span class="lineNum">   10287 </span>                :            : </a>
<a name="10288"><span class="lineNum">   10288 </span>                :            :   //addCurve with zm to non m compound curve</a>
<a name="10289"><span class="lineNum">   10289 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 6, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 3, 1, 5 ) );</span></a>
<a name="10290"><span class="lineNum">   10290 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10291"><span class="lineNum">   10291 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10292"><span class="lineNum">   10292 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10293"><span class="lineNum">   10293 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10294"><span class="lineNum">   10294 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10295"><span class="lineNum">   10295 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 )</span></a>
<a name="10296"><span class="lineNum">   10296 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 3 ) );</a>
<a name="10297"><span class="lineNum">   10297 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10298"><span class="lineNum">   10298 </span>                :            : </a>
<a name="10299"><span class="lineNum">   10299 </span>                :            :   //addCurve with no z to z compound curve</a>
<a name="10300"><span class="lineNum">   10300 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10301"><span class="lineNum">   10301 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 5 ) );</span></a>
<a name="10302"><span class="lineNum">   10302 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10303"><span class="lineNum">   10303 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10304"><span class="lineNum">   10304 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 4 ) );</span></a>
<a name="10305"><span class="lineNum">   10305 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10306"><span class="lineNum">   10306 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.is3D() );</span></a>
<a name="10307"><span class="lineNum">   10307 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10308"><span class="lineNum">   10308 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10309"><span class="lineNum">   10309 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10310"><span class="lineNum">   10310 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 5 )</span></a>
<a name="10311"><span class="lineNum">   10311 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 4, 0 ) );</a>
<a name="10312"><span class="lineNum">   10312 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10313"><span class="lineNum">   10313 </span>                :            : </a>
<a name="10314"><span class="lineNum">   10314 </span>                :            :   //add curve with m, no z to z compound curve</a>
<a name="10315"><span class="lineNum">   10315 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 9 ) );</span></a>
<a name="10316"><span class="lineNum">   10316 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10317"><span class="lineNum">   10317 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.is3D() );</span></a>
<a name="10318"><span class="lineNum">   10318 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10319"><span class="lineNum">   10319 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10320"><span class="lineNum">   10320 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10321"><span class="lineNum">   10321 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 5 )</span></a>
<a name="10322"><span class="lineNum">   10322 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 4, 0 ) );</a>
<a name="10323"><span class="lineNum">   10323 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10324"><span class="lineNum">   10324 </span>                :            : </a>
<a name="10325"><span class="lineNum">   10325 </span>                :            :   //add curve with zm to z compound curve</a>
<a name="10326"><span class="lineNum">   10326 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 6, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 4, 7, 9 ) );</span></a>
<a name="10327"><span class="lineNum">   10327 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10328"><span class="lineNum">   10328 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.is3D() );</span></a>
<a name="10329"><span class="lineNum">   10329 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.isMeasure() );</span></a>
<a name="10330"><span class="lineNum">   10330 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="10331"><span class="lineNum">   10331 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10332"><span class="lineNum">   10332 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 5 )</span></a>
<a name="10333"><span class="lineNum">   10333 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 4, 7 ) );</a>
<a name="10334"><span class="lineNum">   10334 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10335"><span class="lineNum">   10335 </span>                :            : </a>
<a name="10336"><span class="lineNum">   10336 </span>                :            :   //addCurve with no m to m compound curve</a>
<a name="10337"><span class="lineNum">   10337 </span>                :<span class="lineCov">          1 :   c8.clear();</span></a>
<a name="10338"><span class="lineNum">   10338 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 ) );</span></a>
<a name="10339"><span class="lineNum">   10339 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10340"><span class="lineNum">   10340 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10341"><span class="lineNum">   10341 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 4 ) );</span></a>
<a name="10342"><span class="lineNum">   10342 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10343"><span class="lineNum">   10343 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10344"><span class="lineNum">   10344 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isMeasure() );</span></a>
<a name="10345"><span class="lineNum">   10345 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10346"><span class="lineNum">   10346 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10347"><span class="lineNum">   10347 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 )</span></a>
<a name="10348"><span class="lineNum">   10348 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 0 ) );</a>
<a name="10349"><span class="lineNum">   10349 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10350"><span class="lineNum">   10350 </span>                :            : </a>
<a name="10351"><span class="lineNum">   10351 </span>                :            :   //add curve with z, no m to m compound curve</a>
<a name="10352"><span class="lineNum">   10352 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 2, 3, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 4, 9 ) );</span></a>
<a name="10353"><span class="lineNum">   10353 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10354"><span class="lineNum">   10354 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10355"><span class="lineNum">   10355 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isMeasure() );</span></a>
<a name="10356"><span class="lineNum">   10356 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10357"><span class="lineNum">   10357 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10358"><span class="lineNum">   10358 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 )</span></a>
<a name="10359"><span class="lineNum">   10359 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 0 ) );</a>
<a name="10360"><span class="lineNum">   10360 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10361"><span class="lineNum">   10361 </span>                :            : </a>
<a name="10362"><span class="lineNum">   10362 </span>                :            :   //add curve with zm to m compound curve</a>
<a name="10363"><span class="lineNum">   10363 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 2, 3, 6, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 4, 7, 9 ) );</span></a>
<a name="10364"><span class="lineNum">   10364 </span>                :<span class="lineCov">          1 :   c8.addCurve( l8.clone() );</span></a>
<a name="10365"><span class="lineNum">   10365 </span>                :<span class="lineCov">          1 :   QVERIFY( !c8.is3D() );</span></a>
<a name="10366"><span class="lineNum">   10366 </span>                :<span class="lineCov">          1 :   QVERIFY( c8.isMeasure() );</span></a>
<a name="10367"><span class="lineNum">   10367 </span>                :<span class="lineCov">          1 :   QCOMPARE( c8.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="10368"><span class="lineNum">   10368 </span>                :<span class="lineCov">          1 :   c8.points( pts );</span></a>
<a name="10369"><span class="lineNum">   10369 </span>                :<span class="lineCov">          1 :   QCOMPARE( pts, QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 2, 3, 0, 5 )</span></a>
<a name="10370"><span class="lineNum">   10370 </span>                :            :             &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 9 ) );</a>
<a name="10371"><span class="lineNum">   10371 </span>                :<span class="lineCov">          1 :   c8.removeCurve( 1 );</span></a>
<a name="10372"><span class="lineNum">   10372 </span>                :            : </a>
<a name="10373"><span class="lineNum">   10373 </span>                :            :   // add curve and extend existing</a>
<a name="10374"><span class="lineNum">   10374 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c8j;</span></a>
<a name="10375"><span class="lineNum">   10375 </span>                :            :   // try to extend empty compound curve</a>
<a name="10376"><span class="lineNum">   10376 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2, 3 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="10377"><span class="lineNum">   10377 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8.clone(), true );</span></a>
<a name="10378"><span class="lineNum">   10378 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4))&quot; ) );</span></a>
<a name="10379"><span class="lineNum">   10379 </span>                :            :   // try to add another curve with extend existing as true - should be ignored.</a>
<a name="10380"><span class="lineNum">   10380 </span>                :<span class="lineCov">          1 :   l8.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6, 6 ) &lt;&lt; QgsPoint( 7, 8 ) );</span></a>
<a name="10381"><span class="lineNum">   10381 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8.clone(), true );</span></a>
<a name="10382"><span class="lineNum">   10382 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4),CircularString (6 6, 7 8))&quot; ) );</span></a>
<a name="10383"><span class="lineNum">   10383 </span>                :            :   // try to add a linestring with extend existing as true - should be ignored because the last curve isn't a linestring</a>
<a name="10384"><span class="lineNum">   10384 </span>                :<span class="lineCov">          1 :   QgsLineString l8j;</span></a>
<a name="10385"><span class="lineNum">   10385 </span>                :<span class="lineCov">          1 :   l8j.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 8 ) &lt;&lt; QgsPoint( 10, 12 ) );</span></a>
<a name="10386"><span class="lineNum">   10386 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8j.clone(), true );</span></a>
<a name="10387"><span class="lineNum">   10387 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4),CircularString (6 6, 7 8),(10 8, 10 12))&quot; ) );</span></a>
<a name="10388"><span class="lineNum">   10388 </span>                :            :   // try to extend with another linestring -- should add to final part</a>
<a name="10389"><span class="lineNum">   10389 </span>                :<span class="lineCov">          1 :   l8j.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 13 ) &lt;&lt; QgsPoint( 12, 12 ) );</span></a>
<a name="10390"><span class="lineNum">   10390 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8j.clone(), true );</span></a>
<a name="10391"><span class="lineNum">   10391 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4),CircularString (6 6, 7 8),(10 8, 10 12, 11 13, 12 12))&quot; ) );</span></a>
<a name="10392"><span class="lineNum">   10392 </span>                :            :   // try to extend with another linestring -- should add to final part, with no duplicate points</a>
<a name="10393"><span class="lineNum">   10393 </span>                :<span class="lineCov">          1 :   l8j.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 12, 12 ) &lt;&lt; QgsPoint( 13, 12 ) &lt;&lt; QgsPoint( 14, 15 ) );</span></a>
<a name="10394"><span class="lineNum">   10394 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8j.clone(), true );</span></a>
<a name="10395"><span class="lineNum">   10395 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4),CircularString (6 6, 7 8),(10 8, 10 12, 11 13, 12 12, 13 12, 14 15))&quot; ) );</span></a>
<a name="10396"><span class="lineNum">   10396 </span>                :            :   // not extending, should be added as new curve</a>
<a name="10397"><span class="lineNum">   10397 </span>                :<span class="lineCov">          1 :   l8j.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 15, 16 ) &lt;&lt; QgsPoint( 17, 12 ) );</span></a>
<a name="10398"><span class="lineNum">   10398 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8j.clone(), false );</span></a>
<a name="10399"><span class="lineNum">   10399 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (1 2, 2 3, 3 4),CircularString (6 6, 7 8),(10 8, 10 12, 11 13, 12 12, 13 12, 14 15),(15 16, 17 12))&quot; ) );</span></a>
<a name="10400"><span class="lineNum">   10400 </span>                :<span class="lineCov">          1 :   c8j.clear();</span></a>
<a name="10401"><span class="lineNum">   10401 </span>                :            :   // adding a linestring as first part, with extend as true</a>
<a name="10402"><span class="lineNum">   10402 </span>                :<span class="lineCov">          1 :   c8j.addCurve( l8j.clone(), true );</span></a>
<a name="10403"><span class="lineNum">   10403 </span>                :<span class="lineCov">          2 :   QCOMPARE( c8j.asWkt(), QStringLiteral( &quot;CompoundCurve ((15 16, 17 12))&quot; ) );</span></a>
<a name="10404"><span class="lineNum">   10404 </span>                :            : </a>
<a name="10405"><span class="lineNum">   10405 </span>                :            :   //test getters/setters</a>
<a name="10406"><span class="lineNum">   10406 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c9;</span></a>
<a name="10407"><span class="lineNum">   10407 </span>                :            : </a>
<a name="10408"><span class="lineNum">   10408 </span>                :            :   // no crash!</a>
<a name="10409"><span class="lineNum">   10409 </span>                :<span class="lineCov">          1 :   ( void )c9.xAt( -1 );</span></a>
<a name="10410"><span class="lineNum">   10410 </span>                :<span class="lineCov">          1 :   ( void )c9.xAt( 1 );</span></a>
<a name="10411"><span class="lineNum">   10411 </span>                :<span class="lineCov">          1 :   ( void )c9.yAt( -1 );</span></a>
<a name="10412"><span class="lineNum">   10412 </span>                :<span class="lineCov">          1 :   ( void )c9.yAt( 1 );</span></a>
<a name="10413"><span class="lineNum">   10413 </span>                :            : </a>
<a name="10414"><span class="lineNum">   10414 </span>                :<span class="lineCov">          1 :   QgsCircularString l9;</span></a>
<a name="10415"><span class="lineNum">   10415 </span>                :<span class="lineCov">          2 :   l9.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10416"><span class="lineNum">   10416 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 )</span></a>
<a name="10417"><span class="lineNum">   10417 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 ) );</span></a>
<a name="10418"><span class="lineNum">   10418 </span>                :<span class="lineCov">          1 :   c9.addCurve( l9.clone() );</span></a>
<a name="10419"><span class="lineNum">   10419 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 0 ), 1.0 );</span></a>
<a name="10420"><span class="lineNum">   10420 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 1 ), 11.0 );</span></a>
<a name="10421"><span class="lineNum">   10421 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 2 ), 21.0 );</span></a>
<a name="10422"><span class="lineNum">   10422 </span>                :<span class="lineCov">          1 :   ( void ) c9.xAt( -1 ); //out of range</span></a>
<a name="10423"><span class="lineNum">   10423 </span>                :<span class="lineCov">          1 :   ( void ) c9.xAt( 11 ); //out of range</span></a>
<a name="10424"><span class="lineNum">   10424 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 0 ), 2.0 );</span></a>
<a name="10425"><span class="lineNum">   10425 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 1 ), 12.0 );</span></a>
<a name="10426"><span class="lineNum">   10426 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 2 ), 22.0 );</span></a>
<a name="10427"><span class="lineNum">   10427 </span>                :<span class="lineCov">          1 :   ( void ) c9.yAt( -1 ); //out of range</span></a>
<a name="10428"><span class="lineNum">   10428 </span>                :<span class="lineCov">          1 :   ( void ) c9.yAt( 11 ); //out of range</span></a>
<a name="10429"><span class="lineNum">   10429 </span>                :            : </a>
<a name="10430"><span class="lineNum">   10430 </span>                :<span class="lineCov">          1 :   QgsLineString l9a;</span></a>
<a name="10431"><span class="lineNum">   10431 </span>                :<span class="lineCov">          2 :   l9a.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 23, 24 )</span></a>
<a name="10432"><span class="lineNum">   10432 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 22, 13, 14 ) );</span></a>
<a name="10433"><span class="lineNum">   10433 </span>                :<span class="lineCov">          1 :   c9.addCurve( l9a.clone() );</span></a>
<a name="10434"><span class="lineNum">   10434 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 0 ), 1.0 );</span></a>
<a name="10435"><span class="lineNum">   10435 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 1 ), 11.0 );</span></a>
<a name="10436"><span class="lineNum">   10436 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 2 ), 21.0 );</span></a>
<a name="10437"><span class="lineNum">   10437 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 3 ), 31.0 );</span></a>
<a name="10438"><span class="lineNum">   10438 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 4 ), 0.0 );</span></a>
<a name="10439"><span class="lineNum">   10439 </span>                :<span class="lineCov">          1 :   ( void ) c9.xAt( -1 ); //out of range</span></a>
<a name="10440"><span class="lineNum">   10440 </span>                :<span class="lineCov">          1 :   ( void ) c9.xAt( 11 ); //out of range</span></a>
<a name="10441"><span class="lineNum">   10441 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 0 ), 2.0 );</span></a>
<a name="10442"><span class="lineNum">   10442 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 1 ), 12.0 );</span></a>
<a name="10443"><span class="lineNum">   10443 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 2 ), 22.0 );</span></a>
<a name="10444"><span class="lineNum">   10444 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 3 ), 22.0 );</span></a>
<a name="10445"><span class="lineNum">   10445 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 4 ), 0.0 );</span></a>
<a name="10446"><span class="lineNum">   10446 </span>                :<span class="lineCov">          1 :   ( void ) c9.yAt( -1 ); //out of range</span></a>
<a name="10447"><span class="lineNum">   10447 </span>                :<span class="lineCov">          1 :   ( void ) c9.yAt( 11 ); //out of range</span></a>
<a name="10448"><span class="lineNum">   10448 </span>                :            : </a>
<a name="10449"><span class="lineNum">   10449 </span>                :<span class="lineCov">          1 :   c9.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 51.0, 52.0 ) );</span></a>
<a name="10450"><span class="lineNum">   10450 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 0 ), 51.0 );</span></a>
<a name="10451"><span class="lineNum">   10451 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 0 ), 52.0 );</span></a>
<a name="10452"><span class="lineNum">   10452 </span>                :<span class="lineCov">          1 :   c9.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 61.0, 62 ) );</span></a>
<a name="10453"><span class="lineNum">   10453 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.xAt( 1 ), 61.0 );</span></a>
<a name="10454"><span class="lineNum">   10454 </span>                :<span class="lineCov">          1 :   QCOMPARE( c9.yAt( 1 ), 62.0 );</span></a>
<a name="10455"><span class="lineNum">   10455 </span>                :<span class="lineCov">          1 :   c9.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 71.0, 2 ) ); //out of range</span></a>
<a name="10456"><span class="lineNum">   10456 </span>                :<span class="lineCov">          1 :   c9.moveVertex( QgsVertexId( 0, 0, 11 ), QgsPoint( 71.0, 2 ) ); //out of range</span></a>
<a name="10457"><span class="lineNum">   10457 </span>                :            : </a>
<a name="10458"><span class="lineNum">   10458 </span>                :<span class="lineCov">          1 :   QgsPoint p;</span></a>
<a name="10459"><span class="lineNum">   10459 </span>                :            :   QgsVertexId::VertexType type;</a>
<a name="10460"><span class="lineNum">   10460 </span>                :<span class="lineCov">          1 :   QVERIFY( !c9.pointAt( -1, p, type ) );</span></a>
<a name="10461"><span class="lineNum">   10461 </span>                :<span class="lineCov">          1 :   QVERIFY( !c9.pointAt( 11, p, type ) );</span></a>
<a name="10462"><span class="lineNum">   10462 </span>                :<span class="lineCov">          1 :   QVERIFY( c9.pointAt( 0, p, type ) );</span></a>
<a name="10463"><span class="lineNum">   10463 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 3.0 );</span></a>
<a name="10464"><span class="lineNum">   10464 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 4.0 );</span></a>
<a name="10465"><span class="lineNum">   10465 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="10466"><span class="lineNum">   10466 </span>                :<span class="lineCov">          1 :   QVERIFY( c9.pointAt( 1, p, type ) );</span></a>
<a name="10467"><span class="lineNum">   10467 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 13.0 );</span></a>
<a name="10468"><span class="lineNum">   10468 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 14.0 );</span></a>
<a name="10469"><span class="lineNum">   10469 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="10470"><span class="lineNum">   10470 </span>                :<span class="lineCov">          1 :   QVERIFY( c9.pointAt( 2, p, type ) );</span></a>
<a name="10471"><span class="lineNum">   10471 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 23.0 );</span></a>
<a name="10472"><span class="lineNum">   10472 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 24.0 );</span></a>
<a name="10473"><span class="lineNum">   10473 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="10474"><span class="lineNum">   10474 </span>                :<span class="lineCov">          1 :   QVERIFY( c9.pointAt( 3, p, type ) );</span></a>
<a name="10475"><span class="lineNum">   10475 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.z(), 13.0 );</span></a>
<a name="10476"><span class="lineNum">   10476 </span>                :<span class="lineCov">          1 :   QCOMPARE( p.m(), 14.0 );</span></a>
<a name="10477"><span class="lineNum">   10477 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="10478"><span class="lineNum">   10478 </span>                :            : </a>
<a name="10479"><span class="lineNum">   10479 </span>                :            :   //equality</a>
<a name="10480"><span class="lineNum">   10480 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e1;</span></a>
<a name="10481"><span class="lineNum">   10481 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e2;</span></a>
<a name="10482"><span class="lineNum">   10482 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="10483"><span class="lineNum">   10483 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="10484"><span class="lineNum">   10484 </span>                :<span class="lineCov">          1 :   QgsLineString le1;</span></a>
<a name="10485"><span class="lineNum">   10485 </span>                :<span class="lineCov">          1 :   QgsLineString le2;</span></a>
<a name="10486"><span class="lineNum">   10486 </span>                :<span class="lineCov">          1 :   le1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="10487"><span class="lineNum">   10487 </span>                :<span class="lineCov">          1 :   e1.addCurve( le1.clone() );</span></a>
<a name="10488"><span class="lineNum">   10488 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different number of curves</span></a>
<a name="10489"><span class="lineNum">   10489 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="10490"><span class="lineNum">   10490 </span>                :<span class="lineCov">          1 :   e2.addCurve( le1.clone() );</span></a>
<a name="10491"><span class="lineNum">   10491 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 );</span></a>
<a name="10492"><span class="lineNum">   10492 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="10493"><span class="lineNum">   10493 </span>                :<span class="lineCov">          1 :   le1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 1 / 3.0, 4 / 3.0 ) );</span></a>
<a name="10494"><span class="lineNum">   10494 </span>                :<span class="lineCov">          1 :   e1.addCurve( le1.clone() );</span></a>
<a name="10495"><span class="lineNum">   10495 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different number of curves</span></a>
<a name="10496"><span class="lineNum">   10496 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="10497"><span class="lineNum">   10497 </span>                :<span class="lineCov">          1 :   le2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2 / 6.0, 8 / 6.0 ) );</span></a>
<a name="10498"><span class="lineNum">   10498 </span>                :<span class="lineCov">          1 :   e2.addCurve( le2.clone() );</span></a>
<a name="10499"><span class="lineNum">   10499 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 == e2 ); //check non-integer equality</span></a>
<a name="10500"><span class="lineNum">   10500 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 != e2 ) );</span></a>
<a name="10501"><span class="lineNum">   10501 </span>                :<span class="lineCov">          1 :   le1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 1 / 3.0, 4 / 3.0 ) &lt;&lt; QgsPoint( 7, 8 ) );</span></a>
<a name="10502"><span class="lineNum">   10502 </span>                :<span class="lineCov">          1 :   e1.addCurve( le1.clone() );</span></a>
<a name="10503"><span class="lineNum">   10503 </span>                :<span class="lineCov">          1 :   le2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 2 / 6.0, 8 / 6.0 ) &lt;&lt; QgsPoint( 6, 9 ) );</span></a>
<a name="10504"><span class="lineNum">   10504 </span>                :<span class="lineCov">          1 :   e2.addCurve( le2.clone() );</span></a>
<a name="10505"><span class="lineNum">   10505 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e2 ) ); //different coordinates</span></a>
<a name="10506"><span class="lineNum">   10506 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e2 );</span></a>
<a name="10507"><span class="lineNum">   10507 </span>                :            : </a>
<a name="10508"><span class="lineNum">   10508 </span>                :            :   // different dimensions</a>
<a name="10509"><span class="lineNum">   10509 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e3;</span></a>
<a name="10510"><span class="lineNum">   10510 </span>                :<span class="lineCov">          1 :   e1.clear();</span></a>
<a name="10511"><span class="lineNum">   10511 </span>                :<span class="lineCov">          1 :   e1.addCurve( le1.clone() );</span></a>
<a name="10512"><span class="lineNum">   10512 </span>                :<span class="lineCov">          1 :   QgsLineString le3;</span></a>
<a name="10513"><span class="lineNum">   10513 </span>                :<span class="lineCov">          2 :   le3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 0 )</span></a>
<a name="10514"><span class="lineNum">   10514 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 0 )</span></a>
<a name="10515"><span class="lineNum">   10515 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 0 ) );</span></a>
<a name="10516"><span class="lineNum">   10516 </span>                :<span class="lineCov">          1 :   e3.addCurve( le3.clone() );</span></a>
<a name="10517"><span class="lineNum">   10517 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e1 == e3 ) ); //different dimension</span></a>
<a name="10518"><span class="lineNum">   10518 </span>                :<span class="lineCov">          1 :   QVERIFY( e1 != e3 );</span></a>
<a name="10519"><span class="lineNum">   10519 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e4;</span></a>
<a name="10520"><span class="lineNum">   10520 </span>                :<span class="lineCov">          1 :   QgsLineString le4;</span></a>
<a name="10521"><span class="lineNum">   10521 </span>                :<span class="lineCov">          2 :   le4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 )</span></a>
<a name="10522"><span class="lineNum">   10522 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1 / 3.0, 4 / 3.0, 3 )</span></a>
<a name="10523"><span class="lineNum">   10523 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 8, 4 ) );</span></a>
<a name="10524"><span class="lineNum">   10524 </span>                :<span class="lineCov">          1 :   e4.addCurve( le4.clone() );</span></a>
<a name="10525"><span class="lineNum">   10525 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e3 == e4 ) ); //different z coordinates</span></a>
<a name="10526"><span class="lineNum">   10526 </span>                :<span class="lineCov">          1 :   QVERIFY( e3 != e4 );</span></a>
<a name="10527"><span class="lineNum">   10527 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e5;</span></a>
<a name="10528"><span class="lineNum">   10528 </span>                :<span class="lineCov">          1 :   QgsLineString le5;</span></a>
<a name="10529"><span class="lineNum">   10529 </span>                :<span class="lineCov">          2 :   le5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 1 )</span></a>
<a name="10530"><span class="lineNum">   10530 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 2 )</span></a>
<a name="10531"><span class="lineNum">   10531 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 3 ) );</span></a>
<a name="10532"><span class="lineNum">   10532 </span>                :<span class="lineCov">          1 :   e5.addCurve( le5.clone() );</span></a>
<a name="10533"><span class="lineNum">   10533 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve e6;</span></a>
<a name="10534"><span class="lineNum">   10534 </span>                :<span class="lineCov">          1 :   QgsLineString le6;</span></a>
<a name="10535"><span class="lineNum">   10535 </span>                :<span class="lineCov">          2 :   le6.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 11 )</span></a>
<a name="10536"><span class="lineNum">   10536 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1 / 3.0, 4 / 3.0, 0, 12 )</span></a>
<a name="10537"><span class="lineNum">   10537 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 8, 0, 13 ) );</span></a>
<a name="10538"><span class="lineNum">   10538 </span>                :<span class="lineCov">          1 :   e6.addCurve( le6.clone() );</span></a>
<a name="10539"><span class="lineNum">   10539 </span>                :<span class="lineCov">          1 :   QVERIFY( !( e5 == e6 ) ); //different m values</span></a>
<a name="10540"><span class="lineNum">   10540 </span>                :<span class="lineCov">          1 :   QVERIFY( e5 != e6 );</span></a>
<a name="10541"><span class="lineNum">   10541 </span>                :            : </a>
<a name="10542"><span class="lineNum">   10542 </span>                :<span class="lineCov">          1 :   QVERIFY( e6 != QgsLineString() );</span></a>
<a name="10543"><span class="lineNum">   10543 </span>                :            : </a>
<a name="10544"><span class="lineNum">   10544 </span>                :            :   // assignment operator</a>
<a name="10545"><span class="lineNum">   10545 </span>                :<span class="lineCov">          1 :   e5.addCurve( le5.clone() );</span></a>
<a name="10546"><span class="lineNum">   10546 </span>                :<span class="lineCov">          1 :   QVERIFY( e5 != e6 );</span></a>
<a name="10547"><span class="lineNum">   10547 </span>                :<span class="lineCov">          1 :   e6 = e5;</span></a>
<a name="10548"><span class="lineNum">   10548 </span>                :<span class="lineCov">          1 :   QCOMPARE( e5, e6 );</span></a>
<a name="10549"><span class="lineNum">   10549 </span>                :            : </a>
<a name="10550"><span class="lineNum">   10550 </span>                :            :   //isClosed</a>
<a name="10551"><span class="lineNum">   10551 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c11;</span></a>
<a name="10552"><span class="lineNum">   10552 </span>                :<span class="lineCov">          1 :   QgsCircularString l11;</span></a>
<a name="10553"><span class="lineNum">   10553 </span>                :<span class="lineCov">          1 :   QVERIFY( !c11.isClosed() );</span></a>
<a name="10554"><span class="lineNum">   10554 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="10555"><span class="lineNum">   10555 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="10556"><span class="lineNum">   10556 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="10557"><span class="lineNum">   10557 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="10558"><span class="lineNum">   10558 </span>                :<span class="lineCov">          1 :   c11.addCurve( l11.clone() );</span></a>
<a name="10559"><span class="lineNum">   10559 </span>                :<span class="lineCov">          1 :   QVERIFY( !c11.isClosed() );</span></a>
<a name="10560"><span class="lineNum">   10560 </span>                :<span class="lineCov">          1 :   QgsLineString ls11;</span></a>
<a name="10561"><span class="lineNum">   10561 </span>                :<span class="lineCov">          2 :   ls11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 )</span></a>
<a name="10562"><span class="lineNum">   10562 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="10563"><span class="lineNum">   10563 </span>                :<span class="lineCov">          1 :   c11.addCurve( ls11.clone() );</span></a>
<a name="10564"><span class="lineNum">   10564 </span>                :<span class="lineCov">          1 :   QVERIFY( c11.isClosed() );</span></a>
<a name="10565"><span class="lineNum">   10565 </span>                :            : </a>
<a name="10566"><span class="lineNum">   10566 </span>                :            :   //test that m values aren't considered when testing for closedness</a>
<a name="10567"><span class="lineNum">   10567 </span>                :<span class="lineCov">          1 :   c11.clear();</span></a>
<a name="10568"><span class="lineNum">   10568 </span>                :<span class="lineCov">          2 :   l11.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 )</span></a>
<a name="10569"><span class="lineNum">   10569 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 2, 0, 4 )</span></a>
<a name="10570"><span class="lineNum">   10570 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 22, 0, 5 )</span></a>
<a name="10571"><span class="lineNum">   10571 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 6 ) );</span></a>
<a name="10572"><span class="lineNum">   10572 </span>                :<span class="lineCov">          1 :   c11.addCurve( l11.clone() );</span></a>
<a name="10573"><span class="lineNum">   10573 </span>                :<span class="lineCov">          1 :   QVERIFY( c11.isClosed() );</span></a>
<a name="10574"><span class="lineNum">   10574 </span>                :            : </a>
<a name="10575"><span class="lineNum">   10575 </span>                :            :   //polygonf</a>
<a name="10576"><span class="lineNum">   10576 </span>                :<span class="lineCov">          1 :   QgsCircularString lc13;</span></a>
<a name="10577"><span class="lineNum">   10577 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c13;</span></a>
<a name="10578"><span class="lineNum">   10578 </span>                :<span class="lineCov">          2 :   lc13.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10579"><span class="lineNum">   10579 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="10580"><span class="lineNum">   10580 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="10581"><span class="lineNum">   10581 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="10582"><span class="lineNum">   10582 </span>                :<span class="lineCov">          1 :   c13.addCurve( lc13.clone() );</span></a>
<a name="10583"><span class="lineNum">   10583 </span>                :<span class="lineCov">          1 :   QgsLineString ls13;</span></a>
<a name="10584"><span class="lineNum">   10584 </span>                :<span class="lineCov">          1 :   ls13.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( 23, 22 ) );</span></a>
<a name="10585"><span class="lineNum">   10585 </span>                :<span class="lineCov">          1 :   c13.addCurve( ls13.clone() );</span></a>
<a name="10586"><span class="lineNum">   10586 </span>                :<span class="lineCov">          1 :   QPolygonF poly = c13.asQPolygonF();</span></a>
<a name="10587"><span class="lineNum">   10587 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.count(), 183 );</span></a>
<a name="10588"><span class="lineNum">   10588 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).x(), 1.0 );</span></a>
<a name="10589"><span class="lineNum">   10589 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 0 ).y(), 2.0 );</span></a>
<a name="10590"><span class="lineNum">   10590 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 182 ).x(), 23.0 );</span></a>
<a name="10591"><span class="lineNum">   10591 </span>                :<span class="lineCov">          1 :   QCOMPARE( poly.at( 182 ).y(), 22.0 );</span></a>
<a name="10592"><span class="lineNum">   10592 </span>                :            : </a>
<a name="10593"><span class="lineNum">   10593 </span>                :            :   // clone tests</a>
<a name="10594"><span class="lineNum">   10594 </span>                :<span class="lineCov">          1 :   QgsCircularString lc14;</span></a>
<a name="10595"><span class="lineNum">   10595 </span>                :<span class="lineCov">          2 :   lc14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="10596"><span class="lineNum">   10596 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 11, 2 )</span></a>
<a name="10597"><span class="lineNum">   10597 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 11, 22 )</span></a>
<a name="10598"><span class="lineNum">   10598 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="10599"><span class="lineNum">   10599 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c14;</span></a>
<a name="10600"><span class="lineNum">   10600 </span>                :<span class="lineCov">          1 :   c14.addCurve( lc14.clone() );</span></a>
<a name="10601"><span class="lineNum">   10601 </span>                :<span class="lineCov">          1 :   QgsLineString ls14;</span></a>
<a name="10602"><span class="lineNum">   10602 </span>                :<span class="lineCov">          1 :   ls14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( 23, 22 ) );</span></a>
<a name="10603"><span class="lineNum">   10603 </span>                :<span class="lineCov">          1 :   c14.addCurve( ls14.clone() );</span></a>
<a name="10604"><span class="lineNum">   10604 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsCompoundCurve&gt; cloned( c14.clone() );</span></a>
<a name="10605"><span class="lineNum">   10605 </span>                :<span class="lineCov">          1 :   QCOMPARE( *cloned, c14 );</span></a>
<a name="10606"><span class="lineNum">   10606 </span>                :            : </a>
<a name="10607"><span class="lineNum">   10607 </span>                :            :   //clone with Z/M</a>
<a name="10608"><span class="lineNum">   10608 </span>                :<span class="lineCov">          2 :   lc14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10609"><span class="lineNum">   10609 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="10610"><span class="lineNum">   10610 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="10611"><span class="lineNum">   10611 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="10612"><span class="lineNum">   10612 </span>                :<span class="lineCov">          1 :   ls14.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22, 31, 34 ) &lt;&lt; QgsPoint( 23, 22, 42, 43 ) );</span></a>
<a name="10613"><span class="lineNum">   10613 </span>                :<span class="lineCov">          1 :   c14.clear();</span></a>
<a name="10614"><span class="lineNum">   10614 </span>                :<span class="lineCov">          1 :   c14.addCurve( lc14.clone() );</span></a>
<a name="10615"><span class="lineNum">   10615 </span>                :<span class="lineCov">          1 :   c14.addCurve( ls14.clone() );</span></a>
<a name="10616"><span class="lineNum">   10616 </span>                :<span class="lineCov">          1 :   cloned.reset( c14.clone() );</span></a>
<a name="10617"><span class="lineNum">   10617 </span>                :<span class="lineCov">          1 :   QCOMPARE( *cloned, c14 );</span></a>
<a name="10618"><span class="lineNum">   10618 </span>                :            : </a>
<a name="10619"><span class="lineNum">   10619 </span>                :            :   //clone an empty line</a>
<a name="10620"><span class="lineNum">   10620 </span>                :<span class="lineCov">          1 :   c14.clear();</span></a>
<a name="10621"><span class="lineNum">   10621 </span>                :<span class="lineCov">          1 :   cloned.reset( c14.clone() );</span></a>
<a name="10622"><span class="lineNum">   10622 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="10623"><span class="lineNum">   10623 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numPoints(), 0 );</span></a>
<a name="10624"><span class="lineNum">   10624 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;is3D() );</span></a>
<a name="10625"><span class="lineNum">   10625 </span>                :<span class="lineCov">          1 :   QVERIFY( !cloned-&gt;isMeasure() );</span></a>
<a name="10626"><span class="lineNum">   10626 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10627"><span class="lineNum">   10627 </span>                :            : </a>
<a name="10628"><span class="lineNum">   10628 </span>                :            :   //segmentize tests</a>
<a name="10629"><span class="lineNum">   10629 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve toSegment;</span></a>
<a name="10630"><span class="lineNum">   10630 </span>                :<span class="lineCov">          1 :   QgsCircularString lcSegment;</span></a>
<a name="10631"><span class="lineNum">   10631 </span>                :<span class="lineCov">          2 :   lcSegment.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="10632"><span class="lineNum">   10632 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 21, 2 ) );</span></a>
<a name="10633"><span class="lineNum">   10633 </span>                :<span class="lineCov">          1 :   toSegment.addCurve( lcSegment.clone() );</span></a>
<a name="10634"><span class="lineNum">   10634 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsLineString&gt; segmentized( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="10635"><span class="lineNum">   10635 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 156 );</span></a>
<a name="10636"><span class="lineNum">   10636 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;vertexCount(), 156 );</span></a>
<a name="10637"><span class="lineNum">   10637 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;ringCount(), 1 );</span></a>
<a name="10638"><span class="lineNum">   10638 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;partCount(), 1 );</span></a>
<a name="10639"><span class="lineNum">   10639 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="10640"><span class="lineNum">   10640 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="10641"><span class="lineNum">   10641 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="10642"><span class="lineNum">   10642 </span>                :            : </a>
<a name="10643"><span class="lineNum">   10643 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), lcSegment.pointN( 0 ) );</span></a>
<a name="10644"><span class="lineNum">   10644 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), lcSegment.pointN( toSegment.numPoints() - 1 ) );</span></a>
<a name="10645"><span class="lineNum">   10645 </span>                :            : </a>
<a name="10646"><span class="lineNum">   10646 </span>                :            :   //segmentize with Z/M</a>
<a name="10647"><span class="lineNum">   10647 </span>                :<span class="lineCov">          2 :   lcSegment.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10648"><span class="lineNum">   10648 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 10, 11, 14 )</span></a>
<a name="10649"><span class="lineNum">   10649 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 2, 21, 24 ) );</span></a>
<a name="10650"><span class="lineNum">   10650 </span>                :<span class="lineCov">          1 :   toSegment.clear();</span></a>
<a name="10651"><span class="lineNum">   10651 </span>                :<span class="lineCov">          1 :   toSegment.addCurve( lcSegment.clone() );</span></a>
<a name="10652"><span class="lineNum">   10652 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="10653"><span class="lineNum">   10653 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 156 );</span></a>
<a name="10654"><span class="lineNum">   10654 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;vertexCount(), 156 );</span></a>
<a name="10655"><span class="lineNum">   10655 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;ringCount(), 1 );</span></a>
<a name="10656"><span class="lineNum">   10656 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;partCount(), 1 );</span></a>
<a name="10657"><span class="lineNum">   10657 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="10658"><span class="lineNum">   10658 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="10659"><span class="lineNum">   10659 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="10660"><span class="lineNum">   10660 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), lcSegment.pointN( 0 ) );</span></a>
<a name="10661"><span class="lineNum">   10661 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), lcSegment.pointN( toSegment.numPoints() - 1 ) );</span></a>
<a name="10662"><span class="lineNum">   10662 </span>                :            : </a>
<a name="10663"><span class="lineNum">   10663 </span>                :            :   //segmentize an empty line</a>
<a name="10664"><span class="lineNum">   10664 </span>                :<span class="lineCov">          1 :   toSegment.clear();</span></a>
<a name="10665"><span class="lineNum">   10665 </span>                :<span class="lineCov">          1 :   segmentized.reset( static_cast&lt; QgsLineString * &gt;( toSegment.segmentize() ) );</span></a>
<a name="10666"><span class="lineNum">   10666 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isEmpty() );</span></a>
<a name="10667"><span class="lineNum">   10667 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 0 );</span></a>
<a name="10668"><span class="lineNum">   10668 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;is3D() );</span></a>
<a name="10669"><span class="lineNum">   10669 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized-&gt;isMeasure() );</span></a>
<a name="10670"><span class="lineNum">   10670 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="10671"><span class="lineNum">   10671 </span>                :            : </a>
<a name="10672"><span class="lineNum">   10672 </span>                :            :   //to/from WKB</a>
<a name="10673"><span class="lineNum">   10673 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c15;</span></a>
<a name="10674"><span class="lineNum">   10674 </span>                :<span class="lineCov">          1 :   QgsCircularString l15;</span></a>
<a name="10675"><span class="lineNum">   10675 </span>                :<span class="lineCov">          2 :   l15.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10676"><span class="lineNum">   10676 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="10677"><span class="lineNum">   10677 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="10678"><span class="lineNum">   10678 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="10679"><span class="lineNum">   10679 </span>                :<span class="lineCov">          1 :   c15.addCurve( l15.clone() );</span></a>
<a name="10680"><span class="lineNum">   10680 </span>                :<span class="lineCov">          1 :   QByteArray wkb15 = c15.asWkb();</span></a>
<a name="10681"><span class="lineNum">   10681 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb15.size(), c15.wkbSize() );</span></a>
<a name="10682"><span class="lineNum">   10682 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c16;</span></a>
<a name="10683"><span class="lineNum">   10683 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb15ptr( wkb15 );</span></a>
<a name="10684"><span class="lineNum">   10684 </span>                :<span class="lineCov">          1 :   c16.fromWkb( wkb15ptr );</span></a>
<a name="10685"><span class="lineNum">   10685 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.numPoints(), 4 );</span></a>
<a name="10686"><span class="lineNum">   10686 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.vertexCount(), 4 );</span></a>
<a name="10687"><span class="lineNum">   10687 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.nCoordinates(), 4 );</span></a>
<a name="10688"><span class="lineNum">   10688 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.ringCount(), 1 );</span></a>
<a name="10689"><span class="lineNum">   10689 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.partCount(), 1 );</span></a>
<a name="10690"><span class="lineNum">   10690 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="10691"><span class="lineNum">   10691 </span>                :<span class="lineCov">          1 :   QVERIFY( c16.is3D() );</span></a>
<a name="10692"><span class="lineNum">   10692 </span>                :<span class="lineCov">          1 :   QVERIFY( c16.isMeasure() );</span></a>
<a name="10693"><span class="lineNum">   10693 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.nCurves(), 1 );</span></a>
<a name="10694"><span class="lineNum">   10694 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c16.curveAt( 0 ) )-&gt;pointN( 0 ), l15.pointN( 0 ) );</span></a>
<a name="10695"><span class="lineNum">   10695 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c16.curveAt( 0 ) )-&gt;pointN( 1 ), l15.pointN( 1 ) );</span></a>
<a name="10696"><span class="lineNum">   10696 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c16.curveAt( 0 ) )-&gt;pointN( 2 ), l15.pointN( 2 ) );</span></a>
<a name="10697"><span class="lineNum">   10697 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c16.curveAt( 0 ) )-&gt;pointN( 3 ), l15.pointN( 3 ) );</span></a>
<a name="10698"><span class="lineNum">   10698 </span>                :            : </a>
<a name="10699"><span class="lineNum">   10699 </span>                :            :   //bad WKB - check for no crash</a>
<a name="10700"><span class="lineNum">   10700 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="10701"><span class="lineNum">   10701 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="10702"><span class="lineNum">   10702 </span>                :<span class="lineCov">          1 :   QVERIFY( !c16.fromWkb( nullPtr ) );</span></a>
<a name="10703"><span class="lineNum">   10703 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10704"><span class="lineNum">   10704 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="10705"><span class="lineNum">   10705 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = point.asWkb();</span></a>
<a name="10706"><span class="lineNum">   10706 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="10707"><span class="lineNum">   10707 </span>                :<span class="lineCov">          1 :   QVERIFY( !c16.fromWkb( wkb16ptr ) );</span></a>
<a name="10708"><span class="lineNum">   10708 </span>                :<span class="lineCov">          1 :   QCOMPARE( c16.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10709"><span class="lineNum">   10709 </span>                :            : </a>
<a name="10710"><span class="lineNum">   10710 </span>                :            :   //to/from WKT</a>
<a name="10711"><span class="lineNum">   10711 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c17;</span></a>
<a name="10712"><span class="lineNum">   10712 </span>                :<span class="lineCov">          1 :   QgsCircularString l17;</span></a>
<a name="10713"><span class="lineNum">   10713 </span>                :<span class="lineCov">          2 :   l17.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10714"><span class="lineNum">   10714 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 2, 11, 14 )</span></a>
<a name="10715"><span class="lineNum">   10715 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 22, 21, 24 )</span></a>
<a name="10716"><span class="lineNum">   10716 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 31, 34 ) );</span></a>
<a name="10717"><span class="lineNum">   10717 </span>                :<span class="lineCov">          1 :   c17.addCurve( l17.clone() );</span></a>
<a name="10718"><span class="lineNum">   10718 </span>                :            : </a>
<a name="10719"><span class="lineNum">   10719 </span>                :<span class="lineCov">          1 :   QString wkt = c17.asWkt();</span></a>
<a name="10720"><span class="lineNum">   10720 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="10721"><span class="lineNum">   10721 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c18;</span></a>
<a name="10722"><span class="lineNum">   10722 </span>                :<span class="lineCov">          1 :   QVERIFY( c18.fromWkt( wkt ) );</span></a>
<a name="10723"><span class="lineNum">   10723 </span>                :<span class="lineCov">          1 :   QCOMPARE( c18.numPoints(), 4 );</span></a>
<a name="10724"><span class="lineNum">   10724 </span>                :<span class="lineCov">          1 :   QCOMPARE( c18.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="10725"><span class="lineNum">   10725 </span>                :<span class="lineCov">          1 :   QVERIFY( c18.is3D() );</span></a>
<a name="10726"><span class="lineNum">   10726 </span>                :<span class="lineCov">          1 :   QVERIFY( c18.isMeasure() );</span></a>
<a name="10727"><span class="lineNum">   10727 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c18.curveAt( 0 ) )-&gt;pointN( 0 ), l17.pointN( 0 ) );</span></a>
<a name="10728"><span class="lineNum">   10728 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c18.curveAt( 0 ) )-&gt;pointN( 1 ), l17.pointN( 1 ) );</span></a>
<a name="10729"><span class="lineNum">   10729 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c18.curveAt( 0 ) )-&gt;pointN( 2 ), l17.pointN( 2 ) );</span></a>
<a name="10730"><span class="lineNum">   10730 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; const QgsCircularString *&gt;( c18.curveAt( 0 ) )-&gt;pointN( 3 ), l17.pointN( 3 ) );</span></a>
<a name="10731"><span class="lineNum">   10731 </span>                :            : </a>
<a name="10732"><span class="lineNum">   10732 </span>                :            :   //bad WKT</a>
<a name="10733"><span class="lineNum">   10733 </span>                :<span class="lineCov">          1 :   QVERIFY( !c18.fromWkt( &quot;Polygon()&quot; ) );</span></a>
<a name="10734"><span class="lineNum">   10734 </span>                :<span class="lineCov">          1 :   QVERIFY( c18.isEmpty() );</span></a>
<a name="10735"><span class="lineNum">   10735 </span>                :<span class="lineCov">          1 :   QCOMPARE( c18.numPoints(), 0 );</span></a>
<a name="10736"><span class="lineNum">   10736 </span>                :<span class="lineCov">          1 :   QVERIFY( !c18.is3D() );</span></a>
<a name="10737"><span class="lineNum">   10737 </span>                :<span class="lineCov">          1 :   QVERIFY( !c18.isMeasure() );</span></a>
<a name="10738"><span class="lineNum">   10738 </span>                :<span class="lineCov">          1 :   QCOMPARE( c18.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10739"><span class="lineNum">   10739 </span>                :<span class="lineCov">          1 :   QVERIFY( !c18.fromWkt( &quot;CompoundCurve(LineString(0 0, 1 1),Point( 2 2 ))&quot; ) );</span></a>
<a name="10740"><span class="lineNum">   10740 </span>                :            : </a>
<a name="10741"><span class="lineNum">   10741 </span>                :            :   //asGML2</a>
<a name="10742"><span class="lineNum">   10742 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve exportCurve;</span></a>
<a name="10743"><span class="lineNum">   10743 </span>                :<span class="lineCov">          1 :   QgsCircularString exportLine;</span></a>
<a name="10744"><span class="lineNum">   10744 </span>                :<span class="lineCov">          2 :   exportLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 31, 32 )</span></a>
<a name="10745"><span class="lineNum">   10745 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 41, 42 )</span></a>
<a name="10746"><span class="lineNum">   10746 </span>                :<span class="lineCov">          1 :                         &lt;&lt; QgsPoint( 51, 52 ) );</span></a>
<a name="10747"><span class="lineNum">   10747 </span>                :<span class="lineCov">          1 :   exportCurve.addCurve( exportLine.clone() );</span></a>
<a name="10748"><span class="lineNum">   10748 </span>                :<span class="lineCov">          1 :   QgsLineString exportLineString;</span></a>
<a name="10749"><span class="lineNum">   10749 </span>                :<span class="lineCov">          2 :   exportLineString.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 51, 52 )</span></a>
<a name="10750"><span class="lineNum">   10750 </span>                :<span class="lineCov">          1 :                               &lt;&lt; QgsPoint( 61, 62 ) );</span></a>
<a name="10751"><span class="lineNum">   10751 </span>                :<span class="lineCov">          1 :   exportCurve.addCurve( exportLineString.clone() );</span></a>
<a name="10752"><span class="lineNum">   10752 </span>                :            : </a>
<a name="10753"><span class="lineNum">   10753 </span>                :<span class="lineCov">          1 :   QgsCircularString exportLineFloat;</span></a>
<a name="10754"><span class="lineNum">   10754 </span>                :<span class="lineCov">          2 :   exportLineFloat.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1 / 3.0, 2 / 3.0 )</span></a>
<a name="10755"><span class="lineNum">   10755 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 1 + 1 / 3.0, 1 + 2 / 3.0 )</span></a>
<a name="10756"><span class="lineNum">   10756 </span>                :<span class="lineCov">          1 :                              &lt;&lt; QgsPoint( 2 + 1 / 3.0, 2 + 2 / 3.0 ) );</span></a>
<a name="10757"><span class="lineNum">   10757 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve exportCurveFloat;</span></a>
<a name="10758"><span class="lineNum">   10758 </span>                :<span class="lineCov">          1 :   exportCurveFloat.addCurve( exportLineFloat.clone() );</span></a>
<a name="10759"><span class="lineNum">   10759 </span>                :<span class="lineCov">          1 :   QgsLineString exportLineStringFloat;</span></a>
<a name="10760"><span class="lineNum">   10760 </span>                :<span class="lineCov">          2 :   exportLineStringFloat.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2 + 1 / 3.0, 2 + 2 / 3.0 )</span></a>
<a name="10761"><span class="lineNum">   10761 </span>                :<span class="lineCov">          1 :                                    &lt;&lt; QgsPoint( 3 + 1 / 3.0, 3 + 2 / 3.0 ) );</span></a>
<a name="10762"><span class="lineNum">   10762 </span>                :<span class="lineCov">          1 :   exportCurveFloat.addCurve( exportLineStringFloat.clone() );</span></a>
<a name="10763"><span class="lineNum">   10763 </span>                :            : </a>
<a name="10764"><span class="lineNum">   10764 </span>                :<span class="lineCov">          2 :   QDomDocument doc( QStringLiteral( &quot;gml&quot; ) );</span></a>
<a name="10765"><span class="lineNum">   10765 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;31,32 41,42 51,52 61,62&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="10766"><span class="lineNum">   10766 </span>                :<span class="lineCov">          1 :   QString result = elemToString( exportCurve.asGml2( doc ) );</span></a>
<a name="10767"><span class="lineNum">   10767 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( result, expectedGML2 );</span></a>
<a name="10768"><span class="lineNum">   10768 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.333,0.667 1.333,1.667 2.333,2.667 3.333,3.667&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="10769"><span class="lineNum">   10769 </span>                :<span class="lineCov">          1 :   result = elemToString( exportCurveFloat.asGml2( doc, 3 ) );</span></a>
<a name="10770"><span class="lineNum">   10770 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( result, expectedGML2prec3 );</span></a>
<a name="10771"><span class="lineNum">   10771 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;LineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="10772"><span class="lineNum">   10772 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCompoundCurve().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="10773"><span class="lineNum">   10773 </span>                :            : </a>
<a name="10774"><span class="lineNum">   10774 </span>                :            : </a>
<a name="10775"><span class="lineNum">   10775 </span>                :            :   //asGML3</a>
<a name="10776"><span class="lineNum">   10776 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;CompositeCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;31 32 41 42 51 52&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;51 52 61 62&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;/CompositeCurve&gt;&quot; ) );</span></a>
<a name="10777"><span class="lineNum">   10777 </span>                :<span class="lineCov">          1 :   result = elemToString( exportCurve.asGml3( doc ) );</span></a>
<a name="10778"><span class="lineNum">   10778 </span>                :<span class="lineCov">          1 :   QCOMPARE( result, expectedGML3 );</span></a>
<a name="10779"><span class="lineNum">   10779 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;CompositeCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.333 0.667 1.333 1.667 2.333 2.667&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;2.333 2.667 3.333 3.667&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;/CompositeCurve&gt;&quot; ) );</span></a>
<a name="10780"><span class="lineNum">   10780 </span>                :<span class="lineCov">          1 :   result = elemToString( exportCurveFloat.asGml3( doc, 3 ) );</span></a>
<a name="10781"><span class="lineNum">   10781 </span>                :<span class="lineCov">          1 :   QCOMPARE( result, expectedGML3prec3 );</span></a>
<a name="10782"><span class="lineNum">   10782 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;CompositeCurve xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="10783"><span class="lineNum">   10783 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsCompoundCurve().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="10784"><span class="lineNum">   10784 </span>                :            : </a>
<a name="10785"><span class="lineNum">   10785 </span>                :            :   //asJSON</a>
<a name="10786"><span class="lineNum">   10786 </span>                :<span class="lineCov">          1 :   QString expectedJson( &quot;{\&quot;coordinates\&quot;:[[31.0,32.0],[41.0,42.0],[51.0,52.0],[61.0,62.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="10787"><span class="lineNum">   10787 </span>                :<span class="lineCov">          1 :   result = exportCurve.asJson();</span></a>
<a name="10788"><span class="lineNum">   10788 </span>                :<span class="lineCov">          1 :   QCOMPARE( result, expectedJson );</span></a>
<a name="10789"><span class="lineNum">   10789 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[0.333,0.667],[1.333,1.667],[2.333,2.667],[3.333,3.667]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="10790"><span class="lineNum">   10790 </span>                :<span class="lineCov">          1 :   result = exportCurveFloat.asJson( 3 );</span></a>
<a name="10791"><span class="lineNum">   10791 </span>                :<span class="lineCov">          1 :   QCOMPARE( result, expectedJsonPrec3 );</span></a>
<a name="10792"><span class="lineNum">   10792 </span>                :            : </a>
<a name="10793"><span class="lineNum">   10793 </span>                :            :   //asKML</a>
<a name="10794"><span class="lineNum">   10794 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;31,32,0 41,42,0 51,52,0 61,62,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="10795"><span class="lineNum">   10795 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportCurve.asKml(), expectedKml );</span></a>
<a name="10796"><span class="lineNum">   10796 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.333,0.667,0 1.333,1.667,0 2.333,2.667,0 3.333,3.667,0&lt;/coordinates&gt;&lt;/LineString&gt;&quot; ) );</span></a>
<a name="10797"><span class="lineNum">   10797 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportCurveFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="10798"><span class="lineNum">   10798 </span>                :            : </a>
<a name="10799"><span class="lineNum">   10799 </span>                :            :   //length</a>
<a name="10800"><span class="lineNum">   10800 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c19;</span></a>
<a name="10801"><span class="lineNum">   10801 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.length(), 0.0 );</span></a>
<a name="10802"><span class="lineNum">   10802 </span>                :<span class="lineCov">          1 :   QgsCircularString l19;</span></a>
<a name="10803"><span class="lineNum">   10803 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="10804"><span class="lineNum">   10804 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="10805"><span class="lineNum">   10805 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="10806"><span class="lineNum">   10806 </span>                :<span class="lineCov">          1 :   c19.addCurve( l19.clone() );</span></a>
<a name="10807"><span class="lineNum">   10807 </span>                :<span class="lineCov">          1 :   QgsLineString l19a;</span></a>
<a name="10808"><span class="lineNum">   10808 </span>                :<span class="lineCov">          2 :   l19a.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 )</span></a>
<a name="10809"><span class="lineNum">   10809 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 25, 10, 6, 7 ) );</span></a>
<a name="10810"><span class="lineNum">   10810 </span>                :<span class="lineCov">          1 :   c19.addCurve( l19a.clone() );</span></a>
<a name="10811"><span class="lineNum">   10811 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c19.length(), 36.1433, 0.001 );</span></a>
<a name="10812"><span class="lineNum">   10812 </span>                :            : </a>
<a name="10813"><span class="lineNum">   10813 </span>                :            :   //startPoint</a>
<a name="10814"><span class="lineNum">   10814 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="10815"><span class="lineNum">   10815 </span>                :            : </a>
<a name="10816"><span class="lineNum">   10816 </span>                :            :   //endPoint</a>
<a name="10817"><span class="lineNum">   10817 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.endPoint(), QgsPoint( QgsWkbTypes::PointZM, 25, 10, 6, 7 ) );</span></a>
<a name="10818"><span class="lineNum">   10818 </span>                :            : </a>
<a name="10819"><span class="lineNum">   10819 </span>                :            :   //bad start/end points. Test that this doesn't crash.</a>
<a name="10820"><span class="lineNum">   10820 </span>                :<span class="lineCov">          1 :   c19.clear();</span></a>
<a name="10821"><span class="lineNum">   10821 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.startPoint().isEmpty() );</span></a>
<a name="10822"><span class="lineNum">   10822 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.endPoint().isEmpty() );</span></a>
<a name="10823"><span class="lineNum">   10823 </span>                :            : </a>
<a name="10824"><span class="lineNum">   10824 </span>                :            :   //curveToLine</a>
<a name="10825"><span class="lineNum">   10825 </span>                :<span class="lineCov">          1 :   c19.clear();</span></a>
<a name="10826"><span class="lineNum">   10826 </span>                :<span class="lineCov">          2 :   l19.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="10827"><span class="lineNum">   10827 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="10828"><span class="lineNum">   10828 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="10829"><span class="lineNum">   10829 </span>                :<span class="lineCov">          1 :   c19.addCurve( l19.clone() );</span></a>
<a name="10830"><span class="lineNum">   10830 </span>                :<span class="lineCov">          2 :   l19a.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 )</span></a>
<a name="10831"><span class="lineNum">   10831 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 25, 10, 6, 7 ) );</span></a>
<a name="10832"><span class="lineNum">   10832 </span>                :<span class="lineCov">          1 :   c19.addCurve( l19a.clone() );</span></a>
<a name="10833"><span class="lineNum">   10833 </span>                :<span class="lineCov">          1 :   segmentized.reset( c19.curveToLine() );</span></a>
<a name="10834"><span class="lineNum">   10834 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;numPoints(), 182 );</span></a>
<a name="10835"><span class="lineNum">   10835 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;wkbType(), QgsWkbTypes::LineStringZM );</span></a>
<a name="10836"><span class="lineNum">   10836 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;is3D() );</span></a>
<a name="10837"><span class="lineNum">   10837 </span>                :<span class="lineCov">          1 :   QVERIFY( segmentized-&gt;isMeasure() );</span></a>
<a name="10838"><span class="lineNum">   10838 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( 0 ), l19.pointN( 0 ) );</span></a>
<a name="10839"><span class="lineNum">   10839 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized-&gt;pointN( segmentized-&gt;numPoints() - 1 ), l19a.pointN( l19a.numPoints() - 1 ) );</span></a>
<a name="10840"><span class="lineNum">   10840 </span>                :            : </a>
<a name="10841"><span class="lineNum">   10841 </span>                :            :   // points</a>
<a name="10842"><span class="lineNum">   10842 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c20;</span></a>
<a name="10843"><span class="lineNum">   10843 </span>                :<span class="lineCov">          1 :   QgsCircularString l20;</span></a>
<a name="10844"><span class="lineNum">   10844 </span>                :<span class="lineCov">          1 :   QgsPointSequence points;</span></a>
<a name="10845"><span class="lineNum">   10845 </span>                :<span class="lineCov">          1 :   c20.points( points );</span></a>
<a name="10846"><span class="lineNum">   10846 </span>                :<span class="lineCov">          1 :   QVERIFY( points.isEmpty() );</span></a>
<a name="10847"><span class="lineNum">   10847 </span>                :<span class="lineCov">          2 :   l20.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="10848"><span class="lineNum">   10848 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="10849"><span class="lineNum">   10849 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="10850"><span class="lineNum">   10850 </span>                :<span class="lineCov">          1 :   c20.addCurve( l20.clone() );</span></a>
<a name="10851"><span class="lineNum">   10851 </span>                :<span class="lineCov">          1 :   QgsLineString ls20;</span></a>
<a name="10852"><span class="lineNum">   10852 </span>                :<span class="lineCov">          2 :   ls20.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 )</span></a>
<a name="10853"><span class="lineNum">   10853 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 25, 10, 6, 7 ) );</span></a>
<a name="10854"><span class="lineNum">   10854 </span>                :<span class="lineCov">          1 :   c20.addCurve( ls20.clone() );</span></a>
<a name="10855"><span class="lineNum">   10855 </span>                :<span class="lineCov">          1 :   c20.points( points );</span></a>
<a name="10856"><span class="lineNum">   10856 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 4 );</span></a>
<a name="10857"><span class="lineNum">   10857 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 ) );</span></a>
<a name="10858"><span class="lineNum">   10858 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 ) );</span></a>
<a name="10859"><span class="lineNum">   10859 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="10860"><span class="lineNum">   10860 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.at( 3 ), QgsPoint( QgsWkbTypes::PointZM, 25, 10, 6, 7 ) );</span></a>
<a name="10861"><span class="lineNum">   10861 </span>                :            : </a>
<a name="10862"><span class="lineNum">   10862 </span>                :            :   //CRS transform</a>
<a name="10863"><span class="lineNum">   10863 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="10864"><span class="lineNum">   10864 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) ); // want a transform with ellipsoid change</span></a>
<a name="10865"><span class="lineNum">   10865 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="10866"><span class="lineNum">   10866 </span>                :            : </a>
<a name="10867"><span class="lineNum">   10867 </span>                :            :   // 2d CRS transform</a>
<a name="10868"><span class="lineNum">   10868 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c21;</span></a>
<a name="10869"><span class="lineNum">   10869 </span>                :<span class="lineCov">          1 :   QgsCircularString l21;</span></a>
<a name="10870"><span class="lineNum">   10870 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6374985, -3626584 )</span></a>
<a name="10871"><span class="lineNum">   10871 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6474985, -3526584 ) );</span></a>
<a name="10872"><span class="lineNum">   10872 </span>                :<span class="lineCov">          1 :   c21.addCurve( l21.clone() );</span></a>
<a name="10873"><span class="lineNum">   10873 </span>                :<span class="lineCov">          1 :   QgsLineString ls21;</span></a>
<a name="10874"><span class="lineNum">   10874 </span>                :<span class="lineCov">          2 :   ls21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6474985, -3526584 )</span></a>
<a name="10875"><span class="lineNum">   10875 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 6504985, -3526584 ) );</span></a>
<a name="10876"><span class="lineNum">   10876 </span>                :<span class="lineCov">          1 :   c21.addCurve( ls21.clone() );</span></a>
<a name="10877"><span class="lineNum">   10877 </span>                :<span class="lineCov">          1 :   c21.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="10878"><span class="lineNum">   10878 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.xAt( 0 ), 175.771, 0.001 );</span></a>
<a name="10879"><span class="lineNum">   10879 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.yAt( 0 ), -39.724, 0.001 );</span></a>
<a name="10880"><span class="lineNum">   10880 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.xAt( 1 ), 176.959, 0.001 );</span></a>
<a name="10881"><span class="lineNum">   10881 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.yAt( 1 ), -38.7999, 0.001 );</span></a>
<a name="10882"><span class="lineNum">   10882 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.xAt( 2 ), 177.315211, 0.001 );</span></a>
<a name="10883"><span class="lineNum">   10883 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.yAt( 2 ), -38.799974, 0.001 );</span></a>
<a name="10884"><span class="lineNum">   10884 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.boundingBox().xMinimum(), 175.770033, 0.001 );</span></a>
<a name="10885"><span class="lineNum">   10885 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="10886"><span class="lineNum">   10886 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.boundingBox().xMaximum(), 177.315211, 0.001 );</span></a>
<a name="10887"><span class="lineNum">   10887 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c21.boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="10888"><span class="lineNum">   10888 </span>                :            : </a>
<a name="10889"><span class="lineNum">   10889 </span>                :            :   //3d CRS transform</a>
<a name="10890"><span class="lineNum">   10890 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c22;</span></a>
<a name="10891"><span class="lineNum">   10891 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 )</span></a>
<a name="10892"><span class="lineNum">   10892 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6474985, -3526584, 3, 4 ) );</span></a>
<a name="10893"><span class="lineNum">   10893 </span>                :<span class="lineCov">          1 :   c22.addCurve( l21.clone() );</span></a>
<a name="10894"><span class="lineNum">   10894 </span>                :<span class="lineCov">          2 :   ls21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6474985, -3526584, 3, 4 )</span></a>
<a name="10895"><span class="lineNum">   10895 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 6504985, -3526584, 5, 6 ) );</span></a>
<a name="10896"><span class="lineNum">   10896 </span>                :<span class="lineCov">          1 :   c22.addCurve( ls21.clone() );</span></a>
<a name="10897"><span class="lineNum">   10897 </span>                :<span class="lineCov">          1 :   c22.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="10898"><span class="lineNum">   10898 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="10899"><span class="lineNum">   10899 </span>                :            :   QgsVertexId::VertexType v;</a>
<a name="10900"><span class="lineNum">   10900 </span>                :<span class="lineCov">          1 :   c22.pointAt( 0, pt, v );</span></a>
<a name="10901"><span class="lineNum">   10901 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 175.771, 0.001 );</span></a>
<a name="10902"><span class="lineNum">   10902 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -39.724, 0.001 );</span></a>
<a name="10903"><span class="lineNum">   10903 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 1.0, 0.001 );</span></a>
<a name="10904"><span class="lineNum">   10904 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 2.0 );</span></a>
<a name="10905"><span class="lineNum">   10905 </span>                :<span class="lineCov">          1 :   c22.pointAt( 1, pt, v );</span></a>
<a name="10906"><span class="lineNum">   10906 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 176.959, 0.001 );</span></a>
<a name="10907"><span class="lineNum">   10907 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -38.7999, 0.001 );</span></a>
<a name="10908"><span class="lineNum">   10908 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 3.0, 0.001 );</span></a>
<a name="10909"><span class="lineNum">   10909 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 4.0 );</span></a>
<a name="10910"><span class="lineNum">   10910 </span>                :<span class="lineCov">          1 :   c22.pointAt( 2, pt, v );</span></a>
<a name="10911"><span class="lineNum">   10911 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 177.315211, 0.001 );</span></a>
<a name="10912"><span class="lineNum">   10912 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -38.7999, 0.001 );</span></a>
<a name="10913"><span class="lineNum">   10913 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 5.0, 0.001 );</span></a>
<a name="10914"><span class="lineNum">   10914 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 6.0 );</span></a>
<a name="10915"><span class="lineNum">   10915 </span>                :            : </a>
<a name="10916"><span class="lineNum">   10916 </span>                :            :   //reverse transform</a>
<a name="10917"><span class="lineNum">   10917 </span>                :<span class="lineCov">          1 :   c22.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="10918"><span class="lineNum">   10918 </span>                :<span class="lineCov">          1 :   c22.pointAt( 0, pt, v );</span></a>
<a name="10919"><span class="lineNum">   10919 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6374985, 100 );</span></a>
<a name="10920"><span class="lineNum">   10920 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -3626584, 100 );</span></a>
<a name="10921"><span class="lineNum">   10921 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 1.0, 0.001 );</span></a>
<a name="10922"><span class="lineNum">   10922 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 2.0 );</span></a>
<a name="10923"><span class="lineNum">   10923 </span>                :<span class="lineCov">          1 :   c22.pointAt( 1, pt, v );</span></a>
<a name="10924"><span class="lineNum">   10924 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6474985, 100 );</span></a>
<a name="10925"><span class="lineNum">   10925 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -3526584, 100 );</span></a>
<a name="10926"><span class="lineNum">   10926 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 3.0, 0.001 );</span></a>
<a name="10927"><span class="lineNum">   10927 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 4.0 );</span></a>
<a name="10928"><span class="lineNum">   10928 </span>                :<span class="lineCov">          1 :   c22.pointAt( 2, pt, v );</span></a>
<a name="10929"><span class="lineNum">   10929 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6504985, 100 );</span></a>
<a name="10930"><span class="lineNum">   10930 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), -3526584, 100 );</span></a>
<a name="10931"><span class="lineNum">   10931 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.z(), 5.0, 0.001 );</span></a>
<a name="10932"><span class="lineNum">   10932 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt.m(), 6.0 );</span></a>
<a name="10933"><span class="lineNum">   10933 </span>                :            : </a>
<a name="10934"><span class="lineNum">   10934 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="10935"><span class="lineNum">   10935 </span>                :            :   //z value transform</a>
<a name="10936"><span class="lineNum">   10936 </span>                :            :   c22.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="10937"><span class="lineNum">   10937 </span>                :            :   c22.pointAt( 0, pt, v );</a>
<a name="10938"><span class="lineNum">   10938 </span>                :            :   QGSCOMPARENEAR( pt.z(), -19.249066, 0.001 );</a>
<a name="10939"><span class="lineNum">   10939 </span>                :            :   c22.pointAt( 1, pt, v );</a>
<a name="10940"><span class="lineNum">   10940 </span>                :            :   QGSCOMPARENEAR( pt.z(), -21.092128, 0.001 );</a>
<a name="10941"><span class="lineNum">   10941 </span>                :            :   c22.pointAt( 2, pt, v );</a>
<a name="10942"><span class="lineNum">   10942 </span>                :            :   QGSCOMPARENEAR( pt.z(), -19.370485, 0.001 );</a>
<a name="10943"><span class="lineNum">   10943 </span>                :            : </a>
<a name="10944"><span class="lineNum">   10944 </span>                :            :   c22.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="10945"><span class="lineNum">   10945 </span>                :            :   c22.pointAt( 0, pt, v );</a>
<a name="10946"><span class="lineNum">   10946 </span>                :            :   QGSCOMPARENEAR( pt.z(), 1, 0.001 );</a>
<a name="10947"><span class="lineNum">   10947 </span>                :            :   c22.pointAt( 1, pt, v );</a>
<a name="10948"><span class="lineNum">   10948 </span>                :            :   QGSCOMPARENEAR( pt.z(), 3, 0.001 );</a>
<a name="10949"><span class="lineNum">   10949 </span>                :            :   c22.pointAt( 2, pt, v );</a>
<a name="10950"><span class="lineNum">   10950 </span>                :            :   QGSCOMPARENEAR( pt.z(), 5, 0.001 );</a>
<a name="10951"><span class="lineNum">   10951 </span>                :            : #endif</a>
<a name="10952"><span class="lineNum">   10952 </span>                :            : </a>
<a name="10953"><span class="lineNum">   10953 </span>                :            :   //QTransform transform</a>
<a name="10954"><span class="lineNum">   10954 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="10955"><span class="lineNum">   10955 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c23;</span></a>
<a name="10956"><span class="lineNum">   10956 </span>                :<span class="lineCov">          1 :   QgsCircularString l23;</span></a>
<a name="10957"><span class="lineNum">   10957 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="10958"><span class="lineNum">   10958 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="10959"><span class="lineNum">   10959 </span>                :<span class="lineCov">          1 :   c23.addCurve( l23.clone() );</span></a>
<a name="10960"><span class="lineNum">   10960 </span>                :<span class="lineCov">          1 :   QgsLineString ls23;</span></a>
<a name="10961"><span class="lineNum">   10961 </span>                :<span class="lineCov">          1 :   ls23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 13, 13, 14 ) );</span></a>
<a name="10962"><span class="lineNum">   10962 </span>                :<span class="lineCov">          1 :   c23.addCurve( ls23.clone() );</span></a>
<a name="10963"><span class="lineNum">   10963 </span>                :<span class="lineCov">          1 :   c23.transform( qtr, 5, 2, 4, 3 );</span></a>
<a name="10964"><span class="lineNum">   10964 </span>                :<span class="lineCov">          1 :   c23.pointAt( 0, pt, v );</span></a>
<a name="10965"><span class="lineNum">   10965 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 2, 6, 11, 16 ) );</span></a>
<a name="10966"><span class="lineNum">   10966 </span>                :<span class="lineCov">          1 :   c23.pointAt( 1, pt, v );</span></a>
<a name="10967"><span class="lineNum">   10967 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 22, 36, 31, 46 ) );</span></a>
<a name="10968"><span class="lineNum">   10968 </span>                :<span class="lineCov">          1 :   c23.pointAt( 2, pt, v );</span></a>
<a name="10969"><span class="lineNum">   10969 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 42, 39, 31, 46 ) );</span></a>
<a name="10970"><span class="lineNum">   10970 </span>                :<span class="lineCov">          1 :   QCOMPARE( c23.boundingBox(), QgsRectangle( 2, 6, 42, 39 ) );</span></a>
<a name="10971"><span class="lineNum">   10971 </span>                :            : </a>
<a name="10972"><span class="lineNum">   10972 </span>                :            :   //insert vertex</a>
<a name="10973"><span class="lineNum">   10973 </span>                :            :   //cannot insert vertex in empty line</a>
<a name="10974"><span class="lineNum">   10974 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c24;</span></a>
<a name="10975"><span class="lineNum">   10975 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="10976"><span class="lineNum">   10976 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 0 );</span></a>
<a name="10977"><span class="lineNum">   10977 </span>                :            : </a>
<a name="10978"><span class="lineNum">   10978 </span>                :            :   //2d line</a>
<a name="10979"><span class="lineNum">   10979 </span>                :<span class="lineCov">          1 :   QgsCircularString l24;</span></a>
<a name="10980"><span class="lineNum">   10980 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="10981"><span class="lineNum">   10981 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="10982"><span class="lineNum">   10982 </span>                :<span class="lineCov">          1 :   c24.addCurve( l24.clone() );</span></a>
<a name="10983"><span class="lineNum">   10983 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 4.0, 7.0 ) ) );</span></a>
<a name="10984"><span class="lineNum">   10984 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 5 );</span></a>
<a name="10985"><span class="lineNum">   10985 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.is3D() );</span></a>
<a name="10986"><span class="lineNum">   10986 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.isMeasure() );</span></a>
<a name="10987"><span class="lineNum">   10987 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="10988"><span class="lineNum">   10988 </span>                :<span class="lineCov">          1 :   c24.pointAt( 0, pt, v );</span></a>
<a name="10989"><span class="lineNum">   10989 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="10990"><span class="lineNum">   10990 </span>                :<span class="lineCov">          1 :   c24.pointAt( 1, pt, v );</span></a>
<a name="10991"><span class="lineNum">   10991 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 4.0, 7.0 ) );</span></a>
<a name="10992"><span class="lineNum">   10992 </span>                :<span class="lineCov">          1 :   c24.pointAt( 2, pt, v );</span></a>
<a name="10993"><span class="lineNum">   10993 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7.192236, 0.01 );</span></a>
<a name="10994"><span class="lineNum">   10994 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 9.930870, 0.01 );</span></a>
<a name="10995"><span class="lineNum">   10995 </span>                :<span class="lineCov">          1 :   c24.pointAt( 3, pt, v );</span></a>
<a name="10996"><span class="lineNum">   10996 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="10997"><span class="lineNum">   10997 </span>                :<span class="lineCov">          1 :   c24.pointAt( 4, pt, v );</span></a>
<a name="10998"><span class="lineNum">   10998 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1.0, 22.0 ) );</span></a>
<a name="10999"><span class="lineNum">   10999 </span>                :            : </a>
<a name="11000"><span class="lineNum">   11000 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 8.0, 9.0 ) ) );</span></a>
<a name="11001"><span class="lineNum">   11001 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 18.0, 16.0 ) ) );</span></a>
<a name="11002"><span class="lineNum">   11002 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 9 );</span></a>
<a name="11003"><span class="lineNum">   11003 </span>                :<span class="lineCov">          1 :   c24.pointAt( 0, pt, v );</span></a>
<a name="11004"><span class="lineNum">   11004 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="11005"><span class="lineNum">   11005 </span>                :<span class="lineCov">          1 :   c24.pointAt( 1, pt, v );</span></a>
<a name="11006"><span class="lineNum">   11006 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 4.363083, 0.01 );</span></a>
<a name="11007"><span class="lineNum">   11007 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 5.636917, 0.01 );</span></a>
<a name="11008"><span class="lineNum">   11008 </span>                :<span class="lineCov">          1 :   c24.pointAt( 2, pt, v );</span></a>
<a name="11009"><span class="lineNum">   11009 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 8.0, 9.0 ) );</span></a>
<a name="11010"><span class="lineNum">   11010 </span>                :<span class="lineCov">          1 :   c24.pointAt( 3, pt, v );</span></a>
<a name="11011"><span class="lineNum">   11011 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 18.0, 16.0 ) );</span></a>
<a name="11012"><span class="lineNum">   11012 </span>                :<span class="lineCov">          1 :   c24.pointAt( 4, pt, v );</span></a>
<a name="11013"><span class="lineNum">   11013 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.876894, 0.01 );</span></a>
<a name="11014"><span class="lineNum">   11014 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 8.246211, 0.01 );</span></a>
<a name="11015"><span class="lineNum">   11015 </span>                :<span class="lineCov">          1 :   c24.pointAt( 5, pt, v );</span></a>
<a name="11016"><span class="lineNum">   11016 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 4.0, 7.0 ) );</span></a>
<a name="11017"><span class="lineNum">   11017 </span>                :<span class="lineCov">          1 :   c24.pointAt( 6, pt, v );</span></a>
<a name="11018"><span class="lineNum">   11018 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7.192236, 0.01 );</span></a>
<a name="11019"><span class="lineNum">   11019 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 9.930870, 0.01 );</span></a>
<a name="11020"><span class="lineNum">   11020 </span>                :<span class="lineCov">          1 :   c24.pointAt( 7, pt, v );</span></a>
<a name="11021"><span class="lineNum">   11021 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="11022"><span class="lineNum">   11022 </span>                :<span class="lineCov">          1 :   c24.pointAt( 8, pt, v );</span></a>
<a name="11023"><span class="lineNum">   11023 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1.0, 22.0 ) );</span></a>
<a name="11024"><span class="lineNum">   11024 </span>                :            : </a>
<a name="11025"><span class="lineNum">   11025 </span>                :            :   //insert vertex at end</a>
<a name="11026"><span class="lineNum">   11026 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 31.0, 32.0 ) ) );</span></a>
<a name="11027"><span class="lineNum">   11027 </span>                :            : </a>
<a name="11028"><span class="lineNum">   11028 </span>                :            :   //insert vertex past end</a>
<a name="11029"><span class="lineNum">   11029 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.insertVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="11030"><span class="lineNum">   11030 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 9 );</span></a>
<a name="11031"><span class="lineNum">   11031 </span>                :            : </a>
<a name="11032"><span class="lineNum">   11032 </span>                :            :   //insert vertex before start</a>
<a name="11033"><span class="lineNum">   11033 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.insertVertex( QgsVertexId( 0, 0, -18 ), QgsPoint( 41.0, 42.0 ) ) );</span></a>
<a name="11034"><span class="lineNum">   11034 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 9 );</span></a>
<a name="11035"><span class="lineNum">   11035 </span>                :            : </a>
<a name="11036"><span class="lineNum">   11036 </span>                :            :   //insert 4d vertex in 4d line</a>
<a name="11037"><span class="lineNum">   11037 </span>                :<span class="lineCov">          1 :   c24.clear();</span></a>
<a name="11038"><span class="lineNum">   11038 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="11039"><span class="lineNum">   11039 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="11040"><span class="lineNum">   11040 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="11041"><span class="lineNum">   11041 </span>                :<span class="lineCov">          1 :   c24.addCurve( l24.clone( ) );</span></a>
<a name="11042"><span class="lineNum">   11042 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) ) );</span></a>
<a name="11043"><span class="lineNum">   11043 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 5 );</span></a>
<a name="11044"><span class="lineNum">   11044 </span>                :<span class="lineCov">          1 :   c24.pointAt( 1, pt, v );</span></a>
<a name="11045"><span class="lineNum">   11045 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="11046"><span class="lineNum">   11046 </span>                :            : </a>
<a name="11047"><span class="lineNum">   11047 </span>                :            :   //insert 2d vertex in 4d line</a>
<a name="11048"><span class="lineNum">   11048 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 101, 102 ) ) );</span></a>
<a name="11049"><span class="lineNum">   11049 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 7 );</span></a>
<a name="11050"><span class="lineNum">   11050 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="11051"><span class="lineNum">   11051 </span>                :<span class="lineCov">          1 :   c24.pointAt( 1, pt, v );</span></a>
<a name="11052"><span class="lineNum">   11052 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 101, 102 ) );</span></a>
<a name="11053"><span class="lineNum">   11053 </span>                :            : </a>
<a name="11054"><span class="lineNum">   11054 </span>                :            :   //insert 4d vertex in 2d line</a>
<a name="11055"><span class="lineNum">   11055 </span>                :<span class="lineCov">          1 :   c24.clear();</span></a>
<a name="11056"><span class="lineNum">   11056 </span>                :<span class="lineCov">          2 :   l24.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="11057"><span class="lineNum">   11057 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="11058"><span class="lineNum">   11058 </span>                :<span class="lineCov">          1 :   c24.addCurve( l24.clone() );</span></a>
<a name="11059"><span class="lineNum">   11059 </span>                :<span class="lineCov">          1 :   QVERIFY( c24.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 2, 4, 103, 104 ) ) );</span></a>
<a name="11060"><span class="lineNum">   11060 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.numPoints(), 5 );</span></a>
<a name="11061"><span class="lineNum">   11061 </span>                :<span class="lineCov">          1 :   QCOMPARE( c24.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11062"><span class="lineNum">   11062 </span>                :<span class="lineCov">          1 :   c24.pointAt( 1, pt, v );</span></a>
<a name="11063"><span class="lineNum">   11063 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 2, 4 ) );</span></a>
<a name="11064"><span class="lineNum">   11064 </span>                :            : </a>
<a name="11065"><span class="lineNum">   11065 </span>                :            :   // invalid</a>
<a name="11066"><span class="lineNum">   11066 </span>                :<span class="lineCov">          1 :   QVERIFY( !c24.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 1, 2 ) ) );</span></a>
<a name="11067"><span class="lineNum">   11067 </span>                :            : </a>
<a name="11068"><span class="lineNum">   11068 </span>                :            :   //move vertex</a>
<a name="11069"><span class="lineNum">   11069 </span>                :            : </a>
<a name="11070"><span class="lineNum">   11070 </span>                :            :   //empty line</a>
<a name="11071"><span class="lineNum">   11071 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c25;</span></a>
<a name="11072"><span class="lineNum">   11072 </span>                :<span class="lineCov">          1 :   QgsCircularString l25;</span></a>
<a name="11073"><span class="lineNum">   11073 </span>                :<span class="lineCov">          1 :   QVERIFY( !c25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="11074"><span class="lineNum">   11074 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.isEmpty() );</span></a>
<a name="11075"><span class="lineNum">   11075 </span>                :            : </a>
<a name="11076"><span class="lineNum">   11076 </span>                :            :   //valid line</a>
<a name="11077"><span class="lineNum">   11077 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="11078"><span class="lineNum">   11078 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="11079"><span class="lineNum">   11079 </span>                :<span class="lineCov">          1 :   c25.addCurve( l25.clone() );</span></a>
<a name="11080"><span class="lineNum">   11080 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="11081"><span class="lineNum">   11081 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="11082"><span class="lineNum">   11082 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="11083"><span class="lineNum">   11083 </span>                :<span class="lineCov">          1 :   c25.pointAt( 0, pt, v );</span></a>
<a name="11084"><span class="lineNum">   11084 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="11085"><span class="lineNum">   11085 </span>                :<span class="lineCov">          1 :   c25.pointAt( 1, pt, v );</span></a>
<a name="11086"><span class="lineNum">   11086 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="11087"><span class="lineNum">   11087 </span>                :<span class="lineCov">          1 :   c25.pointAt( 2, pt, v );</span></a>
<a name="11088"><span class="lineNum">   11088 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="11089"><span class="lineNum">   11089 </span>                :            : </a>
<a name="11090"><span class="lineNum">   11090 </span>                :            :   //out of range</a>
<a name="11091"><span class="lineNum">   11091 </span>                :<span class="lineCov">          1 :   QVERIFY( !c25.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="11092"><span class="lineNum">   11092 </span>                :<span class="lineCov">          1 :   QVERIFY( !c25.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="11093"><span class="lineNum">   11093 </span>                :<span class="lineCov">          1 :   QVERIFY( !c25.moveVertex( QgsVertexId( 0, 1, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="11094"><span class="lineNum">   11094 </span>                :<span class="lineCov">          1 :   c25.pointAt( 0, pt, v );</span></a>
<a name="11095"><span class="lineNum">   11095 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="11096"><span class="lineNum">   11096 </span>                :<span class="lineCov">          1 :   c25.pointAt( 1, pt, v );</span></a>
<a name="11097"><span class="lineNum">   11097 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="11098"><span class="lineNum">   11098 </span>                :<span class="lineCov">          1 :   c25.pointAt( 2, pt, v );</span></a>
<a name="11099"><span class="lineNum">   11099 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="11100"><span class="lineNum">   11100 </span>                :            : </a>
<a name="11101"><span class="lineNum">   11101 </span>                :            :   //move 4d point in 4d line</a>
<a name="11102"><span class="lineNum">   11102 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 2, 3 )</span></a>
<a name="11103"><span class="lineNum">   11103 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 10, 4, 5 )</span></a>
<a name="11104"><span class="lineNum">   11104 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 15, 10, 6, 7 ) );</span></a>
<a name="11105"><span class="lineNum">   11105 </span>                :<span class="lineCov">          1 :   c25.clear();</span></a>
<a name="11106"><span class="lineNum">   11106 </span>                :<span class="lineCov">          1 :   c25.addCurve( l25.clone() );</span></a>
<a name="11107"><span class="lineNum">   11107 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) ) );</span></a>
<a name="11108"><span class="lineNum">   11108 </span>                :<span class="lineCov">          1 :   c25.pointAt( 1, pt, v );</span></a>
<a name="11109"><span class="lineNum">   11109 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 6, 7, 12, 13 ) );</span></a>
<a name="11110"><span class="lineNum">   11110 </span>                :            : </a>
<a name="11111"><span class="lineNum">   11111 </span>                :            :   //move 2d point in 4d line, existing z/m should be maintained</a>
<a name="11112"><span class="lineNum">   11112 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 34, 35 ) ) );</span></a>
<a name="11113"><span class="lineNum">   11113 </span>                :<span class="lineCov">          1 :   c25.pointAt( 1, pt, v );</span></a>
<a name="11114"><span class="lineNum">   11114 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 34, 35, 12, 13 ) );</span></a>
<a name="11115"><span class="lineNum">   11115 </span>                :            : </a>
<a name="11116"><span class="lineNum">   11116 </span>                :            :   //move 4d point in 2d line</a>
<a name="11117"><span class="lineNum">   11117 </span>                :<span class="lineCov">          2 :   l25.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="11118"><span class="lineNum">   11118 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="11119"><span class="lineNum">   11119 </span>                :<span class="lineCov">          1 :   c25.clear();</span></a>
<a name="11120"><span class="lineNum">   11120 </span>                :<span class="lineCov">          1 :   c25.addCurve( l25.clone() );</span></a>
<a name="11121"><span class="lineNum">   11121 </span>                :<span class="lineCov">          1 :   QVERIFY( c25.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( QgsWkbTypes::PointZM, 3, 4, 2, 3 ) ) );</span></a>
<a name="11122"><span class="lineNum">   11122 </span>                :<span class="lineCov">          1 :   c25.pointAt( 0, pt, v );</span></a>
<a name="11123"><span class="lineNum">   11123 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 3, 4 ) );</span></a>
<a name="11124"><span class="lineNum">   11124 </span>                :            : </a>
<a name="11125"><span class="lineNum">   11125 </span>                :            :   //delete vertex</a>
<a name="11126"><span class="lineNum">   11126 </span>                :            : </a>
<a name="11127"><span class="lineNum">   11127 </span>                :            :   //empty line</a>
<a name="11128"><span class="lineNum">   11128 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c26;</span></a>
<a name="11129"><span class="lineNum">   11129 </span>                :<span class="lineCov">          1 :   QgsCircularString l26;</span></a>
<a name="11130"><span class="lineNum">   11130 </span>                :<span class="lineCov">          1 :   QVERIFY( !c26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="11131"><span class="lineNum">   11131 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.isEmpty() );</span></a>
<a name="11132"><span class="lineNum">   11132 </span>                :            : </a>
<a name="11133"><span class="lineNum">   11133 </span>                :            :   //valid line</a>
<a name="11134"><span class="lineNum">   11134 </span>                :<span class="lineCov">          2 :   l26.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="11135"><span class="lineNum">   11135 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="11136"><span class="lineNum">   11136 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 )</span></a>
<a name="11137"><span class="lineNum">   11137 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 32, 6, 7 ) );</span></a>
<a name="11138"><span class="lineNum">   11138 </span>                :<span class="lineCov">          1 :   c26.addCurve( l26.clone() );</span></a>
<a name="11139"><span class="lineNum">   11139 </span>                :            :   //out of range vertices</a>
<a name="11140"><span class="lineNum">   11140 </span>                :<span class="lineCov">          1 :   QVERIFY( !c26.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="11141"><span class="lineNum">   11141 </span>                :<span class="lineCov">          1 :   QVERIFY( !c26.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="11142"><span class="lineNum">   11142 </span>                :            : </a>
<a name="11143"><span class="lineNum">   11143 </span>                :            :   //valid vertices</a>
<a name="11144"><span class="lineNum">   11144 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="11145"><span class="lineNum">   11145 </span>                :<span class="lineCov">          1 :   QCOMPARE( c26.numPoints(), 2 );</span></a>
<a name="11146"><span class="lineNum">   11146 </span>                :<span class="lineCov">          1 :   c26.pointAt( 0, pt, v );</span></a>
<a name="11147"><span class="lineNum">   11147 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11148"><span class="lineNum">   11148 </span>                :<span class="lineCov">          1 :   c26.pointAt( 1, pt, v );</span></a>
<a name="11149"><span class="lineNum">   11149 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 31, 32, 6, 7 ) );</span></a>
<a name="11150"><span class="lineNum">   11150 </span>                :            : </a>
<a name="11151"><span class="lineNum">   11151 </span>                :            :   //removing the next vertex removes all remaining vertices</a>
<a name="11152"><span class="lineNum">   11152 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="11153"><span class="lineNum">   11153 </span>                :<span class="lineCov">          1 :   QCOMPARE( c26.numPoints(), 0 );</span></a>
<a name="11154"><span class="lineNum">   11154 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.isEmpty() );</span></a>
<a name="11155"><span class="lineNum">   11155 </span>                :            : </a>
<a name="11156"><span class="lineNum">   11156 </span>                :            :   // two lines</a>
<a name="11157"><span class="lineNum">   11157 </span>                :<span class="lineCov">          1 :   QgsLineString ls26;</span></a>
<a name="11158"><span class="lineNum">   11158 </span>                :<span class="lineCov">          1 :   c26.clear();</span></a>
<a name="11159"><span class="lineNum">   11159 </span>                :<span class="lineCov">          2 :   ls26.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="11160"><span class="lineNum">   11160 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="11161"><span class="lineNum">   11161 </span>                :<span class="lineCov">          1 :   c26.addCurve( ls26.clone() );</span></a>
<a name="11162"><span class="lineNum">   11162 </span>                :<span class="lineCov">          2 :   ls26.setPoints( QgsPointSequence()</span></a>
<a name="11163"><span class="lineNum">   11163 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="11164"><span class="lineNum">   11164 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 32, 4, 5 )</span></a>
<a name="11165"><span class="lineNum">   11165 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 42, 4, 5 ) );</span></a>
<a name="11166"><span class="lineNum">   11166 </span>                :<span class="lineCov">          1 :   c26.addCurve( ls26.clone() );</span></a>
<a name="11167"><span class="lineNum">   11167 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="11168"><span class="lineNum">   11168 </span>                :<span class="lineCov">          1 :   QCOMPARE( c26.nCurves(), 1 );</span></a>
<a name="11169"><span class="lineNum">   11169 </span>                :<span class="lineCov">          1 :   const QgsLineString *ls26r = dynamic_cast&lt; const QgsLineString * &gt;( c26.curveAt( 0 ) );</span></a>
<a name="11170"><span class="lineNum">   11170 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;numPoints(), 2 );</span></a>
<a name="11171"><span class="lineNum">   11171 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11172"><span class="lineNum">   11172 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;endPoint(), QgsPoint( QgsWkbTypes::PointZM, 31, 42, 4, 5 ) );</span></a>
<a name="11173"><span class="lineNum">   11173 </span>                :            : </a>
<a name="11174"><span class="lineNum">   11174 </span>                :            :   //add vertex at the end of linestring</a>
<a name="11175"><span class="lineNum">   11175 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.insertVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( QgsWkbTypes::PointZM, 35, 43, 4, 5 ) ) );</span></a>
<a name="11176"><span class="lineNum">   11176 </span>                :<span class="lineCov">          1 :   ls26r = dynamic_cast&lt; const QgsLineString * &gt;( c26.curveAt( 0 ) );</span></a>
<a name="11177"><span class="lineNum">   11177 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;numPoints(), 3 );</span></a>
<a name="11178"><span class="lineNum">   11178 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11179"><span class="lineNum">   11179 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;endPoint(), QgsPoint( QgsWkbTypes::PointZM, 35, 43, 4, 5 ) );</span></a>
<a name="11180"><span class="lineNum">   11180 </span>                :            : </a>
<a name="11181"><span class="lineNum">   11181 </span>                :<span class="lineCov">          1 :   c26.clear();</span></a>
<a name="11182"><span class="lineNum">   11182 </span>                :<span class="lineCov">          2 :   ls26.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="11183"><span class="lineNum">   11183 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="11184"><span class="lineNum">   11184 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 32, 4, 5 ) );</span></a>
<a name="11185"><span class="lineNum">   11185 </span>                :<span class="lineCov">          1 :   c26.addCurve( ls26.clone() );</span></a>
<a name="11186"><span class="lineNum">   11186 </span>                :<span class="lineCov">          2 :   ls26.setPoints( QgsPointSequence()</span></a>
<a name="11187"><span class="lineNum">   11187 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 32, 4, 5 )</span></a>
<a name="11188"><span class="lineNum">   11188 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 31, 42, 4, 5 ) );</span></a>
<a name="11189"><span class="lineNum">   11189 </span>                :<span class="lineCov">          1 :   c26.addCurve( ls26.clone() );</span></a>
<a name="11190"><span class="lineNum">   11190 </span>                :<span class="lineCov">          1 :   QVERIFY( c26.deleteVertex( QgsVertexId( 0, 0, 2 ) ) );</span></a>
<a name="11191"><span class="lineNum">   11191 </span>                :<span class="lineCov">          1 :   QCOMPARE( c26.nCurves(), 1 );</span></a>
<a name="11192"><span class="lineNum">   11192 </span>                :<span class="lineCov">          1 :   ls26r = dynamic_cast&lt; const QgsLineString * &gt;( c26.curveAt( 0 ) );</span></a>
<a name="11193"><span class="lineNum">   11193 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;numPoints(), 2 );</span></a>
<a name="11194"><span class="lineNum">   11194 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;startPoint(), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11195"><span class="lineNum">   11195 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls26r-&gt;endPoint(), QgsPoint( QgsWkbTypes::PointZM, 31, 42, 4, 5 ) );</span></a>
<a name="11196"><span class="lineNum">   11196 </span>                :            : </a>
<a name="11197"><span class="lineNum">   11197 </span>                :            :   //reversed</a>
<a name="11198"><span class="lineNum">   11198 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c27;</span></a>
<a name="11199"><span class="lineNum">   11199 </span>                :<span class="lineCov">          1 :   QgsCircularString l27;</span></a>
<a name="11200"><span class="lineNum">   11200 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCompoundCurve &gt; reversed( c27.reversed() );</span></a>
<a name="11201"><span class="lineNum">   11201 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isEmpty() );</span></a>
<a name="11202"><span class="lineNum">   11202 </span>                :<span class="lineCov">          2 :   l27.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="11203"><span class="lineNum">   11203 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="11204"><span class="lineNum">   11204 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="11205"><span class="lineNum">   11205 </span>                :<span class="lineCov">          1 :   c27.addCurve( l27.clone() );</span></a>
<a name="11206"><span class="lineNum">   11206 </span>                :<span class="lineCov">          1 :   QgsLineString ls27;</span></a>
<a name="11207"><span class="lineNum">   11207 </span>                :<span class="lineCov">          2 :   ls27.setPoints( QgsPointSequence()</span></a>
<a name="11208"><span class="lineNum">   11208 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 )</span></a>
<a name="11209"><span class="lineNum">   11209 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 23, 32, 7, 8 ) );</span></a>
<a name="11210"><span class="lineNum">   11210 </span>                :<span class="lineCov">          1 :   c27.addCurve( ls27.clone() );</span></a>
<a name="11211"><span class="lineNum">   11211 </span>                :            : </a>
<a name="11212"><span class="lineNum">   11212 </span>                :<span class="lineCov">          1 :   reversed.reset( c27.reversed() );</span></a>
<a name="11213"><span class="lineNum">   11213 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;numPoints(), 4 );</span></a>
<a name="11214"><span class="lineNum">   11214 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; const QgsLineString * &gt;( reversed-&gt;curveAt( 0 ) ) );</span></a>
<a name="11215"><span class="lineNum">   11215 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; const QgsCircularString * &gt;( reversed-&gt;curveAt( 1 ) ) );</span></a>
<a name="11216"><span class="lineNum">   11216 </span>                :<span class="lineCov">          1 :   QCOMPARE( reversed-&gt;wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="11217"><span class="lineNum">   11217 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;is3D() );</span></a>
<a name="11218"><span class="lineNum">   11218 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isMeasure() );</span></a>
<a name="11219"><span class="lineNum">   11219 </span>                :<span class="lineCov">          1 :   reversed-&gt;pointAt( 0, pt, v );</span></a>
<a name="11220"><span class="lineNum">   11220 </span>                :<span class="lineCov">          1 :   reversed-&gt;pointAt( 1, pt, v );</span></a>
<a name="11221"><span class="lineNum">   11221 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="11222"><span class="lineNum">   11222 </span>                :<span class="lineCov">          1 :   reversed-&gt;pointAt( 2, pt, v );</span></a>
<a name="11223"><span class="lineNum">   11223 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="11224"><span class="lineNum">   11224 </span>                :<span class="lineCov">          1 :   reversed-&gt;pointAt( 3, pt, v );</span></a>
<a name="11225"><span class="lineNum">   11225 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11226"><span class="lineNum">   11226 </span>                :            : </a>
<a name="11227"><span class="lineNum">   11227 </span>                :            :   //addZValue</a>
<a name="11228"><span class="lineNum">   11228 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c28;</span></a>
<a name="11229"><span class="lineNum">   11229 </span>                :<span class="lineCov">          1 :   QgsCircularString l28;</span></a>
<a name="11230"><span class="lineNum">   11230 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11231"><span class="lineNum">   11231 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.addZValue() );</span></a>
<a name="11232"><span class="lineNum">   11232 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="11233"><span class="lineNum">   11233 </span>                :<span class="lineCov">          1 :   c28.clear();</span></a>
<a name="11234"><span class="lineNum">   11234 </span>                :            :   //2d line</a>
<a name="11235"><span class="lineNum">   11235 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11236"><span class="lineNum">   11236 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11237"><span class="lineNum">   11237 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="11238"><span class="lineNum">   11238 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11239"><span class="lineNum">   11239 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.addZValue( 2 ) );</span></a>
<a name="11240"><span class="lineNum">   11240 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.is3D() );</span></a>
<a name="11241"><span class="lineNum">   11241 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="11242"><span class="lineNum">   11242 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11243"><span class="lineNum">   11243 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="11244"><span class="lineNum">   11244 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11245"><span class="lineNum">   11245 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="11246"><span class="lineNum">   11246 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11247"><span class="lineNum">   11247 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 3, 4, 2 ) );</span></a>
<a name="11248"><span class="lineNum">   11248 </span>                :            : </a>
<a name="11249"><span class="lineNum">   11249 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28.addZValue( 4 ) ); //already has z value, test that existing z is unchanged</span></a>
<a name="11250"><span class="lineNum">   11250 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11251"><span class="lineNum">   11251 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 2 ) );</span></a>
<a name="11252"><span class="lineNum">   11252 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11253"><span class="lineNum">   11253 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 2 ) );</span></a>
<a name="11254"><span class="lineNum">   11254 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11255"><span class="lineNum">   11255 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 3, 4, 2 ) );</span></a>
<a name="11256"><span class="lineNum">   11256 </span>                :            : </a>
<a name="11257"><span class="lineNum">   11257 </span>                :            :   //linestring with m</a>
<a name="11258"><span class="lineNum">   11258 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="11259"><span class="lineNum">   11259 </span>                :<span class="lineCov">          1 :   c28.clear();</span></a>
<a name="11260"><span class="lineNum">   11260 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11261"><span class="lineNum">   11261 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 32, 0, 4 ) );</span></a>
<a name="11262"><span class="lineNum">   11262 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11263"><span class="lineNum">   11263 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.addZValue( 5 ) );</span></a>
<a name="11264"><span class="lineNum">   11264 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.is3D() );</span></a>
<a name="11265"><span class="lineNum">   11265 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.isMeasure() );</span></a>
<a name="11266"><span class="lineNum">   11266 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="11267"><span class="lineNum">   11267 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11268"><span class="lineNum">   11268 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5, 3 ) );</span></a>
<a name="11269"><span class="lineNum">   11269 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11270"><span class="lineNum">   11270 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 5, 4 ) );</span></a>
<a name="11271"><span class="lineNum">   11271 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11272"><span class="lineNum">   11272 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 21, 32, 5, 4 ) );</span></a>
<a name="11273"><span class="lineNum">   11273 </span>                :            : </a>
<a name="11274"><span class="lineNum">   11274 </span>                :            :   //addMValue</a>
<a name="11275"><span class="lineNum">   11275 </span>                :<span class="lineCov">          1 :   c28.clear();</span></a>
<a name="11276"><span class="lineNum">   11276 </span>                :            :   //2d line</a>
<a name="11277"><span class="lineNum">   11277 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11278"><span class="lineNum">   11278 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11279"><span class="lineNum">   11279 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 3, 4 ) );</span></a>
<a name="11280"><span class="lineNum">   11280 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11281"><span class="lineNum">   11281 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.addMValue( 2 ) );</span></a>
<a name="11282"><span class="lineNum">   11282 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.isMeasure() );</span></a>
<a name="11283"><span class="lineNum">   11283 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="11284"><span class="lineNum">   11284 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11285"><span class="lineNum">   11285 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="11286"><span class="lineNum">   11286 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11287"><span class="lineNum">   11287 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="11288"><span class="lineNum">   11288 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11289"><span class="lineNum">   11289 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 2 ) );</span></a>
<a name="11290"><span class="lineNum">   11290 </span>                :            : </a>
<a name="11291"><span class="lineNum">   11291 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28.addMValue( 4 ) ); //already has z value, test that existing z is unchanged</span></a>
<a name="11292"><span class="lineNum">   11292 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11293"><span class="lineNum">   11293 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 2 ) );</span></a>
<a name="11294"><span class="lineNum">   11294 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11295"><span class="lineNum">   11295 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 2 ) );</span></a>
<a name="11296"><span class="lineNum">   11296 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11297"><span class="lineNum">   11297 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 3, 4, 0, 2 ) );</span></a>
<a name="11298"><span class="lineNum">   11298 </span>                :            : </a>
<a name="11299"><span class="lineNum">   11299 </span>                :            :   //linestring with z</a>
<a name="11300"><span class="lineNum">   11300 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 4 ) );</span></a>
<a name="11301"><span class="lineNum">   11301 </span>                :<span class="lineCov">          1 :   c28.clear();</span></a>
<a name="11302"><span class="lineNum">   11302 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11303"><span class="lineNum">   11303 </span>                :<span class="lineCov">          1 :   l28.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 21, 32, 4 ) );</span></a>
<a name="11304"><span class="lineNum">   11304 </span>                :<span class="lineCov">          1 :   c28.addCurve( l28.clone() );</span></a>
<a name="11305"><span class="lineNum">   11305 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.addMValue( 5 ) );</span></a>
<a name="11306"><span class="lineNum">   11306 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.is3D() );</span></a>
<a name="11307"><span class="lineNum">   11307 </span>                :<span class="lineCov">          1 :   QVERIFY( c28.isMeasure() );</span></a>
<a name="11308"><span class="lineNum">   11308 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="11309"><span class="lineNum">   11309 </span>                :<span class="lineCov">          1 :   c28.pointAt( 0, pt, v );</span></a>
<a name="11310"><span class="lineNum">   11310 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 5 ) );</span></a>
<a name="11311"><span class="lineNum">   11311 </span>                :<span class="lineCov">          1 :   c28.pointAt( 1, pt, v );</span></a>
<a name="11312"><span class="lineNum">   11312 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="11313"><span class="lineNum">   11313 </span>                :<span class="lineCov">          1 :   c28.pointAt( 2, pt, v );</span></a>
<a name="11314"><span class="lineNum">   11314 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 21, 32, 4, 5 ) );</span></a>
<a name="11315"><span class="lineNum">   11315 </span>                :            : </a>
<a name="11316"><span class="lineNum">   11316 </span>                :            :   //dropZValue</a>
<a name="11317"><span class="lineNum">   11317 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c28d;</span></a>
<a name="11318"><span class="lineNum">   11318 </span>                :<span class="lineCov">          1 :   QgsCircularString l28d;</span></a>
<a name="11319"><span class="lineNum">   11319 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropZValue() );</span></a>
<a name="11320"><span class="lineNum">   11320 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11321"><span class="lineNum">   11321 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11322"><span class="lineNum">   11322 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="11323"><span class="lineNum">   11323 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11324"><span class="lineNum">   11324 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropZValue() );</span></a>
<a name="11325"><span class="lineNum">   11325 </span>                :<span class="lineCov">          1 :   c28d.addZValue( 1.0 );</span></a>
<a name="11326"><span class="lineNum">   11326 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="11327"><span class="lineNum">   11327 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.is3D() );</span></a>
<a name="11328"><span class="lineNum">   11328 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.dropZValue() );</span></a>
<a name="11329"><span class="lineNum">   11329 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.is3D() );</span></a>
<a name="11330"><span class="lineNum">   11330 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11331"><span class="lineNum">   11331 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11332"><span class="lineNum">   11332 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="11333"><span class="lineNum">   11333 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 1, pt, v );</span></a>
<a name="11334"><span class="lineNum">   11334 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="11335"><span class="lineNum">   11335 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 2, pt, v );</span></a>
<a name="11336"><span class="lineNum">   11336 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 21, 22 ) );</span></a>
<a name="11337"><span class="lineNum">   11337 </span>                :            : </a>
<a name="11338"><span class="lineNum">   11338 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropZValue() ); //already dropped</span></a>
<a name="11339"><span class="lineNum">   11339 </span>                :            :   //linestring with m</a>
<a name="11340"><span class="lineNum">   11340 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="11341"><span class="lineNum">   11341 </span>                :<span class="lineCov">          1 :   c28d.clear();</span></a>
<a name="11342"><span class="lineNum">   11342 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11343"><span class="lineNum">   11343 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt;  QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 3, 4 ) );</span></a>
<a name="11344"><span class="lineNum">   11344 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11345"><span class="lineNum">   11345 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.dropZValue() );</span></a>
<a name="11346"><span class="lineNum">   11346 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.is3D() );</span></a>
<a name="11347"><span class="lineNum">   11347 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.isMeasure() );</span></a>
<a name="11348"><span class="lineNum">   11348 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="11349"><span class="lineNum">   11349 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11350"><span class="lineNum">   11350 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="11351"><span class="lineNum">   11351 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 1, pt, v );</span></a>
<a name="11352"><span class="lineNum">   11352 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 4 ) );</span></a>
<a name="11353"><span class="lineNum">   11353 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 2, pt, v );</span></a>
<a name="11354"><span class="lineNum">   11354 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 4 ) );</span></a>
<a name="11355"><span class="lineNum">   11355 </span>                :            : </a>
<a name="11356"><span class="lineNum">   11356 </span>                :            :   //dropMValue</a>
<a name="11357"><span class="lineNum">   11357 </span>                :<span class="lineCov">          1 :   c28d.clear();</span></a>
<a name="11358"><span class="lineNum">   11358 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropMValue() );</span></a>
<a name="11359"><span class="lineNum">   11359 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11360"><span class="lineNum">   11360 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11361"><span class="lineNum">   11361 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="11362"><span class="lineNum">   11362 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11363"><span class="lineNum">   11363 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropMValue() );</span></a>
<a name="11364"><span class="lineNum">   11364 </span>                :<span class="lineCov">          1 :   c28d.addMValue( 1.0 );</span></a>
<a name="11365"><span class="lineNum">   11365 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="11366"><span class="lineNum">   11366 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.isMeasure() );</span></a>
<a name="11367"><span class="lineNum">   11367 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.dropMValue() );</span></a>
<a name="11368"><span class="lineNum">   11368 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.isMeasure() );</span></a>
<a name="11369"><span class="lineNum">   11369 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11370"><span class="lineNum">   11370 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11371"><span class="lineNum">   11371 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="11372"><span class="lineNum">   11372 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 1, pt, v );</span></a>
<a name="11373"><span class="lineNum">   11373 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 11, 12 ) );</span></a>
<a name="11374"><span class="lineNum">   11374 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 2, pt, v );</span></a>
<a name="11375"><span class="lineNum">   11375 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 21, 22 ) );</span></a>
<a name="11376"><span class="lineNum">   11376 </span>                :            : </a>
<a name="11377"><span class="lineNum">   11377 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.dropMValue() ); //already dropped</span></a>
<a name="11378"><span class="lineNum">   11378 </span>                :            :   //linestring with z</a>
<a name="11379"><span class="lineNum">   11379 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) );</span></a>
<a name="11380"><span class="lineNum">   11380 </span>                :<span class="lineCov">          1 :   c28d.clear();</span></a>
<a name="11381"><span class="lineNum">   11381 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11382"><span class="lineNum">   11382 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt;  QgsPoint( QgsWkbTypes::PointZM, 11, 12, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 3, 4 ) );</span></a>
<a name="11383"><span class="lineNum">   11383 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11384"><span class="lineNum">   11384 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.dropMValue() );</span></a>
<a name="11385"><span class="lineNum">   11385 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.isMeasure() );</span></a>
<a name="11386"><span class="lineNum">   11386 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.is3D() );</span></a>
<a name="11387"><span class="lineNum">   11387 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="11388"><span class="lineNum">   11388 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11389"><span class="lineNum">   11389 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="11390"><span class="lineNum">   11390 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 1, pt, v );</span></a>
<a name="11391"><span class="lineNum">   11391 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 3 ) );</span></a>
<a name="11392"><span class="lineNum">   11392 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 2, pt, v );</span></a>
<a name="11393"><span class="lineNum">   11393 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 21, 22, 3 ) );</span></a>
<a name="11394"><span class="lineNum">   11394 </span>                :            : </a>
<a name="11395"><span class="lineNum">   11395 </span>                :            :   //convertTo</a>
<a name="11396"><span class="lineNum">   11396 </span>                :<span class="lineCov">          1 :   l28d.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11397"><span class="lineNum">   11397 </span>                :<span class="lineCov">          1 :   c28d.clear();</span></a>
<a name="11398"><span class="lineNum">   11398 </span>                :<span class="lineCov">          1 :   c28d.addCurve( l28d.clone() );</span></a>
<a name="11399"><span class="lineNum">   11399 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.convertTo( QgsWkbTypes::CompoundCurve ) );</span></a>
<a name="11400"><span class="lineNum">   11400 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11401"><span class="lineNum">   11401 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.convertTo( QgsWkbTypes::CompoundCurveZ ) );</span></a>
<a name="11402"><span class="lineNum">   11402 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="11403"><span class="lineNum">   11403 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11404"><span class="lineNum">   11404 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 1, 2 ) );</span></a>
<a name="11405"><span class="lineNum">   11405 </span>                :            : </a>
<a name="11406"><span class="lineNum">   11406 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.convertTo( QgsWkbTypes::CompoundCurveZM ) );</span></a>
<a name="11407"><span class="lineNum">   11407 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="11408"><span class="lineNum">   11408 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11409"><span class="lineNum">   11409 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2 ) );</span></a>
<a name="11410"><span class="lineNum">   11410 </span>                :<span class="lineCov">          1 :   c28d.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 1, 2, 5 ) );</span></a>
<a name="11411"><span class="lineNum">   11411 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11412"><span class="lineNum">   11412 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 5.0 ) );</span></a>
<a name="11413"><span class="lineNum">   11413 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.convertTo( QgsWkbTypes::CompoundCurveM ) );</span></a>
<a name="11414"><span class="lineNum">   11414 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="11415"><span class="lineNum">   11415 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11416"><span class="lineNum">   11416 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 1, 2 ) );</span></a>
<a name="11417"><span class="lineNum">   11417 </span>                :<span class="lineCov">          1 :   c28d.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 1, 2, 0, 6 ) );</span></a>
<a name="11418"><span class="lineNum">   11418 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11419"><span class="lineNum">   11419 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0.0, 6.0 ) );</span></a>
<a name="11420"><span class="lineNum">   11420 </span>                :<span class="lineCov">          1 :   QVERIFY( c28d.convertTo( QgsWkbTypes::CompoundCurve ) );</span></a>
<a name="11421"><span class="lineNum">   11421 </span>                :<span class="lineCov">          1 :   QCOMPARE( c28d.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11422"><span class="lineNum">   11422 </span>                :<span class="lineCov">          1 :   c28d.pointAt( 0, pt, v );</span></a>
<a name="11423"><span class="lineNum">   11423 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="11424"><span class="lineNum">   11424 </span>                :<span class="lineCov">          1 :   QVERIFY( !c28d.convertTo( QgsWkbTypes::Polygon ) );</span></a>
<a name="11425"><span class="lineNum">   11425 </span>                :            : </a>
<a name="11426"><span class="lineNum">   11426 </span>                :            :   //isRing</a>
<a name="11427"><span class="lineNum">   11427 </span>                :<span class="lineCov">          1 :   QgsCircularString l30;</span></a>
<a name="11428"><span class="lineNum">   11428 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c30;</span></a>
<a name="11429"><span class="lineNum">   11429 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.isRing() );</span></a>
<a name="11430"><span class="lineNum">   11430 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="11431"><span class="lineNum">   11431 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11432"><span class="lineNum">   11432 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.isRing() ); //&lt;4 points</span></a>
<a name="11433"><span class="lineNum">   11433 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 31, 32 ) );</span></a>
<a name="11434"><span class="lineNum">   11434 </span>                :<span class="lineCov">          1 :   c30.clear();</span></a>
<a name="11435"><span class="lineNum">   11435 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11436"><span class="lineNum">   11436 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.isRing() ); //not closed</span></a>
<a name="11437"><span class="lineNum">   11437 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="11438"><span class="lineNum">   11438 </span>                :<span class="lineCov">          1 :   c30.clear();</span></a>
<a name="11439"><span class="lineNum">   11439 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11440"><span class="lineNum">   11440 </span>                :<span class="lineCov">          1 :   QVERIFY( c30.isRing() );</span></a>
<a name="11441"><span class="lineNum">   11441 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11442"><span class="lineNum">   11442 </span>                :<span class="lineCov">          1 :   c30.clear();</span></a>
<a name="11443"><span class="lineNum">   11443 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11444"><span class="lineNum">   11444 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.isRing() );</span></a>
<a name="11445"><span class="lineNum">   11445 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 )  &lt;&lt; QgsPoint( 21, 22 ) );</span></a>
<a name="11446"><span class="lineNum">   11446 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11447"><span class="lineNum">   11447 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.isRing() );</span></a>
<a name="11448"><span class="lineNum">   11448 </span>                :<span class="lineCov">          1 :   l30.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 21, 22 )  &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="11449"><span class="lineNum">   11449 </span>                :<span class="lineCov">          1 :   c30.addCurve( l30.clone() );</span></a>
<a name="11450"><span class="lineNum">   11450 </span>                :<span class="lineCov">          1 :   QVERIFY( c30.isRing() );</span></a>
<a name="11451"><span class="lineNum">   11451 </span>                :            : </a>
<a name="11452"><span class="lineNum">   11452 </span>                :            :   //coordinateSequence</a>
<a name="11453"><span class="lineNum">   11453 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c31;</span></a>
<a name="11454"><span class="lineNum">   11454 </span>                :<span class="lineCov">          1 :   QgsCircularString l31;</span></a>
<a name="11455"><span class="lineNum">   11455 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence coords = c31.coordinateSequence();</span></a>
<a name="11456"><span class="lineNum">   11456 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="11457"><span class="lineNum">   11457 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="11458"><span class="lineNum">   11458 </span>                :<span class="lineCov">          1 :   QVERIFY( coords.at( 0 ).at( 0 ).isEmpty() );</span></a>
<a name="11459"><span class="lineNum">   11459 </span>                :<span class="lineCov">          2 :   l31.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 )</span></a>
<a name="11460"><span class="lineNum">   11460 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 )</span></a>
<a name="11461"><span class="lineNum">   11461 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="11462"><span class="lineNum">   11462 </span>                :<span class="lineCov">          1 :   c31.addCurve( l31.clone() );</span></a>
<a name="11463"><span class="lineNum">   11463 </span>                :<span class="lineCov">          1 :   QgsLineString ls31;</span></a>
<a name="11464"><span class="lineNum">   11464 </span>                :<span class="lineCov">          2 :   ls31.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) &lt;&lt;</span></a>
<a name="11465"><span class="lineNum">   11465 </span>                :<span class="lineCov">          1 :                   QgsPoint( QgsWkbTypes::PointZM, 31, 32, 16, 17 ) );</span></a>
<a name="11466"><span class="lineNum">   11466 </span>                :<span class="lineCov">          1 :   c31.addCurve( ls31.clone() );</span></a>
<a name="11467"><span class="lineNum">   11467 </span>                :<span class="lineCov">          1 :   coords = c31.coordinateSequence();</span></a>
<a name="11468"><span class="lineNum">   11468 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.count(), 1 );</span></a>
<a name="11469"><span class="lineNum">   11469 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).count(), 1 );</span></a>
<a name="11470"><span class="lineNum">   11470 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).count(), 4 );</span></a>
<a name="11471"><span class="lineNum">   11471 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 0 ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 2, 3 ) );</span></a>
<a name="11472"><span class="lineNum">   11472 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 1 ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 4, 5 ) );</span></a>
<a name="11473"><span class="lineNum">   11473 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 2 ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 6, 7 ) );</span></a>
<a name="11474"><span class="lineNum">   11474 </span>                :<span class="lineCov">          1 :   QCOMPARE( coords.at( 0 ).at( 0 ).at( 3 ), QgsPoint( QgsWkbTypes::PointZM, 31, 32, 16, 17 ) );</span></a>
<a name="11475"><span class="lineNum">   11475 </span>                :            : </a>
<a name="11476"><span class="lineNum">   11476 </span>                :            :   //nextVertex</a>
<a name="11477"><span class="lineNum">   11477 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c32;</span></a>
<a name="11478"><span class="lineNum">   11478 </span>                :<span class="lineCov">          1 :   QgsCircularString l32;</span></a>
<a name="11479"><span class="lineNum">   11479 </span>                :<span class="lineCov">          1 :   QgsVertexId vId;</span></a>
<a name="11480"><span class="lineNum">   11480 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11481"><span class="lineNum">   11481 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -2 );</span></a>
<a name="11482"><span class="lineNum">   11482 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11483"><span class="lineNum">   11483 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, 10 );</span></a>
<a name="11484"><span class="lineNum">   11484 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11485"><span class="lineNum">   11485 </span>                :            :   //CircularString</a>
<a name="11486"><span class="lineNum">   11486 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="11487"><span class="lineNum">   11487 </span>                :<span class="lineCov">          1 :   c32.addCurve( l32.clone() );</span></a>
<a name="11488"><span class="lineNum">   11488 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, 2 ); //out of range</span></a>
<a name="11489"><span class="lineNum">   11489 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11490"><span class="lineNum">   11490 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -5 );</span></a>
<a name="11491"><span class="lineNum">   11491 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11492"><span class="lineNum">   11492 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -1 );</span></a>
<a name="11493"><span class="lineNum">   11493 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11494"><span class="lineNum">   11494 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="11495"><span class="lineNum">   11495 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="11496"><span class="lineNum">   11496 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11497"><span class="lineNum">   11497 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11498"><span class="lineNum">   11498 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="11499"><span class="lineNum">   11499 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11500"><span class="lineNum">   11500 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 1, 0 );</span></a>
<a name="11501"><span class="lineNum">   11501 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11502"><span class="lineNum">   11502 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 1, 1 ) ); //test that ring number is maintained</span></a>
<a name="11503"><span class="lineNum">   11503 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="11504"><span class="lineNum">   11504 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 1, 0, 0 );</span></a>
<a name="11505"><span class="lineNum">   11505 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11506"><span class="lineNum">   11506 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 1, 0, 1 ) ); //test that part number is maintained</span></a>
<a name="11507"><span class="lineNum">   11507 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="11508"><span class="lineNum">   11508 </span>                :<span class="lineCov">          1 :   QgsLineString ls32;</span></a>
<a name="11509"><span class="lineNum">   11509 </span>                :<span class="lineCov">          1 :   ls32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 13, 14 ) );</span></a>
<a name="11510"><span class="lineNum">   11510 </span>                :<span class="lineCov">          1 :   c32.addCurve( ls32.clone() );</span></a>
<a name="11511"><span class="lineNum">   11511 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, 1 );</span></a>
<a name="11512"><span class="lineNum">   11512 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11513"><span class="lineNum">   11513 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="11514"><span class="lineNum">   11514 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 13, 14 ) );</span></a>
<a name="11515"><span class="lineNum">   11515 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11516"><span class="lineNum">   11516 </span>                :            : </a>
<a name="11517"><span class="lineNum">   11517 </span>                :            :   //CircularStringZ</a>
<a name="11518"><span class="lineNum">   11518 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="11519"><span class="lineNum">   11519 </span>                :<span class="lineCov">          1 :   c32.clear();</span></a>
<a name="11520"><span class="lineNum">   11520 </span>                :<span class="lineCov">          1 :   c32.addCurve( l32.clone() );</span></a>
<a name="11521"><span class="lineNum">   11521 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -1 );</span></a>
<a name="11522"><span class="lineNum">   11522 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11523"><span class="lineNum">   11523 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="11524"><span class="lineNum">   11524 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="11525"><span class="lineNum">   11525 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11526"><span class="lineNum">   11526 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11527"><span class="lineNum">   11527 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="11528"><span class="lineNum">   11528 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11529"><span class="lineNum">   11529 </span>                :            :   //CircularStringM</a>
<a name="11530"><span class="lineNum">   11530 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="11531"><span class="lineNum">   11531 </span>                :<span class="lineCov">          1 :   c32.clear();</span></a>
<a name="11532"><span class="lineNum">   11532 </span>                :<span class="lineCov">          1 :   c32.addCurve( l32.clone() );</span></a>
<a name="11533"><span class="lineNum">   11533 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -1 );</span></a>
<a name="11534"><span class="lineNum">   11534 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11535"><span class="lineNum">   11535 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="11536"><span class="lineNum">   11536 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="11537"><span class="lineNum">   11537 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11538"><span class="lineNum">   11538 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11539"><span class="lineNum">   11539 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="11540"><span class="lineNum">   11540 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11541"><span class="lineNum">   11541 </span>                :            :   //CircularStringZM</a>
<a name="11542"><span class="lineNum">   11542 </span>                :<span class="lineCov">          1 :   l32.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="11543"><span class="lineNum">   11543 </span>                :<span class="lineCov">          1 :   c32.clear();</span></a>
<a name="11544"><span class="lineNum">   11544 </span>                :<span class="lineCov">          1 :   c32.addCurve( l32.clone() );</span></a>
<a name="11545"><span class="lineNum">   11545 </span>                :<span class="lineCov">          1 :   vId = QgsVertexId( 0, 0, -1 );</span></a>
<a name="11546"><span class="lineNum">   11546 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11547"><span class="lineNum">   11547 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="11548"><span class="lineNum">   11548 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="11549"><span class="lineNum">   11549 </span>                :<span class="lineCov">          1 :   QVERIFY( c32.nextVertex( vId, p ) );</span></a>
<a name="11550"><span class="lineNum">   11550 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11551"><span class="lineNum">   11551 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="11552"><span class="lineNum">   11552 </span>                :<span class="lineCov">          1 :   QVERIFY( !c32.nextVertex( vId, p ) );</span></a>
<a name="11553"><span class="lineNum">   11553 </span>                :            : </a>
<a name="11554"><span class="lineNum">   11554 </span>                :            :   //vertexAt and pointAt</a>
<a name="11555"><span class="lineNum">   11555 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c33;</span></a>
<a name="11556"><span class="lineNum">   11556 </span>                :<span class="lineCov">          1 :   QgsCircularString l33;</span></a>
<a name="11557"><span class="lineNum">   11557 </span>                :<span class="lineCov">          1 :   c33.vertexAt( QgsVertexId( 0, 0, -10 ) ); //out of bounds, check for no crash</span></a>
<a name="11558"><span class="lineNum">   11558 </span>                :<span class="lineCov">          1 :   c33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="11559"><span class="lineNum">   11559 </span>                :<span class="lineCov">          1 :   QVERIFY( !c33.pointAt( -10, p, type ) );</span></a>
<a name="11560"><span class="lineNum">   11560 </span>                :<span class="lineCov">          1 :   QVERIFY( !c33.pointAt( 10, p, type ) );</span></a>
<a name="11561"><span class="lineNum">   11561 </span>                :            :   //CircularString</a>
<a name="11562"><span class="lineNum">   11562 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="11563"><span class="lineNum">   11563 </span>                :<span class="lineCov">          1 :   c33.addCurve( l33.clone() );</span></a>
<a name="11564"><span class="lineNum">   11564 </span>                :<span class="lineCov">          1 :   c33.vertexAt( QgsVertexId( 0, 0, -10 ) );</span></a>
<a name="11565"><span class="lineNum">   11565 </span>                :<span class="lineCov">          1 :   c33.vertexAt( QgsVertexId( 0, 0, 10 ) ); //out of bounds, check for no crash</span></a>
<a name="11566"><span class="lineNum">   11566 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="11567"><span class="lineNum">   11567 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="11568"><span class="lineNum">   11568 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 1, 22 ) );</span></a>
<a name="11569"><span class="lineNum">   11569 </span>                :<span class="lineCov">          1 :   QVERIFY( !c33.pointAt( -10, p, type ) );</span></a>
<a name="11570"><span class="lineNum">   11570 </span>                :<span class="lineCov">          1 :   QVERIFY( !c33.pointAt( 10, p, type ) );</span></a>
<a name="11571"><span class="lineNum">   11571 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 0, p, type ) );</span></a>
<a name="11572"><span class="lineNum">   11572 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 2 ) );</span></a>
<a name="11573"><span class="lineNum">   11573 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11574"><span class="lineNum">   11574 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 1, p, type ) );</span></a>
<a name="11575"><span class="lineNum">   11575 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 11, 12 ) );</span></a>
<a name="11576"><span class="lineNum">   11576 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="11577"><span class="lineNum">   11577 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 2, p, type ) );</span></a>
<a name="11578"><span class="lineNum">   11578 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 22 ) );</span></a>
<a name="11579"><span class="lineNum">   11579 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11580"><span class="lineNum">   11580 </span>                :<span class="lineCov">          1 :   QgsLineString ls33;</span></a>
<a name="11581"><span class="lineNum">   11581 </span>                :<span class="lineCov">          1 :   ls33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( 3, 34 ) );</span></a>
<a name="11582"><span class="lineNum">   11582 </span>                :<span class="lineCov">          1 :   c33.addCurve( ls33.clone() );</span></a>
<a name="11583"><span class="lineNum">   11583 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 3, p, type ) );</span></a>
<a name="11584"><span class="lineNum">   11584 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 3, 34 ) );</span></a>
<a name="11585"><span class="lineNum">   11585 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11586"><span class="lineNum">   11586 </span>                :            : </a>
<a name="11587"><span class="lineNum">   11587 </span>                :<span class="lineCov">          1 :   c33.clear();</span></a>
<a name="11588"><span class="lineNum">   11588 </span>                :            :   //CircularStringZ</a>
<a name="11589"><span class="lineNum">   11589 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 22, 23 ) );</span></a>
<a name="11590"><span class="lineNum">   11590 </span>                :<span class="lineCov">          1 :   c33.addCurve( l33.clone() );</span></a>
<a name="11591"><span class="lineNum">   11591 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="11592"><span class="lineNum">   11592 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="11593"><span class="lineNum">   11593 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 22, 23 ) );</span></a>
<a name="11594"><span class="lineNum">   11594 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 0, p, type ) );</span></a>
<a name="11595"><span class="lineNum">   11595 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="11596"><span class="lineNum">   11596 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11597"><span class="lineNum">   11597 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 1, p, type ) );</span></a>
<a name="11598"><span class="lineNum">   11598 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="11599"><span class="lineNum">   11599 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="11600"><span class="lineNum">   11600 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 2, p, type ) );</span></a>
<a name="11601"><span class="lineNum">   11601 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 1, 22, 23 ) );</span></a>
<a name="11602"><span class="lineNum">   11602 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11603"><span class="lineNum">   11603 </span>                :            : </a>
<a name="11604"><span class="lineNum">   11604 </span>                :            :   //CircularStringM</a>
<a name="11605"><span class="lineNum">   11605 </span>                :<span class="lineCov">          1 :   c33.clear();</span></a>
<a name="11606"><span class="lineNum">   11606 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="11607"><span class="lineNum">   11607 </span>                :<span class="lineCov">          1 :   c33.addCurve( l33.clone() );</span></a>
<a name="11608"><span class="lineNum">   11608 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="11609"><span class="lineNum">   11609 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="11610"><span class="lineNum">   11610 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="11611"><span class="lineNum">   11611 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 0, p, type ) );</span></a>
<a name="11612"><span class="lineNum">   11612 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="11613"><span class="lineNum">   11613 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11614"><span class="lineNum">   11614 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 1, p, type ) );</span></a>
<a name="11615"><span class="lineNum">   11615 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 14 ) );</span></a>
<a name="11616"><span class="lineNum">   11616 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="11617"><span class="lineNum">   11617 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 2, p, type ) );</span></a>
<a name="11618"><span class="lineNum">   11618 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointM, 1, 22, 0, 24 ) );</span></a>
<a name="11619"><span class="lineNum">   11619 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11620"><span class="lineNum">   11620 </span>                :            :   //CircularStringZM</a>
<a name="11621"><span class="lineNum">   11621 </span>                :<span class="lineCov">          1 :   l33.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="11622"><span class="lineNum">   11622 </span>                :<span class="lineCov">          1 :   c33.clear();</span></a>
<a name="11623"><span class="lineNum">   11623 </span>                :<span class="lineCov">          1 :   c33.addCurve( l33.clone() );</span></a>
<a name="11624"><span class="lineNum">   11624 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="11625"><span class="lineNum">   11625 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="11626"><span class="lineNum">   11626 </span>                :<span class="lineCov">          1 :   QCOMPARE( c33.vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="11627"><span class="lineNum">   11627 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 0, p, type ) );</span></a>
<a name="11628"><span class="lineNum">   11628 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="11629"><span class="lineNum">   11629 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11630"><span class="lineNum">   11630 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 1, p, type ) );</span></a>
<a name="11631"><span class="lineNum">   11631 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 ) );</span></a>
<a name="11632"><span class="lineNum">   11632 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::CurveVertex );</span></a>
<a name="11633"><span class="lineNum">   11633 </span>                :<span class="lineCov">          1 :   QVERIFY( c33.pointAt( 2, p, type ) );</span></a>
<a name="11634"><span class="lineNum">   11634 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( QgsWkbTypes::PointZM, 1, 22, 23, 24 ) );</span></a>
<a name="11635"><span class="lineNum">   11635 </span>                :<span class="lineCov">          1 :   QCOMPARE( type, QgsVertexId::SegmentVertex );</span></a>
<a name="11636"><span class="lineNum">   11636 </span>                :            : </a>
<a name="11637"><span class="lineNum">   11637 </span>                :            :   //centroid</a>
<a name="11638"><span class="lineNum">   11638 </span>                :<span class="lineCov">          1 :   QgsCircularString l34;</span></a>
<a name="11639"><span class="lineNum">   11639 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c34;</span></a>
<a name="11640"><span class="lineNum">   11640 </span>                :<span class="lineCov">          1 :   QCOMPARE( c34.centroid(), QgsPoint( 0, 0 ) );</span></a>
<a name="11641"><span class="lineNum">   11641 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="11642"><span class="lineNum">   11642 </span>                :<span class="lineCov">          1 :   c34.addCurve( l34.clone() );</span></a>
<a name="11643"><span class="lineNum">   11643 </span>                :<span class="lineCov">          1 :   QCOMPARE( c34.centroid(), QgsPoint( 5, 10 ) );</span></a>
<a name="11644"><span class="lineNum">   11644 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 20, 10 ) &lt;&lt; QgsPoint( 2, 9 ) );</span></a>
<a name="11645"><span class="lineNum">   11645 </span>                :<span class="lineCov">          1 :   c34.clear();</span></a>
<a name="11646"><span class="lineNum">   11646 </span>                :<span class="lineCov">          1 :   c34.addCurve( l34.clone() );</span></a>
<a name="11647"><span class="lineNum">   11647 </span>                :<span class="lineCov">          1 :   QgsPoint centroid = c34.centroid();</span></a>
<a name="11648"><span class="lineNum">   11648 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.x(), 7.333, 0.001 );</span></a>
<a name="11649"><span class="lineNum">   11649 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.y(), 6.333, 0.001 );</span></a>
<a name="11650"><span class="lineNum">   11650 </span>                :<span class="lineCov">          1 :   l34.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 9 ) &lt;&lt; QgsPoint( 12, 9 ) &lt;&lt; QgsPoint( 15, 19 ) );</span></a>
<a name="11651"><span class="lineNum">   11651 </span>                :<span class="lineCov">          1 :   c34.addCurve( l34.clone() );</span></a>
<a name="11652"><span class="lineNum">   11652 </span>                :<span class="lineCov">          1 :   centroid = c34.centroid();</span></a>
<a name="11653"><span class="lineNum">   11653 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.x(), 9.756646, 0.001 );</span></a>
<a name="11654"><span class="lineNum">   11654 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( centroid.y(), 8.229039, 0.001 );</span></a>
<a name="11655"><span class="lineNum">   11655 </span>                :            : </a>
<a name="11656"><span class="lineNum">   11656 </span>                :            :   //closest segment</a>
<a name="11657"><span class="lineNum">   11657 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c35;</span></a>
<a name="11658"><span class="lineNum">   11658 </span>                :<span class="lineCov">          1 :   QgsCircularString l35;</span></a>
<a name="11659"><span class="lineNum">   11659 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="11660"><span class="lineNum">   11660 </span>                :<span class="lineCov">          1 :   p = QgsPoint( 0, 0 ); // reset all coords to zero</span></a>
<a name="11661"><span class="lineNum">   11661 </span>                :<span class="lineCov">          1 :   ( void )c35.closestSegment( QgsPoint( 1, 2 ), p, vId ); //empty line, just want no crash</span></a>
<a name="11662"><span class="lineNum">   11662 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="11663"><span class="lineNum">   11663 </span>                :<span class="lineCov">          1 :   c35.addCurve( l35.clone() );</span></a>
<a name="11664"><span class="lineNum">   11664 </span>                :<span class="lineCov">          1 :   QVERIFY( c35.closestSegment( QgsPoint( 5, 10 ), p, vId ) &lt; 0 );</span></a>
<a name="11665"><span class="lineNum">   11665 </span>                :<span class="lineCov">          1 :   l35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 15 ) );</span></a>
<a name="11666"><span class="lineNum">   11666 </span>                :<span class="lineCov">          1 :   c35.clear();</span></a>
<a name="11667"><span class="lineNum">   11667 </span>                :<span class="lineCov">          1 :   c35.addCurve( l35.clone() );</span></a>
<a name="11668"><span class="lineNum">   11668 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 4, 11 ), p, vId, &amp;leftOf ), 2.0, 0.0001 );</span></a>
<a name="11669"><span class="lineNum">   11669 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 10 ) );</span></a>
<a name="11670"><span class="lineNum">   11670 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11671"><span class="lineNum">   11671 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="11672"><span class="lineNum">   11672 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 8, 11 ), p, vId, &amp;leftOf ),  1.583512, 0.0001 );</span></a>
<a name="11673"><span class="lineNum">   11673 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.84, 0.01 );</span></a>
<a name="11674"><span class="lineNum">   11674 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 11.49, 0.01 );</span></a>
<a name="11675"><span class="lineNum">   11675 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11676"><span class="lineNum">   11676 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="11677"><span class="lineNum">   11677 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 5.5, 11.5 ), p, vId, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="11678"><span class="lineNum">   11678 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="11679"><span class="lineNum">   11679 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 10.7, 0.01 );</span></a>
<a name="11680"><span class="lineNum">   11680 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11681"><span class="lineNum">   11681 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="11682"><span class="lineNum">   11682 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 7, 16 ), p, vId, &amp;leftOf ), 3.068288, 0.0001 );</span></a>
<a name="11683"><span class="lineNum">   11683 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.981872, 0.01 );</span></a>
<a name="11684"><span class="lineNum">   11684 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.574621, 0.01 );</span></a>
<a name="11685"><span class="lineNum">   11685 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="11686"><span class="lineNum">   11686 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="11687"><span class="lineNum">   11687 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 5.5, 13.5 ), p, vId, &amp;leftOf ), 1.288897, 0.0001 );</span></a>
<a name="11688"><span class="lineNum">   11688 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 6.302776, 0.01 );</span></a>
<a name="11689"><span class="lineNum">   11689 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 14.3, 0.01 );</span></a>
<a name="11690"><span class="lineNum">   11690 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="11691"><span class="lineNum">   11691 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="11692"><span class="lineNum">   11692 </span>                :            :   // point directly on segment</a>
<a name="11693"><span class="lineNum">   11693 </span>                :<span class="lineCov">          1 :   QCOMPARE( c35.closestSegment( QgsPoint( 5, 15 ), p, vId, &amp;leftOf ), 0.0 );</span></a>
<a name="11694"><span class="lineNum">   11694 </span>                :<span class="lineCov">          1 :   QCOMPARE( p, QgsPoint( 5, 15 ) );</span></a>
<a name="11695"><span class="lineNum">   11695 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="11696"><span class="lineNum">   11696 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="11697"><span class="lineNum">   11697 </span>                :            : </a>
<a name="11698"><span class="lineNum">   11698 </span>                :<span class="lineCov">          1 :   QgsLineString ls35;</span></a>
<a name="11699"><span class="lineNum">   11699 </span>                :<span class="lineCov">          1 :   ls35.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 5, 20 ) );</span></a>
<a name="11700"><span class="lineNum">   11700 </span>                :<span class="lineCov">          1 :   c35.addCurve( ls35.clone() );</span></a>
<a name="11701"><span class="lineNum">   11701 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 5.5, 16.5 ), p, vId, &amp;leftOf ), 0.25, 0.0001 );</span></a>
<a name="11702"><span class="lineNum">   11702 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.0, 0.01 );</span></a>
<a name="11703"><span class="lineNum">   11703 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 16.5, 0.01 );</span></a>
<a name="11704"><span class="lineNum">   11704 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="11705"><span class="lineNum">   11705 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="11706"><span class="lineNum">   11706 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 4.5, 16.5 ), p, vId, &amp;leftOf ), 0.25, 0.0001 );</span></a>
<a name="11707"><span class="lineNum">   11707 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.0, 0.01 );</span></a>
<a name="11708"><span class="lineNum">   11708 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 16.5, 0.01 );</span></a>
<a name="11709"><span class="lineNum">   11709 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="11710"><span class="lineNum">   11710 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="11711"><span class="lineNum">   11711 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 4.5, 21.5 ), p, vId, &amp;leftOf ), 2.500000, 0.0001 );</span></a>
<a name="11712"><span class="lineNum">   11712 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.0, 0.01 );</span></a>
<a name="11713"><span class="lineNum">   11713 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 20.0, 0.01 );</span></a>
<a name="11714"><span class="lineNum">   11714 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="11715"><span class="lineNum">   11715 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="11716"><span class="lineNum">   11716 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 5.5, 21.5 ), p, vId, &amp;leftOf ), 2.500000, 0.0001 );</span></a>
<a name="11717"><span class="lineNum">   11717 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.0, 0.01 );</span></a>
<a name="11718"><span class="lineNum">   11718 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 20.0, 0.01 );</span></a>
<a name="11719"><span class="lineNum">   11719 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="11720"><span class="lineNum">   11720 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="11721"><span class="lineNum">   11721 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c35.closestSegment( QgsPoint( 5, 20 ), p, vId, &amp;leftOf ), 0.0000, 0.0001 );</span></a>
<a name="11722"><span class="lineNum">   11722 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.x(), 5.0, 0.01 );</span></a>
<a name="11723"><span class="lineNum">   11723 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p.y(), 20.0, 0.01 );</span></a>
<a name="11724"><span class="lineNum">   11724 </span>                :<span class="lineCov">          1 :   QCOMPARE( vId, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="11725"><span class="lineNum">   11725 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="11726"><span class="lineNum">   11726 </span>                :            : </a>
<a name="11727"><span class="lineNum">   11727 </span>                :            :   //sumUpArea</a>
<a name="11728"><span class="lineNum">   11728 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c36;</span></a>
<a name="11729"><span class="lineNum">   11729 </span>                :<span class="lineCov">          1 :   QgsCircularString l36;</span></a>
<a name="11730"><span class="lineNum">   11730 </span>                :<span class="lineCov">          1 :   double area = 1.0; //sumUpArea adds to area, so start with non-zero value</span></a>
<a name="11731"><span class="lineNum">   11731 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11732"><span class="lineNum">   11732 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="11733"><span class="lineNum">   11733 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="11734"><span class="lineNum">   11734 </span>                :<span class="lineCov">          1 :   c36.addCurve( l36.clone() );</span></a>
<a name="11735"><span class="lineNum">   11735 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11736"><span class="lineNum">   11736 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="11737"><span class="lineNum">   11737 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="11738"><span class="lineNum">   11738 </span>                :<span class="lineCov">          1 :   c36.clear();</span></a>
<a name="11739"><span class="lineNum">   11739 </span>                :<span class="lineCov">          1 :   c36.addCurve( l36.clone() );</span></a>
<a name="11740"><span class="lineNum">   11740 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11741"><span class="lineNum">   11741 </span>                :<span class="lineCov">          1 :   QCOMPARE( area, 1.0 );</span></a>
<a name="11742"><span class="lineNum">   11742 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) );</span></a>
<a name="11743"><span class="lineNum">   11743 </span>                :<span class="lineCov">          1 :   c36.clear();</span></a>
<a name="11744"><span class="lineNum">   11744 </span>                :<span class="lineCov">          1 :   c36.addCurve( l36.clone() );</span></a>
<a name="11745"><span class="lineNum">   11745 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11746"><span class="lineNum">   11746 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 4.141593, 0.0001 );</span></a>
<a name="11747"><span class="lineNum">   11747 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2, 0 ) &lt;&lt; QgsPoint( 2, 2 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="11748"><span class="lineNum">   11748 </span>                :<span class="lineCov">          1 :   c36.clear();</span></a>
<a name="11749"><span class="lineNum">   11749 </span>                :<span class="lineCov">          1 :   c36.addCurve( l36.clone() );</span></a>
<a name="11750"><span class="lineNum">   11750 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11751"><span class="lineNum">   11751 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 7.283185, 0.0001 );</span></a>
<a name="11752"><span class="lineNum">   11752 </span>                :            :   // full circle</a>
<a name="11753"><span class="lineNum">   11753 </span>                :<span class="lineCov">          1 :   l36.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 4, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11754"><span class="lineNum">   11754 </span>                :<span class="lineCov">          1 :   c36.clear();</span></a>
<a name="11755"><span class="lineNum">   11755 </span>                :<span class="lineCov">          1 :   c36.addCurve( l36.clone() );</span></a>
<a name="11756"><span class="lineNum">   11756 </span>                :<span class="lineCov">          1 :   area = 0.0;</span></a>
<a name="11757"><span class="lineNum">   11757 </span>                :<span class="lineCov">          1 :   c36.sumUpArea( area );</span></a>
<a name="11758"><span class="lineNum">   11758 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( area, 12.566370614359172, 0.0001 );</span></a>
<a name="11759"><span class="lineNum">   11759 </span>                :            : </a>
<a name="11760"><span class="lineNum">   11760 </span>                :            :   //boundingBox - test that bounding box is updated after every modification to the circular string</a>
<a name="11761"><span class="lineNum">   11761 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c37;</span></a>
<a name="11762"><span class="lineNum">   11762 </span>                :<span class="lineCov">          1 :   QgsCircularString l37;</span></a>
<a name="11763"><span class="lineNum">   11763 </span>                :<span class="lineCov">          1 :   QVERIFY( c37.boundingBox().isNull() );</span></a>
<a name="11764"><span class="lineNum">   11764 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="11765"><span class="lineNum">   11765 </span>                :<span class="lineCov">          1 :   c37.addCurve( l37.clone() );</span></a>
<a name="11766"><span class="lineNum">   11766 </span>                :<span class="lineCov">          1 :   QCOMPARE( c37.boundingBox(), QgsRectangle( 5, 10, 10, 15 ) );</span></a>
<a name="11767"><span class="lineNum">   11767 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( -5, -10 ) &lt;&lt; QgsPoint( -6, -10 ) &lt;&lt; QgsPoint( -5.5, -9 ) );</span></a>
<a name="11768"><span class="lineNum">   11768 </span>                :<span class="lineCov">          1 :   c37.clear();</span></a>
<a name="11769"><span class="lineNum">   11769 </span>                :<span class="lineCov">          1 :   c37.addCurve( l37.clone() );</span></a>
<a name="11770"><span class="lineNum">   11770 </span>                :<span class="lineCov">          1 :   QCOMPARE( c37.boundingBox(), QgsRectangle( -6.125, -10.25, -5, -9 ) );</span></a>
<a name="11771"><span class="lineNum">   11771 </span>                :<span class="lineCov">          1 :   QByteArray wkbToAppend = c37.asWkb();</span></a>
<a name="11772"><span class="lineNum">   11772 </span>                :<span class="lineCov">          1 :   c37.clear();</span></a>
<a name="11773"><span class="lineNum">   11773 </span>                :<span class="lineCov">          1 :   QVERIFY( c37.boundingBox().isNull() );</span></a>
<a name="11774"><span class="lineNum">   11774 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbToAppendPtr( wkbToAppend );</span></a>
<a name="11775"><span class="lineNum">   11775 </span>                :<span class="lineCov">          1 :   l37.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 10, 15 ) );</span></a>
<a name="11776"><span class="lineNum">   11776 </span>                :<span class="lineCov">          1 :   c37.clear();</span></a>
<a name="11777"><span class="lineNum">   11777 </span>                :<span class="lineCov">          1 :   c37.addCurve( l37.clone() );</span></a>
<a name="11778"><span class="lineNum">   11778 </span>                :<span class="lineCov">          1 :   QCOMPARE( c37.boundingBox(), QgsRectangle( 5, 10, 10, 15 ) );</span></a>
<a name="11779"><span class="lineNum">   11779 </span>                :<span class="lineCov">          1 :   c37.fromWkb( wkbToAppendPtr );</span></a>
<a name="11780"><span class="lineNum">   11780 </span>                :<span class="lineCov">          1 :   QCOMPARE( c37.boundingBox(), QgsRectangle( -6.125, -10.25, -5, -9 ) );</span></a>
<a name="11781"><span class="lineNum">   11781 </span>                :<span class="lineCov">          2 :   c37.fromWkt( QStringLiteral( &quot;CompoundCurve(CircularString( 5 10, 6 10, 5.5 9 ))&quot; ) );</span></a>
<a name="11782"><span class="lineNum">   11782 </span>                :<span class="lineCov">          1 :   QCOMPARE( c37.boundingBox(), QgsRectangle( 5, 9, 6.125, 10.25 ) );</span></a>
<a name="11783"><span class="lineNum">   11783 </span>                :<span class="lineCov">          1 :   c37.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -1, 7 ) );</span></a>
<a name="11784"><span class="lineNum">   11784 </span>                :<span class="lineCov">          1 :   QgsRectangle r = c37.boundingBox();</span></a>
<a name="11785"><span class="lineNum">   11785 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), -3.014, 0.01 );</span></a>
<a name="11786"><span class="lineNum">   11786 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 14.014, 0.01 );</span></a>
<a name="11787"><span class="lineNum">   11787 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), -7.0146, 0.01 );</span></a>
<a name="11788"><span class="lineNum">   11788 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 12.4988, 0.01 );</span></a>
<a name="11789"><span class="lineNum">   11789 </span>                :<span class="lineCov">          1 :   c37.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( -3, 10 ) );</span></a>
<a name="11790"><span class="lineNum">   11790 </span>                :<span class="lineCov">          1 :   r = c37.boundingBox();</span></a>
<a name="11791"><span class="lineNum">   11791 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), -10.294, 0.01 );</span></a>
<a name="11792"><span class="lineNum">   11792 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 12.294, 0.01 );</span></a>
<a name="11793"><span class="lineNum">   11793 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), 9, 0.01 );</span></a>
<a name="11794"><span class="lineNum">   11794 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 31.856, 0.01 );</span></a>
<a name="11795"><span class="lineNum">   11795 </span>                :<span class="lineCov">          1 :   c37.deleteVertex( QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="11796"><span class="lineNum">   11796 </span>                :<span class="lineCov">          1 :   r = c37.boundingBox();</span></a>
<a name="11797"><span class="lineNum">   11797 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMinimum(), 5, 0.01 );</span></a>
<a name="11798"><span class="lineNum">   11798 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.xMaximum(), 6.125, 0.01 );</span></a>
<a name="11799"><span class="lineNum">   11799 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMinimum(), 9, 0.01 );</span></a>
<a name="11800"><span class="lineNum">   11800 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( r.yMaximum(), 10.25, 0.01 );</span></a>
<a name="11801"><span class="lineNum">   11801 </span>                :            : </a>
<a name="11802"><span class="lineNum">   11802 </span>                :            :   //angle</a>
<a name="11803"><span class="lineNum">   11803 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c38;</span></a>
<a name="11804"><span class="lineNum">   11804 </span>                :<span class="lineCov">          1 :   QgsCircularString l38;</span></a>
<a name="11805"><span class="lineNum">   11805 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="11806"><span class="lineNum">   11806 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="11807"><span class="lineNum">   11807 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11808"><span class="lineNum">   11808 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11809"><span class="lineNum">   11809 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="11810"><span class="lineNum">   11810 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) );</span></a>
<a name="11811"><span class="lineNum">   11811 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11812"><span class="lineNum">   11812 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11813"><span class="lineNum">   11813 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="11814"><span class="lineNum">   11814 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ); //just want no crash, any answer is meaningless</span></a>
<a name="11815"><span class="lineNum">   11815 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="11816"><span class="lineNum">   11816 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11817"><span class="lineNum">   11817 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11818"><span class="lineNum">   11818 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="11819"><span class="lineNum">   11819 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0, 0.0001 );</span></a>
<a name="11820"><span class="lineNum">   11820 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="11821"><span class="lineNum">   11821 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11822"><span class="lineNum">   11822 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11823"><span class="lineNum">   11823 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11824"><span class="lineNum">   11824 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="11825"><span class="lineNum">   11825 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141593, 0.0001 );</span></a>
<a name="11826"><span class="lineNum">   11826 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="11827"><span class="lineNum">   11827 </span>                :<span class="lineCov">          1 :   ( void )c38.vertexAngle( QgsVertexId( 0, 0, 20 ) ); // no crash</span></a>
<a name="11828"><span class="lineNum">   11828 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 )</span></a>
<a name="11829"><span class="lineNum">   11829 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( -1, 3 ) &lt;&lt; QgsPoint( 0, 4 ) );</span></a>
<a name="11830"><span class="lineNum">   11830 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11831"><span class="lineNum">   11831 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11832"><span class="lineNum">   11832 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 1.5708, 0.0001 );</span></a>
<a name="11833"><span class="lineNum">   11833 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 0, 0.0001 );</span></a>
<a name="11834"><span class="lineNum">   11834 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 4.712389, 0.0001 );</span></a>
<a name="11835"><span class="lineNum">   11835 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0, 0.0001 );</span></a>
<a name="11836"><span class="lineNum">   11836 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 1.5708, 0.0001 );</span></a>
<a name="11837"><span class="lineNum">   11837 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 4 ) &lt;&lt; QgsPoint( -1, 3 ) &lt;&lt; QgsPoint( 0, 2 )</span></a>
<a name="11838"><span class="lineNum">   11838 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11839"><span class="lineNum">   11839 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11840"><span class="lineNum">   11840 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11841"><span class="lineNum">   11841 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 4.712389, 0.0001 );</span></a>
<a name="11842"><span class="lineNum">   11842 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141592, 0.0001 );</span></a>
<a name="11843"><span class="lineNum">   11843 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.5708, 0.0001 );</span></a>
<a name="11844"><span class="lineNum">   11844 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 3.141592, 0.0001 );</span></a>
<a name="11845"><span class="lineNum">   11845 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 4.712389, 0.0001 );</span></a>
<a name="11846"><span class="lineNum">   11846 </span>                :            : </a>
<a name="11847"><span class="lineNum">   11847 </span>                :            :   // with second curve</a>
<a name="11848"><span class="lineNum">   11848 </span>                :<span class="lineCov">          1 :   QgsLineString ls38;</span></a>
<a name="11849"><span class="lineNum">   11849 </span>                :<span class="lineCov">          1 :   ls38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, -1 ) );</span></a>
<a name="11850"><span class="lineNum">   11850 </span>                :<span class="lineCov">          1 :   c38.addCurve( ls38.clone() );</span></a>
<a name="11851"><span class="lineNum">   11851 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 3.926991, 0.0001 );</span></a>
<a name="11852"><span class="lineNum">   11852 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.141593, 0.0001 );</span></a>
<a name="11853"><span class="lineNum">   11853 </span>                :            : </a>
<a name="11854"><span class="lineNum">   11854 </span>                :            :   //closed circular string</a>
<a name="11855"><span class="lineNum">   11855 </span>                :<span class="lineCov">          1 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11856"><span class="lineNum">   11856 </span>                :<span class="lineCov">          1 :   c38.clear();</span></a>
<a name="11857"><span class="lineNum">   11857 </span>                :<span class="lineCov">          1 :   c38.addCurve( l38.clone() );</span></a>
<a name="11858"><span class="lineNum">   11858 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 0, 0.00001 );</span></a>
<a name="11859"><span class="lineNum">   11859 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 3.141592, 0.00001 );</span></a>
<a name="11860"><span class="lineNum">   11860 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( c38.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 0, 0.00001 );</span></a>
<a name="11861"><span class="lineNum">   11861 </span>                :            : </a>
<a name="11862"><span class="lineNum">   11862 </span>                :            :   //removing a vertex from a 3 point comound curveshould remove the whole line</a>
<a name="11863"><span class="lineNum">   11863 </span>                :<span class="lineCov">          1 :   QgsCircularString l39;</span></a>
<a name="11864"><span class="lineNum">   11864 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve c39;</span></a>
<a name="11865"><span class="lineNum">   11865 </span>                :<span class="lineCov">          1 :   l39.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="11866"><span class="lineNum">   11866 </span>                :<span class="lineCov">          1 :   c39.addCurve( l39.clone() );</span></a>
<a name="11867"><span class="lineNum">   11867 </span>                :<span class="lineCov">          1 :   QCOMPARE( c39.numPoints(), 3 );</span></a>
<a name="11868"><span class="lineNum">   11868 </span>                :<span class="lineCov">          1 :   c39.deleteVertex( QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="11869"><span class="lineNum">   11869 </span>                :<span class="lineCov">          1 :   QCOMPARE( c39.numPoints(), 0 );</span></a>
<a name="11870"><span class="lineNum">   11870 </span>                :            : </a>
<a name="11871"><span class="lineNum">   11871 </span>                :            :   //boundary</a>
<a name="11872"><span class="lineNum">   11872 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve cBoundary1;</span></a>
<a name="11873"><span class="lineNum">   11873 </span>                :<span class="lineCov">          1 :   QgsCircularString boundary1;</span></a>
<a name="11874"><span class="lineNum">   11874 </span>                :<span class="lineCov">          1 :   QVERIFY( !cBoundary1.boundary() );</span></a>
<a name="11875"><span class="lineNum">   11875 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="11876"><span class="lineNum">   11876 </span>                :<span class="lineCov">          1 :   cBoundary1.addCurve( boundary1.clone() );</span></a>
<a name="11877"><span class="lineNum">   11877 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = cBoundary1.boundary();</span></a>
<a name="11878"><span class="lineNum">   11878 </span>                :<span class="lineCov">          1 :   QgsMultiPoint *mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="11879"><span class="lineNum">   11879 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="11880"><span class="lineNum">   11880 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="11881"><span class="lineNum">   11881 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="11882"><span class="lineNum">   11882 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="11883"><span class="lineNum">   11883 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="11884"><span class="lineNum">   11884 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="11885"><span class="lineNum">   11885 </span>                :            : </a>
<a name="11886"><span class="lineNum">   11886 </span>                :            :   // closed string = no boundary</a>
<a name="11887"><span class="lineNum">   11887 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="11888"><span class="lineNum">   11888 </span>                :<span class="lineCov">          1 :   cBoundary1.clear();</span></a>
<a name="11889"><span class="lineNum">   11889 </span>                :<span class="lineCov">          1 :   cBoundary1.addCurve( boundary1.clone() );</span></a>
<a name="11890"><span class="lineNum">   11890 </span>                :<span class="lineCov">          1 :   QVERIFY( !cBoundary1.boundary() );</span></a>
<a name="11891"><span class="lineNum">   11891 </span>                :            : </a>
<a name="11892"><span class="lineNum">   11892 </span>                :            :   //boundary with z</a>
<a name="11893"><span class="lineNum">   11893 </span>                :<span class="lineCov">          1 :   boundary1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="11894"><span class="lineNum">   11894 </span>                :<span class="lineCov">          1 :   cBoundary1.clear();</span></a>
<a name="11895"><span class="lineNum">   11895 </span>                :<span class="lineCov">          1 :   cBoundary1.addCurve( boundary1.clone() );</span></a>
<a name="11896"><span class="lineNum">   11896 </span>                :<span class="lineCov">          1 :   boundary = cBoundary1.boundary();</span></a>
<a name="11897"><span class="lineNum">   11897 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="11898"><span class="lineNum">   11898 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="11899"><span class="lineNum">   11899 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="11900"><span class="lineNum">   11900 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="11901"><span class="lineNum">   11901 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="11902"><span class="lineNum">   11902 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;z(), 10.0 );</span></a>
<a name="11903"><span class="lineNum">   11903 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="11904"><span class="lineNum">   11904 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="11905"><span class="lineNum">   11905 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="11906"><span class="lineNum">   11906 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;z(), 20.0 );</span></a>
<a name="11907"><span class="lineNum">   11907 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="11908"><span class="lineNum">   11908 </span>                :            : </a>
<a name="11909"><span class="lineNum">   11909 </span>                :            :   // addToPainterPath (note most tests are in test_qgsgeometry.py)</a>
<a name="11910"><span class="lineNum">   11910 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ccPath;</span></a>
<a name="11911"><span class="lineNum">   11911 </span>                :<span class="lineCov">          1 :   QgsCircularString path;</span></a>
<a name="11912"><span class="lineNum">   11912 </span>                :<span class="lineCov">          1 :   QPainterPath pPath;</span></a>
<a name="11913"><span class="lineNum">   11913 </span>                :<span class="lineCov">          1 :   ccPath.addToPainterPath( pPath );</span></a>
<a name="11914"><span class="lineNum">   11914 </span>                :<span class="lineCov">          1 :   QVERIFY( pPath.isEmpty() );</span></a>
<a name="11915"><span class="lineNum">   11915 </span>                :<span class="lineCov">          2 :   path.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 )</span></a>
<a name="11916"><span class="lineNum">   11916 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 21, 2, 3 ) );</span></a>
<a name="11917"><span class="lineNum">   11917 </span>                :<span class="lineCov">          1 :   ccPath.addCurve( path.clone() );</span></a>
<a name="11918"><span class="lineNum">   11918 </span>                :<span class="lineCov">          1 :   ccPath.addToPainterPath( pPath );</span></a>
<a name="11919"><span class="lineNum">   11919 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().x(), 21.0, 0.01 );</span></a>
<a name="11920"><span class="lineNum">   11920 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().y(), 2.0, 0.01 );</span></a>
<a name="11921"><span class="lineNum">   11921 </span>                :<span class="lineCov">          1 :   QVERIFY( !pPath.isEmpty() );</span></a>
<a name="11922"><span class="lineNum">   11922 </span>                :<span class="lineCov">          1 :   QgsLineString lsPath;</span></a>
<a name="11923"><span class="lineNum">   11923 </span>                :<span class="lineCov">          2 :   lsPath.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 21, 2, 3 )</span></a>
<a name="11924"><span class="lineNum">   11924 </span>                :<span class="lineCov">          1 :                     &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 31, 12, 3 ) );</span></a>
<a name="11925"><span class="lineNum">   11925 </span>                :<span class="lineCov">          1 :   ccPath.addCurve( lsPath.clone() );</span></a>
<a name="11926"><span class="lineNum">   11926 </span>                :<span class="lineCov">          1 :   pPath = QPainterPath();</span></a>
<a name="11927"><span class="lineNum">   11927 </span>                :<span class="lineCov">          1 :   ccPath.addToPainterPath( pPath );</span></a>
<a name="11928"><span class="lineNum">   11928 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().x(), 31.0, 0.01 );</span></a>
<a name="11929"><span class="lineNum">   11929 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().y(), 12.0, 0.01 );</span></a>
<a name="11930"><span class="lineNum">   11930 </span>                :            : </a>
<a name="11931"><span class="lineNum">   11931 </span>                :            :   // even number of points - should still work</a>
<a name="11932"><span class="lineNum">   11932 </span>                :<span class="lineCov">          1 :   pPath = QPainterPath();</span></a>
<a name="11933"><span class="lineNum">   11933 </span>                :<span class="lineCov">          1 :   path.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 11, 12, 13 ) );</span></a>
<a name="11934"><span class="lineNum">   11934 </span>                :<span class="lineCov">          1 :   ccPath.clear();</span></a>
<a name="11935"><span class="lineNum">   11935 </span>                :<span class="lineCov">          1 :   ccPath.addCurve( path.clone() );</span></a>
<a name="11936"><span class="lineNum">   11936 </span>                :<span class="lineCov">          1 :   ccPath.addToPainterPath( pPath );</span></a>
<a name="11937"><span class="lineNum">   11937 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().x(), 11.0, 0.01 );</span></a>
<a name="11938"><span class="lineNum">   11938 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pPath.currentPosition().y(), 12.0, 0.01 );</span></a>
<a name="11939"><span class="lineNum">   11939 </span>                :<span class="lineCov">          1 :   QVERIFY( !pPath.isEmpty() );</span></a>
<a name="11940"><span class="lineNum">   11940 </span>                :            : </a>
<a name="11941"><span class="lineNum">   11941 </span>                :            :   // toCurveType</a>
<a name="11942"><span class="lineNum">   11942 </span>                :<span class="lineCov">          1 :   QgsCircularString curveLine1;</span></a>
<a name="11943"><span class="lineNum">   11943 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve cc1;</span></a>
<a name="11944"><span class="lineNum">   11944 </span>                :<span class="lineCov">          1 :   curveLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="11945"><span class="lineNum">   11945 </span>                :<span class="lineCov">          1 :   cc1.addCurve( curveLine1.clone() );</span></a>
<a name="11946"><span class="lineNum">   11946 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCurve &gt; curveType( cc1.toCurveType() );</span></a>
<a name="11947"><span class="lineNum">   11947 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11948"><span class="lineNum">   11948 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numPoints(), 3 );</span></a>
<a name="11949"><span class="lineNum">   11949 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="11950"><span class="lineNum">   11950 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="11951"><span class="lineNum">   11951 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 1, 22 ) );</span></a>
<a name="11952"><span class="lineNum">   11952 </span>                :<span class="lineCov">          1 :   QgsLineString ccls1;</span></a>
<a name="11953"><span class="lineNum">   11953 </span>                :<span class="lineCov">          1 :   ccls1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( 1, 25 ) );</span></a>
<a name="11954"><span class="lineNum">   11954 </span>                :<span class="lineCov">          1 :   cc1.addCurve( ccls1.clone() );</span></a>
<a name="11955"><span class="lineNum">   11955 </span>                :<span class="lineCov">          1 :   curveType.reset( cc1.toCurveType() );</span></a>
<a name="11956"><span class="lineNum">   11956 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11957"><span class="lineNum">   11957 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numPoints(), 4 );</span></a>
<a name="11958"><span class="lineNum">   11958 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="11959"><span class="lineNum">   11959 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="11960"><span class="lineNum">   11960 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( 1, 22 ) );</span></a>
<a name="11961"><span class="lineNum">   11961 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( 1, 25 ) );</span></a>
<a name="11962"><span class="lineNum">   11962 </span>                :            : </a>
<a name="11963"><span class="lineNum">   11963 </span>                :            :   //test that area of a compound curve ring is equal to a closed linestring with the same vertices</a>
<a name="11964"><span class="lineNum">   11964 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve cc;</span></a>
<a name="11965"><span class="lineNum">   11965 </span>                :<span class="lineCov">          1 :   QgsLineString *ll1 = new QgsLineString();</span></a>
<a name="11966"><span class="lineNum">   11966 </span>                :<span class="lineCov">          1 :   ll1-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) );</span></a>
<a name="11967"><span class="lineNum">   11967 </span>                :<span class="lineCov">          1 :   cc.addCurve( ll1 );</span></a>
<a name="11968"><span class="lineNum">   11968 </span>                :<span class="lineCov">          1 :   QgsLineString *ll2 = new QgsLineString();</span></a>
<a name="11969"><span class="lineNum">   11969 </span>                :<span class="lineCov">          1 :   ll2-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( -1, 0 ) &lt;&lt; QgsPoint( 0, -1 ) );</span></a>
<a name="11970"><span class="lineNum">   11970 </span>                :<span class="lineCov">          1 :   cc.addCurve( ll2 );</span></a>
<a name="11971"><span class="lineNum">   11971 </span>                :<span class="lineCov">          1 :   QgsLineString *ll3 = new QgsLineString();</span></a>
<a name="11972"><span class="lineNum">   11972 </span>                :<span class="lineCov">          1 :   ll3-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, -1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="11973"><span class="lineNum">   11973 </span>                :<span class="lineCov">          1 :   cc.addCurve( ll3 );</span></a>
<a name="11974"><span class="lineNum">   11974 </span>                :            : </a>
<a name="11975"><span class="lineNum">   11975 </span>                :<span class="lineCov">          1 :   double ccArea = 0.0;</span></a>
<a name="11976"><span class="lineNum">   11976 </span>                :<span class="lineCov">          1 :   cc.sumUpArea( ccArea );</span></a>
<a name="11977"><span class="lineNum">   11977 </span>                :            : </a>
<a name="11978"><span class="lineNum">   11978 </span>                :<span class="lineCov">          1 :   QgsLineString ls;</span></a>
<a name="11979"><span class="lineNum">   11979 </span>                :<span class="lineCov">          2 :   ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt;  QgsPoint( -1, 0 ) &lt;&lt; QgsPoint( 0, -1 )</span></a>
<a name="11980"><span class="lineNum">   11980 </span>                :<span class="lineCov">          1 :                 &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="11981"><span class="lineNum">   11981 </span>                :<span class="lineCov">          1 :   double lsArea = 0.0;</span></a>
<a name="11982"><span class="lineNum">   11982 </span>                :<span class="lineCov">          1 :   ls.sumUpArea( lsArea );</span></a>
<a name="11983"><span class="lineNum">   11983 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( ccArea, lsArea, 4 * std::numeric_limits&lt;double&gt;::epsilon() );</span></a>
<a name="11984"><span class="lineNum">   11984 </span>                :            : </a>
<a name="11985"><span class="lineNum">   11985 </span>                :            : </a>
<a name="11986"><span class="lineNum">   11986 </span>                :            :   //addVertex</a>
<a name="11987"><span class="lineNum">   11987 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac1;</span></a>
<a name="11988"><span class="lineNum">   11988 </span>                :<span class="lineCov">          1 :   ac1.addVertex( QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="11989"><span class="lineNum">   11989 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac1.isEmpty() );</span></a>
<a name="11990"><span class="lineNum">   11990 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.numPoints(), 1 );</span></a>
<a name="11991"><span class="lineNum">   11991 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.vertexCount(), 1 );</span></a>
<a name="11992"><span class="lineNum">   11992 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.nCoordinates(), 1 );</span></a>
<a name="11993"><span class="lineNum">   11993 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.ringCount(), 1 );</span></a>
<a name="11994"><span class="lineNum">   11994 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.partCount(), 1 );</span></a>
<a name="11995"><span class="lineNum">   11995 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac1.is3D() );</span></a>
<a name="11996"><span class="lineNum">   11996 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac1.isMeasure() );</span></a>
<a name="11997"><span class="lineNum">   11997 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="11998"><span class="lineNum">   11998 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac1.hasCurvedSegments() );</span></a>
<a name="11999"><span class="lineNum">   11999 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.area(), 0.0 );</span></a>
<a name="12000"><span class="lineNum">   12000 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac1.perimeter(), 0.0 );</span></a>
<a name="12001"><span class="lineNum">   12001 </span>                :            : </a>
<a name="12002"><span class="lineNum">   12002 </span>                :            :   //adding first vertex should set linestring z/m type</a>
<a name="12003"><span class="lineNum">   12003 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac2;</span></a>
<a name="12004"><span class="lineNum">   12004 </span>                :<span class="lineCov">          1 :   ac2.addVertex( QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) );</span></a>
<a name="12005"><span class="lineNum">   12005 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac2.isEmpty() );</span></a>
<a name="12006"><span class="lineNum">   12006 </span>                :<span class="lineCov">          1 :   QVERIFY( ac2.is3D() );</span></a>
<a name="12007"><span class="lineNum">   12007 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac2.isMeasure() );</span></a>
<a name="12008"><span class="lineNum">   12008 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac2.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="12009"><span class="lineNum">   12009 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac2.wktTypeStr(), QString( &quot;CompoundCurveZ&quot; ) );</span></a>
<a name="12010"><span class="lineNum">   12010 </span>                :            : </a>
<a name="12011"><span class="lineNum">   12011 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac3;</span></a>
<a name="12012"><span class="lineNum">   12012 </span>                :<span class="lineCov">          1 :   ac3.addVertex( QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0.0, 3.0 ) );</span></a>
<a name="12013"><span class="lineNum">   12013 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac3.isEmpty() );</span></a>
<a name="12014"><span class="lineNum">   12014 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac3.is3D() );</span></a>
<a name="12015"><span class="lineNum">   12015 </span>                :<span class="lineCov">          1 :   QVERIFY( ac3.isMeasure() );</span></a>
<a name="12016"><span class="lineNum">   12016 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac3.wkbType(), QgsWkbTypes::CompoundCurveM );</span></a>
<a name="12017"><span class="lineNum">   12017 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac3.wktTypeStr(), QString( &quot;CompoundCurveM&quot; ) );</span></a>
<a name="12018"><span class="lineNum">   12018 </span>                :            : </a>
<a name="12019"><span class="lineNum">   12019 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac4;</span></a>
<a name="12020"><span class="lineNum">   12020 </span>                :<span class="lineCov">          1 :   ac4.addVertex( QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 3.0, 4.0 ) );</span></a>
<a name="12021"><span class="lineNum">   12021 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac4.isEmpty() );</span></a>
<a name="12022"><span class="lineNum">   12022 </span>                :<span class="lineCov">          1 :   QVERIFY( ac4.is3D() );</span></a>
<a name="12023"><span class="lineNum">   12023 </span>                :<span class="lineCov">          1 :   QVERIFY( ac4.isMeasure() );</span></a>
<a name="12024"><span class="lineNum">   12024 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac4.wkbType(), QgsWkbTypes::CompoundCurveZM );</span></a>
<a name="12025"><span class="lineNum">   12025 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac4.wktTypeStr(), QString( &quot;CompoundCurveZM&quot; ) );</span></a>
<a name="12026"><span class="lineNum">   12026 </span>                :            : </a>
<a name="12027"><span class="lineNum">   12027 </span>                :            :   //adding subsequent vertices should not alter z/m type, regardless of points type</a>
<a name="12028"><span class="lineNum">   12028 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac5;</span></a>
<a name="12029"><span class="lineNum">   12029 </span>                :<span class="lineCov">          1 :   ac5.addVertex( QgsPoint( QgsWkbTypes::Point, 1.0, 2.0 ) ); //2d type</span></a>
<a name="12030"><span class="lineNum">   12030 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.wkbType(), QgsWkbTypes::CompoundCurve );</span></a>
<a name="12031"><span class="lineNum">   12031 </span>                :<span class="lineCov">          1 :   ac5.addVertex( QgsPoint( QgsWkbTypes::PointZ, 11.0, 12.0, 13.0 ) ); // add 3d point</span></a>
<a name="12032"><span class="lineNum">   12032 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.numPoints(), 2 );</span></a>
<a name="12033"><span class="lineNum">   12033 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.vertexCount(), 2 );</span></a>
<a name="12034"><span class="lineNum">   12034 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.nCoordinates(), 2 );</span></a>
<a name="12035"><span class="lineNum">   12035 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.ringCount(), 1 );</span></a>
<a name="12036"><span class="lineNum">   12036 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.partCount(), 1 );</span></a>
<a name="12037"><span class="lineNum">   12037 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.wkbType(), QgsWkbTypes::CompoundCurve ); //should still be 2d</span></a>
<a name="12038"><span class="lineNum">   12038 </span>                :<span class="lineCov">          1 :   QVERIFY( !ac5.is3D() );</span></a>
<a name="12039"><span class="lineNum">   12039 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.area(), 0.0 );</span></a>
<a name="12040"><span class="lineNum">   12040 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac5.perimeter(), 0.0 );</span></a>
<a name="12041"><span class="lineNum">   12041 </span>                :            : </a>
<a name="12042"><span class="lineNum">   12042 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve ac6;</span></a>
<a name="12043"><span class="lineNum">   12043 </span>                :<span class="lineCov">          1 :   ac6.addVertex( QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3.0 ) ); //3d type</span></a>
<a name="12044"><span class="lineNum">   12044 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.wkbType(), QgsWkbTypes::CompoundCurveZ );</span></a>
<a name="12045"><span class="lineNum">   12045 </span>                :<span class="lineCov">          1 :   ac6.addVertex( QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) ); //add 2d point</span></a>
<a name="12046"><span class="lineNum">   12046 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.wkbType(), QgsWkbTypes::CompoundCurveZ ); //should still be 3d</span></a>
<a name="12047"><span class="lineNum">   12047 </span>                :<span class="lineCov">          1 :   ac6.pointAt( 1, pt, v );</span></a>
<a name="12048"><span class="lineNum">   12048 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::PointZ, 11.0, 12.0 ) );</span></a>
<a name="12049"><span class="lineNum">   12049 </span>                :<span class="lineCov">          1 :   QVERIFY( ac6.is3D() );</span></a>
<a name="12050"><span class="lineNum">   12050 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.numPoints(), 2 );</span></a>
<a name="12051"><span class="lineNum">   12051 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.vertexCount(), 2 );</span></a>
<a name="12052"><span class="lineNum">   12052 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.nCoordinates(), 2 );</span></a>
<a name="12053"><span class="lineNum">   12053 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.ringCount(), 1 );</span></a>
<a name="12054"><span class="lineNum">   12054 </span>                :<span class="lineCov">          1 :   QCOMPARE( ac6.partCount(), 1 );</span></a>
<a name="12055"><span class="lineNum">   12055 </span>                :            : </a>
<a name="12056"><span class="lineNum">   12056 </span>                :            :   //close</a>
<a name="12057"><span class="lineNum">   12057 </span>                :<span class="lineCov">          1 :   QgsLineString closeC1;</span></a>
<a name="12058"><span class="lineNum">   12058 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve closeCc1;</span></a>
<a name="12059"><span class="lineNum">   12059 </span>                :<span class="lineCov">          1 :   closeCc1.close();</span></a>
<a name="12060"><span class="lineNum">   12060 </span>                :<span class="lineCov">          1 :   QVERIFY( closeCc1.isEmpty() );</span></a>
<a name="12061"><span class="lineNum">   12061 </span>                :<span class="lineCov">          1 :   closeC1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="12062"><span class="lineNum">   12062 </span>                :<span class="lineCov">          1 :   closeCc1.addCurve( closeC1.clone() );</span></a>
<a name="12063"><span class="lineNum">   12063 </span>                :<span class="lineCov">          1 :   QCOMPARE( closeCc1.numPoints(), 3 );</span></a>
<a name="12064"><span class="lineNum">   12064 </span>                :<span class="lineCov">          1 :   QVERIFY( !closeCc1.isClosed() );</span></a>
<a name="12065"><span class="lineNum">   12065 </span>                :<span class="lineCov">          1 :   closeCc1.close();</span></a>
<a name="12066"><span class="lineNum">   12066 </span>                :<span class="lineCov">          1 :   QCOMPARE( closeCc1.numPoints(), 4 );</span></a>
<a name="12067"><span class="lineNum">   12067 </span>                :<span class="lineCov">          1 :   QVERIFY( closeCc1.isClosed() );</span></a>
<a name="12068"><span class="lineNum">   12068 </span>                :<span class="lineCov">          1 :   closeCc1.pointAt( 3, pt, v );</span></a>
<a name="12069"><span class="lineNum">   12069 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( QgsWkbTypes::Point, 1, 2 ) );</span></a>
<a name="12070"><span class="lineNum">   12070 </span>                :<span class="lineCov">          1 :   closeCc1.close();</span></a>
<a name="12071"><span class="lineNum">   12071 </span>                :<span class="lineCov">          1 :   QCOMPARE( closeCc1.numPoints(), 4 );</span></a>
<a name="12072"><span class="lineNum">   12072 </span>                :<span class="lineCov">          1 :   QVERIFY( closeCc1.isClosed() );</span></a>
<a name="12073"><span class="lineNum">   12073 </span>                :            : </a>
<a name="12074"><span class="lineNum">   12074 </span>                :            :   //segmentLength</a>
<a name="12075"><span class="lineNum">   12075 </span>                :<span class="lineCov">          1 :   QgsCircularString curveLine2;</span></a>
<a name="12076"><span class="lineNum">   12076 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve slc1;</span></a>
<a name="12077"><span class="lineNum">   12077 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="12078"><span class="lineNum">   12078 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="12079"><span class="lineNum">   12079 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 1, 0, 0 ) ), 0.0 );</span></a>
<a name="12080"><span class="lineNum">   12080 </span>                :<span class="lineCov">          1 :   curveLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 22 ) );</span></a>
<a name="12081"><span class="lineNum">   12081 </span>                :<span class="lineCov">          1 :   slc1.addCurve( curveLine2.clone() );</span></a>
<a name="12082"><span class="lineNum">   12082 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="12083"><span class="lineNum">   12083 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="12084"><span class="lineNum">   12084 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 0, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="12085"><span class="lineNum">   12085 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 1 ) ), 0.0 );</span></a>
<a name="12086"><span class="lineNum">   12086 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 2 ) ), 0.0 );</span></a>
<a name="12087"><span class="lineNum">   12087 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="12088"><span class="lineNum">   12088 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( -1, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="12089"><span class="lineNum">   12089 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 1, 0, 1 ) ), 0.0 );</span></a>
<a name="12090"><span class="lineNum">   12090 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 1, 1, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="12091"><span class="lineNum">   12091 </span>                :<span class="lineCov">          1 :   curveLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 22 ) &lt;&lt; QgsPoint( -9, 32 ) &lt;&lt; QgsPoint( 1, 42 ) );</span></a>
<a name="12092"><span class="lineNum">   12092 </span>                :<span class="lineCov">          1 :   slc1.addCurve( curveLine2.clone() );</span></a>
<a name="12093"><span class="lineNum">   12093 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="12094"><span class="lineNum">   12094 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="12095"><span class="lineNum">   12095 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 0, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="12096"><span class="lineNum">   12096 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 1 ) ), 0.0 );</span></a>
<a name="12097"><span class="lineNum">   12097 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 0, 0, 2 ) ), 31.4159, 0.001 );</span></a>
<a name="12098"><span class="lineNum">   12098 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 3 ) ), 0.0 );</span></a>
<a name="12099"><span class="lineNum">   12099 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 4 ) ), 0.0 );</span></a>
<a name="12100"><span class="lineNum">   12100 </span>                :<span class="lineCov">          1 :   QgsLineString curveLine3;</span></a>
<a name="12101"><span class="lineNum">   12101 </span>                :<span class="lineCov">          1 :   curveLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 42 ) &lt;&lt; QgsPoint( 10, 42 ) );</span></a>
<a name="12102"><span class="lineNum">   12102 </span>                :<span class="lineCov">          1 :   slc1.addCurve( curveLine3.clone() );</span></a>
<a name="12103"><span class="lineNum">   12103 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="12104"><span class="lineNum">   12104 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="12105"><span class="lineNum">   12105 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 0, 0, 0 ) ), 31.4159, 0.001 );</span></a>
<a name="12106"><span class="lineNum">   12106 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 1 ) ), 0.0 );</span></a>
<a name="12107"><span class="lineNum">   12107 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( slc1.segmentLength( QgsVertexId( 0, 0, 2 ) ), 31.4159, 0.001 );</span></a>
<a name="12108"><span class="lineNum">   12108 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 3 ) ), 0.0 );</span></a>
<a name="12109"><span class="lineNum">   12109 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 4 ) ), 9.0 );</span></a>
<a name="12110"><span class="lineNum">   12110 </span>                :<span class="lineCov">          1 :   QCOMPARE( slc1.segmentLength( QgsVertexId( 0, 0, 5 ) ), 0.0 );</span></a>
<a name="12111"><span class="lineNum">   12111 </span>                :            : </a>
<a name="12112"><span class="lineNum">   12112 </span>                :            :   //removeDuplicateNodes</a>
<a name="12113"><span class="lineNum">   12113 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve nodeCurve;</span></a>
<a name="12114"><span class="lineNum">   12114 </span>                :<span class="lineCov">          1 :   QgsCircularString nodeLine;</span></a>
<a name="12115"><span class="lineNum">   12115 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes() );</span></a>
<a name="12116"><span class="lineNum">   12116 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="12117"><span class="lineNum">   12117 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12118"><span class="lineNum">   12118 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes() );</span></a>
<a name="12119"><span class="lineNum">   12119 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11 12, 111 12))&quot; ) );</span></a>
<a name="12120"><span class="lineNum">   12120 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="12121"><span class="lineNum">   12121 </span>                :<span class="lineCov">          1 :   nodeCurve.clear();</span></a>
<a name="12122"><span class="lineNum">   12122 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12123"><span class="lineNum">   12123 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes() );</span></a>
<a name="12124"><span class="lineNum">   12124 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11 12, 11 2))&quot; ) );</span></a>
<a name="12125"><span class="lineNum">   12125 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 10, 3 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 9, 3 )</span></a>
<a name="12126"><span class="lineNum">   12126 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="12127"><span class="lineNum">   12127 </span>                :<span class="lineCov">          1 :   nodeCurve.clear();</span></a>
<a name="12128"><span class="lineNum">   12128 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12129"><span class="lineNum">   12129 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12130"><span class="lineNum">   12130 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 10 3, 11.01 1.99, 9 3, 11 2))&quot; ) );</span></a>
<a name="12131"><span class="lineNum">   12131 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="12132"><span class="lineNum">   12132 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) );</span></a>
<a name="12133"><span class="lineNum">   12133 </span>                :<span class="lineCov">          1 :   nodeCurve.clear();</span></a>
<a name="12134"><span class="lineNum">   12134 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12135"><span class="lineNum">   12135 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes() );</span></a>
<a name="12136"><span class="lineNum">   12136 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11.01 1.99, 11.02 2.01, 11 12, 111 12, 111.01 11.99))&quot; ) );</span></a>
<a name="12137"><span class="lineNum">   12137 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12138"><span class="lineNum">   12138 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12139"><span class="lineNum">   12139 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11 12, 111 12, 111.01 11.99))&quot; ) );</span></a>
<a name="12140"><span class="lineNum">   12140 </span>                :            : </a>
<a name="12141"><span class="lineNum">   12141 </span>                :            :   // with tiny segment</a>
<a name="12142"><span class="lineNum">   12142 </span>                :<span class="lineCov">          1 :   QgsLineString linePart;</span></a>
<a name="12143"><span class="lineNum">   12143 </span>                :<span class="lineCov">          1 :   linePart.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 111.01, 11.99 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="12144"><span class="lineNum">   12144 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( linePart.clone() );</span></a>
<a name="12145"><span class="lineNum">   12145 </span>                :<span class="lineCov">          1 :   QVERIFY( !nodeCurve.removeDuplicateNodes() );</span></a>
<a name="12146"><span class="lineNum">   12146 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11 12, 111 12, 111.01 11.99),(111.01 11.99, 111 12))&quot; ) );</span></a>
<a name="12147"><span class="lineNum">   12147 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12148"><span class="lineNum">   12148 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve (CircularString (11 2, 11 12, 111 12, 111.01 11.99))&quot; ) );</span></a>
<a name="12149"><span class="lineNum">   12149 </span>                :            : </a>
<a name="12150"><span class="lineNum">   12150 </span>                :            :   // with multiple duplicate nodes</a>
<a name="12151"><span class="lineNum">   12151 </span>                :<span class="lineCov">          2 :   nodeCurve.fromWkt( QStringLiteral( &quot;CompoundCurve ((11 1, 11 2, 11 2),CircularString(11 2, 10 3, 10 2),(10 2, 10 2, 11 1))&quot; ) );</span></a>
<a name="12152"><span class="lineNum">   12152 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12153"><span class="lineNum">   12153 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 0 ), QStringLiteral( &quot;CompoundCurve ((11 1, 11 2),CircularString (11 2, 10 3, 10 2),(10 2, 11 1))&quot; ) );</span></a>
<a name="12154"><span class="lineNum">   12154 </span>                :            : </a>
<a name="12155"><span class="lineNum">   12155 </span>                :            :   // ensure continuity</a>
<a name="12156"><span class="lineNum">   12156 </span>                :<span class="lineCov">          1 :   nodeCurve.clear();</span></a>
<a name="12157"><span class="lineNum">   12157 </span>                :<span class="lineCov">          1 :   linePart.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="12158"><span class="lineNum">   12158 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( linePart.clone() );</span></a>
<a name="12159"><span class="lineNum">   12159 </span>                :<span class="lineCov">          1 :   linePart.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 31, 33 ) );</span></a>
<a name="12160"><span class="lineNum">   12160 </span>                :<span class="lineCov">          1 :   nodeCurve.addCurve( linePart.clone() );</span></a>
<a name="12161"><span class="lineNum">   12161 </span>                :<span class="lineCov">          1 :   QVERIFY( nodeCurve.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="12162"><span class="lineNum">   12162 </span>                :<span class="lineCov">          2 :   QCOMPARE( nodeCurve.asWkt( 2 ), QStringLiteral( &quot;CompoundCurve ((1 1, 111.01 11.99),(111.01 11.99, 31 33))&quot; ) );</span></a>
<a name="12163"><span class="lineNum">   12163 </span>                :            : </a>
<a name="12164"><span class="lineNum">   12164 </span>                :            :   // swap xy</a>
<a name="12165"><span class="lineNum">   12165 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve swapCurve;</span></a>
<a name="12166"><span class="lineNum">   12166 </span>                :<span class="lineCov">          1 :   swapCurve.swapXy(); //no crash</span></a>
<a name="12167"><span class="lineNum">   12167 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="12168"><span class="lineNum">   12168 </span>                :<span class="lineCov">          1 :   swapCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12169"><span class="lineNum">   12169 </span>                :<span class="lineCov">          1 :   swapCurve.swapXy();</span></a>
<a name="12170"><span class="lineNum">   12170 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (2 11 3 4, 12 11 13 14, 12 111 23 24))&quot; ) );</span></a>
<a name="12171"><span class="lineNum">   12171 </span>                :<span class="lineCov">          1 :   QgsLineString lsSwap;</span></a>
<a name="12172"><span class="lineNum">   12172 </span>                :<span class="lineCov">          1 :   lsSwap.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 12, 111, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 22, 122, 33, 34, QgsWkbTypes::PointZM ) );</span></a>
<a name="12173"><span class="lineNum">   12173 </span>                :<span class="lineCov">          1 :   swapCurve.addCurve( lsSwap.clone() );</span></a>
<a name="12174"><span class="lineNum">   12174 </span>                :<span class="lineCov">          1 :   swapCurve.swapXy();</span></a>
<a name="12175"><span class="lineNum">   12175 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (11 2 3 4, 11 12 13 14, 111 12 23 24),(111 12 23 24, 122 22 33 34))&quot; ) );</span></a>
<a name="12176"><span class="lineNum">   12176 </span>                :            : </a>
<a name="12177"><span class="lineNum">   12177 </span>                :            :   // filter vertices</a>
<a name="12178"><span class="lineNum">   12178 </span>                :<span class="lineCov">         11 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="12179"><span class="lineNum">   12179 </span>                :            :   {</a>
<a name="12180"><span class="lineNum">   12180 </span>                :<span class="lineCov">         11 :     return point.x() &gt; 5;</span></a>
<a name="12181"><span class="lineNum">   12181 </span>                :            :   };</a>
<a name="12182"><span class="lineNum">   12182 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve filterCurve;</span></a>
<a name="12183"><span class="lineNum">   12183 </span>                :<span class="lineCov">          1 :   filterCurve.filterVertices( filter ); //no crash</span></a>
<a name="12184"><span class="lineNum">   12184 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence()   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM )   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="12185"><span class="lineNum">   12185 </span>                :<span class="lineCov">          1 :   filterCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12186"><span class="lineNum">   12186 </span>                :<span class="lineCov">          1 :   filterCurve.filterVertices( filter );</span></a>
<a name="12187"><span class="lineNum">   12187 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (11 2 3 4, 11 12 13 14, 111 12 23 24))&quot; ) );</span></a>
<a name="12188"><span class="lineNum">   12188 </span>                :<span class="lineCov">          1 :   QgsLineString lsFilter;</span></a>
<a name="12189"><span class="lineNum">   12189 </span>                :<span class="lineCov">          1 :   lsFilter.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 12, 111, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 22, 122, 33, 34, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 111, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="12190"><span class="lineNum">   12190 </span>                :<span class="lineCov">          1 :   filterCurve.addCurve( lsFilter.clone() );</span></a>
<a name="12191"><span class="lineNum">   12191 </span>                :<span class="lineCov">          1 :   filterCurve.filterVertices( filter );</span></a>
<a name="12192"><span class="lineNum">   12192 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (11 2 3 4, 11 12 13 14, 111 12 23 24),(12 111 23 24, 22 122 33 34))&quot; ) );</span></a>
<a name="12193"><span class="lineNum">   12193 </span>                :            : </a>
<a name="12194"><span class="lineNum">   12194 </span>                :            :   // transform vertices</a>
<a name="12195"><span class="lineNum">   12195 </span>                :<span class="lineCov">         13 :   auto transform = []( const QgsPoint &amp; point )-&gt; QgsPoint</span></a>
<a name="12196"><span class="lineNum">   12196 </span>                :            :   {</a>
<a name="12197"><span class="lineNum">   12197 </span>                :<span class="lineCov">         13 :     return QgsPoint( point.x() + 2, point.y() + 3, point.z() + 4, point.m() + 5 );</span></a>
<a name="12198"><span class="lineNum">   12198 </span>                :            :   };</a>
<a name="12199"><span class="lineNum">   12199 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve transformCurve;</span></a>
<a name="12200"><span class="lineNum">   12200 </span>                :<span class="lineCov">          1 :   transformCurve.transformVertices( transform ); //no crash</span></a>
<a name="12201"><span class="lineNum">   12201 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence()   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM )   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="12202"><span class="lineNum">   12202 </span>                :<span class="lineCov">          1 :   transformCurve.addCurve( nodeLine.clone() );</span></a>
<a name="12203"><span class="lineNum">   12203 </span>                :<span class="lineCov">          1 :   transformCurve.transformVertices( transform );</span></a>
<a name="12204"><span class="lineNum">   12204 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (3 5 7 9, 13 5 7 9, 13 15 17 19, 113 15 27 29, 3 5 7 9))&quot; ) );</span></a>
<a name="12205"><span class="lineNum">   12205 </span>                :<span class="lineCov">          1 :   QgsLineString lsTransform;</span></a>
<a name="12206"><span class="lineNum">   12206 </span>                :<span class="lineCov">          1 :   lsTransform.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 12, 111, 23, 24, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 22, 122, 33, 34, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1, 111, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="12207"><span class="lineNum">   12207 </span>                :<span class="lineCov">          1 :   transformCurve.addCurve( lsTransform.clone() );</span></a>
<a name="12208"><span class="lineNum">   12208 </span>                :<span class="lineCov">          1 :   transformCurve.transformVertices( transform );</span></a>
<a name="12209"><span class="lineNum">   12209 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCurve.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (5 8 11 14, 15 8 11 14, 15 18 21 24, 115 18 31 34, 5 8 11 14),(14 114 27 29, 24 125 37 39, 3 114 27 29))&quot; ) );</span></a>
<a name="12210"><span class="lineNum">   12210 </span>                :            : </a>
<a name="12211"><span class="lineNum">   12211 </span>                :            :   // transform using class</a>
<a name="12212"><span class="lineNum">   12212 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve transformCurve2;</span></a>
<a name="12213"><span class="lineNum">   12213 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="12214"><span class="lineNum">   12214 </span>                :            :   // no crash</a>
<a name="12215"><span class="lineNum">   12215 </span>                :<span class="lineCov">          1 :   QVERIFY( transformCurve2.transform( &amp;transformer ) );</span></a>
<a name="12216"><span class="lineNum">   12216 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence()   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM )   &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) );</span></a>
<a name="12217"><span class="lineNum">   12217 </span>                :<span class="lineCov">          1 :   transformCurve2.addCurve( nodeLine.clone() );</span></a>
<a name="12218"><span class="lineNum">   12218 </span>                :<span class="lineCov">          1 :   QVERIFY( transformCurve2.transform( &amp;transformer ) );</span></a>
<a name="12219"><span class="lineNum">   12219 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCurve2.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (3 16 8 3, 33 16 8 3, 33 26 18 13, 333 26 28 23, 3 16 8 3))&quot; ) );</span></a>
<a name="12220"><span class="lineNum">   12220 </span>                :<span class="lineCov">          1 :   transformCurve2.addCurve( lsTransform.clone() );</span></a>
<a name="12221"><span class="lineNum">   12221 </span>                :<span class="lineCov">          1 :   QVERIFY( transformCurve2.transform( &amp;transformer ) );</span></a>
<a name="12222"><span class="lineNum">   12222 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCurve2.asWkt(), QStringLiteral( &quot;CompoundCurveZM (CircularStringZM (9 30 13 2, 99 30 13 2, 99 40 23 12, 999 40 33 22, 9 30 13 2),(36 125 28 23, 66 136 38 33, 3 125 28 23))&quot; ) );</span></a>
<a name="12223"><span class="lineNum">   12223 </span>                :            : </a>
<a name="12224"><span class="lineNum">   12224 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="12225"><span class="lineNum">   12225 </span>                :<span class="lineCov">          1 :   QVERIFY( !transformCurve2.transform( &amp;failTransformer ) );</span></a>
<a name="12226"><span class="lineNum">   12226 </span>                :            : </a>
<a name="12227"><span class="lineNum">   12227 </span>                :            :   // substring</a>
<a name="12228"><span class="lineNum">   12228 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve substring;</span></a>
<a name="12229"><span class="lineNum">   12229 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsCompoundCurve &gt; substringResult( substring.curveSubstring( 1, 2 ) ); // no crash</span></a>
<a name="12230"><span class="lineNum">   12230 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult.get() );</span></a>
<a name="12231"><span class="lineNum">   12231 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="12232"><span class="lineNum">   12232 </span>                :<span class="lineCov">          2 :   substring.fromWkt( QStringLiteral( &quot;CompoundCurveZM( ( 5 0 -1 -2, 10 0 1 2 ), CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14))&quot; ) );</span></a>
<a name="12233"><span class="lineNum">   12233 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 0, 0 ) );</span></a>
<a name="12234"><span class="lineNum">   12234 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((5 0 -1 -2, 5 0 -1 -2))&quot; ) );</span></a>
<a name="12235"><span class="lineNum">   12235 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, -0.1 ) );</span></a>
<a name="12236"><span class="lineNum">   12236 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="12237"><span class="lineNum">   12237 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 100000, 10000 ) );</span></a>
<a name="12238"><span class="lineNum">   12238 </span>                :<span class="lineCov">          1 :   QVERIFY( substringResult-&gt;isEmpty() );</span></a>
<a name="12239"><span class="lineNum">   12239 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 1 ) );</span></a>
<a name="12240"><span class="lineNum">   12240 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((5 0 -1 -2, 6 0 -0.6 -1.2))&quot; ) );</span></a>
<a name="12241"><span class="lineNum">   12241 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, -1 ) );</span></a>
<a name="12242"><span class="lineNum">   12242 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((6 0 -0.6 -1.2, 6 0 -0.6 -1.2))&quot; ) );</span></a>
<a name="12243"><span class="lineNum">   12243 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( -1, 10000 ) );</span></a>
<a name="12244"><span class="lineNum">   12244 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((5 0 -1 -2, 10 0 1 2),CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14))&quot; ) );</span></a>
<a name="12245"><span class="lineNum">   12245 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 10000 ) );</span></a>
<a name="12246"><span class="lineNum">   12246 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((6 0 -0.6 -1.2, 10 0 1 2),CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14))&quot; ) );</span></a>
<a name="12247"><span class="lineNum">   12247 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 7 ) );</span></a>
<a name="12248"><span class="lineNum">   12248 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((6 0 -0.6 -1.2, 10 0 1 2),CircularStringZM (10 0 1 2, 10.46 0.84 2.27 3.27, 11.42 0.91 5.73 6.73))&quot; ) );</span></a>
<a name="12249"><span class="lineNum">   12249 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 1.5 ) );</span></a>
<a name="12250"><span class="lineNum">   12250 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZM ((6 0 -0.6 -1.2, 6.5 0 -0.4 -0.8))&quot; ) );</span></a>
<a name="12251"><span class="lineNum">   12251 </span>                :            : </a>
<a name="12252"><span class="lineNum">   12252 </span>                :<span class="lineCov">          2 :   substring.fromWkt( QStringLiteral( &quot;CompoundCurveZ( ( 5 0 -1, 10 0 1 ), CircularStringZ (10 0 1, 11 1 3, 12 0 13))&quot; ) );</span></a>
<a name="12253"><span class="lineNum">   12253 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 7 ) );</span></a>
<a name="12254"><span class="lineNum">   12254 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveZ ((6 0 -0.6, 10 0 1),CircularStringZ (10 0 1, 10.46 0.84 2.27, 11.42 0.91 5.73))&quot; ) );</span></a>
<a name="12255"><span class="lineNum">   12255 </span>                :<span class="lineCov">          2 :   substring.fromWkt( QStringLiteral( &quot;CompoundCurveM( ( 5 0 -1, 10 0 1 ), CircularStringM (10 0 1, 11 1 3, 12 0 13))&quot; ) );</span></a>
<a name="12256"><span class="lineNum">   12256 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 7 ) );</span></a>
<a name="12257"><span class="lineNum">   12257 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurveM ((6 0 -0.6, 10 0 1),CircularStringM (10 0 1, 10.46 0.84 2.27, 11.42 0.91 5.73))&quot; ) );</span></a>
<a name="12258"><span class="lineNum">   12258 </span>                :<span class="lineCov">          2 :   substring.fromWkt( QStringLiteral( &quot;CompoundCurve( ( 5 0, 10 0 ), CircularString (10 0, 11 1, 12 0))&quot; ) );</span></a>
<a name="12259"><span class="lineNum">   12259 </span>                :<span class="lineCov">          1 :   substringResult.reset( substring.curveSubstring( 1, 7 ) );</span></a>
<a name="12260"><span class="lineNum">   12260 </span>                :<span class="lineCov">          2 :   QCOMPARE( substringResult-&gt;asWkt( 2 ), QStringLiteral( &quot;CompoundCurve ((6 0, 10 0),CircularString (10 0, 10.46 0.84, 11.42 0.91))&quot; ) );</span></a>
<a name="12261"><span class="lineNum">   12261 </span>                :            : </a>
<a name="12262"><span class="lineNum">   12262 </span>                :            :   // substring</a>
<a name="12263"><span class="lineNum">   12263 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve interpolate;</span></a>
<a name="12264"><span class="lineNum">   12264 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsPoint &gt; interpolateResult( interpolate.interpolatePoint( 1 ) ); // no crash</span></a>
<a name="12265"><span class="lineNum">   12265 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="12266"><span class="lineNum">   12266 </span>                :<span class="lineCov">          2 :   interpolate.fromWkt( QStringLiteral( &quot;CompoundCurveZM( ( 5 0 -1 -2, 10 0 1 2 ), CircularStringZM (10 0 1 2, 11 1 3 4, 12 0 13 14))&quot; ) );</span></a>
<a name="12267"><span class="lineNum">   12267 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 0 ) );</span></a>
<a name="12268"><span class="lineNum">   12268 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (5 0 -1 -2)&quot; ) );</span></a>
<a name="12269"><span class="lineNum">   12269 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( -1 ) );</span></a>
<a name="12270"><span class="lineNum">   12270 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="12271"><span class="lineNum">   12271 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 100000 ) );</span></a>
<a name="12272"><span class="lineNum">   12272 </span>                :<span class="lineCov">          1 :   QVERIFY( !interpolateResult.get() );</span></a>
<a name="12273"><span class="lineNum">   12273 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="12274"><span class="lineNum">   12274 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (6 0 -0.6 -1.2)&quot; ) );</span></a>
<a name="12275"><span class="lineNum">   12275 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 7 ) );</span></a>
<a name="12276"><span class="lineNum">   12276 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (11.42 0.91 5.73 6.73)&quot; ) );</span></a>
<a name="12277"><span class="lineNum">   12277 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1.5 ) );</span></a>
<a name="12278"><span class="lineNum">   12278 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (6.5 0 -0.4 -0.8)&quot; ) );</span></a>
<a name="12279"><span class="lineNum">   12279 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( interpolate.length() ) );</span></a>
<a name="12280"><span class="lineNum">   12280 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZM (12 0 13 14)&quot; ) );</span></a>
<a name="12281"><span class="lineNum">   12281 </span>                :            : </a>
<a name="12282"><span class="lineNum">   12282 </span>                :<span class="lineCov">          2 :   interpolate.fromWkt( QStringLiteral( &quot;CompoundCurveZ( ( 5 0 -1, 10 0 1 ), CircularStringZ (10 0 1, 11 1 3, 12 0 13))&quot; ) );</span></a>
<a name="12283"><span class="lineNum">   12283 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="12284"><span class="lineNum">   12284 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointZ (6 0 -0.6)&quot; ) );</span></a>
<a name="12285"><span class="lineNum">   12285 </span>                :<span class="lineCov">          2 :   interpolate.fromWkt( QStringLiteral( &quot;CompoundCurveM( ( 5 0 -1, 10 0 1 ), CircularStringM (10 0 1, 11 1 3, 12 0 13))&quot; ) );</span></a>
<a name="12286"><span class="lineNum">   12286 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="12287"><span class="lineNum">   12287 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;PointM (6 0 -0.6)&quot; ) );</span></a>
<a name="12288"><span class="lineNum">   12288 </span>                :<span class="lineCov">          2 :   interpolate.fromWkt( QStringLiteral( &quot;CompoundCurve( ( 5 0, 10 0 ), CircularString (10 0, 11 1, 12 0))&quot; ) );</span></a>
<a name="12289"><span class="lineNum">   12289 </span>                :<span class="lineCov">          1 :   interpolateResult.reset( interpolate.interpolatePoint( 1 ) );</span></a>
<a name="12290"><span class="lineNum">   12290 </span>                :<span class="lineCov">          2 :   QCOMPARE( interpolateResult-&gt;asWkt( 2 ), QStringLiteral( &quot;Point (6 0)&quot; ) );</span></a>
<a name="12291"><span class="lineNum">   12291 </span>                :            : </a>
<a name="12292"><span class="lineNum">   12292 </span>                :            :   // orientation</a>
<a name="12293"><span class="lineNum">   12293 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve orientation;</span></a>
<a name="12294"><span class="lineNum">   12294 </span>                :<span class="lineCov">          1 :   ( void )orientation.orientation(); // no crash</span></a>
<a name="12295"><span class="lineNum">   12295 </span>                :<span class="lineCov">          2 :   orientation.fromWkt( QStringLiteral( &quot;CompoundCurve( ( 0 0, 0 1), CircularString (0 1, 1 1, 1 0), (1 0, 0 0))&quot; ) );</span></a>
<a name="12296"><span class="lineNum">   12296 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::Clockwise );</span></a>
<a name="12297"><span class="lineNum">   12297 </span>                :<span class="lineCov">          2 :   orientation.fromWkt( QStringLiteral( &quot;CompoundCurve( ( 0 0, 1 0), CircularString (1 0, 1 1, 0 1), (0 1, 0 0))&quot; ) );</span></a>
<a name="12298"><span class="lineNum">   12298 </span>                :<span class="lineCov">          1 :   QCOMPARE( orientation.orientation(), QgsCurve::CounterClockwise );</span></a>
<a name="12299"><span class="lineNum">   12299 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="12300"><span class="lineNum">   12300 </span>                :            : </a>
<a name="12301"><span class="lineNum">   12301 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::multiPoint()</span></a>
<a name="12302"><span class="lineNum">   12302 </span>                :            : {</a>
<a name="12303"><span class="lineNum">   12303 </span>                :            :   //test constructor</a>
<a name="12304"><span class="lineNum">   12304 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c1;</span></a>
<a name="12305"><span class="lineNum">   12305 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12306"><span class="lineNum">   12306 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12307"><span class="lineNum">   12307 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12308"><span class="lineNum">   12308 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12309"><span class="lineNum">   12309 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="12310"><span class="lineNum">   12310 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="12311"><span class="lineNum">   12311 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12312"><span class="lineNum">   12312 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiPoint&quot; ) );</span></a>
<a name="12313"><span class="lineNum">   12313 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiPoint&quot; ) );</span></a>
<a name="12314"><span class="lineNum">   12314 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="12315"><span class="lineNum">   12315 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="12316"><span class="lineNum">   12316 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="12317"><span class="lineNum">   12317 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="12318"><span class="lineNum">   12318 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12319"><span class="lineNum">   12319 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12320"><span class="lineNum">   12320 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12321"><span class="lineNum">   12321 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="12322"><span class="lineNum">   12322 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="12323"><span class="lineNum">   12323 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="12324"><span class="lineNum">   12324 </span>                :            : </a>
<a name="12325"><span class="lineNum">   12325 </span>                :            :   //addGeometry</a>
<a name="12326"><span class="lineNum">   12326 </span>                :            : </a>
<a name="12327"><span class="lineNum">   12327 </span>                :            :   //try with nullptr</a>
<a name="12328"><span class="lineNum">   12328 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="12329"><span class="lineNum">   12329 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12330"><span class="lineNum">   12330 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12331"><span class="lineNum">   12331 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12332"><span class="lineNum">   12332 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12333"><span class="lineNum">   12333 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12334"><span class="lineNum">   12334 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12335"><span class="lineNum">   12335 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12336"><span class="lineNum">   12336 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12337"><span class="lineNum">   12337 </span>                :            : </a>
<a name="12338"><span class="lineNum">   12338 </span>                :            :   // not a point</a>
<a name="12339"><span class="lineNum">   12339 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.addGeometry( new QgsLineString() ) );</span></a>
<a name="12340"><span class="lineNum">   12340 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12341"><span class="lineNum">   12341 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12342"><span class="lineNum">   12342 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12343"><span class="lineNum">   12343 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12344"><span class="lineNum">   12344 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12345"><span class="lineNum">   12345 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12346"><span class="lineNum">   12346 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12347"><span class="lineNum">   12347 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12348"><span class="lineNum">   12348 </span>                :            : </a>
<a name="12349"><span class="lineNum">   12349 </span>                :            :   //valid geometry</a>
<a name="12350"><span class="lineNum">   12350 </span>                :<span class="lineCov">          1 :   QgsPoint part( 1, 10 );</span></a>
<a name="12351"><span class="lineNum">   12351 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="12352"><span class="lineNum">   12352 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="12353"><span class="lineNum">   12353 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="12354"><span class="lineNum">   12354 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 1 );</span></a>
<a name="12355"><span class="lineNum">   12355 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="12356"><span class="lineNum">   12356 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="12357"><span class="lineNum">   12357 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="12358"><span class="lineNum">   12358 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="12359"><span class="lineNum">   12359 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12360"><span class="lineNum">   12360 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiPoint&quot; ) );</span></a>
<a name="12361"><span class="lineNum">   12361 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiPoint&quot; ) );</span></a>
<a name="12362"><span class="lineNum">   12362 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="12363"><span class="lineNum">   12363 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="12364"><span class="lineNum">   12364 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="12365"><span class="lineNum">   12365 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="12366"><span class="lineNum">   12366 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="12367"><span class="lineNum">   12367 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c1.geometryN( 0 ) ), part );</span></a>
<a name="12368"><span class="lineNum">   12368 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="12369"><span class="lineNum">   12369 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12370"><span class="lineNum">   12370 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 1 );</span></a>
<a name="12371"><span class="lineNum">   12371 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="12372"><span class="lineNum">   12372 </span>                :            : </a>
<a name="12373"><span class="lineNum">   12373 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="12374"><span class="lineNum">   12374 </span>                :<span class="lineCov">          1 :   part = QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 );</span></a>
<a name="12375"><span class="lineNum">   12375 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c2;</span></a>
<a name="12376"><span class="lineNum">   12376 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="12377"><span class="lineNum">   12377 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="12378"><span class="lineNum">   12378 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="12379"><span class="lineNum">   12379 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="12380"><span class="lineNum">   12380 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;MultiPointZ&quot; ) );</span></a>
<a name="12381"><span class="lineNum">   12381 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;MultiPoint&quot; ) );</span></a>
<a name="12382"><span class="lineNum">   12382 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="12383"><span class="lineNum">   12383 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c3;</span></a>
<a name="12384"><span class="lineNum">   12384 </span>                :<span class="lineCov">          1 :   part = QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 );</span></a>
<a name="12385"><span class="lineNum">   12385 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="12386"><span class="lineNum">   12386 </span>                :<span class="lineCov">          1 :   QVERIFY( !c3.is3D() );</span></a>
<a name="12387"><span class="lineNum">   12387 </span>                :<span class="lineCov">          1 :   QVERIFY( c3.isMeasure() );</span></a>
<a name="12388"><span class="lineNum">   12388 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="12389"><span class="lineNum">   12389 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;MultiPointM&quot; ) );</span></a>
<a name="12390"><span class="lineNum">   12390 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="12391"><span class="lineNum">   12391 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c4;</span></a>
<a name="12392"><span class="lineNum">   12392 </span>                :<span class="lineCov">          1 :   part = QgsPoint( QgsWkbTypes::PointZM, 10, 10, 5, 3 );</span></a>
<a name="12393"><span class="lineNum">   12393 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="12394"><span class="lineNum">   12394 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.is3D() );</span></a>
<a name="12395"><span class="lineNum">   12395 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="12396"><span class="lineNum">   12396 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12397"><span class="lineNum">   12397 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;MultiPointZM&quot; ) );</span></a>
<a name="12398"><span class="lineNum">   12398 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="12399"><span class="lineNum">   12399 </span>                :            : </a>
<a name="12400"><span class="lineNum">   12400 </span>                :            :   //add another part</a>
<a name="12401"><span class="lineNum">   12401 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c6;</span></a>
<a name="12402"><span class="lineNum">   12402 </span>                :<span class="lineCov">          1 :   part = QgsPoint( 10, 11 );</span></a>
<a name="12403"><span class="lineNum">   12403 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12404"><span class="lineNum">   12404 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 1 );</span></a>
<a name="12405"><span class="lineNum">   12405 </span>                :<span class="lineCov">          1 :   part = QgsPoint( 9, 1 );</span></a>
<a name="12406"><span class="lineNum">   12406 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12407"><span class="lineNum">   12407 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 1 );</span></a>
<a name="12408"><span class="lineNum">   12408 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="12409"><span class="lineNum">   12409 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="12410"><span class="lineNum">   12410 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="12411"><span class="lineNum">   12411 </span>                :            : </a>
<a name="12412"><span class="lineNum">   12412 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence seq = c6.coordinateSequence();</span></a>
<a name="12413"><span class="lineNum">   12413 </span>                :<span class="lineCov">          1 :   QCOMPARE( seq, QgsCoordinateSequence() &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 10, 11 ) ) )</span></a>
<a name="12414"><span class="lineNum">   12414 </span>                :            :             &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 9, 1 ) ) ) );</a>
<a name="12415"><span class="lineNum">   12415 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 2 );</span></a>
<a name="12416"><span class="lineNum">   12416 </span>                :            : </a>
<a name="12417"><span class="lineNum">   12417 </span>                :            :   //adding subsequent points should not alter z/m type, regardless of points type</a>
<a name="12418"><span class="lineNum">   12418 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12419"><span class="lineNum">   12419 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12420"><span class="lineNum">   12420 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12421"><span class="lineNum">   12421 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3 ) );</span></a>
<a name="12422"><span class="lineNum">   12422 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12423"><span class="lineNum">   12423 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 1 );</span></a>
<a name="12424"><span class="lineNum">   12424 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 1 );</span></a>
<a name="12425"><span class="lineNum">   12425 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 0 );</span></a>
<a name="12426"><span class="lineNum">   12426 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( -1, 0 ), 0 );</span></a>
<a name="12427"><span class="lineNum">   12427 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 2 );</span></a>
<a name="12428"><span class="lineNum">   12428 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="12429"><span class="lineNum">   12429 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 2 );</span></a>
<a name="12430"><span class="lineNum">   12430 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPoint ); //should still be 2d</span></a>
<a name="12431"><span class="lineNum">   12431 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="12432"><span class="lineNum">   12432 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 1 ) ) ), QgsPoint( 1, 2 ) );</span></a>
<a name="12433"><span class="lineNum">   12433 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 11.0, 12.0, 0, 3 ) );</span></a>
<a name="12434"><span class="lineNum">   12434 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12435"><span class="lineNum">   12435 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 1 );</span></a>
<a name="12436"><span class="lineNum">   12436 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 1 );</span></a>
<a name="12437"><span class="lineNum">   12437 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 1 );</span></a>
<a name="12438"><span class="lineNum">   12438 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 3 );</span></a>
<a name="12439"><span class="lineNum">   12439 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="12440"><span class="lineNum">   12440 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 3 );</span></a>
<a name="12441"><span class="lineNum">   12441 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPoint ); //should still be 2d</span></a>
<a name="12442"><span class="lineNum">   12442 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="12443"><span class="lineNum">   12443 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="12444"><span class="lineNum">   12444 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 2 ) ) ), QgsPoint( 11, 12 ) );</span></a>
<a name="12445"><span class="lineNum">   12445 </span>                :            : </a>
<a name="12446"><span class="lineNum">   12446 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12447"><span class="lineNum">   12447 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 1.0, 2.0, 3 ) );</span></a>
<a name="12448"><span class="lineNum">   12448 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="12449"><span class="lineNum">   12449 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) );</span></a>
<a name="12450"><span class="lineNum">   12450 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="12451"><span class="lineNum">   12451 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12452"><span class="lineNum">   12452 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 0 ) ) ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="12453"><span class="lineNum">   12453 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 1 ) ) ), QgsPoint( QgsWkbTypes::PointZ, 11, 12, 0 ) );</span></a>
<a name="12454"><span class="lineNum">   12454 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 21.0, 22.0, 0, 3 ) );</span></a>
<a name="12455"><span class="lineNum">   12455 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="12456"><span class="lineNum">   12456 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12457"><span class="lineNum">   12457 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="12458"><span class="lineNum">   12458 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 2 ) ) ), QgsPoint( QgsWkbTypes::PointZ, 21, 22, 0 ) );</span></a>
<a name="12459"><span class="lineNum">   12459 </span>                :            : </a>
<a name="12460"><span class="lineNum">   12460 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12461"><span class="lineNum">   12461 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 1.0, 2.0, 0, 3 ) );</span></a>
<a name="12462"><span class="lineNum">   12462 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="12463"><span class="lineNum">   12463 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) );</span></a>
<a name="12464"><span class="lineNum">   12464 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="12465"><span class="lineNum">   12465 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12466"><span class="lineNum">   12466 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 0 ) ) ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 3 ) );</span></a>
<a name="12467"><span class="lineNum">   12467 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 1 ) ) ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="12468"><span class="lineNum">   12468 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 21.0, 22.0, 3 ) );</span></a>
<a name="12469"><span class="lineNum">   12469 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="12470"><span class="lineNum">   12470 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="12471"><span class="lineNum">   12471 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12472"><span class="lineNum">   12472 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 2 ) ) ), QgsPoint( QgsWkbTypes::PointM, 21, 22, 0, 0 ) );</span></a>
<a name="12473"><span class="lineNum">   12473 </span>                :            : </a>
<a name="12474"><span class="lineNum">   12474 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12475"><span class="lineNum">   12475 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 1.0, 2.0, 4, 3 ) );</span></a>
<a name="12476"><span class="lineNum">   12476 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12477"><span class="lineNum">   12477 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::Point, 11.0, 12.0 ) );</span></a>
<a name="12478"><span class="lineNum">   12478 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12479"><span class="lineNum">   12479 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12480"><span class="lineNum">   12480 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12481"><span class="lineNum">   12481 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 0 ) ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 4, 3 ) );</span></a>
<a name="12482"><span class="lineNum">   12482 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 1 ) ) ), QgsPoint( QgsWkbTypes::PointZM, 11, 12, 0, 0 ) );</span></a>
<a name="12483"><span class="lineNum">   12483 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 21.0, 22.0, 3 ) );</span></a>
<a name="12484"><span class="lineNum">   12484 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12485"><span class="lineNum">   12485 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12486"><span class="lineNum">   12486 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12487"><span class="lineNum">   12487 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 2 ) ) ), QgsPoint( QgsWkbTypes::PointZM, 21, 22, 3, 0 ) );</span></a>
<a name="12488"><span class="lineNum">   12488 </span>                :<span class="lineCov">          1 :   c6.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 31.0, 32.0, 0, 4 ) );</span></a>
<a name="12489"><span class="lineNum">   12489 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12490"><span class="lineNum">   12490 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12491"><span class="lineNum">   12491 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12492"><span class="lineNum">   12492 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPoint * &gt;( c6.geometryN( 3 ) ) ), QgsPoint( QgsWkbTypes::PointZM, 31, 32, 0, 4 ) );</span></a>
<a name="12493"><span class="lineNum">   12493 </span>                :            : </a>
<a name="12494"><span class="lineNum">   12494 </span>                :            :   //clear</a>
<a name="12495"><span class="lineNum">   12495 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c7;</span></a>
<a name="12496"><span class="lineNum">   12496 </span>                :<span class="lineCov">          1 :   c7.addGeometry( new  QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) );</span></a>
<a name="12497"><span class="lineNum">   12497 </span>                :<span class="lineCov">          1 :   c7.addGeometry( new  QgsPoint( QgsWkbTypes::PointZ, 11, 12, 3 ) );</span></a>
<a name="12498"><span class="lineNum">   12498 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="12499"><span class="lineNum">   12499 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="12500"><span class="lineNum">   12500 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="12501"><span class="lineNum">   12501 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="12502"><span class="lineNum">   12502 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="12503"><span class="lineNum">   12503 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="12504"><span class="lineNum">   12504 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="12505"><span class="lineNum">   12505 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="12506"><span class="lineNum">   12506 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="12507"><span class="lineNum">   12507 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12508"><span class="lineNum">   12508 </span>                :            : </a>
<a name="12509"><span class="lineNum">   12509 </span>                :            :   //clone</a>
<a name="12510"><span class="lineNum">   12510 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c11;</span></a>
<a name="12511"><span class="lineNum">   12511 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiPoint &gt;cloned( c11.clone() );</span></a>
<a name="12512"><span class="lineNum">   12512 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="12513"><span class="lineNum">   12513 </span>                :<span class="lineCov">          1 :   c11.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 ) );</span></a>
<a name="12514"><span class="lineNum">   12514 </span>                :<span class="lineCov">          1 :   c11.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="12515"><span class="lineNum">   12515 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="12516"><span class="lineNum">   12516 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="12517"><span class="lineNum">   12517 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( cloned-&gt;geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 ) );</span></a>
<a name="12518"><span class="lineNum">   12518 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( cloned-&gt;geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="12519"><span class="lineNum">   12519 </span>                :            : </a>
<a name="12520"><span class="lineNum">   12520 </span>                :            :   //copy constructor</a>
<a name="12521"><span class="lineNum">   12521 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c12;</span></a>
<a name="12522"><span class="lineNum">   12522 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c13( c12 );</span></a>
<a name="12523"><span class="lineNum">   12523 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="12524"><span class="lineNum">   12524 </span>                :<span class="lineCov">          1 :   c12.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12525"><span class="lineNum">   12525 </span>                :<span class="lineCov">          1 :   c12.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 20, 10, 14, 18 ) );</span></a>
<a name="12526"><span class="lineNum">   12526 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c14( c12 );</span></a>
<a name="12527"><span class="lineNum">   12527 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="12528"><span class="lineNum">   12528 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12529"><span class="lineNum">   12529 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c14.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12530"><span class="lineNum">   12530 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c14.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 20, 10, 14, 18 ) );</span></a>
<a name="12531"><span class="lineNum">   12531 </span>                :            : </a>
<a name="12532"><span class="lineNum">   12532 </span>                :            :   //assignment operator</a>
<a name="12533"><span class="lineNum">   12533 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c15;</span></a>
<a name="12534"><span class="lineNum">   12534 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="12535"><span class="lineNum">   12535 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="12536"><span class="lineNum">   12536 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="12537"><span class="lineNum">   12537 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="12538"><span class="lineNum">   12538 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c15.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12539"><span class="lineNum">   12539 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c15.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 20, 10, 14, 18 ) );</span></a>
<a name="12540"><span class="lineNum">   12540 </span>                :            : </a>
<a name="12541"><span class="lineNum">   12541 </span>                :            :   //toCurveType</a>
<a name="12542"><span class="lineNum">   12542 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiPoint &gt; curveType( c12.toCurveType() );</span></a>
<a name="12543"><span class="lineNum">   12543 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12544"><span class="lineNum">   12544 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="12545"><span class="lineNum">   12545 </span>                :<span class="lineCov">          1 :   const QgsPoint *curve = static_cast&lt; const QgsPoint * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="12546"><span class="lineNum">   12546 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12547"><span class="lineNum">   12547 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsPoint * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="12548"><span class="lineNum">   12548 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, QgsPoint( QgsWkbTypes::PointZM, 20, 10, 14, 18 ) );</span></a>
<a name="12549"><span class="lineNum">   12549 </span>                :            : </a>
<a name="12550"><span class="lineNum">   12550 </span>                :            :   //to/fromWKB</a>
<a name="12551"><span class="lineNum">   12551 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c16;</span></a>
<a name="12552"><span class="lineNum">   12552 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::Point, 10, 11 ) );</span></a>
<a name="12553"><span class="lineNum">   12553 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::Point, 20, 21 ) );</span></a>
<a name="12554"><span class="lineNum">   12554 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="12555"><span class="lineNum">   12555 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c17;</span></a>
<a name="12556"><span class="lineNum">   12556 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="12557"><span class="lineNum">   12557 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="12558"><span class="lineNum">   12558 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="12559"><span class="lineNum">   12559 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::Point, 10, 11 ) );</span></a>
<a name="12560"><span class="lineNum">   12560 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::Point, 20, 21 ) );</span></a>
<a name="12561"><span class="lineNum">   12561 </span>                :            : </a>
<a name="12562"><span class="lineNum">   12562 </span>                :            :   //parts with Z</a>
<a name="12563"><span class="lineNum">   12563 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="12564"><span class="lineNum">   12564 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="12565"><span class="lineNum">   12565 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) );</span></a>
<a name="12566"><span class="lineNum">   12566 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) );</span></a>
<a name="12567"><span class="lineNum">   12567 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="12568"><span class="lineNum">   12568 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="12569"><span class="lineNum">   12569 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="12570"><span class="lineNum">   12570 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="12571"><span class="lineNum">   12571 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="12572"><span class="lineNum">   12572 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) );</span></a>
<a name="12573"><span class="lineNum">   12573 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) );</span></a>
<a name="12574"><span class="lineNum">   12574 </span>                :            : </a>
<a name="12575"><span class="lineNum">   12575 </span>                :            :   //parts with m</a>
<a name="12576"><span class="lineNum">   12576 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="12577"><span class="lineNum">   12577 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="12578"><span class="lineNum">   12578 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) );</span></a>
<a name="12579"><span class="lineNum">   12579 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointM, 9, 1, 0, 4 ) );</span></a>
<a name="12580"><span class="lineNum">   12580 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="12581"><span class="lineNum">   12581 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="12582"><span class="lineNum">   12582 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="12583"><span class="lineNum">   12583 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="12584"><span class="lineNum">   12584 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="12585"><span class="lineNum">   12585 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) );</span></a>
<a name="12586"><span class="lineNum">   12586 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointM, 9, 1, 0, 4 ) );</span></a>
<a name="12587"><span class="lineNum">   12587 </span>                :            : </a>
<a name="12588"><span class="lineNum">   12588 </span>                :            :   // parts with ZM</a>
<a name="12589"><span class="lineNum">   12589 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="12590"><span class="lineNum">   12590 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="12591"><span class="lineNum">   12591 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 70, 4 ) );</span></a>
<a name="12592"><span class="lineNum">   12592 </span>                :<span class="lineCov">          1 :   c16.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 9, 1, 3, 4 ) );</span></a>
<a name="12593"><span class="lineNum">   12593 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="12594"><span class="lineNum">   12594 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="12595"><span class="lineNum">   12595 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="12596"><span class="lineNum">   12596 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="12597"><span class="lineNum">   12597 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="12598"><span class="lineNum">   12598 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 70, 4 ) );</span></a>
<a name="12599"><span class="lineNum">   12599 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c17.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 1, 3, 4 ) );</span></a>
<a name="12600"><span class="lineNum">   12600 </span>                :            : </a>
<a name="12601"><span class="lineNum">   12601 </span>                :            :   //bad WKB - check for no crash</a>
<a name="12602"><span class="lineNum">   12602 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="12603"><span class="lineNum">   12603 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="12604"><span class="lineNum">   12604 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="12605"><span class="lineNum">   12605 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12606"><span class="lineNum">   12606 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="12607"><span class="lineNum">   12607 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="12608"><span class="lineNum">   12608 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="12609"><span class="lineNum">   12609 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="12610"><span class="lineNum">   12610 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12611"><span class="lineNum">   12611 </span>                :            : </a>
<a name="12612"><span class="lineNum">   12612 </span>                :            :   //to/from WKT</a>
<a name="12613"><span class="lineNum">   12613 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c18;</span></a>
<a name="12614"><span class="lineNum">   12614 </span>                :<span class="lineCov">          1 :   c18.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12615"><span class="lineNum">   12615 </span>                :<span class="lineCov">          1 :   c18.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="12616"><span class="lineNum">   12616 </span>                :            : </a>
<a name="12617"><span class="lineNum">   12617 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="12618"><span class="lineNum">   12618 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="12619"><span class="lineNum">   12619 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c19;</span></a>
<a name="12620"><span class="lineNum">   12620 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="12621"><span class="lineNum">   12621 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="12622"><span class="lineNum">   12622 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c19.geometryN( 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12623"><span class="lineNum">   12623 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPoint * &gt;( c19.geometryN( 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="12624"><span class="lineNum">   12624 </span>                :            : </a>
<a name="12625"><span class="lineNum">   12625 </span>                :            :   //bad WKT</a>
<a name="12626"><span class="lineNum">   12626 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c20;</span></a>
<a name="12627"><span class="lineNum">   12627 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="12628"><span class="lineNum">   12628 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="12629"><span class="lineNum">   12629 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="12630"><span class="lineNum">   12630 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="12631"><span class="lineNum">   12631 </span>                :            : </a>
<a name="12632"><span class="lineNum">   12632 </span>                :            :   //as JSON</a>
<a name="12633"><span class="lineNum">   12633 </span>                :<span class="lineCov">          1 :   QgsMultiPoint exportC;</span></a>
<a name="12634"><span class="lineNum">   12634 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( new QgsPoint( QgsWkbTypes::Point, 0, 10 ) );</span></a>
<a name="12635"><span class="lineNum">   12635 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( new QgsPoint( QgsWkbTypes::Point, 10, 0 ) );</span></a>
<a name="12636"><span class="lineNum">   12636 </span>                :            : </a>
<a name="12637"><span class="lineNum">   12637 </span>                :            :   // GML document for compare</a>
<a name="12638"><span class="lineNum">   12638 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="12639"><span class="lineNum">   12639 </span>                :            : </a>
<a name="12640"><span class="lineNum">   12640 </span>                :            :   // as GML2</a>
<a name="12641"><span class="lineNum">   12641 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,10&lt;/coordinates&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;10,0&lt;/coordinates&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;/MultiPoint&gt;&quot; ) );</span></a>
<a name="12642"><span class="lineNum">   12642 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc ) );</span></a>
<a name="12643"><span class="lineNum">   12643 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="12644"><span class="lineNum">   12644 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="12645"><span class="lineNum">   12645 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiPoint().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="12646"><span class="lineNum">   12646 </span>                :            : </a>
<a name="12647"><span class="lineNum">   12647 </span>                :            :   //as GML3</a>
<a name="12648"><span class="lineNum">   12648 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0 10&lt;/pos&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;10 0&lt;/pos&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;/MultiPoint&gt;&quot; ) );</span></a>
<a name="12649"><span class="lineNum">   12649 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="12650"><span class="lineNum">   12650 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="12651"><span class="lineNum">   12651 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="12652"><span class="lineNum">   12652 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiPoint().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="12653"><span class="lineNum">   12653 </span>                :            : </a>
<a name="12654"><span class="lineNum">   12654 </span>                :            :   // as JSON</a>
<a name="12655"><span class="lineNum">   12655 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[0.0,10.0],[10.0,0.0]],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="12656"><span class="lineNum">   12656 </span>                :<span class="lineCov">          1 :   res = exportC.asJson();</span></a>
<a name="12657"><span class="lineNum">   12657 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="12658"><span class="lineNum">   12658 </span>                :            : </a>
<a name="12659"><span class="lineNum">   12659 </span>                :<span class="lineCov">          1 :   QgsMultiPoint exportFloat;</span></a>
<a name="12660"><span class="lineNum">   12660 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( new QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 100 / 9.0 ) );</span></a>
<a name="12661"><span class="lineNum">   12661 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( new QgsPoint( QgsWkbTypes::Point, 4 / 3.0, 2 / 3.0 ) );</span></a>
<a name="12662"><span class="lineNum">   12662 </span>                :            : </a>
<a name="12663"><span class="lineNum">   12663 </span>                :            : </a>
<a name="12664"><span class="lineNum">   12664 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[1.111,11.111],[1.333,0.667]],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="12665"><span class="lineNum">   12665 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="12666"><span class="lineNum">   12666 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="12667"><span class="lineNum">   12667 </span>                :            : </a>
<a name="12668"><span class="lineNum">   12668 </span>                :            :   // as GML2</a>
<a name="12669"><span class="lineNum">   12669 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1.111,11.111&lt;/coordinates&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1.333,0.667&lt;/coordinates&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;/MultiPoint&gt;&quot; ) );</span></a>
<a name="12670"><span class="lineNum">   12670 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="12671"><span class="lineNum">   12671 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="12672"><span class="lineNum">   12672 </span>                :            : </a>
<a name="12673"><span class="lineNum">   12673 </span>                :            :   //as GML3</a>
<a name="12674"><span class="lineNum">   12674 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;MultiPoint xmlns=\&quot;gml\&quot;&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1.111 11.111&lt;/pos&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;pointMember xmlns=\&quot;gml\&quot;&gt;&lt;Point xmlns=\&quot;gml\&quot;&gt;&lt;pos xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1.333 0.667&lt;/pos&gt;&lt;/Point&gt;&lt;/pointMember&gt;&lt;/MultiPoint&gt;&quot; ) );</span></a>
<a name="12675"><span class="lineNum">   12675 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="12676"><span class="lineNum">   12676 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="12677"><span class="lineNum">   12677 </span>                :            : </a>
<a name="12678"><span class="lineNum">   12678 </span>                :            :   //asKML</a>
<a name="12679"><span class="lineNum">   12679 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;Point&gt;&lt;coordinates&gt;0,10&lt;/coordinates&gt;&lt;/Point&gt;&lt;Point&gt;&lt;coordinates&gt;10,0&lt;/coordinates&gt;&lt;/Point&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="12680"><span class="lineNum">   12680 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportC.asKml(), expectedKml );</span></a>
<a name="12681"><span class="lineNum">   12681 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;Point&gt;&lt;coordinates&gt;1.111,11.111&lt;/coordinates&gt;&lt;/Point&gt;&lt;Point&gt;&lt;coordinates&gt;1.333,0.667&lt;/coordinates&gt;&lt;/Point&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="12682"><span class="lineNum">   12682 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="12683"><span class="lineNum">   12683 </span>                :            : </a>
<a name="12684"><span class="lineNum">   12684 </span>                :            : </a>
<a name="12685"><span class="lineNum">   12685 </span>                :            :   // insert geometry</a>
<a name="12686"><span class="lineNum">   12686 </span>                :<span class="lineCov">          1 :   QgsMultiPoint rc;</span></a>
<a name="12687"><span class="lineNum">   12687 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="12688"><span class="lineNum">   12688 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="12689"><span class="lineNum">   12689 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="12690"><span class="lineNum">   12690 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="12691"><span class="lineNum">   12691 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="12692"><span class="lineNum">   12692 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="12693"><span class="lineNum">   12693 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="12694"><span class="lineNum">   12694 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="12695"><span class="lineNum">   12695 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="12696"><span class="lineNum">   12696 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="12697"><span class="lineNum">   12697 </span>                :            : </a>
<a name="12698"><span class="lineNum">   12698 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( new QgsLineString(), 0 );</span></a>
<a name="12699"><span class="lineNum">   12699 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="12700"><span class="lineNum">   12700 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="12701"><span class="lineNum">   12701 </span>                :            : </a>
<a name="12702"><span class="lineNum">   12702 </span>                :            :   // cast</a>
<a name="12703"><span class="lineNum">   12703 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsMultiPoint().cast( nullptr ) );</span></a>
<a name="12704"><span class="lineNum">   12704 </span>                :<span class="lineCov">          1 :   QgsMultiPoint pCast;</span></a>
<a name="12705"><span class="lineNum">   12705 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPoint().cast( &amp;pCast ) );</span></a>
<a name="12706"><span class="lineNum">   12706 </span>                :<span class="lineCov">          1 :   QgsMultiPoint pCast2;</span></a>
<a name="12707"><span class="lineNum">   12707 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPointZ(PointZ(0 1 1))&quot; ) );</span></a>
<a name="12708"><span class="lineNum">   12708 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPoint().cast( &amp;pCast2 ) );</span></a>
<a name="12709"><span class="lineNum">   12709 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPointM(PointM(0 1 1))&quot; ) );</span></a>
<a name="12710"><span class="lineNum">   12710 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPoint().cast( &amp;pCast2 ) );</span></a>
<a name="12711"><span class="lineNum">   12711 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPointZM(PointZM(0 1 1 2))&quot; ) );</span></a>
<a name="12712"><span class="lineNum">   12712 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPoint().cast( &amp;pCast2 ) );</span></a>
<a name="12713"><span class="lineNum">   12713 </span>                :            : </a>
<a name="12714"><span class="lineNum">   12714 </span>                :            :   // bounding box</a>
<a name="12715"><span class="lineNum">   12715 </span>                :<span class="lineCov">          1 :   QgsMultiPoint boundingBox;</span></a>
<a name="12716"><span class="lineNum">   12716 </span>                :<span class="lineCov">          1 :   boundingBox.addGeometry( new QgsPoint( 0, 0 ) );</span></a>
<a name="12717"><span class="lineNum">   12717 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox.boundingBox(), QgsRectangle( 0, 0, 0, 0 ) );</span></a>
<a name="12718"><span class="lineNum">   12718 </span>                :<span class="lineCov">          1 :   boundingBox.addGeometry( new QgsPoint( 1, 2 ) );</span></a>
<a name="12719"><span class="lineNum">   12719 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox.boundingBox(), QgsRectangle( 0, 0, 1, 2 ) );</span></a>
<a name="12720"><span class="lineNum">   12720 </span>                :<span class="lineCov">          1 :   QgsMultiPoint boundingBox2;</span></a>
<a name="12721"><span class="lineNum">   12721 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox2.boundingBox(), QgsRectangle( 0, 0, 0, 0 ) );</span></a>
<a name="12722"><span class="lineNum">   12722 </span>                :<span class="lineCov">          1 :   boundingBox2.addGeometry( new QgsPoint( 1, 2 ) );</span></a>
<a name="12723"><span class="lineNum">   12723 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox2.boundingBox(), QgsRectangle( 1, 2, 1, 2 ) );</span></a>
<a name="12724"><span class="lineNum">   12724 </span>                :<span class="lineCov">          1 :   boundingBox2.addGeometry( new QgsPoint( 10, 3 ) );</span></a>
<a name="12725"><span class="lineNum">   12725 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox2.boundingBox(), QgsRectangle( 1, 2, 10, 3 ) );</span></a>
<a name="12726"><span class="lineNum">   12726 </span>                :<span class="lineCov">          1 :   boundingBox2.addGeometry( new QgsPoint( 0, 0 ) );</span></a>
<a name="12727"><span class="lineNum">   12727 </span>                :<span class="lineCov">          1 :   QCOMPARE( boundingBox2.boundingBox(), QgsRectangle( 0, 0, 10, 3 ) );</span></a>
<a name="12728"><span class="lineNum">   12728 </span>                :            : </a>
<a name="12729"><span class="lineNum">   12729 </span>                :            :   //boundary</a>
<a name="12730"><span class="lineNum">   12730 </span>                :            : </a>
<a name="12731"><span class="lineNum">   12731 </span>                :            :   //multipoints have no boundary defined</a>
<a name="12732"><span class="lineNum">   12732 </span>                :<span class="lineCov">          1 :   QgsMultiPoint boundaryMP;</span></a>
<a name="12733"><span class="lineNum">   12733 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryMP.boundary() );</span></a>
<a name="12734"><span class="lineNum">   12734 </span>                :            :   // add some points and retest, should still be undefined</a>
<a name="12735"><span class="lineNum">   12735 </span>                :<span class="lineCov">          1 :   boundaryMP.addGeometry( new QgsPoint( 0, 0 ) );</span></a>
<a name="12736"><span class="lineNum">   12736 </span>                :<span class="lineCov">          1 :   boundaryMP.addGeometry( new QgsPoint( 1, 1 ) );</span></a>
<a name="12737"><span class="lineNum">   12737 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryMP.boundary() );</span></a>
<a name="12738"><span class="lineNum">   12738 </span>                :            : </a>
<a name="12739"><span class="lineNum">   12739 </span>                :            :   // closestSegment</a>
<a name="12740"><span class="lineNum">   12740 </span>                :<span class="lineCov">          1 :   QgsPoint closest;</span></a>
<a name="12741"><span class="lineNum">   12741 </span>                :<span class="lineCov">          1 :   QgsVertexId after;</span></a>
<a name="12742"><span class="lineNum">   12742 </span>                :            :   // return error - points have no segments</a>
<a name="12743"><span class="lineNum">   12743 </span>                :<span class="lineCov">          1 :   QVERIFY( boundaryMP.closestSegment( QgsPoint( 0.5, 0.5 ), closest, after ) &lt; 0 );</span></a>
<a name="12744"><span class="lineNum">   12744 </span>                :            : </a>
<a name="12745"><span class="lineNum">   12745 </span>                :            :   // vertex iterator</a>
<a name="12746"><span class="lineNum">   12746 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it = boundaryMP.vertices_begin();</span></a>
<a name="12747"><span class="lineNum">   12747 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator itEnd = boundaryMP.vertices_end();</span></a>
<a name="12748"><span class="lineNum">   12748 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 0, 0 ) );</span></a>
<a name="12749"><span class="lineNum">   12749 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="12750"><span class="lineNum">   12750 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="12751"><span class="lineNum">   12751 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 1, 1 ) );</span></a>
<a name="12752"><span class="lineNum">   12752 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="12753"><span class="lineNum">   12753 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="12754"><span class="lineNum">   12754 </span>                :<span class="lineCov">          1 :   QCOMPARE( it, itEnd );</span></a>
<a name="12755"><span class="lineNum">   12755 </span>                :            : </a>
<a name="12756"><span class="lineNum">   12756 </span>                :            :   // Java-style iterator</a>
<a name="12757"><span class="lineNum">   12757 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2( &amp;boundaryMP );</span></a>
<a name="12758"><span class="lineNum">   12758 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="12759"><span class="lineNum">   12759 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 0, 0 ) );</span></a>
<a name="12760"><span class="lineNum">   12760 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="12761"><span class="lineNum">   12761 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 1 ) );</span></a>
<a name="12762"><span class="lineNum">   12762 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="12763"><span class="lineNum">   12763 </span>                :            : </a>
<a name="12764"><span class="lineNum">   12764 </span>                :            :   //adjacent vertices - both should be invalid</a>
<a name="12765"><span class="lineNum">   12765 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c21;</span></a>
<a name="12766"><span class="lineNum">   12766 </span>                :<span class="lineCov">          1 :   c21.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12767"><span class="lineNum">   12767 </span>                :<span class="lineCov">          1 :   c21.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="12768"><span class="lineNum">   12768 </span>                :<span class="lineCov">          1 :   QgsVertexId prev( 1, 2, 3 ); // start with something</span></a>
<a name="12769"><span class="lineNum">   12769 </span>                :<span class="lineCov">          1 :   QgsVertexId next( 4, 5, 6 );</span></a>
<a name="12770"><span class="lineNum">   12770 </span>                :<span class="lineCov">          1 :   c21.adjacentVertices( QgsVertexId( 0, 0, 0 ), prev, next );</span></a>
<a name="12771"><span class="lineNum">   12771 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="12772"><span class="lineNum">   12772 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="12773"><span class="lineNum">   12773 </span>                :<span class="lineCov">          1 :   c21.adjacentVertices( QgsVertexId( 1, 0, 0 ), prev, next );</span></a>
<a name="12774"><span class="lineNum">   12774 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="12775"><span class="lineNum">   12775 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="12776"><span class="lineNum">   12776 </span>                :            : </a>
<a name="12777"><span class="lineNum">   12777 </span>                :            :   // vertex number</a>
<a name="12778"><span class="lineNum">   12778 </span>                :<span class="lineCov">          1 :   QgsMultiPoint c22;</span></a>
<a name="12779"><span class="lineNum">   12779 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="12780"><span class="lineNum">   12780 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), -1 );</span></a>
<a name="12781"><span class="lineNum">   12781 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="12782"><span class="lineNum">   12782 </span>                :<span class="lineCov">          1 :   c22.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12783"><span class="lineNum">   12783 </span>                :<span class="lineCov">          1 :   c22.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="12784"><span class="lineNum">   12784 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="12785"><span class="lineNum">   12785 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 2, 0, 0 ) ), -1 );</span></a>
<a name="12786"><span class="lineNum">   12786 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="12787"><span class="lineNum">   12787 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), -1 );</span></a>
<a name="12788"><span class="lineNum">   12788 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="12789"><span class="lineNum">   12789 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), 1 );</span></a>
<a name="12790"><span class="lineNum">   12790 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( 1, 0, 1 ) ), -1 );</span></a>
<a name="12791"><span class="lineNum">   12791 </span>                :<span class="lineCov">          1 :   QCOMPARE( c22.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="12792"><span class="lineNum">   12792 </span>                :            : </a>
<a name="12793"><span class="lineNum">   12793 </span>                :<span class="lineCov">          1 :   QgsMultiPoint mp;</span></a>
<a name="12794"><span class="lineNum">   12794 </span>                :            :   // multipoints should not be affected by removeDuplicatePoints</a>
<a name="12795"><span class="lineNum">   12795 </span>                :<span class="lineCov">          1 :   QVERIFY( !mp.removeDuplicateNodes() );</span></a>
<a name="12796"><span class="lineNum">   12796 </span>                :<span class="lineCov">          1 :   mp.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 1, 4, 8 ) );</span></a>
<a name="12797"><span class="lineNum">   12797 </span>                :<span class="lineCov">          1 :   mp.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 1, 4, 8 ) );</span></a>
<a name="12798"><span class="lineNum">   12798 </span>                :<span class="lineCov">          1 :   QVERIFY( !mp.removeDuplicateNodes() );</span></a>
<a name="12799"><span class="lineNum">   12799 </span>                :<span class="lineCov">          1 :   QCOMPARE( mp.numGeometries(), 2 );</span></a>
<a name="12800"><span class="lineNum">   12800 </span>                :            : </a>
<a name="12801"><span class="lineNum">   12801 </span>                :            :   // filter vertex</a>
<a name="12802"><span class="lineNum">   12802 </span>                :<span class="lineCov">          1 :   QgsMultiPoint filterPoint;</span></a>
<a name="12803"><span class="lineNum">   12803 </span>                :<span class="lineCov">          4 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="12804"><span class="lineNum">   12804 </span>                :            :   {</a>
<a name="12805"><span class="lineNum">   12805 </span>                :<span class="lineCov">          4 :     return point.x() &lt; 5;</span></a>
<a name="12806"><span class="lineNum">   12806 </span>                :            :   };</a>
<a name="12807"><span class="lineNum">   12807 </span>                :<span class="lineCov">          1 :   filterPoint.filterVertices( filter ); // no crash</span></a>
<a name="12808"><span class="lineNum">   12808 </span>                :<span class="lineCov">          1 :   filterPoint.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="12809"><span class="lineNum">   12809 </span>                :<span class="lineCov">          1 :   filterPoint.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 3, 0, 4, 8 ) );</span></a>
<a name="12810"><span class="lineNum">   12810 </span>                :<span class="lineCov">          1 :   filterPoint.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 1, 0, 4, 8 ) );</span></a>
<a name="12811"><span class="lineNum">   12811 </span>                :<span class="lineCov">          1 :   filterPoint.addGeometry( new QgsPoint( QgsWkbTypes::PointZM, 11, 0, 4, 8 ) );</span></a>
<a name="12812"><span class="lineNum">   12812 </span>                :<span class="lineCov">          1 :   filterPoint.filterVertices( filter );</span></a>
<a name="12813"><span class="lineNum">   12813 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterPoint.asWkt( 2 ), QStringLiteral( &quot;MultiPointZM ((3 0 4 8),(1 0 4 8))&quot; ) );</span></a>
<a name="12814"><span class="lineNum">   12814 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="12815"><span class="lineNum">   12815 </span>                :            : </a>
<a name="12816"><span class="lineNum">   12816 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::multiLineString()</span></a>
<a name="12817"><span class="lineNum">   12817 </span>                :            : {</a>
<a name="12818"><span class="lineNum">   12818 </span>                :            :   //test constructor</a>
<a name="12819"><span class="lineNum">   12819 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c1;</span></a>
<a name="12820"><span class="lineNum">   12820 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12821"><span class="lineNum">   12821 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12822"><span class="lineNum">   12822 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12823"><span class="lineNum">   12823 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12824"><span class="lineNum">   12824 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="12825"><span class="lineNum">   12825 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="12826"><span class="lineNum">   12826 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12827"><span class="lineNum">   12827 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiLineString&quot; ) );</span></a>
<a name="12828"><span class="lineNum">   12828 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiLineString&quot; ) );</span></a>
<a name="12829"><span class="lineNum">   12829 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="12830"><span class="lineNum">   12830 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="12831"><span class="lineNum">   12831 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="12832"><span class="lineNum">   12832 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="12833"><span class="lineNum">   12833 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12834"><span class="lineNum">   12834 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12835"><span class="lineNum">   12835 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12836"><span class="lineNum">   12836 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="12837"><span class="lineNum">   12837 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="12838"><span class="lineNum">   12838 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="12839"><span class="lineNum">   12839 </span>                :            : </a>
<a name="12840"><span class="lineNum">   12840 </span>                :            :   //addGeometry</a>
<a name="12841"><span class="lineNum">   12841 </span>                :            : </a>
<a name="12842"><span class="lineNum">   12842 </span>                :            :   //try with nullptr</a>
<a name="12843"><span class="lineNum">   12843 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="12844"><span class="lineNum">   12844 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12845"><span class="lineNum">   12845 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12846"><span class="lineNum">   12846 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12847"><span class="lineNum">   12847 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12848"><span class="lineNum">   12848 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12849"><span class="lineNum">   12849 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12850"><span class="lineNum">   12850 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12851"><span class="lineNum">   12851 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12852"><span class="lineNum">   12852 </span>                :            : </a>
<a name="12853"><span class="lineNum">   12853 </span>                :            :   // not a linestring</a>
<a name="12854"><span class="lineNum">   12854 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.addGeometry( new QgsPoint() ) );</span></a>
<a name="12855"><span class="lineNum">   12855 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="12856"><span class="lineNum">   12856 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="12857"><span class="lineNum">   12857 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="12858"><span class="lineNum">   12858 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="12859"><span class="lineNum">   12859 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="12860"><span class="lineNum">   12860 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12861"><span class="lineNum">   12861 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="12862"><span class="lineNum">   12862 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12863"><span class="lineNum">   12863 </span>                :            : </a>
<a name="12864"><span class="lineNum">   12864 </span>                :            :   //valid geometry</a>
<a name="12865"><span class="lineNum">   12865 </span>                :<span class="lineCov">          1 :   QgsLineString part;</span></a>
<a name="12866"><span class="lineNum">   12866 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) );</span></a>
<a name="12867"><span class="lineNum">   12867 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="12868"><span class="lineNum">   12868 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="12869"><span class="lineNum">   12869 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="12870"><span class="lineNum">   12870 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 2 );</span></a>
<a name="12871"><span class="lineNum">   12871 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="12872"><span class="lineNum">   12872 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="12873"><span class="lineNum">   12873 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="12874"><span class="lineNum">   12874 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="12875"><span class="lineNum">   12875 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12876"><span class="lineNum">   12876 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiLineString&quot; ) );</span></a>
<a name="12877"><span class="lineNum">   12877 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiLineString&quot; ) );</span></a>
<a name="12878"><span class="lineNum">   12878 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 1 );</span></a>
<a name="12879"><span class="lineNum">   12879 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="12880"><span class="lineNum">   12880 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="12881"><span class="lineNum">   12881 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="12882"><span class="lineNum">   12882 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="12883"><span class="lineNum">   12883 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c1.geometryN( 0 ) ), part );</span></a>
<a name="12884"><span class="lineNum">   12884 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="12885"><span class="lineNum">   12885 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="12886"><span class="lineNum">   12886 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 2 );</span></a>
<a name="12887"><span class="lineNum">   12887 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="12888"><span class="lineNum">   12888 </span>                :            : </a>
<a name="12889"><span class="lineNum">   12889 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="12890"><span class="lineNum">   12890 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 21, 2 ) );</span></a>
<a name="12891"><span class="lineNum">   12891 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c2;</span></a>
<a name="12892"><span class="lineNum">   12892 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="12893"><span class="lineNum">   12893 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="12894"><span class="lineNum">   12894 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="12895"><span class="lineNum">   12895 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="12896"><span class="lineNum">   12896 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;MultiLineStringZ&quot; ) );</span></a>
<a name="12897"><span class="lineNum">   12897 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;MultiLineString&quot; ) );</span></a>
<a name="12898"><span class="lineNum">   12898 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="12899"><span class="lineNum">   12899 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c3;</span></a>
<a name="12900"><span class="lineNum">   12900 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 20, 21, 0, 2 ) );</span></a>
<a name="12901"><span class="lineNum">   12901 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="12902"><span class="lineNum">   12902 </span>                :<span class="lineCov">          1 :   QVERIFY( !c3.is3D() );</span></a>
<a name="12903"><span class="lineNum">   12903 </span>                :<span class="lineCov">          1 :   QVERIFY( c3.isMeasure() );</span></a>
<a name="12904"><span class="lineNum">   12904 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::MultiLineStringM );</span></a>
<a name="12905"><span class="lineNum">   12905 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;MultiLineStringM&quot; ) );</span></a>
<a name="12906"><span class="lineNum">   12906 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="12907"><span class="lineNum">   12907 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c4;</span></a>
<a name="12908"><span class="lineNum">   12908 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 20, 21, 3, 2 ) );</span></a>
<a name="12909"><span class="lineNum">   12909 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="12910"><span class="lineNum">   12910 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.is3D() );</span></a>
<a name="12911"><span class="lineNum">   12911 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="12912"><span class="lineNum">   12912 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="12913"><span class="lineNum">   12913 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;MultiLineStringZM&quot; ) );</span></a>
<a name="12914"><span class="lineNum">   12914 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="12915"><span class="lineNum">   12915 </span>                :            : </a>
<a name="12916"><span class="lineNum">   12916 </span>                :            :   //add another part</a>
<a name="12917"><span class="lineNum">   12917 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c6;</span></a>
<a name="12918"><span class="lineNum">   12918 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) );</span></a>
<a name="12919"><span class="lineNum">   12919 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12920"><span class="lineNum">   12920 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 2 );</span></a>
<a name="12921"><span class="lineNum">   12921 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 9, 12 ) &lt;&lt; QgsPoint( 3, 13 ) );</span></a>
<a name="12922"><span class="lineNum">   12922 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12923"><span class="lineNum">   12923 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 2 );</span></a>
<a name="12924"><span class="lineNum">   12924 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="12925"><span class="lineNum">   12925 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="12926"><span class="lineNum">   12926 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="12927"><span class="lineNum">   12927 </span>                :            : </a>
<a name="12928"><span class="lineNum">   12928 </span>                :            :   //adding subsequent points should not alter z/m type, regardless of points type</a>
<a name="12929"><span class="lineNum">   12929 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12930"><span class="lineNum">   12930 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12931"><span class="lineNum">   12931 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12932"><span class="lineNum">   12932 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) ) ;</span></a>
<a name="12933"><span class="lineNum">   12933 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12934"><span class="lineNum">   12934 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12935"><span class="lineNum">   12935 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 2 );</span></a>
<a name="12936"><span class="lineNum">   12936 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 2 );</span></a>
<a name="12937"><span class="lineNum">   12937 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 0 );</span></a>
<a name="12938"><span class="lineNum">   12938 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( -1, 0 ), 0 );</span></a>
<a name="12939"><span class="lineNum">   12939 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 4 );</span></a>
<a name="12940"><span class="lineNum">   12940 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="12941"><span class="lineNum">   12941 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 2 );</span></a>
<a name="12942"><span class="lineNum">   12942 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="12943"><span class="lineNum">   12943 </span>                :<span class="lineCov">          1 :   const QgsLineString *ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="12944"><span class="lineNum">   12944 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 9, 12 ) );</span></a>
<a name="12945"><span class="lineNum">   12945 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 3, 13 ) );</span></a>
<a name="12946"><span class="lineNum">   12946 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="12947"><span class="lineNum">   12947 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 1, 10 ) );</span></a>
<a name="12948"><span class="lineNum">   12948 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 2, 11 ) );</span></a>
<a name="12949"><span class="lineNum">   12949 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 32, 41, 0, 3 ) ) ;</span></a>
<a name="12950"><span class="lineNum">   12950 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12951"><span class="lineNum">   12951 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12952"><span class="lineNum">   12952 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 2 );</span></a>
<a name="12953"><span class="lineNum">   12953 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 2 );</span></a>
<a name="12954"><span class="lineNum">   12954 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 2 );</span></a>
<a name="12955"><span class="lineNum">   12955 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 6 );</span></a>
<a name="12956"><span class="lineNum">   12956 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="12957"><span class="lineNum">   12957 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 3 );</span></a>
<a name="12958"><span class="lineNum">   12958 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="12959"><span class="lineNum">   12959 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="12960"><span class="lineNum">   12960 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="12961"><span class="lineNum">   12961 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 21, 30 ) );</span></a>
<a name="12962"><span class="lineNum">   12962 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 32, 41 ) );</span></a>
<a name="12963"><span class="lineNum">   12963 </span>                :            : </a>
<a name="12964"><span class="lineNum">   12964 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12965"><span class="lineNum">   12965 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) ) ;</span></a>
<a name="12966"><span class="lineNum">   12966 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12967"><span class="lineNum">   12967 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="12968"><span class="lineNum">   12968 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 ) ) ;</span></a>
<a name="12969"><span class="lineNum">   12969 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12970"><span class="lineNum">   12970 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="12971"><span class="lineNum">   12971 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12972"><span class="lineNum">   12972 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="12973"><span class="lineNum">   12973 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="12974"><span class="lineNum">   12974 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 2, 11, 3 ) );</span></a>
<a name="12975"><span class="lineNum">   12975 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="12976"><span class="lineNum">   12976 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="12977"><span class="lineNum">   12977 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 3, 31, 0 ) );</span></a>
<a name="12978"><span class="lineNum">   12978 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) ) ;</span></a>
<a name="12979"><span class="lineNum">   12979 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12980"><span class="lineNum">   12980 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="12981"><span class="lineNum">   12981 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="12982"><span class="lineNum">   12982 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="12983"><span class="lineNum">   12983 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="12984"><span class="lineNum">   12984 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="12985"><span class="lineNum">   12985 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 6, 61, 0 ) );</span></a>
<a name="12986"><span class="lineNum">   12986 </span>                :            : </a>
<a name="12987"><span class="lineNum">   12987 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="12988"><span class="lineNum">   12988 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="12989"><span class="lineNum">   12989 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) ) ;</span></a>
<a name="12990"><span class="lineNum">   12990 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12991"><span class="lineNum">   12991 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringM );</span></a>
<a name="12992"><span class="lineNum">   12992 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 ) ) ;</span></a>
<a name="12993"><span class="lineNum">   12993 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="12994"><span class="lineNum">   12994 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringM );</span></a>
<a name="12995"><span class="lineNum">   12995 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="12996"><span class="lineNum">   12996 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="12997"><span class="lineNum">   12997 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="12998"><span class="lineNum">   12998 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) );</span></a>
<a name="12999"><span class="lineNum">   12999 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13000"><span class="lineNum">   13000 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="13001"><span class="lineNum">   13001 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 3, 31, 0, 0 ) );</span></a>
<a name="13002"><span class="lineNum">   13002 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 14, 15, 16 ) ) ;</span></a>
<a name="13003"><span class="lineNum">   13003 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13004"><span class="lineNum">   13004 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringM );</span></a>
<a name="13005"><span class="lineNum">   13005 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="13006"><span class="lineNum">   13006 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13007"><span class="lineNum">   13007 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13008"><span class="lineNum">   13008 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="13009"><span class="lineNum">   13009 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 14, 15, 0, 0 ) );</span></a>
<a name="13010"><span class="lineNum">   13010 </span>                :            : </a>
<a name="13011"><span class="lineNum">   13011 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="13012"><span class="lineNum">   13012 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) ) ;</span></a>
<a name="13013"><span class="lineNum">   13013 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13014"><span class="lineNum">   13014 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13015"><span class="lineNum">   13015 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) ) ;</span></a>
<a name="13016"><span class="lineNum">   13016 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13017"><span class="lineNum">   13017 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13018"><span class="lineNum">   13018 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13019"><span class="lineNum">   13019 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13020"><span class="lineNum">   13020 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="13021"><span class="lineNum">   13021 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="13022"><span class="lineNum">   13022 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) );</span></a>
<a name="13023"><span class="lineNum">   13023 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13024"><span class="lineNum">   13024 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="13025"><span class="lineNum">   13025 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 3, 13, 0, 0 ) );</span></a>
<a name="13026"><span class="lineNum">   13026 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 83, 83, 8 ) ) ;</span></a>
<a name="13027"><span class="lineNum">   13027 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13028"><span class="lineNum">   13028 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13029"><span class="lineNum">   13029 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13030"><span class="lineNum">   13030 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13031"><span class="lineNum">   13031 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13032"><span class="lineNum">   13032 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="13033"><span class="lineNum">   13033 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 83, 83, 8, 0 ) );</span></a>
<a name="13034"><span class="lineNum">   13034 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 183, 183, 0, 11 ) ) ;</span></a>
<a name="13035"><span class="lineNum">   13035 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13036"><span class="lineNum">   13036 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13037"><span class="lineNum">   13037 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13038"><span class="lineNum">   13038 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13039"><span class="lineNum">   13039 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 3 ) );</span></a>
<a name="13040"><span class="lineNum">   13040 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="13041"><span class="lineNum">   13041 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 183, 183, 0, 11 ) );</span></a>
<a name="13042"><span class="lineNum">   13042 </span>                :            : </a>
<a name="13043"><span class="lineNum">   13043 </span>                :            :   //clear</a>
<a name="13044"><span class="lineNum">   13044 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c7;</span></a>
<a name="13045"><span class="lineNum">   13045 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) ) ;</span></a>
<a name="13046"><span class="lineNum">   13046 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="13047"><span class="lineNum">   13047 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="13048"><span class="lineNum">   13048 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="13049"><span class="lineNum">   13049 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="13050"><span class="lineNum">   13050 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="13051"><span class="lineNum">   13051 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="13052"><span class="lineNum">   13052 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="13053"><span class="lineNum">   13053 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="13054"><span class="lineNum">   13054 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="13055"><span class="lineNum">   13055 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="13056"><span class="lineNum">   13056 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="13057"><span class="lineNum">   13057 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="13058"><span class="lineNum">   13058 </span>                :            : </a>
<a name="13059"><span class="lineNum">   13059 </span>                :            :   //clone</a>
<a name="13060"><span class="lineNum">   13060 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c11;</span></a>
<a name="13061"><span class="lineNum">   13061 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiLineString &gt;cloned( c11.clone() );</span></a>
<a name="13062"><span class="lineNum">   13062 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="13063"><span class="lineNum">   13063 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="13064"><span class="lineNum">   13064 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="13065"><span class="lineNum">   13065 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="13066"><span class="lineNum">   13066 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="13067"><span class="lineNum">   13067 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( cloned-&gt;geometryN( 0 ) );</span></a>
<a name="13068"><span class="lineNum">   13068 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13069"><span class="lineNum">   13069 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( cloned-&gt;geometryN( 1 ) );</span></a>
<a name="13070"><span class="lineNum">   13070 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13071"><span class="lineNum">   13071 </span>                :            : </a>
<a name="13072"><span class="lineNum">   13072 </span>                :            :   //copy constructor</a>
<a name="13073"><span class="lineNum">   13073 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c12;</span></a>
<a name="13074"><span class="lineNum">   13074 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c13( c12 );</span></a>
<a name="13075"><span class="lineNum">   13075 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="13076"><span class="lineNum">   13076 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="13077"><span class="lineNum">   13077 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="13078"><span class="lineNum">   13078 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c14( c12 );</span></a>
<a name="13079"><span class="lineNum">   13079 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="13080"><span class="lineNum">   13080 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13081"><span class="lineNum">   13081 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c14.geometryN( 0 ) );</span></a>
<a name="13082"><span class="lineNum">   13082 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13083"><span class="lineNum">   13083 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c14.geometryN( 1 ) );</span></a>
<a name="13084"><span class="lineNum">   13084 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13085"><span class="lineNum">   13085 </span>                :            : </a>
<a name="13086"><span class="lineNum">   13086 </span>                :            :   //assignment operator</a>
<a name="13087"><span class="lineNum">   13087 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c15;</span></a>
<a name="13088"><span class="lineNum">   13088 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="13089"><span class="lineNum">   13089 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="13090"><span class="lineNum">   13090 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="13091"><span class="lineNum">   13091 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="13092"><span class="lineNum">   13092 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c15.geometryN( 0 ) );</span></a>
<a name="13093"><span class="lineNum">   13093 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13094"><span class="lineNum">   13094 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsLineString * &gt;( c15.geometryN( 1 ) );</span></a>
<a name="13095"><span class="lineNum">   13095 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13096"><span class="lineNum">   13096 </span>                :            : </a>
<a name="13097"><span class="lineNum">   13097 </span>                :            :   //toCurveType</a>
<a name="13098"><span class="lineNum">   13098 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiCurve &gt; curveType( c12.toCurveType() );</span></a>
<a name="13099"><span class="lineNum">   13099 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13100"><span class="lineNum">   13100 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="13101"><span class="lineNum">   13101 </span>                :<span class="lineCov">          1 :   const QgsCompoundCurve *curve = static_cast&lt; const QgsCompoundCurve * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="13102"><span class="lineNum">   13102 </span>                :<span class="lineCov">          2 :   QCOMPARE( curve-&gt;asWkt(), QStringLiteral( &quot;CompoundCurveZM ((5 50 1 4, 6 61 3 5))&quot; ) );</span></a>
<a name="13103"><span class="lineNum">   13103 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsCompoundCurve * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="13104"><span class="lineNum">   13104 </span>                :<span class="lineCov">          2 :   QCOMPARE( curve-&gt;asWkt(), QStringLiteral( &quot;CompoundCurveZM ((5 50 1 4, 6 61 3 5))&quot; ) );</span></a>
<a name="13105"><span class="lineNum">   13105 </span>                :            : </a>
<a name="13106"><span class="lineNum">   13106 </span>                :            :   //to/fromWKB</a>
<a name="13107"><span class="lineNum">   13107 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c16;</span></a>
<a name="13108"><span class="lineNum">   13108 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) ) ;</span></a>
<a name="13109"><span class="lineNum">   13109 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13110"><span class="lineNum">   13110 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 ) ) ;</span></a>
<a name="13111"><span class="lineNum">   13111 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13112"><span class="lineNum">   13112 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="13113"><span class="lineNum">   13113 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c17;</span></a>
<a name="13114"><span class="lineNum">   13114 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="13115"><span class="lineNum">   13115 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="13116"><span class="lineNum">   13116 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13117"><span class="lineNum">   13117 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13118"><span class="lineNum">   13118 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13119"><span class="lineNum">   13119 </span>                :            : </a>
<a name="13120"><span class="lineNum">   13120 </span>                :            :   //parts with Z</a>
<a name="13121"><span class="lineNum">   13121 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13122"><span class="lineNum">   13122 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13123"><span class="lineNum">   13123 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 13, 4 ) ) ;</span></a>
<a name="13124"><span class="lineNum">   13124 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13125"><span class="lineNum">   13125 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 43, 43, 5 ) ) ;</span></a>
<a name="13126"><span class="lineNum">   13126 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13127"><span class="lineNum">   13127 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13128"><span class="lineNum">   13128 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="13129"><span class="lineNum">   13129 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="13130"><span class="lineNum">   13130 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13131"><span class="lineNum">   13131 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="13132"><span class="lineNum">   13132 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13133"><span class="lineNum">   13133 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13134"><span class="lineNum">   13134 </span>                :            : </a>
<a name="13135"><span class="lineNum">   13135 </span>                :            :   //parts with m</a>
<a name="13136"><span class="lineNum">   13136 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13137"><span class="lineNum">   13137 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13138"><span class="lineNum">   13138 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 13, 0, 4 ) ) ;</span></a>
<a name="13139"><span class="lineNum">   13139 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13140"><span class="lineNum">   13140 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 43, 43, 0, 5 ) ) ;</span></a>
<a name="13141"><span class="lineNum">   13141 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13142"><span class="lineNum">   13142 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13143"><span class="lineNum">   13143 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="13144"><span class="lineNum">   13144 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="13145"><span class="lineNum">   13145 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13146"><span class="lineNum">   13146 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiLineStringM );</span></a>
<a name="13147"><span class="lineNum">   13147 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13148"><span class="lineNum">   13148 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13149"><span class="lineNum">   13149 </span>                :            : </a>
<a name="13150"><span class="lineNum">   13150 </span>                :            :   // parts with ZM</a>
<a name="13151"><span class="lineNum">   13151 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13152"><span class="lineNum">   13152 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13153"><span class="lineNum">   13153 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) ) ;</span></a>
<a name="13154"><span class="lineNum">   13154 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13155"><span class="lineNum">   13155 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 ) ) ;</span></a>
<a name="13156"><span class="lineNum">   13156 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13157"><span class="lineNum">   13157 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13158"><span class="lineNum">   13158 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="13159"><span class="lineNum">   13159 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="13160"><span class="lineNum">   13160 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13161"><span class="lineNum">   13161 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiLineStringZM );</span></a>
<a name="13162"><span class="lineNum">   13162 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13163"><span class="lineNum">   13163 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsLineString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13164"><span class="lineNum">   13164 </span>                :            : </a>
<a name="13165"><span class="lineNum">   13165 </span>                :            :   //bad WKB - check for no crash</a>
<a name="13166"><span class="lineNum">   13166 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13167"><span class="lineNum">   13167 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="13168"><span class="lineNum">   13168 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="13169"><span class="lineNum">   13169 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="13170"><span class="lineNum">   13170 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="13171"><span class="lineNum">   13171 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="13172"><span class="lineNum">   13172 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="13173"><span class="lineNum">   13173 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="13174"><span class="lineNum">   13174 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="13175"><span class="lineNum">   13175 </span>                :            : </a>
<a name="13176"><span class="lineNum">   13176 </span>                :            :   //to/from WKT</a>
<a name="13177"><span class="lineNum">   13177 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c18;</span></a>
<a name="13178"><span class="lineNum">   13178 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) ) ;</span></a>
<a name="13179"><span class="lineNum">   13179 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="13180"><span class="lineNum">   13180 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 ) ) ;</span></a>
<a name="13181"><span class="lineNum">   13181 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="13182"><span class="lineNum">   13182 </span>                :            : </a>
<a name="13183"><span class="lineNum">   13183 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="13184"><span class="lineNum">   13184 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="13185"><span class="lineNum">   13185 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c19;</span></a>
<a name="13186"><span class="lineNum">   13186 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="13187"><span class="lineNum">   13187 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="13188"><span class="lineNum">   13188 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c19.geometryN( 0 ) ), *static_cast&lt; const QgsLineString * &gt;( c18.geometryN( 0 ) ) );</span></a>
<a name="13189"><span class="lineNum">   13189 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c19.geometryN( 1 ) ), *static_cast&lt; const QgsLineString * &gt;( c18.geometryN( 1 ) ) );</span></a>
<a name="13190"><span class="lineNum">   13190 </span>                :            : </a>
<a name="13191"><span class="lineNum">   13191 </span>                :            :   //bad WKT</a>
<a name="13192"><span class="lineNum">   13192 </span>                :<span class="lineCov">          1 :   QgsMultiLineString c20;</span></a>
<a name="13193"><span class="lineNum">   13193 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="13194"><span class="lineNum">   13194 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="13195"><span class="lineNum">   13195 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="13196"><span class="lineNum">   13196 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::MultiLineString );</span></a>
<a name="13197"><span class="lineNum">   13197 </span>                :            : </a>
<a name="13198"><span class="lineNum">   13198 </span>                :            :   //as JSON</a>
<a name="13199"><span class="lineNum">   13199 </span>                :<span class="lineCov">          1 :   QgsMultiLineString exportC;</span></a>
<a name="13200"><span class="lineNum">   13200 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) ) ;</span></a>
<a name="13201"><span class="lineNum">   13201 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="13202"><span class="lineNum">   13202 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 ) ) ;</span></a>
<a name="13203"><span class="lineNum">   13203 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="13204"><span class="lineNum">   13204 </span>                :            : </a>
<a name="13205"><span class="lineNum">   13205 </span>                :            :   // GML document for compare</a>
<a name="13206"><span class="lineNum">   13206 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="13207"><span class="lineNum">   13207 </span>                :            : </a>
<a name="13208"><span class="lineNum">   13208 </span>                :            :   // as GML2</a>
<a name="13209"><span class="lineNum">   13209 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;7,17 3,13&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;27,37 43,43&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;/MultiLineString&gt;&quot; ) );</span></a>
<a name="13210"><span class="lineNum">   13210 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc ) );</span></a>
<a name="13211"><span class="lineNum">   13211 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="13212"><span class="lineNum">   13212 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="13213"><span class="lineNum">   13213 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiLineString().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="13214"><span class="lineNum">   13214 </span>                :            : </a>
<a name="13215"><span class="lineNum">   13215 </span>                :            :   //as GML3</a>
<a name="13216"><span class="lineNum">   13216 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;7 17 3 13&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;27 37 43 43&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;/MultiCurve&gt;&quot; ) );</span></a>
<a name="13217"><span class="lineNum">   13217 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="13218"><span class="lineNum">   13218 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="13219"><span class="lineNum">   13219 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="13220"><span class="lineNum">   13220 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiLineString().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="13221"><span class="lineNum">   13221 </span>                :            : </a>
<a name="13222"><span class="lineNum">   13222 </span>                :            :   // as JSON</a>
<a name="13223"><span class="lineNum">   13223 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[7.0,17.0],[3.0,13.0]],[[27.0,37.0],[43.0,43.0]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="13224"><span class="lineNum">   13224 </span>                :<span class="lineCov">          1 :   res = exportC.asJson();</span></a>
<a name="13225"><span class="lineNum">   13225 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="13226"><span class="lineNum">   13226 </span>                :            : </a>
<a name="13227"><span class="lineNum">   13227 </span>                :<span class="lineCov">          1 :   QgsMultiLineString exportFloat;</span></a>
<a name="13228"><span class="lineNum">   13228 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7 / 3.0, 17 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3 / 5.0, 13 / 3.0 ) ) ;</span></a>
<a name="13229"><span class="lineNum">   13229 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="13230"><span class="lineNum">   13230 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27 / 3.0, 37 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43 / 41.0, 43 / 42.0 ) ) ;</span></a>
<a name="13231"><span class="lineNum">   13231 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="13232"><span class="lineNum">   13232 </span>                :            : </a>
<a name="13233"><span class="lineNum">   13233 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[[2.333,5.667],[0.6,4.333]],[[9.0,4.111],[1.049,1.024]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="13234"><span class="lineNum">   13234 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="13235"><span class="lineNum">   13235 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="13236"><span class="lineNum">   13236 </span>                :            : </a>
<a name="13237"><span class="lineNum">   13237 </span>                :            :   // as GML2</a>
<a name="13238"><span class="lineNum">   13238 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;2.333,5.667 0.6,4.333&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;9,4.111 1.049,1.024&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;/MultiLineString&gt;&quot; ) );</span></a>
<a name="13239"><span class="lineNum">   13239 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="13240"><span class="lineNum">   13240 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="13241"><span class="lineNum">   13241 </span>                :            : </a>
<a name="13242"><span class="lineNum">   13242 </span>                :            :   //as GML3</a>
<a name="13243"><span class="lineNum">   13243 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;2.333 5.667 0.6 4.333&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;9 4.111 1.049 1.024&lt;/posList&gt;&lt;/LineString&gt;&lt;/curveMember&gt;&lt;/MultiCurve&gt;&quot; ) );</span></a>
<a name="13244"><span class="lineNum">   13244 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="13245"><span class="lineNum">   13245 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="13246"><span class="lineNum">   13246 </span>                :            : </a>
<a name="13247"><span class="lineNum">   13247 </span>                :            :   //asKML</a>
<a name="13248"><span class="lineNum">   13248 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;7,17,0 3,13,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;27,37,0 43,43,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="13249"><span class="lineNum">   13249 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportC.asKml(), expectedKml );</span></a>
<a name="13250"><span class="lineNum">   13250 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;2.333,5.667,0 0.6,4.333,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;9,4.111,0 1.049,1.024,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="13251"><span class="lineNum">   13251 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="13252"><span class="lineNum">   13252 </span>                :            : </a>
<a name="13253"><span class="lineNum">   13253 </span>                :            :   // insert geometry</a>
<a name="13254"><span class="lineNum">   13254 </span>                :<span class="lineCov">          1 :   QgsMultiLineString rc;</span></a>
<a name="13255"><span class="lineNum">   13255 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="13256"><span class="lineNum">   13256 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="13257"><span class="lineNum">   13257 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13258"><span class="lineNum">   13258 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13259"><span class="lineNum">   13259 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="13260"><span class="lineNum">   13260 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13261"><span class="lineNum">   13261 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13262"><span class="lineNum">   13262 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="13263"><span class="lineNum">   13263 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13264"><span class="lineNum">   13264 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13265"><span class="lineNum">   13265 </span>                :            : </a>
<a name="13266"><span class="lineNum">   13266 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( new QgsPoint(), 0 );</span></a>
<a name="13267"><span class="lineNum">   13267 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13268"><span class="lineNum">   13268 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13269"><span class="lineNum">   13269 </span>                :            : </a>
<a name="13270"><span class="lineNum">   13270 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part.clone(), 0 );</span></a>
<a name="13271"><span class="lineNum">   13271 </span>                :<span class="lineCov">          1 :   QVERIFY( !rc.isEmpty() );</span></a>
<a name="13272"><span class="lineNum">   13272 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="13273"><span class="lineNum">   13273 </span>                :            : </a>
<a name="13274"><span class="lineNum">   13274 </span>                :            :   // cast</a>
<a name="13275"><span class="lineNum">   13275 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsMultiLineString().cast( nullptr ) );</span></a>
<a name="13276"><span class="lineNum">   13276 </span>                :<span class="lineCov">          1 :   QgsMultiLineString pCast;</span></a>
<a name="13277"><span class="lineNum">   13277 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().cast( &amp;pCast ) );</span></a>
<a name="13278"><span class="lineNum">   13278 </span>                :<span class="lineCov">          1 :   QgsMultiLineString pCast2;</span></a>
<a name="13279"><span class="lineNum">   13279 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiLineStringZ()&quot; ) );</span></a>
<a name="13280"><span class="lineNum">   13280 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().cast( &amp;pCast2 ) );</span></a>
<a name="13281"><span class="lineNum">   13281 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiLineStringM()&quot; ) );</span></a>
<a name="13282"><span class="lineNum">   13282 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().cast( &amp;pCast2 ) );</span></a>
<a name="13283"><span class="lineNum">   13283 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiLineStringZM()&quot; ) );</span></a>
<a name="13284"><span class="lineNum">   13284 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().cast( &amp;pCast2 ) );</span></a>
<a name="13285"><span class="lineNum">   13285 </span>                :            : </a>
<a name="13286"><span class="lineNum">   13286 </span>                :            :   //boundary</a>
<a name="13287"><span class="lineNum">   13287 </span>                :<span class="lineCov">          1 :   QgsMultiLineString multiLine1;</span></a>
<a name="13288"><span class="lineNum">   13288 </span>                :<span class="lineCov">          1 :   QVERIFY( !multiLine1.boundary() );</span></a>
<a name="13289"><span class="lineNum">   13289 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryLine1;</span></a>
<a name="13290"><span class="lineNum">   13290 </span>                :<span class="lineCov">          1 :   boundaryLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="13291"><span class="lineNum">   13291 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine1.clone() );</span></a>
<a name="13292"><span class="lineNum">   13292 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = multiLine1.boundary();</span></a>
<a name="13293"><span class="lineNum">   13293 </span>                :<span class="lineCov">          1 :   QgsMultiPoint *mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13294"><span class="lineNum">   13294 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13295"><span class="lineNum">   13295 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 2 );</span></a>
<a name="13296"><span class="lineNum">   13296 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13297"><span class="lineNum">   13297 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13298"><span class="lineNum">   13298 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13299"><span class="lineNum">   13299 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13300"><span class="lineNum">   13300 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13301"><span class="lineNum">   13301 </span>                :            :   // add another linestring</a>
<a name="13302"><span class="lineNum">   13302 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryLine2;</span></a>
<a name="13303"><span class="lineNum">   13303 </span>                :<span class="lineCov">          1 :   boundaryLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 11, 11 ) );</span></a>
<a name="13304"><span class="lineNum">   13304 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine2.clone() );</span></a>
<a name="13305"><span class="lineNum">   13305 </span>                :<span class="lineCov">          1 :   boundary = multiLine1.boundary();</span></a>
<a name="13306"><span class="lineNum">   13306 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13307"><span class="lineNum">   13307 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13308"><span class="lineNum">   13308 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="13309"><span class="lineNum">   13309 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13310"><span class="lineNum">   13310 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13311"><span class="lineNum">   13311 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13312"><span class="lineNum">   13312 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13313"><span class="lineNum">   13313 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="13314"><span class="lineNum">   13314 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="13315"><span class="lineNum">   13315 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 11.0 );</span></a>
<a name="13316"><span class="lineNum">   13316 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 11.0 );</span></a>
<a name="13317"><span class="lineNum">   13317 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13318"><span class="lineNum">   13318 </span>                :            : </a>
<a name="13319"><span class="lineNum">   13319 </span>                :            :   // vertex iterator: 2 linestrings with 3 points each</a>
<a name="13320"><span class="lineNum">   13320 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it = multiLine1.vertices_begin();</span></a>
<a name="13321"><span class="lineNum">   13321 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator itEnd = multiLine1.vertices_end();</span></a>
<a name="13322"><span class="lineNum">   13322 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 0, 0 ) );</span></a>
<a name="13323"><span class="lineNum">   13323 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="13324"><span class="lineNum">   13324 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13325"><span class="lineNum">   13325 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 1, 0 ) );</span></a>
<a name="13326"><span class="lineNum">   13326 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="13327"><span class="lineNum">   13327 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13328"><span class="lineNum">   13328 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 1, 1 ) );</span></a>
<a name="13329"><span class="lineNum">   13329 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="13330"><span class="lineNum">   13330 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13331"><span class="lineNum">   13331 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10, 10 ) );</span></a>
<a name="13332"><span class="lineNum">   13332 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="13333"><span class="lineNum">   13333 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13334"><span class="lineNum">   13334 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 11, 10 ) );</span></a>
<a name="13335"><span class="lineNum">   13335 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 1 ) );</span></a>
<a name="13336"><span class="lineNum">   13336 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13337"><span class="lineNum">   13337 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 11, 11 ) );</span></a>
<a name="13338"><span class="lineNum">   13338 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="13339"><span class="lineNum">   13339 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="13340"><span class="lineNum">   13340 </span>                :<span class="lineCov">          1 :   QCOMPARE( it, itEnd );</span></a>
<a name="13341"><span class="lineNum">   13341 </span>                :            : </a>
<a name="13342"><span class="lineNum">   13342 </span>                :            :   // Java-style iterator</a>
<a name="13343"><span class="lineNum">   13343 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2( &amp;multiLine1 );</span></a>
<a name="13344"><span class="lineNum">   13344 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13345"><span class="lineNum">   13345 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 0, 0 ) );</span></a>
<a name="13346"><span class="lineNum">   13346 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13347"><span class="lineNum">   13347 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 0 ) );</span></a>
<a name="13348"><span class="lineNum">   13348 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13349"><span class="lineNum">   13349 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 1 ) );</span></a>
<a name="13350"><span class="lineNum">   13350 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13351"><span class="lineNum">   13351 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10, 10 ) );</span></a>
<a name="13352"><span class="lineNum">   13352 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13353"><span class="lineNum">   13353 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 11, 10 ) );</span></a>
<a name="13354"><span class="lineNum">   13354 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="13355"><span class="lineNum">   13355 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 11, 11 ) );</span></a>
<a name="13356"><span class="lineNum">   13356 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="13357"><span class="lineNum">   13357 </span>                :            : </a>
<a name="13358"><span class="lineNum">   13358 </span>                :            :   // add a closed string = no boundary</a>
<a name="13359"><span class="lineNum">   13359 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryLine3;</span></a>
<a name="13360"><span class="lineNum">   13360 </span>                :<span class="lineCov">          1 :   boundaryLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 20, 20 ) &lt;&lt; QgsPoint( 21, 20 ) &lt;&lt; QgsPoint( 21, 21 ) &lt;&lt; QgsPoint( 20, 20 ) );</span></a>
<a name="13361"><span class="lineNum">   13361 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine3.clone() );</span></a>
<a name="13362"><span class="lineNum">   13362 </span>                :<span class="lineCov">          1 :   boundary = multiLine1.boundary();</span></a>
<a name="13363"><span class="lineNum">   13363 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13364"><span class="lineNum">   13364 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13365"><span class="lineNum">   13365 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="13366"><span class="lineNum">   13366 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13367"><span class="lineNum">   13367 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13368"><span class="lineNum">   13368 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13369"><span class="lineNum">   13369 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13370"><span class="lineNum">   13370 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="13371"><span class="lineNum">   13371 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="13372"><span class="lineNum">   13372 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 11.0 );</span></a>
<a name="13373"><span class="lineNum">   13373 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 11.0 );</span></a>
<a name="13374"><span class="lineNum">   13374 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13375"><span class="lineNum">   13375 </span>                :            : </a>
<a name="13376"><span class="lineNum">   13376 </span>                :            :   //boundary with z</a>
<a name="13377"><span class="lineNum">   13377 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryLine4;</span></a>
<a name="13378"><span class="lineNum">   13378 </span>                :<span class="lineCov">          1 :   boundaryLine4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="13379"><span class="lineNum">   13379 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryLine5;</span></a>
<a name="13380"><span class="lineNum">   13380 </span>                :<span class="lineCov">          1 :   boundaryLine5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 150 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 20, 200 ) );</span></a>
<a name="13381"><span class="lineNum">   13381 </span>                :<span class="lineCov">          1 :   QgsMultiLineString multiLine2;</span></a>
<a name="13382"><span class="lineNum">   13382 </span>                :<span class="lineCov">          1 :   multiLine2.addGeometry( boundaryLine4.clone() );</span></a>
<a name="13383"><span class="lineNum">   13383 </span>                :<span class="lineCov">          1 :   multiLine2.addGeometry( boundaryLine5.clone() );</span></a>
<a name="13384"><span class="lineNum">   13384 </span>                :            : </a>
<a name="13385"><span class="lineNum">   13385 </span>                :<span class="lineCov">          1 :   boundary = multiLine2.boundary();</span></a>
<a name="13386"><span class="lineNum">   13386 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13387"><span class="lineNum">   13387 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13388"><span class="lineNum">   13388 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="13389"><span class="lineNum">   13389 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="13390"><span class="lineNum">   13390 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13391"><span class="lineNum">   13391 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13392"><span class="lineNum">   13392 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;z(), 10.0 );</span></a>
<a name="13393"><span class="lineNum">   13393 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="13394"><span class="lineNum">   13394 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13395"><span class="lineNum">   13395 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13396"><span class="lineNum">   13396 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;z(), 20.0 );</span></a>
<a name="13397"><span class="lineNum">   13397 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 2 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="13398"><span class="lineNum">   13398 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="13399"><span class="lineNum">   13399 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="13400"><span class="lineNum">   13400 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;z(), 100.0 );</span></a>
<a name="13401"><span class="lineNum">   13401 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 3 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="13402"><span class="lineNum">   13402 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 20.0 );</span></a>
<a name="13403"><span class="lineNum">   13403 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 20.0 );</span></a>
<a name="13404"><span class="lineNum">   13404 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;z(), 200.0 );</span></a>
<a name="13405"><span class="lineNum">   13405 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13406"><span class="lineNum">   13406 </span>                :            : </a>
<a name="13407"><span class="lineNum">   13407 </span>                :            :   //segmentLength</a>
<a name="13408"><span class="lineNum">   13408 </span>                :<span class="lineCov">          1 :   QgsMultiLineString multiLine3;</span></a>
<a name="13409"><span class="lineNum">   13409 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine3;</span></a>
<a name="13410"><span class="lineNum">   13410 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="13411"><span class="lineNum">   13411 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 0 ) ), 0.0 );</span></a>
<a name="13412"><span class="lineNum">   13412 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 0 ) ), 0.0 );</span></a>
<a name="13413"><span class="lineNum">   13413 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, -1, 0 ) ), 0.0 );</span></a>
<a name="13414"><span class="lineNum">   13414 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 1, 0 ) ), 0.0 );</span></a>
<a name="13415"><span class="lineNum">   13415 </span>                :<span class="lineCov">          2 :   vertexLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 )</span></a>
<a name="13416"><span class="lineNum">   13416 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( 111, 2 ) &lt;&lt; QgsPoint( 11, 2 ) );</span></a>
<a name="13417"><span class="lineNum">   13417 </span>                :<span class="lineCov">          1 :   multiLine3.addGeometry( vertexLine3.clone() );</span></a>
<a name="13418"><span class="lineNum">   13418 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="13419"><span class="lineNum">   13419 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="13420"><span class="lineNum">   13420 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 0 ) ), 10.0 );</span></a>
<a name="13421"><span class="lineNum">   13421 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 1 ) ), 100.0 );</span></a>
<a name="13422"><span class="lineNum">   13422 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 2 ) ), 10.0 );</span></a>
<a name="13423"><span class="lineNum">   13423 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 3 ) ), 100.0 );</span></a>
<a name="13424"><span class="lineNum">   13424 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 4 ) ), 0.0 );</span></a>
<a name="13425"><span class="lineNum">   13425 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="13426"><span class="lineNum">   13426 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="13427"><span class="lineNum">   13427 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, -1, 0 ) ), 10.0 );</span></a>
<a name="13428"><span class="lineNum">   13428 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 1, 0 ) ), 0.0 );</span></a>
<a name="13429"><span class="lineNum">   13429 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 1, 1 ) ), 0.0 );</span></a>
<a name="13430"><span class="lineNum">   13430 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 1 ) ), 0.0 );</span></a>
<a name="13431"><span class="lineNum">   13431 </span>                :            : </a>
<a name="13432"><span class="lineNum">   13432 </span>                :            :   // add another line</a>
<a name="13433"><span class="lineNum">   13433 </span>                :<span class="lineCov">          2 :   vertexLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 30, 6 ) &lt;&lt; QgsPoint( 34, 6 ) &lt;&lt; QgsPoint( 34, 8 )</span></a>
<a name="13434"><span class="lineNum">   13434 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPoint( 30, 8 ) &lt;&lt; QgsPoint( 30, 6 ) );</span></a>
<a name="13435"><span class="lineNum">   13435 </span>                :<span class="lineCov">          1 :   multiLine3.addGeometry( vertexLine3.clone() );</span></a>
<a name="13436"><span class="lineNum">   13436 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId() ), 0.0 );</span></a>
<a name="13437"><span class="lineNum">   13437 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, -1 ) ), 0.0 );</span></a>
<a name="13438"><span class="lineNum">   13438 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 0 ) ), 10.0 );</span></a>
<a name="13439"><span class="lineNum">   13439 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 1 ) ), 100.0 );</span></a>
<a name="13440"><span class="lineNum">   13440 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 2 ) ), 10.0 );</span></a>
<a name="13441"><span class="lineNum">   13441 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 3 ) ), 100.0 );</span></a>
<a name="13442"><span class="lineNum">   13442 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, 0, 4 ) ), 0.0 );</span></a>
<a name="13443"><span class="lineNum">   13443 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( -1, 0, -1 ) ), 0.0 );</span></a>
<a name="13444"><span class="lineNum">   13444 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( -1, 0, 0 ) ), 0.0 );</span></a>
<a name="13445"><span class="lineNum">   13445 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 0, -1, 0 ) ), 10.0 );</span></a>
<a name="13446"><span class="lineNum">   13446 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, -1 ) ), 0.0 );</span></a>
<a name="13447"><span class="lineNum">   13447 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 0 ) ), 4.0 );</span></a>
<a name="13448"><span class="lineNum">   13448 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 1 ) ), 2.0 );</span></a>
<a name="13449"><span class="lineNum">   13449 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 2 ) ), 4.0 );</span></a>
<a name="13450"><span class="lineNum">   13450 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 3 ) ), 2.0 );</span></a>
<a name="13451"><span class="lineNum">   13451 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 0, 4 ) ), 0.0 );</span></a>
<a name="13452"><span class="lineNum">   13452 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 1, 1 ) ), 2.0 );</span></a>
<a name="13453"><span class="lineNum">   13453 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 1, 1, 2 ) ), 4.0 );</span></a>
<a name="13454"><span class="lineNum">   13454 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLine3.segmentLength( QgsVertexId( 2, 0, 0 ) ), 0.0 );</span></a>
<a name="13455"><span class="lineNum">   13455 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="13456"><span class="lineNum">   13456 </span>                :            : </a>
<a name="13457"><span class="lineNum">   13457 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::multiCurve()</span></a>
<a name="13458"><span class="lineNum">   13458 </span>                :            : {</a>
<a name="13459"><span class="lineNum">   13459 </span>                :            :   //test constructor</a>
<a name="13460"><span class="lineNum">   13460 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c1;</span></a>
<a name="13461"><span class="lineNum">   13461 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="13462"><span class="lineNum">   13462 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="13463"><span class="lineNum">   13463 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="13464"><span class="lineNum">   13464 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="13465"><span class="lineNum">   13465 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="13466"><span class="lineNum">   13466 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="13467"><span class="lineNum">   13467 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13468"><span class="lineNum">   13468 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiCurve&quot; ) );</span></a>
<a name="13469"><span class="lineNum">   13469 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiCurve&quot; ) );</span></a>
<a name="13470"><span class="lineNum">   13470 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="13471"><span class="lineNum">   13471 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="13472"><span class="lineNum">   13472 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="13473"><span class="lineNum">   13473 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="13474"><span class="lineNum">   13474 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="13475"><span class="lineNum">   13475 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="13476"><span class="lineNum">   13476 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="13477"><span class="lineNum">   13477 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="13478"><span class="lineNum">   13478 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="13479"><span class="lineNum">   13479 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="13480"><span class="lineNum">   13480 </span>                :            : </a>
<a name="13481"><span class="lineNum">   13481 </span>                :            :   //addGeometry</a>
<a name="13482"><span class="lineNum">   13482 </span>                :            :   //try with nullptr</a>
<a name="13483"><span class="lineNum">   13483 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="13484"><span class="lineNum">   13484 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="13485"><span class="lineNum">   13485 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="13486"><span class="lineNum">   13486 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="13487"><span class="lineNum">   13487 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="13488"><span class="lineNum">   13488 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="13489"><span class="lineNum">   13489 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13490"><span class="lineNum">   13490 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="13491"><span class="lineNum">   13491 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="13492"><span class="lineNum">   13492 </span>                :            : </a>
<a name="13493"><span class="lineNum">   13493 </span>                :            :   // not a curve</a>
<a name="13494"><span class="lineNum">   13494 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.addGeometry( new QgsPoint() ) );</span></a>
<a name="13495"><span class="lineNum">   13495 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="13496"><span class="lineNum">   13496 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="13497"><span class="lineNum">   13497 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="13498"><span class="lineNum">   13498 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="13499"><span class="lineNum">   13499 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="13500"><span class="lineNum">   13500 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13501"><span class="lineNum">   13501 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="13502"><span class="lineNum">   13502 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="13503"><span class="lineNum">   13503 </span>                :            : </a>
<a name="13504"><span class="lineNum">   13504 </span>                :            :   //valid geometry</a>
<a name="13505"><span class="lineNum">   13505 </span>                :<span class="lineCov">          1 :   QgsCircularString part;</span></a>
<a name="13506"><span class="lineNum">   13506 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 1, 12 ) );</span></a>
<a name="13507"><span class="lineNum">   13507 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="13508"><span class="lineNum">   13508 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="13509"><span class="lineNum">   13509 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="13510"><span class="lineNum">   13510 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 3 );</span></a>
<a name="13511"><span class="lineNum">   13511 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="13512"><span class="lineNum">   13512 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="13513"><span class="lineNum">   13513 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="13514"><span class="lineNum">   13514 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="13515"><span class="lineNum">   13515 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13516"><span class="lineNum">   13516 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiCurve&quot; ) );</span></a>
<a name="13517"><span class="lineNum">   13517 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiCurve&quot; ) );</span></a>
<a name="13518"><span class="lineNum">   13518 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 1 );</span></a>
<a name="13519"><span class="lineNum">   13519 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.hasCurvedSegments() );</span></a>
<a name="13520"><span class="lineNum">   13520 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="13521"><span class="lineNum">   13521 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="13522"><span class="lineNum">   13522 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="13523"><span class="lineNum">   13523 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c1.geometryN( 0 ) ), part );</span></a>
<a name="13524"><span class="lineNum">   13524 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="13525"><span class="lineNum">   13525 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="13526"><span class="lineNum">   13526 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 3 );</span></a>
<a name="13527"><span class="lineNum">   13527 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="13528"><span class="lineNum">   13528 </span>                :            : </a>
<a name="13529"><span class="lineNum">   13529 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="13530"><span class="lineNum">   13530 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 21, 2 )</span></a>
<a name="13531"><span class="lineNum">   13531 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 31, 3 ) );</span></a>
<a name="13532"><span class="lineNum">   13532 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c2;</span></a>
<a name="13533"><span class="lineNum">   13533 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="13534"><span class="lineNum">   13534 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="13535"><span class="lineNum">   13535 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="13536"><span class="lineNum">   13536 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::MultiCurveZ );</span></a>
<a name="13537"><span class="lineNum">   13537 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;MultiCurveZ&quot; ) );</span></a>
<a name="13538"><span class="lineNum">   13538 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;MultiCurve&quot; ) );</span></a>
<a name="13539"><span class="lineNum">   13539 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="13540"><span class="lineNum">   13540 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c3;</span></a>
<a name="13541"><span class="lineNum">   13541 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 20, 21, 0, 2 )</span></a>
<a name="13542"><span class="lineNum">   13542 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 31, 0, 3 ) );</span></a>
<a name="13543"><span class="lineNum">   13543 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="13544"><span class="lineNum">   13544 </span>                :<span class="lineCov">          1 :   QVERIFY( !c3.is3D() );</span></a>
<a name="13545"><span class="lineNum">   13545 </span>                :<span class="lineCov">          1 :   QVERIFY( c3.isMeasure() );</span></a>
<a name="13546"><span class="lineNum">   13546 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::MultiCurveM );</span></a>
<a name="13547"><span class="lineNum">   13547 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;MultiCurveM&quot; ) );</span></a>
<a name="13548"><span class="lineNum">   13548 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="13549"><span class="lineNum">   13549 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c4;</span></a>
<a name="13550"><span class="lineNum">   13550 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 20, 21, 3, 2 )</span></a>
<a name="13551"><span class="lineNum">   13551 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 31, 4, 5 ) );</span></a>
<a name="13552"><span class="lineNum">   13552 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="13553"><span class="lineNum">   13553 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.is3D() );</span></a>
<a name="13554"><span class="lineNum">   13554 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="13555"><span class="lineNum">   13555 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13556"><span class="lineNum">   13556 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;MultiCurveZM&quot; ) );</span></a>
<a name="13557"><span class="lineNum">   13557 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCircularString * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="13558"><span class="lineNum">   13558 </span>                :            : </a>
<a name="13559"><span class="lineNum">   13559 </span>                :            :   //add another part</a>
<a name="13560"><span class="lineNum">   13560 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c6;</span></a>
<a name="13561"><span class="lineNum">   13561 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 1, 20 ) );</span></a>
<a name="13562"><span class="lineNum">   13562 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13563"><span class="lineNum">   13563 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="13564"><span class="lineNum">   13564 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 9, 12 ) &lt;&lt; QgsPoint( 3, 13 )  &lt;&lt; QgsPoint( 9, 20 ) );</span></a>
<a name="13565"><span class="lineNum">   13565 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13566"><span class="lineNum">   13566 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="13567"><span class="lineNum">   13567 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="13568"><span class="lineNum">   13568 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="13569"><span class="lineNum">   13569 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="13570"><span class="lineNum">   13570 </span>                :            : </a>
<a name="13571"><span class="lineNum">   13571 </span>                :            :   //adding subsequent points should not alter z/m type, regardless of parts type</a>
<a name="13572"><span class="lineNum">   13572 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="13573"><span class="lineNum">   13573 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13574"><span class="lineNum">   13574 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13575"><span class="lineNum">   13575 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 1, 20, 4 ) ) ;</span></a>
<a name="13576"><span class="lineNum">   13576 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13577"><span class="lineNum">   13577 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13578"><span class="lineNum">   13578 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="13579"><span class="lineNum">   13579 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="13580"><span class="lineNum">   13580 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 0 );</span></a>
<a name="13581"><span class="lineNum">   13581 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( -1, 0 ), 0 );</span></a>
<a name="13582"><span class="lineNum">   13582 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 6 );</span></a>
<a name="13583"><span class="lineNum">   13583 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="13584"><span class="lineNum">   13584 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 2 );</span></a>
<a name="13585"><span class="lineNum">   13585 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="13586"><span class="lineNum">   13586 </span>                :<span class="lineCov">          1 :   const QgsCircularString *ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="13587"><span class="lineNum">   13587 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 9, 12 ) );</span></a>
<a name="13588"><span class="lineNum">   13588 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 3, 13 ) );</span></a>
<a name="13589"><span class="lineNum">   13589 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 9, 20 ) );</span></a>
<a name="13590"><span class="lineNum">   13590 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13591"><span class="lineNum">   13591 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 1, 10 ) );</span></a>
<a name="13592"><span class="lineNum">   13592 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 2, 11 ) );</span></a>
<a name="13593"><span class="lineNum">   13593 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 1, 20 ) );</span></a>
<a name="13594"><span class="lineNum">   13594 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 32, 41, 0, 3 )</span></a>
<a name="13595"><span class="lineNum">   13595 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 51, 0, 4 ) ) ;</span></a>
<a name="13596"><span class="lineNum">   13596 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13597"><span class="lineNum">   13597 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13598"><span class="lineNum">   13598 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="13599"><span class="lineNum">   13599 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="13600"><span class="lineNum">   13600 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 3 );</span></a>
<a name="13601"><span class="lineNum">   13601 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 9 );</span></a>
<a name="13602"><span class="lineNum">   13602 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="13603"><span class="lineNum">   13603 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 3 );</span></a>
<a name="13604"><span class="lineNum">   13604 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="13605"><span class="lineNum">   13605 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="13606"><span class="lineNum">   13606 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13607"><span class="lineNum">   13607 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 21, 30 ) );</span></a>
<a name="13608"><span class="lineNum">   13608 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 32, 41 ) );</span></a>
<a name="13609"><span class="lineNum">   13609 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 21, 51 ) );</span></a>
<a name="13610"><span class="lineNum">   13610 </span>                :            : </a>
<a name="13611"><span class="lineNum">   13611 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="13612"><span class="lineNum">   13612 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 1, 21, 4 ) ) ;</span></a>
<a name="13613"><span class="lineNum">   13613 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13614"><span class="lineNum">   13614 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZ );</span></a>
<a name="13615"><span class="lineNum">   13615 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 ) &lt;&lt; QgsPoint( 2, 41 ) ) ;</span></a>
<a name="13616"><span class="lineNum">   13616 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13617"><span class="lineNum">   13617 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZ );</span></a>
<a name="13618"><span class="lineNum">   13618 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13619"><span class="lineNum">   13619 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="13620"><span class="lineNum">   13620 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="13621"><span class="lineNum">   13621 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 2, 11, 3 ) );</span></a>
<a name="13622"><span class="lineNum">   13622 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 1, 21, 4 ) );</span></a>
<a name="13623"><span class="lineNum">   13623 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13624"><span class="lineNum">   13624 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="13625"><span class="lineNum">   13625 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 3, 31, 0 ) );</span></a>
<a name="13626"><span class="lineNum">   13626 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 2, 41, 0 ) );</span></a>
<a name="13627"><span class="lineNum">   13627 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="13628"><span class="lineNum">   13628 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 71, 0, 6 ) ) ;</span></a>
<a name="13629"><span class="lineNum">   13629 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13630"><span class="lineNum">   13630 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZ );</span></a>
<a name="13631"><span class="lineNum">   13631 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13632"><span class="lineNum">   13632 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="13633"><span class="lineNum">   13633 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13634"><span class="lineNum">   13634 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="13635"><span class="lineNum">   13635 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( 6, 61, 0 ) );</span></a>
<a name="13636"><span class="lineNum">   13636 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( 5, 71, 0 ) );</span></a>
<a name="13637"><span class="lineNum">   13637 </span>                :            : </a>
<a name="13638"><span class="lineNum">   13638 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="13639"><span class="lineNum">   13639 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13640"><span class="lineNum">   13640 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="13641"><span class="lineNum">   13641 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 71, 0, 5 ) ) ;</span></a>
<a name="13642"><span class="lineNum">   13642 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13643"><span class="lineNum">   13643 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveM );</span></a>
<a name="13644"><span class="lineNum">   13644 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 )   &lt;&lt; QgsPoint( 2, 41 ) ) ;</span></a>
<a name="13645"><span class="lineNum">   13645 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13646"><span class="lineNum">   13646 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveM );</span></a>
<a name="13647"><span class="lineNum">   13647 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13648"><span class="lineNum">   13648 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="13649"><span class="lineNum">   13649 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="13650"><span class="lineNum">   13650 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) );</span></a>
<a name="13651"><span class="lineNum">   13651 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 5, 71, 0, 5 ) );</span></a>
<a name="13652"><span class="lineNum">   13652 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13653"><span class="lineNum">   13653 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="13654"><span class="lineNum">   13654 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 3, 31, 0, 0 ) );</span></a>
<a name="13655"><span class="lineNum">   13655 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 2, 41, 0, 0 ) );</span></a>
<a name="13656"><span class="lineNum">   13656 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 14, 15, 16 ) &lt;&lt; QgsPoint( 11, 25, 17 ) ) ;</span></a>
<a name="13657"><span class="lineNum">   13657 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13658"><span class="lineNum">   13658 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveM );</span></a>
<a name="13659"><span class="lineNum">   13659 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="13660"><span class="lineNum">   13660 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13661"><span class="lineNum">   13661 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13662"><span class="lineNum">   13662 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="13663"><span class="lineNum">   13663 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 14, 15, 0, 0 ) );</span></a>
<a name="13664"><span class="lineNum">   13664 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 11, 25, 0, 0 ) );</span></a>
<a name="13665"><span class="lineNum">   13665 </span>                :            : </a>
<a name="13666"><span class="lineNum">   13666 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="13667"><span class="lineNum">   13667 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="13668"><span class="lineNum">   13668 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 71, 4, 6 ) ) ;</span></a>
<a name="13669"><span class="lineNum">   13669 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13670"><span class="lineNum">   13670 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13671"><span class="lineNum">   13671 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 )</span></a>
<a name="13672"><span class="lineNum">   13672 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 11 ) ) ;</span></a>
<a name="13673"><span class="lineNum">   13673 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13674"><span class="lineNum">   13674 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13675"><span class="lineNum">   13675 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13676"><span class="lineNum">   13676 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13677"><span class="lineNum">   13677 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="13678"><span class="lineNum">   13678 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="13679"><span class="lineNum">   13679 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) );</span></a>
<a name="13680"><span class="lineNum">   13680 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 5, 71, 4, 6 ) );</span></a>
<a name="13681"><span class="lineNum">   13681 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="13682"><span class="lineNum">   13682 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="13683"><span class="lineNum">   13683 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 3, 13, 0, 0 ) );</span></a>
<a name="13684"><span class="lineNum">   13684 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 7, 11, 0, 0 ) );</span></a>
<a name="13685"><span class="lineNum">   13685 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 83, 83, 8 )</span></a>
<a name="13686"><span class="lineNum">   13686 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 81, 9 ) ) ;</span></a>
<a name="13687"><span class="lineNum">   13687 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13688"><span class="lineNum">   13688 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13689"><span class="lineNum">   13689 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13690"><span class="lineNum">   13690 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13691"><span class="lineNum">   13691 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="13692"><span class="lineNum">   13692 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="13693"><span class="lineNum">   13693 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 83, 83, 8, 0 ) );</span></a>
<a name="13694"><span class="lineNum">   13694 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 77, 81, 9, 0 ) );</span></a>
<a name="13695"><span class="lineNum">   13695 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 183, 183, 0, 11 )</span></a>
<a name="13696"><span class="lineNum">   13696 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 181, 0, 13 ) ) ;</span></a>
<a name="13697"><span class="lineNum">   13697 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="13698"><span class="lineNum">   13698 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13699"><span class="lineNum">   13699 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="13700"><span class="lineNum">   13700 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="13701"><span class="lineNum">   13701 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c6.geometryN( 3 ) );</span></a>
<a name="13702"><span class="lineNum">   13702 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="13703"><span class="lineNum">   13703 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 183, 183, 0, 11 ) );</span></a>
<a name="13704"><span class="lineNum">   13704 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 177, 181, 0, 13 ) );</span></a>
<a name="13705"><span class="lineNum">   13705 </span>                :            : </a>
<a name="13706"><span class="lineNum">   13706 </span>                :            :   //clear</a>
<a name="13707"><span class="lineNum">   13707 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c7;</span></a>
<a name="13708"><span class="lineNum">   13708 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="13709"><span class="lineNum">   13709 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 71, 4, 6 ) ) ;</span></a>
<a name="13710"><span class="lineNum">   13710 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="13711"><span class="lineNum">   13711 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="13712"><span class="lineNum">   13712 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="13713"><span class="lineNum">   13713 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="13714"><span class="lineNum">   13714 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="13715"><span class="lineNum">   13715 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="13716"><span class="lineNum">   13716 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="13717"><span class="lineNum">   13717 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="13718"><span class="lineNum">   13718 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="13719"><span class="lineNum">   13719 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="13720"><span class="lineNum">   13720 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="13721"><span class="lineNum">   13721 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13722"><span class="lineNum">   13722 </span>                :            : </a>
<a name="13723"><span class="lineNum">   13723 </span>                :            :   //clone</a>
<a name="13724"><span class="lineNum">   13724 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c11;</span></a>
<a name="13725"><span class="lineNum">   13725 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiCurve &gt;cloned( c11.clone() );</span></a>
<a name="13726"><span class="lineNum">   13726 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="13727"><span class="lineNum">   13727 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="13728"><span class="lineNum">   13728 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="13729"><span class="lineNum">   13729 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="13730"><span class="lineNum">   13730 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="13731"><span class="lineNum">   13731 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( cloned-&gt;geometryN( 0 ) );</span></a>
<a name="13732"><span class="lineNum">   13732 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13733"><span class="lineNum">   13733 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( cloned-&gt;geometryN( 1 ) );</span></a>
<a name="13734"><span class="lineNum">   13734 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13735"><span class="lineNum">   13735 </span>                :            : </a>
<a name="13736"><span class="lineNum">   13736 </span>                :            :   //copy constructor</a>
<a name="13737"><span class="lineNum">   13737 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c12;</span></a>
<a name="13738"><span class="lineNum">   13738 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c13( c12 );</span></a>
<a name="13739"><span class="lineNum">   13739 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="13740"><span class="lineNum">   13740 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="13741"><span class="lineNum">   13741 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="13742"><span class="lineNum">   13742 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c14( c12 );</span></a>
<a name="13743"><span class="lineNum">   13743 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="13744"><span class="lineNum">   13744 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13745"><span class="lineNum">   13745 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c14.geometryN( 0 ) );</span></a>
<a name="13746"><span class="lineNum">   13746 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13747"><span class="lineNum">   13747 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c14.geometryN( 1 ) );</span></a>
<a name="13748"><span class="lineNum">   13748 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13749"><span class="lineNum">   13749 </span>                :            : </a>
<a name="13750"><span class="lineNum">   13750 </span>                :            :   //assignment operator</a>
<a name="13751"><span class="lineNum">   13751 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c15;</span></a>
<a name="13752"><span class="lineNum">   13752 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="13753"><span class="lineNum">   13753 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="13754"><span class="lineNum">   13754 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="13755"><span class="lineNum">   13755 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="13756"><span class="lineNum">   13756 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c15.geometryN( 0 ) );</span></a>
<a name="13757"><span class="lineNum">   13757 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13758"><span class="lineNum">   13758 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( c15.geometryN( 1 ) );</span></a>
<a name="13759"><span class="lineNum">   13759 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="13760"><span class="lineNum">   13760 </span>                :            : </a>
<a name="13761"><span class="lineNum">   13761 </span>                :            :   //toCurveType</a>
<a name="13762"><span class="lineNum">   13762 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiCurve &gt; curveType( c12.toCurveType() );</span></a>
<a name="13763"><span class="lineNum">   13763 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13764"><span class="lineNum">   13764 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="13765"><span class="lineNum">   13765 </span>                :<span class="lineCov">          1 :   const QgsCircularString *curve = static_cast&lt; const QgsCircularString * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="13766"><span class="lineNum">   13766 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsCircularString * &gt;( c12.geometryN( 0 ) ) );</span></a>
<a name="13767"><span class="lineNum">   13767 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsCircularString * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="13768"><span class="lineNum">   13768 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsCircularString * &gt;( c12.geometryN( 1 ) ) );</span></a>
<a name="13769"><span class="lineNum">   13769 </span>                :            : </a>
<a name="13770"><span class="lineNum">   13770 </span>                :            :   //to/fromWKB</a>
<a name="13771"><span class="lineNum">   13771 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c16;</span></a>
<a name="13772"><span class="lineNum">   13772 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 11 ) ) ;</span></a>
<a name="13773"><span class="lineNum">   13773 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13774"><span class="lineNum">   13774 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 54 ) ) ;</span></a>
<a name="13775"><span class="lineNum">   13775 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13776"><span class="lineNum">   13776 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="13777"><span class="lineNum">   13777 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c17;</span></a>
<a name="13778"><span class="lineNum">   13778 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="13779"><span class="lineNum">   13779 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="13780"><span class="lineNum">   13780 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13781"><span class="lineNum">   13781 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13782"><span class="lineNum">   13782 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13783"><span class="lineNum">   13783 </span>                :            : </a>
<a name="13784"><span class="lineNum">   13784 </span>                :            :   //parts with Z</a>
<a name="13785"><span class="lineNum">   13785 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13786"><span class="lineNum">   13786 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13787"><span class="lineNum">   13787 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 11, 3 ) ) ;</span></a>
<a name="13788"><span class="lineNum">   13788 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13789"><span class="lineNum">   13789 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 43, 43, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 53, 6 ) ) ;</span></a>
<a name="13790"><span class="lineNum">   13790 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13791"><span class="lineNum">   13791 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13792"><span class="lineNum">   13792 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="13793"><span class="lineNum">   13793 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="13794"><span class="lineNum">   13794 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13795"><span class="lineNum">   13795 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiCurveZ );</span></a>
<a name="13796"><span class="lineNum">   13796 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13797"><span class="lineNum">   13797 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13798"><span class="lineNum">   13798 </span>                :            : </a>
<a name="13799"><span class="lineNum">   13799 </span>                :            :   //parts with m</a>
<a name="13800"><span class="lineNum">   13800 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13801"><span class="lineNum">   13801 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13802"><span class="lineNum">   13802 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 13, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 11, 0, 5 ) ) ;</span></a>
<a name="13803"><span class="lineNum">   13803 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13804"><span class="lineNum">   13804 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 43, 43, 0, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 53, 0, 7 ) ) ;</span></a>
<a name="13805"><span class="lineNum">   13805 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13806"><span class="lineNum">   13806 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13807"><span class="lineNum">   13807 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="13808"><span class="lineNum">   13808 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="13809"><span class="lineNum">   13809 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13810"><span class="lineNum">   13810 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiCurveM );</span></a>
<a name="13811"><span class="lineNum">   13811 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13812"><span class="lineNum">   13812 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13813"><span class="lineNum">   13813 </span>                :            : </a>
<a name="13814"><span class="lineNum">   13814 </span>                :            :   // parts with ZM</a>
<a name="13815"><span class="lineNum">   13815 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="13816"><span class="lineNum">   13816 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13817"><span class="lineNum">   13817 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 5 ) ) ;</span></a>
<a name="13818"><span class="lineNum">   13818 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13819"><span class="lineNum">   13819 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 47, 12, 15 ) ) ;</span></a>
<a name="13820"><span class="lineNum">   13820 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="13821"><span class="lineNum">   13821 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="13822"><span class="lineNum">   13822 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="13823"><span class="lineNum">   13823 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="13824"><span class="lineNum">   13824 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="13825"><span class="lineNum">   13825 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiCurveZM );</span></a>
<a name="13826"><span class="lineNum">   13826 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="13827"><span class="lineNum">   13827 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCircularString * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="13828"><span class="lineNum">   13828 </span>                :            : </a>
<a name="13829"><span class="lineNum">   13829 </span>                :            :   //bad WKB - check for no crash</a>
<a name="13830"><span class="lineNum">   13830 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="13831"><span class="lineNum">   13831 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="13832"><span class="lineNum">   13832 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="13833"><span class="lineNum">   13833 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13834"><span class="lineNum">   13834 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="13835"><span class="lineNum">   13835 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="13836"><span class="lineNum">   13836 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="13837"><span class="lineNum">   13837 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="13838"><span class="lineNum">   13838 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13839"><span class="lineNum">   13839 </span>                :            : </a>
<a name="13840"><span class="lineNum">   13840 </span>                :            :   //to/from WKT</a>
<a name="13841"><span class="lineNum">   13841 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c18;</span></a>
<a name="13842"><span class="lineNum">   13842 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 8 ) ) ;</span></a>
<a name="13843"><span class="lineNum">   13843 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="13844"><span class="lineNum">   13844 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 53, 21, 52 ) ) ;</span></a>
<a name="13845"><span class="lineNum">   13845 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="13846"><span class="lineNum">   13846 </span>                :            : </a>
<a name="13847"><span class="lineNum">   13847 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="13848"><span class="lineNum">   13848 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="13849"><span class="lineNum">   13849 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c19;</span></a>
<a name="13850"><span class="lineNum">   13850 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="13851"><span class="lineNum">   13851 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="13852"><span class="lineNum">   13852 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c19.geometryN( 0 ) ), *static_cast&lt; const QgsCircularString * &gt;( c18.geometryN( 0 ) ) );</span></a>
<a name="13853"><span class="lineNum">   13853 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCircularString * &gt;( c19.geometryN( 1 ) ), *static_cast&lt; const QgsCircularString * &gt;( c18.geometryN( 1 ) ) );</span></a>
<a name="13854"><span class="lineNum">   13854 </span>                :            : </a>
<a name="13855"><span class="lineNum">   13855 </span>                :            :   //bad WKT</a>
<a name="13856"><span class="lineNum">   13856 </span>                :<span class="lineCov">          1 :   QgsMultiCurve c20;</span></a>
<a name="13857"><span class="lineNum">   13857 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="13858"><span class="lineNum">   13858 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="13859"><span class="lineNum">   13859 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="13860"><span class="lineNum">   13860 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::MultiCurve );</span></a>
<a name="13861"><span class="lineNum">   13861 </span>                :            : </a>
<a name="13862"><span class="lineNum">   13862 </span>                :            :   //as JSON</a>
<a name="13863"><span class="lineNum">   13863 </span>                :<span class="lineCov">          1 :   QgsMultiCurve exportC;</span></a>
<a name="13864"><span class="lineNum">   13864 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 11 ) ) ;</span></a>
<a name="13865"><span class="lineNum">   13865 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="13866"><span class="lineNum">   13866 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 47 ) ) ;</span></a>
<a name="13867"><span class="lineNum">   13867 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="13868"><span class="lineNum">   13868 </span>                :            : </a>
<a name="13869"><span class="lineNum">   13869 </span>                :            :   // GML document for compare</a>
<a name="13870"><span class="lineNum">   13870 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="13871"><span class="lineNum">   13871 </span>                :            : </a>
<a name="13872"><span class="lineNum">   13872 </span>                :            :   // as GML2</a>
<a name="13873"><span class="lineNum">   13873 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;7,17 6.9,17 6.9,17 6.8,17 6.8,17.1 6.7,17.1 6.7,17.1 6.6,17.1 6.6,17.1 6.5,17.1 6.5,17.1 6.4,17.1 6.4,17.1 6.3,17.1 6.2,17.2 6.2,17.2 6.1,17.2 6.1,17.2 6,17.2 6,17.2 5.9,17.2 5.9,17.2 5.8,17.2 5.7,17.2 5.7,17.1 5.6,17.1 5.6,17.1 5.5,17.1 5.5,17.1 5.4,17.1 5.4,17.1 5.3,17.1 5.3,17.1 5.2,17.1 5.2,17 5.1,17 5,17 5,17 4.9,17 4.9,17 4.8,16.9 4.8,16.9 4.7,16.9 4.7,16.9 4.6,16.9 4.6,16.8 4.5,16.8 4.5,16.8 4.4,16.8 4.4,16.7 4.3,16.7 4.3,16.7 4.3,16.6 4.2,16.6 4.2,16.6 4.1,16.5 4.1,16.5 4,16.5 4,16.4 3.9,16.4 3.9,16.4 3.9,16.3 3.8,16.3 3.8,16.3 3.7,16.2 3.7,16.2 3.7,16.1 3.6,16.1 3.6,16.1 3.6,16 3.5,16 3.5,15.9 3.5,15.9 3.4,15.8 3.4,15.8 3.4,15.7 3.3,15.7 3.3,15.7 3.3,15.6 3.2,15.6 3.2,15.5 3.2,15.5 3.2,15.4 3.1,15.4 3.1,15.3 3.1,15.3 3.1,15.2 3.1,15.2 3,15.1 3,15.1 3,15 3,15 3,14.9 3,14.8 2.9,14.8 2.9,14.7 2.9,14.7 2.9,14.6 2.9,14.6 2.9,14.5 2.9,14.5 2.9,14.4 2.9,14.4 2.9,14.3 2.8,14.2 2.8,14.2 2.8,14.1 2.8,14.1 2.8,14 2.8,14 2.8,13.9 2.8,13.9 2.8,13.8 2.8,13.8 2.9,13.7 2.9,13.6 2.9,13.6 2.9,13.5 2.9,13.5 2.9,13.4 2.9,13.4 2.9,13.3 2.9,13.3 2.9,13.2 3,13.2 3,13.1 3,13 3,13 3,12.9 3,12.9 3.1,12.8 3.1,12.8 3.1,12.7 3.1,12.7 3.1,12.6 3.2,12.6 3.2,12.5 3.2,12.5 3.2,12.4 3.3,12.4 3.3,12.3 3.3,12.3 3.4,12.3 3.4,12.2 3.4,12.2 3.5,12.1 3.5,12.1 3.5,12 3.6,12 3.6,11.9 3.6,11.9 3.7,11.9 3.7,11.8 3.7,11.8 3.8,11.7 3.8,11.7 3.9,11.7 3.9,11.6 3.9,11.6 4,11.6 4,11.5 4.1,11.5 4.1,11.5 4.2,11.4 4.2,11.4 4.3,11.4 4.3,11.3 4.3,11.3 4.4,11.3 4.4,11.2 4.5,11.2 4.5,11.2 4.6,11.2 4.6,11.1 4.7,11.1 4.7,11.1 4.8,11.1 4.8,11.1 4.9,11 4.9,11 5,11 5,11 5.1,11 5.2,11 5.2,10.9 5.3,10.9 5.3,10.9 5.4,10.9 5.4,10.9 5.5,10.9 5.5,10.9 5.6,10.9 5.6,10.9 5.7,10.9 5.7,10.8 5.8,10.8 5.9,10.8 5.9,10.8 6,10.8 6,10.8 6.1,10.8 6.1,10.8 6.2,10.8 6.2,10.8 6.3,10.9 6.4,10.9 6.4,10.9 6.5,10.9 6.5,10.9 6.6,10.9 6.6,10.9 6.7,10.9 6.7,10.9 6.8,10.9 6.8,11 6.9,11 6.9,11 7,11&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;27,37 27.1,36.9 27.2,36.8 27.3,36.6 27.4,36.5 27.5,36.4 27.6,36.3 27.7,36.2 27.8,36 27.9,35.9 28,35.8 28.1,35.7 28.2,35.6 28.3,35.5 28.4,35.4 28.5,35.3 28.7,35.2 28.8,35.1 28.9,35 29,34.9 29.1,34.8 29.3,34.7 29.4,34.6 29.5,34.6 29.7,34.5 29.8,34.4 29.9,34.3 30.1,34.3 30.2,34.2 30.3,34.1 30.5,34 30.6,34 30.7,33.9 30.9,33.9 31,33.8 31.2,33.7 31.3,33.7 31.5,33.6 31.6,33.6 31.8,33.6 31.9,33.5 32.1,33.5 32.2,33.4 32.4,33.4 32.5,33.4 32.7,33.3 32.8,33.3 33,33.3 33.1,33.3 33.3,33.2 33.4,33.2 33.6,33.2 33.7,33.2 33.9,33.2 34,33.2 34.2,33.2 34.3,33.2 34.5,33.2 34.6,33.2 34.8,33.2 34.9,33.2 35.1,33.2 35.3,33.3 35.4,33.3 35.6,33.3 35.7,33.3 35.9,33.3 36,33.4 36.2,33.4 36.3,33.4 36.5,33.5 36.6,33.5 36.8,33.6 36.9,33.6 37.1,33.7 37.2,33.7 37.3,33.8 37.5,33.8 37.6,33.9 37.8,33.9 37.9,34 38,34.1 38.2,34.1 38.3,34.2 38.5,34.3 38.6,34.3 38.7,34.4 38.9,34.5 39,34.6 39.1,34.7 39.2,34.7 39.4,34.8 39.5,34.9 39.6,35 39.7,35.1 39.9,35.2 40,35.3 40.1,35.4 40.2,35.5 40.3,35.6 40.4,35.7 40.5,35.8 40.6,35.9 40.7,36.1 40.8,36.2 40.9,36.3 41,36.4 41.1,36.5 41.2,36.6 41.3,36.8 41.4,36.9 41.5,37 41.6,37.1 41.7,37.3 41.8,37.4 41.8,37.5 41.9,37.7 42,37.8 42.1,37.9 42.1,38.1 42.2,38.2 42.3,38.3 42.3,38.5 42.4,38.6 42.4,38.8 42.5,38.9 42.6,39.1 42.6,39.2 42.6,39.4 42.7,39.5 42.7,39.6 42.8,39.8 42.8,39.9 42.8,40.1 42.9,40.2 42.9,40.4 42.9,40.5 43,40.7 43,40.9 43,41 43,41.2 43,41.3 43,41.5 43,41.6 43.1,41.8 43.1,41.9 43.1,42.1 43.1,42.2 43,42.4 43,42.5 43,42.7 43,42.8 43,43 43,43.1 43,43.3 42.9,43.5 42.9,43.6 42.9,43.8 42.8,43.9 42.8,44.1 42.8,44.2 42.7,44.4 42.7,44.5 42.6,44.6 42.6,44.8 42.6,44.9 42.5,45.1 42.4,45.2 42.4,45.4 42.3,45.5 42.3,45.7 42.2,45.8 42.1,45.9 42.1,46.1 42,46.2 41.9,46.3 41.8,46.5 41.8,46.6 41.7,46.7 41.6,46.9 41.5,47 41.4,47.1 41.3,47.2 41.2,47.4 41.1,47.5 41,47.6 40.9,47.7 40.8,47.8 40.7,47.9 40.6,48.1 40.5,48.2 40.4,48.3 40.3,48.4 40.2,48.5 40.1,48.6 40,48.7 39.9,48.8 39.7,48.9 39.6,49 39.5,49.1 39.4,49.2 39.2,49.3 39.1,49.3 39,49.4 38.9,49.5 38.7,49.6 38.6,49.7 38.5,49.7 38.3,49.8 38.2,49.9 38,49.9 37.9,50 37.8,50.1 37.6,50.1 37.5,50.2 37.3,50.2 37.2,50.3 37.1,50.3 36.9,50.4 36.8,50.4 36.6,50.5 36.5,50.5 36.3,50.6 36.2,50.6 36,50.6 35.9,50.7 35.7,50.7 35.6,50.7 35.4,50.7 35.3,50.7 35.1,50.8 34.9,50.8 34.8,50.8 34.6,50.8 34.5,50.8 34.3,50.8 34.2,50.8 34,50.8 33.9,50.8 33.7,50.8 33.6,50.8 33.4,50.8 33.3,50.8 33.1,50.7 33,50.7 32.8,50.7 32.7,50.7 32.5,50.6 32.4,50.6 32.2,50.6 32.1,50.5 31.9,50.5 31.8,50.4 31.6,50.4 31.5,50.4 31.3,50.3 31.2,50.3 31,50.2 30.9,50.1 30.7,50.1 30.6,50 30.5,50 30.3,49.9 30.2,49.8 30.1,49.7 29.9,49.7 29.8,49.6 29.7,49.5 29.5,49.4 29.4,49.4 29.3,49.3 29.1,49.2 29,49.1 28.9,49 28.8,48.9 28.7,48.8 28.5,48.7 28.4,48.6 28.3,48.5 28.2,48.4 28.1,48.3 28,48.2 27.9,48.1 27.8,48 27.7,47.8 27.6,47.7 27.5,47.6 27.4,47.5 27.3,47.4 27.2,47.2 27.1,47.1 27,47&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;/MultiLineString&gt;&quot; ) );</span></a>
<a name="13874"><span class="lineNum">   13874 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc, 1 ) );</span></a>
<a name="13875"><span class="lineNum">   13875 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="13876"><span class="lineNum">   13876 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="13877"><span class="lineNum">   13877 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiCurve().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="13878"><span class="lineNum">   13878 </span>                :            : </a>
<a name="13879"><span class="lineNum">   13879 </span>                :            :   //as GML3</a>
<a name="13880"><span class="lineNum">   13880 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;7 17 3 13 7 11&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;27 37 43 43 27 47&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;/MultiCurve&gt;&quot; ) );</span></a>
<a name="13881"><span class="lineNum">   13881 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="13882"><span class="lineNum">   13882 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="13883"><span class="lineNum">   13883 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="13884"><span class="lineNum">   13884 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiCurve().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="13885"><span class="lineNum">   13885 </span>                :            : </a>
<a name="13886"><span class="lineNum">   13886 </span>                :            :   // as JSON</a>
<a name="13887"><span class="lineNum">   13887 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[7.0,17.0],[6.9,17.0],[6.9,17.0],[6.8,17.0],[6.8,17.1],[6.7,17.1],[6.7,17.1],[6.6,17.1],[6.6,17.1],[6.5,17.1],[6.5,17.1],[6.4,17.1],[6.4,17.1],[6.3,17.1],[6.2,17.2],[6.2,17.2],[6.1,17.2],[6.1,17.2],[6.0,17.2],[6.0,17.2],[5.9,17.2],[5.9,17.2],[5.8,17.2],[5.7,17.2],[5.7,17.1],[5.6,17.1],[5.6,17.1],[5.5,17.1],[5.5,17.1],[5.4,17.1],[5.4,17.1],[5.3,17.1],[5.3,17.1],[5.2,17.1],[5.2,17.0],[5.1,17.0],[5.0,17.0],[5.0,17.0],[4.9,17.0],[4.9,17.0],[4.8,16.9],[4.8,16.9],[4.7,16.9],[4.7,16.9],[4.6,16.9],[4.6,16.8],[4.5,16.8],[4.5,16.8],[4.4,16.8],[4.4,16.7],[4.3,16.7],[4.3,16.7],[4.3,16.6],[4.2,16.6],[4.2,16.6],[4.1,16.5],[4.1,16.5],[4.0,16.5],[4.0,16.4],[3.9,16.4],[3.9,16.4],[3.9,16.3],[3.8,16.3],[3.8,16.3],[3.7,16.2],[3.7,16.2],[3.7,16.1],[3.6,16.1],[3.6,16.1],[3.6,16.0],[3.5,16.0],[3.5,15.9],[3.5,15.9],[3.4,15.8],[3.4,15.8],[3.4,15.7],[3.3,15.7],[3.3,15.7],[3.3,15.6],[3.2,15.6],[3.2,15.5],[3.2,15.5],[3.2,15.4],[3.1,15.4],[3.1,15.3],[3.1,15.3],[3.1,15.2],[3.1,15.2],[3.0,15.1],[3.0,15.1],[3.0,15.0],[3.0,15.0],[3.0,14.9],[3.0,14.8],[2.9,14.8],[2.9,14.7],[2.9,14.7],[2.9,14.6],[2.9,14.6],[2.9,14.5],[2.9,14.5],[2.9,14.4],[2.9,14.4],[2.9,14.3],[2.8,14.2],[2.8,14.2],[2.8,14.1],[2.8,14.1],[2.8,14.0],[2.8,14.0],[2.8,13.9],[2.8,13.9],[2.8,13.8],[2.8,13.8],[2.9,13.7],[2.9,13.6],[2.9,13.6],[2.9,13.5],[2.9,13.5],[2.9,13.4],[2.9,13.4],[2.9,13.3],[2.9,13.3],[2.9,13.2],[3.0,13.2],[3.0,13.1],[3.0,13.0],[3.0,13.0],[3.0,12.9],[3.0,12.9],[3.1,12.8],[3.1,12.8],[3.1,12.7],[3.1,12.7],[3.1,12.6],[3.2,12.6],[3.2,12.5],[3.2,12.5],[3.2,12.4],[3.3,12.4],[3.3,12.3],[3.3,12.3],[3.4,12.3],[3.4,12.2],[3.4,12.2],[3.5,12.1],[3.5,12.1],[3.5,12.0],[3.6,12.0],[3.6,11.9],[3.6,11.9],[3.7,11.9],[3.7,11.8],[3.7,11.8],[3.8,11.7],[3.8,11.7],[3.9,11.7],[3.9,11.6],[3.9,11.6],[4.0,11.6],[4.0,11.5],[4.1,11.5],[4.1,11.5],[4.2,11.4],[4.2,11.4],[4.3,11.4],[4.3,11.3],[4.3,11.3],[4.4,11.3],[4.4,11.2],[4.5,11.2],[4.5,11.2],[4.6,11.2],[4.6,11.1],[4.7,11.1],[4.7,11.1],[4.8,11.1],[4.8,11.1],[4.9,11.0],[4.9,11.0],[5.0,11.0],[5.0,11.0],[5.1,11.0],[5.2,11.0],[5.2,10.9],[5.3,10.9],[5.3,10.9],[5.4,10.9],[5.4,10.9],[5.5,10.9],[5.5,10.9],[5.6,10.9],[5.6,10.9],[5.7,10.9],[5.7,10.8],[5.8,10.8],[5.9,10.8],[5.9,10.8],[6.0,10.8],[6.0,10.8],[6.1,10.8],[6.1,10.8],[6.2,10.8],[6.2,10.8],[6.3,10.9],[6.4,10.9],[6.4,10.9],[6.5,10.9],[6.5,10.9],[6.6,10.9],[6.6,10.9],[6.7,10.9],[6.7,10.9],[6.8,10.9],[6.8,11.0],[6.9,11.0],[6.9,11.0],[7.0,11.0]],[[27.0,37.0],[27.1,36.9],[27.2,36.8],[27.3,36.6],[27.4,36.5],[27.5,36.4],[27.6,36.3],[27.7,36.2],[27.8,36.0],[27.9,35.9],[28.0,35.8],[28.1,35.7],[28.2,35.6],[28.3,35.5],[28.4,35.4],[28.5,35.3],[28.7,35.2],[28.8,35.1],[28.9,35.0],[29.0,34.9],[29.1,34.8],[29.3,34.7],[29.4,34.6],[29.5,34.6],[29.7,34.5],[29.8,34.4],[29.9,34.3],[30.1,34.3],[30.2,34.2],[30.3,34.1],[30.5,34.0],[30.6,34.0],[30.7,33.9],[30.9,33.9],[31.0,33.8],[31.2,33.7],[31.3,33.7],[31.5,33.6],[31.6,33.6],[31.8,33.6],[31.9,33.5],[32.1,33.5],[32.2,33.4],[32.4,33.4],[32.5,33.4],[32.7,33.3],[32.8,33.3],[33.0,33.3],[33.1,33.3],[33.3,33.2],[33.4,33.2],[33.6,33.2],[33.7,33.2],[33.9,33.2],[34.0,33.2],[34.2,33.2],[34.3,33.2],[34.5,33.2],[34.6,33.2],[34.8,33.2],[34.9,33.2],[35.1,33.2],[35.3,33.3],[35.4,33.3],[35.6,33.3],[35.7,33.3],[35.9,33.3],[36.0,33.4],[36.2,33.4],[36.3,33.4],[36.5,33.5],[36.6,33.5],[36.8,33.6],[36.9,33.6],[37.1,33.7],[37.2,33.7],[37.3,33.8],[37.5,33.8],[37.6,33.9],[37.8,33.9],[37.9,34.0],[38.0,34.1],[38.2,34.1],[38.3,34.2],[38.5,34.3],[38.6,34.3],[38.7,34.4],[38.9,34.5],[39.0,34.6],[39.1,34.7],[39.2,34.7],[39.4,34.8],[39.5,34.9],[39.6,35.0],[39.7,35.1],[39.9,35.2],[40.0,35.3],[40.1,35.4],[40.2,35.5],[40.3,35.6],[40.4,35.7],[40.5,35.8],[40.6,35.9],[40.7,36.1],[40.8,36.2],[40.9,36.3],[41.0,36.4],[41.1,36.5],[41.2,36.6],[41.3,36.8],[41.4,36.9],[41.5,37.0],[41.6,37.1],[41.7,37.3],[41.8,37.4],[41.8,37.5],[41.9,37.7],[42.0,37.8],[42.1,37.9],[42.1,38.1],[42.2,38.2],[42.3,38.3],[42.3,38.5],[42.4,38.6],[42.4,38.8],[42.5,38.9],[42.6,39.1],[42.6,39.2],[42.6,39.4],[42.7,39.5],[42.7,39.6],[42.8,39.8],[42.8,39.9],[42.8,40.1],[42.9,40.2],[42.9,40.4],[42.9,40.5],[43.0,40.7],[43.0,40.9],[43.0,41.0],[43.0,41.2],[43.0,41.3],[43.0,41.5],[43.0,41.6],[43.1,41.8],[43.1,41.9],[43.1,42.1],[43.1,42.2],[43.0,42.4],[43.0,42.5],[43.0,42.7],[43.0,42.8],[43.0,43.0],[43.0,43.1],[43.0,43.3],[42.9,43.5],[42.9,43.6],[42.9,43.8],[42.8,43.9],[42.8,44.1],[42.8,44.2],[42.7,44.4],[42.7,44.5],[42.6,44.6],[42.6,44.8],[42.6,44.9],[42.5,45.1],[42.4,45.2],[42.4,45.4],[42.3,45.5],[42.3,45.7],[42.2,45.8],[42.1,45.9],[42.1,46.1],[42.0,46.2],[41.9,46.3],[41.8,46.5],[41.8,46.6],[41.7,46.7],[41.6,46.9],[41.5,47.0],[41.4,47.1],[41.3,47.2],[41.2,47.4],[41.1,47.5],[41.0,47.6],[40.9,47.7],[40.8,47.8],[40.7,47.9],[40.6,48.1],[40.5,48.2],[40.4,48.3],[40.3,48.4],[40.2,48.5],[40.1,48.6],[40.0,48.7],[39.9,48.8],[39.7,48.9],[39.6,49.0],[39.5,49.1],[39.4,49.2],[39.2,49.3],[39.1,49.3],[39.0,49.4],[38.9,49.5],[38.7,49.6],[38.6,49.7],[38.5,49.7],[38.3,49.8],[38.2,49.9],[38.0,49.9],[37.9,50.0],[37.8,50.1],[37.6,50.1],[37.5,50.2],[37.3,50.2],[37.2,50.3],[37.1,50.3],[36.9,50.4],[36.8,50.4],[36.6,50.5],[36.5,50.5],[36.3,50.6],[36.2,50.6],[36.0,50.6],[35.9,50.7],[35.7,50.7],[35.6,50.7],[35.4,50.7],[35.3,50.7],[35.1,50.8],[34.9,50.8],[34.8,50.8],[34.6,50.8],[34.5,50.8],[34.3,50.8],[34.2,50.8],[34.0,50.8],[33.9,50.8],[33.7,50.8],[33.6,50.8],[33.4,50.8],[33.3,50.8],[33.1,50.7],[33.0,50.7],[32.8,50.7],[32.7,50.7],[32.5,50.6],[32.4,50.6],[32.2,50.6],[32.1,50.5],[31.9,50.5],[31.8,50.4],[31.6,50.4],[31.5,50.4],[31.3,50.3],[31.2,50.3],[31.0,50.2],[30.9,50.1],[30.7,50.1],[30.6,50.0],[30.5,50.0],[30.3,49.9],[30.2,49.8],[30.1,49.7],[29.9,49.7],[29.8,49.6],[29.7,49.5],[29.5,49.4],[29.4,49.4],[29.3,49.3],[29.1,49.2],[29.0,49.1],[28.9,49.0],[28.8,48.9],[28.7,48.8],[28.5,48.7],[28.4,48.6],[28.3,48.5],[28.2,48.4],[28.1,48.3],[28.0,48.2],[27.9,48.1],[27.8,48.0],[27.7,47.8],[27.6,47.7],[27.5,47.6],[27.4,47.5],[27.3,47.4],[27.2,47.2],[27.1,47.1],[27.0,47.0]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="13888"><span class="lineNum">   13888 </span>                :<span class="lineCov">          1 :   res = exportC.asJson( 1 );</span></a>
<a name="13889"><span class="lineNum">   13889 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="13890"><span class="lineNum">   13890 </span>                :            : </a>
<a name="13891"><span class="lineNum">   13891 </span>                :<span class="lineCov">          1 :   QgsMultiCurve exportFloat;</span></a>
<a name="13892"><span class="lineNum">   13892 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7 / 3.0, 17 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3 / 5.0, 13 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7 / 3.0, 11 / 3.0 ) ) ;</span></a>
<a name="13893"><span class="lineNum">   13893 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="13894"><span class="lineNum">   13894 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27 / 3.0, 37 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43 / 41.0, 43 / 42.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27 / 3.0, 1 / 3.0 ) ) ;</span></a>
<a name="13895"><span class="lineNum">   13895 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="13896"><span class="lineNum">   13896 </span>                :            : </a>
<a name="13897"><span class="lineNum">   13897 </span>                :<span class="lineCov">          2 :   QString expectedJsonPrec3( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[2.333,5.667],[2.316,5.677],[2.298,5.687],[2.28,5.697],[2.262,5.707],[2.244,5.716],[2.226,5.725],[2.207,5.734],[2.188,5.742],[2.17,5.75],[2.151,5.757],[2.131,5.765],[2.112,5.772],[2.093,5.778],[2.074,5.785],[2.054,5.79],[2.034,5.796],[2.015,5.801],[1.995,5.806],[1.975,5.811],[1.955,5.815],[1.935,5.819],[1.915,5.822],[1.894,5.826],[1.874,5.828],[1.854,5.831],[1.834,5.833],[1.813,5.835],[1.793,5.836],[1.773,5.837],[1.752,5.838],[1.732,5.838],[1.711,5.838],[1.691,5.838],[1.67,5.837],[1.65,5.836],[1.63,5.834],[1.609,5.833],[1.589,5.83],[1.569,5.828],[1.548,5.825],[1.528,5.822],[1.508,5.818],[1.488,5.814],[1.468,5.81],[1.448,5.805],[1.428,5.801],[1.409,5.795],[1.389,5.79],[1.37,5.784],[1.35,5.777],[1.331,5.771],[1.312,5.764],[1.293,5.756],[1.274,5.749],[1.255,5.741],[1.236,5.732],[1.218,5.724],[1.199,5.715],[1.181,5.705],[1.163,5.696],[1.145,5.686],[1.128,5.676],[1.11,5.665],[1.093,5.654],[1.076,5.643],[1.059,5.632],[1.042,5.62],[1.025,5.608],[1.009,5.596],[0.993,5.583],[0.977,5.57],[0.962,5.557],[0.946,5.543],[0.931,5.53],[0.916,5.516],[0.901,5.502],[0.887,5.487],[0.873,5.473],[0.859,5.458],[0.845,5.442],[0.832,5.427],[0.819,5.411],[0.806,5.395],[0.793,5.379],[0.781,5.363],[0.769,5.346],[0.757,5.33],[0.746,5.313],[0.735,5.296],[0.724,5.278],[0.713,5.261],[0.703,5.243],[0.693,5.225],[0.684,5.207],[0.674,5.189],[0.666,5.171],[0.657,5.152],[0.649,5.133],[0.641,5.115],[0.633,5.096],[0.626,5.077],[0.619,5.057],[0.612,5.038],[0.606,5.019],[0.6,4.999],[0.594,4.979],[0.589,4.96],[0.584,4.94],[0.579,4.92],[0.575,4.9],[0.571,4.88],[0.568,4.86],[0.564,4.84],[0.562,4.819],[0.559,4.799],[0.557,4.779],[0.555,4.759],[0.554,4.738],[0.553,4.718],[0.552,4.697],[0.552,4.677],[0.552,4.656],[0.552,4.636],[0.553,4.616],[0.554,4.595],[0.555,4.575],[0.557,4.554],[0.559,4.534],[0.562,4.514],[0.564,4.494],[0.568,4.473],[0.571,4.453],[0.575,4.433],[0.579,4.413],[0.584,4.393],[0.589,4.374],[0.594,4.354],[0.6,4.334],[0.606,4.315],[0.612,4.295],[0.619,4.276],[0.626,4.257],[0.633,4.238],[0.641,4.219],[0.649,4.2],[0.657,4.181],[0.666,4.163],[0.674,4.144],[0.684,4.126],[0.693,4.108],[0.703,4.09],[0.713,4.073],[0.724,4.055],[0.735,4.038],[0.746,4.021],[0.757,4.004],[0.769,3.987],[0.781,3.97],[0.793,3.954],[0.806,3.938],[0.819,3.922],[0.832,3.906],[0.845,3.891],[0.859,3.876],[0.873,3.861],[0.887,3.846],[0.901,3.832],[0.916,3.817],[0.931,3.804],[0.946,3.79],[0.962,3.776],[0.977,3.763],[0.993,3.75],[1.009,3.738],[1.025,3.726],[1.042,3.713],[1.059,3.702],[1.076,3.69],[1.093,3.679],[1.11,3.668],[1.128,3.658],[1.145,3.648],[1.163,3.638],[1.181,3.628],[1.199,3.619],[1.218,3.61],[1.236,3.601],[1.255,3.593],[1.274,3.585],[1.293,3.577],[1.312,3.57],[1.331,3.563],[1.35,3.556],[1.37,3.55],[1.389,3.544],[1.409,3.538],[1.428,3.533],[1.448,3.528],[1.468,3.523],[1.488,3.519],[1.508,3.515],[1.528,3.511],[1.548,3.508],[1.569,3.505],[1.589,3.503],[1.609,3.501],[1.63,3.499],[1.65,3.497],[1.67,3.496],[1.691,3.496],[1.711,3.495],[1.732,3.495],[1.752,3.496],[1.773,3.496],[1.793,3.497],[1.813,3.499],[1.834,3.5],[1.854,3.503],[1.874,3.505],[1.894,3.508],[1.915,3.511],[1.935,3.514],[1.955,3.518],[1.975,3.523],[1.995,3.527],[2.015,3.532],[2.034,3.537],[2.054,3.543],[2.074,3.549],[2.093,3.555],[2.112,3.562],[2.131,3.569],[2.151,3.576],[2.17,3.584],[2.188,3.592],[2.207,3.6],[2.226,3.608],[2.244,3.617],[2.262,3.627],[2.28,3.636],[2.298,3.646],[2.316,3.656],[2.333,3.667]],[[9.0,4.111],[8.966,4.178],[8.932,4.244],[8.896,4.309],[8.859,4.374],[8.821,4.438],[8.782,4.502],[8.742,4.565],[8.7,4.627],[8.658,4.688],[8.614,4.749],[8.57,4.809],[8.524,4.868],[8.477,4.926],[8.43,4.983],[8.381,5.04],[8.331,5.096],[8.281,5.151],[8.229,5.205],[8.177,5.258],[8.124,5.31],[8.069,5.361],[8.014,5.411],[7.958,5.461],[7.901,5.509],[7.844,5.556],[7.785,5.603],[7.726,5.648],[7.666,5.692],[7.605,5.735],[7.543,5.777],[7.481,5.818],[7.418,5.858],[7.354,5.897],[7.29,5.935],[7.225,5.971],[7.159,6.007],[7.093,6.041],[7.026,6.074],[6.958,6.106],[6.89,6.137],[6.822,6.167],[6.753,6.195],[6.683,6.222],[6.613,6.248],[6.543,6.273],[6.472,6.296],[6.401,6.319],[6.329,6.34],[6.257,6.36],[6.185,6.378],[6.112,6.395],[6.04,6.411],[5.966,6.426],[5.893,6.44],[5.819,6.452],[5.746,6.463],[5.672,6.472],[5.597,6.48],[5.523,6.487],[5.449,6.493],[5.374,6.498],[5.3,6.501],[5.225,6.503],[5.15,6.503],[5.076,6.502],[5.001,6.5],[4.927,6.497],[4.852,6.492],[4.778,6.486],[4.704,6.479],[4.629,6.47],[4.555,6.46],[4.482,6.449],[4.408,6.437],[4.335,6.423],[4.262,6.408],[4.189,6.392],[4.116,6.374],[4.044,6.355],[3.972,6.335],[3.901,6.314],[3.83,6.292],[3.759,6.268],[3.688,6.243],[3.619,6.217],[3.549,6.189],[3.48,6.16],[3.412,6.131],[3.344,6.1],[3.277,6.067],[3.21,6.034],[3.144,5.999],[3.078,5.964],[3.013,5.927],[2.949,5.889],[2.886,5.85],[2.823,5.81],[2.761,5.768],[2.699,5.726],[2.638,5.683],[2.578,5.638],[2.519,5.593],[2.461,5.546],[2.403,5.499],[2.347,5.45],[2.291,5.401],[2.236,5.35],[2.182,5.299],[2.129,5.246],[2.076,5.193],[2.025,5.139],[1.975,5.084],[1.925,5.028],[1.877,4.971],[1.829,4.914],[1.783,4.855],[1.738,4.796],[1.693,4.736],[1.65,4.675],[1.608,4.614],[1.567,4.551],[1.527,4.488],[1.488,4.425],[1.45,4.36],[1.413,4.295],[1.378,4.23],[1.343,4.164],[1.31,4.097],[1.278,4.029],[1.247,3.961],[1.217,3.893],[1.189,3.824],[1.161,3.755],[1.135,3.685],[1.11,3.614],[1.087,3.544],[1.064,3.472],[1.043,3.401],[1.023,3.329],[1.004,3.257],[0.987,3.184],[0.971,3.111],[0.956,3.038],[0.942,2.965],[0.93,2.891],[0.919,2.817],[0.909,2.743],[0.901,2.669],[0.894,2.595],[0.888,2.52],[0.883,2.446],[0.88,2.371],[0.878,2.297],[0.878,2.222],[0.878,2.148],[0.88,2.073],[0.883,1.998],[0.888,1.924],[0.894,1.85],[0.901,1.775],[0.909,1.701],[0.919,1.627],[0.93,1.553],[0.942,1.48],[0.956,1.406],[0.971,1.333],[0.987,1.26],[1.004,1.188],[1.023,1.116],[1.043,1.044],[1.064,0.972],[1.087,0.901],[1.11,0.83],[1.135,0.76],[1.161,0.69],[1.189,0.62],[1.217,0.551],[1.247,0.483],[1.278,0.415],[1.31,0.348],[1.343,0.281],[1.378,0.215],[1.413,0.149],[1.45,0.084],[1.488,0.02],[1.527,-0.044],[1.567,-0.107],[1.608,-0.169],[1.65,-0.231],[1.693,-0.291],[1.738,-0.351],[1.783,-0.411],[1.829,-0.469],[1.877,-0.527],[1.925,-0.584],[1.975,-0.639],[2.025,-0.694],[2.076,-0.749],[2.129,-0.802],[2.182,-0.854],[2.236,-0.906],[2.291,-0.956],[2.347,-1.006],[2.403,-1.054],[2.461,-1.102],[2.519,-1.148],[2.578,-1.194],[2.638,-1.238],[2.699,-1.282],[2.761,-1.324],[2.823,-1.365],[2.886,-1.405],[2.949,-1.444],[3.013,-1.482],[3.078,-1.519],[3.144,-1.555],[3.21,-1.589],[3.277,-1.623],[3.344,-1.655],[3.412,-1.686],[3.48,-1.716],[3.549,-1.745],[3.619,-1.772],[3.688,-1.798],[3.759,-1.823],[3.83,-1.847],[3.901,-1.87],[3.972,-1.891],[4.044,-1.911],[4.116,-1.93],[4.189,-1.947],[4.262,-1.964],[4.335,-1.979],[4.408,-1.992],[4.482,-2.005],[4.555,-2.016],[4.629,-2.026],[4.704,-2.034],[4.778,-2.042],[4.852,-2.048],[4.927,-2.052],[5.001,-2.056],[5.076,-2.058],[5.15,-2.059],[5.225,-2.058],[5.3,-2.056],[5.374,-2.053],[5.449,-2.049],[5.523,-2.043],[5.597,-2.036],[5.672,-2.028],[5.746,-2.018],[5.819,-2.007],[5.893,-1.995],[5.966,-1.982],[6.04,-1.967],[6.112,-1.951],[6.185,-1.934],[6.257,-1.915],[6.329,-1.895],[6.401,-1.874],[6.472,-1.852],[6.543,-1.829],[6.613,-1.804],[6.683,-1.778],[6.753,-1.751],[6.822,-1.722],[6.89,-1.693],[6.958,-1.662],[7.026,-1.63],[7.093,-1.597],[7.159,-1.562],[7.225,-1.527],[7.29,-1.49],[7.354,-1.453],[7.418,-1.414],[7.481,-1.374],[7.543,-1.333],[7.605,-1.291],[7.666,-1.248],[7.726,-1.203],[7.785,-1.158],[7.844,-1.112],[7.901,-1.065],[7.958,-1.016],[8.014,-0.967],[8.069,-0.917],[8.124,-0.865],[8.177,-0.813],[8.229,-0.76],[8.281,-0.706],[8.331,-0.651],[8.381,-0.596],[8.43,-0.539],[8.477,-0.482],[8.524,-0.423],[8.57,-0.364],[8.614,-0.304],[8.658,-0.244],[8.7,-0.182],[8.742,-0.12],[8.782,-0.057],[8.821,0.006],[8.859,0.07],[8.896,0.135],[8.932,0.201],[8.966,0.267],[9.0,0.333]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; ) );</span></a>
<a name="13898"><span class="lineNum">   13898 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="13899"><span class="lineNum">   13899 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="13900"><span class="lineNum">   13900 </span>                :            : </a>
<a name="13901"><span class="lineNum">   13901 </span>                :            :   // as GML2</a>
<a name="13902"><span class="lineNum">   13902 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;MultiLineString xmlns=\&quot;gml\&quot;&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;2.333,5.667 2.316,5.677 2.298,5.687 2.28,5.697 2.262,5.707 2.244,5.716 2.226,5.725 2.207,5.734 2.188,5.742 2.17,5.75 2.151,5.757 2.131,5.765 2.112,5.772 2.093,5.778 2.074,5.785 2.054,5.79 2.034,5.796 2.015,5.801 1.995,5.806 1.975,5.811 1.955,5.815 1.935,5.819 1.915,5.822 1.894,5.826 1.874,5.828 1.854,5.831 1.834,5.833 1.813,5.835 1.793,5.836 1.773,5.837 1.752,5.838 1.732,5.838 1.711,5.838 1.691,5.838 1.67,5.837 1.65,5.836 1.63,5.834 1.609,5.833 1.589,5.83 1.569,5.828 1.548,5.825 1.528,5.822 1.508,5.818 1.488,5.814 1.468,5.81 1.448,5.805 1.428,5.801 1.409,5.795 1.389,5.79 1.37,5.784 1.35,5.777 1.331,5.771 1.312,5.764 1.293,5.756 1.274,5.749 1.255,5.741 1.236,5.732 1.218,5.724 1.199,5.715 1.181,5.705 1.163,5.696 1.145,5.686 1.128,5.676 1.11,5.665 1.093,5.654 1.076,5.643 1.059,5.632 1.042,5.62 1.025,5.608 1.009,5.596 0.993,5.583 0.977,5.57 0.962,5.557 0.946,5.543 0.931,5.53 0.916,5.516 0.901,5.502 0.887,5.487 0.873,5.473 0.859,5.458 0.845,5.442 0.832,5.427 0.819,5.411 0.806,5.395 0.793,5.379 0.781,5.363 0.769,5.346 0.757,5.33 0.746,5.313 0.735,5.296 0.724,5.278 0.713,5.261 0.703,5.243 0.693,5.225 0.684,5.207 0.674,5.189 0.666,5.171 0.657,5.152 0.649,5.133 0.641,5.115 0.633,5.096 0.626,5.077 0.619,5.057 0.612,5.038 0.606,5.019 0.6,4.999 0.594,4.979 0.589,4.96 0.584,4.94 0.579,4.92 0.575,4.9 0.571,4.88 0.568,4.86 0.564,4.84 0.562,4.819 0.559,4.799 0.557,4.779 0.555,4.759 0.554,4.738 0.553,4.718 0.552,4.697 0.552,4.677 0.552,4.656 0.552,4.636 0.553,4.616 0.554,4.595 0.555,4.575 0.557,4.554 0.559,4.534 0.562,4.514 0.564,4.494 0.568,4.473 0.571,4.453 0.575,4.433 0.579,4.413 0.584,4.393 0.589,4.374 0.594,4.354 0.6,4.334 0.606,4.315 0.612,4.295 0.619,4.276 0.626,4.257 0.633,4.238 0.641,4.219 0.649,4.2 0.657,4.181 0.666,4.163 0.674,4.144 0.684,4.126 0.693,4.108 0.703,4.09 0.713,4.073 0.724,4.055 0.735,4.038 0.746,4.021 0.757,4.004 0.769,3.987 0.781,3.97 0.793,3.954 0.806,3.938 0.819,3.922 0.832,3.906 0.845,3.891 0.859,3.876 0.873,3.861 0.887,3.846 0.901,3.832 0.916,3.817 0.931,3.804 0.946,3.79 0.962,3.776 0.977,3.763 0.993,3.75 1.009,3.738 1.025,3.726 1.042,3.713 1.059,3.702 1.076,3.69 1.093,3.679 1.11,3.668 1.128,3.658 1.145,3.648 1.163,3.638 1.181,3.628 1.199,3.619 1.218,3.61 1.236,3.601 1.255,3.593 1.274,3.585 1.293,3.577 1.312,3.57 1.331,3.563 1.35,3.556 1.37,3.55 1.389,3.544 1.409,3.538 1.428,3.533 1.448,3.528 1.468,3.523 1.488,3.519 1.508,3.515 1.528,3.511 1.548,3.508 1.569,3.505 1.589,3.503 1.609,3.501 1.63,3.499 1.65,3.497 1.67,3.496 1.691,3.496 1.711,3.495 1.732,3.495 1.752,3.496 1.773,3.496 1.793,3.497 1.813,3.499 1.834,3.5 1.854,3.503 1.874,3.505 1.894,3.508 1.915,3.511 1.935,3.514 1.955,3.518 1.975,3.523 1.995,3.527 2.015,3.532 2.034,3.537 2.054,3.543 2.074,3.549 2.093,3.555 2.112,3.562 2.131,3.569 2.151,3.576 2.17,3.584 2.188,3.592 2.207,3.6 2.226,3.608 2.244,3.617 2.262,3.627 2.28,3.636 2.298,3.646 2.316,3.656 2.333,3.667&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;lineStringMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;9,4.111 8.966,4.178 8.932,4.244 8.896,4.309 8.859,4.374 8.821,4.438 8.782,4.502 8.742,4.565 8.7,4.627 8.658,4.688 8.614,4.749 8.57,4.809 8.524,4.868 8.477,4.926 8.43,4.983 8.381,5.04 8.331,5.096 8.281,5.151 8.229,5.205 8.177,5.258 8.124,5.31 8.069,5.361 8.014,5.411 7.958,5.461 7.901,5.509 7.844,5.556 7.785,5.603 7.726,5.648 7.666,5.692 7.605,5.735 7.543,5.777 7.481,5.818 7.418,5.858 7.354,5.897 7.29,5.935 7.225,5.971 7.159,6.007 7.093,6.041 7.026,6.074 6.958,6.106 6.89,6.137 6.822,6.167 6.753,6.195 6.683,6.222 6.613,6.248 6.543,6.273 6.472,6.296 6.401,6.319 6.329,6.34 6.257,6.36 6.185,6.378 6.112,6.395 6.04,6.411 5.966,6.426 5.893,6.44 5.819,6.452 5.746,6.463 5.672,6.472 5.597,6.48 5.523,6.487 5.449,6.493 5.374,6.498 5.3,6.501 5.225,6.503 5.15,6.503 5.076,6.502 5.001,6.5 4.927,6.497 4.852,6.492 4.778,6.486 4.704,6.479 4.629,6.47 4.555,6.46 4.482,6.449 4.408,6.437 4.335,6.423 4.262,6.408 4.189,6.392 4.116,6.374 4.044,6.355 3.972,6.335 3.901,6.314 3.83,6.292 3.759,6.268 3.688,6.243 3.619,6.217 3.549,6.189 3.48,6.16 3.412,6.131 3.344,6.1 3.277,6.067 3.21,6.034 3.144,5.999 3.078,5.964 3.013,5.927 2.949,5.889 2.886,5.85 2.823,5.81 2.761,5.768 2.699,5.726 2.638,5.683 2.578,5.638 2.519,5.593 2.461,5.546 2.403,5.499 2.347,5.45 2.291,5.401 2.236,5.35 2.182,5.299 2.129,5.246 2.076,5.193 2.025,5.139 1.975,5.084 1.925,5.028 1.877,4.971 1.829,4.914 1.783,4.855 1.738,4.796 1.693,4.736 1.65,4.675 1.608,4.614 1.567,4.551 1.527,4.488 1.488,4.425 1.45,4.36 1.413,4.295 1.378,4.23 1.343,4.164 1.31,4.097 1.278,4.029 1.247,3.961 1.217,3.893 1.189,3.824 1.161,3.755 1.135,3.685 1.11,3.614 1.087,3.544 1.064,3.472 1.043,3.401 1.023,3.329 1.004,3.257 0.987,3.184 0.971,3.111 0.956,3.038 0.942,2.965 0.93,2.891 0.919,2.817 0.909,2.743 0.901,2.669 0.894,2.595 0.888,2.52 0.883,2.446 0.88,2.371 0.878,2.297 0.878,2.222 0.878,2.148 0.88,2.073 0.883,1.998 0.888,1.924 0.894,1.85 0.901,1.775 0.909,1.701 0.919,1.627 0.93,1.553 0.942,1.48 0.956,1.406 0.971,1.333 0.987,1.26 1.004,1.188 1.023,1.116 1.043,1.044 1.064,0.972 1.087,0.901 1.11,0.83 1.135,0.76 1.161,0.69 1.189,0.62 1.217,0.551 1.247,0.483 1.278,0.415 1.31,0.348 1.343,0.281 1.378,0.215 1.413,0.149 1.45,0.084 1.488,0.02 1.527,-0.044 1.567,-0.107 1.608,-0.169 1.65,-0.231 1.693,-0.291 1.738,-0.351 1.783,-0.411 1.829,-0.469 1.877,-0.527 1.925,-0.584 1.975,-0.639 2.025,-0.694 2.076,-0.749 2.129,-0.802 2.182,-0.854 2.236,-0.906 2.291,-0.956 2.347,-1.006 2.403,-1.054 2.461,-1.102 2.519,-1.148 2.578,-1.194 2.638,-1.238 2.699,-1.282 2.761,-1.324 2.823,-1.365 2.886,-1.405 2.949,-1.444 3.013,-1.482 3.078,-1.519 3.144,-1.555 3.21,-1.589 3.277,-1.623 3.344,-1.655 3.412,-1.686 3.48,-1.716 3.549,-1.745 3.619,-1.772 3.688,-1.798 3.759,-1.823 3.83,-1.847 3.901,-1.87 3.972,-1.891 4.044,-1.911 4.116,-1.93 4.189,-1.947 4.262,-1.964 4.335,-1.979 4.408,-1.992 4.482,-2.005 4.555,-2.016 4.629,-2.026 4.704,-2.034 4.778,-2.042 4.852,-2.048 4.927,-2.052 5.001,-2.056 5.076,-2.058 5.15,-2.059 5.225,-2.058 5.3,-2.056 5.374,-2.053 5.449,-2.049 5.523,-2.043 5.597,-2.036 5.672,-2.028 5.746,-2.018 5.819,-2.007 5.893,-1.995 5.966,-1.982 6.04,-1.967 6.112,-1.951 6.185,-1.934 6.257,-1.915 6.329,-1.895 6.401,-1.874 6.472,-1.852 6.543,-1.829 6.613,-1.804 6.683,-1.778 6.753,-1.751 6.822,-1.722 6.89,-1.693 6.958,-1.662 7.026,-1.63 7.093,-1.597 7.159,-1.562 7.225,-1.527 7.29,-1.49 7.354,-1.453 7.418,-1.414 7.481,-1.374 7.543,-1.333 7.605,-1.291 7.666,-1.248 7.726,-1.203 7.785,-1.158 7.844,-1.112 7.901,-1.065 7.958,-1.016 8.014,-0.967 8.069,-0.917 8.124,-0.865 8.177,-0.813 8.229,-0.76 8.281,-0.706 8.331,-0.651 8.381,-0.596 8.43,-0.539 8.477,-0.482 8.524,-0.423 8.57,-0.364 8.614,-0.304 8.658,-0.244 8.7,-0.182 8.742,-0.12 8.782,-0.057 8.821,0.006 8.859,0.07 8.896,0.135 8.932,0.201 8.966,0.267 9,0.333&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/lineStringMember&gt;&lt;/MultiLineString&gt;&quot; ) );</span></a>
<a name="13903"><span class="lineNum">   13903 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="13904"><span class="lineNum">   13904 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="13905"><span class="lineNum">   13905 </span>                :            : </a>
<a name="13906"><span class="lineNum">   13906 </span>                :            :   //as GML3</a>
<a name="13907"><span class="lineNum">   13907 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;MultiCurve xmlns=\&quot;gml\&quot;&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;2.333 5.667 0.6 4.333 2.333 3.667&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;curveMember xmlns=\&quot;gml\&quot;&gt;&lt;Curve xmlns=\&quot;gml\&quot;&gt;&lt;segments xmlns=\&quot;gml\&quot;&gt;&lt;ArcString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;9 4.111 1.049 1.024 9 0.333&lt;/posList&gt;&lt;/ArcString&gt;&lt;/segments&gt;&lt;/Curve&gt;&lt;/curveMember&gt;&lt;/MultiCurve&gt;&quot; ) );</span></a>
<a name="13908"><span class="lineNum">   13908 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="13909"><span class="lineNum">   13909 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="13910"><span class="lineNum">   13910 </span>                :            : </a>
<a name="13911"><span class="lineNum">   13911 </span>                :            :   //asKML</a>
<a name="13912"><span class="lineNum">   13912 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;7,17,0 6.9,17,0 6.9,17,0 6.8,17,0 6.8,17.1,0 6.7,17.1,0 6.7,17.1,0 6.6,17.1,0 6.6,17.1,0 6.5,17.1,0 6.5,17.1,0 6.4,17.1,0 6.4,17.1,0 6.3,17.1,0 6.2,17.2,0 6.2,17.2,0 6.1,17.2,0 6.1,17.2,0 6,17.2,0 6,17.2,0 5.9,17.2,0 5.9,17.2,0 5.8,17.2,0 5.7,17.2,0 5.7,17.1,0 5.6,17.1,0 5.6,17.1,0 5.5,17.1,0 5.5,17.1,0 5.4,17.1,0 5.4,17.1,0 5.3,17.1,0 5.3,17.1,0 5.2,17.1,0 5.2,17,0 5.1,17,0 5,17,0 5,17,0 4.9,17,0 4.9,17,0 4.8,16.9,0 4.8,16.9,0 4.7,16.9,0 4.7,16.9,0 4.6,16.9,0 4.6,16.8,0 4.5,16.8,0 4.5,16.8,0 4.4,16.8,0 4.4,16.7,0 4.3,16.7,0 4.3,16.7,0 4.3,16.6,0 4.2,16.6,0 4.2,16.6,0 4.1,16.5,0 4.1,16.5,0 4,16.5,0 4,16.4,0 3.9,16.4,0 3.9,16.4,0 3.9,16.3,0 3.8,16.3,0 3.8,16.3,0 3.7,16.2,0 3.7,16.2,0 3.7,16.1,0 3.6,16.1,0 3.6,16.1,0 3.6,16,0 3.5,16,0 3.5,15.9,0 3.5,15.9,0 3.4,15.8,0 3.4,15.8,0 3.4,15.7,0 3.3,15.7,0 3.3,15.7,0 3.3,15.6,0 3.2,15.6,0 3.2,15.5,0 3.2,15.5,0 3.2,15.4,0 3.1,15.4,0 3.1,15.3,0 3.1,15.3,0 3.1,15.2,0 3.1,15.2,0 3,15.1,0 3,15.1,0 3,15,0 3,15,0 3,14.9,0 3,14.8,0 2.9,14.8,0 2.9,14.7,0 2.9,14.7,0 2.9,14.6,0 2.9,14.6,0 2.9,14.5,0 2.9,14.5,0 2.9,14.4,0 2.9,14.4,0 2.9,14.3,0 2.8,14.2,0 2.8,14.2,0 2.8,14.1,0 2.8,14.1,0 2.8,14,0 2.8,14,0 2.8,13.9,0 2.8,13.9,0 2.8,13.8,0 2.8,13.8,0 2.9,13.7,0 2.9,13.6,0 2.9,13.6,0 2.9,13.5,0 2.9,13.5,0 2.9,13.4,0 2.9,13.4,0 2.9,13.3,0 2.9,13.3,0 2.9,13.2,0 3,13.2,0 3,13.1,0 3,13,0 3,13,0 3,12.9,0 3,12.9,0 3.1,12.8,0 3.1,12.8,0 3.1,12.7,0 3.1,12.7,0 3.1,12.6,0 3.2,12.6,0 3.2,12.5,0 3.2,12.5,0 3.2,12.4,0 3.3,12.4,0 3.3,12.3,0 3.3,12.3,0 3.4,12.3,0 3.4,12.2,0 3.4,12.2,0 3.5,12.1,0 3.5,12.1,0 3.5,12,0 3.6,12,0 3.6,11.9,0 3.6,11.9,0 3.7,11.9,0 3.7,11.8,0 3.7,11.8,0 3.8,11.7,0 3.8,11.7,0 3.9,11.7,0 3.9,11.6,0 3.9,11.6,0 4,11.6,0 4,11.5,0 4.1,11.5,0 4.1,11.5,0 4.2,11.4,0 4.2,11.4,0 4.3,11.4,0 4.3,11.3,0 4.3,11.3,0 4.4,11.3,0 4.4,11.2,0 4.5,11.2,0 4.5,11.2,0 4.6,11.2,0 4.6,11.1,0 4.7,11.1,0 4.7,11.1,0 4.8,11.1,0 4.8,11.1,0 4.9,11,0 4.9,11,0 5,11,0 5,11,0 5.1,11,0 5.2,11,0 5.2,10.9,0 5.3,10.9,0 5.3,10.9,0 5.4,10.9,0 5.4,10.9,0 5.5,10.9,0 5.5,10.9,0 5.6,10.9,0 5.6,10.9,0 5.7,10.9,0 5.7,10.8,0 5.8,10.8,0 5.9,10.8,0 5.9,10.8,0 6,10.8,0 6,10.8,0 6.1,10.8,0 6.1,10.8,0 6.2,10.8,0 6.2,10.8,0 6.3,10.9,0 6.4,10.9,0 6.4,10.9,0 6.5,10.9,0 6.5,10.9,0 6.6,10.9,0 6.6,10.9,0 6.7,10.9,0 6.7,10.9,0 6.8,10.9,0 6.8,11,0 6.9,11,0 6.9,11,0 7,11,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;27,37,0 27.1,36.9,0 27.2,36.8,0 27.3,36.6,0 27.4,36.5,0 27.5,36.4,0 27.6,36.3,0 27.7,36.2,0 27.8,36,0 27.9,35.9,0 28,35.8,0 28.1,35.7,0 28.2,35.6,0 28.3,35.5,0 28.4,35.4,0 28.5,35.3,0 28.7,35.2,0 28.8,35.1,0 28.9,35,0 29,34.9,0 29.1,34.8,0 29.3,34.7,0 29.4,34.6,0 29.5,34.6,0 29.7,34.5,0 29.8,34.4,0 29.9,34.3,0 30.1,34.3,0 30.2,34.2,0 30.3,34.1,0 30.5,34,0 30.6,34,0 30.7,33.9,0 30.9,33.9,0 31,33.8,0 31.2,33.7,0 31.3,33.7,0 31.5,33.6,0 31.6,33.6,0 31.8,33.6,0 31.9,33.5,0 32.1,33.5,0 32.2,33.4,0 32.4,33.4,0 32.5,33.4,0 32.7,33.3,0 32.8,33.3,0 33,33.3,0 33.1,33.3,0 33.3,33.2,0 33.4,33.2,0 33.6,33.2,0 33.7,33.2,0 33.9,33.2,0 34,33.2,0 34.2,33.2,0 34.3,33.2,0 34.5,33.2,0 34.6,33.2,0 34.8,33.2,0 34.9,33.2,0 35.1,33.2,0 35.3,33.3,0 35.4,33.3,0 35.6,33.3,0 35.7,33.3,0 35.9,33.3,0 36,33.4,0 36.2,33.4,0 36.3,33.4,0 36.5,33.5,0 36.6,33.5,0 36.8,33.6,0 36.9,33.6,0 37.1,33.7,0 37.2,33.7,0 37.3,33.8,0 37.5,33.8,0 37.6,33.9,0 37.8,33.9,0 37.9,34,0 38,34.1,0 38.2,34.1,0 38.3,34.2,0 38.5,34.3,0 38.6,34.3,0 38.7,34.4,0 38.9,34.5,0 39,34.6,0 39.1,34.7,0 39.2,34.7,0 39.4,34.8,0 39.5,34.9,0 39.6,35,0 39.7,35.1,0 39.9,35.2,0 40,35.3,0 40.1,35.4,0 40.2,35.5,0 40.3,35.6,0 40.4,35.7,0 40.5,35.8,0 40.6,35.9,0 40.7,36.1,0 40.8,36.2,0 40.9,36.3,0 41,36.4,0 41.1,36.5,0 41.2,36.6,0 41.3,36.8,0 41.4,36.9,0 41.5,37,0 41.6,37.1,0 41.7,37.3,0 41.8,37.4,0 41.8,37.5,0 41.9,37.7,0 42,37.8,0 42.1,37.9,0 42.1,38.1,0 42.2,38.2,0 42.3,38.3,0 42.3,38.5,0 42.4,38.6,0 42.4,38.8,0 42.5,38.9,0 42.6,39.1,0 42.6,39.2,0 42.6,39.4,0 42.7,39.5,0 42.7,39.6,0 42.8,39.8,0 42.8,39.9,0 42.8,40.1,0 42.9,40.2,0 42.9,40.4,0 42.9,40.5,0 43,40.7,0 43,40.9,0 43,41,0 43,41.2,0 43,41.3,0 43,41.5,0 43,41.6,0 43.1,41.8,0 43.1,41.9,0 43.1,42.1,0 43.1,42.2,0 43,42.4,0 43,42.5,0 43,42.7,0 43,42.8,0 43,43,0 43,43.1,0 43,43.3,0 42.9,43.5,0 42.9,43.6,0 42.9,43.8,0 42.8,43.9,0 42.8,44.1,0 42.8,44.2,0 42.7,44.4,0 42.7,44.5,0 42.6,44.6,0 42.6,44.8,0 42.6,44.9,0 42.5,45.1,0 42.4,45.2,0 42.4,45.4,0 42.3,45.5,0 42.3,45.7,0 42.2,45.8,0 42.1,45.9,0 42.1,46.1,0 42,46.2,0 41.9,46.3,0 41.8,46.5,0 41.8,46.6,0 41.7,46.7,0 41.6,46.9,0 41.5,47,0 41.4,47.1,0 41.3,47.2,0 41.2,47.4,0 41.1,47.5,0 41,47.6,0 40.9,47.7,0 40.8,47.8,0 40.7,47.9,0 40.6,48.1,0 40.5,48.2,0 40.4,48.3,0 40.3,48.4,0 40.2,48.5,0 40.1,48.6,0 40,48.7,0 39.9,48.8,0 39.7,48.9,0 39.6,49,0 39.5,49.1,0 39.4,49.2,0 39.2,49.3,0 39.1,49.3,0 39,49.4,0 38.9,49.5,0 38.7,49.6,0 38.6,49.7,0 38.5,49.7,0 38.3,49.8,0 38.2,49.9,0 38,49.9,0 37.9,50,0 37.8,50.1,0 37.6,50.1,0 37.5,50.2,0 37.3,50.2,0 37.2,50.3,0 37.1,50.3,0 36.9,50.4,0 36.8,50.4,0 36.6,50.5,0 36.5,50.5,0 36.3,50.6,0 36.2,50.6,0 36,50.6,0 35.9,50.7,0 35.7,50.7,0 35.6,50.7,0 35.4,50.7,0 35.3,50.7,0 35.1,50.8,0 34.9,50.8,0 34.8,50.8,0 34.6,50.8,0 34.5,50.8,0 34.3,50.8,0 34.2,50.8,0 34,50.8,0 33.9,50.8,0 33.7,50.8,0 33.6,50.8,0 33.4,50.8,0 33.3,50.8,0 33.1,50.7,0 33,50.7,0 32.8,50.7,0 32.7,50.7,0 32.5,50.6,0 32.4,50.6,0 32.2,50.6,0 32.1,50.5,0 31.9,50.5,0 31.8,50.4,0 31.6,50.4,0 31.5,50.4,0 31.3,50.3,0 31.2,50.3,0 31,50.2,0 30.9,50.1,0 30.7,50.1,0 30.6,50,0 30.5,50,0 30.3,49.9,0 30.2,49.8,0 30.1,49.7,0 29.9,49.7,0 29.8,49.6,0 29.7,49.5,0 29.5,49.4,0 29.4,49.4,0 29.3,49.3,0 29.1,49.2,0 29,49.1,0 28.9,49,0 28.8,48.9,0 28.7,48.8,0 28.5,48.7,0 28.4,48.6,0 28.3,48.5,0 28.2,48.4,0 28.1,48.3,0 28,48.2,0 27.9,48.1,0 27.8,48,0 27.7,47.8,0 27.6,47.7,0 27.5,47.6,0 27.4,47.5,0 27.3,47.4,0 27.2,47.2,0 27.1,47.1,0 27,47,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="13913"><span class="lineNum">   13913 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportC.asKml( 1 ), expectedKml );</span></a>
<a name="13914"><span class="lineNum">   13914 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;2.333,5.667,0 2.316,5.677,0 2.298,5.687,0 2.28,5.697,0 2.262,5.707,0 2.244,5.716,0 2.226,5.725,0 2.207,5.734,0 2.188,5.742,0 2.17,5.75,0 2.151,5.757,0 2.131,5.765,0 2.112,5.772,0 2.093,5.778,0 2.074,5.785,0 2.054,5.79,0 2.034,5.796,0 2.015,5.801,0 1.995,5.806,0 1.975,5.811,0 1.955,5.815,0 1.935,5.819,0 1.915,5.822,0 1.894,5.826,0 1.874,5.828,0 1.854,5.831,0 1.834,5.833,0 1.813,5.835,0 1.793,5.836,0 1.773,5.837,0 1.752,5.838,0 1.732,5.838,0 1.711,5.838,0 1.691,5.838,0 1.67,5.837,0 1.65,5.836,0 1.63,5.834,0 1.609,5.833,0 1.589,5.83,0 1.569,5.828,0 1.548,5.825,0 1.528,5.822,0 1.508,5.818,0 1.488,5.814,0 1.468,5.81,0 1.448,5.805,0 1.428,5.801,0 1.409,5.795,0 1.389,5.79,0 1.37,5.784,0 1.35,5.777,0 1.331,5.771,0 1.312,5.764,0 1.293,5.756,0 1.274,5.749,0 1.255,5.741,0 1.236,5.732,0 1.218,5.724,0 1.199,5.715,0 1.181,5.705,0 1.163,5.696,0 1.145,5.686,0 1.128,5.676,0 1.11,5.665,0 1.093,5.654,0 1.076,5.643,0 1.059,5.632,0 1.042,5.62,0 1.025,5.608,0 1.009,5.596,0 0.993,5.583,0 0.977,5.57,0 0.962,5.557,0 0.946,5.543,0 0.931,5.53,0 0.916,5.516,0 0.901,5.502,0 0.887,5.487,0 0.873,5.473,0 0.859,5.458,0 0.845,5.442,0 0.832,5.427,0 0.819,5.411,0 0.806,5.395,0 0.793,5.379,0 0.781,5.363,0 0.769,5.346,0 0.757,5.33,0 0.746,5.313,0 0.735,5.296,0 0.724,5.278,0 0.713,5.261,0 0.703,5.243,0 0.693,5.225,0 0.684,5.207,0 0.674,5.189,0 0.666,5.171,0 0.657,5.152,0 0.649,5.133,0 0.641,5.115,0 0.633,5.096,0 0.626,5.077,0 0.619,5.057,0 0.612,5.038,0 0.606,5.019,0 0.6,4.999,0 0.594,4.979,0 0.589,4.96,0 0.584,4.94,0 0.579,4.92,0 0.575,4.9,0 0.571,4.88,0 0.568,4.86,0 0.564,4.84,0 0.562,4.819,0 0.559,4.799,0 0.557,4.779,0 0.555,4.759,0 0.554,4.738,0 0.553,4.718,0 0.552,4.697,0 0.552,4.677,0 0.552,4.656,0 0.552,4.636,0 0.553,4.616,0 0.554,4.595,0 0.555,4.575,0 0.557,4.554,0 0.559,4.534,0 0.562,4.514,0 0.564,4.494,0 0.568,4.473,0 0.571,4.453,0 0.575,4.433,0 0.579,4.413,0 0.584,4.393,0 0.589,4.374,0 0.594,4.354,0 0.6,4.334,0 0.606,4.315,0 0.612,4.295,0 0.619,4.276,0 0.626,4.257,0 0.633,4.238,0 0.641,4.219,0 0.649,4.2,0 0.657,4.181,0 0.666,4.163,0 0.674,4.144,0 0.684,4.126,0 0.693,4.108,0 0.703,4.09,0 0.713,4.073,0 0.724,4.055,0 0.735,4.038,0 0.746,4.021,0 0.757,4.004,0 0.769,3.987,0 0.781,3.97,0 0.793,3.954,0 0.806,3.938,0 0.819,3.922,0 0.832,3.906,0 0.845,3.891,0 0.859,3.876,0 0.873,3.861,0 0.887,3.846,0 0.901,3.832,0 0.916,3.817,0 0.931,3.804,0 0.946,3.79,0 0.962,3.776,0 0.977,3.763,0 0.993,3.75,0 1.009,3.738,0 1.025,3.726,0 1.042,3.713,0 1.059,3.702,0 1.076,3.69,0 1.093,3.679,0 1.11,3.668,0 1.128,3.658,0 1.145,3.648,0 1.163,3.638,0 1.181,3.628,0 1.199,3.619,0 1.218,3.61,0 1.236,3.601,0 1.255,3.593,0 1.274,3.585,0 1.293,3.577,0 1.312,3.57,0 1.331,3.563,0 1.35,3.556,0 1.37,3.55,0 1.389,3.544,0 1.409,3.538,0 1.428,3.533,0 1.448,3.528,0 1.468,3.523,0 1.488,3.519,0 1.508,3.515,0 1.528,3.511,0 1.548,3.508,0 1.569,3.505,0 1.589,3.503,0 1.609,3.501,0 1.63,3.499,0 1.65,3.497,0 1.67,3.496,0 1.691,3.496,0 1.711,3.495,0 1.732,3.495,0 1.752,3.496,0 1.773,3.496,0 1.793,3.497,0 1.813,3.499,0 1.834,3.5,0 1.854,3.503,0 1.874,3.505,0 1.894,3.508,0 1.915,3.511,0 1.935,3.514,0 1.955,3.518,0 1.975,3.523,0 1.995,3.527,0 2.015,3.532,0 2.034,3.537,0 2.054,3.543,0 2.074,3.549,0 2.093,3.555,0 2.112,3.562,0 2.131,3.569,0 2.151,3.576,0 2.17,3.584,0 2.188,3.592,0 2.207,3.6,0 2.226,3.608,0 2.244,3.617,0 2.262,3.627,0 2.28,3.636,0 2.298,3.646,0 2.316,3.656,0 2.333,3.667,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;9,4.111,0 8.966,4.178,0 8.932,4.244,0 8.896,4.309,0 8.859,4.374,0 8.821,4.438,0 8.782,4.502,0 8.742,4.565,0 8.7,4.627,0 8.658,4.688,0 8.614,4.749,0 8.57,4.809,0 8.524,4.868,0 8.477,4.926,0 8.43,4.983,0 8.381,5.04,0 8.331,5.096,0 8.281,5.151,0 8.229,5.205,0 8.177,5.258,0 8.124,5.31,0 8.069,5.361,0 8.014,5.411,0 7.958,5.461,0 7.901,5.509,0 7.844,5.556,0 7.785,5.603,0 7.726,5.648,0 7.666,5.692,0 7.605,5.735,0 7.543,5.777,0 7.481,5.818,0 7.418,5.858,0 7.354,5.897,0 7.29,5.935,0 7.225,5.971,0 7.159,6.007,0 7.093,6.041,0 7.026,6.074,0 6.958,6.106,0 6.89,6.137,0 6.822,6.167,0 6.753,6.195,0 6.683,6.222,0 6.613,6.248,0 6.543,6.273,0 6.472,6.296,0 6.401,6.319,0 6.329,6.34,0 6.257,6.36,0 6.185,6.378,0 6.112,6.395,0 6.04,6.411,0 5.966,6.426,0 5.893,6.44,0 5.819,6.452,0 5.746,6.463,0 5.672,6.472,0 5.597,6.48,0 5.523,6.487,0 5.449,6.493,0 5.374,6.498,0 5.3,6.501,0 5.225,6.503,0 5.15,6.503,0 5.076,6.502,0 5.001,6.5,0 4.927,6.497,0 4.852,6.492,0 4.778,6.486,0 4.704,6.479,0 4.629,6.47,0 4.555,6.46,0 4.482,6.449,0 4.408,6.437,0 4.335,6.423,0 4.262,6.408,0 4.189,6.392,0 4.116,6.374,0 4.044,6.355,0 3.972,6.335,0 3.901,6.314,0 3.83,6.292,0 3.759,6.268,0 3.688,6.243,0 3.619,6.217,0 3.549,6.189,0 3.48,6.16,0 3.412,6.131,0 3.344,6.1,0 3.277,6.067,0 3.21,6.034,0 3.144,5.999,0 3.078,5.964,0 3.013,5.927,0 2.949,5.889,0 2.886,5.85,0 2.823,5.81,0 2.761,5.768,0 2.699,5.726,0 2.638,5.683,0 2.578,5.638,0 2.519,5.593,0 2.461,5.546,0 2.403,5.499,0 2.347,5.45,0 2.291,5.401,0 2.236,5.35,0 2.182,5.299,0 2.129,5.246,0 2.076,5.193,0 2.025,5.139,0 1.975,5.084,0 1.925,5.028,0 1.877,4.971,0 1.829,4.914,0 1.783,4.855,0 1.738,4.796,0 1.693,4.736,0 1.65,4.675,0 1.608,4.614,0 1.567,4.551,0 1.527,4.488,0 1.488,4.425,0 1.45,4.36,0 1.413,4.295,0 1.378,4.23,0 1.343,4.164,0 1.31,4.097,0 1.278,4.029,0 1.247,3.961,0 1.217,3.893,0 1.189,3.824,0 1.161,3.755,0 1.135,3.685,0 1.11,3.614,0 1.087,3.544,0 1.064,3.472,0 1.043,3.401,0 1.023,3.329,0 1.004,3.257,0 0.987,3.184,0 0.971,3.111,0 0.956,3.038,0 0.942,2.965,0 0.93,2.891,0 0.919,2.817,0 0.909,2.743,0 0.901,2.669,0 0.894,2.595,0 0.888,2.52,0 0.883,2.446,0 0.88,2.371,0 0.878,2.297,0 0.878,2.222,0 0.878,2.148,0 0.88,2.073,0 0.883,1.998,0 0.888,1.924,0 0.894,1.85,0 0.901,1.775,0 0.909,1.701,0 0.919,1.627,0 0.93,1.553,0 0.942,1.48,0 0.956,1.406,0 0.971,1.333,0 0.987,1.26,0 1.004,1.188,0 1.023,1.116,0 1.043,1.044,0 1.064,0.972,0 1.087,0.901,0 1.11,0.83,0 1.135,0.76,0 1.161,0.69,0 1.189,0.62,0 1.217,0.551,0 1.247,0.483,0 1.278,0.415,0 1.31,0.348,0 1.343,0.281,0 1.378,0.215,0 1.413,0.149,0 1.45,0.084,0 1.488,0.02,0 1.527,-0.044,0 1.567,-0.107,0 1.608,-0.169,0 1.65,-0.231,0 1.693,-0.291,0 1.738,-0.351,0 1.783,-0.411,0 1.829,-0.469,0 1.877,-0.527,0 1.925,-0.584,0 1.975,-0.639,0 2.025,-0.694,0 2.076,-0.749,0 2.129,-0.802,0 2.182,-0.854,0 2.236,-0.906,0 2.291,-0.956,0 2.347,-1.006,0 2.403,-1.054,0 2.461,-1.102,0 2.519,-1.148,0 2.578,-1.194,0 2.638,-1.238,0 2.699,-1.282,0 2.761,-1.324,0 2.823,-1.365,0 2.886,-1.405,0 2.949,-1.444,0 3.013,-1.482,0 3.078,-1.519,0 3.144,-1.555,0 3.21,-1.589,0 3.277,-1.623,0 3.344,-1.655,0 3.412,-1.686,0 3.48,-1.716,0 3.549,-1.745,0 3.619,-1.772,0 3.688,-1.798,0 3.759,-1.823,0 3.83,-1.847,0 3.901,-1.87,0 3.972,-1.891,0 4.044,-1.911,0 4.116,-1.93,0 4.189,-1.947,0 4.262,-1.964,0 4.335,-1.979,0 4.408,-1.992,0 4.482,-2.005,0 4.555,-2.016,0 4.629,-2.026,0 4.704,-2.034,0 4.778,-2.042,0 4.852,-2.048,0 4.927,-2.052,0 5.001,-2.056,0 5.076,-2.058,0 5.15,-2.059,0 5.225,-2.058,0 5.3,-2.056,0 5.374,-2.053,0 5.449,-2.049,0 5.523,-2.043,0 5.597,-2.036,0 5.672,-2.028,0 5.746,-2.018,0 5.819,-2.007,0 5.893,-1.995,0 5.966,-1.982,0 6.04,-1.967,0 6.112,-1.951,0 6.185,-1.934,0 6.257,-1.915,0 6.329,-1.895,0 6.401,-1.874,0 6.472,-1.852,0 6.543,-1.829,0 6.613,-1.804,0 6.683,-1.778,0 6.753,-1.751,0 6.822,-1.722,0 6.89,-1.693,0 6.958,-1.662,0 7.026,-1.63,0 7.093,-1.597,0 7.159,-1.562,0 7.225,-1.527,0 7.29,-1.49,0 7.354,-1.453,0 7.418,-1.414,0 7.481,-1.374,0 7.543,-1.333,0 7.605,-1.291,0 7.666,-1.248,0 7.726,-1.203,0 7.785,-1.158,0 7.844,-1.112,0 7.901,-1.065,0 7.958,-1.016,0 8.014,-0.967,0 8.069,-0.917,0 8.124,-0.865,0 8.177,-0.813,0 8.229,-0.76,0 8.281,-0.706,0 8.331,-0.651,0 8.381,-0.596,0 8.43,-0.539,0 8.477,-0.482,0 8.524,-0.423,0 8.57,-0.364,0 8.614,-0.304,0 8.658,-0.244,0 8.7,-0.182,0 8.742,-0.12,0 8.782,-0.057,0 8.821,0.006,0 8.859,0.07,0 8.896,0.135,0 8.932,0.201,0 8.966,0.267,0 9,0.333,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="13915"><span class="lineNum">   13915 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="13916"><span class="lineNum">   13916 </span>                :            : </a>
<a name="13917"><span class="lineNum">   13917 </span>                :            :   // insert geometry</a>
<a name="13918"><span class="lineNum">   13918 </span>                :<span class="lineCov">          1 :   QgsMultiCurve rc;</span></a>
<a name="13919"><span class="lineNum">   13919 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="13920"><span class="lineNum">   13920 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="13921"><span class="lineNum">   13921 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13922"><span class="lineNum">   13922 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13923"><span class="lineNum">   13923 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="13924"><span class="lineNum">   13924 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13925"><span class="lineNum">   13925 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13926"><span class="lineNum">   13926 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="13927"><span class="lineNum">   13927 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13928"><span class="lineNum">   13928 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13929"><span class="lineNum">   13929 </span>                :            : </a>
<a name="13930"><span class="lineNum">   13930 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( new QgsPoint(), 0 );</span></a>
<a name="13931"><span class="lineNum">   13931 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="13932"><span class="lineNum">   13932 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="13933"><span class="lineNum">   13933 </span>                :            : </a>
<a name="13934"><span class="lineNum">   13934 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part.clone(), 0 );</span></a>
<a name="13935"><span class="lineNum">   13935 </span>                :<span class="lineCov">          1 :   QVERIFY( !rc.isEmpty() );</span></a>
<a name="13936"><span class="lineNum">   13936 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="13937"><span class="lineNum">   13937 </span>                :            : </a>
<a name="13938"><span class="lineNum">   13938 </span>                :            :   // cast</a>
<a name="13939"><span class="lineNum">   13939 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsMultiCurve().cast( nullptr ) );</span></a>
<a name="13940"><span class="lineNum">   13940 </span>                :<span class="lineCov">          1 :   QgsMultiCurve pCast;</span></a>
<a name="13941"><span class="lineNum">   13941 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiCurve().cast( &amp;pCast ) );</span></a>
<a name="13942"><span class="lineNum">   13942 </span>                :<span class="lineCov">          1 :   QgsMultiCurve pCast2;</span></a>
<a name="13943"><span class="lineNum">   13943 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiCurveZ()&quot; ) );</span></a>
<a name="13944"><span class="lineNum">   13944 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiCurve().cast( &amp;pCast2 ) );</span></a>
<a name="13945"><span class="lineNum">   13945 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiCurveM()&quot; ) );</span></a>
<a name="13946"><span class="lineNum">   13946 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiCurve().cast( &amp;pCast2 ) );</span></a>
<a name="13947"><span class="lineNum">   13947 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiCurveZM()&quot; ) );</span></a>
<a name="13948"><span class="lineNum">   13948 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiCurve().cast( &amp;pCast2 ) );</span></a>
<a name="13949"><span class="lineNum">   13949 </span>                :            : </a>
<a name="13950"><span class="lineNum">   13950 </span>                :            :   //boundary</a>
<a name="13951"><span class="lineNum">   13951 </span>                :<span class="lineCov">          1 :   QgsMultiCurve multiLine1;</span></a>
<a name="13952"><span class="lineNum">   13952 </span>                :<span class="lineCov">          1 :   QVERIFY( !multiLine1.boundary() );</span></a>
<a name="13953"><span class="lineNum">   13953 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine1;</span></a>
<a name="13954"><span class="lineNum">   13954 </span>                :<span class="lineCov">          1 :   boundaryLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="13955"><span class="lineNum">   13955 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine1.clone() );</span></a>
<a name="13956"><span class="lineNum">   13956 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = multiLine1.boundary();</span></a>
<a name="13957"><span class="lineNum">   13957 </span>                :<span class="lineCov">          1 :   QgsMultiPoint *mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13958"><span class="lineNum">   13958 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13959"><span class="lineNum">   13959 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 2 );</span></a>
<a name="13960"><span class="lineNum">   13960 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13961"><span class="lineNum">   13961 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13962"><span class="lineNum">   13962 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13963"><span class="lineNum">   13963 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13964"><span class="lineNum">   13964 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13965"><span class="lineNum">   13965 </span>                :            :   // add another QgsCircularString</a>
<a name="13966"><span class="lineNum">   13966 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine2;</span></a>
<a name="13967"><span class="lineNum">   13967 </span>                :<span class="lineCov">          1 :   boundaryLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 11, 11 ) );</span></a>
<a name="13968"><span class="lineNum">   13968 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine2.clone() );</span></a>
<a name="13969"><span class="lineNum">   13969 </span>                :<span class="lineCov">          1 :   boundary = multiLine1.boundary();</span></a>
<a name="13970"><span class="lineNum">   13970 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13971"><span class="lineNum">   13971 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13972"><span class="lineNum">   13972 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="13973"><span class="lineNum">   13973 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13974"><span class="lineNum">   13974 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13975"><span class="lineNum">   13975 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13976"><span class="lineNum">   13976 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13977"><span class="lineNum">   13977 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="13978"><span class="lineNum">   13978 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="13979"><span class="lineNum">   13979 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 11.0 );</span></a>
<a name="13980"><span class="lineNum">   13980 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 11.0 );</span></a>
<a name="13981"><span class="lineNum">   13981 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="13982"><span class="lineNum">   13982 </span>                :            : </a>
<a name="13983"><span class="lineNum">   13983 </span>                :            :   // add a closed string = no boundary</a>
<a name="13984"><span class="lineNum">   13984 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine3;</span></a>
<a name="13985"><span class="lineNum">   13985 </span>                :<span class="lineCov">          1 :   boundaryLine3.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 20, 20 ) &lt;&lt; QgsPoint( 21, 20 ) &lt;&lt;  QgsPoint( 20, 20 ) );</span></a>
<a name="13986"><span class="lineNum">   13986 </span>                :<span class="lineCov">          1 :   multiLine1.addGeometry( boundaryLine3.clone() );</span></a>
<a name="13987"><span class="lineNum">   13987 </span>                :<span class="lineCov">          1 :   boundary = multiLine1.boundary();</span></a>
<a name="13988"><span class="lineNum">   13988 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="13989"><span class="lineNum">   13989 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="13990"><span class="lineNum">   13990 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="13991"><span class="lineNum">   13991 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="13992"><span class="lineNum">   13992 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="13993"><span class="lineNum">   13993 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="13994"><span class="lineNum">   13994 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="13995"><span class="lineNum">   13995 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="13996"><span class="lineNum">   13996 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="13997"><span class="lineNum">   13997 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 11.0 );</span></a>
<a name="13998"><span class="lineNum">   13998 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 11.0 );</span></a>
<a name="13999"><span class="lineNum">   13999 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="14000"><span class="lineNum">   14000 </span>                :            : </a>
<a name="14001"><span class="lineNum">   14001 </span>                :            :   //boundary with z</a>
<a name="14002"><span class="lineNum">   14002 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine4;</span></a>
<a name="14003"><span class="lineNum">   14003 </span>                :<span class="lineCov">          1 :   boundaryLine4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 20 ) );</span></a>
<a name="14004"><span class="lineNum">   14004 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine5;</span></a>
<a name="14005"><span class="lineNum">   14005 </span>                :<span class="lineCov">          1 :   boundaryLine5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 150 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 20, 200 ) );</span></a>
<a name="14006"><span class="lineNum">   14006 </span>                :<span class="lineCov">          1 :   QgsMultiCurve multiLine2;</span></a>
<a name="14007"><span class="lineNum">   14007 </span>                :<span class="lineCov">          1 :   multiLine2.addGeometry( boundaryLine4.clone() );</span></a>
<a name="14008"><span class="lineNum">   14008 </span>                :<span class="lineCov">          1 :   multiLine2.addGeometry( boundaryLine5.clone() );</span></a>
<a name="14009"><span class="lineNum">   14009 </span>                :            : </a>
<a name="14010"><span class="lineNum">   14010 </span>                :<span class="lineCov">          1 :   boundary = multiLine2.boundary();</span></a>
<a name="14011"><span class="lineNum">   14011 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiPoint * &gt;( boundary );</span></a>
<a name="14012"><span class="lineNum">   14012 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="14013"><span class="lineNum">   14013 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="14014"><span class="lineNum">   14014 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="14015"><span class="lineNum">   14015 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;x(), 0.0 );</span></a>
<a name="14016"><span class="lineNum">   14016 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;y(), 0.0 );</span></a>
<a name="14017"><span class="lineNum">   14017 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 0 ) )-&gt;z(), 10.0 );</span></a>
<a name="14018"><span class="lineNum">   14018 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="14019"><span class="lineNum">   14019 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;x(), 1.0 );</span></a>
<a name="14020"><span class="lineNum">   14020 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;y(), 1.0 );</span></a>
<a name="14021"><span class="lineNum">   14021 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 1 ) )-&gt;z(), 20.0 );</span></a>
<a name="14022"><span class="lineNum">   14022 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 2 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="14023"><span class="lineNum">   14023 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;x(), 10.0 );</span></a>
<a name="14024"><span class="lineNum">   14024 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;y(), 10.0 );</span></a>
<a name="14025"><span class="lineNum">   14025 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 2 ) )-&gt;z(), 100.0 );</span></a>
<a name="14026"><span class="lineNum">   14026 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;geometryN( 3 )-&gt;wkbType(), QgsWkbTypes::PointZ );</span></a>
<a name="14027"><span class="lineNum">   14027 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;x(), 20.0 );</span></a>
<a name="14028"><span class="lineNum">   14028 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;y(), 20.0 );</span></a>
<a name="14029"><span class="lineNum">   14029 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; QgsPoint *&gt;( mpBoundary-&gt;geometryN( 3 ) )-&gt;z(), 200.0 );</span></a>
<a name="14030"><span class="lineNum">   14030 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="14031"><span class="lineNum">   14031 </span>                :            : </a>
<a name="14032"><span class="lineNum">   14032 </span>                :            :   //reversed</a>
<a name="14033"><span class="lineNum">   14033 </span>                :<span class="lineCov">          1 :   QgsMultiCurve cR;</span></a>
<a name="14034"><span class="lineNum">   14034 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiCurve &gt; reversed( cR.reversed() );</span></a>
<a name="14035"><span class="lineNum">   14035 </span>                :<span class="lineCov">          1 :   QVERIFY( reversed-&gt;isEmpty() );</span></a>
<a name="14036"><span class="lineNum">   14036 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 8 ) ) ;</span></a>
<a name="14037"><span class="lineNum">   14037 </span>                :<span class="lineCov">          1 :   cR.addGeometry( part.clone() );</span></a>
<a name="14038"><span class="lineNum">   14038 </span>                :<span class="lineCov">          1 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 53, 21, 52 ) ) ;</span></a>
<a name="14039"><span class="lineNum">   14039 </span>                :<span class="lineCov">          1 :   cR.addGeometry( part.clone() );</span></a>
<a name="14040"><span class="lineNum">   14040 </span>                :<span class="lineCov">          1 :   reversed.reset( cR.reversed() );</span></a>
<a name="14041"><span class="lineNum">   14041 </span>                :<span class="lineCov">          1 :   QVERIFY( !reversed-&gt;isEmpty() );</span></a>
<a name="14042"><span class="lineNum">   14042 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( reversed-&gt;geometryN( 0 ) );</span></a>
<a name="14043"><span class="lineNum">   14043 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 8 ) );</span></a>
<a name="14044"><span class="lineNum">   14044 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) );</span></a>
<a name="14045"><span class="lineNum">   14045 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) );</span></a>
<a name="14046"><span class="lineNum">   14046 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCircularString * &gt;( reversed-&gt;geometryN( 1 ) );</span></a>
<a name="14047"><span class="lineNum">   14047 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 27, 53, 21, 52 ) );</span></a>
<a name="14048"><span class="lineNum">   14048 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 ) );</span></a>
<a name="14049"><span class="lineNum">   14049 </span>                :<span class="lineCov">          1 :   QCOMPARE( ls-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) );</span></a>
<a name="14050"><span class="lineNum">   14050 </span>                :            : </a>
<a name="14051"><span class="lineNum">   14051 </span>                :            :   // segmentize</a>
<a name="14052"><span class="lineNum">   14052 </span>                :<span class="lineCov">          1 :   QgsMultiCurve multiCurve2;</span></a>
<a name="14053"><span class="lineNum">   14053 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve compoundCurve2;</span></a>
<a name="14054"><span class="lineNum">   14054 </span>                :<span class="lineCov">          1 :   QgsCircularString circularString2;</span></a>
<a name="14055"><span class="lineNum">   14055 </span>                :<span class="lineCov">          1 :   circularString2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 21, 2 ) );</span></a>
<a name="14056"><span class="lineNum">   14056 </span>                :<span class="lineCov">          1 :   compoundCurve2.addCurve( circularString2.clone() );</span></a>
<a name="14057"><span class="lineNum">   14057 </span>                :<span class="lineCov">          1 :   multiCurve2.addGeometry( compoundCurve2.clone() );</span></a>
<a name="14058"><span class="lineNum">   14058 </span>                :<span class="lineCov">          1 :   QgsMultiLineString *segmentized2 = static_cast&lt;QgsMultiLineString *&gt;( multiCurve2.segmentize() );</span></a>
<a name="14059"><span class="lineNum">   14059 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized2-&gt;vertexCount(), 156 );</span></a>
<a name="14060"><span class="lineNum">   14060 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized2-&gt;partCount(), 1 );</span></a>
<a name="14061"><span class="lineNum">   14061 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized2-&gt;is3D() );</span></a>
<a name="14062"><span class="lineNum">   14062 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentized2-&gt;isMeasure() );</span></a>
<a name="14063"><span class="lineNum">   14063 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentized2-&gt;wkbType(),  QgsWkbTypes::Type::MultiLineString );</span></a>
<a name="14064"><span class="lineNum">   14064 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="14065"><span class="lineNum">   14065 </span>                :            : </a>
<a name="14066"><span class="lineNum">   14066 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::multiSurface()</span></a>
<a name="14067"><span class="lineNum">   14067 </span>                :            : {</a>
<a name="14068"><span class="lineNum">   14068 </span>                :            :   //test constructor</a>
<a name="14069"><span class="lineNum">   14069 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c1;</span></a>
<a name="14070"><span class="lineNum">   14070 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14071"><span class="lineNum">   14071 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14072"><span class="lineNum">   14072 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14073"><span class="lineNum">   14073 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14074"><span class="lineNum">   14074 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="14075"><span class="lineNum">   14075 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="14076"><span class="lineNum">   14076 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14077"><span class="lineNum">   14077 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiSurface&quot; ) );</span></a>
<a name="14078"><span class="lineNum">   14078 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiSurface&quot; ) );</span></a>
<a name="14079"><span class="lineNum">   14079 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="14080"><span class="lineNum">   14080 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="14081"><span class="lineNum">   14081 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="14082"><span class="lineNum">   14082 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="14083"><span class="lineNum">   14083 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14084"><span class="lineNum">   14084 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14085"><span class="lineNum">   14085 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14086"><span class="lineNum">   14086 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="14087"><span class="lineNum">   14087 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="14088"><span class="lineNum">   14088 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="14089"><span class="lineNum">   14089 </span>                :            : </a>
<a name="14090"><span class="lineNum">   14090 </span>                :            :   //addGeometry</a>
<a name="14091"><span class="lineNum">   14091 </span>                :            :   //try with nullptr</a>
<a name="14092"><span class="lineNum">   14092 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="14093"><span class="lineNum">   14093 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14094"><span class="lineNum">   14094 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14095"><span class="lineNum">   14095 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14096"><span class="lineNum">   14096 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14097"><span class="lineNum">   14097 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14098"><span class="lineNum">   14098 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14099"><span class="lineNum">   14099 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14100"><span class="lineNum">   14100 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14101"><span class="lineNum">   14101 </span>                :            : </a>
<a name="14102"><span class="lineNum">   14102 </span>                :            :   // not a surface</a>
<a name="14103"><span class="lineNum">   14103 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.addGeometry( new QgsPoint() ) );</span></a>
<a name="14104"><span class="lineNum">   14104 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14105"><span class="lineNum">   14105 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14106"><span class="lineNum">   14106 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14107"><span class="lineNum">   14107 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14108"><span class="lineNum">   14108 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14109"><span class="lineNum">   14109 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14110"><span class="lineNum">   14110 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14111"><span class="lineNum">   14111 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14112"><span class="lineNum">   14112 </span>                :            : </a>
<a name="14113"><span class="lineNum">   14113 </span>                :            :   //valid geometry</a>
<a name="14114"><span class="lineNum">   14114 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon part;</span></a>
<a name="14115"><span class="lineNum">   14115 </span>                :<span class="lineCov">          1 :   QgsCircularString ring;</span></a>
<a name="14116"><span class="lineNum">   14116 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 1, 10 ) );</span></a>
<a name="14117"><span class="lineNum">   14117 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14118"><span class="lineNum">   14118 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="14119"><span class="lineNum">   14119 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="14120"><span class="lineNum">   14120 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="14121"><span class="lineNum">   14121 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 3 );</span></a>
<a name="14122"><span class="lineNum">   14122 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="14123"><span class="lineNum">   14123 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="14124"><span class="lineNum">   14124 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="14125"><span class="lineNum">   14125 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="14126"><span class="lineNum">   14126 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14127"><span class="lineNum">   14127 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiSurface&quot; ) );</span></a>
<a name="14128"><span class="lineNum">   14128 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiSurface&quot; ) );</span></a>
<a name="14129"><span class="lineNum">   14129 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 2 );</span></a>
<a name="14130"><span class="lineNum">   14130 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.hasCurvedSegments() );</span></a>
<a name="14131"><span class="lineNum">   14131 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="14132"><span class="lineNum">   14132 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c1.geometryN( 0 ) ), part );</span></a>
<a name="14133"><span class="lineNum">   14133 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="14134"><span class="lineNum">   14134 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14135"><span class="lineNum">   14135 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 3 );</span></a>
<a name="14136"><span class="lineNum">   14136 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="14137"><span class="lineNum">   14137 </span>                :            : </a>
<a name="14138"><span class="lineNum">   14138 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="14139"><span class="lineNum">   14139 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 21, 2 )</span></a>
<a name="14140"><span class="lineNum">   14140 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) );</span></a>
<a name="14141"><span class="lineNum">   14141 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14142"><span class="lineNum">   14142 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14143"><span class="lineNum">   14143 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c2;</span></a>
<a name="14144"><span class="lineNum">   14144 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="14145"><span class="lineNum">   14145 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="14146"><span class="lineNum">   14146 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="14147"><span class="lineNum">   14147 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::MultiSurfaceZ );</span></a>
<a name="14148"><span class="lineNum">   14148 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;MultiSurfaceZ&quot; ) );</span></a>
<a name="14149"><span class="lineNum">   14149 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;MultiSurface&quot; ) );</span></a>
<a name="14150"><span class="lineNum">   14150 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCurvePolygon * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="14151"><span class="lineNum">   14151 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c3;</span></a>
<a name="14152"><span class="lineNum">   14152 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 20, 21, 0, 2 )</span></a>
<a name="14153"><span class="lineNum">   14153 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) );</span></a>
<a name="14154"><span class="lineNum">   14154 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14155"><span class="lineNum">   14155 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14156"><span class="lineNum">   14156 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="14157"><span class="lineNum">   14157 </span>                :<span class="lineCov">          1 :   QVERIFY( !c3.is3D() );</span></a>
<a name="14158"><span class="lineNum">   14158 </span>                :<span class="lineCov">          1 :   QVERIFY( c3.isMeasure() );</span></a>
<a name="14159"><span class="lineNum">   14159 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="14160"><span class="lineNum">   14160 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;MultiSurfaceM&quot; ) );</span></a>
<a name="14161"><span class="lineNum">   14161 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCurvePolygon * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="14162"><span class="lineNum">   14162 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c4;</span></a>
<a name="14163"><span class="lineNum">   14163 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 20, 21, 3, 2 )</span></a>
<a name="14164"><span class="lineNum">   14164 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) );</span></a>
<a name="14165"><span class="lineNum">   14165 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14166"><span class="lineNum">   14166 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14167"><span class="lineNum">   14167 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="14168"><span class="lineNum">   14168 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.is3D() );</span></a>
<a name="14169"><span class="lineNum">   14169 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="14170"><span class="lineNum">   14170 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14171"><span class="lineNum">   14171 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;MultiSurfaceZM&quot; ) );</span></a>
<a name="14172"><span class="lineNum">   14172 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsCurvePolygon * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="14173"><span class="lineNum">   14173 </span>                :            : </a>
<a name="14174"><span class="lineNum">   14174 </span>                :            :   //add another part</a>
<a name="14175"><span class="lineNum">   14175 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c6;</span></a>
<a name="14176"><span class="lineNum">   14176 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 1, 10 ) );</span></a>
<a name="14177"><span class="lineNum">   14177 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14178"><span class="lineNum">   14178 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14179"><span class="lineNum">   14179 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14180"><span class="lineNum">   14180 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="14181"><span class="lineNum">   14181 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 9, 12 ) &lt;&lt; QgsPoint( 3, 13 )  &lt;&lt; QgsPoint( 9, 12 ) );</span></a>
<a name="14182"><span class="lineNum">   14182 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14183"><span class="lineNum">   14183 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14184"><span class="lineNum">   14184 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14185"><span class="lineNum">   14185 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="14186"><span class="lineNum">   14186 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="14187"><span class="lineNum">   14187 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="14188"><span class="lineNum">   14188 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="14189"><span class="lineNum">   14189 </span>                :            : </a>
<a name="14190"><span class="lineNum">   14190 </span>                :            :   //adding subsequent points should not alter z/m type, regardless of parts type</a>
<a name="14191"><span class="lineNum">   14191 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14192"><span class="lineNum">   14192 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14193"><span class="lineNum">   14193 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14194"><span class="lineNum">   14194 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 1, 10, 2 ) ) ;</span></a>
<a name="14195"><span class="lineNum">   14195 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14196"><span class="lineNum">   14196 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14197"><span class="lineNum">   14197 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14198"><span class="lineNum">   14198 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14199"><span class="lineNum">   14199 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="14200"><span class="lineNum">   14200 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="14201"><span class="lineNum">   14201 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 0 );</span></a>
<a name="14202"><span class="lineNum">   14202 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( -1, 0 ), 0 );</span></a>
<a name="14203"><span class="lineNum">   14203 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 6 );</span></a>
<a name="14204"><span class="lineNum">   14204 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="14205"><span class="lineNum">   14205 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 2 );</span></a>
<a name="14206"><span class="lineNum">   14206 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14207"><span class="lineNum">   14207 </span>                :<span class="lineCov">          1 :   const QgsCurvePolygon *ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14208"><span class="lineNum">   14208 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 9, 12 ) );</span></a>
<a name="14209"><span class="lineNum">   14209 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 3, 13 ) );</span></a>
<a name="14210"><span class="lineNum">   14210 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 9, 12 ) );</span></a>
<a name="14211"><span class="lineNum">   14211 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14212"><span class="lineNum">   14212 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 10 ) );</span></a>
<a name="14213"><span class="lineNum">   14213 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 2, 11 ) );</span></a>
<a name="14214"><span class="lineNum">   14214 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 1, 10 ) );</span></a>
<a name="14215"><span class="lineNum">   14215 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 32, 41, 0, 3 )</span></a>
<a name="14216"><span class="lineNum">   14216 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) ) ;</span></a>
<a name="14217"><span class="lineNum">   14217 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14218"><span class="lineNum">   14218 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14219"><span class="lineNum">   14219 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14220"><span class="lineNum">   14220 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14221"><span class="lineNum">   14221 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 3 );</span></a>
<a name="14222"><span class="lineNum">   14222 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 3 );</span></a>
<a name="14223"><span class="lineNum">   14223 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 3 );</span></a>
<a name="14224"><span class="lineNum">   14224 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 9 );</span></a>
<a name="14225"><span class="lineNum">   14225 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="14226"><span class="lineNum">   14226 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 3 );</span></a>
<a name="14227"><span class="lineNum">   14227 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14228"><span class="lineNum">   14228 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="14229"><span class="lineNum">   14229 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14230"><span class="lineNum">   14230 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 21, 30 ) );</span></a>
<a name="14231"><span class="lineNum">   14231 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 32, 41 ) );</span></a>
<a name="14232"><span class="lineNum">   14232 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 21, 30 ) );</span></a>
<a name="14233"><span class="lineNum">   14233 </span>                :            : </a>
<a name="14234"><span class="lineNum">   14234 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14235"><span class="lineNum">   14235 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 1, 10, 2 ) ) ;</span></a>
<a name="14236"><span class="lineNum">   14236 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14237"><span class="lineNum">   14237 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14238"><span class="lineNum">   14238 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14239"><span class="lineNum">   14239 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZ );</span></a>
<a name="14240"><span class="lineNum">   14240 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 ) &lt;&lt; QgsPoint( 2, 20 ) ) ;</span></a>
<a name="14241"><span class="lineNum">   14241 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14242"><span class="lineNum">   14242 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14243"><span class="lineNum">   14243 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14244"><span class="lineNum">   14244 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZ );</span></a>
<a name="14245"><span class="lineNum">   14245 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14246"><span class="lineNum">   14246 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14247"><span class="lineNum">   14247 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="14248"><span class="lineNum">   14248 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 2, 11, 3 ) );</span></a>
<a name="14249"><span class="lineNum">   14249 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="14250"><span class="lineNum">   14250 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14251"><span class="lineNum">   14251 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="14252"><span class="lineNum">   14252 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 3, 31, 0 ) );</span></a>
<a name="14253"><span class="lineNum">   14253 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="14254"><span class="lineNum">   14254 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="14255"><span class="lineNum">   14255 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) ) ;</span></a>
<a name="14256"><span class="lineNum">   14256 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14257"><span class="lineNum">   14257 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14258"><span class="lineNum">   14258 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14259"><span class="lineNum">   14259 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZ );</span></a>
<a name="14260"><span class="lineNum">   14260 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14261"><span class="lineNum">   14261 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="14262"><span class="lineNum">   14262 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14263"><span class="lineNum">   14263 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="14264"><span class="lineNum">   14264 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 6, 61, 0 ) );</span></a>
<a name="14265"><span class="lineNum">   14265 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="14266"><span class="lineNum">   14266 </span>                :            : </a>
<a name="14267"><span class="lineNum">   14267 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14268"><span class="lineNum">   14268 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14269"><span class="lineNum">   14269 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="14270"><span class="lineNum">   14270 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) ) ;</span></a>
<a name="14271"><span class="lineNum">   14271 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14272"><span class="lineNum">   14272 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14273"><span class="lineNum">   14273 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14274"><span class="lineNum">   14274 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="14275"><span class="lineNum">   14275 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 )   &lt;&lt; QgsPoint( 2, 20 ) ) ;</span></a>
<a name="14276"><span class="lineNum">   14276 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14277"><span class="lineNum">   14277 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14278"><span class="lineNum">   14278 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14279"><span class="lineNum">   14279 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="14280"><span class="lineNum">   14280 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14281"><span class="lineNum">   14281 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14282"><span class="lineNum">   14282 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="14283"><span class="lineNum">   14283 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) );</span></a>
<a name="14284"><span class="lineNum">   14284 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="14285"><span class="lineNum">   14285 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14286"><span class="lineNum">   14286 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="14287"><span class="lineNum">   14287 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 3, 31, 0, 0 ) );</span></a>
<a name="14288"><span class="lineNum">   14288 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="14289"><span class="lineNum">   14289 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 14, 15, 16 ) &lt;&lt; QgsPoint( 11, 12, 13 ) ) ;</span></a>
<a name="14290"><span class="lineNum">   14290 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14291"><span class="lineNum">   14291 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14292"><span class="lineNum">   14292 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14293"><span class="lineNum">   14293 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="14294"><span class="lineNum">   14294 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14295"><span class="lineNum">   14295 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14296"><span class="lineNum">   14296 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14297"><span class="lineNum">   14297 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="14298"><span class="lineNum">   14298 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 14, 15, 0, 0 ) );</span></a>
<a name="14299"><span class="lineNum">   14299 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="14300"><span class="lineNum">   14300 </span>                :            : </a>
<a name="14301"><span class="lineNum">   14301 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14302"><span class="lineNum">   14302 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="14303"><span class="lineNum">   14303 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) ) ;</span></a>
<a name="14304"><span class="lineNum">   14304 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14305"><span class="lineNum">   14305 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14306"><span class="lineNum">   14306 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14307"><span class="lineNum">   14307 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14308"><span class="lineNum">   14308 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 )</span></a>
<a name="14309"><span class="lineNum">   14309 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="14310"><span class="lineNum">   14310 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14311"><span class="lineNum">   14311 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14312"><span class="lineNum">   14312 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14313"><span class="lineNum">   14313 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14314"><span class="lineNum">   14314 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14315"><span class="lineNum">   14315 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14316"><span class="lineNum">   14316 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14317"><span class="lineNum">   14317 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="14318"><span class="lineNum">   14318 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) );</span></a>
<a name="14319"><span class="lineNum">   14319 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="14320"><span class="lineNum">   14320 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14321"><span class="lineNum">   14321 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="14322"><span class="lineNum">   14322 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 3, 13, 0, 0 ) );</span></a>
<a name="14323"><span class="lineNum">   14323 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="14324"><span class="lineNum">   14324 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 83, 83, 8 )</span></a>
<a name="14325"><span class="lineNum">   14325 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) ) ;</span></a>
<a name="14326"><span class="lineNum">   14326 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14327"><span class="lineNum">   14327 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14328"><span class="lineNum">   14328 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14329"><span class="lineNum">   14329 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14330"><span class="lineNum">   14330 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14331"><span class="lineNum">   14331 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14332"><span class="lineNum">   14332 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14333"><span class="lineNum">   14333 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="14334"><span class="lineNum">   14334 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 83, 83, 8, 0 ) );</span></a>
<a name="14335"><span class="lineNum">   14335 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="14336"><span class="lineNum">   14336 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 183, 183, 0, 11 )</span></a>
<a name="14337"><span class="lineNum">   14337 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) ) ;</span></a>
<a name="14338"><span class="lineNum">   14338 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14339"><span class="lineNum">   14339 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14340"><span class="lineNum">   14340 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14341"><span class="lineNum">   14341 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14342"><span class="lineNum">   14342 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14343"><span class="lineNum">   14343 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14344"><span class="lineNum">   14344 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c6.geometryN( 3 ) );</span></a>
<a name="14345"><span class="lineNum">   14345 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="14346"><span class="lineNum">   14346 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 183, 183, 0, 11 ) );</span></a>
<a name="14347"><span class="lineNum">   14347 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsCircularString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="14348"><span class="lineNum">   14348 </span>                :            : </a>
<a name="14349"><span class="lineNum">   14349 </span>                :            :   //clear</a>
<a name="14350"><span class="lineNum">   14350 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c7;</span></a>
<a name="14351"><span class="lineNum">   14351 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="14352"><span class="lineNum">   14352 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 71, 4, 6 ) ) ;</span></a>
<a name="14353"><span class="lineNum">   14353 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14354"><span class="lineNum">   14354 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14355"><span class="lineNum">   14355 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="14356"><span class="lineNum">   14356 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="14357"><span class="lineNum">   14357 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="14358"><span class="lineNum">   14358 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="14359"><span class="lineNum">   14359 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="14360"><span class="lineNum">   14360 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="14361"><span class="lineNum">   14361 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="14362"><span class="lineNum">   14362 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="14363"><span class="lineNum">   14363 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="14364"><span class="lineNum">   14364 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="14365"><span class="lineNum">   14365 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="14366"><span class="lineNum">   14366 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14367"><span class="lineNum">   14367 </span>                :            : </a>
<a name="14368"><span class="lineNum">   14368 </span>                :            :   //clone</a>
<a name="14369"><span class="lineNum">   14369 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c11;</span></a>
<a name="14370"><span class="lineNum">   14370 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiSurface &gt;cloned( c11.clone() );</span></a>
<a name="14371"><span class="lineNum">   14371 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="14372"><span class="lineNum">   14372 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="14373"><span class="lineNum">   14373 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="14374"><span class="lineNum">   14374 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="14375"><span class="lineNum">   14375 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="14376"><span class="lineNum">   14376 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( cloned-&gt;geometryN( 0 ) );</span></a>
<a name="14377"><span class="lineNum">   14377 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14378"><span class="lineNum">   14378 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( cloned-&gt;geometryN( 1 ) );</span></a>
<a name="14379"><span class="lineNum">   14379 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14380"><span class="lineNum">   14380 </span>                :            : </a>
<a name="14381"><span class="lineNum">   14381 </span>                :            :   //copy constructor</a>
<a name="14382"><span class="lineNum">   14382 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c12;</span></a>
<a name="14383"><span class="lineNum">   14383 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c13( c12 );</span></a>
<a name="14384"><span class="lineNum">   14384 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="14385"><span class="lineNum">   14385 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="14386"><span class="lineNum">   14386 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="14387"><span class="lineNum">   14387 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c14( c12 );</span></a>
<a name="14388"><span class="lineNum">   14388 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="14389"><span class="lineNum">   14389 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14390"><span class="lineNum">   14390 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c14.geometryN( 0 ) );</span></a>
<a name="14391"><span class="lineNum">   14391 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14392"><span class="lineNum">   14392 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c14.geometryN( 1 ) );</span></a>
<a name="14393"><span class="lineNum">   14393 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14394"><span class="lineNum">   14394 </span>                :            : </a>
<a name="14395"><span class="lineNum">   14395 </span>                :            :   //assignment operator</a>
<a name="14396"><span class="lineNum">   14396 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c15;</span></a>
<a name="14397"><span class="lineNum">   14397 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="14398"><span class="lineNum">   14398 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="14399"><span class="lineNum">   14399 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="14400"><span class="lineNum">   14400 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="14401"><span class="lineNum">   14401 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c15.geometryN( 0 ) );</span></a>
<a name="14402"><span class="lineNum">   14402 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14403"><span class="lineNum">   14403 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsCurvePolygon * &gt;( c15.geometryN( 1 ) );</span></a>
<a name="14404"><span class="lineNum">   14404 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="14405"><span class="lineNum">   14405 </span>                :            : </a>
<a name="14406"><span class="lineNum">   14406 </span>                :            :   //toCurveType</a>
<a name="14407"><span class="lineNum">   14407 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiSurface &gt; curveType( c12.toCurveType() );</span></a>
<a name="14408"><span class="lineNum">   14408 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14409"><span class="lineNum">   14409 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="14410"><span class="lineNum">   14410 </span>                :<span class="lineCov">          1 :   const QgsCurvePolygon *curve = static_cast&lt; const QgsCurvePolygon * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="14411"><span class="lineNum">   14411 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsCurvePolygon * &gt;( c12.geometryN( 0 ) ) );</span></a>
<a name="14412"><span class="lineNum">   14412 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsCurvePolygon * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="14413"><span class="lineNum">   14413 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsCurvePolygon * &gt;( c12.geometryN( 1 ) ) );</span></a>
<a name="14414"><span class="lineNum">   14414 </span>                :            : </a>
<a name="14415"><span class="lineNum">   14415 </span>                :            :   //to/fromWKB</a>
<a name="14416"><span class="lineNum">   14416 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c16;</span></a>
<a name="14417"><span class="lineNum">   14417 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="14418"><span class="lineNum">   14418 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14419"><span class="lineNum">   14419 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14420"><span class="lineNum">   14420 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14421"><span class="lineNum">   14421 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) ) ;</span></a>
<a name="14422"><span class="lineNum">   14422 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14423"><span class="lineNum">   14423 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14424"><span class="lineNum">   14424 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14425"><span class="lineNum">   14425 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="14426"><span class="lineNum">   14426 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c17;</span></a>
<a name="14427"><span class="lineNum">   14427 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="14428"><span class="lineNum">   14428 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="14429"><span class="lineNum">   14429 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="14430"><span class="lineNum">   14430 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="14431"><span class="lineNum">   14431 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="14432"><span class="lineNum">   14432 </span>                :            : </a>
<a name="14433"><span class="lineNum">   14433 </span>                :            :   //parts with Z</a>
<a name="14434"><span class="lineNum">   14434 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="14435"><span class="lineNum">   14435 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="14436"><span class="lineNum">   14436 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) ) ;</span></a>
<a name="14437"><span class="lineNum">   14437 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14438"><span class="lineNum">   14438 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14439"><span class="lineNum">   14439 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14440"><span class="lineNum">   14440 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 43, 43, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) ) ;</span></a>
<a name="14441"><span class="lineNum">   14441 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14442"><span class="lineNum">   14442 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14443"><span class="lineNum">   14443 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14444"><span class="lineNum">   14444 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="14445"><span class="lineNum">   14445 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="14446"><span class="lineNum">   14446 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="14447"><span class="lineNum">   14447 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="14448"><span class="lineNum">   14448 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiSurfaceZ );</span></a>
<a name="14449"><span class="lineNum">   14449 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="14450"><span class="lineNum">   14450 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="14451"><span class="lineNum">   14451 </span>                :            : </a>
<a name="14452"><span class="lineNum">   14452 </span>                :            :   //parts with m</a>
<a name="14453"><span class="lineNum">   14453 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="14454"><span class="lineNum">   14454 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="14455"><span class="lineNum">   14455 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 13, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) ) ;</span></a>
<a name="14456"><span class="lineNum">   14456 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14457"><span class="lineNum">   14457 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14458"><span class="lineNum">   14458 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14459"><span class="lineNum">   14459 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 43, 43, 0, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) ) ;</span></a>
<a name="14460"><span class="lineNum">   14460 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14461"><span class="lineNum">   14461 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14462"><span class="lineNum">   14462 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14463"><span class="lineNum">   14463 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="14464"><span class="lineNum">   14464 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="14465"><span class="lineNum">   14465 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="14466"><span class="lineNum">   14466 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="14467"><span class="lineNum">   14467 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="14468"><span class="lineNum">   14468 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="14469"><span class="lineNum">   14469 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="14470"><span class="lineNum">   14470 </span>                :            : </a>
<a name="14471"><span class="lineNum">   14471 </span>                :            :   // parts with ZM</a>
<a name="14472"><span class="lineNum">   14472 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="14473"><span class="lineNum">   14473 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="14474"><span class="lineNum">   14474 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) ) ;</span></a>
<a name="14475"><span class="lineNum">   14475 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14476"><span class="lineNum">   14476 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14477"><span class="lineNum">   14477 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14478"><span class="lineNum">   14478 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) ) ;</span></a>
<a name="14479"><span class="lineNum">   14479 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14480"><span class="lineNum">   14480 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14481"><span class="lineNum">   14481 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="14482"><span class="lineNum">   14482 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="14483"><span class="lineNum">   14483 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="14484"><span class="lineNum">   14484 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="14485"><span class="lineNum">   14485 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="14486"><span class="lineNum">   14486 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="14487"><span class="lineNum">   14487 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="14488"><span class="lineNum">   14488 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="14489"><span class="lineNum">   14489 </span>                :            : </a>
<a name="14490"><span class="lineNum">   14490 </span>                :            :   //bad WKB - check for no crash</a>
<a name="14491"><span class="lineNum">   14491 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="14492"><span class="lineNum">   14492 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="14493"><span class="lineNum">   14493 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="14494"><span class="lineNum">   14494 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14495"><span class="lineNum">   14495 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="14496"><span class="lineNum">   14496 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="14497"><span class="lineNum">   14497 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="14498"><span class="lineNum">   14498 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="14499"><span class="lineNum">   14499 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14500"><span class="lineNum">   14500 </span>                :            : </a>
<a name="14501"><span class="lineNum">   14501 </span>                :            :   //to/from WKT</a>
<a name="14502"><span class="lineNum">   14502 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c18;</span></a>
<a name="14503"><span class="lineNum">   14503 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 8 ) ) ;</span></a>
<a name="14504"><span class="lineNum">   14504 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14505"><span class="lineNum">   14505 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14506"><span class="lineNum">   14506 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="14507"><span class="lineNum">   14507 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 53, 21, 52 ) ) ;</span></a>
<a name="14508"><span class="lineNum">   14508 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14509"><span class="lineNum">   14509 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14510"><span class="lineNum">   14510 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="14511"><span class="lineNum">   14511 </span>                :            : </a>
<a name="14512"><span class="lineNum">   14512 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="14513"><span class="lineNum">   14513 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="14514"><span class="lineNum">   14514 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c19;</span></a>
<a name="14515"><span class="lineNum">   14515 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="14516"><span class="lineNum">   14516 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="14517"><span class="lineNum">   14517 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c19.geometryN( 0 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c18.geometryN( 0 ) ) );</span></a>
<a name="14518"><span class="lineNum">   14518 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurvePolygon * &gt;( c19.geometryN( 1 ) ), *static_cast&lt; const QgsCurvePolygon * &gt;( c18.geometryN( 1 ) ) );</span></a>
<a name="14519"><span class="lineNum">   14519 </span>                :            : </a>
<a name="14520"><span class="lineNum">   14520 </span>                :            :   //bad WKT</a>
<a name="14521"><span class="lineNum">   14521 </span>                :<span class="lineCov">          1 :   QgsMultiSurface c20;</span></a>
<a name="14522"><span class="lineNum">   14522 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="14523"><span class="lineNum">   14523 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="14524"><span class="lineNum">   14524 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="14525"><span class="lineNum">   14525 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::MultiSurface );</span></a>
<a name="14526"><span class="lineNum">   14526 </span>                :            : </a>
<a name="14527"><span class="lineNum">   14527 </span>                :            :   //as JSON</a>
<a name="14528"><span class="lineNum">   14528 </span>                :<span class="lineCov">          1 :   QgsMultiSurface exportC;</span></a>
<a name="14529"><span class="lineNum">   14529 </span>                :<span class="lineCov">          1 :   QgsLineString lineRing;</span></a>
<a name="14530"><span class="lineNum">   14530 </span>                :<span class="lineCov">          1 :   lineRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 13 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="14531"><span class="lineNum">   14531 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14532"><span class="lineNum">   14532 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( lineRing.clone() );</span></a>
<a name="14533"><span class="lineNum">   14533 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="14534"><span class="lineNum">   14534 </span>                :<span class="lineCov">          1 :   lineRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 43 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) ) ;</span></a>
<a name="14535"><span class="lineNum">   14535 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14536"><span class="lineNum">   14536 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( lineRing.clone() );</span></a>
<a name="14537"><span class="lineNum">   14537 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="14538"><span class="lineNum">   14538 </span>                :            : </a>
<a name="14539"><span class="lineNum">   14539 </span>                :            :   // GML document for compare</a>
<a name="14540"><span class="lineNum">   14540 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="14541"><span class="lineNum">   14541 </span>                :            : </a>
<a name="14542"><span class="lineNum">   14542 </span>                :            :   // as GML2</a>
<a name="14543"><span class="lineNum">   14543 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;7,17 7,13 3,13 7,17&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;27,37 27,43 43,43 27,37&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; ) );</span></a>
<a name="14544"><span class="lineNum">   14544 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc, 1 ) );</span></a>
<a name="14545"><span class="lineNum">   14545 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="14546"><span class="lineNum">   14546 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="14547"><span class="lineNum">   14547 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiSurface().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="14548"><span class="lineNum">   14548 </span>                :            : </a>
<a name="14549"><span class="lineNum">   14549 </span>                :            :   //as GML3</a>
<a name="14550"><span class="lineNum">   14550 </span>                :            : </a>
<a name="14551"><span class="lineNum">   14551 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiSurface xmlns=\&quot;gml\&quot;&gt;&lt;surfaceMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;7 17 7 13 3 13 7 17&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/surfaceMember&gt;&lt;surfaceMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;27 37 27 43 43 43 27 37&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/surfaceMember&gt;&lt;/MultiSurface&gt;&quot; ) );</span></a>
<a name="14552"><span class="lineNum">   14552 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="14553"><span class="lineNum">   14553 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="14554"><span class="lineNum">   14554 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiSurface xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="14555"><span class="lineNum">   14555 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiSurface().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="14556"><span class="lineNum">   14556 </span>                :            : </a>
<a name="14557"><span class="lineNum">   14557 </span>                :            :   // as JSON</a>
<a name="14558"><span class="lineNum">   14558 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[[7.0,17.0],[7.0,13.0],[3.0,13.0],[7.0,17.0]]],[[[27.0,37.0],[27.0,43.0],[43.0,43.0],[27.0,37.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="14559"><span class="lineNum">   14559 </span>                :<span class="lineCov">          1 :   res = exportC.asJson( 1 );</span></a>
<a name="14560"><span class="lineNum">   14560 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="14561"><span class="lineNum">   14561 </span>                :            : </a>
<a name="14562"><span class="lineNum">   14562 </span>                :<span class="lineCov">          1 :   lineRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 17, 27 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 17, 28 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 18, 28 )  &lt;&lt; QgsPoint( QgsWkbTypes::Point, 17, 27 ) ) ;</span></a>
<a name="14563"><span class="lineNum">   14563 </span>                :<span class="lineCov">          1 :   part.addInteriorRing( lineRing.clone() );</span></a>
<a name="14564"><span class="lineNum">   14564 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="14565"><span class="lineNum">   14565 </span>                :            : </a>
<a name="14566"><span class="lineNum">   14566 </span>                :<span class="lineCov">          1 :   QString expectedJsonWithRings( &quot;{\&quot;coordinates\&quot;:[[[[7.0,17.0],[7.0,13.0],[3.0,13.0],[7.0,17.0]]],[[[27.0,37.0],[27.0,43.0],[43.0,43.0],[27.0,37.0]]],[[[27.0,37.0],[27.0,43.0],[43.0,43.0],[27.0,37.0]],[[17.0,27.0],[17.0,28.0],[18.0,28.0],[17.0,27.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="14567"><span class="lineNum">   14567 </span>                :<span class="lineCov">          1 :   res = exportC.asJson( 1 );</span></a>
<a name="14568"><span class="lineNum">   14568 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonWithRings );</span></a>
<a name="14569"><span class="lineNum">   14569 </span>                :            : </a>
<a name="14570"><span class="lineNum">   14570 </span>                :<span class="lineCov">          1 :   QgsMultiSurface exportFloat;</span></a>
<a name="14571"><span class="lineNum">   14571 </span>                :<span class="lineCov">          1 :   lineRing.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0.1234, 0.1234 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0.1234, 1.2344 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1.2344, 1.2344 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0.1234, 0.1234 ) ) ;</span></a>
<a name="14572"><span class="lineNum">   14572 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14573"><span class="lineNum">   14573 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( lineRing.clone() );</span></a>
<a name="14574"><span class="lineNum">   14574 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="14575"><span class="lineNum">   14575 </span>                :            : </a>
<a name="14576"><span class="lineNum">   14576 </span>                :<span class="lineCov">          2 :   QString expectedJsonPrec3( QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[[0.123,0.123],[0.123,1.234],[1.234,1.234],[0.123,0.123]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; ) );</span></a>
<a name="14577"><span class="lineNum">   14577 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="14578"><span class="lineNum">   14578 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="14579"><span class="lineNum">   14579 </span>                :            : </a>
<a name="14580"><span class="lineNum">   14580 </span>                :            :   // as GML2</a>
<a name="14581"><span class="lineNum">   14581 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.123,0.123 0.123,1.234 1.234,1.234 0.123,0.123&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; ) );</span></a>
<a name="14582"><span class="lineNum">   14582 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="14583"><span class="lineNum">   14583 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="14584"><span class="lineNum">   14584 </span>                :            : </a>
<a name="14585"><span class="lineNum">   14585 </span>                :            :   //as GML3</a>
<a name="14586"><span class="lineNum">   14586 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;MultiSurface xmlns=\&quot;gml\&quot;&gt;&lt;surfaceMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.123 0.123 0.123 1.234 1.234 1.234 0.123 0.123&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/surfaceMember&gt;&lt;/MultiSurface&gt;&quot; ) );</span></a>
<a name="14587"><span class="lineNum">   14587 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="14588"><span class="lineNum">   14588 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="14589"><span class="lineNum">   14589 </span>                :            : </a>
<a name="14590"><span class="lineNum">   14590 </span>                :            :   //asKML</a>
<a name="14591"><span class="lineNum">   14591 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.123,0.123,0 0.123,1.234,0 1.234,1.234,0 0.123,0.123,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="14592"><span class="lineNum">   14592 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="14593"><span class="lineNum">   14593 </span>                :            : </a>
<a name="14594"><span class="lineNum">   14594 </span>                :            :   // insert geometry</a>
<a name="14595"><span class="lineNum">   14595 </span>                :<span class="lineCov">          1 :   QgsMultiSurface rc;</span></a>
<a name="14596"><span class="lineNum">   14596 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="14597"><span class="lineNum">   14597 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="14598"><span class="lineNum">   14598 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="14599"><span class="lineNum">   14599 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="14600"><span class="lineNum">   14600 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="14601"><span class="lineNum">   14601 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="14602"><span class="lineNum">   14602 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="14603"><span class="lineNum">   14603 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="14604"><span class="lineNum">   14604 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="14605"><span class="lineNum">   14605 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="14606"><span class="lineNum">   14606 </span>                :            : </a>
<a name="14607"><span class="lineNum">   14607 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( new QgsPoint(), 0 );</span></a>
<a name="14608"><span class="lineNum">   14608 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="14609"><span class="lineNum">   14609 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="14610"><span class="lineNum">   14610 </span>                :            : </a>
<a name="14611"><span class="lineNum">   14611 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part.clone(), 0 );</span></a>
<a name="14612"><span class="lineNum">   14612 </span>                :<span class="lineCov">          1 :   QVERIFY( !rc.isEmpty() );</span></a>
<a name="14613"><span class="lineNum">   14613 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="14614"><span class="lineNum">   14614 </span>                :            : </a>
<a name="14615"><span class="lineNum">   14615 </span>                :            :   // cast</a>
<a name="14616"><span class="lineNum">   14616 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsMultiSurface().cast( nullptr ) );</span></a>
<a name="14617"><span class="lineNum">   14617 </span>                :<span class="lineCov">          1 :   QgsMultiSurface pCast;</span></a>
<a name="14618"><span class="lineNum">   14618 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiSurface().cast( &amp;pCast ) );</span></a>
<a name="14619"><span class="lineNum">   14619 </span>                :<span class="lineCov">          1 :   QgsMultiSurface pCast2;</span></a>
<a name="14620"><span class="lineNum">   14620 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiSurfaceZ()&quot; ) );</span></a>
<a name="14621"><span class="lineNum">   14621 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiSurface().cast( &amp;pCast2 ) );</span></a>
<a name="14622"><span class="lineNum">   14622 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiSurfaceM()&quot; ) );</span></a>
<a name="14623"><span class="lineNum">   14623 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiSurface().cast( &amp;pCast2 ) );</span></a>
<a name="14624"><span class="lineNum">   14624 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiSurfaceZM()&quot; ) );</span></a>
<a name="14625"><span class="lineNum">   14625 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiSurface().cast( &amp;pCast2 ) );</span></a>
<a name="14626"><span class="lineNum">   14626 </span>                :            : </a>
<a name="14627"><span class="lineNum">   14627 </span>                :            :   //boundary</a>
<a name="14628"><span class="lineNum">   14628 </span>                :<span class="lineCov">          1 :   QgsMultiSurface multiSurface;</span></a>
<a name="14629"><span class="lineNum">   14629 </span>                :<span class="lineCov">          1 :   QVERIFY( !multiSurface.boundary() );</span></a>
<a name="14630"><span class="lineNum">   14630 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine1;</span></a>
<a name="14631"><span class="lineNum">   14631 </span>                :<span class="lineCov">          1 :   boundaryLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="14632"><span class="lineNum">   14632 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14633"><span class="lineNum">   14633 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( boundaryLine1.clone() );</span></a>
<a name="14634"><span class="lineNum">   14634 </span>                :<span class="lineCov">          1 :   multiSurface.addGeometry( part.clone() );</span></a>
<a name="14635"><span class="lineNum">   14635 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *boundary = multiSurface.boundary();</span></a>
<a name="14636"><span class="lineNum">   14636 </span>                :<span class="lineCov">          1 :   QgsMultiCurve *mpBoundary = dynamic_cast&lt; QgsMultiCurve * &gt;( boundary );</span></a>
<a name="14637"><span class="lineNum">   14637 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="14638"><span class="lineNum">   14638 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 1 );</span></a>
<a name="14639"><span class="lineNum">   14639 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurve *&gt;( mpBoundary-&gt;geometryN( 0 ) ), *part.exteriorRing() );</span></a>
<a name="14640"><span class="lineNum">   14640 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="14641"><span class="lineNum">   14641 </span>                :            :   // add another QgsCircularString</a>
<a name="14642"><span class="lineNum">   14642 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine2;</span></a>
<a name="14643"><span class="lineNum">   14643 </span>                :<span class="lineCov">          1 :   boundaryLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="14644"><span class="lineNum">   14644 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon part2;</span></a>
<a name="14645"><span class="lineNum">   14645 </span>                :<span class="lineCov">          1 :   part2.setExteriorRing( boundaryLine2.clone() );</span></a>
<a name="14646"><span class="lineNum">   14646 </span>                :<span class="lineCov">          1 :   multiSurface.addGeometry( part2.clone() );</span></a>
<a name="14647"><span class="lineNum">   14647 </span>                :<span class="lineCov">          1 :   boundary = multiSurface.boundary();</span></a>
<a name="14648"><span class="lineNum">   14648 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiCurve * &gt;( boundary );</span></a>
<a name="14649"><span class="lineNum">   14649 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="14650"><span class="lineNum">   14650 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 2 );</span></a>
<a name="14651"><span class="lineNum">   14651 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurve *&gt;( mpBoundary-&gt;geometryN( 0 ) ), *part.exteriorRing() );</span></a>
<a name="14652"><span class="lineNum">   14652 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurve *&gt;( mpBoundary-&gt;geometryN( 1 ) ), *part2.exteriorRing() );</span></a>
<a name="14653"><span class="lineNum">   14653 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="14654"><span class="lineNum">   14654 </span>                :            : </a>
<a name="14655"><span class="lineNum">   14655 </span>                :            :   //boundary with z</a>
<a name="14656"><span class="lineNum">   14656 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine4;</span></a>
<a name="14657"><span class="lineNum">   14657 </span>                :<span class="lineCov">          1 :   boundaryLine4.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 0, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 10 ) );</span></a>
<a name="14658"><span class="lineNum">   14658 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14659"><span class="lineNum">   14659 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( boundaryLine4.clone() );</span></a>
<a name="14660"><span class="lineNum">   14660 </span>                :<span class="lineCov">          1 :   QgsCircularString boundaryLine5;</span></a>
<a name="14661"><span class="lineNum">   14661 </span>                :<span class="lineCov">          1 :   boundaryLine5.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 150 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 100 ) );</span></a>
<a name="14662"><span class="lineNum">   14662 </span>                :<span class="lineCov">          1 :   part2.clear();</span></a>
<a name="14663"><span class="lineNum">   14663 </span>                :<span class="lineCov">          1 :   part2.setExteriorRing( boundaryLine5.clone() );</span></a>
<a name="14664"><span class="lineNum">   14664 </span>                :<span class="lineCov">          1 :   QgsMultiSurface multiSurface2;</span></a>
<a name="14665"><span class="lineNum">   14665 </span>                :<span class="lineCov">          1 :   multiSurface2.addGeometry( part.clone() );</span></a>
<a name="14666"><span class="lineNum">   14666 </span>                :<span class="lineCov">          1 :   multiSurface2.addGeometry( part2.clone() );</span></a>
<a name="14667"><span class="lineNum">   14667 </span>                :            : </a>
<a name="14668"><span class="lineNum">   14668 </span>                :<span class="lineCov">          1 :   boundary = multiSurface2.boundary();</span></a>
<a name="14669"><span class="lineNum">   14669 </span>                :<span class="lineCov">          1 :   mpBoundary = dynamic_cast&lt; QgsMultiCurve * &gt;( boundary );</span></a>
<a name="14670"><span class="lineNum">   14670 </span>                :<span class="lineCov">          1 :   QVERIFY( mpBoundary );</span></a>
<a name="14671"><span class="lineNum">   14671 </span>                :<span class="lineCov">          1 :   QCOMPARE( mpBoundary-&gt;numGeometries(), 2 );</span></a>
<a name="14672"><span class="lineNum">   14672 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurve *&gt;( mpBoundary-&gt;geometryN( 0 ) ), *part.exteriorRing() );</span></a>
<a name="14673"><span class="lineNum">   14673 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsCurve *&gt;( mpBoundary-&gt;geometryN( 1 ) ), *part2.exteriorRing() );</span></a>
<a name="14674"><span class="lineNum">   14674 </span>                :<span class="lineCov">          1 :   delete boundary;</span></a>
<a name="14675"><span class="lineNum">   14675 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="14676"><span class="lineNum">   14676 </span>                :            : </a>
<a name="14677"><span class="lineNum">   14677 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::multiPolygon()</span></a>
<a name="14678"><span class="lineNum">   14678 </span>                :            : {</a>
<a name="14679"><span class="lineNum">   14679 </span>                :            :   //test constructor</a>
<a name="14680"><span class="lineNum">   14680 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c1;</span></a>
<a name="14681"><span class="lineNum">   14681 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14682"><span class="lineNum">   14682 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14683"><span class="lineNum">   14683 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14684"><span class="lineNum">   14684 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14685"><span class="lineNum">   14685 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="14686"><span class="lineNum">   14686 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="14687"><span class="lineNum">   14687 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14688"><span class="lineNum">   14688 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiPolygon&quot; ) );</span></a>
<a name="14689"><span class="lineNum">   14689 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiPolygon&quot; ) );</span></a>
<a name="14690"><span class="lineNum">   14690 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="14691"><span class="lineNum">   14691 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="14692"><span class="lineNum">   14692 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="14693"><span class="lineNum">   14693 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="14694"><span class="lineNum">   14694 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14695"><span class="lineNum">   14695 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14696"><span class="lineNum">   14696 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14697"><span class="lineNum">   14697 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="14698"><span class="lineNum">   14698 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="14699"><span class="lineNum">   14699 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="14700"><span class="lineNum">   14700 </span>                :            : </a>
<a name="14701"><span class="lineNum">   14701 </span>                :            :   //addGeometry</a>
<a name="14702"><span class="lineNum">   14702 </span>                :            :   //try with nullptr</a>
<a name="14703"><span class="lineNum">   14703 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="14704"><span class="lineNum">   14704 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14705"><span class="lineNum">   14705 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14706"><span class="lineNum">   14706 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14707"><span class="lineNum">   14707 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14708"><span class="lineNum">   14708 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14709"><span class="lineNum">   14709 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14710"><span class="lineNum">   14710 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14711"><span class="lineNum">   14711 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14712"><span class="lineNum">   14712 </span>                :            : </a>
<a name="14713"><span class="lineNum">   14713 </span>                :            :   // not a surface</a>
<a name="14714"><span class="lineNum">   14714 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.addGeometry( new QgsPoint() ) );</span></a>
<a name="14715"><span class="lineNum">   14715 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="14716"><span class="lineNum">   14716 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="14717"><span class="lineNum">   14717 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="14718"><span class="lineNum">   14718 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="14719"><span class="lineNum">   14719 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="14720"><span class="lineNum">   14720 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14721"><span class="lineNum">   14721 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="14722"><span class="lineNum">   14722 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14723"><span class="lineNum">   14723 </span>                :            : </a>
<a name="14724"><span class="lineNum">   14724 </span>                :            :   //valid geometry</a>
<a name="14725"><span class="lineNum">   14725 </span>                :<span class="lineCov">          1 :   QgsPolygon part;</span></a>
<a name="14726"><span class="lineNum">   14726 </span>                :<span class="lineCov">          1 :   QgsLineString ring;</span></a>
<a name="14727"><span class="lineNum">   14727 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 2, 21 ) &lt;&lt; QgsPoint( 1, 10 ) );</span></a>
<a name="14728"><span class="lineNum">   14728 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14729"><span class="lineNum">   14729 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="14730"><span class="lineNum">   14730 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="14731"><span class="lineNum">   14731 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="14732"><span class="lineNum">   14732 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 4 );</span></a>
<a name="14733"><span class="lineNum">   14733 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="14734"><span class="lineNum">   14734 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="14735"><span class="lineNum">   14735 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="14736"><span class="lineNum">   14736 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="14737"><span class="lineNum">   14737 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14738"><span class="lineNum">   14738 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;MultiPolygon&quot; ) );</span></a>
<a name="14739"><span class="lineNum">   14739 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;MultiPolygon&quot; ) );</span></a>
<a name="14740"><span class="lineNum">   14740 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 2 );</span></a>
<a name="14741"><span class="lineNum">   14741 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="14742"><span class="lineNum">   14742 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="14743"><span class="lineNum">   14743 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c1.geometryN( 0 ) ), part );</span></a>
<a name="14744"><span class="lineNum">   14744 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="14745"><span class="lineNum">   14745 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="14746"><span class="lineNum">   14746 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 4 );</span></a>
<a name="14747"><span class="lineNum">   14747 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="14748"><span class="lineNum">   14748 </span>                :            : </a>
<a name="14749"><span class="lineNum">   14749 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="14750"><span class="lineNum">   14750 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 21, 2 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 31, 2 )</span></a>
<a name="14751"><span class="lineNum">   14751 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 11, 1 ) );</span></a>
<a name="14752"><span class="lineNum">   14752 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14753"><span class="lineNum">   14753 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14754"><span class="lineNum">   14754 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c2;</span></a>
<a name="14755"><span class="lineNum">   14755 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="14756"><span class="lineNum">   14756 </span>                :<span class="lineCov">          1 :   QVERIFY( c2.is3D() );</span></a>
<a name="14757"><span class="lineNum">   14757 </span>                :<span class="lineCov">          1 :   QVERIFY( !c2.isMeasure() );</span></a>
<a name="14758"><span class="lineNum">   14758 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::MultiPolygonZ );</span></a>
<a name="14759"><span class="lineNum">   14759 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;MultiPolygonZ&quot; ) );</span></a>
<a name="14760"><span class="lineNum">   14760 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;MultiPolygon&quot; ) );</span></a>
<a name="14761"><span class="lineNum">   14761 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPolygon * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="14762"><span class="lineNum">   14762 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c3;</span></a>
<a name="14763"><span class="lineNum">   14763 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 20, 21, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 30, 31, 0, 2 )</span></a>
<a name="14764"><span class="lineNum">   14764 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 11, 0, 1 ) );</span></a>
<a name="14765"><span class="lineNum">   14765 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14766"><span class="lineNum">   14766 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14767"><span class="lineNum">   14767 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="14768"><span class="lineNum">   14768 </span>                :<span class="lineCov">          1 :   QVERIFY( !c3.is3D() );</span></a>
<a name="14769"><span class="lineNum">   14769 </span>                :<span class="lineCov">          1 :   QVERIFY( c3.isMeasure() );</span></a>
<a name="14770"><span class="lineNum">   14770 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="14771"><span class="lineNum">   14771 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;MultiPolygonM&quot; ) );</span></a>
<a name="14772"><span class="lineNum">   14772 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPolygon * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="14773"><span class="lineNum">   14773 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c4;</span></a>
<a name="14774"><span class="lineNum">   14774 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 20, 21, 3, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 30, 31, 3, 2 )</span></a>
<a name="14775"><span class="lineNum">   14775 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 11, 2, 1 ) );</span></a>
<a name="14776"><span class="lineNum">   14776 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14777"><span class="lineNum">   14777 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14778"><span class="lineNum">   14778 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="14779"><span class="lineNum">   14779 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.is3D() );</span></a>
<a name="14780"><span class="lineNum">   14780 </span>                :<span class="lineCov">          1 :   QVERIFY( c4.isMeasure() );</span></a>
<a name="14781"><span class="lineNum">   14781 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="14782"><span class="lineNum">   14782 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;MultiPolygonZM&quot; ) );</span></a>
<a name="14783"><span class="lineNum">   14783 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsPolygon * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="14784"><span class="lineNum">   14784 </span>                :            : </a>
<a name="14785"><span class="lineNum">   14785 </span>                :            :   //add another part</a>
<a name="14786"><span class="lineNum">   14786 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c6;</span></a>
<a name="14787"><span class="lineNum">   14787 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10 ) &lt;&lt; QgsPoint( 2, 11 ) &lt;&lt; QgsPoint( 10, 21 ) &lt;&lt; QgsPoint( 1, 10 ) );</span></a>
<a name="14788"><span class="lineNum">   14788 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14789"><span class="lineNum">   14789 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14790"><span class="lineNum">   14790 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14791"><span class="lineNum">   14791 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 4 );</span></a>
<a name="14792"><span class="lineNum">   14792 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 9, 12 ) &lt;&lt; QgsPoint( 3, 13 )  &lt;&lt; QgsPoint( 4, 17 ) &lt;&lt; QgsPoint( 9, 12 ) );</span></a>
<a name="14793"><span class="lineNum">   14793 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14794"><span class="lineNum">   14794 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14795"><span class="lineNum">   14795 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14796"><span class="lineNum">   14796 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 4 );</span></a>
<a name="14797"><span class="lineNum">   14797 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="14798"><span class="lineNum">   14798 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="14799"><span class="lineNum">   14799 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="14800"><span class="lineNum">   14800 </span>                :            : </a>
<a name="14801"><span class="lineNum">   14801 </span>                :            :   //adding subsequent points should not alter z/m type, regardless of parts type</a>
<a name="14802"><span class="lineNum">   14802 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14803"><span class="lineNum">   14803 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14804"><span class="lineNum">   14804 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14805"><span class="lineNum">   14805 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 10, 13, 3 ) &lt;&lt; QgsPoint( 1, 10, 2 ) ) ;</span></a>
<a name="14806"><span class="lineNum">   14806 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14807"><span class="lineNum">   14807 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14808"><span class="lineNum">   14808 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14809"><span class="lineNum">   14809 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14810"><span class="lineNum">   14810 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 4 );</span></a>
<a name="14811"><span class="lineNum">   14811 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 4 );</span></a>
<a name="14812"><span class="lineNum">   14812 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 0 );</span></a>
<a name="14813"><span class="lineNum">   14813 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( -1, 0 ), 0 );</span></a>
<a name="14814"><span class="lineNum">   14814 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 8 );</span></a>
<a name="14815"><span class="lineNum">   14815 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="14816"><span class="lineNum">   14816 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 2 );</span></a>
<a name="14817"><span class="lineNum">   14817 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14818"><span class="lineNum">   14818 </span>                :<span class="lineCov">          1 :   const QgsPolygon *ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14819"><span class="lineNum">   14819 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 9, 12 ) );</span></a>
<a name="14820"><span class="lineNum">   14820 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 3, 13 ) );</span></a>
<a name="14821"><span class="lineNum">   14821 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 4, 17 ) );</span></a>
<a name="14822"><span class="lineNum">   14822 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 9, 12 ) );</span></a>
<a name="14823"><span class="lineNum">   14823 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14824"><span class="lineNum">   14824 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 10 ) );</span></a>
<a name="14825"><span class="lineNum">   14825 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 2, 11 ) );</span></a>
<a name="14826"><span class="lineNum">   14826 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 10, 13 ) );</span></a>
<a name="14827"><span class="lineNum">   14827 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 1, 10 ) );</span></a>
<a name="14828"><span class="lineNum">   14828 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 32, 41, 0, 3 )</span></a>
<a name="14829"><span class="lineNum">   14829 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 42, 61, 0, 4 )</span></a>
<a name="14830"><span class="lineNum">   14830 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 21, 30, 0, 2 ) ) ;</span></a>
<a name="14831"><span class="lineNum">   14831 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14832"><span class="lineNum">   14832 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14833"><span class="lineNum">   14833 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14834"><span class="lineNum">   14834 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14835"><span class="lineNum">   14835 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 4 );</span></a>
<a name="14836"><span class="lineNum">   14836 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 4 );</span></a>
<a name="14837"><span class="lineNum">   14837 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 2, 0 ), 4 );</span></a>
<a name="14838"><span class="lineNum">   14838 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 12 );</span></a>
<a name="14839"><span class="lineNum">   14839 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.ringCount(), 1 );</span></a>
<a name="14840"><span class="lineNum">   14840 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.partCount(), 3 );</span></a>
<a name="14841"><span class="lineNum">   14841 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14842"><span class="lineNum">   14842 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="14843"><span class="lineNum">   14843 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14844"><span class="lineNum">   14844 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 21, 30 ) );</span></a>
<a name="14845"><span class="lineNum">   14845 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 32, 41 ) );</span></a>
<a name="14846"><span class="lineNum">   14846 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 42, 61 ) );</span></a>
<a name="14847"><span class="lineNum">   14847 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 21, 30 ) );</span></a>
<a name="14848"><span class="lineNum">   14848 </span>                :            : </a>
<a name="14849"><span class="lineNum">   14849 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14850"><span class="lineNum">   14850 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 10, 2 ) &lt;&lt; QgsPoint( 2, 11, 3 ) &lt;&lt; QgsPoint( 9, 15, 3 ) &lt;&lt; QgsPoint( 1, 10, 2 ) ) ;</span></a>
<a name="14851"><span class="lineNum">   14851 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14852"><span class="lineNum">   14852 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14853"><span class="lineNum">   14853 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14854"><span class="lineNum">   14854 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZ );</span></a>
<a name="14855"><span class="lineNum">   14855 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 )  &lt;&lt; QgsPoint( 7, 34 ) &lt;&lt; QgsPoint( 2, 20 ) ) ;</span></a>
<a name="14856"><span class="lineNum">   14856 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14857"><span class="lineNum">   14857 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14858"><span class="lineNum">   14858 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14859"><span class="lineNum">   14859 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZ );</span></a>
<a name="14860"><span class="lineNum">   14860 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14861"><span class="lineNum">   14861 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14862"><span class="lineNum">   14862 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="14863"><span class="lineNum">   14863 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 2, 11, 3 ) );</span></a>
<a name="14864"><span class="lineNum">   14864 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 9, 15, 3 ) );</span></a>
<a name="14865"><span class="lineNum">   14865 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 1, 10, 2 ) );</span></a>
<a name="14866"><span class="lineNum">   14866 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14867"><span class="lineNum">   14867 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="14868"><span class="lineNum">   14868 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 3, 31, 0 ) );</span></a>
<a name="14869"><span class="lineNum">   14869 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 7, 34, 0 ) );</span></a>
<a name="14870"><span class="lineNum">   14870 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 2, 20, 0 ) );</span></a>
<a name="14871"><span class="lineNum">   14871 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="14872"><span class="lineNum">   14872 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 65, 0, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) ) ;</span></a>
<a name="14873"><span class="lineNum">   14873 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14874"><span class="lineNum">   14874 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14875"><span class="lineNum">   14875 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14876"><span class="lineNum">   14876 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZ );</span></a>
<a name="14877"><span class="lineNum">   14877 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14878"><span class="lineNum">   14878 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.isMeasure() );</span></a>
<a name="14879"><span class="lineNum">   14879 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14880"><span class="lineNum">   14880 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="14881"><span class="lineNum">   14881 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( 6, 61, 0 ) );</span></a>
<a name="14882"><span class="lineNum">   14882 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( 9, 65, 0 ) );</span></a>
<a name="14883"><span class="lineNum">   14883 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( 5, 50, 0 ) );</span></a>
<a name="14884"><span class="lineNum">   14884 </span>                :            : </a>
<a name="14885"><span class="lineNum">   14885 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14886"><span class="lineNum">   14886 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14887"><span class="lineNum">   14887 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 )</span></a>
<a name="14888"><span class="lineNum">   14888 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 76, 0, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) ) ;</span></a>
<a name="14889"><span class="lineNum">   14889 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14890"><span class="lineNum">   14890 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14891"><span class="lineNum">   14891 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14892"><span class="lineNum">   14892 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="14893"><span class="lineNum">   14893 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 2, 20 ) &lt;&lt; QgsPoint( 3, 31 ) &lt;&lt; QgsPoint( 7, 39 ) &lt;&lt; QgsPoint( 2, 20 ) ) ;</span></a>
<a name="14894"><span class="lineNum">   14894 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14895"><span class="lineNum">   14895 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14896"><span class="lineNum">   14896 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14897"><span class="lineNum">   14897 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="14898"><span class="lineNum">   14898 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14899"><span class="lineNum">   14899 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14900"><span class="lineNum">   14900 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="14901"><span class="lineNum">   14901 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 6, 61, 0, 5 ) );</span></a>
<a name="14902"><span class="lineNum">   14902 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 9, 76, 0, 8 ) );</span></a>
<a name="14903"><span class="lineNum">   14903 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointM, 5, 50, 0, 4 ) );</span></a>
<a name="14904"><span class="lineNum">   14904 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14905"><span class="lineNum">   14905 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="14906"><span class="lineNum">   14906 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 3, 31, 0, 0 ) );</span></a>
<a name="14907"><span class="lineNum">   14907 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 7, 39, 0, 0 ) );</span></a>
<a name="14908"><span class="lineNum">   14908 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointM, 2, 20, 0, 0 ) );</span></a>
<a name="14909"><span class="lineNum">   14909 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 14, 15, 16 ) &lt;&lt; QgsPoint( 24, 21, 5 ) &lt;&lt; QgsPoint( 11, 12, 13 ) ) ;</span></a>
<a name="14910"><span class="lineNum">   14910 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14911"><span class="lineNum">   14911 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14912"><span class="lineNum">   14912 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14913"><span class="lineNum">   14913 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="14914"><span class="lineNum">   14914 </span>                :<span class="lineCov">          1 :   QVERIFY( !c6.is3D() );</span></a>
<a name="14915"><span class="lineNum">   14915 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14916"><span class="lineNum">   14916 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14917"><span class="lineNum">   14917 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="14918"><span class="lineNum">   14918 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointM, 14, 15, 0, 0 ) );</span></a>
<a name="14919"><span class="lineNum">   14919 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointM, 24, 21, 0, 0 ) );</span></a>
<a name="14920"><span class="lineNum">   14920 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 0 ) );</span></a>
<a name="14921"><span class="lineNum">   14921 </span>                :            : </a>
<a name="14922"><span class="lineNum">   14922 </span>                :<span class="lineCov">          1 :   c6.clear();</span></a>
<a name="14923"><span class="lineNum">   14923 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="14924"><span class="lineNum">   14924 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 71, 4, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) ) ;</span></a>
<a name="14925"><span class="lineNum">   14925 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14926"><span class="lineNum">   14926 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14927"><span class="lineNum">   14927 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14928"><span class="lineNum">   14928 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="14929"><span class="lineNum">   14929 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 )</span></a>
<a name="14930"><span class="lineNum">   14930 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 13, 27 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="14931"><span class="lineNum">   14931 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14932"><span class="lineNum">   14932 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14933"><span class="lineNum">   14933 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14934"><span class="lineNum">   14934 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="14935"><span class="lineNum">   14935 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14936"><span class="lineNum">   14936 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14937"><span class="lineNum">   14937 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 0 ) );</span></a>
<a name="14938"><span class="lineNum">   14938 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="14939"><span class="lineNum">   14939 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 ) );</span></a>
<a name="14940"><span class="lineNum">   14940 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 9, 71, 4, 9 ) );</span></a>
<a name="14941"><span class="lineNum">   14941 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) );</span></a>
<a name="14942"><span class="lineNum">   14942 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 1 ) );</span></a>
<a name="14943"><span class="lineNum">   14943 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="14944"><span class="lineNum">   14944 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 3, 13, 0, 0 ) );</span></a>
<a name="14945"><span class="lineNum">   14945 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 13, 27, 0, 0 ) );</span></a>
<a name="14946"><span class="lineNum">   14946 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointZM, 7, 17, 0, 0 ) );</span></a>
<a name="14947"><span class="lineNum">   14947 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 83, 83, 8 )</span></a>
<a name="14948"><span class="lineNum">   14948 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 93, 85, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 77, 87, 7 ) ) ;</span></a>
<a name="14949"><span class="lineNum">   14949 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14950"><span class="lineNum">   14950 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14951"><span class="lineNum">   14951 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14952"><span class="lineNum">   14952 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="14953"><span class="lineNum">   14953 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14954"><span class="lineNum">   14954 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14955"><span class="lineNum">   14955 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 2 ) );</span></a>
<a name="14956"><span class="lineNum">   14956 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="14957"><span class="lineNum">   14957 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 83, 83, 8, 0 ) );</span></a>
<a name="14958"><span class="lineNum">   14958 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 93, 85, 10, 0 ) );</span></a>
<a name="14959"><span class="lineNum">   14959 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointZM, 77, 87, 7, 0 ) );</span></a>
<a name="14960"><span class="lineNum">   14960 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 183, 183, 0, 11 )</span></a>
<a name="14961"><span class="lineNum">   14961 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 185, 193, 0, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 177, 187, 0, 9 ) ) ;</span></a>
<a name="14962"><span class="lineNum">   14962 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14963"><span class="lineNum">   14963 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14964"><span class="lineNum">   14964 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="14965"><span class="lineNum">   14965 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="14966"><span class="lineNum">   14966 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.is3D() );</span></a>
<a name="14967"><span class="lineNum">   14967 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.isMeasure() );</span></a>
<a name="14968"><span class="lineNum">   14968 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c6.geometryN( 3 ) );</span></a>
<a name="14969"><span class="lineNum">   14969 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="14970"><span class="lineNum">   14970 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 1 ), QgsPoint( QgsWkbTypes::PointZM, 183, 183, 0, 11 ) );</span></a>
<a name="14971"><span class="lineNum">   14971 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 2 ), QgsPoint( QgsWkbTypes::PointZM, 185, 193, 0, 13 ) );</span></a>
<a name="14972"><span class="lineNum">   14972 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( ls-&gt;exteriorRing() )-&gt;pointN( 3 ), QgsPoint( QgsWkbTypes::PointZM, 177, 187, 0, 9 ) );</span></a>
<a name="14973"><span class="lineNum">   14973 </span>                :            : </a>
<a name="14974"><span class="lineNum">   14974 </span>                :            :   //clear</a>
<a name="14975"><span class="lineNum">   14975 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c7;</span></a>
<a name="14976"><span class="lineNum">   14976 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 50, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6, 61, 3, 5 )</span></a>
<a name="14977"><span class="lineNum">   14977 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 71, 4, 15 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 5, 71, 4, 6 ) ) ;</span></a>
<a name="14978"><span class="lineNum">   14978 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="14979"><span class="lineNum">   14979 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="14980"><span class="lineNum">   14980 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="14981"><span class="lineNum">   14981 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="14982"><span class="lineNum">   14982 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="14983"><span class="lineNum">   14983 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="14984"><span class="lineNum">   14984 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="14985"><span class="lineNum">   14985 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="14986"><span class="lineNum">   14986 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="14987"><span class="lineNum">   14987 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="14988"><span class="lineNum">   14988 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="14989"><span class="lineNum">   14989 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="14990"><span class="lineNum">   14990 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="14991"><span class="lineNum">   14991 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="14992"><span class="lineNum">   14992 </span>                :            : </a>
<a name="14993"><span class="lineNum">   14993 </span>                :            :   //clone</a>
<a name="14994"><span class="lineNum">   14994 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c11;</span></a>
<a name="14995"><span class="lineNum">   14995 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiPolygon &gt;cloned( c11.clone() );</span></a>
<a name="14996"><span class="lineNum">   14996 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="14997"><span class="lineNum">   14997 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="14998"><span class="lineNum">   14998 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="14999"><span class="lineNum">   14999 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="15000"><span class="lineNum">   15000 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="15001"><span class="lineNum">   15001 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( cloned-&gt;geometryN( 0 ) );</span></a>
<a name="15002"><span class="lineNum">   15002 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15003"><span class="lineNum">   15003 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( cloned-&gt;geometryN( 1 ) );</span></a>
<a name="15004"><span class="lineNum">   15004 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15005"><span class="lineNum">   15005 </span>                :            : </a>
<a name="15006"><span class="lineNum">   15006 </span>                :            :   //copy constructor</a>
<a name="15007"><span class="lineNum">   15007 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c12;</span></a>
<a name="15008"><span class="lineNum">   15008 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c13( c12 );</span></a>
<a name="15009"><span class="lineNum">   15009 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="15010"><span class="lineNum">   15010 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="15011"><span class="lineNum">   15011 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="15012"><span class="lineNum">   15012 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c14( c12 );</span></a>
<a name="15013"><span class="lineNum">   15013 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="15014"><span class="lineNum">   15014 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="15015"><span class="lineNum">   15015 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c14.geometryN( 0 ) );</span></a>
<a name="15016"><span class="lineNum">   15016 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15017"><span class="lineNum">   15017 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c14.geometryN( 1 ) );</span></a>
<a name="15018"><span class="lineNum">   15018 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15019"><span class="lineNum">   15019 </span>                :            : </a>
<a name="15020"><span class="lineNum">   15020 </span>                :            :   //assignment operator</a>
<a name="15021"><span class="lineNum">   15021 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c15;</span></a>
<a name="15022"><span class="lineNum">   15022 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="15023"><span class="lineNum">   15023 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="15024"><span class="lineNum">   15024 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="15025"><span class="lineNum">   15025 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="15026"><span class="lineNum">   15026 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c15.geometryN( 0 ) );</span></a>
<a name="15027"><span class="lineNum">   15027 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15028"><span class="lineNum">   15028 </span>                :<span class="lineCov">          1 :   ls = static_cast&lt; const QgsPolygon * &gt;( c15.geometryN( 1 ) );</span></a>
<a name="15029"><span class="lineNum">   15029 </span>                :<span class="lineCov">          1 :   QCOMPARE( *ls, part );</span></a>
<a name="15030"><span class="lineNum">   15030 </span>                :            : </a>
<a name="15031"><span class="lineNum">   15031 </span>                :            :   //toCurveType</a>
<a name="15032"><span class="lineNum">   15032 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsMultiSurface &gt; curveType( c12.toCurveType() );</span></a>
<a name="15033"><span class="lineNum">   15033 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::MultiSurfaceZM );</span></a>
<a name="15034"><span class="lineNum">   15034 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="15035"><span class="lineNum">   15035 </span>                :<span class="lineCov">          1 :   const QgsPolygon *curve = static_cast&lt; const QgsPolygon * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="15036"><span class="lineNum">   15036 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsPolygon * &gt;( c12.geometryN( 0 ) ) );</span></a>
<a name="15037"><span class="lineNum">   15037 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsPolygon * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="15038"><span class="lineNum">   15038 </span>                :<span class="lineCov">          1 :   QCOMPARE( *curve, *static_cast&lt; const QgsPolygon * &gt;( c12.geometryN( 1 ) ) );</span></a>
<a name="15039"><span class="lineNum">   15039 </span>                :            : </a>
<a name="15040"><span class="lineNum">   15040 </span>                :            :   //to/fromWKB</a>
<a name="15041"><span class="lineNum">   15041 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c16;</span></a>
<a name="15042"><span class="lineNum">   15042 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 27 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="15043"><span class="lineNum">   15043 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15044"><span class="lineNum">   15044 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15045"><span class="lineNum">   15045 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15046"><span class="lineNum">   15046 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 29, 39 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) ) ;</span></a>
<a name="15047"><span class="lineNum">   15047 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15048"><span class="lineNum">   15048 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15049"><span class="lineNum">   15049 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15050"><span class="lineNum">   15050 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="15051"><span class="lineNum">   15051 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), c16.wkbSize() );</span></a>
<a name="15052"><span class="lineNum">   15052 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c17;</span></a>
<a name="15053"><span class="lineNum">   15053 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="15054"><span class="lineNum">   15054 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="15055"><span class="lineNum">   15055 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15056"><span class="lineNum">   15056 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="15057"><span class="lineNum">   15057 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="15058"><span class="lineNum">   15058 </span>                :            : </a>
<a name="15059"><span class="lineNum">   15059 </span>                :            :   //parts with Z</a>
<a name="15060"><span class="lineNum">   15060 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15061"><span class="lineNum">   15061 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15062"><span class="lineNum">   15062 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 3, 13, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 27, 5 )  &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 7, 17, 1 ) ) ;</span></a>
<a name="15063"><span class="lineNum">   15063 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15064"><span class="lineNum">   15064 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15065"><span class="lineNum">   15065 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15066"><span class="lineNum">   15066 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 43, 43, 5 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 87, 54, 7 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 27, 37, 2 ) ) ;</span></a>
<a name="15067"><span class="lineNum">   15067 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15068"><span class="lineNum">   15068 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15069"><span class="lineNum">   15069 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15070"><span class="lineNum">   15070 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15071"><span class="lineNum">   15071 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="15072"><span class="lineNum">   15072 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="15073"><span class="lineNum">   15073 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15074"><span class="lineNum">   15074 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPolygonZ );</span></a>
<a name="15075"><span class="lineNum">   15075 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="15076"><span class="lineNum">   15076 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="15077"><span class="lineNum">   15077 </span>                :            : </a>
<a name="15078"><span class="lineNum">   15078 </span>                :            :   //parts with m</a>
<a name="15079"><span class="lineNum">   15079 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15080"><span class="lineNum">   15080 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15081"><span class="lineNum">   15081 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 3, 13, 0, 4 )</span></a>
<a name="15082"><span class="lineNum">   15082 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 21, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 7, 17, 0, 1 ) ) ;</span></a>
<a name="15083"><span class="lineNum">   15083 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15084"><span class="lineNum">   15084 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15085"><span class="lineNum">   15085 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15086"><span class="lineNum">   15086 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 43, 43, 0, 5 )</span></a>
<a name="15087"><span class="lineNum">   15087 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 37, 31, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 27, 37, 0, 2 ) ) ;</span></a>
<a name="15088"><span class="lineNum">   15088 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15089"><span class="lineNum">   15089 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15090"><span class="lineNum">   15090 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15091"><span class="lineNum">   15091 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15092"><span class="lineNum">   15092 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="15093"><span class="lineNum">   15093 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="15094"><span class="lineNum">   15094 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15095"><span class="lineNum">   15095 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="15096"><span class="lineNum">   15096 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="15097"><span class="lineNum">   15097 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="15098"><span class="lineNum">   15098 </span>                :            : </a>
<a name="15099"><span class="lineNum">   15099 </span>                :            :   // parts with ZM</a>
<a name="15100"><span class="lineNum">   15100 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15101"><span class="lineNum">   15101 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15102"><span class="lineNum">   15102 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 )</span></a>
<a name="15103"><span class="lineNum">   15103 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 19, 13, 5, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) ) ;</span></a>
<a name="15104"><span class="lineNum">   15104 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15105"><span class="lineNum">   15105 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15106"><span class="lineNum">   15106 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15107"><span class="lineNum">   15107 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 )</span></a>
<a name="15108"><span class="lineNum">   15108 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) ) ;</span></a>
<a name="15109"><span class="lineNum">   15109 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15110"><span class="lineNum">   15110 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15111"><span class="lineNum">   15111 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15112"><span class="lineNum">   15112 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15113"><span class="lineNum">   15113 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="15114"><span class="lineNum">   15114 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="15115"><span class="lineNum">   15115 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15116"><span class="lineNum">   15116 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPolygonZM );</span></a>
<a name="15117"><span class="lineNum">   15117 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 0 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 0 ) ) );</span></a>
<a name="15118"><span class="lineNum">   15118 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c17.geometryN( 1 ) ), *static_cast&lt; const QgsPolygon * &gt;( c16.geometryN( 1 ) ) );</span></a>
<a name="15119"><span class="lineNum">   15119 </span>                :            : </a>
<a name="15120"><span class="lineNum">   15120 </span>                :            :   //bad WKB - check for no crash</a>
<a name="15121"><span class="lineNum">   15121 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15122"><span class="lineNum">   15122 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="15123"><span class="lineNum">   15123 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="15124"><span class="lineNum">   15124 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="15125"><span class="lineNum">   15125 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="15126"><span class="lineNum">   15126 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="15127"><span class="lineNum">   15127 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="15128"><span class="lineNum">   15128 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="15129"><span class="lineNum">   15129 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="15130"><span class="lineNum">   15130 </span>                :            : </a>
<a name="15131"><span class="lineNum">   15131 </span>                :            :   //to/from WKT</a>
<a name="15132"><span class="lineNum">   15132 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c18;</span></a>
<a name="15133"><span class="lineNum">   15133 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 17, 4, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 3, 13, 1, 4 )</span></a>
<a name="15134"><span class="lineNum">   15134 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 13, 19, 3, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 7, 11, 2, 8 ) ) ;</span></a>
<a name="15135"><span class="lineNum">   15135 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15136"><span class="lineNum">   15136 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15137"><span class="lineNum">   15137 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="15138"><span class="lineNum">   15138 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 37, 6, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 43, 43, 11, 5 )</span></a>
<a name="15139"><span class="lineNum">   15139 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 17, 49, 31, 53 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 27, 53, 21, 52 ) ) ;</span></a>
<a name="15140"><span class="lineNum">   15140 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15141"><span class="lineNum">   15141 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15142"><span class="lineNum">   15142 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="15143"><span class="lineNum">   15143 </span>                :            : </a>
<a name="15144"><span class="lineNum">   15144 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="15145"><span class="lineNum">   15145 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="15146"><span class="lineNum">   15146 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c19;</span></a>
<a name="15147"><span class="lineNum">   15147 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="15148"><span class="lineNum">   15148 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="15149"><span class="lineNum">   15149 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c19.geometryN( 0 ) ), *static_cast&lt; const QgsPolygon * &gt;( c18.geometryN( 0 ) ) );</span></a>
<a name="15150"><span class="lineNum">   15150 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsPolygon * &gt;( c19.geometryN( 1 ) ), *static_cast&lt; const QgsPolygon * &gt;( c18.geometryN( 1 ) ) );</span></a>
<a name="15151"><span class="lineNum">   15151 </span>                :            : </a>
<a name="15152"><span class="lineNum">   15152 </span>                :            :   //bad WKT</a>
<a name="15153"><span class="lineNum">   15153 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon c20;</span></a>
<a name="15154"><span class="lineNum">   15154 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="15155"><span class="lineNum">   15155 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="15156"><span class="lineNum">   15156 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="15157"><span class="lineNum">   15157 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::MultiPolygon );</span></a>
<a name="15158"><span class="lineNum">   15158 </span>                :            : </a>
<a name="15159"><span class="lineNum">   15159 </span>                :            :   //as JSON</a>
<a name="15160"><span class="lineNum">   15160 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon exportC;</span></a>
<a name="15161"><span class="lineNum">   15161 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3, 13 )</span></a>
<a name="15162"><span class="lineNum">   15162 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 21 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7, 17 ) ) ;</span></a>
<a name="15163"><span class="lineNum">   15163 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15164"><span class="lineNum">   15164 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15165"><span class="lineNum">   15165 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="15166"><span class="lineNum">   15166 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43, 43 )</span></a>
<a name="15167"><span class="lineNum">   15167 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 41, 39 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27, 37 ) ) ;</span></a>
<a name="15168"><span class="lineNum">   15168 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15169"><span class="lineNum">   15169 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15170"><span class="lineNum">   15170 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="15171"><span class="lineNum">   15171 </span>                :            : </a>
<a name="15172"><span class="lineNum">   15172 </span>                :            :   // GML document for compare</a>
<a name="15173"><span class="lineNum">   15173 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="15174"><span class="lineNum">   15174 </span>                :            : </a>
<a name="15175"><span class="lineNum">   15175 </span>                :            :   // as GML2</a>
<a name="15176"><span class="lineNum">   15176 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;7,17 3,13 7,21 7,17&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;27,37 43,43 41,39 27,37&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; ) );</span></a>
<a name="15177"><span class="lineNum">   15177 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc, 1 ) );</span></a>
<a name="15178"><span class="lineNum">   15178 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="15179"><span class="lineNum">   15179 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="15180"><span class="lineNum">   15180 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiPolygon().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="15181"><span class="lineNum">   15181 </span>                :            : </a>
<a name="15182"><span class="lineNum">   15182 </span>                :            :   //as GML3</a>
<a name="15183"><span class="lineNum">   15183 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;7 17 3 13 7 21 7 17&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;27 37 43 43 41 39 27 37&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; ) );</span></a>
<a name="15184"><span class="lineNum">   15184 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="15185"><span class="lineNum">   15185 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="15186"><span class="lineNum">   15186 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="15187"><span class="lineNum">   15187 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsMultiPolygon().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="15188"><span class="lineNum">   15188 </span>                :            : </a>
<a name="15189"><span class="lineNum">   15189 </span>                :            :   // as JSON</a>
<a name="15190"><span class="lineNum">   15190 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;coordinates\&quot;:[[[[7.0,17.0],[3.0,13.0],[7.0,21.0],[7.0,17.0]]],[[[27.0,37.0],[43.0,43.0],[41.0,39.0],[27.0,37.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="15191"><span class="lineNum">   15191 </span>                :<span class="lineCov">          1 :   res = exportC.asJson( 1 );</span></a>
<a name="15192"><span class="lineNum">   15192 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="15193"><span class="lineNum">   15193 </span>                :            : </a>
<a name="15194"><span class="lineNum">   15194 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 17, 27 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 18, 28 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 19, 37 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 17, 27 ) ) ;</span></a>
<a name="15195"><span class="lineNum">   15195 </span>                :<span class="lineCov">          1 :   part.addInteriorRing( ring.clone() );</span></a>
<a name="15196"><span class="lineNum">   15196 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="15197"><span class="lineNum">   15197 </span>                :            : </a>
<a name="15198"><span class="lineNum">   15198 </span>                :<span class="lineCov">          1 :   QString expectedJsonWithRings( &quot;{\&quot;coordinates\&quot;:[[[[7.0,17.0],[3.0,13.0],[7.0,21.0],[7.0,17.0]]],[[[27.0,37.0],[43.0,43.0],[41.0,39.0],[27.0,37.0]]],[[[27.0,37.0],[43.0,43.0],[41.0,39.0],[27.0,37.0]],[[17.0,27.0],[18.0,28.0],[19.0,37.0],[17.0,27.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="15199"><span class="lineNum">   15199 </span>                :<span class="lineCov">          1 :   res = exportC.asJson( 1 );</span></a>
<a name="15200"><span class="lineNum">   15200 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonWithRings );</span></a>
<a name="15201"><span class="lineNum">   15201 </span>                :            : </a>
<a name="15202"><span class="lineNum">   15202 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon exportFloat;</span></a>
<a name="15203"><span class="lineNum">   15203 </span>                :<span class="lineCov">          2 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7 / 3.0, 17 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 3 / 5.0, 13 / 3.0 )</span></a>
<a name="15204"><span class="lineNum">   15204 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 8 / 3.0, 27 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 7 / 3.0, 17 / 3.0 ) ) ;</span></a>
<a name="15205"><span class="lineNum">   15205 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15206"><span class="lineNum">   15206 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15207"><span class="lineNum">   15207 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="15208"><span class="lineNum">   15208 </span>                :<span class="lineCov">          1 :   ring.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27 / 3.0, 37 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 43 / 41.0, 43 / 42.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 27 / 3.0, 37 / 9.0 ) ) ;</span></a>
<a name="15209"><span class="lineNum">   15209 </span>                :<span class="lineCov">          1 :   part.clear();</span></a>
<a name="15210"><span class="lineNum">   15210 </span>                :<span class="lineCov">          1 :   part.setExteriorRing( ring.clone() );</span></a>
<a name="15211"><span class="lineNum">   15211 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="15212"><span class="lineNum">   15212 </span>                :            : </a>
<a name="15213"><span class="lineNum">   15213 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;coordinates\&quot;:[[[[2.333,5.667],[0.6,4.333],[2.667,9.0],[2.333,5.667]]],[[[9.0,4.111],[1.049,1.024],[9.0,4.111]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="15214"><span class="lineNum">   15214 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="15215"><span class="lineNum">   15215 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="15216"><span class="lineNum">   15216 </span>                :            : </a>
<a name="15217"><span class="lineNum">   15217 </span>                :            :   // as GML2</a>
<a name="15218"><span class="lineNum">   15218 </span>                :<span class="lineCov">          1 :   QString expectedGML2prec3( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;2.333,5.667 0.6,4.333 2.667,9 2.333,5.667&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;outerBoundaryIs xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;9,4.111 1.049,1.024 9,4.111&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; );</span></a>
<a name="15219"><span class="lineNum">   15219 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="15220"><span class="lineNum">   15220 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="15221"><span class="lineNum">   15221 </span>                :            : </a>
<a name="15222"><span class="lineNum">   15222 </span>                :            :   //as GML3</a>
<a name="15223"><span class="lineNum">   15223 </span>                :<span class="lineCov">          1 :   QString expectedGML3prec3( &quot;&lt;MultiPolygon xmlns=\&quot;gml\&quot;&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;2.333 5.667 0.6 4.333 2.667 9 2.333 5.667&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;polygonMember xmlns=\&quot;gml\&quot;&gt;&lt;Polygon xmlns=\&quot;gml\&quot;&gt;&lt;exterior xmlns=\&quot;gml\&quot;&gt;&lt;LinearRing xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;9 4.111 1.049 1.024 9 4.111&lt;/posList&gt;&lt;/LinearRing&gt;&lt;/exterior&gt;&lt;/Polygon&gt;&lt;/polygonMember&gt;&lt;/MultiPolygon&gt;&quot; );</span></a>
<a name="15224"><span class="lineNum">   15224 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="15225"><span class="lineNum">   15225 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="15226"><span class="lineNum">   15226 </span>                :            : </a>
<a name="15227"><span class="lineNum">   15227 </span>                :            :   //asKML</a>
<a name="15228"><span class="lineNum">   15228 </span>                :<span class="lineCov">          1 :   QString expectedKmlPrec3( &quot;&lt;MultiGeometry&gt;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;2.333,5.667,0 0.6,4.333,0 2.667,9,0 2.333,5.667,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;Polygon&gt;&lt;outerBoundaryIs&gt;&lt;LineString&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;9,4.111,0 1.049,1.024,0 9,4.111,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/outerBoundaryIs&gt;&lt;/Polygon&gt;&lt;/MultiGeometry&gt;&quot; );</span></a>
<a name="15229"><span class="lineNum">   15229 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="15230"><span class="lineNum">   15230 </span>                :            : </a>
<a name="15231"><span class="lineNum">   15231 </span>                :            : </a>
<a name="15232"><span class="lineNum">   15232 </span>                :            :   // insert geometry</a>
<a name="15233"><span class="lineNum">   15233 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon rc;</span></a>
<a name="15234"><span class="lineNum">   15234 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="15235"><span class="lineNum">   15235 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="15236"><span class="lineNum">   15236 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15237"><span class="lineNum">   15237 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15238"><span class="lineNum">   15238 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="15239"><span class="lineNum">   15239 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15240"><span class="lineNum">   15240 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15241"><span class="lineNum">   15241 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="15242"><span class="lineNum">   15242 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15243"><span class="lineNum">   15243 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15244"><span class="lineNum">   15244 </span>                :            : </a>
<a name="15245"><span class="lineNum">   15245 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( new QgsPoint(), 0 );</span></a>
<a name="15246"><span class="lineNum">   15246 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15247"><span class="lineNum">   15247 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15248"><span class="lineNum">   15248 </span>                :            : </a>
<a name="15249"><span class="lineNum">   15249 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part.clone(), 0 );</span></a>
<a name="15250"><span class="lineNum">   15250 </span>                :<span class="lineCov">          1 :   QVERIFY( !rc.isEmpty() );</span></a>
<a name="15251"><span class="lineNum">   15251 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="15252"><span class="lineNum">   15252 </span>                :            : </a>
<a name="15253"><span class="lineNum">   15253 </span>                :            :   // cast</a>
<a name="15254"><span class="lineNum">   15254 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsMultiPolygon().cast( nullptr ) );</span></a>
<a name="15255"><span class="lineNum">   15255 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon pCast;</span></a>
<a name="15256"><span class="lineNum">   15256 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPolygon().cast( &amp;pCast ) );</span></a>
<a name="15257"><span class="lineNum">   15257 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon pCast2;</span></a>
<a name="15258"><span class="lineNum">   15258 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPolygonZ()&quot; ) );</span></a>
<a name="15259"><span class="lineNum">   15259 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="15260"><span class="lineNum">   15260 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPolygonM()&quot; ) );</span></a>
<a name="15261"><span class="lineNum">   15261 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="15262"><span class="lineNum">   15262 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;MultiPolygonZM()&quot; ) );</span></a>
<a name="15263"><span class="lineNum">   15263 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiPolygon().cast( &amp;pCast2 ) );</span></a>
<a name="15264"><span class="lineNum">   15264 </span>                :            : </a>
<a name="15265"><span class="lineNum">   15265 </span>                :            : </a>
<a name="15266"><span class="lineNum">   15266 </span>                :            :   //boundary</a>
<a name="15267"><span class="lineNum">   15267 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon multiPolygon1;</span></a>
<a name="15268"><span class="lineNum">   15268 </span>                :<span class="lineCov">          1 :   QVERIFY( !multiPolygon1.boundary() );</span></a>
<a name="15269"><span class="lineNum">   15269 </span>                :            : </a>
<a name="15270"><span class="lineNum">   15270 </span>                :<span class="lineCov">          1 :   QgsLineString ring1;</span></a>
<a name="15271"><span class="lineNum">   15271 </span>                :<span class="lineCov">          1 :   ring1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) &lt;&lt; QgsPoint( 1, 1 )  &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="15272"><span class="lineNum">   15272 </span>                :<span class="lineCov">          1 :   QgsPolygon polygon1;</span></a>
<a name="15273"><span class="lineNum">   15273 </span>                :<span class="lineCov">          1 :   polygon1.setExteriorRing( ring1.clone() );</span></a>
<a name="15274"><span class="lineNum">   15274 </span>                :<span class="lineCov">          1 :   multiPolygon1.addGeometry( polygon1.clone() );</span></a>
<a name="15275"><span class="lineNum">   15275 </span>                :            : </a>
<a name="15276"><span class="lineNum">   15276 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsAbstractGeometry &gt; boundary( multiPolygon1.boundary() );</span></a>
<a name="15277"><span class="lineNum">   15277 </span>                :<span class="lineCov">          1 :   QgsMultiLineString *lineBoundary = dynamic_cast&lt; QgsMultiLineString * &gt;( boundary.get() );</span></a>
<a name="15278"><span class="lineNum">   15278 </span>                :<span class="lineCov">          1 :   QVERIFY( lineBoundary );</span></a>
<a name="15279"><span class="lineNum">   15279 </span>                :<span class="lineCov">          1 :   QCOMPARE( lineBoundary-&gt;numGeometries(), 1 );</span></a>
<a name="15280"><span class="lineNum">   15280 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;numPoints(), 4 );</span></a>
<a name="15281"><span class="lineNum">   15281 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="15282"><span class="lineNum">   15282 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="15283"><span class="lineNum">   15283 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 2 ), 1.0 );</span></a>
<a name="15284"><span class="lineNum">   15284 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 3 ), 0.0 );</span></a>
<a name="15285"><span class="lineNum">   15285 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="15286"><span class="lineNum">   15286 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="15287"><span class="lineNum">   15287 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 2 ), 1.0 );</span></a>
<a name="15288"><span class="lineNum">   15288 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( lineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 3 ), 0.0 );</span></a>
<a name="15289"><span class="lineNum">   15289 </span>                :            : </a>
<a name="15290"><span class="lineNum">   15290 </span>                :            :   // add polygon with interior rings</a>
<a name="15291"><span class="lineNum">   15291 </span>                :<span class="lineCov">          1 :   QgsLineString ring2;</span></a>
<a name="15292"><span class="lineNum">   15292 </span>                :<span class="lineCov">          1 :   ring2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 11, 11 )  &lt;&lt; QgsPoint( 10, 10 ) );</span></a>
<a name="15293"><span class="lineNum">   15293 </span>                :<span class="lineCov">          1 :   QgsPolygon polygon2;</span></a>
<a name="15294"><span class="lineNum">   15294 </span>                :<span class="lineCov">          1 :   polygon2.setExteriorRing( ring2.clone() );</span></a>
<a name="15295"><span class="lineNum">   15295 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryRing1;</span></a>
<a name="15296"><span class="lineNum">   15296 </span>                :<span class="lineCov">          1 :   boundaryRing1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10.1, 10.1 ) &lt;&lt; QgsPoint( 10.2, 10.1 ) &lt;&lt; QgsPoint( 10.2, 10.2 )  &lt;&lt; QgsPoint( 10.1, 10.1 ) );</span></a>
<a name="15297"><span class="lineNum">   15297 </span>                :<span class="lineCov">          1 :   QgsLineString boundaryRing2;</span></a>
<a name="15298"><span class="lineNum">   15298 </span>                :<span class="lineCov">          1 :   boundaryRing2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 10.8, 10.8 ) &lt;&lt; QgsPoint( 10.9, 10.8 ) &lt;&lt; QgsPoint( 10.9, 10.9 )  &lt;&lt; QgsPoint( 10.8, 10.8 ) );</span></a>
<a name="15299"><span class="lineNum">   15299 </span>                :<span class="lineCov">          1 :   polygon2.setInteriorRings( QVector&lt; QgsCurve * &gt;() &lt;&lt; boundaryRing1.clone() &lt;&lt; boundaryRing2.clone() );</span></a>
<a name="15300"><span class="lineNum">   15300 </span>                :<span class="lineCov">          1 :   multiPolygon1.addGeometry( polygon2.clone() );</span></a>
<a name="15301"><span class="lineNum">   15301 </span>                :            : </a>
<a name="15302"><span class="lineNum">   15302 </span>                :<span class="lineCov">          1 :   boundary.reset( multiPolygon1.boundary() );</span></a>
<a name="15303"><span class="lineNum">   15303 </span>                :<span class="lineCov">          1 :   QgsMultiLineString *multiLineBoundary( static_cast&lt; QgsMultiLineString * &gt;( boundary.get() ) );</span></a>
<a name="15304"><span class="lineNum">   15304 </span>                :<span class="lineCov">          1 :   QVERIFY( multiLineBoundary );</span></a>
<a name="15305"><span class="lineNum">   15305 </span>                :<span class="lineCov">          1 :   QCOMPARE( multiLineBoundary-&gt;numGeometries(), 4 );</span></a>
<a name="15306"><span class="lineNum">   15306 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;numPoints(), 4 );</span></a>
<a name="15307"><span class="lineNum">   15307 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 0 ), 0.0 );</span></a>
<a name="15308"><span class="lineNum">   15308 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 1 ), 1.0 );</span></a>
<a name="15309"><span class="lineNum">   15309 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 2 ), 1.0 );</span></a>
<a name="15310"><span class="lineNum">   15310 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;xAt( 3 ), 0.0 );</span></a>
<a name="15311"><span class="lineNum">   15311 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 0 ), 0.0 );</span></a>
<a name="15312"><span class="lineNum">   15312 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 1 ), 0.0 );</span></a>
<a name="15313"><span class="lineNum">   15313 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 2 ), 1.0 );</span></a>
<a name="15314"><span class="lineNum">   15314 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 0 ) )-&gt;yAt( 3 ), 0.0 );</span></a>
<a name="15315"><span class="lineNum">   15315 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;numPoints(), 4 );</span></a>
<a name="15316"><span class="lineNum">   15316 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 0 ), 10.0 );</span></a>
<a name="15317"><span class="lineNum">   15317 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 1 ), 11.0 );</span></a>
<a name="15318"><span class="lineNum">   15318 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 2 ), 11.0 );</span></a>
<a name="15319"><span class="lineNum">   15319 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;xAt( 3 ), 10.0 );</span></a>
<a name="15320"><span class="lineNum">   15320 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 0 ), 10.0 );</span></a>
<a name="15321"><span class="lineNum">   15321 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 1 ), 10.0 );</span></a>
<a name="15322"><span class="lineNum">   15322 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 2 ), 11.0 );</span></a>
<a name="15323"><span class="lineNum">   15323 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 1 ) )-&gt;yAt( 3 ), 10.0 );</span></a>
<a name="15324"><span class="lineNum">   15324 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;numPoints(), 4 );</span></a>
<a name="15325"><span class="lineNum">   15325 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 0 ), 10.1 );</span></a>
<a name="15326"><span class="lineNum">   15326 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 1 ), 10.2 );</span></a>
<a name="15327"><span class="lineNum">   15327 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 2 ), 10.2 );</span></a>
<a name="15328"><span class="lineNum">   15328 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;xAt( 3 ), 10.1 );</span></a>
<a name="15329"><span class="lineNum">   15329 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 0 ), 10.1 );</span></a>
<a name="15330"><span class="lineNum">   15330 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 1 ), 10.1 );</span></a>
<a name="15331"><span class="lineNum">   15331 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 2 ), 10.2 );</span></a>
<a name="15332"><span class="lineNum">   15332 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 2 ) )-&gt;yAt( 3 ), 10.1 );</span></a>
<a name="15333"><span class="lineNum">   15333 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;numPoints(), 4 );</span></a>
<a name="15334"><span class="lineNum">   15334 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;xAt( 0 ), 10.8 );</span></a>
<a name="15335"><span class="lineNum">   15335 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;xAt( 1 ), 10.9 );</span></a>
<a name="15336"><span class="lineNum">   15336 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;xAt( 2 ), 10.9 );</span></a>
<a name="15337"><span class="lineNum">   15337 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;xAt( 3 ), 10.8 );</span></a>
<a name="15338"><span class="lineNum">   15338 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;yAt( 0 ), 10.8 );</span></a>
<a name="15339"><span class="lineNum">   15339 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;yAt( 1 ), 10.8 );</span></a>
<a name="15340"><span class="lineNum">   15340 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;yAt( 2 ), 10.9 );</span></a>
<a name="15341"><span class="lineNum">   15341 </span>                :<span class="lineCov">          1 :   QCOMPARE( dynamic_cast&lt; QgsLineString * &gt;( multiLineBoundary-&gt;geometryN( 3 ) )-&gt;yAt( 3 ), 10.8 );</span></a>
<a name="15342"><span class="lineNum">   15342 </span>                :            : </a>
<a name="15343"><span class="lineNum">   15343 </span>                :            :   // vertex iterator: 2 polygons (one with just exterior ring, other with two interior rings)</a>
<a name="15344"><span class="lineNum">   15344 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator it = multiPolygon1.vertices_begin();</span></a>
<a name="15345"><span class="lineNum">   15345 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry::vertex_iterator itEnd = multiPolygon1.vertices_end();</span></a>
<a name="15346"><span class="lineNum">   15346 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 0, 0 ) );</span></a>
<a name="15347"><span class="lineNum">   15347 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="15348"><span class="lineNum">   15348 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15349"><span class="lineNum">   15349 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 1, 0 ) );</span></a>
<a name="15350"><span class="lineNum">   15350 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="15351"><span class="lineNum">   15351 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15352"><span class="lineNum">   15352 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 1, 1 ) );</span></a>
<a name="15353"><span class="lineNum">   15353 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="15354"><span class="lineNum">   15354 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15355"><span class="lineNum">   15355 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 0, 0 ) );</span></a>
<a name="15356"><span class="lineNum">   15356 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="15357"><span class="lineNum">   15357 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15358"><span class="lineNum">   15358 </span>                :            :   // 2nd polygon - exterior ring</a>
<a name="15359"><span class="lineNum">   15359 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10, 10 ) );</span></a>
<a name="15360"><span class="lineNum">   15360 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="15361"><span class="lineNum">   15361 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15362"><span class="lineNum">   15362 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 11, 10 ) );</span></a>
<a name="15363"><span class="lineNum">   15363 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 1 ) );</span></a>
<a name="15364"><span class="lineNum">   15364 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15365"><span class="lineNum">   15365 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 11, 11 ) );</span></a>
<a name="15366"><span class="lineNum">   15366 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="15367"><span class="lineNum">   15367 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15368"><span class="lineNum">   15368 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10, 10 ) );</span></a>
<a name="15369"><span class="lineNum">   15369 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 0, 3 ) );</span></a>
<a name="15370"><span class="lineNum">   15370 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15371"><span class="lineNum">   15371 </span>                :            :   // 2nd polygon - 1st interior ring</a>
<a name="15372"><span class="lineNum">   15372 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.1, 10.1 ) );</span></a>
<a name="15373"><span class="lineNum">   15373 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 1, 0 ) );</span></a>
<a name="15374"><span class="lineNum">   15374 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15375"><span class="lineNum">   15375 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.2, 10.1 ) );</span></a>
<a name="15376"><span class="lineNum">   15376 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 1, 1 ) );</span></a>
<a name="15377"><span class="lineNum">   15377 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15378"><span class="lineNum">   15378 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.2, 10.2 ) );</span></a>
<a name="15379"><span class="lineNum">   15379 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 1, 2 ) );</span></a>
<a name="15380"><span class="lineNum">   15380 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15381"><span class="lineNum">   15381 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.1, 10.1 ) );</span></a>
<a name="15382"><span class="lineNum">   15382 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 1, 3 ) );</span></a>
<a name="15383"><span class="lineNum">   15383 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15384"><span class="lineNum">   15384 </span>                :            :   // 2nd polygon - 2nd interior ring</a>
<a name="15385"><span class="lineNum">   15385 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.8, 10.8 ) );</span></a>
<a name="15386"><span class="lineNum">   15386 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 2, 0 ) );</span></a>
<a name="15387"><span class="lineNum">   15387 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15388"><span class="lineNum">   15388 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.9, 10.8 ) );</span></a>
<a name="15389"><span class="lineNum">   15389 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 2, 1 ) );</span></a>
<a name="15390"><span class="lineNum">   15390 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15391"><span class="lineNum">   15391 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.9, 10.9 ) );</span></a>
<a name="15392"><span class="lineNum">   15392 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 2, 2 ) );</span></a>
<a name="15393"><span class="lineNum">   15393 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15394"><span class="lineNum">   15394 </span>                :<span class="lineCov">          1 :   QCOMPARE( *it, QgsPoint( 10.8, 10.8 ) );</span></a>
<a name="15395"><span class="lineNum">   15395 </span>                :<span class="lineCov">          1 :   QCOMPARE( it.vertexId(), QgsVertexId( 1, 2, 3 ) );</span></a>
<a name="15396"><span class="lineNum">   15396 </span>                :<span class="lineCov">          1 :   ++it;</span></a>
<a name="15397"><span class="lineNum">   15397 </span>                :            :   // done!</a>
<a name="15398"><span class="lineNum">   15398 </span>                :<span class="lineCov">          1 :   QCOMPARE( it, itEnd );</span></a>
<a name="15399"><span class="lineNum">   15399 </span>                :            : </a>
<a name="15400"><span class="lineNum">   15400 </span>                :            :   // Java-style iterator</a>
<a name="15401"><span class="lineNum">   15401 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2( &amp;multiPolygon1 );</span></a>
<a name="15402"><span class="lineNum">   15402 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15403"><span class="lineNum">   15403 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 0, 0 ) );</span></a>
<a name="15404"><span class="lineNum">   15404 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15405"><span class="lineNum">   15405 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 0 ) );</span></a>
<a name="15406"><span class="lineNum">   15406 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15407"><span class="lineNum">   15407 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 1 ) );</span></a>
<a name="15408"><span class="lineNum">   15408 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15409"><span class="lineNum">   15409 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 0, 0 ) );</span></a>
<a name="15410"><span class="lineNum">   15410 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15411"><span class="lineNum">   15411 </span>                :            :   // 2nd polygon - exterior ring</a>
<a name="15412"><span class="lineNum">   15412 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10, 10 ) );</span></a>
<a name="15413"><span class="lineNum">   15413 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15414"><span class="lineNum">   15414 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 11, 10 ) );</span></a>
<a name="15415"><span class="lineNum">   15415 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15416"><span class="lineNum">   15416 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 11, 11 ) );</span></a>
<a name="15417"><span class="lineNum">   15417 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15418"><span class="lineNum">   15418 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10, 10 ) );</span></a>
<a name="15419"><span class="lineNum">   15419 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15420"><span class="lineNum">   15420 </span>                :            :   // 2nd polygon - 1st interior ring</a>
<a name="15421"><span class="lineNum">   15421 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.1, 10.1 ) );</span></a>
<a name="15422"><span class="lineNum">   15422 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15423"><span class="lineNum">   15423 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.2, 10.1 ) );</span></a>
<a name="15424"><span class="lineNum">   15424 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15425"><span class="lineNum">   15425 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.2, 10.2 ) );</span></a>
<a name="15426"><span class="lineNum">   15426 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15427"><span class="lineNum">   15427 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.1, 10.1 ) );</span></a>
<a name="15428"><span class="lineNum">   15428 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15429"><span class="lineNum">   15429 </span>                :            :   // 2nd polygon - 2nd interior ring</a>
<a name="15430"><span class="lineNum">   15430 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.8, 10.8 ) );</span></a>
<a name="15431"><span class="lineNum">   15431 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15432"><span class="lineNum">   15432 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.9, 10.8 ) );</span></a>
<a name="15433"><span class="lineNum">   15433 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15434"><span class="lineNum">   15434 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.9, 10.9 ) );</span></a>
<a name="15435"><span class="lineNum">   15435 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="15436"><span class="lineNum">   15436 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 10.8, 10.8 ) );</span></a>
<a name="15437"><span class="lineNum">   15437 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="15438"><span class="lineNum">   15438 </span>                :            : </a>
<a name="15439"><span class="lineNum">   15439 </span>                :            :   //removeDuplicateNodes</a>
<a name="15440"><span class="lineNum">   15440 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon dn1;</span></a>
<a name="15441"><span class="lineNum">   15441 </span>                :<span class="lineCov">          2 :   QVERIFY( dn1.fromWkt( QStringLiteral( &quot;MultiPolygonZ (((0 0 0, 10 10 0, 11 9 0, 9 8 0, 9 8 0, 1 -1 0, 0 0 0)),((7 -1 0, 12 7 0, 13 6 0, 13 6 0, 8 -3 0, 7 -1 0)))&quot; ) ) );</span></a>
<a name="15442"><span class="lineNum">   15442 </span>                :<span class="lineCov">          1 :   QCOMPARE( dn1.numGeometries(), 2 );</span></a>
<a name="15443"><span class="lineNum">   15443 </span>                :            :   // First call should remove all duplicate nodes (one per part)</a>
<a name="15444"><span class="lineNum">   15444 </span>                :<span class="lineCov">          1 :   QVERIFY( dn1.removeDuplicateNodes( 0.001, false ) );</span></a>
<a name="15445"><span class="lineNum">   15445 </span>                :<span class="lineCov">          1 :   QVERIFY( !dn1.removeDuplicateNodes( 0.001, false ) );</span></a>
<a name="15446"><span class="lineNum">   15446 </span>                :<span class="lineCov">          2 :   QCOMPARE( dn1.asWkt(), QStringLiteral( &quot;MultiPolygonZ (((0 0 0, 10 10 0, 11 9 0, 9 8 0, 1 -1 0, 0 0 0)),((7 -1 0, 12 7 0, 13 6 0, 8 -3 0, 7 -1 0)))&quot; ) );</span></a>
<a name="15447"><span class="lineNum">   15447 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="15448"><span class="lineNum">   15448 </span>                :            : </a>
<a name="15449"><span class="lineNum">   15449 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::geometryCollection()</span></a>
<a name="15450"><span class="lineNum">   15450 </span>                :            : {</a>
<a name="15451"><span class="lineNum">   15451 </span>                :            :   //test constructor</a>
<a name="15452"><span class="lineNum">   15452 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c1;</span></a>
<a name="15453"><span class="lineNum">   15453 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="15454"><span class="lineNum">   15454 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="15455"><span class="lineNum">   15455 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="15456"><span class="lineNum">   15456 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="15457"><span class="lineNum">   15457 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="15458"><span class="lineNum">   15458 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="15459"><span class="lineNum">   15459 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15460"><span class="lineNum">   15460 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15461"><span class="lineNum">   15461 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15462"><span class="lineNum">   15462 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 0 );</span></a>
<a name="15463"><span class="lineNum">   15463 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="15464"><span class="lineNum">   15464 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="15465"><span class="lineNum">   15465 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="15466"><span class="lineNum">   15466 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="15467"><span class="lineNum">   15467 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="15468"><span class="lineNum">   15468 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="15469"><span class="lineNum">   15469 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 0 );</span></a>
<a name="15470"><span class="lineNum">   15470 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 1 ), 0 );</span></a>
<a name="15471"><span class="lineNum">   15471 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="15472"><span class="lineNum">   15472 </span>                :            : </a>
<a name="15473"><span class="lineNum">   15473 </span>                :            :   //addGeometry</a>
<a name="15474"><span class="lineNum">   15474 </span>                :            : </a>
<a name="15475"><span class="lineNum">   15475 </span>                :            :   //try with nullptr</a>
<a name="15476"><span class="lineNum">   15476 </span>                :<span class="lineCov">          1 :   c1.addGeometry( nullptr );</span></a>
<a name="15477"><span class="lineNum">   15477 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.isEmpty() );</span></a>
<a name="15478"><span class="lineNum">   15478 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 0 );</span></a>
<a name="15479"><span class="lineNum">   15479 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 0 );</span></a>
<a name="15480"><span class="lineNum">   15480 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 0 );</span></a>
<a name="15481"><span class="lineNum">   15481 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 0 );</span></a>
<a name="15482"><span class="lineNum">   15482 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15483"><span class="lineNum">   15483 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 0 ) );</span></a>
<a name="15484"><span class="lineNum">   15484 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="15485"><span class="lineNum">   15485 </span>                :            : </a>
<a name="15486"><span class="lineNum">   15486 </span>                :            :   //valid geometry</a>
<a name="15487"><span class="lineNum">   15487 </span>                :<span class="lineCov">          1 :   QgsLineString part;</span></a>
<a name="15488"><span class="lineNum">   15488 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="15489"><span class="lineNum">   15489 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="15490"><span class="lineNum">   15490 </span>                :<span class="lineCov">          1 :   c1.addGeometry( part.clone() );</span></a>
<a name="15491"><span class="lineNum">   15491 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isEmpty() );</span></a>
<a name="15492"><span class="lineNum">   15492 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.numGeometries(), 1 );</span></a>
<a name="15493"><span class="lineNum">   15493 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.nCoordinates(), 5 );</span></a>
<a name="15494"><span class="lineNum">   15494 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.ringCount(), 1 );</span></a>
<a name="15495"><span class="lineNum">   15495 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.partCount(), 1 );</span></a>
<a name="15496"><span class="lineNum">   15496 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.is3D() );</span></a>
<a name="15497"><span class="lineNum">   15497 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.isMeasure() );</span></a>
<a name="15498"><span class="lineNum">   15498 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15499"><span class="lineNum">   15499 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.wktTypeStr(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15500"><span class="lineNum">   15500 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.geometryType(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15501"><span class="lineNum">   15501 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.dimension(), 1 );</span></a>
<a name="15502"><span class="lineNum">   15502 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.hasCurvedSegments() );</span></a>
<a name="15503"><span class="lineNum">   15503 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.area(), 0.0 );</span></a>
<a name="15504"><span class="lineNum">   15504 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.perimeter(), 0.0 );</span></a>
<a name="15505"><span class="lineNum">   15505 </span>                :<span class="lineCov">          1 :   QVERIFY( c1.geometryN( 0 ) );</span></a>
<a name="15506"><span class="lineNum">   15506 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( 100 ) );</span></a>
<a name="15507"><span class="lineNum">   15507 </span>                :<span class="lineCov">          1 :   QVERIFY( !c1.geometryN( -1 ) );</span></a>
<a name="15508"><span class="lineNum">   15508 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 0, 0 ), 5 );</span></a>
<a name="15509"><span class="lineNum">   15509 </span>                :<span class="lineCov">          1 :   QCOMPARE( c1.vertexCount( 1, 0 ), 0 );</span></a>
<a name="15510"><span class="lineNum">   15510 </span>                :            : </a>
<a name="15511"><span class="lineNum">   15511 </span>                :            :   //retrieve geometry and check</a>
<a name="15512"><span class="lineNum">   15512 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c1.geometryN( 0 ) ) ), part );</span></a>
<a name="15513"><span class="lineNum">   15513 </span>                :            : </a>
<a name="15514"><span class="lineNum">   15514 </span>                :            :   //initial adding of geometry should set z/m type</a>
<a name="15515"><span class="lineNum">   15515 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="15516"><span class="lineNum">   15516 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="15517"><span class="lineNum">   15517 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="15518"><span class="lineNum">   15518 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c2;</span></a>
<a name="15519"><span class="lineNum">   15519 </span>                :<span class="lineCov">          1 :   c2.addGeometry( part.clone() );</span></a>
<a name="15520"><span class="lineNum">   15520 </span>                :            :   //QVERIFY( c2.is3D() ); //no meaning for collections?</a>
<a name="15521"><span class="lineNum">   15521 </span>                :            :   //QVERIFY( !c2.isMeasure() ); //no meaning for collections?</a>
<a name="15522"><span class="lineNum">   15522 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15523"><span class="lineNum">   15523 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.wktTypeStr(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15524"><span class="lineNum">   15524 </span>                :<span class="lineCov">          1 :   QCOMPARE( c2.geometryType(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15525"><span class="lineNum">   15525 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c2.geometryN( 0 ) ) ), part );</span></a>
<a name="15526"><span class="lineNum">   15526 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c3;</span></a>
<a name="15527"><span class="lineNum">   15527 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="15528"><span class="lineNum">   15528 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="15529"><span class="lineNum">   15529 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="15530"><span class="lineNum">   15530 </span>                :<span class="lineCov">          1 :   c3.addGeometry( part.clone() );</span></a>
<a name="15531"><span class="lineNum">   15531 </span>                :            :   //QVERIFY( !c3.is3D() ); //no meaning for collections?</a>
<a name="15532"><span class="lineNum">   15532 </span>                :            :   //QVERIFY( c3.isMeasure() ); //no meaning for collections?</a>
<a name="15533"><span class="lineNum">   15533 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15534"><span class="lineNum">   15534 </span>                :<span class="lineCov">          1 :   QCOMPARE( c3.wktTypeStr(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15535"><span class="lineNum">   15535 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c3.geometryN( 0 ) ) ), part );</span></a>
<a name="15536"><span class="lineNum">   15536 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c4;</span></a>
<a name="15537"><span class="lineNum">   15537 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 )</span></a>
<a name="15538"><span class="lineNum">   15538 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 3, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 5, 3 )</span></a>
<a name="15539"><span class="lineNum">   15539 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 2, 1 ) );</span></a>
<a name="15540"><span class="lineNum">   15540 </span>                :<span class="lineCov">          1 :   c4.addGeometry( part.clone() );</span></a>
<a name="15541"><span class="lineNum">   15541 </span>                :            :   //QVERIFY( c4.is3D() ); //no meaning for collections?</a>
<a name="15542"><span class="lineNum">   15542 </span>                :            :   //QVERIFY( c4.isMeasure() ); //no meaning for collections?</a>
<a name="15543"><span class="lineNum">   15543 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15544"><span class="lineNum">   15544 </span>                :<span class="lineCov">          1 :   QCOMPARE( c4.wktTypeStr(), QString( &quot;GeometryCollection&quot; ) );</span></a>
<a name="15545"><span class="lineNum">   15545 </span>                :<span class="lineCov">          1 :   QCOMPARE( *( static_cast&lt; const QgsLineString * &gt;( c4.geometryN( 0 ) ) ), part );</span></a>
<a name="15546"><span class="lineNum">   15546 </span>                :            : </a>
<a name="15547"><span class="lineNum">   15547 </span>                :            :   //add another part</a>
<a name="15548"><span class="lineNum">   15548 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c6;</span></a>
<a name="15549"><span class="lineNum">   15549 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="15550"><span class="lineNum">   15550 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="15551"><span class="lineNum">   15551 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="15552"><span class="lineNum">   15552 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 0, 0 ), 5 );</span></a>
<a name="15553"><span class="lineNum">   15553 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</span></a>
<a name="15554"><span class="lineNum">   15554 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) );</span></a>
<a name="15555"><span class="lineNum">   15555 </span>                :<span class="lineCov">          1 :   c6.addGeometry( part.clone() );</span></a>
<a name="15556"><span class="lineNum">   15556 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.vertexCount( 1, 0 ), 5 );</span></a>
<a name="15557"><span class="lineNum">   15557 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.numGeometries(), 2 );</span></a>
<a name="15558"><span class="lineNum">   15558 </span>                :<span class="lineCov">          1 :   QVERIFY( c6.geometryN( 0 ) );</span></a>
<a name="15559"><span class="lineNum">   15559 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c6.geometryN( 1 ) ), part );</span></a>
<a name="15560"><span class="lineNum">   15560 </span>                :            : </a>
<a name="15561"><span class="lineNum">   15561 </span>                :<span class="lineCov">          1 :   QgsCoordinateSequence seq = c6.coordinateSequence();</span></a>
<a name="15562"><span class="lineNum">   15562 </span>                :<span class="lineCov">          1 :   QCOMPARE( seq, QgsCoordinateSequence() &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 10 ) &lt;&lt; QgsPoint( 10, 10 )</span></a>
<a name="15563"><span class="lineNum">   15563 </span>                :            :             &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 0, 0 ) ) )</a>
<a name="15564"><span class="lineNum">   15564 </span>                :            :             &lt;&lt; ( QgsRingSequence() &lt;&lt; ( QgsPointSequence() &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 1, 9 ) &lt;&lt; QgsPoint( 9, 9 )</a>
<a name="15565"><span class="lineNum">   15565 </span>                :            :                                         &lt;&lt; QgsPoint( 9, 1 ) &lt;&lt; QgsPoint( 1, 1 ) ) ) );</a>
<a name="15566"><span class="lineNum">   15566 </span>                :<span class="lineCov">          1 :   QCOMPARE( c6.nCoordinates(), 10 );</span></a>
<a name="15567"><span class="lineNum">   15567 </span>                :            : </a>
<a name="15568"><span class="lineNum">   15568 </span>                :            : </a>
<a name="15569"><span class="lineNum">   15569 </span>                :            :   //clear</a>
<a name="15570"><span class="lineNum">   15570 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c7;</span></a>
<a name="15571"><span class="lineNum">   15571 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="15572"><span class="lineNum">   15572 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="15573"><span class="lineNum">   15573 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="15574"><span class="lineNum">   15574 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="15575"><span class="lineNum">   15575 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="15576"><span class="lineNum">   15576 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="15577"><span class="lineNum">   15577 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="15578"><span class="lineNum">   15578 </span>                :<span class="lineCov">          1 :   c7.addGeometry( part.clone() );</span></a>
<a name="15579"><span class="lineNum">   15579 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 2 );</span></a>
<a name="15580"><span class="lineNum">   15580 </span>                :<span class="lineCov">          1 :   c7.clear();</span></a>
<a name="15581"><span class="lineNum">   15581 </span>                :<span class="lineCov">          1 :   QVERIFY( c7.isEmpty() );</span></a>
<a name="15582"><span class="lineNum">   15582 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.numGeometries(), 0 );</span></a>
<a name="15583"><span class="lineNum">   15583 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.nCoordinates(), 0 );</span></a>
<a name="15584"><span class="lineNum">   15584 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.ringCount(), 0 );</span></a>
<a name="15585"><span class="lineNum">   15585 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.partCount(), 0 );</span></a>
<a name="15586"><span class="lineNum">   15586 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.is3D() );</span></a>
<a name="15587"><span class="lineNum">   15587 </span>                :<span class="lineCov">          1 :   QVERIFY( !c7.isMeasure() );</span></a>
<a name="15588"><span class="lineNum">   15588 </span>                :<span class="lineCov">          1 :   QCOMPARE( c7.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15589"><span class="lineNum">   15589 </span>                :            : </a>
<a name="15590"><span class="lineNum">   15590 </span>                :            :   //clone</a>
<a name="15591"><span class="lineNum">   15591 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c11;</span></a>
<a name="15592"><span class="lineNum">   15592 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryCollection &gt;cloned( c11.clone() );</span></a>
<a name="15593"><span class="lineNum">   15593 </span>                :<span class="lineCov">          1 :   QVERIFY( cloned-&gt;isEmpty() );</span></a>
<a name="15594"><span class="lineNum">   15594 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="15595"><span class="lineNum">   15595 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="15596"><span class="lineNum">   15596 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15597"><span class="lineNum">   15597 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part.clone() );</span></a>
<a name="15598"><span class="lineNum">   15598 </span>                :<span class="lineCov">          1 :   QgsLineString part2;</span></a>
<a name="15599"><span class="lineNum">   15599 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="15600"><span class="lineNum">   15600 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="15601"><span class="lineNum">   15601 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15602"><span class="lineNum">   15602 </span>                :<span class="lineCov">          1 :   c11.addGeometry( part2.clone() );</span></a>
<a name="15603"><span class="lineNum">   15603 </span>                :<span class="lineCov">          1 :   cloned.reset( c11.clone() );</span></a>
<a name="15604"><span class="lineNum">   15604 </span>                :<span class="lineCov">          1 :   QCOMPARE( cloned-&gt;numGeometries(), 2 );</span></a>
<a name="15605"><span class="lineNum">   15605 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( cloned-&gt;geometryN( 0 ) ), part );</span></a>
<a name="15606"><span class="lineNum">   15606 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( cloned-&gt;geometryN( 1 ) ), part2 );</span></a>
<a name="15607"><span class="lineNum">   15607 </span>                :            : </a>
<a name="15608"><span class="lineNum">   15608 </span>                :            :   //copy constructor</a>
<a name="15609"><span class="lineNum">   15609 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c12;</span></a>
<a name="15610"><span class="lineNum">   15610 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c13( c12 );</span></a>
<a name="15611"><span class="lineNum">   15611 </span>                :<span class="lineCov">          1 :   QVERIFY( c13.isEmpty() );</span></a>
<a name="15612"><span class="lineNum">   15612 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="15613"><span class="lineNum">   15613 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="15614"><span class="lineNum">   15614 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15615"><span class="lineNum">   15615 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part.clone() );</span></a>
<a name="15616"><span class="lineNum">   15616 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="15617"><span class="lineNum">   15617 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="15618"><span class="lineNum">   15618 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15619"><span class="lineNum">   15619 </span>                :<span class="lineCov">          1 :   c12.addGeometry( part2.clone() );</span></a>
<a name="15620"><span class="lineNum">   15620 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c14( c12 );</span></a>
<a name="15621"><span class="lineNum">   15621 </span>                :<span class="lineCov">          1 :   QCOMPARE( c14.numGeometries(), 2 );</span></a>
<a name="15622"><span class="lineNum">   15622 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c14.geometryN( 0 ) ), part );</span></a>
<a name="15623"><span class="lineNum">   15623 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c14.geometryN( 1 ) ), part2 );</span></a>
<a name="15624"><span class="lineNum">   15624 </span>                :            : </a>
<a name="15625"><span class="lineNum">   15625 </span>                :            :   //assignment operator</a>
<a name="15626"><span class="lineNum">   15626 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c15;</span></a>
<a name="15627"><span class="lineNum">   15627 </span>                :<span class="lineCov">          1 :   c15 = c13;</span></a>
<a name="15628"><span class="lineNum">   15628 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 0 );</span></a>
<a name="15629"><span class="lineNum">   15629 </span>                :<span class="lineCov">          1 :   c15 = c14;</span></a>
<a name="15630"><span class="lineNum">   15630 </span>                :<span class="lineCov">          1 :   QCOMPARE( c15.numGeometries(), 2 );</span></a>
<a name="15631"><span class="lineNum">   15631 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c15.geometryN( 0 ) ), part );</span></a>
<a name="15632"><span class="lineNum">   15632 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c15.geometryN( 1 ) ), part2 );</span></a>
<a name="15633"><span class="lineNum">   15633 </span>                :            : </a>
<a name="15634"><span class="lineNum">   15634 </span>                :            :   //equality</a>
<a name="15635"><span class="lineNum">   15635 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection emptyCollection;</span></a>
<a name="15636"><span class="lineNum">   15636 </span>                :<span class="lineCov">          1 :   QVERIFY( !( emptyCollection == c15 ) );</span></a>
<a name="15637"><span class="lineNum">   15637 </span>                :<span class="lineCov">          1 :   QVERIFY( emptyCollection != c15 );</span></a>
<a name="15638"><span class="lineNum">   15638 </span>                :<span class="lineCov">          1 :   QgsPoint notCollection;</span></a>
<a name="15639"><span class="lineNum">   15639 </span>                :<span class="lineCov">          1 :   QVERIFY( !( emptyCollection == notCollection ) );</span></a>
<a name="15640"><span class="lineNum">   15640 </span>                :<span class="lineCov">          1 :   QVERIFY( emptyCollection != notCollection );</span></a>
<a name="15641"><span class="lineNum">   15641 </span>                :<span class="lineCov">          1 :   QgsMultiPoint mp;</span></a>
<a name="15642"><span class="lineNum">   15642 </span>                :<span class="lineCov">          1 :   QgsMultiLineString ml;</span></a>
<a name="15643"><span class="lineNum">   15643 </span>                :<span class="lineCov">          1 :   QVERIFY( mp != ml );</span></a>
<a name="15644"><span class="lineNum">   15644 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="15645"><span class="lineNum">   15645 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="15646"><span class="lineNum">   15646 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="15647"><span class="lineNum">   15647 </span>                :<span class="lineCov">          1 :   ml.addGeometry( part.clone() );</span></a>
<a name="15648"><span class="lineNum">   15648 </span>                :<span class="lineCov">          1 :   QgsMultiLineString ml2;</span></a>
<a name="15649"><span class="lineNum">   15649 </span>                :<span class="lineCov">          1 :   QVERIFY( ml != ml2 );</span></a>
<a name="15650"><span class="lineNum">   15650 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="15651"><span class="lineNum">   15651 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="15652"><span class="lineNum">   15652 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="15653"><span class="lineNum">   15653 </span>                :<span class="lineCov">          1 :   ml2.addGeometry( part.clone() );</span></a>
<a name="15654"><span class="lineNum">   15654 </span>                :<span class="lineCov">          1 :   QVERIFY( ml != ml2 );</span></a>
<a name="15655"><span class="lineNum">   15655 </span>                :            : </a>
<a name="15656"><span class="lineNum">   15656 </span>                :<span class="lineCov">          1 :   QgsMultiLineString ml3;</span></a>
<a name="15657"><span class="lineNum">   15657 </span>                :<span class="lineCov">          1 :   ml3.addGeometry( part.clone() );</span></a>
<a name="15658"><span class="lineNum">   15658 </span>                :<span class="lineCov">          1 :   QVERIFY( ml2 == ml3 );</span></a>
<a name="15659"><span class="lineNum">   15659 </span>                :            : </a>
<a name="15660"><span class="lineNum">   15660 </span>                :            :   //toCurveType</a>
<a name="15661"><span class="lineNum">   15661 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryCollection &gt; curveType( c12.toCurveType() );</span></a>
<a name="15662"><span class="lineNum">   15662 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15663"><span class="lineNum">   15663 </span>                :<span class="lineCov">          1 :   QCOMPARE( curveType-&gt;numGeometries(), 2 );</span></a>
<a name="15664"><span class="lineNum">   15664 </span>                :<span class="lineCov">          1 :   const QgsCompoundCurve *curve = static_cast&lt; const QgsCompoundCurve * &gt;( curveType-&gt;geometryN( 0 ) );</span></a>
<a name="15665"><span class="lineNum">   15665 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;numPoints(), 5 );</span></a>
<a name="15666"><span class="lineNum">   15666 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 ) );</span></a>
<a name="15667"><span class="lineNum">   15667 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) );</span></a>
<a name="15668"><span class="lineNum">   15668 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 ) );</span></a>
<a name="15669"><span class="lineNum">   15669 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) );</span></a>
<a name="15670"><span class="lineNum">   15670 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15671"><span class="lineNum">   15671 </span>                :<span class="lineCov">          1 :   curve = static_cast&lt; const QgsCompoundCurve * &gt;( curveType-&gt;geometryN( 1 ) );</span></a>
<a name="15672"><span class="lineNum">   15672 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;numPoints(), 5 );</span></a>
<a name="15673"><span class="lineNum">   15673 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 ) );</span></a>
<a name="15674"><span class="lineNum">   15674 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 1 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) );</span></a>
<a name="15675"><span class="lineNum">   15675 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 2 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 ) );</span></a>
<a name="15676"><span class="lineNum">   15676 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 3 ) ), QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) );</span></a>
<a name="15677"><span class="lineNum">   15677 </span>                :<span class="lineCov">          1 :   QCOMPARE( curve-&gt;vertexAt( QgsVertexId( 0, 0, 4 ) ), QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15678"><span class="lineNum">   15678 </span>                :            : </a>
<a name="15679"><span class="lineNum">   15679 </span>                :            :   //to/fromWKB</a>
<a name="15680"><span class="lineNum">   15680 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c16;</span></a>
<a name="15681"><span class="lineNum">   15681 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="15682"><span class="lineNum">   15682 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 10 )</span></a>
<a name="15683"><span class="lineNum">   15683 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 ) );</span></a>
<a name="15684"><span class="lineNum">   15684 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15685"><span class="lineNum">   15685 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 )</span></a>
<a name="15686"><span class="lineNum">   15686 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 9 )</span></a>
<a name="15687"><span class="lineNum">   15687 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 ) );</span></a>
<a name="15688"><span class="lineNum">   15688 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part2.clone() );</span></a>
<a name="15689"><span class="lineNum">   15689 </span>                :<span class="lineCov">          1 :   QByteArray wkb16 = c16.asWkb();</span></a>
<a name="15690"><span class="lineNum">   15690 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkb16.size(), c16.wkbSize() );</span></a>
<a name="15691"><span class="lineNum">   15691 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c17;</span></a>
<a name="15692"><span class="lineNum">   15692 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr( wkb16 );</span></a>
<a name="15693"><span class="lineNum">   15693 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr );</span></a>
<a name="15694"><span class="lineNum">   15694 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15695"><span class="lineNum">   15695 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), part );</span></a>
<a name="15696"><span class="lineNum">   15696 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), part2 );</span></a>
<a name="15697"><span class="lineNum">   15697 </span>                :            : </a>
<a name="15698"><span class="lineNum">   15698 </span>                :            :   //parts with Z</a>
<a name="15699"><span class="lineNum">   15699 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15700"><span class="lineNum">   15700 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15701"><span class="lineNum">   15701 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 )</span></a>
<a name="15702"><span class="lineNum">   15702 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 10, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 3 )</span></a>
<a name="15703"><span class="lineNum">   15703 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 0, 0, 1 ) );</span></a>
<a name="15704"><span class="lineNum">   15704 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15705"><span class="lineNum">   15705 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 )</span></a>
<a name="15706"><span class="lineNum">   15706 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 9, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 9, 3 )</span></a>
<a name="15707"><span class="lineNum">   15707 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 9, 1, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 1, 1, 1 ) );</span></a>
<a name="15708"><span class="lineNum">   15708 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part2.clone() );</span></a>
<a name="15709"><span class="lineNum">   15709 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15710"><span class="lineNum">   15710 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr2( wkb16 );</span></a>
<a name="15711"><span class="lineNum">   15711 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr2 );</span></a>
<a name="15712"><span class="lineNum">   15712 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15713"><span class="lineNum">   15713 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), part );</span></a>
<a name="15714"><span class="lineNum">   15714 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), part2 );</span></a>
<a name="15715"><span class="lineNum">   15715 </span>                :            : </a>
<a name="15716"><span class="lineNum">   15716 </span>                :            : </a>
<a name="15717"><span class="lineNum">   15717 </span>                :            :   //parts with m</a>
<a name="15718"><span class="lineNum">   15718 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15719"><span class="lineNum">   15719 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15720"><span class="lineNum">   15720 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 )</span></a>
<a name="15721"><span class="lineNum">   15721 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 10,  0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 10, 0, 3 )</span></a>
<a name="15722"><span class="lineNum">   15722 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 0,  0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 0, 0, 0, 1 ) );</span></a>
<a name="15723"><span class="lineNum">   15723 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15724"><span class="lineNum">   15724 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 1 )</span></a>
<a name="15725"><span class="lineNum">   15725 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 9, 0, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 9, 0, 3 )</span></a>
<a name="15726"><span class="lineNum">   15726 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 9, 1, 0, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 1, 0, 1 ) );</span></a>
<a name="15727"><span class="lineNum">   15727 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part2.clone() );</span></a>
<a name="15728"><span class="lineNum">   15728 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15729"><span class="lineNum">   15729 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr3( wkb16 );</span></a>
<a name="15730"><span class="lineNum">   15730 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr3 );</span></a>
<a name="15731"><span class="lineNum">   15731 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15732"><span class="lineNum">   15732 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), part );</span></a>
<a name="15733"><span class="lineNum">   15733 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), part2 );</span></a>
<a name="15734"><span class="lineNum">   15734 </span>                :            : </a>
<a name="15735"><span class="lineNum">   15735 </span>                :            :   // parts with ZM</a>
<a name="15736"><span class="lineNum">   15736 </span>                :<span class="lineCov">          1 :   c16.clear();</span></a>
<a name="15737"><span class="lineNum">   15737 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15738"><span class="lineNum">   15738 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="15739"><span class="lineNum">   15739 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="15740"><span class="lineNum">   15740 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15741"><span class="lineNum">   15741 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part.clone() );</span></a>
<a name="15742"><span class="lineNum">   15742 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="15743"><span class="lineNum">   15743 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="15744"><span class="lineNum">   15744 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15745"><span class="lineNum">   15745 </span>                :<span class="lineCov">          1 :   c16.addGeometry( part2.clone() );</span></a>
<a name="15746"><span class="lineNum">   15746 </span>                :<span class="lineCov">          1 :   wkb16 = c16.asWkb();</span></a>
<a name="15747"><span class="lineNum">   15747 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkb16ptr4( wkb16 );</span></a>
<a name="15748"><span class="lineNum">   15748 </span>                :<span class="lineCov">          1 :   c17.fromWkb( wkb16ptr4 );</span></a>
<a name="15749"><span class="lineNum">   15749 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.numGeometries(), 2 );</span></a>
<a name="15750"><span class="lineNum">   15750 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 0 ) ), part );</span></a>
<a name="15751"><span class="lineNum">   15751 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c17.geometryN( 1 ) ), part2 );</span></a>
<a name="15752"><span class="lineNum">   15752 </span>                :            : </a>
<a name="15753"><span class="lineNum">   15753 </span>                :            : </a>
<a name="15754"><span class="lineNum">   15754 </span>                :            :   //bad WKB - check for no crash</a>
<a name="15755"><span class="lineNum">   15755 </span>                :<span class="lineCov">          1 :   c17.clear();</span></a>
<a name="15756"><span class="lineNum">   15756 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr nullPtr( nullptr, 0 );</span></a>
<a name="15757"><span class="lineNum">   15757 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( nullPtr ) );</span></a>
<a name="15758"><span class="lineNum">   15758 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15759"><span class="lineNum">   15759 </span>                :<span class="lineCov">          1 :   QgsPoint point( 1, 2 );</span></a>
<a name="15760"><span class="lineNum">   15760 </span>                :<span class="lineCov">          1 :   QByteArray wkbPoint = point.asWkb();</span></a>
<a name="15761"><span class="lineNum">   15761 </span>                :<span class="lineCov">          1 :   QgsConstWkbPtr wkbPointPtr( wkbPoint );</span></a>
<a name="15762"><span class="lineNum">   15762 </span>                :<span class="lineCov">          1 :   QVERIFY( !c17.fromWkb( wkbPointPtr ) );</span></a>
<a name="15763"><span class="lineNum">   15763 </span>                :<span class="lineCov">          1 :   QCOMPARE( c17.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15764"><span class="lineNum">   15764 </span>                :            : </a>
<a name="15765"><span class="lineNum">   15765 </span>                :            :   //to/from WKT</a>
<a name="15766"><span class="lineNum">   15766 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c18;</span></a>
<a name="15767"><span class="lineNum">   15767 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="15768"><span class="lineNum">   15768 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="15769"><span class="lineNum">   15769 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15770"><span class="lineNum">   15770 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part.clone() );</span></a>
<a name="15771"><span class="lineNum">   15771 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="15772"><span class="lineNum">   15772 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="15773"><span class="lineNum">   15773 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15774"><span class="lineNum">   15774 </span>                :<span class="lineCov">          1 :   c18.addGeometry( part2.clone() );</span></a>
<a name="15775"><span class="lineNum">   15775 </span>                :            : </a>
<a name="15776"><span class="lineNum">   15776 </span>                :<span class="lineCov">          1 :   QString wkt = c18.asWkt();</span></a>
<a name="15777"><span class="lineNum">   15777 </span>                :<span class="lineCov">          1 :   QVERIFY( !wkt.isEmpty() );</span></a>
<a name="15778"><span class="lineNum">   15778 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c19;</span></a>
<a name="15779"><span class="lineNum">   15779 </span>                :<span class="lineCov">          1 :   QVERIFY( c19.fromWkt( wkt ) );</span></a>
<a name="15780"><span class="lineNum">   15780 </span>                :<span class="lineCov">          1 :   QCOMPARE( c19.numGeometries(), 2 );</span></a>
<a name="15781"><span class="lineNum">   15781 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c19.geometryN( 0 ) ), part );</span></a>
<a name="15782"><span class="lineNum">   15782 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( c19.geometryN( 1 ) ), part2 );</span></a>
<a name="15783"><span class="lineNum">   15783 </span>                :            : </a>
<a name="15784"><span class="lineNum">   15784 </span>                :            :   //bad WKT</a>
<a name="15785"><span class="lineNum">   15785 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c20;</span></a>
<a name="15786"><span class="lineNum">   15786 </span>                :<span class="lineCov">          1 :   QVERIFY( !c20.fromWkt( &quot;Point()&quot; ) );</span></a>
<a name="15787"><span class="lineNum">   15787 </span>                :<span class="lineCov">          1 :   QVERIFY( c20.isEmpty() );</span></a>
<a name="15788"><span class="lineNum">   15788 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.numGeometries(), 0 );</span></a>
<a name="15789"><span class="lineNum">   15789 </span>                :<span class="lineCov">          1 :   QCOMPARE( c20.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="15790"><span class="lineNum">   15790 </span>                :            : </a>
<a name="15791"><span class="lineNum">   15791 </span>                :            :   //as JSON</a>
<a name="15792"><span class="lineNum">   15792 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection exportC;</span></a>
<a name="15793"><span class="lineNum">   15793 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 )</span></a>
<a name="15794"><span class="lineNum">   15794 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 10 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 10 )</span></a>
<a name="15795"><span class="lineNum">   15795 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10, 0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 0, 0 ) );</span></a>
<a name="15796"><span class="lineNum">   15796 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="15797"><span class="lineNum">   15797 </span>                :            : </a>
<a name="15798"><span class="lineNum">   15798 </span>                :            :   // GML document for compare</a>
<a name="15799"><span class="lineNum">   15799 </span>                :<span class="lineCov">          1 :   QDomDocument doc( &quot;gml&quot; );</span></a>
<a name="15800"><span class="lineNum">   15800 </span>                :            : </a>
<a name="15801"><span class="lineNum">   15801 </span>                :            : </a>
<a name="15802"><span class="lineNum">   15802 </span>                :            :   // as GML2</a>
<a name="15803"><span class="lineNum">   15803 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML2( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0,10 10,10 10,0 0,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15804"><span class="lineNum">   15804 </span>                :<span class="lineCov">          1 :   QString res = elemToString( exportC.asGml2( doc ) );</span></a>
<a name="15805"><span class="lineNum">   15805 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedSimpleGML2 );</span></a>
<a name="15806"><span class="lineNum">   15806 </span>                :<span class="lineCov">          2 :   QString expectedGML2empty( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="15807"><span class="lineNum">   15807 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsGeometryCollection().asGml2( doc ) ), expectedGML2empty );</span></a>
<a name="15808"><span class="lineNum">   15808 </span>                :            : </a>
<a name="15809"><span class="lineNum">   15809 </span>                :            :   //as GML3</a>
<a name="15810"><span class="lineNum">   15810 </span>                :<span class="lineCov">          2 :   QString expectedSimpleGML3( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0 0 0 10 10 10 10 0 0 0&lt;/posList&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15811"><span class="lineNum">   15811 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="15812"><span class="lineNum">   15812 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleGML3 );</span></a>
<a name="15813"><span class="lineNum">   15813 </span>                :<span class="lineCov">          2 :   QString expectedGML3empty( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;/&gt;&quot; ) );</span></a>
<a name="15814"><span class="lineNum">   15814 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( elemToString( QgsGeometryCollection().asGml3( doc ) ), expectedGML3empty );</span></a>
<a name="15815"><span class="lineNum">   15815 </span>                :            : </a>
<a name="15816"><span class="lineNum">   15816 </span>                :            :   // as JSON</a>
<a name="15817"><span class="lineNum">   15817 </span>                :<span class="lineCov">          1 :   QString expectedSimpleJson( &quot;{\&quot;geometries\&quot;:[{\&quot;coordinates\&quot;:[[0.0,0.0],[0.0,10.0],[10.0,10.0],[10.0,0.0],[0.0,0.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}],\&quot;type\&quot;:\&quot;GeometryCollection\&quot;}&quot; );</span></a>
<a name="15818"><span class="lineNum">   15818 </span>                :<span class="lineCov">          1 :   res = exportC.asJson();</span></a>
<a name="15819"><span class="lineNum">   15819 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedSimpleJson );</span></a>
<a name="15820"><span class="lineNum">   15820 </span>                :            : </a>
<a name="15821"><span class="lineNum">   15821 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 )</span></a>
<a name="15822"><span class="lineNum">   15822 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 9 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 9 )</span></a>
<a name="15823"><span class="lineNum">   15823 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 9, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 1, 1 ) );</span></a>
<a name="15824"><span class="lineNum">   15824 </span>                :<span class="lineCov">          1 :   exportC.addGeometry( part.clone() );</span></a>
<a name="15825"><span class="lineNum">   15825 </span>                :            : </a>
<a name="15826"><span class="lineNum">   15826 </span>                :<span class="lineCov">          1 :   QString expectedJson( &quot;{\&quot;geometries\&quot;:[{\&quot;coordinates\&quot;:[[0.0,0.0],[0.0,10.0],[10.0,10.0],[10.0,0.0],[0.0,0.0]],\&quot;type\&quot;:\&quot;LineString\&quot;},{\&quot;coordinates\&quot;:[[1.0,1.0],[1.0,9.0],[9.0,9.0],[9.0,1.0],[1.0,1.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}],\&quot;type\&quot;:\&quot;GeometryCollection\&quot;}&quot; );</span></a>
<a name="15827"><span class="lineNum">   15827 </span>                :<span class="lineCov">          1 :   res = exportC.asJson();</span></a>
<a name="15828"><span class="lineNum">   15828 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJson );</span></a>
<a name="15829"><span class="lineNum">   15829 </span>                :            : </a>
<a name="15830"><span class="lineNum">   15830 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection exportFloat;</span></a>
<a name="15831"><span class="lineNum">   15831 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 10 / 9.0 )</span></a>
<a name="15832"><span class="lineNum">   15832 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 100 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 100 / 9.0, 100 / 9.0 )</span></a>
<a name="15833"><span class="lineNum">   15833 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 100 / 9.0, 10 / 9.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 10 / 9.0, 10 / 9.0 ) );</span></a>
<a name="15834"><span class="lineNum">   15834 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="15835"><span class="lineNum">   15835 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 2 / 3.0 )</span></a>
<a name="15836"><span class="lineNum">   15836 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 4 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 4 / 3.0, 4 / 3.0 )</span></a>
<a name="15837"><span class="lineNum">   15837 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::Point, 4 / 3.0, 2 / 3.0 ) &lt;&lt; QgsPoint( QgsWkbTypes::Point, 2 / 3.0, 2 / 3.0 ) );</span></a>
<a name="15838"><span class="lineNum">   15838 </span>                :<span class="lineCov">          1 :   exportFloat.addGeometry( part.clone() );</span></a>
<a name="15839"><span class="lineNum">   15839 </span>                :            : </a>
<a name="15840"><span class="lineNum">   15840 </span>                :<span class="lineCov">          1 :   QString expectedJsonPrec3( &quot;{\&quot;geometries\&quot;:[{\&quot;coordinates\&quot;:[[1.111,1.111],[1.111,11.111],[11.111,11.111],[11.111,1.111],[1.111,1.111]],\&quot;type\&quot;:\&quot;LineString\&quot;},{\&quot;coordinates\&quot;:[[0.667,0.667],[0.667,1.333],[1.333,1.333],[1.333,0.667],[0.667,0.667]],\&quot;type\&quot;:\&quot;LineString\&quot;}],\&quot;type\&quot;:\&quot;GeometryCollection\&quot;}&quot; );</span></a>
<a name="15841"><span class="lineNum">   15841 </span>                :<span class="lineCov">          1 :   res = exportFloat.asJson( 3 );</span></a>
<a name="15842"><span class="lineNum">   15842 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedJsonPrec3 );</span></a>
<a name="15843"><span class="lineNum">   15843 </span>                :            : </a>
<a name="15844"><span class="lineNum">   15844 </span>                :            :   // as GML2</a>
<a name="15845"><span class="lineNum">   15845 </span>                :<span class="lineCov">          2 :   QString expectedGML2( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0,0 0,10 10,10 10,0 0,0&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1,1 1,9 9,9 9,1 1,1&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15846"><span class="lineNum">   15846 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml2( doc ) );</span></a>
<a name="15847"><span class="lineNum">   15847 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2 );</span></a>
<a name="15848"><span class="lineNum">   15848 </span>                :<span class="lineCov">          2 :   QString expectedGML2prec3( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;1.111,1.111 1.111,11.111 11.111,11.111 11.111,1.111 1.111,1.111&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;coordinates xmlns=\&quot;gml\&quot; cs=\&quot;,\&quot; ts=\&quot; \&quot;&gt;0.667,0.667 0.667,1.333 1.333,1.333 1.333,0.667 0.667,0.667&lt;/coordinates&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15849"><span class="lineNum">   15849 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml2( doc, 3 ) );</span></a>
<a name="15850"><span class="lineNum">   15850 </span>                :<span class="lineCov">          3 :   QGSCOMPAREGML( res, expectedGML2prec3 );</span></a>
<a name="15851"><span class="lineNum">   15851 </span>                :            : </a>
<a name="15852"><span class="lineNum">   15852 </span>                :            :   //as GML3</a>
<a name="15853"><span class="lineNum">   15853 </span>                :<span class="lineCov">          2 :   QString expectedGML3( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0 0 0 10 10 10 10 0 0 0&lt;/posList&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1 1 1 9 9 9 9 1 1 1&lt;/posList&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15854"><span class="lineNum">   15854 </span>                :<span class="lineCov">          1 :   res = elemToString( exportC.asGml3( doc ) );</span></a>
<a name="15855"><span class="lineNum">   15855 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3 );</span></a>
<a name="15856"><span class="lineNum">   15856 </span>                :<span class="lineCov">          2 :   QString expectedGML3prec3( QStringLiteral( &quot;&lt;MultiGeometry xmlns=\&quot;gml\&quot;&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;1.111 1.111 1.111 11.111 11.111 11.111 11.111 1.111 1.111 1.111&lt;/posList&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;geometryMember xmlns=\&quot;gml\&quot;&gt;&lt;LineString xmlns=\&quot;gml\&quot;&gt;&lt;posList xmlns=\&quot;gml\&quot; srsDimension=\&quot;2\&quot;&gt;0.667 0.667 0.667 1.333 1.333 1.333 1.333 0.667 0.667 0.667&lt;/posList&gt;&lt;/LineString&gt;&lt;/geometryMember&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15857"><span class="lineNum">   15857 </span>                :<span class="lineCov">          1 :   res = elemToString( exportFloat.asGml3( doc, 3 ) );</span></a>
<a name="15858"><span class="lineNum">   15858 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, expectedGML3prec3 );</span></a>
<a name="15859"><span class="lineNum">   15859 </span>                :            : </a>
<a name="15860"><span class="lineNum">   15860 </span>                :            :   //asKML</a>
<a name="15861"><span class="lineNum">   15861 </span>                :<span class="lineCov">          2 :   QString expectedKml( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0,0,0 0,10,0 10,10,0 10,0,0 0,0,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;1,1,0 1,9,0 9,9,0 9,1,0 1,1,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15862"><span class="lineNum">   15862 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportC.asKml(), expectedKml );</span></a>
<a name="15863"><span class="lineNum">   15863 </span>                :<span class="lineCov">          2 :   QString expectedKmlPrec3( QStringLiteral( &quot;&lt;MultiGeometry&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;1.111,1.111,0 1.111,11.111,0 11.111,11.111,0 11.111,1.111,0 1.111,1.111,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;LinearRing&gt;&lt;altitudeMode&gt;clampToGround&lt;/altitudeMode&gt;&lt;coordinates&gt;0.667,0.667,0 0.667,1.333,0 1.333,1.333,0 1.333,0.667,0 0.667,0.667,0&lt;/coordinates&gt;&lt;/LinearRing&gt;&lt;/MultiGeometry&gt;&quot; ) );</span></a>
<a name="15864"><span class="lineNum">   15864 </span>                :<span class="lineCov">          1 :   QCOMPARE( exportFloat.asKml( 3 ), expectedKmlPrec3 );</span></a>
<a name="15865"><span class="lineNum">   15865 </span>                :            : </a>
<a name="15866"><span class="lineNum">   15866 </span>                :            : </a>
<a name="15867"><span class="lineNum">   15867 </span>                :            :   // remove geometry</a>
<a name="15868"><span class="lineNum">   15868 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection rc;</span></a>
<a name="15869"><span class="lineNum">   15869 </span>                :            :   // no crash!</a>
<a name="15870"><span class="lineNum">   15870 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( -1 );</span></a>
<a name="15871"><span class="lineNum">   15871 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 0 );</span></a>
<a name="15872"><span class="lineNum">   15872 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 100 );</span></a>
<a name="15873"><span class="lineNum">   15873 </span>                :<span class="lineCov">          2 :   part.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 5 )</span></a>
<a name="15874"><span class="lineNum">   15874 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 10, 2, 6 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 10, 3, 7 )</span></a>
<a name="15875"><span class="lineNum">   15875 </span>                :<span class="lineCov">          1 :                   &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 0, 4, 8 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 0, 0, 1, 9 ) );</span></a>
<a name="15876"><span class="lineNum">   15876 </span>                :<span class="lineCov">          1 :   rc.addGeometry( part.clone() );</span></a>
<a name="15877"><span class="lineNum">   15877 </span>                :<span class="lineCov">          2 :   part2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 2 )</span></a>
<a name="15878"><span class="lineNum">   15878 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 9, 2, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 9, 3, 6 )</span></a>
<a name="15879"><span class="lineNum">   15879 </span>                :<span class="lineCov">          1 :                    &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 9, 1, 4, 4 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 1, 1, 7 ) );</span></a>
<a name="15880"><span class="lineNum">   15880 </span>                :<span class="lineCov">          1 :   rc.addGeometry( part2.clone() );</span></a>
<a name="15881"><span class="lineNum">   15881 </span>                :            :   // no crash</a>
<a name="15882"><span class="lineNum">   15882 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( -1 );</span></a>
<a name="15883"><span class="lineNum">   15883 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 100 );</span></a>
<a name="15884"><span class="lineNum">   15884 </span>                :            : </a>
<a name="15885"><span class="lineNum">   15885 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 0 );</span></a>
<a name="15886"><span class="lineNum">   15886 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="15887"><span class="lineNum">   15887 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part2 );</span></a>
<a name="15888"><span class="lineNum">   15888 </span>                :            : </a>
<a name="15889"><span class="lineNum">   15889 </span>                :<span class="lineCov">          1 :   rc.addGeometry( part.clone() );</span></a>
<a name="15890"><span class="lineNum">   15890 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 1 );</span></a>
<a name="15891"><span class="lineNum">   15891 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="15892"><span class="lineNum">   15892 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part2 );</span></a>
<a name="15893"><span class="lineNum">   15893 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 0 );</span></a>
<a name="15894"><span class="lineNum">   15894 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15895"><span class="lineNum">   15895 </span>                :            : </a>
<a name="15896"><span class="lineNum">   15896 </span>                :            : </a>
<a name="15897"><span class="lineNum">   15897 </span>                :            :   // insert geometry</a>
<a name="15898"><span class="lineNum">   15898 </span>                :<span class="lineCov">          1 :   rc.clear();</span></a>
<a name="15899"><span class="lineNum">   15899 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 0 );</span></a>
<a name="15900"><span class="lineNum">   15900 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15901"><span class="lineNum">   15901 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15902"><span class="lineNum">   15902 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, -1 );</span></a>
<a name="15903"><span class="lineNum">   15903 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15904"><span class="lineNum">   15904 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15905"><span class="lineNum">   15905 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( nullptr, 100 );</span></a>
<a name="15906"><span class="lineNum">   15906 </span>                :<span class="lineCov">          1 :   QVERIFY( rc.isEmpty() );</span></a>
<a name="15907"><span class="lineNum">   15907 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 0 );</span></a>
<a name="15908"><span class="lineNum">   15908 </span>                :            : </a>
<a name="15909"><span class="lineNum">   15909 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part.clone(), 0 );</span></a>
<a name="15910"><span class="lineNum">   15910 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 1 );</span></a>
<a name="15911"><span class="lineNum">   15911 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part );</span></a>
<a name="15912"><span class="lineNum">   15912 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part2.clone(), 0 );</span></a>
<a name="15913"><span class="lineNum">   15913 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 2 );</span></a>
<a name="15914"><span class="lineNum">   15914 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part2 );</span></a>
<a name="15915"><span class="lineNum">   15915 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 1 ) ), part );</span></a>
<a name="15916"><span class="lineNum">   15916 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 0 );</span></a>
<a name="15917"><span class="lineNum">   15917 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part2.clone(), 1 );</span></a>
<a name="15918"><span class="lineNum">   15918 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 2 );</span></a>
<a name="15919"><span class="lineNum">   15919 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part );</span></a>
<a name="15920"><span class="lineNum">   15920 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 1 ) ), part2 );</span></a>
<a name="15921"><span class="lineNum">   15921 </span>                :<span class="lineCov">          1 :   rc.removeGeometry( 1 );</span></a>
<a name="15922"><span class="lineNum">   15922 </span>                :<span class="lineCov">          1 :   rc.insertGeometry( part2.clone(), 2 );</span></a>
<a name="15923"><span class="lineNum">   15923 </span>                :<span class="lineCov">          1 :   QCOMPARE( rc.numGeometries(), 2 );</span></a>
<a name="15924"><span class="lineNum">   15924 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 0 ) ), part );</span></a>
<a name="15925"><span class="lineNum">   15925 </span>                :<span class="lineCov">          1 :   QCOMPARE( *static_cast&lt; const QgsLineString * &gt;( rc.geometryN( 1 ) ), part2 );</span></a>
<a name="15926"><span class="lineNum">   15926 </span>                :            : </a>
<a name="15927"><span class="lineNum">   15927 </span>                :            :   // cast</a>
<a name="15928"><span class="lineNum">   15928 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometryCollection().cast( nullptr ) );</span></a>
<a name="15929"><span class="lineNum">   15929 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection pCast;</span></a>
<a name="15930"><span class="lineNum">   15930 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometryCollection().cast( &amp;pCast ) );</span></a>
<a name="15931"><span class="lineNum">   15931 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection pCast2;</span></a>
<a name="15932"><span class="lineNum">   15932 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;GeometryCollectionZ(PolygonZ((0 0 0, 0 1 1, 1 0 2, 0 0 0)))&quot; ) );</span></a>
<a name="15933"><span class="lineNum">   15933 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometryCollection().cast( &amp;pCast2 ) );</span></a>
<a name="15934"><span class="lineNum">   15934 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;GeometryCollectionM(PolygonM((0 0 1, 0 1 2, 1 0 3, 0 0 1)))&quot; ) );</span></a>
<a name="15935"><span class="lineNum">   15935 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometryCollection().cast( &amp;pCast2 ) );</span></a>
<a name="15936"><span class="lineNum">   15936 </span>                :<span class="lineCov">          2 :   pCast2.fromWkt( QStringLiteral( &quot;GeometryCollectionZM(PolygonZM((0 0 0 1, 0 1 1 2, 1 0 2 3, 0 0 0 1)))&quot; ) );</span></a>
<a name="15937"><span class="lineNum">   15937 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometryCollection().cast( &amp;pCast2 ) );</span></a>
<a name="15938"><span class="lineNum">   15938 </span>                :            : </a>
<a name="15939"><span class="lineNum">   15939 </span>                :            :   //transform</a>
<a name="15940"><span class="lineNum">   15940 </span>                :            :   //CRS transform</a>
<a name="15941"><span class="lineNum">   15941 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem sourceSrs( QStringLiteral( &quot;EPSG:3994&quot; ) );</span></a>
<a name="15942"><span class="lineNum">   15942 </span>                :<span class="lineCov">          2 :   QgsCoordinateReferenceSystem destSrs( QStringLiteral( &quot;EPSG:4202&quot; ) ); // want a transform with ellipsoid change</span></a>
<a name="15943"><span class="lineNum">   15943 </span>                :<span class="lineCov">          1 :   QgsCoordinateTransform tr( sourceSrs, destSrs, QgsProject::instance() );</span></a>
<a name="15944"><span class="lineNum">   15944 </span>                :            : </a>
<a name="15945"><span class="lineNum">   15945 </span>                :            :   // 2d CRS transform</a>
<a name="15946"><span class="lineNum">   15946 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection pTransform;</span></a>
<a name="15947"><span class="lineNum">   15947 </span>                :<span class="lineCov">          1 :   QgsLineString l21;</span></a>
<a name="15948"><span class="lineNum">   15948 </span>                :<span class="lineCov">          2 :   l21.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6374985, -3626584 )</span></a>
<a name="15949"><span class="lineNum">   15949 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6274985, -3526584 )</span></a>
<a name="15950"><span class="lineNum">   15950 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6474985, -3526584 )</span></a>
<a name="15951"><span class="lineNum">   15951 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 6374985, -3626584 ) );</span></a>
<a name="15952"><span class="lineNum">   15952 </span>                :<span class="lineCov">          1 :   pTransform.addGeometry( l21.clone() );</span></a>
<a name="15953"><span class="lineNum">   15953 </span>                :<span class="lineCov">          1 :   pTransform.addGeometry( l21.clone() );</span></a>
<a name="15954"><span class="lineNum">   15954 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="15955"><span class="lineNum">   15955 </span>                :<span class="lineCov">          1 :   const QgsLineString *extR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 0 ) );</span></a>
<a name="15956"><span class="lineNum">   15956 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="15957"><span class="lineNum">   15957 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="15958"><span class="lineNum">   15958 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="15959"><span class="lineNum">   15959 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="15960"><span class="lineNum">   15960 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="15961"><span class="lineNum">   15961 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="15962"><span class="lineNum">   15962 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="15963"><span class="lineNum">   15963 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="15964"><span class="lineNum">   15964 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="15965"><span class="lineNum">   15965 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="15966"><span class="lineNum">   15966 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="15967"><span class="lineNum">   15967 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="15968"><span class="lineNum">   15968 </span>                :<span class="lineCov">          1 :   const QgsLineString *intR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 1 ) );</span></a>
<a name="15969"><span class="lineNum">   15969 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="15970"><span class="lineNum">   15970 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="15971"><span class="lineNum">   15971 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="15972"><span class="lineNum">   15972 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="15973"><span class="lineNum">   15973 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="15974"><span class="lineNum">   15974 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="15975"><span class="lineNum">   15975 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="15976"><span class="lineNum">   15976 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="15977"><span class="lineNum">   15977 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="15978"><span class="lineNum">   15978 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="15979"><span class="lineNum">   15979 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="15980"><span class="lineNum">   15980 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="15981"><span class="lineNum">   15981 </span>                :            : </a>
<a name="15982"><span class="lineNum">   15982 </span>                :            :   //3d CRS transform</a>
<a name="15983"><span class="lineNum">   15983 </span>                :<span class="lineCov">          1 :   QgsLineString l22;</span></a>
<a name="15984"><span class="lineNum">   15984 </span>                :<span class="lineCov">          2 :   l22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 )</span></a>
<a name="15985"><span class="lineNum">   15985 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6274985, -3526584, 3, 4 )</span></a>
<a name="15986"><span class="lineNum">   15986 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6474985, -3526584, 5, 6 )</span></a>
<a name="15987"><span class="lineNum">   15987 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 6374985, -3626584, 1, 2 ) );</span></a>
<a name="15988"><span class="lineNum">   15988 </span>                :<span class="lineCov">          1 :   pTransform.clear();</span></a>
<a name="15989"><span class="lineNum">   15989 </span>                :<span class="lineCov">          1 :   pTransform.addGeometry( l22.clone() );</span></a>
<a name="15990"><span class="lineNum">   15990 </span>                :<span class="lineCov">          1 :   pTransform.addGeometry( l22.clone() );</span></a>
<a name="15991"><span class="lineNum">   15991 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform );</span></a>
<a name="15992"><span class="lineNum">   15992 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 0 ) );</span></a>
<a name="15993"><span class="lineNum">   15993 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="15994"><span class="lineNum">   15994 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="15995"><span class="lineNum">   15995 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="15996"><span class="lineNum">   15996 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="15997"><span class="lineNum">   15997 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="15998"><span class="lineNum">   15998 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="15999"><span class="lineNum">   15999 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="16000"><span class="lineNum">   16000 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="16001"><span class="lineNum">   16001 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="16002"><span class="lineNum">   16002 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="16003"><span class="lineNum">   16003 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="16004"><span class="lineNum">   16004 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="16005"><span class="lineNum">   16005 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="16006"><span class="lineNum">   16006 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="16007"><span class="lineNum">   16007 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="16008"><span class="lineNum">   16008 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="16009"><span class="lineNum">   16009 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="16010"><span class="lineNum">   16010 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="16011"><span class="lineNum">   16011 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="16012"><span class="lineNum">   16012 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="16013"><span class="lineNum">   16013 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 1 ) );</span></a>
<a name="16014"><span class="lineNum">   16014 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 175.771, 0.001 );</span></a>
<a name="16015"><span class="lineNum">   16015 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -39.724, 0.001 );</span></a>
<a name="16016"><span class="lineNum">   16016 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="16017"><span class="lineNum">   16017 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="16018"><span class="lineNum">   16018 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(),  174.581448, 0.001 );</span></a>
<a name="16019"><span class="lineNum">   16019 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -38.7999, 0.001 );</span></a>
<a name="16020"><span class="lineNum">   16020 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="16021"><span class="lineNum">   16021 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="16022"><span class="lineNum">   16022 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  176.958633, 0.001 );</span></a>
<a name="16023"><span class="lineNum">   16023 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -38.7999, 0.001 );</span></a>
<a name="16024"><span class="lineNum">   16024 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="16025"><span class="lineNum">   16025 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="16026"><span class="lineNum">   16026 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  175.771, 0.001 );</span></a>
<a name="16027"><span class="lineNum">   16027 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -39.724, 0.001 );</span></a>
<a name="16028"><span class="lineNum">   16028 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="16029"><span class="lineNum">   16029 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="16030"><span class="lineNum">   16030 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 174.581448, 0.001 );</span></a>
<a name="16031"><span class="lineNum">   16031 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), -39.724, 0.001 );</span></a>
<a name="16032"><span class="lineNum">   16032 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 176.959, 0.001 );</span></a>
<a name="16033"><span class="lineNum">   16033 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), -38.7999, 0.001 );</span></a>
<a name="16034"><span class="lineNum">   16034 </span>                :            : </a>
<a name="16035"><span class="lineNum">   16035 </span>                :            :   //reverse transform</a>
<a name="16036"><span class="lineNum">   16036 </span>                :<span class="lineCov">          1 :   pTransform.transform( tr, QgsCoordinateTransform::ReverseTransform );</span></a>
<a name="16037"><span class="lineNum">   16037 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 0 ) );</span></a>
<a name="16038"><span class="lineNum">   16038 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 6374984, 100 );</span></a>
<a name="16039"><span class="lineNum">   16039 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), -3626584, 100 );</span></a>
<a name="16040"><span class="lineNum">   16040 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="16041"><span class="lineNum">   16041 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="16042"><span class="lineNum">   16042 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(), 6274984, 100 );</span></a>
<a name="16043"><span class="lineNum">   16043 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), -3526584, 100 );</span></a>
<a name="16044"><span class="lineNum">   16044 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="16045"><span class="lineNum">   16045 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="16046"><span class="lineNum">   16046 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  6474984, 100 );</span></a>
<a name="16047"><span class="lineNum">   16047 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), -3526584, 100 );</span></a>
<a name="16048"><span class="lineNum">   16048 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="16049"><span class="lineNum">   16049 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="16050"><span class="lineNum">   16050 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(),  6374984, 100 );</span></a>
<a name="16051"><span class="lineNum">   16051 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), -3626584, 100 );</span></a>
<a name="16052"><span class="lineNum">   16052 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="16053"><span class="lineNum">   16053 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="16054"><span class="lineNum">   16054 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMinimum(), 6274984, 100 );</span></a>
<a name="16055"><span class="lineNum">   16055 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMinimum(), -3626584, 100 );</span></a>
<a name="16056"><span class="lineNum">   16056 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMaximum(), 6474984, 100 );</span></a>
<a name="16057"><span class="lineNum">   16057 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMaximum(), -3526584, 100 );</span></a>
<a name="16058"><span class="lineNum">   16058 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 1 ) );</span></a>
<a name="16059"><span class="lineNum">   16059 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 6374984, 100 );</span></a>
<a name="16060"><span class="lineNum">   16060 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), -3626584, 100 );</span></a>
<a name="16061"><span class="lineNum">   16061 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1.0, 0.001 );</span></a>
<a name="16062"><span class="lineNum">   16062 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 2.0, 0.001 );</span></a>
<a name="16063"><span class="lineNum">   16063 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(), 6274984, 100 );</span></a>
<a name="16064"><span class="lineNum">   16064 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), -3526584, 100 );</span></a>
<a name="16065"><span class="lineNum">   16065 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3.0, 0.001 );</span></a>
<a name="16066"><span class="lineNum">   16066 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 4.0, 0.001 );</span></a>
<a name="16067"><span class="lineNum">   16067 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  6474984, 100 );</span></a>
<a name="16068"><span class="lineNum">   16068 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), -3526584, 100 );</span></a>
<a name="16069"><span class="lineNum">   16069 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5.0, 0.001 );</span></a>
<a name="16070"><span class="lineNum">   16070 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 6.0, 0.001 );</span></a>
<a name="16071"><span class="lineNum">   16071 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(),  6374984, 100 );</span></a>
<a name="16072"><span class="lineNum">   16072 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), -3626584, 100 );</span></a>
<a name="16073"><span class="lineNum">   16073 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1.0, 0.001 );</span></a>
<a name="16074"><span class="lineNum">   16074 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 2.0, 0.001 );</span></a>
<a name="16075"><span class="lineNum">   16075 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 6274984, 100 );</span></a>
<a name="16076"><span class="lineNum">   16076 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), -3626584, 100 );</span></a>
<a name="16077"><span class="lineNum">   16077 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 6474984, 100 );</span></a>
<a name="16078"><span class="lineNum">   16078 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), -3526584, 100 );</span></a>
<a name="16079"><span class="lineNum">   16079 </span>                :            : </a>
<a name="16080"><span class="lineNum">   16080 </span>                :            : #if PROJ_VERSION_MAJOR&lt;6 // note - z value transform doesn't currently work with proj 6+, because we don't yet support compound CRS definitions</a>
<a name="16081"><span class="lineNum">   16081 </span>                :            :   //z value transform</a>
<a name="16082"><span class="lineNum">   16082 </span>                :            :   pTransform.transform( tr, QgsCoordinateTransform::ForwardTransform, true );</a>
<a name="16083"><span class="lineNum">   16083 </span>                :            :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 0 ) );</a>
<a name="16084"><span class="lineNum">   16084 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="16085"><span class="lineNum">   16085 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), -19.148357, 0.001 );</a>
<a name="16086"><span class="lineNum">   16086 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), -19.092128, 0.001 );</a>
<a name="16087"><span class="lineNum">   16087 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), -19.249066, 0.001 );</a>
<a name="16088"><span class="lineNum">   16088 </span>                :            :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 1 ) );</a>
<a name="16089"><span class="lineNum">   16089 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), -19.249066, 0.001 );</a>
<a name="16090"><span class="lineNum">   16090 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), -19.148357, 0.001 );</a>
<a name="16091"><span class="lineNum">   16091 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), -19.092128, 0.001 );</a>
<a name="16092"><span class="lineNum">   16092 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), -19.249066, 0.001 );</a>
<a name="16093"><span class="lineNum">   16093 </span>                :            :   pTransform.transform( tr, QgsCoordinateTransform::ReverseTransform, true );</a>
<a name="16094"><span class="lineNum">   16094 </span>                :            :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 0 ) );</a>
<a name="16095"><span class="lineNum">   16095 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 1, 0.001 );</a>
<a name="16096"><span class="lineNum">   16096 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 3, 0.001 );</a>
<a name="16097"><span class="lineNum">   16097 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 5, 0.001 );</a>
<a name="16098"><span class="lineNum">   16098 </span>                :            :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 1, 0.001 );</a>
<a name="16099"><span class="lineNum">   16099 </span>                :            :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform.geometryN( 1 ) );</a>
<a name="16100"><span class="lineNum">   16100 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 1, 0.001 );</a>
<a name="16101"><span class="lineNum">   16101 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 3, 0.001 );</a>
<a name="16102"><span class="lineNum">   16102 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 5, 0.001 );</a>
<a name="16103"><span class="lineNum">   16103 </span>                :            :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 1, 0.001 );</a>
<a name="16104"><span class="lineNum">   16104 </span>                :            : #endif</a>
<a name="16105"><span class="lineNum">   16105 </span>                :            : </a>
<a name="16106"><span class="lineNum">   16106 </span>                :            :   //QTransform transform</a>
<a name="16107"><span class="lineNum">   16107 </span>                :<span class="lineCov">          1 :   QTransform qtr = QTransform::fromScale( 2, 3 );</span></a>
<a name="16108"><span class="lineNum">   16108 </span>                :<span class="lineCov">          1 :   QgsLineString l23;</span></a>
<a name="16109"><span class="lineNum">   16109 </span>                :<span class="lineCov">          2 :   l23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 )</span></a>
<a name="16110"><span class="lineNum">   16110 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 11, 12, 13, 14 )</span></a>
<a name="16111"><span class="lineNum">   16111 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 12, 23, 24 )</span></a>
<a name="16112"><span class="lineNum">   16112 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 1, 2, 3, 4 ) );</span></a>
<a name="16113"><span class="lineNum">   16113 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection pTransform2;</span></a>
<a name="16114"><span class="lineNum">   16114 </span>                :<span class="lineCov">          1 :   pTransform2.addGeometry( l23.clone() );</span></a>
<a name="16115"><span class="lineNum">   16115 </span>                :<span class="lineCov">          1 :   pTransform2.addGeometry( l23.clone() );</span></a>
<a name="16116"><span class="lineNum">   16116 </span>                :<span class="lineCov">          1 :   pTransform2.transform( qtr, 3, 2, 6, 3 );</span></a>
<a name="16117"><span class="lineNum">   16117 </span>                :            : </a>
<a name="16118"><span class="lineNum">   16118 </span>                :<span class="lineCov">          1 :   extR = static_cast&lt; const QgsLineString * &gt;( pTransform2.geometryN( 0 ) );</span></a>
<a name="16119"><span class="lineNum">   16119 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).x(), 2, 100 );</span></a>
<a name="16120"><span class="lineNum">   16120 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).y(), 6, 100 );</span></a>
<a name="16121"><span class="lineNum">   16121 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).z(), 9.0, 0.001 );</span></a>
<a name="16122"><span class="lineNum">   16122 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 0 ).m(), 18.0, 0.001 );</span></a>
<a name="16123"><span class="lineNum">   16123 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).x(), 22, 100 );</span></a>
<a name="16124"><span class="lineNum">   16124 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).y(), 36, 100 );</span></a>
<a name="16125"><span class="lineNum">   16125 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).z(), 29.0, 0.001 );</span></a>
<a name="16126"><span class="lineNum">   16126 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 1 ).m(), 48.0, 0.001 );</span></a>
<a name="16127"><span class="lineNum">   16127 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).x(),  2, 100 );</span></a>
<a name="16128"><span class="lineNum">   16128 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).y(), 36, 100 );</span></a>
<a name="16129"><span class="lineNum">   16129 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).z(), 49.0, 0.001 );</span></a>
<a name="16130"><span class="lineNum">   16130 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 2 ).m(), 78.0, 0.001 );</span></a>
<a name="16131"><span class="lineNum">   16131 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).x(), 2, 100 );</span></a>
<a name="16132"><span class="lineNum">   16132 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).y(), 6, 100 );</span></a>
<a name="16133"><span class="lineNum">   16133 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).z(), 9.0, 0.001 );</span></a>
<a name="16134"><span class="lineNum">   16134 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;pointN( 3 ).m(), 18.0, 0.001 );</span></a>
<a name="16135"><span class="lineNum">   16135 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMinimum(), 2, 0.001 );</span></a>
<a name="16136"><span class="lineNum">   16136 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMinimum(), 6, 0.001 );</span></a>
<a name="16137"><span class="lineNum">   16137 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().xMaximum(), 22, 0.001 );</span></a>
<a name="16138"><span class="lineNum">   16138 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( extR-&gt;boundingBox().yMaximum(), 36, 0.001 );</span></a>
<a name="16139"><span class="lineNum">   16139 </span>                :<span class="lineCov">          1 :   intR = static_cast&lt; const QgsLineString * &gt;( pTransform2.geometryN( 1 ) );</span></a>
<a name="16140"><span class="lineNum">   16140 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).x(), 2, 100 );</span></a>
<a name="16141"><span class="lineNum">   16141 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).y(), 6, 100 );</span></a>
<a name="16142"><span class="lineNum">   16142 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).z(), 9.0, 0.001 );</span></a>
<a name="16143"><span class="lineNum">   16143 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 0 ).m(), 18.0, 0.001 );</span></a>
<a name="16144"><span class="lineNum">   16144 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).x(), 22, 100 );</span></a>
<a name="16145"><span class="lineNum">   16145 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).y(), 36, 100 );</span></a>
<a name="16146"><span class="lineNum">   16146 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).z(), 29.0, 0.001 );</span></a>
<a name="16147"><span class="lineNum">   16147 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 1 ).m(), 48.0, 0.001 );</span></a>
<a name="16148"><span class="lineNum">   16148 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).x(),  2, 100 );</span></a>
<a name="16149"><span class="lineNum">   16149 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).y(), 36, 100 );</span></a>
<a name="16150"><span class="lineNum">   16150 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).z(), 49.0, 0.001 );</span></a>
<a name="16151"><span class="lineNum">   16151 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 2 ).m(), 78.0, 0.001 );</span></a>
<a name="16152"><span class="lineNum">   16152 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).x(), 2, 100 );</span></a>
<a name="16153"><span class="lineNum">   16153 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).y(), 6, 100 );</span></a>
<a name="16154"><span class="lineNum">   16154 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).z(), 9.0, 0.001 );</span></a>
<a name="16155"><span class="lineNum">   16155 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;pointN( 3 ).m(), 18.0, 0.001 );</span></a>
<a name="16156"><span class="lineNum">   16156 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMinimum(), 2, 0.001 );</span></a>
<a name="16157"><span class="lineNum">   16157 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMinimum(), 6, 0.001 );</span></a>
<a name="16158"><span class="lineNum">   16158 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().xMaximum(), 22, 0.001 );</span></a>
<a name="16159"><span class="lineNum">   16159 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( intR-&gt;boundingBox().yMaximum(), 36, 0.001 );</span></a>
<a name="16160"><span class="lineNum">   16160 </span>                :            : </a>
<a name="16161"><span class="lineNum">   16161 </span>                :            : </a>
<a name="16162"><span class="lineNum">   16162 </span>                :            :   // closestSegment</a>
<a name="16163"><span class="lineNum">   16163 </span>                :<span class="lineCov">          1 :   QgsPoint pt;</span></a>
<a name="16164"><span class="lineNum">   16164 </span>                :<span class="lineCov">          1 :   QgsVertexId v;</span></a>
<a name="16165"><span class="lineNum">   16165 </span>                :<span class="lineCov">          1 :   int leftOf = 0;</span></a>
<a name="16166"><span class="lineNum">   16166 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection empty;</span></a>
<a name="16167"><span class="lineNum">   16167 </span>                :<span class="lineCov">          1 :   ( void )empty.closestSegment( QgsPoint( 1, 2 ), pt, v ); // empty collection, just want no crash</span></a>
<a name="16168"><span class="lineNum">   16168 </span>                :            : </a>
<a name="16169"><span class="lineNum">   16169 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p21;</span></a>
<a name="16170"><span class="lineNum">   16170 </span>                :<span class="lineCov">          1 :   QgsLineString p21ls;</span></a>
<a name="16171"><span class="lineNum">   16171 </span>                :<span class="lineCov">          1 :   p21ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 5, 10 ) &lt;&lt; QgsPoint( 7, 12 ) &lt;&lt; QgsPoint( 5, 15 ) &lt;&lt; QgsPoint( 5, 10 ) );</span></a>
<a name="16172"><span class="lineNum">   16172 </span>                :<span class="lineCov">          1 :   p21.addGeometry( p21ls.clone() );</span></a>
<a name="16173"><span class="lineNum">   16173 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="16174"><span class="lineNum">   16174 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="16175"><span class="lineNum">   16175 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="16176"><span class="lineNum">   16176 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="16177"><span class="lineNum">   16177 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16178"><span class="lineNum">   16178 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="16179"><span class="lineNum">   16179 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="16180"><span class="lineNum">   16180 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="16181"><span class="lineNum">   16181 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="16182"><span class="lineNum">   16182 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16183"><span class="lineNum">   16183 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 6, 11.5 ), pt, v, &amp;leftOf ), 0.125000, 0.0001 );</span></a>
<a name="16184"><span class="lineNum">   16184 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.25, 0.01 );</span></a>
<a name="16185"><span class="lineNum">   16185 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.25, 0.01 );</span></a>
<a name="16186"><span class="lineNum">   16186 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="16187"><span class="lineNum">   16187 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="16188"><span class="lineNum">   16188 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="16189"><span class="lineNum">   16189 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="16190"><span class="lineNum">   16190 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="16191"><span class="lineNum">   16191 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16192"><span class="lineNum">   16192 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16193"><span class="lineNum">   16193 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="16194"><span class="lineNum">   16194 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="16195"><span class="lineNum">   16195 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="16196"><span class="lineNum">   16196 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16197"><span class="lineNum">   16197 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="16198"><span class="lineNum">   16198 </span>                :            :   // point directly on segment</a>
<a name="16199"><span class="lineNum">   16199 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.closestSegment( QgsPoint( 5, 15 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="16200"><span class="lineNum">   16200 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 5, 15 ) );</span></a>
<a name="16201"><span class="lineNum">   16201 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16202"><span class="lineNum">   16202 </span>                :            :   // with interior ring</a>
<a name="16203"><span class="lineNum">   16203 </span>                :<span class="lineCov">          1 :   p21ls.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 6, 11.5 ) &lt;&lt; QgsPoint( 6.5, 12 ) &lt;&lt; QgsPoint( 6, 13 ) &lt;&lt; QgsPoint( 6, 11.5 ) );</span></a>
<a name="16204"><span class="lineNum">   16204 </span>                :<span class="lineCov">          1 :   p21.addGeometry( p21ls.clone() );</span></a>
<a name="16205"><span class="lineNum">   16205 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 4, 11 ), pt, v, &amp;leftOf ), 1.0, 0.0001 );</span></a>
<a name="16206"><span class="lineNum">   16206 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5, 0.01 );</span></a>
<a name="16207"><span class="lineNum">   16207 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11, 0.01 );</span></a>
<a name="16208"><span class="lineNum">   16208 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="16209"><span class="lineNum">   16209 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16210"><span class="lineNum">   16210 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 8, 11 ), pt, v, &amp;leftOf ),  2.0, 0.0001 );</span></a>
<a name="16211"><span class="lineNum">   16211 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 7, 0.01 );</span></a>
<a name="16212"><span class="lineNum">   16212 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 12, 0.01 );</span></a>
<a name="16213"><span class="lineNum">   16213 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="16214"><span class="lineNum">   16214 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16215"><span class="lineNum">   16215 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 6, 11.4 ), pt, v, &amp;leftOf ), 0.01, 0.0001 );</span></a>
<a name="16216"><span class="lineNum">   16216 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 6.0, 0.01 );</span></a>
<a name="16217"><span class="lineNum">   16217 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 11.5, 0.01 );</span></a>
<a name="16218"><span class="lineNum">   16218 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) );</span></a>
<a name="16219"><span class="lineNum">   16219 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16220"><span class="lineNum">   16220 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 7, 16 ), pt, v, &amp;leftOf ), 4.923077, 0.0001 );</span></a>
<a name="16221"><span class="lineNum">   16221 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.153846, 0.01 );</span></a>
<a name="16222"><span class="lineNum">   16222 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 14.769231, 0.01 );</span></a>
<a name="16223"><span class="lineNum">   16223 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16224"><span class="lineNum">   16224 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 1 );</span></a>
<a name="16225"><span class="lineNum">   16225 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p21.closestSegment( QgsPoint( 5.5, 13.5 ), pt, v, &amp;leftOf ), 0.173077, 0.0001 );</span></a>
<a name="16226"><span class="lineNum">   16226 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.x(), 5.846154, 0.01 );</span></a>
<a name="16227"><span class="lineNum">   16227 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( pt.y(), 13.730769, 0.01 );</span></a>
<a name="16228"><span class="lineNum">   16228 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16229"><span class="lineNum">   16229 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, -1 );</span></a>
<a name="16230"><span class="lineNum">   16230 </span>                :            :   // point directly on segment</a>
<a name="16231"><span class="lineNum">   16231 </span>                :<span class="lineCov">          1 :   QCOMPARE( p21.closestSegment( QgsPoint( 6, 13 ), pt, v, &amp;leftOf ), 0.0 );</span></a>
<a name="16232"><span class="lineNum">   16232 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 6, 13 ) );</span></a>
<a name="16233"><span class="lineNum">   16233 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="16234"><span class="lineNum">   16234 </span>                :<span class="lineCov">          1 :   QCOMPARE( leftOf, 0 );</span></a>
<a name="16235"><span class="lineNum">   16235 </span>                :            : </a>
<a name="16236"><span class="lineNum">   16236 </span>                :            :   //nextVertex</a>
<a name="16237"><span class="lineNum">   16237 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p22;</span></a>
<a name="16238"><span class="lineNum">   16238 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16239"><span class="lineNum">   16239 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -2 );</span></a>
<a name="16240"><span class="lineNum">   16240 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16241"><span class="lineNum">   16241 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 10 );</span></a>
<a name="16242"><span class="lineNum">   16242 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16243"><span class="lineNum">   16243 </span>                :<span class="lineCov">          1 :   QgsLineString lp22;</span></a>
<a name="16244"><span class="lineNum">   16244 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="16245"><span class="lineNum">   16245 </span>                :<span class="lineCov">          1 :   p22.addGeometry( lp22.clone() );</span></a>
<a name="16246"><span class="lineNum">   16246 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, 4 ); //out of range</span></a>
<a name="16247"><span class="lineNum">   16247 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16248"><span class="lineNum">   16248 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -5 );</span></a>
<a name="16249"><span class="lineNum">   16249 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16250"><span class="lineNum">   16250 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 0, 0, -1 );</span></a>
<a name="16251"><span class="lineNum">   16251 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16252"><span class="lineNum">   16252 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="16253"><span class="lineNum">   16253 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="16254"><span class="lineNum">   16254 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16255"><span class="lineNum">   16255 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="16256"><span class="lineNum">   16256 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="16257"><span class="lineNum">   16257 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16258"><span class="lineNum">   16258 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16259"><span class="lineNum">   16259 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 12 ) );</span></a>
<a name="16260"><span class="lineNum">   16260 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16261"><span class="lineNum">   16261 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 0, 0, 3 ) );</span></a>
<a name="16262"><span class="lineNum">   16262 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 1, 2 ) );</span></a>
<a name="16263"><span class="lineNum">   16263 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="16264"><span class="lineNum">   16264 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16265"><span class="lineNum">   16265 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 0 );</span></a>
<a name="16266"><span class="lineNum">   16266 </span>                :            :   // add another part</a>
<a name="16267"><span class="lineNum">   16267 </span>                :<span class="lineCov">          1 :   lp22.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 11, 22 ) &lt;&lt; QgsPoint( 11, 12 ) );</span></a>
<a name="16268"><span class="lineNum">   16268 </span>                :<span class="lineCov">          1 :   p22.addGeometry( lp22.clone() );</span></a>
<a name="16269"><span class="lineNum">   16269 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, 4 ); //out of range</span></a>
<a name="16270"><span class="lineNum">   16270 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16271"><span class="lineNum">   16271 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, -5 );</span></a>
<a name="16272"><span class="lineNum">   16272 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16273"><span class="lineNum">   16273 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 0, -1 );</span></a>
<a name="16274"><span class="lineNum">   16274 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16275"><span class="lineNum">   16275 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="16276"><span class="lineNum">   16276 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="16277"><span class="lineNum">   16277 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16278"><span class="lineNum">   16278 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 1 ) );</span></a>
<a name="16279"><span class="lineNum">   16279 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="16280"><span class="lineNum">   16280 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16281"><span class="lineNum">   16281 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="16282"><span class="lineNum">   16282 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 22 ) );</span></a>
<a name="16283"><span class="lineNum">   16283 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16284"><span class="lineNum">   16284 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 0, 3 ) );</span></a>
<a name="16285"><span class="lineNum">   16285 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 11, 12 ) );</span></a>
<a name="16286"><span class="lineNum">   16286 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 2, 0, 0 );</span></a>
<a name="16287"><span class="lineNum">   16287 </span>                :<span class="lineCov">          1 :   QVERIFY( !p22.nextVertex( v, pt ) );</span></a>
<a name="16288"><span class="lineNum">   16288 </span>                :<span class="lineCov">          1 :   v = QgsVertexId( 1, 1, 0 );</span></a>
<a name="16289"><span class="lineNum">   16289 </span>                :<span class="lineCov">          1 :   QVERIFY( p22.nextVertex( v, pt ) );</span></a>
<a name="16290"><span class="lineNum">   16290 </span>                :<span class="lineCov">          1 :   QCOMPARE( v, QgsVertexId( 1, 1, 1 ) ); //test that part number is maintained</span></a>
<a name="16291"><span class="lineNum">   16291 </span>                :<span class="lineCov">          1 :   QCOMPARE( pt, QgsPoint( 21, 22 ) );</span></a>
<a name="16292"><span class="lineNum">   16292 </span>                :            : </a>
<a name="16293"><span class="lineNum">   16293 </span>                :            : </a>
<a name="16294"><span class="lineNum">   16294 </span>                :            :   // dropZValue</a>
<a name="16295"><span class="lineNum">   16295 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p23;</span></a>
<a name="16296"><span class="lineNum">   16296 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="16297"><span class="lineNum">   16297 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16298"><span class="lineNum">   16298 </span>                :<span class="lineCov">          1 :   QgsLineString lp23;</span></a>
<a name="16299"><span class="lineNum">   16299 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="16300"><span class="lineNum">   16300 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16301"><span class="lineNum">   16301 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16302"><span class="lineNum">   16302 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16303"><span class="lineNum">   16303 </span>                :<span class="lineCov">          1 :   p23.dropZValue(); // not z</span></a>
<a name="16304"><span class="lineNum">   16304 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16305"><span class="lineNum">   16305 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16306"><span class="lineNum">   16306 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16307"><span class="lineNum">   16307 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16308"><span class="lineNum">   16308 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16309"><span class="lineNum">   16309 </span>                :            :   // with z</a>
<a name="16310"><span class="lineNum">   16310 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3 ) &lt;&lt; QgsPoint( 11, 12, 13 ) &lt;&lt; QgsPoint( 1, 12, 23 ) &lt;&lt; QgsPoint( 1, 2, 3 ) );</span></a>
<a name="16311"><span class="lineNum">   16311 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="16312"><span class="lineNum">   16312 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16313"><span class="lineNum">   16313 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16314"><span class="lineNum">   16314 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="16315"><span class="lineNum">   16315 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16316"><span class="lineNum">   16316 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16317"><span class="lineNum">   16317 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16318"><span class="lineNum">   16318 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16319"><span class="lineNum">   16319 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16320"><span class="lineNum">   16320 </span>                :            :   // with zm</a>
<a name="16321"><span class="lineNum">   16321 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="16322"><span class="lineNum">   16322 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="16323"><span class="lineNum">   16323 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16324"><span class="lineNum">   16324 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16325"><span class="lineNum">   16325 </span>                :<span class="lineCov">          1 :   p23.dropZValue();</span></a>
<a name="16326"><span class="lineNum">   16326 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16327"><span class="lineNum">   16327 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="16328"><span class="lineNum">   16328 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="16329"><span class="lineNum">   16329 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineStringM );</span></a>
<a name="16330"><span class="lineNum">   16330 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointM, 1, 2, 0, 4 ) );</span></a>
<a name="16331"><span class="lineNum">   16331 </span>                :            : </a>
<a name="16332"><span class="lineNum">   16332 </span>                :            : </a>
<a name="16333"><span class="lineNum">   16333 </span>                :            :   // dropMValue</a>
<a name="16334"><span class="lineNum">   16334 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="16335"><span class="lineNum">   16335 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="16336"><span class="lineNum">   16336 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16337"><span class="lineNum">   16337 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 1, 12 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="16338"><span class="lineNum">   16338 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16339"><span class="lineNum">   16339 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16340"><span class="lineNum">   16340 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16341"><span class="lineNum">   16341 </span>                :<span class="lineCov">          1 :   p23.dropMValue(); // not zm</span></a>
<a name="16342"><span class="lineNum">   16342 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16343"><span class="lineNum">   16343 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16344"><span class="lineNum">   16344 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16345"><span class="lineNum">   16345 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16346"><span class="lineNum">   16346 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16347"><span class="lineNum">   16347 </span>                :            :   // with m</a>
<a name="16348"><span class="lineNum">   16348 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 11, 12, 0, 13 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 1, 12, 0, 23 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM,  1, 2, 0, 3 ) );</span></a>
<a name="16349"><span class="lineNum">   16349 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="16350"><span class="lineNum">   16350 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16351"><span class="lineNum">   16351 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16352"><span class="lineNum">   16352 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="16353"><span class="lineNum">   16353 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16354"><span class="lineNum">   16354 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16355"><span class="lineNum">   16355 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16356"><span class="lineNum">   16356 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16357"><span class="lineNum">   16357 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16358"><span class="lineNum">   16358 </span>                :            :   // with zm</a>
<a name="16359"><span class="lineNum">   16359 </span>                :<span class="lineCov">          1 :   lp23.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4 ) &lt;&lt; QgsPoint( 11, 12, 13, 14 ) &lt;&lt; QgsPoint( 1, 12, 23, 24 ) &lt;&lt; QgsPoint( 1, 2, 3, 4 ) );</span></a>
<a name="16360"><span class="lineNum">   16360 </span>                :<span class="lineCov">          1 :   p23.clear();</span></a>
<a name="16361"><span class="lineNum">   16361 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16362"><span class="lineNum">   16362 </span>                :<span class="lineCov">          1 :   p23.addGeometry( lp23.clone() );</span></a>
<a name="16363"><span class="lineNum">   16363 </span>                :<span class="lineCov">          1 :   p23.dropMValue();</span></a>
<a name="16364"><span class="lineNum">   16364 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.wkbType(), QgsWkbTypes::GeometryCollection );</span></a>
<a name="16365"><span class="lineNum">   16365 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 0 )-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="16366"><span class="lineNum">   16366 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="16367"><span class="lineNum">   16367 </span>                :<span class="lineCov">          1 :   QCOMPARE( p23.geometryN( 1 )-&gt;wkbType(), QgsWkbTypes::LineStringZ );</span></a>
<a name="16368"><span class="lineNum">   16368 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString *&gt;( p23.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( QgsWkbTypes::PointZ, 1, 2, 3 ) );</span></a>
<a name="16369"><span class="lineNum">   16369 </span>                :            : </a>
<a name="16370"><span class="lineNum">   16370 </span>                :            :   //vertexAngle</a>
<a name="16371"><span class="lineNum">   16371 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p24;</span></a>
<a name="16372"><span class="lineNum">   16372 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId() ); //just want no crash</span></a>
<a name="16373"><span class="lineNum">   16373 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( 0, 0, 0 ) ); //just want no crash</span></a>
<a name="16374"><span class="lineNum">   16374 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( 0, 1, 0 ) ); //just want no crash</span></a>
<a name="16375"><span class="lineNum">   16375 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( 1, 0, 0 ) ); //just want no crash</span></a>
<a name="16376"><span class="lineNum">   16376 </span>                :<span class="lineCov">          1 :   ( void )p24.vertexAngle( QgsVertexId( -1, 0, 0 ) ); //just want no crash</span></a>
<a name="16377"><span class="lineNum">   16377 </span>                :<span class="lineCov">          1 :   QgsLineString l38;</span></a>
<a name="16378"><span class="lineNum">   16378 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="16379"><span class="lineNum">   16379 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="16380"><span class="lineNum">   16380 </span>                :<span class="lineCov">          1 :   p24.addGeometry( l38.clone() );</span></a>
<a name="16381"><span class="lineNum">   16381 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="16382"><span class="lineNum">   16382 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="16383"><span class="lineNum">   16383 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="16384"><span class="lineNum">   16384 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="16385"><span class="lineNum">   16385 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="16386"><span class="lineNum">   16386 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="16387"><span class="lineNum">   16387 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 0, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="16388"><span class="lineNum">   16388 </span>                :<span class="lineCov">          1 :   p24.addGeometry( l38.clone() );</span></a>
<a name="16389"><span class="lineNum">   16389 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 0 ) ), 2.35619, 0.00001 );</span></a>
<a name="16390"><span class="lineNum">   16390 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 1 ) ), 1.5708, 0.0001 );</span></a>
<a name="16391"><span class="lineNum">   16391 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 2 ) ), 1.17809, 0.00001 );</span></a>
<a name="16392"><span class="lineNum">   16392 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 3 ) ), 0.0, 0.00001 );</span></a>
<a name="16393"><span class="lineNum">   16393 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 4 ) ), 5.10509, 0.00001 );</span></a>
<a name="16394"><span class="lineNum">   16394 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 5 ) ), 3.92699, 0.00001 );</span></a>
<a name="16395"><span class="lineNum">   16395 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( p24.vertexAngle( QgsVertexId( 1, 0, 6 ) ), 2.35619, 0.00001 );</span></a>
<a name="16396"><span class="lineNum">   16396 </span>                :            : </a>
<a name="16397"><span class="lineNum">   16397 </span>                :            :   //insert vertex</a>
<a name="16398"><span class="lineNum">   16398 </span>                :            : </a>
<a name="16399"><span class="lineNum">   16399 </span>                :            :   //insert vertex in empty collection</a>
<a name="16400"><span class="lineNum">   16400 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p25;</span></a>
<a name="16401"><span class="lineNum">   16401 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16402"><span class="lineNum">   16402 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16403"><span class="lineNum">   16403 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 1, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16404"><span class="lineNum">   16404 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16405"><span class="lineNum">   16405 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.isEmpty() );</span></a>
<a name="16406"><span class="lineNum">   16406 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0.5, 0 ) &lt;&lt; QgsPoint( 1, 0 )</span></a>
<a name="16407"><span class="lineNum">   16407 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 2, 1 ) &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 0, 2 ) &lt;&lt; QgsPoint( 0, 0 ) );</span></a>
<a name="16408"><span class="lineNum">   16408 </span>                :<span class="lineCov">          1 :   p25.addGeometry( l38.clone() );</span></a>
<a name="16409"><span class="lineNum">   16409 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="16410"><span class="lineNum">   16410 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 8 );</span></a>
<a name="16411"><span class="lineNum">   16411 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16412"><span class="lineNum">   16412 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16413"><span class="lineNum">   16413 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16414"><span class="lineNum">   16414 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16415"><span class="lineNum">   16415 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 0, 0, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16416"><span class="lineNum">   16416 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16417"><span class="lineNum">   16417 </span>                :            :   // first vertex</a>
<a name="16418"><span class="lineNum">   16418 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="16419"><span class="lineNum">   16419 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 9 );</span></a>
<a name="16420"><span class="lineNum">   16420 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="16421"><span class="lineNum">   16421 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16422"><span class="lineNum">   16422 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16423"><span class="lineNum">   16423 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16424"><span class="lineNum">   16424 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="16425"><span class="lineNum">   16425 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16426"><span class="lineNum">   16426 </span>                :            :   // last vertex</a>
<a name="16427"><span class="lineNum">   16427 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 0, 0, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="16428"><span class="lineNum">   16428 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 10 );</span></a>
<a name="16429"><span class="lineNum">   16429 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="16430"><span class="lineNum">   16430 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16431"><span class="lineNum">   16431 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16432"><span class="lineNum">   16432 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16433"><span class="lineNum">   16433 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16434"><span class="lineNum">   16434 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 0 ) )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="16435"><span class="lineNum">   16435 </span>                :            :   // with second part</a>
<a name="16436"><span class="lineNum">   16436 </span>                :<span class="lineCov">          1 :   p25.addGeometry( l38.clone() );</span></a>
<a name="16437"><span class="lineNum">   16437 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 17 );</span></a>
<a name="16438"><span class="lineNum">   16438 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 1, 0, 1 ), QgsPoint( 0.3, 0 ) ) );</span></a>
<a name="16439"><span class="lineNum">   16439 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 18 );</span></a>
<a name="16440"><span class="lineNum">   16440 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16441"><span class="lineNum">   16441 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16442"><span class="lineNum">   16442 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16443"><span class="lineNum">   16443 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, -1 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16444"><span class="lineNum">   16444 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 1, 0, 100 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16445"><span class="lineNum">   16445 </span>                :<span class="lineCov">          1 :   QVERIFY( !p25.insertVertex( QgsVertexId( 2, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16446"><span class="lineNum">   16446 </span>                :            :   // first vertex in second part</a>
<a name="16447"><span class="lineNum">   16447 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 0, 0.1 ) ) );</span></a>
<a name="16448"><span class="lineNum">   16448 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 19 );</span></a>
<a name="16449"><span class="lineNum">   16449 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="16450"><span class="lineNum">   16450 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16451"><span class="lineNum">   16451 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16452"><span class="lineNum">   16452 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16453"><span class="lineNum">   16453 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 7 ), QgsPoint( 0, 2 ) );</span></a>
<a name="16454"><span class="lineNum">   16454 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16455"><span class="lineNum">   16455 </span>                :            :   // last vertex in second part</a>
<a name="16456"><span class="lineNum">   16456 </span>                :<span class="lineCov">          1 :   QVERIFY( p25.insertVertex( QgsVertexId( 1, 0, 9 ), QgsPoint( 0.1, 0.1 ) ) );</span></a>
<a name="16457"><span class="lineNum">   16457 </span>                :<span class="lineCov">          1 :   QCOMPARE( p25.nCoordinates(), 20 );</span></a>
<a name="16458"><span class="lineNum">   16458 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 0, 0.1 ) );</span></a>
<a name="16459"><span class="lineNum">   16459 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16460"><span class="lineNum">   16460 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 0.3, 0 ) );</span></a>
<a name="16461"><span class="lineNum">   16461 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 0.5, 0 ) );</span></a>
<a name="16462"><span class="lineNum">   16462 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 8 ), QgsPoint( 0, 0 ) );</span></a>
<a name="16463"><span class="lineNum">   16463 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p25.geometryN( 1 ) )-&gt;pointN( 9 ), QgsPoint( 0.1, 0.1 ) );</span></a>
<a name="16464"><span class="lineNum">   16464 </span>                :            : </a>
<a name="16465"><span class="lineNum">   16465 </span>                :            :   //move vertex</a>
<a name="16466"><span class="lineNum">   16466 </span>                :            : </a>
<a name="16467"><span class="lineNum">   16467 </span>                :            :   //empty collection</a>
<a name="16468"><span class="lineNum">   16468 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p26;</span></a>
<a name="16469"><span class="lineNum">   16469 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16470"><span class="lineNum">   16470 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( -1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16471"><span class="lineNum">   16471 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16472"><span class="lineNum">   16472 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.isEmpty() );</span></a>
<a name="16473"><span class="lineNum">   16473 </span>                :            : </a>
<a name="16474"><span class="lineNum">   16474 </span>                :            :   //valid collection</a>
<a name="16475"><span class="lineNum">   16475 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="16476"><span class="lineNum">   16476 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="16477"><span class="lineNum">   16477 </span>                :<span class="lineCov">          1 :   p26.addGeometry( l38.clone() );</span></a>
<a name="16478"><span class="lineNum">   16478 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16479"><span class="lineNum">   16479 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="16480"><span class="lineNum">   16480 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 0, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="16481"><span class="lineNum">   16481 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="16482"><span class="lineNum">   16482 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="16483"><span class="lineNum">   16483 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="16484"><span class="lineNum">   16484 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 1, 2 ) );</span></a>
<a name="16485"><span class="lineNum">   16485 </span>                :            : </a>
<a name="16486"><span class="lineNum">   16486 </span>                :            :   //out of range</a>
<a name="16487"><span class="lineNum">   16487 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16488"><span class="lineNum">   16488 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 0, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16489"><span class="lineNum">   16489 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16490"><span class="lineNum">   16490 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="16491"><span class="lineNum">   16491 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="16492"><span class="lineNum">   16492 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="16493"><span class="lineNum">   16493 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16494"><span class="lineNum">   16494 </span>                :            : </a>
<a name="16495"><span class="lineNum">   16495 </span>                :            :   // with second part</a>
<a name="16496"><span class="lineNum">   16496 </span>                :<span class="lineCov">          1 :   p26.addGeometry( l38.clone() );</span></a>
<a name="16497"><span class="lineNum">   16497 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 1, 0, 0 ), QgsPoint( 6.0, 7.0 ) ) );</span></a>
<a name="16498"><span class="lineNum">   16498 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 1, 0, 1 ), QgsPoint( 16.0, 17.0 ) ) );</span></a>
<a name="16499"><span class="lineNum">   16499 </span>                :<span class="lineCov">          1 :   QVERIFY( p26.moveVertex( QgsVertexId( 1, 0, 2 ), QgsPoint( 26.0, 27.0 ) ) );</span></a>
<a name="16500"><span class="lineNum">   16500 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 7.0 ) );</span></a>
<a name="16501"><span class="lineNum">   16501 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 16.0, 17.0 ) );</span></a>
<a name="16502"><span class="lineNum">   16502 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 26.0, 27.0 ) );</span></a>
<a name="16503"><span class="lineNum">   16503 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p26.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16504"><span class="lineNum">   16504 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 1, 0, -1 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16505"><span class="lineNum">   16505 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 1, 0, 10 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16506"><span class="lineNum">   16506 </span>                :<span class="lineCov">          1 :   QVERIFY( !p26.moveVertex( QgsVertexId( 2, 0, 0 ), QgsPoint( 3.0, 4.0 ) ) );</span></a>
<a name="16507"><span class="lineNum">   16507 </span>                :            : </a>
<a name="16508"><span class="lineNum">   16508 </span>                :            :   //delete vertex</a>
<a name="16509"><span class="lineNum">   16509 </span>                :            : </a>
<a name="16510"><span class="lineNum">   16510 </span>                :            :   //empty collection</a>
<a name="16511"><span class="lineNum">   16511 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection p27;</span></a>
<a name="16512"><span class="lineNum">   16512 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16513"><span class="lineNum">   16513 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 1, 0 ) ) );</span></a>
<a name="16514"><span class="lineNum">   16514 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 1, 1, 0 ) ) );</span></a>
<a name="16515"><span class="lineNum">   16515 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( -1, 1, 0 ) ) );</span></a>
<a name="16516"><span class="lineNum">   16516 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.isEmpty() );</span></a>
<a name="16517"><span class="lineNum">   16517 </span>                :            : </a>
<a name="16518"><span class="lineNum">   16518 </span>                :            :   //valid collection</a>
<a name="16519"><span class="lineNum">   16519 </span>                :<span class="lineCov">          2 :   l38.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 5, 2 ) &lt;&lt; QgsPoint( 6, 2 ) &lt;&lt; QgsPoint( 7, 2 )</span></a>
<a name="16520"><span class="lineNum">   16520 </span>                :<span class="lineCov">          1 :                  &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 21, 22 ) &lt;&lt; QgsPoint( 1, 2 ) );</span></a>
<a name="16521"><span class="lineNum">   16521 </span>                :            : </a>
<a name="16522"><span class="lineNum">   16522 </span>                :<span class="lineCov">          1 :   p27.addGeometry( l38.clone() );</span></a>
<a name="16523"><span class="lineNum">   16523 </span>                :            :   //out of range vertices</a>
<a name="16524"><span class="lineNum">   16524 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, -1 ) ) );</span></a>
<a name="16525"><span class="lineNum">   16525 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 0, 0, 100 ) ) );</span></a>
<a name="16526"><span class="lineNum">   16526 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 1, 0, 1 ) ) );</span></a>
<a name="16527"><span class="lineNum">   16527 </span>                :            : </a>
<a name="16528"><span class="lineNum">   16528 </span>                :            :   //valid vertices</a>
<a name="16529"><span class="lineNum">   16529 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 1 ) ) );</span></a>
<a name="16530"><span class="lineNum">   16530 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16531"><span class="lineNum">   16531 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16532"><span class="lineNum">   16532 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16533"><span class="lineNum">   16533 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16534"><span class="lineNum">   16534 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16535"><span class="lineNum">   16535 </span>                :            : </a>
<a name="16536"><span class="lineNum">   16536 </span>                :            :   // delete first vertex</a>
<a name="16537"><span class="lineNum">   16537 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16538"><span class="lineNum">   16538 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16539"><span class="lineNum">   16539 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16540"><span class="lineNum">   16540 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16541"><span class="lineNum">   16541 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="16542"><span class="lineNum">   16542 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 4 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16543"><span class="lineNum">   16543 </span>                :            : </a>
<a name="16544"><span class="lineNum">   16544 </span>                :            :   // delete last vertex</a>
<a name="16545"><span class="lineNum">   16545 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 4 ) ) );</span></a>
<a name="16546"><span class="lineNum">   16546 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16547"><span class="lineNum">   16547 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16548"><span class="lineNum">   16548 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16549"><span class="lineNum">   16549 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 0 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="16550"><span class="lineNum">   16550 </span>                :            : </a>
<a name="16551"><span class="lineNum">   16551 </span>                :            :   // delete some more vertices - should remove part</a>
<a name="16552"><span class="lineNum">   16552 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16553"><span class="lineNum">   16553 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16554"><span class="lineNum">   16554 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16555"><span class="lineNum">   16555 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.geometryN( 0 ) );</span></a>
<a name="16556"><span class="lineNum">   16556 </span>                :            : </a>
<a name="16557"><span class="lineNum">   16557 </span>                :            :   // with two parts</a>
<a name="16558"><span class="lineNum">   16558 </span>                :<span class="lineCov">          1 :   p27.addGeometry( l38.clone() );</span></a>
<a name="16559"><span class="lineNum">   16559 </span>                :<span class="lineCov">          1 :   p27.addGeometry( l38.clone() );</span></a>
<a name="16560"><span class="lineNum">   16560 </span>                :            : </a>
<a name="16561"><span class="lineNum">   16561 </span>                :            :   //out of range vertices</a>
<a name="16562"><span class="lineNum">   16562 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 1, 0, -1 ) ) );</span></a>
<a name="16563"><span class="lineNum">   16563 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 1, 0, 100 ) ) );</span></a>
<a name="16564"><span class="lineNum">   16564 </span>                :<span class="lineCov">          1 :   QVERIFY( !p27.deleteVertex( QgsVertexId( 2, 0, 1 ) ) );</span></a>
<a name="16565"><span class="lineNum">   16565 </span>                :            : </a>
<a name="16566"><span class="lineNum">   16566 </span>                :            :   //valid vertices</a>
<a name="16567"><span class="lineNum">   16567 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 1 ) ) );</span></a>
<a name="16568"><span class="lineNum">   16568 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16569"><span class="lineNum">   16569 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16570"><span class="lineNum">   16570 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16571"><span class="lineNum">   16571 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16572"><span class="lineNum">   16572 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 5 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16573"><span class="lineNum">   16573 </span>                :            : </a>
<a name="16574"><span class="lineNum">   16574 </span>                :            :   // delete first vertex</a>
<a name="16575"><span class="lineNum">   16575 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 0 ) ) );</span></a>
<a name="16576"><span class="lineNum">   16576 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16577"><span class="lineNum">   16577 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16578"><span class="lineNum">   16578 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16579"><span class="lineNum">   16579 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="16580"><span class="lineNum">   16580 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 4 ), QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="16581"><span class="lineNum">   16581 </span>                :            : </a>
<a name="16582"><span class="lineNum">   16582 </span>                :            :   // delete last vertex</a>
<a name="16583"><span class="lineNum">   16583 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 4 ) ) );</span></a>
<a name="16584"><span class="lineNum">   16584 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 0 ), QgsPoint( 6.0, 2.0 ) );</span></a>
<a name="16585"><span class="lineNum">   16585 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 1 ), QgsPoint( 7.0, 2.0 ) );</span></a>
<a name="16586"><span class="lineNum">   16586 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 2 ), QgsPoint( 11.0, 12.0 ) );</span></a>
<a name="16587"><span class="lineNum">   16587 </span>                :<span class="lineCov">          1 :   QCOMPARE( static_cast&lt; const QgsLineString * &gt;( p27.geometryN( 1 ) )-&gt;pointN( 3 ), QgsPoint( 21.0, 22.0 ) );</span></a>
<a name="16588"><span class="lineNum">   16588 </span>                :            : </a>
<a name="16589"><span class="lineNum">   16589 </span>                :            :   // delete some more vertices - should remove part</a>
<a name="16590"><span class="lineNum">   16590 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 1 ) ) );</span></a>
<a name="16591"><span class="lineNum">   16591 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 1 ) ) );</span></a>
<a name="16592"><span class="lineNum">   16592 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 1, 0, 1 ) ) );</span></a>
<a name="16593"><span class="lineNum">   16593 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numGeometries(), 1 );</span></a>
<a name="16594"><span class="lineNum">   16594 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.geometryN( 0 ) );</span></a>
<a name="16595"><span class="lineNum">   16595 </span>                :            : </a>
<a name="16596"><span class="lineNum">   16596 </span>                :            :   // test that second geometry is &quot;promoted&quot; when first is removed</a>
<a name="16597"><span class="lineNum">   16597 </span>                :<span class="lineCov">          1 :   p27.addGeometry( l38.clone() );</span></a>
<a name="16598"><span class="lineNum">   16598 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16599"><span class="lineNum">   16599 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numGeometries(), 2 );</span></a>
<a name="16600"><span class="lineNum">   16600 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16601"><span class="lineNum">   16601 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numGeometries(), 2 );</span></a>
<a name="16602"><span class="lineNum">   16602 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16603"><span class="lineNum">   16603 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numGeometries(), 2 );</span></a>
<a name="16604"><span class="lineNum">   16604 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16605"><span class="lineNum">   16605 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16606"><span class="lineNum">   16606 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.deleteVertex( QgsVertexId( 0, 0, 0 ) ) );</span></a>
<a name="16607"><span class="lineNum">   16607 </span>                :<span class="lineCov">          1 :   QCOMPARE( p27.numGeometries(), 1 );</span></a>
<a name="16608"><span class="lineNum">   16608 </span>                :<span class="lineCov">          1 :   QVERIFY( p27.geometryN( 0 ) );</span></a>
<a name="16609"><span class="lineNum">   16609 </span>                :            : </a>
<a name="16610"><span class="lineNum">   16610 </span>                :            :   //boundary</a>
<a name="16611"><span class="lineNum">   16611 </span>                :            : </a>
<a name="16612"><span class="lineNum">   16612 </span>                :            :   // collections have no boundary defined</a>
<a name="16613"><span class="lineNum">   16613 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection boundaryCollection;</span></a>
<a name="16614"><span class="lineNum">   16614 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryCollection.boundary() );</span></a>
<a name="16615"><span class="lineNum">   16615 </span>                :            :   // add a geometry and retest, should still be undefined</a>
<a name="16616"><span class="lineNum">   16616 </span>                :<span class="lineCov">          1 :   QgsLineString *lineBoundary = new QgsLineString();</span></a>
<a name="16617"><span class="lineNum">   16617 </span>                :<span class="lineCov">          1 :   lineBoundary-&gt;setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 1, 0 ) );</span></a>
<a name="16618"><span class="lineNum">   16618 </span>                :<span class="lineCov">          1 :   boundaryCollection.addGeometry( lineBoundary );</span></a>
<a name="16619"><span class="lineNum">   16619 </span>                :<span class="lineCov">          1 :   QVERIFY( !boundaryCollection.boundary() );</span></a>
<a name="16620"><span class="lineNum">   16620 </span>                :            : </a>
<a name="16621"><span class="lineNum">   16621 </span>                :            :   // segmentize</a>
<a name="16622"><span class="lineNum">   16622 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection segmentC;</span></a>
<a name="16623"><span class="lineNum">   16623 </span>                :<span class="lineCov">          1 :   QgsCircularString toSegment;</span></a>
<a name="16624"><span class="lineNum">   16624 </span>                :<span class="lineCov">          2 :   toSegment.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 )</span></a>
<a name="16625"><span class="lineNum">   16625 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPoint( 11, 10 ) &lt;&lt; QgsPoint( 21, 2 ) );</span></a>
<a name="16626"><span class="lineNum">   16626 </span>                :<span class="lineCov">          1 :   segmentC.addGeometry( toSegment.clone() );</span></a>
<a name="16627"><span class="lineNum">   16627 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsGeometryCollection&gt; segmentized( static_cast&lt; QgsGeometryCollection * &gt;( segmentC.segmentize() ) );</span></a>
<a name="16628"><span class="lineNum">   16628 </span>                :<span class="lineCov">          1 :   const QgsLineString *segmentizedLine = static_cast&lt; const QgsLineString * &gt;( segmentized-&gt;geometryN( 0 ) );</span></a>
<a name="16629"><span class="lineNum">   16629 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;numPoints(), 156 );</span></a>
<a name="16630"><span class="lineNum">   16630 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;vertexCount(), 156 );</span></a>
<a name="16631"><span class="lineNum">   16631 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;ringCount(), 1 );</span></a>
<a name="16632"><span class="lineNum">   16632 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;partCount(), 1 );</span></a>
<a name="16633"><span class="lineNum">   16633 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16634"><span class="lineNum">   16634 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentizedLine-&gt;is3D() );</span></a>
<a name="16635"><span class="lineNum">   16635 </span>                :<span class="lineCov">          1 :   QVERIFY( !segmentizedLine-&gt;isMeasure() );</span></a>
<a name="16636"><span class="lineNum">   16636 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;pointN( 0 ), toSegment.pointN( 0 ) );</span></a>
<a name="16637"><span class="lineNum">   16637 </span>                :<span class="lineCov">          1 :   QCOMPARE( segmentizedLine-&gt;pointN( segmentizedLine-&gt;numPoints() - 1 ), toSegment.pointN( toSegment.numPoints() - 1 ) );</span></a>
<a name="16638"><span class="lineNum">   16638 </span>                :            : </a>
<a name="16639"><span class="lineNum">   16639 </span>                :            :   // hasCurvedSegments</a>
<a name="16640"><span class="lineNum">   16640 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c30;</span></a>
<a name="16641"><span class="lineNum">   16641 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.hasCurvedSegments() );</span></a>
<a name="16642"><span class="lineNum">   16642 </span>                :<span class="lineCov">          1 :   c30.addGeometry( part.clone() );</span></a>
<a name="16643"><span class="lineNum">   16643 </span>                :<span class="lineCov">          1 :   QVERIFY( !c30.hasCurvedSegments() );</span></a>
<a name="16644"><span class="lineNum">   16644 </span>                :<span class="lineCov">          1 :   c30.addGeometry( toSegment.clone() );</span></a>
<a name="16645"><span class="lineNum">   16645 </span>                :<span class="lineCov">          1 :   QVERIFY( c30.hasCurvedSegments() );</span></a>
<a name="16646"><span class="lineNum">   16646 </span>                :            : </a>
<a name="16647"><span class="lineNum">   16647 </span>                :            : </a>
<a name="16648"><span class="lineNum">   16648 </span>                :            :   //adjacent vertices</a>
<a name="16649"><span class="lineNum">   16649 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c31;</span></a>
<a name="16650"><span class="lineNum">   16650 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine1;</span></a>
<a name="16651"><span class="lineNum">   16651 </span>                :<span class="lineCov">          1 :   QgsVertexId prev( 1, 2, 3 ); // start with something</span></a>
<a name="16652"><span class="lineNum">   16652 </span>                :<span class="lineCov">          1 :   QgsVertexId next( 4, 5, 6 );</span></a>
<a name="16653"><span class="lineNum">   16653 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 0, 0, -1 ), prev, next );</span></a>
<a name="16654"><span class="lineNum">   16654 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16655"><span class="lineNum">   16655 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="16656"><span class="lineNum">   16656 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( -1, 0, -1 ), prev, next );</span></a>
<a name="16657"><span class="lineNum">   16657 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16658"><span class="lineNum">   16658 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="16659"><span class="lineNum">   16659 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 10, 0, -1 ), prev, next );</span></a>
<a name="16660"><span class="lineNum">   16660 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16661"><span class="lineNum">   16661 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="16662"><span class="lineNum">   16662 </span>                :<span class="lineCov">          1 :   vertexLine1.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 112 ) );</span></a>
<a name="16663"><span class="lineNum">   16663 </span>                :<span class="lineCov">          1 :   c31.addGeometry( vertexLine1.clone() );</span></a>
<a name="16664"><span class="lineNum">   16664 </span>                :<span class="lineCov">          1 :   c31.addGeometry( vertexLine1.clone() );</span></a>
<a name="16665"><span class="lineNum">   16665 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( -1, 0, -1 ), prev, next );</span></a>
<a name="16666"><span class="lineNum">   16666 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16667"><span class="lineNum">   16667 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="16668"><span class="lineNum">   16668 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 10, 0, -1 ), prev, next );</span></a>
<a name="16669"><span class="lineNum">   16669 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16670"><span class="lineNum">   16670 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId() );</span></a>
<a name="16671"><span class="lineNum">   16671 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 0, 0, 0 ), prev, next );</span></a>
<a name="16672"><span class="lineNum">   16672 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId() );</span></a>
<a name="16673"><span class="lineNum">   16673 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 1 ) );</span></a>
<a name="16674"><span class="lineNum">   16674 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 0, 0, 1 ), prev, next );</span></a>
<a name="16675"><span class="lineNum">   16675 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 0, 0, 0 ) );</span></a>
<a name="16676"><span class="lineNum">   16676 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 0, 0, 2 ) );</span></a>
<a name="16677"><span class="lineNum">   16677 </span>                :<span class="lineCov">          1 :   c31.adjacentVertices( QgsVertexId( 1, 0, 1 ), prev, next );</span></a>
<a name="16678"><span class="lineNum">   16678 </span>                :<span class="lineCov">          1 :   QCOMPARE( prev, QgsVertexId( 1, 0, 0 ) );</span></a>
<a name="16679"><span class="lineNum">   16679 </span>                :<span class="lineCov">          1 :   QCOMPARE( next, QgsVertexId( 1, 0, 2 ) );</span></a>
<a name="16680"><span class="lineNum">   16680 </span>                :            : </a>
<a name="16681"><span class="lineNum">   16681 </span>                :            : </a>
<a name="16682"><span class="lineNum">   16682 </span>                :            :   // vertex number</a>
<a name="16683"><span class="lineNum">   16683 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection c32;</span></a>
<a name="16684"><span class="lineNum">   16684 </span>                :<span class="lineCov">          1 :   QgsLineString vertexLine2;</span></a>
<a name="16685"><span class="lineNum">   16685 </span>                :<span class="lineCov">          1 :   vertexLine2.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 112 ) );</span></a>
<a name="16686"><span class="lineNum">   16686 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="16687"><span class="lineNum">   16687 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="16688"><span class="lineNum">   16688 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, -1, 0 ) ), -1 );</span></a>
<a name="16689"><span class="lineNum">   16689 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="16690"><span class="lineNum">   16690 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="16691"><span class="lineNum">   16691 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), -1 );</span></a>
<a name="16692"><span class="lineNum">   16692 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), -1 );</span></a>
<a name="16693"><span class="lineNum">   16693 </span>                :<span class="lineCov">          1 :   c32.addGeometry( vertexLine2.clone() );</span></a>
<a name="16694"><span class="lineNum">   16694 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( -1, 0, 0 ) ), -1 );</span></a>
<a name="16695"><span class="lineNum">   16695 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), -1 );</span></a>
<a name="16696"><span class="lineNum">   16696 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, -1, 0 ) ), -1 );</span></a>
<a name="16697"><span class="lineNum">   16697 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 1, 0 ) ), -1 );</span></a>
<a name="16698"><span class="lineNum">   16698 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, -1 ) ), -1 );</span></a>
<a name="16699"><span class="lineNum">   16699 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="16700"><span class="lineNum">   16700 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="16701"><span class="lineNum">   16701 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="16702"><span class="lineNum">   16702 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), -1 );</span></a>
<a name="16703"><span class="lineNum">   16703 </span>                :<span class="lineCov">          1 :   c32.addGeometry( vertexLine2.clone() );</span></a>
<a name="16704"><span class="lineNum">   16704 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="16705"><span class="lineNum">   16705 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="16706"><span class="lineNum">   16706 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="16707"><span class="lineNum">   16707 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), -1 );</span></a>
<a name="16708"><span class="lineNum">   16708 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), 3 );</span></a>
<a name="16709"><span class="lineNum">   16709 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 1 ) ), 4 );</span></a>
<a name="16710"><span class="lineNum">   16710 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 2 ) ), 5 );</span></a>
<a name="16711"><span class="lineNum">   16711 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 3 ) ), -1 );</span></a>
<a name="16712"><span class="lineNum">   16712 </span>                :<span class="lineCov">          1 :   QgsPolygon polyPart;</span></a>
<a name="16713"><span class="lineNum">   16713 </span>                :<span class="lineCov">          1 :   vertexLine2.close();</span></a>
<a name="16714"><span class="lineNum">   16714 </span>                :<span class="lineCov">          1 :   polyPart.setExteriorRing( vertexLine2.clone() );</span></a>
<a name="16715"><span class="lineNum">   16715 </span>                :<span class="lineCov">          1 :   c32.addGeometry( polyPart.clone() );</span></a>
<a name="16716"><span class="lineNum">   16716 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 0 ) ), 0 );</span></a>
<a name="16717"><span class="lineNum">   16717 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 1 ) ), 1 );</span></a>
<a name="16718"><span class="lineNum">   16718 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 2 ) ), 2 );</span></a>
<a name="16719"><span class="lineNum">   16719 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 0, 0, 3 ) ), -1 );</span></a>
<a name="16720"><span class="lineNum">   16720 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 0 ) ), 3 );</span></a>
<a name="16721"><span class="lineNum">   16721 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 1 ) ), 4 );</span></a>
<a name="16722"><span class="lineNum">   16722 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 2 ) ), 5 );</span></a>
<a name="16723"><span class="lineNum">   16723 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 1, 0, 3 ) ), -1 );</span></a>
<a name="16724"><span class="lineNum">   16724 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, -1, 0 ) ), -1 );</span></a>
<a name="16725"><span class="lineNum">   16725 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 1, 0 ) ), -1 );</span></a>
<a name="16726"><span class="lineNum">   16726 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, -1 ) ), -1 );</span></a>
<a name="16727"><span class="lineNum">   16727 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 0 ) ), 6 );</span></a>
<a name="16728"><span class="lineNum">   16728 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 1 ) ), 7 );</span></a>
<a name="16729"><span class="lineNum">   16729 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 2 ) ), 8 );</span></a>
<a name="16730"><span class="lineNum">   16730 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 3 ) ), 9 );</span></a>
<a name="16731"><span class="lineNum">   16731 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 4 ) ), -1 );</span></a>
<a name="16732"><span class="lineNum">   16732 </span>                :<span class="lineCov">          1 :   polyPart.addInteriorRing( vertexLine2.clone() );</span></a>
<a name="16733"><span class="lineNum">   16733 </span>                :<span class="lineCov">          1 :   c32.addGeometry( polyPart.clone() );</span></a>
<a name="16734"><span class="lineNum">   16734 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 0 ) ), 6 );</span></a>
<a name="16735"><span class="lineNum">   16735 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 1 ) ), 7 );</span></a>
<a name="16736"><span class="lineNum">   16736 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 2 ) ), 8 );</span></a>
<a name="16737"><span class="lineNum">   16737 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 3 ) ), 9 );</span></a>
<a name="16738"><span class="lineNum">   16738 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 2, 0, 4 ) ), -1 );</span></a>
<a name="16739"><span class="lineNum">   16739 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, -1, 0 ) ), -1 );</span></a>
<a name="16740"><span class="lineNum">   16740 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 2, 0 ) ), -1 );</span></a>
<a name="16741"><span class="lineNum">   16741 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 0, 0 ) ), 10 );</span></a>
<a name="16742"><span class="lineNum">   16742 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 0, 1 ) ), 11 );</span></a>
<a name="16743"><span class="lineNum">   16743 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 0, 2 ) ), 12 );</span></a>
<a name="16744"><span class="lineNum">   16744 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 0, 3 ) ), 13 );</span></a>
<a name="16745"><span class="lineNum">   16745 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 0, 4 ) ), -1 );</span></a>
<a name="16746"><span class="lineNum">   16746 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 1, 0 ) ), 14 );</span></a>
<a name="16747"><span class="lineNum">   16747 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 1, 1 ) ), 15 );</span></a>
<a name="16748"><span class="lineNum">   16748 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 1, 2 ) ), 16 );</span></a>
<a name="16749"><span class="lineNum">   16749 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 1, 3 ) ), 17 );</span></a>
<a name="16750"><span class="lineNum">   16750 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 1, 4 ) ), -1 );</span></a>
<a name="16751"><span class="lineNum">   16751 </span>                :<span class="lineCov">          1 :   QCOMPARE( c32.vertexNumberFromVertexId( QgsVertexId( 3, 2, 0 ) ), -1 );</span></a>
<a name="16752"><span class="lineNum">   16752 </span>                :            : </a>
<a name="16753"><span class="lineNum">   16753 </span>                :            : </a>
<a name="16754"><span class="lineNum">   16754 </span>                :            :   //removeDuplicateNodes</a>
<a name="16755"><span class="lineNum">   16755 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection gcNodes;</span></a>
<a name="16756"><span class="lineNum">   16756 </span>                :<span class="lineCov">          1 :   QgsLineString nodeLine;</span></a>
<a name="16757"><span class="lineNum">   16757 </span>                :<span class="lineCov">          1 :   QVERIFY( !gcNodes.removeDuplicateNodes() );</span></a>
<a name="16758"><span class="lineNum">   16758 </span>                :<span class="lineCov">          1 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) );</span></a>
<a name="16759"><span class="lineNum">   16759 </span>                :<span class="lineCov">          1 :   gcNodes.addGeometry( nodeLine.clone() );</span></a>
<a name="16760"><span class="lineNum">   16760 </span>                :<span class="lineCov">          1 :   QVERIFY( !gcNodes.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="16761"><span class="lineNum">   16761 </span>                :<span class="lineCov">          2 :   QCOMPARE( gcNodes.asWkt(), QStringLiteral( &quot;GeometryCollection (LineString (11 2, 11 12, 111 12))&quot; ) );</span></a>
<a name="16762"><span class="lineNum">   16762 </span>                :<span class="lineCov">          2 :   nodeLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2 ) &lt;&lt; QgsPoint( 11.01, 1.99 ) &lt;&lt; QgsPoint( 11.02, 2.01 )</span></a>
<a name="16763"><span class="lineNum">   16763 </span>                :<span class="lineCov">          1 :                       &lt;&lt; QgsPoint( 11, 12 ) &lt;&lt; QgsPoint( 111, 12 ) &lt;&lt; QgsPoint( 111.01, 11.99 ) );</span></a>
<a name="16764"><span class="lineNum">   16764 </span>                :<span class="lineCov">          1 :   gcNodes.addGeometry( nodeLine.clone() );</span></a>
<a name="16765"><span class="lineNum">   16765 </span>                :<span class="lineCov">          1 :   QVERIFY( gcNodes.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="16766"><span class="lineNum">   16766 </span>                :<span class="lineCov">          1 :   QVERIFY( !gcNodes.removeDuplicateNodes( 0.02 ) );</span></a>
<a name="16767"><span class="lineNum">   16767 </span>                :<span class="lineCov">          2 :   QCOMPARE( gcNodes.asWkt( 2 ), QStringLiteral( &quot;GeometryCollection (LineString (11 2, 11 12, 111 12),LineString (11 2, 11 12, 111 12))&quot; ) );</span></a>
<a name="16768"><span class="lineNum">   16768 </span>                :            : </a>
<a name="16769"><span class="lineNum">   16769 </span>                :            :   //swapXy</a>
<a name="16770"><span class="lineNum">   16770 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection swapCollect;</span></a>
<a name="16771"><span class="lineNum">   16771 </span>                :<span class="lineCov">          1 :   QgsLineString swapLine;</span></a>
<a name="16772"><span class="lineNum">   16772 </span>                :<span class="lineCov">          1 :   swapCollect.swapXy(); // no crash</span></a>
<a name="16773"><span class="lineNum">   16773 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="16774"><span class="lineNum">   16774 </span>                :<span class="lineCov">          1 :   swapCollect.addGeometry( swapLine.clone() );</span></a>
<a name="16775"><span class="lineNum">   16775 </span>                :<span class="lineCov">          1 :   swapCollect.swapXy();</span></a>
<a name="16776"><span class="lineNum">   16776 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapCollect.asWkt(), QStringLiteral( &quot;GeometryCollection (LineStringZM (2 11 3 4, 12 11 13 14, 12 111 23 24))&quot; ) );</span></a>
<a name="16777"><span class="lineNum">   16777 </span>                :<span class="lineCov">          1 :   swapLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.01, 1.99, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.02, 2.01, 25, 26, QgsWkbTypes::PointZM ) );</span></a>
<a name="16778"><span class="lineNum">   16778 </span>                :<span class="lineCov">          1 :   swapCollect.addGeometry( swapLine.clone() );</span></a>
<a name="16779"><span class="lineNum">   16779 </span>                :<span class="lineCov">          1 :   swapCollect.swapXy();</span></a>
<a name="16780"><span class="lineNum">   16780 </span>                :<span class="lineCov">          2 :   QCOMPARE( swapCollect.asWkt( 2 ), QStringLiteral( &quot;GeometryCollection (LineStringZM (11 2 3 4, 11 12 13 14, 111 12 23 24),LineStringZM (2 11 5 6, 1.99 11.01 15 16, 2.01 11.02 25 26))&quot; ) );</span></a>
<a name="16781"><span class="lineNum">   16781 </span>                :            : </a>
<a name="16782"><span class="lineNum">   16782 </span>                :            :   // filter vertices</a>
<a name="16783"><span class="lineNum">   16783 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection filterCollect;</span></a>
<a name="16784"><span class="lineNum">   16784 </span>                :<span class="lineCov">          8 :   auto filter = []( const QgsPoint &amp; point )-&gt; bool</span></a>
<a name="16785"><span class="lineNum">   16785 </span>                :            :   {</a>
<a name="16786"><span class="lineNum">   16786 </span>                :<span class="lineCov">          8 :     return point.x() &gt; 5;</span></a>
<a name="16787"><span class="lineNum">   16787 </span>                :            :   };</a>
<a name="16788"><span class="lineNum">   16788 </span>                :<span class="lineCov">          1 :   QgsLineString filterLine;</span></a>
<a name="16789"><span class="lineNum">   16789 </span>                :<span class="lineCov">          1 :   filterCollect.filterVertices( filter ); // no crash</span></a>
<a name="16790"><span class="lineNum">   16790 </span>                :<span class="lineCov">          1 :   filterLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="16791"><span class="lineNum">   16791 </span>                :<span class="lineCov">          1 :   filterCollect.addGeometry( filterLine.clone() );</span></a>
<a name="16792"><span class="lineNum">   16792 </span>                :<span class="lineCov">          1 :   filterCollect.filterVertices( filter );</span></a>
<a name="16793"><span class="lineNum">   16793 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterCollect.asWkt(), QStringLiteral( &quot;GeometryCollection (LineStringZM (11 12 13 14, 111 12 23 24))&quot; ) );</span></a>
<a name="16794"><span class="lineNum">   16794 </span>                :<span class="lineCov">          1 :   filterLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1.01, 1.99, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.02, 2.01, 25, 26, QgsWkbTypes::PointZM ) );</span></a>
<a name="16795"><span class="lineNum">   16795 </span>                :<span class="lineCov">          1 :   filterCollect.addGeometry( filterLine.clone() );</span></a>
<a name="16796"><span class="lineNum">   16796 </span>                :<span class="lineCov">          1 :   filterCollect.filterVertices( filter );</span></a>
<a name="16797"><span class="lineNum">   16797 </span>                :<span class="lineCov">          2 :   QCOMPARE( filterCollect.asWkt( 2 ), QStringLiteral( &quot;GeometryCollection (LineStringZM (11 12 13 14, 111 12 23 24),LineStringZM (11 2 5 6, 11.02 2.01 25 26))&quot; ) );</span></a>
<a name="16798"><span class="lineNum">   16798 </span>                :            : </a>
<a name="16799"><span class="lineNum">   16799 </span>                :            :   // transform vertices</a>
<a name="16800"><span class="lineNum">   16800 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection transformCollect;</span></a>
<a name="16801"><span class="lineNum">   16801 </span>                :<span class="lineCov">          9 :   auto transform = []( const QgsPoint &amp; point )-&gt; QgsPoint</span></a>
<a name="16802"><span class="lineNum">   16802 </span>                :            :   {</a>
<a name="16803"><span class="lineNum">   16803 </span>                :<span class="lineCov">          9 :     return QgsPoint( point.x() + 2, point.y() + 3, point.z() + 4, point.m() + 5 );</span></a>
<a name="16804"><span class="lineNum">   16804 </span>                :            :   };</a>
<a name="16805"><span class="lineNum">   16805 </span>                :<span class="lineCov">          1 :   QgsLineString transformLine;</span></a>
<a name="16806"><span class="lineNum">   16806 </span>                :<span class="lineCov">          1 :   transformCollect.transformVertices( transform ); // no crash</span></a>
<a name="16807"><span class="lineNum">   16807 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="16808"><span class="lineNum">   16808 </span>                :<span class="lineCov">          1 :   transformCollect.addGeometry( transformLine.clone() );</span></a>
<a name="16809"><span class="lineNum">   16809 </span>                :<span class="lineCov">          1 :   transformCollect.transformVertices( transform );</span></a>
<a name="16810"><span class="lineNum">   16810 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCollect.asWkt(), QStringLiteral( &quot;GeometryCollection (LineStringZM (3 5 7 9, 13 15 17 19, 113 15 27 29))&quot; ) );</span></a>
<a name="16811"><span class="lineNum">   16811 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1.01, 1.99, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.02, 2.01, 25, 26, QgsWkbTypes::PointZM ) );</span></a>
<a name="16812"><span class="lineNum">   16812 </span>                :<span class="lineCov">          1 :   transformCollect.addGeometry( transformLine.clone() );</span></a>
<a name="16813"><span class="lineNum">   16813 </span>                :<span class="lineCov">          1 :   transformCollect.transformVertices( transform );</span></a>
<a name="16814"><span class="lineNum">   16814 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCollect.asWkt( 2 ), QStringLiteral( &quot;GeometryCollection (LineStringZM (5 8 11 14, 15 18 21 24, 115 18 31 34),LineStringZM (13 5 9 11, 3.01 4.99 19 21, 13.02 5.01 29 31))&quot; ) );</span></a>
<a name="16815"><span class="lineNum">   16815 </span>                :            : </a>
<a name="16816"><span class="lineNum">   16816 </span>                :            :   // transform using class</a>
<a name="16817"><span class="lineNum">   16817 </span>                :<span class="lineCov">          1 :   TestTransformer transformer;</span></a>
<a name="16818"><span class="lineNum">   16818 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection transformCollect2;</span></a>
<a name="16819"><span class="lineNum">   16819 </span>                :<span class="lineCov">          1 :   transformCollect2.transform( &amp;transformer ); // no crash</span></a>
<a name="16820"><span class="lineNum">   16820 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 1, 2, 3, 4, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11, 12, 13, 14, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 111, 12, 23, 24, QgsWkbTypes::PointZM ) );</span></a>
<a name="16821"><span class="lineNum">   16821 </span>                :<span class="lineCov">          1 :   transformCollect2.addGeometry( transformLine.clone() );</span></a>
<a name="16822"><span class="lineNum">   16822 </span>                :<span class="lineCov">          1 :   QVERIFY( transformCollect2.transform( &amp;transformer ) );</span></a>
<a name="16823"><span class="lineNum">   16823 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCollect2.asWkt(), QStringLiteral( &quot;GeometryCollection (LineStringZM (3 16 8 3, 33 26 18 13, 333 26 28 23))&quot; ) );</span></a>
<a name="16824"><span class="lineNum">   16824 </span>                :<span class="lineCov">          1 :   transformLine.setPoints( QgsPointSequence() &lt;&lt; QgsPoint( 11, 2, 5, 6, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 1.01, 1.99, 15, 16, QgsWkbTypes::PointZM ) &lt;&lt; QgsPoint( 11.02, 2.01, 25, 26, QgsWkbTypes::PointZM ) );</span></a>
<a name="16825"><span class="lineNum">   16825 </span>                :<span class="lineCov">          1 :   transformCollect2.addGeometry( transformLine.clone() );</span></a>
<a name="16826"><span class="lineNum">   16826 </span>                :<span class="lineCov">          1 :   QVERIFY( transformCollect2.transform( &amp;transformer ) );</span></a>
<a name="16827"><span class="lineNum">   16827 </span>                :<span class="lineCov">          2 :   QCOMPARE( transformCollect2.asWkt( 2 ), QStringLiteral( &quot;GeometryCollection (LineStringZM (9 30 13 2, 99 40 23 12, 999 40 33 22),LineStringZM (33 16 10 5, 3.03 15.99 20 15, 33.06 16.01 30 25))&quot; ) );</span></a>
<a name="16828"><span class="lineNum">   16828 </span>                :            : </a>
<a name="16829"><span class="lineNum">   16829 </span>                :<span class="lineCov">          1 :   TestFailTransformer failTransformer;</span></a>
<a name="16830"><span class="lineNum">   16830 </span>                :<span class="lineCov">          1 :   QVERIFY( !transformCollect2.transform( &amp;failTransformer ) );</span></a>
<a name="16831"><span class="lineNum">   16831 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16832"><span class="lineNum">   16832 </span>                :            : </a>
<a name="16833"><span class="lineNum">   16833 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQgsPointXY()</span></a>
<a name="16834"><span class="lineNum">   16834 </span>                :            : {</a>
<a name="16835"><span class="lineNum">   16835 </span>                :<span class="lineCov">          1 :   QgsPointXY point( 1.0, 2.0 );</span></a>
<a name="16836"><span class="lineNum">   16836 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromPointXY( point ) );</span></a>
<a name="16837"><span class="lineNum">   16837 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="16838"><span class="lineNum">   16838 </span>                :<span class="lineCov">          1 :   QgsPointXY resultPoint = result.asPoint();</span></a>
<a name="16839"><span class="lineNum">   16839 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint, point );</span></a>
<a name="16840"><span class="lineNum">   16840 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16841"><span class="lineNum">   16841 </span>                :            : </a>
<a name="16842"><span class="lineNum">   16842 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQPoint()</span></a>
<a name="16843"><span class="lineNum">   16843 </span>                :            : {</a>
<a name="16844"><span class="lineNum">   16844 </span>                :<span class="lineCov">          1 :   QPointF point( 1.0, 2.0 );</span></a>
<a name="16845"><span class="lineNum">   16845 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromQPointF( point ) );</span></a>
<a name="16846"><span class="lineNum">   16846 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="16847"><span class="lineNum">   16847 </span>                :<span class="lineCov">          1 :   QgsPointXY resultPoint = result.asPoint();</span></a>
<a name="16848"><span class="lineNum">   16848 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint.x(), 1.0 );</span></a>
<a name="16849"><span class="lineNum">   16849 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint.y(), 2.0 );</span></a>
<a name="16850"><span class="lineNum">   16850 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16851"><span class="lineNum">   16851 </span>                :            : </a>
<a name="16852"><span class="lineNum">   16852 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQPolygonF()</span></a>
<a name="16853"><span class="lineNum">   16853 </span>                :            : {</a>
<a name="16854"><span class="lineNum">   16854 </span>                :            :   //test with a polyline</a>
<a name="16855"><span class="lineNum">   16855 </span>                :<span class="lineCov">          1 :   QPolygonF polyline;</span></a>
<a name="16856"><span class="lineNum">   16856 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QPointF( 1.0, 2.0 ) &lt;&lt; QPointF( 4.0, 6.0 ) &lt;&lt; QPointF( 4.0, 3.0 ) &lt;&lt; QPointF( 2.0, 2.0 );</span></a>
<a name="16857"><span class="lineNum">   16857 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromQPolygonF( polyline ) );</span></a>
<a name="16858"><span class="lineNum">   16858 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16859"><span class="lineNum">   16859 </span>                :<span class="lineCov">          1 :   QgsPolylineXY resultLine = result.asPolyline();</span></a>
<a name="16860"><span class="lineNum">   16860 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.size(), 4 );</span></a>
<a name="16861"><span class="lineNum">   16861 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 0 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="16862"><span class="lineNum">   16862 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 1 ), QgsPointXY( 4.0, 6.0 ) );</span></a>
<a name="16863"><span class="lineNum">   16863 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 2 ), QgsPointXY( 4.0, 3.0 ) );</span></a>
<a name="16864"><span class="lineNum">   16864 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 3 ), QgsPointXY( 2.0, 2.0 ) );</span></a>
<a name="16865"><span class="lineNum">   16865 </span>                :            : </a>
<a name="16866"><span class="lineNum">   16866 </span>                :            :   //test with a closed polygon</a>
<a name="16867"><span class="lineNum">   16867 </span>                :<span class="lineCov">          1 :   QPolygonF polygon;</span></a>
<a name="16868"><span class="lineNum">   16868 </span>                :<span class="lineCov">          1 :   polygon &lt;&lt; QPointF( 1.0, 2.0 ) &lt;&lt; QPointF( 4.0, 6.0 ) &lt;&lt; QPointF( 4.0, 3.0 ) &lt;&lt; QPointF( 2.0, 2.0 ) &lt;&lt; QPointF( 1.0, 2.0 );</span></a>
<a name="16869"><span class="lineNum">   16869 </span>                :<span class="lineCov">          1 :   QgsGeometry result2( QgsGeometry::fromQPolygonF( polygon ) );</span></a>
<a name="16870"><span class="lineNum">   16870 </span>                :<span class="lineCov">          1 :   QCOMPARE( result2.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="16871"><span class="lineNum">   16871 </span>                :<span class="lineCov">          1 :   QgsPolygonXY resultPolygon = result2.asPolygon();</span></a>
<a name="16872"><span class="lineNum">   16872 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.size(), 1 );</span></a>
<a name="16873"><span class="lineNum">   16873 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 0 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="16874"><span class="lineNum">   16874 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 1 ), QgsPointXY( 4.0, 6.0 ) );</span></a>
<a name="16875"><span class="lineNum">   16875 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 2 ), QgsPointXY( 4.0, 3.0 ) );</span></a>
<a name="16876"><span class="lineNum">   16876 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 3 ), QgsPointXY( 2.0, 2.0 ) );</span></a>
<a name="16877"><span class="lineNum">   16877 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 4 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="16878"><span class="lineNum">   16878 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16879"><span class="lineNum">   16879 </span>                :            : </a>
<a name="16880"><span class="lineNum">   16880 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromPolyline()</span></a>
<a name="16881"><span class="lineNum">   16881 </span>                :            : {</a>
<a name="16882"><span class="lineNum">   16882 </span>                :<span class="lineCov">          1 :   QgsPolyline polyline;</span></a>
<a name="16883"><span class="lineNum">   16883 </span>                :<span class="lineCov">          1 :   QgsGeometry fromPolyline = QgsGeometry::fromPolyline( polyline );</span></a>
<a name="16884"><span class="lineNum">   16884 </span>                :<span class="lineCov">          1 :   QVERIFY( fromPolyline.isEmpty() );</span></a>
<a name="16885"><span class="lineNum">   16885 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPolyline.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="16886"><span class="lineNum">   16886 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QgsPoint( 10, 20 ) &lt;&lt; QgsPoint( 30, 40 );</span></a>
<a name="16887"><span class="lineNum">   16887 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polyline );</span></a>
<a name="16888"><span class="lineNum">   16888 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineString (10 20, 30 40)&quot; ) );</span></a>
<a name="16889"><span class="lineNum">   16889 </span>                :<span class="lineCov">          1 :   QgsPolyline polyline3d;</span></a>
<a name="16890"><span class="lineNum">   16890 </span>                :<span class="lineCov">          1 :   polyline3d &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 40, 200 );</span></a>
<a name="16891"><span class="lineNum">   16891 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polyline3d );</span></a>
<a name="16892"><span class="lineNum">   16892 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringZ (10 20 100, 30 40 200)&quot; ) );</span></a>
<a name="16893"><span class="lineNum">   16893 </span>                :<span class="lineCov">          1 :   QgsPolyline polylineM;</span></a>
<a name="16894"><span class="lineNum">   16894 </span>                :<span class="lineCov">          1 :   polylineM &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 20, 0, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 30, 40, 0, 200 );</span></a>
<a name="16895"><span class="lineNum">   16895 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polylineM );</span></a>
<a name="16896"><span class="lineNum">   16896 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringM (10 20 100, 30 40 200)&quot; ) );</span></a>
<a name="16897"><span class="lineNum">   16897 </span>                :<span class="lineCov">          1 :   QgsPolyline polylineZM;</span></a>
<a name="16898"><span class="lineNum">   16898 </span>                :<span class="lineCov">          1 :   polylineZM &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 20, 4, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 30, 40, 5, 200 );</span></a>
<a name="16899"><span class="lineNum">   16899 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polylineZM );</span></a>
<a name="16900"><span class="lineNum">   16900 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringZM (10 20 4 100, 30 40 5 200)&quot; ) );</span></a>
<a name="16901"><span class="lineNum">   16901 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16902"><span class="lineNum">   16902 </span>                :            : </a>
<a name="16903"><span class="lineNum">   16903 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asQPointF()</span></a>
<a name="16904"><span class="lineNum">   16904 </span>                :            : {</a>
<a name="16905"><span class="lineNum">   16905 </span>                :<span class="lineCov">          1 :   QPointF point( 1.0, 2.0 );</span></a>
<a name="16906"><span class="lineNum">   16906 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromQPointF( point ) );</span></a>
<a name="16907"><span class="lineNum">   16907 </span>                :<span class="lineCov">          1 :   QPointF resultPoint = geom.asQPointF();</span></a>
<a name="16908"><span class="lineNum">   16908 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint, point );</span></a>
<a name="16909"><span class="lineNum">   16909 </span>                :            : </a>
<a name="16910"><span class="lineNum">   16910 </span>                :            :   //non point geom</a>
<a name="16911"><span class="lineNum">   16911 </span>                :<span class="lineCov">          1 :   QPointF badPoint = mpPolygonGeometryA.asQPointF();</span></a>
<a name="16912"><span class="lineNum">   16912 </span>                :<span class="lineCov">          1 :   QVERIFY( badPoint.isNull() );</span></a>
<a name="16913"><span class="lineNum">   16913 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16914"><span class="lineNum">   16914 </span>                :            : </a>
<a name="16915"><span class="lineNum">   16915 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asQPolygonF()</span></a>
<a name="16916"><span class="lineNum">   16916 </span>                :            : {</a>
<a name="16917"><span class="lineNum">   16917 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="16918"><span class="lineNum">   16918 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="16919"><span class="lineNum">   16919 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="16920"><span class="lineNum">   16920 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="16921"><span class="lineNum">   16921 </span>                :            : </a>
<a name="16922"><span class="lineNum">   16922 </span>                :<span class="lineCov">          1 :   QgsGeometry polygonGeometryA = QgsGeometry::fromPolygonXY( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point4 &lt;&lt; point1 ) );</span></a>
<a name="16923"><span class="lineNum">   16923 </span>                :            : </a>
<a name="16924"><span class="lineNum">   16924 </span>                :            :   //test polygon</a>
<a name="16925"><span class="lineNum">   16925 </span>                :<span class="lineCov">          1 :   QPolygonF fromPoly = polygonGeometryA.asQPolygonF();</span></a>
<a name="16926"><span class="lineNum">   16926 </span>                :<span class="lineCov">          1 :   QVERIFY( fromPoly.isClosed() );</span></a>
<a name="16927"><span class="lineNum">   16927 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.size(), 5 );</span></a>
<a name="16928"><span class="lineNum">   16928 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 0 ).x(), point1.x() );</span></a>
<a name="16929"><span class="lineNum">   16929 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 0 ).y(), point1.y() );</span></a>
<a name="16930"><span class="lineNum">   16930 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 1 ).x(), point2.x() );</span></a>
<a name="16931"><span class="lineNum">   16931 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 1 ).y(), point2.y() );</span></a>
<a name="16932"><span class="lineNum">   16932 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 2 ).x(), point3.x() );</span></a>
<a name="16933"><span class="lineNum">   16933 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 2 ).y(), point3.y() );</span></a>
<a name="16934"><span class="lineNum">   16934 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 3 ).x(), point4.x() );</span></a>
<a name="16935"><span class="lineNum">   16935 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 3 ).y(), point4.y() );</span></a>
<a name="16936"><span class="lineNum">   16936 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 4 ).x(), point1.x() );</span></a>
<a name="16937"><span class="lineNum">   16937 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 4 ).y(), point1.y() );</span></a>
<a name="16938"><span class="lineNum">   16938 </span>                :            : </a>
<a name="16939"><span class="lineNum">   16939 </span>                :            :   //test polyline</a>
<a name="16940"><span class="lineNum">   16940 </span>                :<span class="lineCov">          1 :   QgsPolylineXY testline;</span></a>
<a name="16941"><span class="lineNum">   16941 </span>                :<span class="lineCov">          1 :   testline &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="16942"><span class="lineNum">   16942 </span>                :<span class="lineCov">          1 :   QgsGeometry lineGeom( QgsGeometry::fromPolylineXY( testline ) );</span></a>
<a name="16943"><span class="lineNum">   16943 </span>                :<span class="lineCov">          1 :   QPolygonF fromLine = lineGeom.asQPolygonF();</span></a>
<a name="16944"><span class="lineNum">   16944 </span>                :<span class="lineCov">          1 :   QVERIFY( !fromLine.isClosed() );</span></a>
<a name="16945"><span class="lineNum">   16945 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.size(), 3 );</span></a>
<a name="16946"><span class="lineNum">   16946 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 0 ).x(), point1.x() );</span></a>
<a name="16947"><span class="lineNum">   16947 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 0 ).y(), point1.y() );</span></a>
<a name="16948"><span class="lineNum">   16948 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 1 ).x(), point2.x() );</span></a>
<a name="16949"><span class="lineNum">   16949 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 1 ).y(), point2.y() );</span></a>
<a name="16950"><span class="lineNum">   16950 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 2 ).x(), point3.x() );</span></a>
<a name="16951"><span class="lineNum">   16951 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 2 ).y(), point3.y() );</span></a>
<a name="16952"><span class="lineNum">   16952 </span>                :            : </a>
<a name="16953"><span class="lineNum">   16953 </span>                :            :   //test a bad geometry</a>
<a name="16954"><span class="lineNum">   16954 </span>                :<span class="lineCov">          1 :   QgsGeometry badGeom( QgsGeometry::fromPointXY( point1 ) );</span></a>
<a name="16955"><span class="lineNum">   16955 </span>                :<span class="lineCov">          1 :   QPolygonF fromBad = badGeom.asQPolygonF();</span></a>
<a name="16956"><span class="lineNum">   16956 </span>                :<span class="lineCov">          1 :   QVERIFY( fromBad.isEmpty() );</span></a>
<a name="16957"><span class="lineNum">   16957 </span>                :            : </a>
<a name="16958"><span class="lineNum">   16958 </span>                :            :   // test a multipolygon</a>
<a name="16959"><span class="lineNum">   16959 </span>                :<span class="lineCov">          2 :   QPolygonF res = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; ) ).asQPolygonF();</span></a>
<a name="16960"><span class="lineNum">   16960 </span>                :<span class="lineCov">          1 :   QVERIFY( res.isClosed() );</span></a>
<a name="16961"><span class="lineNum">   16961 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.size(), 5 );</span></a>
<a name="16962"><span class="lineNum">   16962 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).x(), 0.0 );</span></a>
<a name="16963"><span class="lineNum">   16963 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).y(), 0.0 );</span></a>
<a name="16964"><span class="lineNum">   16964 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).x(), 10.0 );</span></a>
<a name="16965"><span class="lineNum">   16965 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).y(), 0.0 );</span></a>
<a name="16966"><span class="lineNum">   16966 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).x(), 10.0 );</span></a>
<a name="16967"><span class="lineNum">   16967 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).y(), 10.0 );</span></a>
<a name="16968"><span class="lineNum">   16968 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).x(), 0.0 );</span></a>
<a name="16969"><span class="lineNum">   16969 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).y(), 10.0 );</span></a>
<a name="16970"><span class="lineNum">   16970 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 4 ).x(), 0.0 );</span></a>
<a name="16971"><span class="lineNum">   16971 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 4 ).y(), 0.0 );</span></a>
<a name="16972"><span class="lineNum">   16972 </span>                :            : </a>
<a name="16973"><span class="lineNum">   16973 </span>                :            :   // test a multilinestring</a>
<a name="16974"><span class="lineNum">   16974 </span>                :<span class="lineCov">          2 :   res = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiLineString((0 0, 10 0, 10 10, 0 10 ),(2 2, 4 2, 4 4, 2 4))&quot; ) ).asQPolygonF();</span></a>
<a name="16975"><span class="lineNum">   16975 </span>                :<span class="lineCov">          1 :   QVERIFY( !res.isClosed() );</span></a>
<a name="16976"><span class="lineNum">   16976 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.size(), 4 );</span></a>
<a name="16977"><span class="lineNum">   16977 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).x(), 0.0 );</span></a>
<a name="16978"><span class="lineNum">   16978 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).y(), 0.0 );</span></a>
<a name="16979"><span class="lineNum">   16979 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).x(), 10.0 );</span></a>
<a name="16980"><span class="lineNum">   16980 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).y(), 0.0 );</span></a>
<a name="16981"><span class="lineNum">   16981 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).x(), 10.0 );</span></a>
<a name="16982"><span class="lineNum">   16982 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).y(), 10.0 );</span></a>
<a name="16983"><span class="lineNum">   16983 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).x(), 0.0 );</span></a>
<a name="16984"><span class="lineNum">   16984 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).y(), 10.0 );</span></a>
<a name="16985"><span class="lineNum">   16985 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="16986"><span class="lineNum">   16986 </span>                :            : </a>
<a name="16987"><span class="lineNum">   16987 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::comparePolylines()</span></a>
<a name="16988"><span class="lineNum">   16988 </span>                :            : {</a>
<a name="16989"><span class="lineNum">   16989 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="16990"><span class="lineNum">   16990 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="16991"><span class="lineNum">   16991 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="16992"><span class="lineNum">   16992 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="16993"><span class="lineNum">   16993 </span>                :<span class="lineCov">          1 :   QgsPointXY pointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="16994"><span class="lineNum">   16994 </span>                :            : </a>
<a name="16995"><span class="lineNum">   16995 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line1;</span></a>
<a name="16996"><span class="lineNum">   16996 </span>                :<span class="lineCov">          1 :   line1 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="16997"><span class="lineNum">   16997 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line2;</span></a>
<a name="16998"><span class="lineNum">   16998 </span>                :<span class="lineCov">          1 :   line2 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="16999"><span class="lineNum">   16999 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line1, line2 ) );</span></a>
<a name="17000"><span class="lineNum">   17000 </span>                :            : </a>
<a name="17001"><span class="lineNum">   17001 </span>                :            :   //different number of nodes</a>
<a name="17002"><span class="lineNum">   17002 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line3;</span></a>
<a name="17003"><span class="lineNum">   17003 </span>                :<span class="lineCov">          1 :   line3 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point4;</span></a>
<a name="17004"><span class="lineNum">   17004 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( line1, line3 ) );</span></a>
<a name="17005"><span class="lineNum">   17005 </span>                :            : </a>
<a name="17006"><span class="lineNum">   17006 </span>                :            :   //different nodes</a>
<a name="17007"><span class="lineNum">   17007 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line4;</span></a>
<a name="17008"><span class="lineNum">   17008 </span>                :<span class="lineCov">          1 :   line3 &lt;&lt; point1 &lt;&lt; pointA &lt;&lt; point3 &lt;&lt; point4;</span></a>
<a name="17009"><span class="lineNum">   17009 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( line3, line4 ) );</span></a>
<a name="17010"><span class="lineNum">   17010 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17011"><span class="lineNum">   17011 </span>                :            : </a>
<a name="17012"><span class="lineNum">   17012 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::comparePolygons()</span></a>
<a name="17013"><span class="lineNum">   17013 </span>                :            : {</a>
<a name="17014"><span class="lineNum">   17014 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="17015"><span class="lineNum">   17015 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="17016"><span class="lineNum">   17016 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="17017"><span class="lineNum">   17017 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="17018"><span class="lineNum">   17018 </span>                :<span class="lineCov">          1 :   QgsPointXY pointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="17019"><span class="lineNum">   17019 </span>                :<span class="lineCov">          1 :   QgsPointXY pointB = QgsPointXY( 100.0, 40.0 );</span></a>
<a name="17020"><span class="lineNum">   17020 </span>                :            : </a>
<a name="17021"><span class="lineNum">   17021 </span>                :<span class="lineCov">          1 :   QgsPolylineXY ring1;</span></a>
<a name="17022"><span class="lineNum">   17022 </span>                :<span class="lineCov">          1 :   ring1 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point1;</span></a>
<a name="17023"><span class="lineNum">   17023 </span>                :<span class="lineCov">          1 :   QgsPolylineXY ring2;</span></a>
<a name="17024"><span class="lineNum">   17024 </span>                :<span class="lineCov">          1 :   ring2 &lt;&lt; point4 &lt;&lt; pointA &lt;&lt; pointB &lt;&lt; point4;</span></a>
<a name="17025"><span class="lineNum">   17025 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly1;</span></a>
<a name="17026"><span class="lineNum">   17026 </span>                :<span class="lineCov">          1 :   poly1 &lt;&lt; ring1 &lt;&lt; ring2;</span></a>
<a name="17027"><span class="lineNum">   17027 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly2;</span></a>
<a name="17028"><span class="lineNum">   17028 </span>                :<span class="lineCov">          1 :   poly2 &lt;&lt; ring1 &lt;&lt; ring2;</span></a>
<a name="17029"><span class="lineNum">   17029 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly1, poly2 ) );</span></a>
<a name="17030"><span class="lineNum">   17030 </span>                :            : </a>
<a name="17031"><span class="lineNum">   17031 </span>                :            :   //different number of rings</a>
<a name="17032"><span class="lineNum">   17032 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly3;</span></a>
<a name="17033"><span class="lineNum">   17033 </span>                :<span class="lineCov">          1 :   poly3 &lt;&lt; ring1;</span></a>
<a name="17034"><span class="lineNum">   17034 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( poly1, poly3 ) );</span></a>
<a name="17035"><span class="lineNum">   17035 </span>                :            : </a>
<a name="17036"><span class="lineNum">   17036 </span>                :            :   //different rings</a>
<a name="17037"><span class="lineNum">   17037 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly4;</span></a>
<a name="17038"><span class="lineNum">   17038 </span>                :<span class="lineCov">          1 :   poly4 &lt;&lt; ring2;</span></a>
<a name="17039"><span class="lineNum">   17039 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( poly3, poly4 ) );</span></a>
<a name="17040"><span class="lineNum">   17040 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17041"><span class="lineNum">   17041 </span>                :            : </a>
<a name="17042"><span class="lineNum">   17042 </span>                :            : #if defined(__clang__) || defined(__GNUG__)</a>
<a name="17043"><span class="lineNum">   17043 </span>                :            : #include &lt;cxxabi.h&gt;</a>
<a name="17044"><span class="lineNum">   17044 </span>                :            : #include &lt;ctime&gt;</a>
<a name="17045"><span class="lineNum">   17045 </span>                :            : </a>
<a name="17046"><span class="lineNum">   17046 </span>                :<span class="lineCov">       1392 : QString generateSpacesString( int numberOfSpace )</span></a>
<a name="17047"><span class="lineNum">   17047 </span>                :            : {</a>
<a name="17048"><span class="lineNum">   17048 </span>                :<span class="lineCov">       1392 :   QStringList spaces;</span></a>
<a name="17049"><span class="lineNum">   17049 </span>                :<span class="lineCov">       1392 :   spaces &lt;&lt; QString( &quot; &quot; ) &lt;&lt; QString( &quot;\t&quot; ) &lt;&lt; QString( &quot;\n&quot; ) &lt;&lt; QString( &quot;\r&quot; );</span></a>
<a name="17050"><span class="lineNum">   17050 </span>                :            : </a>
<a name="17051"><span class="lineNum">   17051 </span>                :<span class="lineCov">       1392 :   QString ret;</span></a>
<a name="17052"><span class="lineNum">   17052 </span>                :<span class="lineCov">       7872 :   for ( int i = 0; i &lt; numberOfSpace; ++i )</span></a>
<a name="17053"><span class="lineNum">   17053 </span>                :            :   {</a>
<a name="17054"><span class="lineNum">   17054 </span>                :<span class="lineCov">       6480 :     int r = rand() % ( spaces.count() );</span></a>
<a name="17055"><span class="lineNum">   17055 </span>                :<span class="lineCov">       6480 :     ret += spaces.at( r );</span></a>
<a name="17056"><span class="lineNum">   17056 </span>                :<span class="lineCov">       6480 :   }</span></a>
<a name="17057"><span class="lineNum">   17057 </span>                :<span class="lineCov">       1392 :   return ret;</span></a>
<a name="17058"><span class="lineNum">   17058 </span>                :<span class="lineCov">       1392 : }</span></a>
<a name="17059"><span class="lineNum">   17059 </span>                :            : </a>
<a name="17060"><span class="lineNum">   17060 </span>                :            : #endif</a>
<a name="17061"><span class="lineNum">   17061 </span>                :            : // Helper function (in anonymous namespace to prevent possible link with the extirior)</a>
<a name="17062"><span class="lineNum">   17062 </span>                :            : namespace</a>
<a name="17063"><span class="lineNum">   17063 </span>                :            : {</a>
<a name="17064"><span class="lineNum">   17064 </span>                :            :   template&lt;typename T&gt;</a>
<a name="17065"><span class="lineNum">   17065 </span>                :<span class="lineCov">         12 :   inline void testCreateEmptyWithSameType()</span></a>
<a name="17066"><span class="lineNum">   17066 </span>                :            :   {</a>
<a name="17067"><span class="lineNum">   17067 </span>                :<span class="lineCov">         12 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; geom { new T() };</span></a>
<a name="17068"><span class="lineNum">   17068 </span>                :<span class="lineCov">         12 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; created { TestQgsGeometry::createEmpty( geom.get() ) };</span></a>
<a name="17069"><span class="lineNum">   17069 </span>                :<span class="lineCov">         12 :     QVERIFY( created-&gt;isEmpty() );</span></a>
<a name="17070"><span class="lineNum">   17070 </span>                :            : #if defined(__clang__) || defined(__GNUG__)</a>
<a name="17071"><span class="lineNum">   17071 </span>                :<span class="lineCov">         12 :     srand( ( unsigned )time( NULL ) );</span></a>
<a name="17072"><span class="lineNum">   17072 </span>                :            : </a>
<a name="17073"><span class="lineNum">   17073 </span>                :<span class="lineCov">         12 :     const std::type_info  &amp;ti = typeid( T );</span></a>
<a name="17074"><span class="lineNum">   17074 </span>                :            :     int status;</a>
<a name="17075"><span class="lineNum">   17075 </span>                :<span class="lineCov">         12 :     char *realname = abi::__cxa_demangle( ti.name(), 0, 0, &amp;status );</span></a>
<a name="17076"><span class="lineNum">   17076 </span>                :            : </a>
<a name="17077"><span class="lineNum">   17077 </span>                :<span class="lineCov">         12 :     QString type = realname;</span></a>
<a name="17078"><span class="lineNum">   17078 </span>                :            : // remove Qgs prefix</a>
<a name="17079"><span class="lineNum">   17079 </span>                :<span class="lineCov">         12 :     type = type.right( type.count() - 3 );</span></a>
<a name="17080"><span class="lineNum">   17080 </span>                :<span class="lineCov">         12 :     QStringList extensionZM;</span></a>
<a name="17081"><span class="lineNum">   17081 </span>                :<span class="lineCov">         12 :     extensionZM &lt;&lt; QString() &lt;&lt; QString( &quot;Z&quot; ) &lt;&lt; QString( &quot;M&quot; ) &lt;&lt; QString( &quot;ZM&quot; );</span></a>
<a name="17082"><span class="lineNum">   17082 </span>                :<span class="lineCov">         60 :     for ( QString ext : extensionZM )</span></a>
<a name="17083"><span class="lineNum">   17083 </span>                :            :     {</a>
<a name="17084"><span class="lineNum">   17084 </span>                :<span class="lineCov">         48 :       QString wkt = type + ext;</span></a>
<a name="17085"><span class="lineNum">   17085 </span>                :<span class="lineCov">         48 :       QString result = wkt + QLatin1String( &quot; EMPTY&quot; );</span></a>
<a name="17086"><span class="lineNum">   17086 </span>                :            : </a>
<a name="17087"><span class="lineNum">   17087 </span>                :<span class="lineCov">         48 :       QStringList emptyStringList;</span></a>
<a name="17088"><span class="lineNum">   17088 </span>                :<span class="lineCov">         48 :       emptyStringList &lt;&lt; QString( &quot;EMPTY&quot; ) &lt;&lt; QString( &quot;Empty&quot; ) &lt;&lt; QString( &quot;empty&quot; ) &lt;&lt; QString( &quot;EmptY&quot; ) &lt;&lt; QString( &quot;EmPtY&quot; );</span></a>
<a name="17089"><span class="lineNum">   17089 </span>                :<span class="lineCov">        528 :       for ( int i = 0 ; i &lt; 10 ; ++i )</span></a>
<a name="17090"><span class="lineNum">   17090 </span>                :            :       {</a>
<a name="17091"><span class="lineNum">   17091 </span>                :<span class="lineCov">        480 :         QString spacesBefore = generateSpacesString( i );</span></a>
<a name="17092"><span class="lineNum">   17092 </span>                :<span class="lineCov">        528 :         QString spacesMiddle = i == 0 ? QStringLiteral( &quot; &quot; ) : generateSpacesString( i );</span></a>
<a name="17093"><span class="lineNum">   17093 </span>                :<span class="lineCov">        480 :         QString spacesAfter = generateSpacesString( i );</span></a>
<a name="17094"><span class="lineNum">   17094 </span>                :<span class="lineCov">       2880 :         for ( int j = 0; j &lt; emptyStringList.count() ; ++j )</span></a>
<a name="17095"><span class="lineNum">   17095 </span>                :            :         {</a>
<a name="17096"><span class="lineNum">   17096 </span>                :<span class="lineCov">       2400 :           QString generatedWkt = spacesBefore + wkt + spacesMiddle + emptyStringList.at( j ) + spacesAfter;</span></a>
<a name="17097"><span class="lineNum">   17097 </span>                :            : </a>
<a name="17098"><span class="lineNum">   17098 </span>                :<span class="lineCov">       2400 :           QgsGeometry gWkt = QgsGeometry().fromWkt( generatedWkt );</span></a>
<a name="17099"><span class="lineNum">   17099 </span>                :<span class="lineCov">       2400 :           QVERIFY( gWkt.asWkt().compare( result, Qt::CaseInsensitive ) == 0 );</span></a>
<a name="17100"><span class="lineNum">   17100 </span>                :            : </a>
<a name="17101"><span class="lineNum">   17101 </span>                :<span class="lineCov">       2400 :           QVERIFY( geom-&gt;fromWkt( generatedWkt ) );</span></a>
<a name="17102"><span class="lineNum">   17102 </span>                :<span class="lineCov">       2400 :           QVERIFY( geom-&gt;asWkt().compare( result, Qt::CaseInsensitive ) == 0 );</span></a>
<a name="17103"><span class="lineNum">   17103 </span>                :<span class="lineCov">       2400 :         }</span></a>
<a name="17104"><span class="lineNum">   17104 </span>                :<span class="lineCov">        480 :       }</span></a>
<a name="17105"><span class="lineNum">   17105 </span>                :<span class="lineCov">         48 :     }</span></a>
<a name="17106"><span class="lineNum">   17106 </span>                :<span class="lineCov">         12 :     free( realname );</span></a>
<a name="17107"><span class="lineNum">   17107 </span>                :            : #endif</a>
<a name="17108"><span class="lineNum">   17108 </span>                :            : </a>
<a name="17109"><span class="lineNum">   17109 </span>                :            : </a>
<a name="17110"><span class="lineNum">   17110 </span>                :            :     // Check that it is the correct type</a>
<a name="17111"><span class="lineNum">   17111 </span>                :<span class="lineCov">         12 :     QVERIFY( static_cast&lt;T *&gt;( created.get() ) != nullptr );</span></a>
<a name="17112"><span class="lineNum">   17112 </span>                :<span class="lineCov">         12 :   }</span></a>
<a name="17113"><span class="lineNum">   17113 </span>                :            : }</a>
<a name="17114"><span class="lineNum">   17114 </span>                :            : </a>
<a name="17115"><span class="lineNum">   17115 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::createEmptyWithSameType()</span></a>
<a name="17116"><span class="lineNum">   17116 </span>                :            : {</a>
<a name="17117"><span class="lineNum">   17117 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCircularString&gt;();</span></a>
<a name="17118"><span class="lineNum">   17118 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCompoundCurve&gt;();</span></a>
<a name="17119"><span class="lineNum">   17119 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsLineString&gt;();</span></a>
<a name="17120"><span class="lineNum">   17120 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsGeometryCollection&gt;();</span></a>
<a name="17121"><span class="lineNum">   17121 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiCurve&gt;();</span></a>
<a name="17122"><span class="lineNum">   17122 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiLineString&gt;();</span></a>
<a name="17123"><span class="lineNum">   17123 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiPoint&gt;();</span></a>
<a name="17124"><span class="lineNum">   17124 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiSurface&gt;();</span></a>
<a name="17125"><span class="lineNum">   17125 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsPoint&gt;();</span></a>
<a name="17126"><span class="lineNum">   17126 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCurvePolygon&gt;();</span></a>
<a name="17127"><span class="lineNum">   17127 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsPolygon&gt;();</span></a>
<a name="17128"><span class="lineNum">   17128 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsTriangle&gt;();</span></a>
<a name="17129"><span class="lineNum">   17129 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17130"><span class="lineNum">   17130 </span>                :            : </a>
<a name="17131"><span class="lineNum">   17131 </span>                :            : </a>
<a name="17132"><span class="lineNum">   17132 </span>                :            : // MK, Disabled 14.11.2014</a>
<a name="17133"><span class="lineNum">   17133 </span>                :            : // Too unclear what exactly should be tested and which variations are allowed for the line</a>
<a name="17134"><span class="lineNum">   17134 </span>                :            : #if 0</a>
<a name="17135"><span class="lineNum">   17135 </span>                :            : void TestQgsGeometry::simplifyCheck1()</a>
<a name="17136"><span class="lineNum">   17136 </span>                :            : {</a>
<a name="17137"><span class="lineNum">   17137 </span>                :            :   initPainterTest();</a>
<a name="17138"><span class="lineNum">   17138 </span>                :            :   QVERIFY( mpPolylineGeometryD-&gt;simplify( 0.5 ) );</a>
<a name="17139"><span class="lineNum">   17139 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="17140"><span class="lineNum">   17140 </span>                :            :   QgsGeometry *mypSimplifyGeometry  =  mpPolylineGeometryD-&gt;simplify( 0.5 );</a>
<a name="17141"><span class="lineNum">   17141 </span>                :            :   qDebug( &quot;Geometry Type: %s&quot;, QgsWkbTypes::displayString( mypSimplifyGeometry-&gt;wkbType() ) );</a>
<a name="17142"><span class="lineNum">   17142 </span>                :            :   QVERIFY( mypSimplifyGeometry-&gt;wkbType() == QgsWkbTypes::LineString );</a>
<a name="17143"><span class="lineNum">   17143 </span>                :            :   QgsPolyline myLine = mypSimplifyGeometry-&gt;asPolyline();</a>
<a name="17144"><span class="lineNum">   17144 </span>                :            :   QVERIFY( myLine.size() &gt; 0 ); //check that the union created a feature</a>
<a name="17145"><span class="lineNum">   17145 </span>                :            :   dumpPolyline( myLine );</a>
<a name="17146"><span class="lineNum">   17146 </span>                :            :   delete mypSimplifyGeometry;</a>
<a name="17147"><span class="lineNum">   17147 </span>                :            :   QVERIFY( renderCheck( &quot;geometry_simplifyCheck1&quot;, &quot;Checking simplify of line&quot; ) );</a>
<a name="17148"><span class="lineNum">   17148 </span>                :            : }</a>
<a name="17149"><span class="lineNum">   17149 </span>                :            : #endif</a>
<a name="17150"><span class="lineNum">   17150 </span>                :            : </a>
<a name="17151"><span class="lineNum">   17151 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::intersectionCheck1()</span></a>
<a name="17152"><span class="lineNum">   17152 </span>                :            : {</a>
<a name="17153"><span class="lineNum">   17153 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17154"><span class="lineNum">   17154 </span>                :<span class="lineCov">          1 :   QVERIFY( mpPolygonGeometryA.intersects( mpPolygonGeometryB ) );</span></a>
<a name="17155"><span class="lineNum">   17155 </span>                :            : </a>
<a name="17156"><span class="lineNum">   17156 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryEngine &gt; engine( QgsGeometry::createGeometryEngine( mpPolygonGeometryA.constGet() ) );</span></a>
<a name="17157"><span class="lineNum">   17157 </span>                :<span class="lineCov">          1 :   QVERIFY( engine-&gt;intersects( mpPolygonGeometryB.constGet() ) );</span></a>
<a name="17158"><span class="lineNum">   17158 </span>                :<span class="lineCov">          1 :   engine-&gt;prepareGeometry();</span></a>
<a name="17159"><span class="lineNum">   17159 </span>                :<span class="lineCov">          1 :   QVERIFY( engine-&gt;intersects( mpPolygonGeometryB.constGet() ) );</span></a>
<a name="17160"><span class="lineNum">   17160 </span>                :            : </a>
<a name="17161"><span class="lineNum">   17161 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="17162"><span class="lineNum">   17162 </span>                :<span class="lineCov">          1 :   QgsGeometry mypIntersectionGeometry  =  mpPolygonGeometryA.intersection( mpPolygonGeometryB );</span></a>
<a name="17163"><span class="lineNum">   17163 </span>                :<span class="lineCov">          1 :   QVERIFY( mypIntersectionGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="17164"><span class="lineNum">   17164 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypIntersectionGeometry.asPolygon();</span></a>
<a name="17165"><span class="lineNum">   17165 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="17166"><span class="lineNum">   17166 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="17167"><span class="lineNum">   17167 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_intersectionCheck1&quot;, &quot;Checking if A intersects B&quot; ) );</span></a>
<a name="17168"><span class="lineNum">   17168 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17169"><span class="lineNum">   17169 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::intersectionCheck2()</span></a>
<a name="17170"><span class="lineNum">   17170 </span>                :            : {</a>
<a name="17171"><span class="lineNum">   17171 </span>                :<span class="lineCov">          1 :   QVERIFY( !mpPolygonGeometryA.intersects( mpPolygonGeometryC ) );</span></a>
<a name="17172"><span class="lineNum">   17172 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17173"><span class="lineNum">   17173 </span>                :            : </a>
<a name="17174"><span class="lineNum">   17174 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::translateCheck1()</span></a>
<a name="17175"><span class="lineNum">   17175 </span>                :            : {</a>
<a name="17176"><span class="lineNum">   17176 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;LineString (0 0, 10 0, 10 10)&quot; );</span></a>
<a name="17177"><span class="lineNum">   17177 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="17178"><span class="lineNum">   17178 </span>                :<span class="lineCov">          1 :   geom.translate( 10, -5 );</span></a>
<a name="17179"><span class="lineNum">   17179 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asWkt();</span></a>
<a name="17180"><span class="lineNum">   17180 </span>                :<span class="lineCov">          2 :   QString expected = QStringLiteral( &quot;LineString (10 -5, 20 -5, 20 5)&quot; );</span></a>
<a name="17181"><span class="lineNum">   17181 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17182"><span class="lineNum">   17182 </span>                :<span class="lineCov">          1 :   geom.translate( -10, 5 );</span></a>
<a name="17183"><span class="lineNum">   17183 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17184"><span class="lineNum">   17184 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17185"><span class="lineNum">   17185 </span>                :            : </a>
<a name="17186"><span class="lineNum">   17186 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((-2 4, -2 -10, 2 3, -2 4),(1 1, -1 1, -1 -1, 1 1))&quot; );</span></a>
<a name="17187"><span class="lineNum">   17187 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17188"><span class="lineNum">   17188 </span>                :<span class="lineCov">          1 :   geom.translate( -2, 10 );</span></a>
<a name="17189"><span class="lineNum">   17189 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17190"><span class="lineNum">   17190 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Polygon ((-4 14, -4 0, 0 13, -4 14),(-1 11, -3 11, -3 9, -1 11))&quot; );</span></a>
<a name="17191"><span class="lineNum">   17191 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17192"><span class="lineNum">   17192 </span>                :<span class="lineCov">          1 :   geom.translate( 2, -10 );</span></a>
<a name="17193"><span class="lineNum">   17193 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17194"><span class="lineNum">   17194 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17195"><span class="lineNum">   17195 </span>                :            : </a>
<a name="17196"><span class="lineNum">   17196 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="17197"><span class="lineNum">   17197 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17198"><span class="lineNum">   17198 </span>                :<span class="lineCov">          1 :   geom.translate( -2, 10 );</span></a>
<a name="17199"><span class="lineNum">   17199 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17200"><span class="lineNum">   17200 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (38 60)&quot; );</span></a>
<a name="17201"><span class="lineNum">   17201 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17202"><span class="lineNum">   17202 </span>                :<span class="lineCov">          1 :   geom.translate( 2, -10 );</span></a>
<a name="17203"><span class="lineNum">   17203 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17204"><span class="lineNum">   17204 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17205"><span class="lineNum">   17205 </span>                :            : </a>
<a name="17206"><span class="lineNum">   17206 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17207"><span class="lineNum">   17207 </span>                :            : </a>
<a name="17208"><span class="lineNum">   17208 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::rotateCheck1()</span></a>
<a name="17209"><span class="lineNum">   17209 </span>                :            : {</a>
<a name="17210"><span class="lineNum">   17210 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;LineString (0 0, 10 0, 10 10)&quot; );</span></a>
<a name="17211"><span class="lineNum">   17211 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="17212"><span class="lineNum">   17212 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17213"><span class="lineNum">   17213 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asWkt();</span></a>
<a name="17214"><span class="lineNum">   17214 </span>                :<span class="lineCov">          2 :   QString expected = QStringLiteral( &quot;LineString (0 0, 0 -10, 10 -10)&quot; );</span></a>
<a name="17215"><span class="lineNum">   17215 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17216"><span class="lineNum">   17216 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17217"><span class="lineNum">   17217 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17218"><span class="lineNum">   17218 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17219"><span class="lineNum">   17219 </span>                :            : </a>
<a name="17220"><span class="lineNum">   17220 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((-2 4, -2 -10, 2 3, -2 4),(1 1, -1 1, -1 -1, 1 1))&quot; );</span></a>
<a name="17221"><span class="lineNum">   17221 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17222"><span class="lineNum">   17222 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17223"><span class="lineNum">   17223 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17224"><span class="lineNum">   17224 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Polygon ((4 2, -10 2, 3 -2, 4 2),(1 -1, 1 1, -1 1, 1 -1))&quot; );</span></a>
<a name="17225"><span class="lineNum">   17225 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17226"><span class="lineNum">   17226 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17227"><span class="lineNum">   17227 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17228"><span class="lineNum">   17228 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17229"><span class="lineNum">   17229 </span>                :            : </a>
<a name="17230"><span class="lineNum">   17230 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="17231"><span class="lineNum">   17231 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17232"><span class="lineNum">   17232 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17233"><span class="lineNum">   17233 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17234"><span class="lineNum">   17234 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (50 -40)&quot; );</span></a>
<a name="17235"><span class="lineNum">   17235 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17236"><span class="lineNum">   17236 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="17237"><span class="lineNum">   17237 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17238"><span class="lineNum">   17238 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17239"><span class="lineNum">   17239 </span>                :<span class="lineCov">          1 :   geom.rotate( 180, QgsPointXY( 40, 0 ) );</span></a>
<a name="17240"><span class="lineNum">   17240 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (40 -50)&quot; );</span></a>
<a name="17241"><span class="lineNum">   17241 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17242"><span class="lineNum">   17242 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="17243"><span class="lineNum">   17243 </span>                :<span class="lineCov">          1 :   geom.rotate( 180, QgsPointXY( 40, 0 ) ); // round-trip</span></a>
<a name="17244"><span class="lineNum">   17244 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="17245"><span class="lineNum">   17245 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17246"><span class="lineNum">   17246 </span>                :            : </a>
<a name="17247"><span class="lineNum">   17247 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17248"><span class="lineNum">   17248 </span>                :            : </a>
<a name="17249"><span class="lineNum">   17249 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unionCheck1()</span></a>
<a name="17250"><span class="lineNum">   17250 </span>                :            : {</a>
<a name="17251"><span class="lineNum">   17251 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17252"><span class="lineNum">   17252 </span>                :            :   // should be a multipolygon with 2 parts as A does not intersect C</a>
<a name="17253"><span class="lineNum">   17253 </span>                :<span class="lineCov">          1 :   QgsGeometry mypUnionGeometry  =  mpPolygonGeometryA.combine( mpPolygonGeometryC );</span></a>
<a name="17254"><span class="lineNum">   17254 </span>                :<span class="lineCov">          1 :   QVERIFY( mypUnionGeometry.wkbType() == QgsWkbTypes::MultiPolygon );</span></a>
<a name="17255"><span class="lineNum">   17255 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY myMultiPolygon = mypUnionGeometry.asMultiPolygon();</span></a>
<a name="17256"><span class="lineNum">   17256 </span>                :<span class="lineCov">          1 :   QVERIFY( myMultiPolygon.size() &gt; 0 ); //check that the union did not fail</span></a>
<a name="17257"><span class="lineNum">   17257 </span>                :<span class="lineCov">          1 :   paintMultiPolygon( myMultiPolygon );</span></a>
<a name="17258"><span class="lineNum">   17258 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_unionCheck1&quot;, &quot;Checking A union C produces 2 polys&quot; ) );</span></a>
<a name="17259"><span class="lineNum">   17259 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17260"><span class="lineNum">   17260 </span>                :            : </a>
<a name="17261"><span class="lineNum">   17261 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unionCheck2()</span></a>
<a name="17262"><span class="lineNum">   17262 </span>                :            : {</a>
<a name="17263"><span class="lineNum">   17263 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17264"><span class="lineNum">   17264 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="17265"><span class="lineNum">   17265 </span>                :<span class="lineCov">          1 :   QgsGeometry mypUnionGeometry  =  mpPolygonGeometryA.combine( mpPolygonGeometryB );</span></a>
<a name="17266"><span class="lineNum">   17266 </span>                :<span class="lineCov">          1 :   QVERIFY( mypUnionGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="17267"><span class="lineNum">   17267 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypUnionGeometry.asPolygon();</span></a>
<a name="17268"><span class="lineNum">   17268 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="17269"><span class="lineNum">   17269 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="17270"><span class="lineNum">   17270 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_unionCheck2&quot;, &quot;Checking A union B produces single union poly&quot; ) );</span></a>
<a name="17271"><span class="lineNum">   17271 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17272"><span class="lineNum">   17272 </span>                :            : </a>
<a name="17273"><span class="lineNum">   17273 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::differenceCheck1()</span></a>
<a name="17274"><span class="lineNum">   17274 </span>                :            : {</a>
<a name="17275"><span class="lineNum">   17275 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17276"><span class="lineNum">   17276 </span>                :            :   // should be same as A since A does not intersect C so diff is 100% of A</a>
<a name="17277"><span class="lineNum">   17277 </span>                :<span class="lineCov">          1 :   QgsGeometry mypDifferenceGeometry( mpPolygonGeometryA.difference( mpPolygonGeometryC ) );</span></a>
<a name="17278"><span class="lineNum">   17278 </span>                :<span class="lineCov">          1 :   QVERIFY( mypDifferenceGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="17279"><span class="lineNum">   17279 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypDifferenceGeometry.asPolygon();</span></a>
<a name="17280"><span class="lineNum">   17280 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union did not fail</span></a>
<a name="17281"><span class="lineNum">   17281 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="17282"><span class="lineNum">   17282 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_differenceCheck1&quot;, &quot;Checking (A - C) = A&quot; ) );</span></a>
<a name="17283"><span class="lineNum">   17283 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17284"><span class="lineNum">   17284 </span>                :            : </a>
<a name="17285"><span class="lineNum">   17285 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::differenceCheck2()</span></a>
<a name="17286"><span class="lineNum">   17286 </span>                :            : {</a>
<a name="17287"><span class="lineNum">   17287 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17288"><span class="lineNum">   17288 </span>                :            :   // should be a single polygon as (A - B) = subset of A</a>
<a name="17289"><span class="lineNum">   17289 </span>                :<span class="lineCov">          1 :   QgsGeometry mypDifferenceGeometry( mpPolygonGeometryA.difference( mpPolygonGeometryB ) );</span></a>
<a name="17290"><span class="lineNum">   17290 </span>                :<span class="lineCov">          1 :   QVERIFY( mypDifferenceGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="17291"><span class="lineNum">   17291 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypDifferenceGeometry.asPolygon();</span></a>
<a name="17292"><span class="lineNum">   17292 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="17293"><span class="lineNum">   17293 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="17294"><span class="lineNum">   17294 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_differenceCheck2&quot;, &quot;Checking (A - B) = subset of A&quot; ) );</span></a>
<a name="17295"><span class="lineNum">   17295 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17296"><span class="lineNum">   17296 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::bufferCheck()</span></a>
<a name="17297"><span class="lineNum">   17297 </span>                :            : {</a>
<a name="17298"><span class="lineNum">   17298 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="17299"><span class="lineNum">   17299 </span>                :            :   // should be a single polygon</a>
<a name="17300"><span class="lineNum">   17300 </span>                :<span class="lineCov">          1 :   QgsGeometry mypBufferGeometry( mpPolygonGeometryB.buffer( 10, 10 ) );</span></a>
<a name="17301"><span class="lineNum">   17301 </span>                :<span class="lineCov">          1 :   QVERIFY( mypBufferGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="17302"><span class="lineNum">   17302 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypBufferGeometry.asPolygon();</span></a>
<a name="17303"><span class="lineNum">   17303 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the buffer created a feature</span></a>
<a name="17304"><span class="lineNum">   17304 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="17305"><span class="lineNum">   17305 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_bufferCheck&quot;, &quot;Checking buffer(10,10) of B&quot;, 10 ) );</span></a>
<a name="17306"><span class="lineNum">   17306 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17307"><span class="lineNum">   17307 </span>                :            : </a>
<a name="17308"><span class="lineNum">   17308 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::smoothCheck()</span></a>
<a name="17309"><span class="lineNum">   17309 </span>                :            : {</a>
<a name="17310"><span class="lineNum">   17310 </span>                :            :   //can't smooth a point</a>
<a name="17311"><span class="lineNum">   17311 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="17312"><span class="lineNum">   17312 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="17313"><span class="lineNum">   17313 </span>                :<span class="lineCov">          1 :   QgsGeometry result = geom.smooth( 1, 0.25 );</span></a>
<a name="17314"><span class="lineNum">   17314 </span>                :<span class="lineCov">          1 :   QString obtained = result.asWkt();</span></a>
<a name="17315"><span class="lineNum">   17315 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="17316"><span class="lineNum">   17316 </span>                :            : </a>
<a name="17317"><span class="lineNum">   17317 </span>                :            :   //linestring</a>
<a name="17318"><span class="lineNum">   17318 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="17319"><span class="lineNum">   17319 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17320"><span class="lineNum">   17320 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17321"><span class="lineNum">   17321 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line = result.asPolyline();</span></a>
<a name="17322"><span class="lineNum">   17322 </span>                :<span class="lineCov">          1 :   QgsPolylineXY expectedLine;</span></a>
<a name="17323"><span class="lineNum">   17323 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="17324"><span class="lineNum">   17324 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 12.5, 10.0 ) &lt;&lt; QgsPointXY( 20.0, 10.0 );</span></a>
<a name="17325"><span class="lineNum">   17325 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="17326"><span class="lineNum">   17326 </span>                :            : </a>
<a name="17327"><span class="lineNum">   17327 </span>                :            :   //linestringM</a>
<a name="17328"><span class="lineNum">   17328 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringM(0 0 1, 10 0 2, 10 10 6, 20 10 4)&quot; );</span></a>
<a name="17329"><span class="lineNum">   17329 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17330"><span class="lineNum">   17330 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17331"><span class="lineNum">   17331 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringM (0 0 1, 7.5 0 1.75, 10 2.5 3, 10 7.5 5, 12.5 10 5.5, 20 10 4)&quot; ) );</span></a>
<a name="17332"><span class="lineNum">   17332 </span>                :            : </a>
<a name="17333"><span class="lineNum">   17333 </span>                :            :   //linestringZ</a>
<a name="17334"><span class="lineNum">   17334 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringZ(0 0 1, 10 0 2, 10 10 6, 20 10 4)&quot; );</span></a>
<a name="17335"><span class="lineNum">   17335 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17336"><span class="lineNum">   17336 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17337"><span class="lineNum">   17337 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringZ (0 0 1, 7.5 0 1.75, 10 2.5 3, 10 7.5 5, 12.5 10 5.5, 20 10 4)&quot; ) );</span></a>
<a name="17338"><span class="lineNum">   17338 </span>                :            : </a>
<a name="17339"><span class="lineNum">   17339 </span>                :            :   //linestringZM</a>
<a name="17340"><span class="lineNum">   17340 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringZM(0 0 1 4, 10 0 2 8, 10 10 6 2, 20 10 4 0)&quot; );</span></a>
<a name="17341"><span class="lineNum">   17341 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17342"><span class="lineNum">   17342 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17343"><span class="lineNum">   17343 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringZM (0 0 1 4, 7.5 0 1.75 7, 10 2.5 3 6.5, 10 7.5 5 3.5, 12.5 10 5.5 1.5, 20 10 4 0)&quot; ) );</span></a>
<a name="17344"><span class="lineNum">   17344 </span>                :            : </a>
<a name="17345"><span class="lineNum">   17345 </span>                :            :   //linestring, with min distance</a>
<a name="17346"><span class="lineNum">   17346 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 15 10, 15 20)&quot; );</span></a>
<a name="17347"><span class="lineNum">   17347 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17348"><span class="lineNum">   17348 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 6 );</span></a>
<a name="17349"><span class="lineNum">   17349 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="17350"><span class="lineNum">   17350 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="17351"><span class="lineNum">   17351 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="17352"><span class="lineNum">   17352 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 15, 12.5 ) &lt;&lt; QgsPointXY( 15.0, 20.0 );</span></a>
<a name="17353"><span class="lineNum">   17353 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="17354"><span class="lineNum">   17354 </span>                :            : </a>
<a name="17355"><span class="lineNum">   17355 </span>                :            :   //linestring, with max angle</a>
<a name="17356"><span class="lineNum">   17356 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 15 5, 25 -5, 30 -5 )&quot; );</span></a>
<a name="17357"><span class="lineNum">   17357 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17358"><span class="lineNum">   17358 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="17359"><span class="lineNum">   17359 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="17360"><span class="lineNum">   17360 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="17361"><span class="lineNum">   17361 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 11.25, 1.25 )</span></a>
<a name="17362"><span class="lineNum">   17362 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 15.0, 5.0 ) &lt;&lt; QgsPointXY( 22.5, -2.5 ) &lt;&lt; QgsPointXY( 26.25, -5 ) &lt;&lt; QgsPointXY( 30, -5 );</span></a>
<a name="17363"><span class="lineNum">   17363 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="17364"><span class="lineNum">   17364 </span>                :            : </a>
<a name="17365"><span class="lineNum">   17365 </span>                :            :   //linestring, with max angle, other direction</a>
<a name="17366"><span class="lineNum">   17366 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString( 30 -5, 25 -5, 15 5, 10 0, 0 0 )&quot; );</span></a>
<a name="17367"><span class="lineNum">   17367 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17368"><span class="lineNum">   17368 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="17369"><span class="lineNum">   17369 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="17370"><span class="lineNum">   17370 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="17371"><span class="lineNum">   17371 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 30, -5 ) &lt;&lt; QgsPointXY( 26.25, -5 ) &lt;&lt; QgsPointXY( 22.5, -2.5 )</span></a>
<a name="17372"><span class="lineNum">   17372 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 15.0, 5.0 ) &lt;&lt; QgsPointXY( 11.25, 1.25 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 0, 0 );</span></a>
<a name="17373"><span class="lineNum">   17373 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="17374"><span class="lineNum">   17374 </span>                :            : </a>
<a name="17375"><span class="lineNum">   17375 </span>                :            :   //linestring, max angle, first corner sharp</a>
<a name="17376"><span class="lineNum">   17376 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10 )&quot; );</span></a>
<a name="17377"><span class="lineNum">   17377 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17378"><span class="lineNum">   17378 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="17379"><span class="lineNum">   17379 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="17380"><span class="lineNum">   17380 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="17381"><span class="lineNum">   17381 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 10, 0 ) &lt;&lt; QgsPointXY( 10, 10 );</span></a>
<a name="17382"><span class="lineNum">   17382 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="17383"><span class="lineNum">   17383 </span>                :            : </a>
<a name="17384"><span class="lineNum">   17384 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiLineString ((0 0, 10 0, 10 10, 20 10),(30 30, 40 30, 40 40, 50 40))&quot; );</span></a>
<a name="17385"><span class="lineNum">   17385 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17386"><span class="lineNum">   17386 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17387"><span class="lineNum">   17387 </span>                :<span class="lineCov">          1 :   QgsMultiPolylineXY multiLine = result.asMultiPolyline();</span></a>
<a name="17388"><span class="lineNum">   17388 </span>                :<span class="lineCov">          1 :   QgsMultiPolylineXY expectedMultiline;</span></a>
<a name="17389"><span class="lineNum">   17389 </span>                :<span class="lineCov">          3 :   expectedMultiline &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="17390"><span class="lineNum">   17390 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 12.5, 10.0 ) &lt;&lt; QgsPointXY( 20.0, 10.0 ) )</span></a>
<a name="17391"><span class="lineNum">   17391 </span>                :<span class="lineCov">          2 :                     &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 30.0, 30.0 ) &lt;&lt; QgsPointXY( 37.5, 30.0 ) &lt;&lt; QgsPointXY( 40.0, 32.5 )</span></a>
<a name="17392"><span class="lineNum">   17392 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPointXY( 40.0, 37.5 ) &lt;&lt; QgsPointXY( 42.5, 40.0 ) &lt;&lt; QgsPointXY( 50.0, 40.0 ) );</span></a>
<a name="17393"><span class="lineNum">   17393 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( multiLine, expectedMultiline ) );</span></a>
<a name="17394"><span class="lineNum">   17394 </span>                :            : </a>
<a name="17395"><span class="lineNum">   17395 </span>                :            :   //polygon</a>
<a name="17396"><span class="lineNum">   17396 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ),(2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="17397"><span class="lineNum">   17397 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17398"><span class="lineNum">   17398 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17399"><span class="lineNum">   17399 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly = result.asPolygon();</span></a>
<a name="17400"><span class="lineNum">   17400 </span>                :<span class="lineCov">          1 :   QgsPolygonXY expectedPolygon;</span></a>
<a name="17401"><span class="lineNum">   17401 </span>                :<span class="lineCov">          3 :   expectedPolygon &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.5, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="17402"><span class="lineNum">   17402 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 7.5, 10.0 ) &lt;&lt; QgsPointXY( 2.5, 10.0 ) &lt;&lt; QgsPointXY( 0, 7.5 )</span></a>
<a name="17403"><span class="lineNum">   17403 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 0, 2.5 ) &lt;&lt; QgsPointXY( 2.5, 0 ) )</span></a>
<a name="17404"><span class="lineNum">   17404 </span>                :<span class="lineCov">          2 :                   &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.5, 2.0 ) &lt;&lt; QgsPointXY( 3.5, 2.0 ) &lt;&lt; QgsPointXY( 4.0, 2.5 )</span></a>
<a name="17405"><span class="lineNum">   17405 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 4.0, 3.5 ) &lt;&lt; QgsPointXY( 3.5, 4.0 ) &lt;&lt; QgsPointXY( 2.5, 4.0 )</span></a>
<a name="17406"><span class="lineNum">   17406 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 2.0, 3.5 ) &lt;&lt; QgsPointXY( 2.0, 2.5 ) &lt;&lt; QgsPointXY( 2.5, 2.0 ) );</span></a>
<a name="17407"><span class="lineNum">   17407 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly, expectedPolygon ) );</span></a>
<a name="17408"><span class="lineNum">   17408 </span>                :            : </a>
<a name="17409"><span class="lineNum">   17409 </span>                :            :   //polygonM</a>
<a name="17410"><span class="lineNum">   17410 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonM ((0 0 1, 10 0 4, 10 10 6, 0 10 8, 0 0 1 ),(2 2 3, 4 2 5, 4 4 7, 2 4 9, 2 2 3))&quot; );</span></a>
<a name="17411"><span class="lineNum">   17411 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17412"><span class="lineNum">   17412 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17413"><span class="lineNum">   17413 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonM ((2.5 0 1.75, 7.5 0 3.25, 10 2.5 4.5, 10 7.5 5.5, 7.5 10 6.5, 2.5 10 7.5, 0 7.5 6.25, 0 2.5 2.75, 2.5 0 1.75),(2.5 2 3.5, 3.5 2 4.5, 4 2.5 5.5, 4 3.5 6.5, 3.5 4 7.5, 2.5 4 8.5, 2 3.5 7.5, 2 2.5 4.5, 2.5 2 3.5))&quot; ) );</span></a>
<a name="17414"><span class="lineNum">   17414 </span>                :            : </a>
<a name="17415"><span class="lineNum">   17415 </span>                :            :   //polygonZ</a>
<a name="17416"><span class="lineNum">   17416 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonZ ((0 0 1, 10 0 4, 10 10 6, 0 10 8, 0 0 1 ),(2 2 3, 4 2 5, 4 4 7, 2 4 9, 2 2 3))&quot; );</span></a>
<a name="17417"><span class="lineNum">   17417 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17418"><span class="lineNum">   17418 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17419"><span class="lineNum">   17419 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonZ ((2.5 0 1.75, 7.5 0 3.25, 10 2.5 4.5, 10 7.5 5.5, 7.5 10 6.5, 2.5 10 7.5, 0 7.5 6.25, 0 2.5 2.75, 2.5 0 1.75),(2.5 2 3.5, 3.5 2 4.5, 4 2.5 5.5, 4 3.5 6.5, 3.5 4 7.5, 2.5 4 8.5, 2 3.5 7.5, 2 2.5 4.5, 2.5 2 3.5))&quot; ) );</span></a>
<a name="17420"><span class="lineNum">   17420 </span>                :            : </a>
<a name="17421"><span class="lineNum">   17421 </span>                :            :   //polygonZM</a>
<a name="17422"><span class="lineNum">   17422 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonZ ((0 0 1 6, 10 0 4 2, 10 10 6 0, 0 10 8 4, 0 0 1 6 ))&quot; );</span></a>
<a name="17423"><span class="lineNum">   17423 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17424"><span class="lineNum">   17424 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="17425"><span class="lineNum">   17425 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonZM ((2.5 0 1.75 5, 7.5 0 3.25 3, 10 2.5 4.5 1.5, 10 7.5 5.5 0.5, 7.5 10 6.5 1, 2.5 10 7.5 3, 0 7.5 6.25 4.5, 0 2.5 2.75 5.5, 2.5 0 1.75 5))&quot; ) );</span></a>
<a name="17426"><span class="lineNum">   17426 </span>                :            : </a>
<a name="17427"><span class="lineNum">   17427 </span>                :            :   //polygon with max angle - should be unchanged</a>
<a name="17428"><span class="lineNum">   17428 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0))&quot; );</span></a>
<a name="17429"><span class="lineNum">   17429 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17430"><span class="lineNum">   17430 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, -1, 50 );</span></a>
<a name="17431"><span class="lineNum">   17431 </span>                :<span class="lineCov">          1 :   poly = result.asPolygon();</span></a>
<a name="17432"><span class="lineNum">   17432 </span>                :<span class="lineCov">          1 :   expectedPolygon.clear();</span></a>
<a name="17433"><span class="lineNum">   17433 </span>                :<span class="lineCov">          2 :   expectedPolygon &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 10, 0 ) &lt;&lt; QgsPointXY( 10.0, 10 )</span></a>
<a name="17434"><span class="lineNum">   17434 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPointXY( 0, 10 ) &lt;&lt; QgsPointXY( 0, 0 ) );</span></a>
<a name="17435"><span class="lineNum">   17435 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly, expectedPolygon ) );</span></a>
<a name="17436"><span class="lineNum">   17436 </span>                :            : </a>
<a name="17437"><span class="lineNum">   17437 </span>                :            :   //multipolygon)</a>
<a name="17438"><span class="lineNum">   17438 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; );</span></a>
<a name="17439"><span class="lineNum">   17439 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17440"><span class="lineNum">   17440 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.1 );</span></a>
<a name="17441"><span class="lineNum">   17441 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY multipoly = result.asMultiPolygon();</span></a>
<a name="17442"><span class="lineNum">   17442 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY expectedMultiPoly;</span></a>
<a name="17443"><span class="lineNum">   17443 </span>                :<span class="lineCov">          1 :   expectedMultiPoly</span></a>
<a name="17444"><span class="lineNum">   17444 </span>                :<span class="lineCov">          2 :       &lt;&lt; ( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 1.0, 0 ) &lt;&lt; QgsPointXY( 9, 0 ) &lt;&lt; QgsPointXY( 10.0, 1 )</span></a>
<a name="17445"><span class="lineNum">   17445 </span>                :<span class="lineCov">          1 :                                &lt;&lt;  QgsPointXY( 10.0, 9 ) &lt;&lt; QgsPointXY( 9, 10.0 ) &lt;&lt; QgsPointXY( 1, 10.0 ) &lt;&lt; QgsPointXY( 0, 9 )</span></a>
<a name="17446"><span class="lineNum">   17446 </span>                :<span class="lineCov">          1 :                                &lt;&lt; QgsPointXY( 0, 1 ) &lt;&lt; QgsPointXY( 1, 0 ) ) )</span></a>
<a name="17447"><span class="lineNum">   17447 </span>                :<span class="lineCov">          2 :       &lt;&lt; ( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.2, 2.0 ) &lt;&lt; QgsPointXY( 3.8, 2.0 ) &lt;&lt; QgsPointXY( 4.0, 2.2 )</span></a>
<a name="17448"><span class="lineNum">   17448 </span>                :<span class="lineCov">          1 :                                &lt;&lt;  QgsPointXY( 4.0, 3.8 ) &lt;&lt; QgsPointXY( 3.8, 4.0 ) &lt;&lt; QgsPointXY( 2.2, 4.0 ) &lt;&lt; QgsPointXY( 2.0, 3.8 )</span></a>
<a name="17449"><span class="lineNum">   17449 </span>                :<span class="lineCov">          1 :                                &lt;&lt; QgsPointXY( 2, 2.2 ) &lt;&lt; QgsPointXY( 2.2, 2 ) ) );</span></a>
<a name="17450"><span class="lineNum">   17450 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( multipoly, expectedMultiPoly ) );</span></a>
<a name="17451"><span class="lineNum">   17451 </span>                :            : </a>
<a name="17452"><span class="lineNum">   17452 </span>                :            :   // curved geometry</a>
<a name="17453"><span class="lineNum">   17453 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;CurvePolygon (CompoundCurve (CircularString (-70.75639028391421448 42.11076979194393743, -70.75300889449444242 42.10738840252416537, -70.75639028391421448 42.10400701310439331, -70.75977167333398654 42.10738840252416537, -70.75639028391421448 42.11076979194393743)))        1&quot; );</span></a>
<a name="17454"><span class="lineNum">   17454 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17455"><span class="lineNum">   17455 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 3 );</span></a>
<a name="17456"><span class="lineNum">   17456 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="17457"><span class="lineNum">   17457 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17458"><span class="lineNum">   17458 </span>                :            : </a>
<a name="17459"><span class="lineNum">   17459 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::shortestLineEmptyGeometry()</span></a>
<a name="17460"><span class="lineNum">   17460 </span>                :            : {</a>
<a name="17461"><span class="lineNum">   17461 </span>                :            :   // test calculating distance to an empty geometry</a>
<a name="17462"><span class="lineNum">   17462 </span>                :            :   // refs https://github.com/qgis/QGIS/issues/41968</a>
<a name="17463"><span class="lineNum">   17463 </span>                :<span class="lineCov">          2 :   QgsGeometry geom1( QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ))&quot; ) ) );</span></a>
<a name="17464"><span class="lineNum">   17464 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2( new QgsPoint() );</span></a>
<a name="17465"><span class="lineNum">   17465 </span>                :<span class="lineCov">          1 :   QgsGeos geos( geom1.constGet() );</span></a>
<a name="17466"><span class="lineNum">   17466 </span>                :<span class="lineCov">          1 :   QVERIFY( geos.shortestLine( geom2.constGet() ).isNull() );</span></a>
<a name="17467"><span class="lineNum">   17467 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17468"><span class="lineNum">   17468 </span>                :            : </a>
<a name="17469"><span class="lineNum">   17469 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unaryUnion()</span></a>
<a name="17470"><span class="lineNum">   17470 </span>                :            : {</a>
<a name="17471"><span class="lineNum">   17471 </span>                :            :   //test QgsGeometry::unaryUnion with null geometry</a>
<a name="17472"><span class="lineNum">   17472 </span>                :<span class="lineCov">          2 :   QString wkt1 = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ))&quot; );</span></a>
<a name="17473"><span class="lineNum">   17473 </span>                :<span class="lineCov">          2 :   QString wkt2 = QStringLiteral( &quot;Polygon ((2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="17474"><span class="lineNum">   17474 </span>                :<span class="lineCov">          1 :   QgsGeometry geom1( QgsGeometry::fromWkt( wkt1 ) );</span></a>
<a name="17475"><span class="lineNum">   17475 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2( QgsGeometry::fromWkt( wkt2 ) );</span></a>
<a name="17476"><span class="lineNum">   17476 </span>                :<span class="lineCov">          1 :   QgsGeometry empty;</span></a>
<a name="17477"><span class="lineNum">   17477 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsGeometry &gt; list;</span></a>
<a name="17478"><span class="lineNum">   17478 </span>                :<span class="lineCov">          1 :   list &lt;&lt; geom1 &lt;&lt; empty &lt;&lt; geom2;</span></a>
<a name="17479"><span class="lineNum">   17479 </span>                :            : </a>
<a name="17480"><span class="lineNum">   17480 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::unaryUnion( list ) );</span></a>
<a name="17481"><span class="lineNum">   17481 </span>                :            :   Q_UNUSED( result );</a>
<a name="17482"><span class="lineNum">   17482 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17483"><span class="lineNum">   17483 </span>                :            : </a>
<a name="17484"><span class="lineNum">   17484 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::dataStream()</span></a>
<a name="17485"><span class="lineNum">   17485 </span>                :            : {</a>
<a name="17486"><span class="lineNum">   17486 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="17487"><span class="lineNum">   17487 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="17488"><span class="lineNum">   17488 </span>                :            : </a>
<a name="17489"><span class="lineNum">   17489 </span>                :<span class="lineCov">          1 :   QByteArray ba;</span></a>
<a name="17490"><span class="lineNum">   17490 </span>                :<span class="lineCov">          1 :   QDataStream ds( &amp;ba, QIODevice::ReadWrite );</span></a>
<a name="17491"><span class="lineNum">   17491 </span>                :<span class="lineCov">          1 :   ds &lt;&lt; geom;</span></a>
<a name="17492"><span class="lineNum">   17492 </span>                :            : </a>
<a name="17493"><span class="lineNum">   17493 </span>                :<span class="lineCov">          1 :   QgsGeometry resultGeometry;</span></a>
<a name="17494"><span class="lineNum">   17494 </span>                :<span class="lineCov">          1 :   ds.device()-&gt;seek( 0 );</span></a>
<a name="17495"><span class="lineNum">   17495 </span>                :<span class="lineCov">          1 :   ds &gt;&gt; resultGeometry;</span></a>
<a name="17496"><span class="lineNum">   17496 </span>                :            : </a>
<a name="17497"><span class="lineNum">   17497 </span>                :<span class="lineCov">          1 :   QCOMPARE( geom.constGet()-&gt;asWkt(), resultGeometry.constGet()-&gt;asWkt() );</span></a>
<a name="17498"><span class="lineNum">   17498 </span>                :            : </a>
<a name="17499"><span class="lineNum">   17499 </span>                :            :   //also test with geometry without data</a>
<a name="17500"><span class="lineNum">   17500 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsGeometry&gt; emptyGeom( new QgsGeometry() );</span></a>
<a name="17501"><span class="lineNum">   17501 </span>                :            : </a>
<a name="17502"><span class="lineNum">   17502 </span>                :<span class="lineCov">          1 :   QByteArray ba2;</span></a>
<a name="17503"><span class="lineNum">   17503 </span>                :<span class="lineCov">          1 :   QDataStream ds2( &amp;ba2, QIODevice::ReadWrite );</span></a>
<a name="17504"><span class="lineNum">   17504 </span>                :<span class="lineCov">          1 :   ds2 &lt;&lt; emptyGeom.get();</span></a>
<a name="17505"><span class="lineNum">   17505 </span>                :            : </a>
<a name="17506"><span class="lineNum">   17506 </span>                :<span class="lineCov">          1 :   ds2.device()-&gt;seek( 0 );</span></a>
<a name="17507"><span class="lineNum">   17507 </span>                :<span class="lineCov">          1 :   ds2 &gt;&gt; resultGeometry;</span></a>
<a name="17508"><span class="lineNum">   17508 </span>                :            : </a>
<a name="17509"><span class="lineNum">   17509 </span>                :<span class="lineCov">          1 :   QVERIFY( resultGeometry.isNull() );</span></a>
<a name="17510"><span class="lineNum">   17510 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17511"><span class="lineNum">   17511 </span>                :            : </a>
<a name="17512"><span class="lineNum">   17512 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::exportToGeoJSON()</span></a>
<a name="17513"><span class="lineNum">   17513 </span>                :            : {</a>
<a name="17514"><span class="lineNum">   17514 </span>                :            :   //Point</a>
<a name="17515"><span class="lineNum">   17515 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="17516"><span class="lineNum">   17516 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="17517"><span class="lineNum">   17517 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asJson();</span></a>
<a name="17518"><span class="lineNum">   17518 </span>                :<span class="lineCov">          2 :   QString geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[40.0,50.0],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; );</span></a>
<a name="17519"><span class="lineNum">   17519 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17520"><span class="lineNum">   17520 </span>                :            : </a>
<a name="17521"><span class="lineNum">   17521 </span>                :            :   //MultiPoint</a>
<a name="17522"><span class="lineNum">   17522 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPoint (0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="17523"><span class="lineNum">   17523 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17524"><span class="lineNum">   17524 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="17525"><span class="lineNum">   17525 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="17526"><span class="lineNum">   17526 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17527"><span class="lineNum">   17527 </span>                :            : </a>
<a name="17528"><span class="lineNum">   17528 </span>                :            :   //Linestring</a>
<a name="17529"><span class="lineNum">   17529 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="17530"><span class="lineNum">   17530 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17531"><span class="lineNum">   17531 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="17532"><span class="lineNum">   17532 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="17533"><span class="lineNum">   17533 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17534"><span class="lineNum">   17534 </span>                :            : </a>
<a name="17535"><span class="lineNum">   17535 </span>                :            :   //MultiLineString</a>
<a name="17536"><span class="lineNum">   17536 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiLineString ((0 0, 10 0, 10 10, 20 10),(30 30, 40 30, 40 40, 50 40))&quot; );</span></a>
<a name="17537"><span class="lineNum">   17537 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17538"><span class="lineNum">   17538 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="17539"><span class="lineNum">   17539 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],[[30.0,30.0],[40.0,30.0],[40.0,40.0],[50.0,40.0]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="17540"><span class="lineNum">   17540 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17541"><span class="lineNum">   17541 </span>                :            : </a>
<a name="17542"><span class="lineNum">   17542 </span>                :            :   //Polygon</a>
<a name="17543"><span class="lineNum">   17543 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ),(2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="17544"><span class="lineNum">   17544 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17545"><span class="lineNum">   17545 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="17546"><span class="lineNum">   17546 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[0.0,10.0],[0.0,0.0]],[[2.0,2.0],[4.0,2.0],[4.0,4.0],[2.0,4.0],[2.0,2.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="17547"><span class="lineNum">   17547 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17548"><span class="lineNum">   17548 </span>                :            : </a>
<a name="17549"><span class="lineNum">   17549 </span>                :            :   //MultiPolygon</a>
<a name="17550"><span class="lineNum">   17550 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; );</span></a>
<a name="17551"><span class="lineNum">   17551 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17552"><span class="lineNum">   17552 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="17553"><span class="lineNum">   17553 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[0.0,10.0],[0.0,0.0]]],[[[2.0,2.0],[4.0,2.0],[4.0,4.0],[2.0,4.0],[2.0,2.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="17554"><span class="lineNum">   17554 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17555"><span class="lineNum">   17555 </span>                :            : </a>
<a name="17556"><span class="lineNum">   17556 </span>                :            :   // no geometry</a>
<a name="17557"><span class="lineNum">   17557 </span>                :<span class="lineCov">          1 :   QgsGeometry nullGeom( nullptr );</span></a>
<a name="17558"><span class="lineNum">   17558 </span>                :<span class="lineCov">          1 :   obtained = nullGeom.asJson();</span></a>
<a name="17559"><span class="lineNum">   17559 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;null&quot; );</span></a>
<a name="17560"><span class="lineNum">   17560 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="17561"><span class="lineNum">   17561 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17562"><span class="lineNum">   17562 </span>                :            : </a>
<a name="17563"><span class="lineNum">   17563 </span>                :<span class="lineCov">          6 : bool TestQgsGeometry::renderCheck( const QString &amp;testName, const QString &amp;comment, int mismatchCount )</span></a>
<a name="17564"><span class="lineNum">   17564 </span>                :            : {</a>
<a name="17565"><span class="lineNum">   17565 </span>                :<span class="lineCov">          6 :   mReport += &quot;&lt;h2&gt;&quot; + testName + &quot;&lt;/h2&gt;\n&quot;;</span></a>
<a name="17566"><span class="lineNum">   17566 </span>                :<span class="lineCov">          6 :   mReport += &quot;&lt;h3&gt;&quot; + comment + &quot;&lt;/h3&gt;\n&quot;;</span></a>
<a name="17567"><span class="lineNum">   17567 </span>                :<span class="lineCov">          6 :   QString myTmpDir = QDir::tempPath() + '/';</span></a>
<a name="17568"><span class="lineNum">   17568 </span>                :<span class="lineCov">          6 :   QString myFileName = myTmpDir + testName + &quot;.png&quot;;</span></a>
<a name="17569"><span class="lineNum">   17569 </span>                :<span class="lineCov">          6 :   mImage.save( myFileName, &quot;PNG&quot; );</span></a>
<a name="17570"><span class="lineNum">   17570 </span>                :<span class="lineCov">          6 :   QgsRenderChecker myChecker;</span></a>
<a name="17571"><span class="lineNum">   17571 </span>                :<span class="lineCov">          6 :   myChecker.setControlName( &quot;expected_&quot; + testName );</span></a>
<a name="17572"><span class="lineNum">   17572 </span>                :<span class="lineCov">          6 :   myChecker.setRenderedImage( myFileName );</span></a>
<a name="17573"><span class="lineNum">   17573 </span>                :<span class="lineCov">          6 :   bool myResultFlag = myChecker.compareImages( testName, mismatchCount );</span></a>
<a name="17574"><span class="lineNum">   17574 </span>                :<span class="lineCov">          6 :   mReport += myChecker.report();</span></a>
<a name="17575"><span class="lineNum">   17575 </span>                :<span class="lineCov">          6 :   return myResultFlag;</span></a>
<a name="17576"><span class="lineNum">   17576 </span>                :<span class="lineCov">          6 : }</span></a>
<a name="17577"><span class="lineNum">   17577 </span>                :            : </a>
<a name="17578"><span class="lineNum">   17578 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon )</span></a>
<a name="17579"><span class="lineNum">   17579 </span>                :            : {</a>
<a name="17580"><span class="lineNum">   17580 </span>                :<span class="lineNoCov">          0 :   qDebug( &quot;Multipolygon Geometry Dump&quot; );</span></a>
<a name="17581"><span class="lineNum">   17581 </span>                :<span class="lineNoCov">          0 :   for ( int i = 0; i &lt; multiPolygon.size(); i++ )</span></a>
<a name="17582"><span class="lineNum">   17582 </span>                :            :   {</a>
<a name="17583"><span class="lineNum">   17583 </span>                :<span class="lineNoCov">          0 :     QgsPolygonXY myPolygon = multiPolygon.at( i );</span></a>
<a name="17584"><span class="lineNum">   17584 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\tPolygon in multipolygon: %d&quot;, i );</span></a>
<a name="17585"><span class="lineNum">   17585 </span>                :<span class="lineNoCov">          0 :     dumpPolygon( myPolygon );</span></a>
<a name="17586"><span class="lineNum">   17586 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="17587"><span class="lineNum">   17587 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="17588"><span class="lineNum">   17588 </span>                :            : </a>
<a name="17589"><span class="lineNum">   17589 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::paintMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon )</span></a>
<a name="17590"><span class="lineNum">   17590 </span>                :            : {</a>
<a name="17591"><span class="lineNum">   17591 </span>                :<span class="lineCov">          3 :   for ( int i = 0; i &lt; multiPolygon.size(); i++ )</span></a>
<a name="17592"><span class="lineNum">   17592 </span>                :            :   {</a>
<a name="17593"><span class="lineNum">   17593 </span>                :<span class="lineCov">          2 :     QgsPolygonXY myPolygon = multiPolygon.at( i );</span></a>
<a name="17594"><span class="lineNum">   17594 </span>                :<span class="lineCov">          2 :     paintPolygon( myPolygon );</span></a>
<a name="17595"><span class="lineNum">   17595 </span>                :<span class="lineCov">          2 :   }</span></a>
<a name="17596"><span class="lineNum">   17596 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17597"><span class="lineNum">   17597 </span>                :            : </a>
<a name="17598"><span class="lineNum">   17598 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpPolygon( QgsPolygonXY &amp;polygon )</span></a>
<a name="17599"><span class="lineNum">   17599 </span>                :            : {</a>
<a name="17600"><span class="lineNum">   17600 </span>                :<span class="lineNoCov">          0 :   for ( int j = 0; j &lt; polygon.size(); j++ )</span></a>
<a name="17601"><span class="lineNum">   17601 </span>                :            :   {</a>
<a name="17602"><span class="lineNum">   17602 </span>                :<span class="lineNoCov">          0 :     QgsPolylineXY myPolyline = polygon.at( j ); //rings of polygon</span></a>
<a name="17603"><span class="lineNum">   17603 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\t\tRing in polygon: %d&quot;, j );</span></a>
<a name="17604"><span class="lineNum">   17604 </span>                :            : </a>
<a name="17605"><span class="lineNum">   17605 </span>                :<span class="lineNoCov">          0 :     for ( int k = 0; k &lt; myPolyline.size(); k++ )</span></a>
<a name="17606"><span class="lineNum">   17606 </span>                :            :     {</a>
<a name="17607"><span class="lineNum">   17607 </span>                :<span class="lineNoCov">          0 :       QgsPointXY myPoint = myPolyline.at( k );</span></a>
<a name="17608"><span class="lineNum">   17608 </span>                :<span class="lineNoCov">          0 :       qDebug( &quot;\t\t\tPoint in ring %d : %s&quot;, k, myPoint.toString().toLocal8Bit().constData() );</span></a>
<a name="17609"><span class="lineNum">   17609 </span>                :<span class="lineNoCov">          0 :     }</span></a>
<a name="17610"><span class="lineNum">   17610 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="17611"><span class="lineNum">   17611 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="17612"><span class="lineNum">   17612 </span>                :            : </a>
<a name="17613"><span class="lineNum">   17613 </span>                :<span class="lineCov">         25 : void TestQgsGeometry::paintPolygon( QgsPolygonXY &amp;polygon )</span></a>
<a name="17614"><span class="lineNum">   17614 </span>                :            : {</a>
<a name="17615"><span class="lineNum">   17615 </span>                :<span class="lineCov">         25 :   QVector&lt;QPointF&gt; myPoints;</span></a>
<a name="17616"><span class="lineNum">   17616 </span>                :<span class="lineCov">         50 :   for ( int j = 0; j &lt; polygon.size(); j++ )</span></a>
<a name="17617"><span class="lineNum">   17617 </span>                :            :   {</a>
<a name="17618"><span class="lineNum">   17618 </span>                :<span class="lineCov">         25 :     QgsPolylineXY myPolyline = polygon.at( j ); //rings of polygon</span></a>
<a name="17619"><span class="lineNum">   17619 </span>                :<span class="lineCov">        196 :     for ( int k = 0; k &lt; myPolyline.size(); k++ )</span></a>
<a name="17620"><span class="lineNum">   17620 </span>                :            :     {</a>
<a name="17621"><span class="lineNum">   17621 </span>                :<span class="lineCov">        171 :       QgsPointXY myPoint = myPolyline.at( k );</span></a>
<a name="17622"><span class="lineNum">   17622 </span>                :<span class="lineCov">        171 :       myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</span></a>
<a name="17623"><span class="lineNum">   17623 </span>                :<span class="lineCov">        171 :     }</span></a>
<a name="17624"><span class="lineNum">   17624 </span>                :<span class="lineCov">         25 :   }</span></a>
<a name="17625"><span class="lineNum">   17625 </span>                :<span class="lineCov">         25 :   mpPainter-&gt;drawPolygon( myPoints );</span></a>
<a name="17626"><span class="lineNum">   17626 </span>                :<span class="lineCov">         25 : }</span></a>
<a name="17627"><span class="lineNum">   17627 </span>                :            : </a>
<a name="17628"><span class="lineNum">   17628 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpPolyline( QgsPolylineXY &amp;polyline )</span></a>
<a name="17629"><span class="lineNum">   17629 </span>                :            : {</a>
<a name="17630"><span class="lineNum">   17630 </span>                :<span class="lineNoCov">          0 :   QVector&lt;QPointF&gt; myPoints;</span></a>
<a name="17631"><span class="lineNum">   17631 </span>                :            : //  QgsPolyline myPolyline = polyline.at( j ); //rings of polygon</a>
<a name="17632"><span class="lineNum">   17632 </span>                :<span class="lineNoCov">          0 :   for ( int j = 0; j &lt; polyline.size(); j++ )</span></a>
<a name="17633"><span class="lineNum">   17633 </span>                :            :   {</a>
<a name="17634"><span class="lineNum">   17634 </span>                :<span class="lineNoCov">          0 :     QgsPointXY myPoint = polyline.at( j );</span></a>
<a name="17635"><span class="lineNum">   17635 </span>                :            : //    QgsPolyline myPolyline = polygon.at( j ); //rings of polygon</a>
<a name="17636"><span class="lineNum">   17636 </span>                :<span class="lineNoCov">          0 :     myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</span></a>
<a name="17637"><span class="lineNum">   17637 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\t\tPoint in line: %d&quot;, j );</span></a>
<a name="17638"><span class="lineNum">   17638 </span>                :            : </a>
<a name="17639"><span class="lineNum">   17639 </span>                :            : //    for ( int k = 0; k &lt; myPolyline.size(); k++ )</a>
<a name="17640"><span class="lineNum">   17640 </span>                :            : //    {</a>
<a name="17641"><span class="lineNum">   17641 </span>                :            : //      QgsPointXY myPoint = myPolyline.at( k );</a>
<a name="17642"><span class="lineNum">   17642 </span>                :            : //      qDebug( &quot;\t\t\tPoint in ring %d : %s&quot;, k, myPoint.toString().toLocal8Bit().constData() );</a>
<a name="17643"><span class="lineNum">   17643 </span>                :            : //      myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</a>
<a name="17644"><span class="lineNum">   17644 </span>                :            : //    }</a>
<a name="17645"><span class="lineNum">   17645 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="17646"><span class="lineNum">   17646 </span>                :<span class="lineNoCov">          0 :   mpPainter-&gt;drawPolyline( myPoints );</span></a>
<a name="17647"><span class="lineNum">   17647 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="17648"><span class="lineNum">   17648 </span>                :            : </a>
<a name="17649"><span class="lineNum">   17649 </span>                :<span class="lineCov">         92 : QString TestQgsGeometry::elemToString( const QDomElement &amp;elem ) const</span></a>
<a name="17650"><span class="lineNum">   17650 </span>                :            : {</a>
<a name="17651"><span class="lineNum">   17651 </span>                :<span class="lineCov">         92 :   QString s;</span></a>
<a name="17652"><span class="lineNum">   17652 </span>                :<span class="lineCov">         92 :   QTextStream stream( &amp;s );</span></a>
<a name="17653"><span class="lineNum">   17653 </span>                :<span class="lineCov">         92 :   elem.save( stream, -1 );</span></a>
<a name="17654"><span class="lineNum">   17654 </span>                :            : </a>
<a name="17655"><span class="lineNum">   17655 </span>                :<span class="lineCov">         92 :   return s;</span></a>
<a name="17656"><span class="lineNum">   17656 </span>                :<span class="lineCov">         92 : }</span></a>
<a name="17657"><span class="lineNum">   17657 </span>                :            : </a>
<a name="17658"><span class="lineNum">   17658 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::wkbInOut()</span></a>
<a name="17659"><span class="lineNum">   17659 </span>                :            : {</a>
<a name="17660"><span class="lineNum">   17660 </span>                :            :   // Premature end of WKB</a>
<a name="17661"><span class="lineNum">   17661 </span>                :            :   // See https://github.com/qgis/QGIS/issues/22184</a>
<a name="17662"><span class="lineNum">   17662 </span>                :<span class="lineCov">          1 :   const char *hexwkb = &quot;0102000000EF0000000000000000000000000000000000000000000000000000000000000000000000&quot;;</span></a>
<a name="17663"><span class="lineNum">   17663 </span>                :            :   int size;</a>
<a name="17664"><span class="lineNum">   17664 </span>                :<span class="lineCov">          1 :   unsigned char *wkb = hex2bytes( hexwkb, &amp;size );</span></a>
<a name="17665"><span class="lineNum">   17665 </span>                :<span class="lineCov">          1 :   QgsGeometry g14182;</span></a>
<a name="17666"><span class="lineNum">   17666 </span>                :            :   // NOTE: wkb onwership transferred to QgsGeometry</a>
<a name="17667"><span class="lineNum">   17667 </span>                :<span class="lineCov">          1 :   g14182.fromWkb( wkb, size );</span></a>
<a name="17668"><span class="lineNum">   17668 </span>                :            :   //QList&lt;QgsGeometry::Error&gt; errors;</a>
<a name="17669"><span class="lineNum">   17669 </span>                :            :   //g14182.validateGeometry(errors);</a>
<a name="17670"><span class="lineNum">   17670 </span>                :            :   // Check with valgrind !</a>
<a name="17671"><span class="lineNum">   17671 </span>                :<span class="lineCov">          1 :   QString wkt = g14182.asWkt();</span></a>
<a name="17672"><span class="lineNum">   17672 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkt, QString() );</span></a>
<a name="17673"><span class="lineNum">   17673 </span>                :            : </a>
<a name="17674"><span class="lineNum">   17674 </span>                :            :   //WKB with a truncated header</a>
<a name="17675"><span class="lineNum">   17675 </span>                :<span class="lineCov">          1 :   const char *badHeaderHexwkb = &quot;0102&quot;;</span></a>
<a name="17676"><span class="lineNum">   17676 </span>                :<span class="lineCov">          1 :   wkb = hex2bytes( badHeaderHexwkb, &amp;size );</span></a>
<a name="17677"><span class="lineNum">   17677 </span>                :<span class="lineCov">          1 :   QgsGeometry badHeader;</span></a>
<a name="17678"><span class="lineNum">   17678 </span>                :            :   // NOTE: wkb onwership transferred to QgsGeometry</a>
<a name="17679"><span class="lineNum">   17679 </span>                :<span class="lineCov">          1 :   badHeader.fromWkb( wkb, size );</span></a>
<a name="17680"><span class="lineNum">   17680 </span>                :<span class="lineCov">          1 :   QVERIFY( badHeader.isNull() );</span></a>
<a name="17681"><span class="lineNum">   17681 </span>                :<span class="lineCov">          1 :   QCOMPARE( badHeader.wkbType(), QgsWkbTypes::Unknown );</span></a>
<a name="17682"><span class="lineNum">   17682 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17683"><span class="lineNum">   17683 </span>                :            : </a>
<a name="17684"><span class="lineNum">   17684 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::directionNeutralSegmentation()</span></a>
<a name="17685"><span class="lineNum">   17685 </span>                :            : {</a>
<a name="17686"><span class="lineNum">   17686 </span>                :            :   //Tests, if segmentation of a circularstring is the same in both directions</a>
<a name="17687"><span class="lineNum">   17687 </span>                :<span class="lineCov">          2 :   QString CWCircularStringWkt( QStringLiteral( &quot;CIRCULARSTRING( 0 0, 0.5 0.5, 0.83 7.33 )&quot; ) );</span></a>
<a name="17688"><span class="lineNum">   17688 </span>                :<span class="lineCov">          1 :   QgsCircularString *CWCircularString = static_cast&lt;QgsCircularString *&gt;( QgsGeometryFactory::geomFromWkt( CWCircularStringWkt ).release() );</span></a>
<a name="17689"><span class="lineNum">   17689 </span>                :<span class="lineCov">          1 :   QgsLineString *CWLineString = CWCircularString-&gt;curveToLine();</span></a>
<a name="17690"><span class="lineNum">   17690 </span>                :            : </a>
<a name="17691"><span class="lineNum">   17691 </span>                :<span class="lineCov">          2 :   QString CCWCircularStringWkt( QStringLiteral( &quot;CIRCULARSTRING( 0.83 7.33, 0.5 0.5, 0 0 )&quot; ) );</span></a>
<a name="17692"><span class="lineNum">   17692 </span>                :<span class="lineCov">          1 :   QgsCircularString *CCWCircularString = static_cast&lt;QgsCircularString *&gt;( QgsGeometryFactory::geomFromWkt( CCWCircularStringWkt ).release() );</span></a>
<a name="17693"><span class="lineNum">   17693 </span>                :<span class="lineCov">          1 :   QgsLineString *CCWLineString = CCWCircularString-&gt;curveToLine();</span></a>
<a name="17694"><span class="lineNum">   17694 </span>                :<span class="lineCov">          1 :   QgsLineString *reversedCCWLineString = CCWLineString-&gt;reversed();</span></a>
<a name="17695"><span class="lineNum">   17695 </span>                :            : </a>
<a name="17696"><span class="lineNum">   17696 </span>                :<span class="lineCov">          1 :   QCOMPARE( CWLineString-&gt;asWkt(), reversedCCWLineString-&gt;asWkt() );</span></a>
<a name="17697"><span class="lineNum">   17697 </span>                :<span class="lineCov">          1 :   bool equal = ( *CWLineString == *reversedCCWLineString );</span></a>
<a name="17698"><span class="lineNum">   17698 </span>                :            : </a>
<a name="17699"><span class="lineNum">   17699 </span>                :<span class="lineCov">          1 :   delete CWCircularString;</span></a>
<a name="17700"><span class="lineNum">   17700 </span>                :<span class="lineCov">          1 :   delete CCWCircularString;</span></a>
<a name="17701"><span class="lineNum">   17701 </span>                :<span class="lineCov">          1 :   delete CWLineString;</span></a>
<a name="17702"><span class="lineNum">   17702 </span>                :<span class="lineCov">          1 :   delete CCWLineString;</span></a>
<a name="17703"><span class="lineNum">   17703 </span>                :<span class="lineCov">          1 :   delete reversedCCWLineString;</span></a>
<a name="17704"><span class="lineNum">   17704 </span>                :            : </a>
<a name="17705"><span class="lineNum">   17705 </span>                :<span class="lineCov">          1 :   QVERIFY( equal );</span></a>
<a name="17706"><span class="lineNum">   17706 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17707"><span class="lineNum">   17707 </span>                :            : </a>
<a name="17708"><span class="lineNum">   17708 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::poleOfInaccessibility()</span></a>
<a name="17709"><span class="lineNum">   17709 </span>                :            : {</a>
<a name="17710"><span class="lineNum">   17710 </span>                :<span class="lineCov">          1 :   QString poly1Wkt( &quot;Polygon ((3116 3071, 3394 3431, 3563 3362, 3611 3205, 3599 3181, 3477 3281, 3449 3160, 3570 3127, 3354 3116,&quot;</span></a>
<a name="17711"><span class="lineNum">   17711 </span>                :            :                     &quot; 3436 3008, 3158 2907, 2831 2438, 3269 2916, 3438 2885, 3295 2799, 3407 2772, 3278 2629, 3411 2689, 3329 2611,&quot;</a>
<a name="17712"><span class="lineNum">   17712 </span>                :            :                     &quot; 3360 2531, 3603 2800, 3598 2501, 3317 2429, 3329 2401, 3170 2340, 3142 2291, 3524 2403, 3598 2233, 3460 2117,&quot;</a>
<a name="17713"><span class="lineNum">   17713 </span>                :            :                     &quot; 3590 1931, 3364 1753, 3597 1875, 3639 1835, 3660 1733, 3600 1771, 3538 1694, 3661 1732, 3359 1554, 3334 1554,&quot;</a>
<a name="17714"><span class="lineNum">   17714 </span>                :            :                     &quot; 3341 1588, 3317 1588, 3305 1644, 3286 1656, 3115 1255, 3072 1252, 3078 1335, 3046 1355, 2984 1234, 2983 1409,&quot;</a>
<a name="17715"><span class="lineNum">   17715 </span>                :            :                     &quot; 2876 1222, 2525 1161, 2488 787, 2162 913, 2079 661, 2270 380, 2188 823, 2510 592, 2659 992, 2911 1118, 2943 938,&quot;</a>
<a name="17716"><span class="lineNum">   17716 </span>                :            :                     &quot; 2957 1097, 3092 1002, 3006 1097, 3233 1282, 3325 1291, 3296 1116, 3333 1115, 3391 1333, 3434 1274, 3413 1326,&quot;</a>
<a name="17717"><span class="lineNum">   17717 </span>                :            :                     &quot; 3449 1327, 3473 1408, 3490 1430, 3526 1434, 3198 -112, 3263 -87, 3289 -128, 4224 -128, 4224 -128, 3474 -128,&quot;</a>
<a name="17718"><span class="lineNum">   17718 </span>                :            :                     &quot; 3475 -116, 3486 -120, 3458 -49, 3523 -78, 3513 -128, 3509 -119, 3509 -128, 3717 -128, 3705 -60, 3735 -16,&quot;</a>
<a name="17719"><span class="lineNum">   17719 </span>                :            :                     &quot; 3714 38, 3758 88, 3825 47, 3812 -11, 3859 -51, 3871 49, 3760 149, 3636 -74, 3510 126, 3501 245, 3504 270,&quot;</a>
<a name="17720"><span class="lineNum">   17720 </span>                :            :                     &quot; 3511 284, 3582 16, 3631 19, 3569 125, 3570 193, 3610 212, 3583 119, 3655 29, 3738 170, 3561 466, 3826 549,&quot;</a>
<a name="17721"><span class="lineNum">   17721 </span>                :            :                     &quot; 3527 604, 3609 833, 3681 798, 3956 1127, 3917 964, 4043 850, 4049 1096, 4193 1052, 4191 1078, 4208 1106,&quot;</a>
<a name="17722"><span class="lineNum">   17722 </span>                :            :                     &quot; 4222 1110, 4224 1109, 4224 1144, 4202 1158, 4177 1161, 4182 1181, 4075 1201, 4141 1275, 4215 1215, 4221 1223,&quot;</a>
<a name="17723"><span class="lineNum">   17723 </span>                :            :                     &quot; 4219 1231, 4224 1243, 4224 1257, 4224 1262, 4224 1345, 4224 1339, 4224 1328, 4215 1335, 4203 1355, 4215 1369,&quot;</a>
<a name="17724"><span class="lineNum">   17724 </span>                :            :                     &quot; 4224 1363, 4215 1377, 4208 1387, 4217 1401, 4224 1403, 4224 1520, 4219 1535, 4221 1544, 4199 1593, 4223 1595,&quot;</a>
<a name="17725"><span class="lineNum">   17725 </span>                :            :                     &quot; 4206 1626, 4214 1648, 4224 1645, 4224 1640, 4224 2108, 4220 2125, 4224 2125, 4224 2143, 4205 2141, 4180 2159,&quot;</a>
<a name="17726"><span class="lineNum">   17726 </span>                :            :                     &quot; 4201 2182, 4163 2189, 4176 2229, 4199 2211, 4210 2218, 4212 2210, 4223 2214, 4224 2207, 4224 2216, 4217 2225,&quot;</a>
<a name="17727"><span class="lineNum">   17727 </span>                :            :                     &quot; 4221 2233, 4203 2227, 4209 2248, 4185 2240, 4198 2276, 4144 2218, 4091 2343, 4119 2332, 4121 2347, 4155 2337,&quot;</a>
<a name="17728"><span class="lineNum">   17728 </span>                :            :                     &quot; 4180 2355, 4200 2342, 4201 2354, 4213 2352, 4224 2348, 4224 2356, 4207 2361, 4184 2358, 4176 2367, 4106 2355,&quot;</a>
<a name="17729"><span class="lineNum">   17729 </span>                :            :                     &quot; 3983 2765, 4050 3151, 4139 2720, 4209 2589, 4211 2600, 4219 2599, 4224 2592, 4224 2574, 4223 2566, 4224 2562,&quot;</a>
<a name="17730"><span class="lineNum">   17730 </span>                :            :                     &quot; 4224 2553, 4224 2552, 4224 -128, 4224 4224, 4205 4224, 4015 3513, 3993 3494, 3873 3533, 3887 3539, 3923 3524,&quot;</a>
<a name="17731"><span class="lineNum">   17731 </span>                :            :                     &quot; 3950 3529, 4018 3572, 3987 3633, 3983 3571, 3955 3583, 3936 3547, 3882 3539, 3913 3557, 3920 3598, 3901 3596,&quot;</a>
<a name="17732"><span class="lineNum">   17732 </span>                :            :                     &quot; 3923 3631, 3914 3628, 3919 3647, 3922 3656, 3917 3666, 3523 3438, 3631 3564, 3527 3597, 3718 3655, 3578 3672,&quot;</a>
<a name="17733"><span class="lineNum">   17733 </span>                :            :                     &quot; 3660 3867, 3543 3628, 3416 3725, 3487 3503, 3274 3583, 3271 3644, 3197 3671, 3210 3775, 3184 3788, 3181 3672,&quot;</a>
<a name="17734"><span class="lineNum">   17734 </span>                :            :                     &quot; 3306 3521, 3292 3508, 3229 3565, 3219 3564, 3216 3574, 3192 3578, 3297 3444, 3089 3395, 3029 3028, 2973 3133,&quot;</a>
<a name="17735"><span class="lineNum">   17735 </span>                :            :                     &quot; 2529 2945, 2538 2811, 2461 2901, 2170 2839, 2121 2797, 2156 2733, 2105 2709, 2096 2695, 2114 2621, 2102 2693,&quot;</a>
<a name="17736"><span class="lineNum">   17736 </span>                :            :                     &quot; 2168 2738, 2167 2778, 2447 2765, 2441 2866, 2527 2793, 2670 2938, 2626 2651, 2688 2623, 2740 2922, 3084 2960,&quot;</a>
<a name="17737"><span class="lineNum">   17737 </span>                :            :                     &quot; 3116 3071),(4016 1878, 4029 1859, 4008 1839, 4006 1863, 4016 1878),(3315 1339, 3331 1324, 3290 1293, 3305 1315,&quot;</a>
<a name="17738"><span class="lineNum">   17738 </span>                :            :                     &quot; 3315 1339),(4136 3071, 4136 3080, 4143 3020, 4137 3036, 4136 3071),(4218 3073, 4183 3114, 4117 3157, 4159 3147,&quot;</a>
<a name="17739"><span class="lineNum">   17739 </span>                :            :                     &quot; 4218 3073),(3912 3542, 3934 3536, 3955 3536, 3937 3527, 3900 3540, 3912 3542),(4050 3172, 4043 3210, 4085 3209,&quot;</a>
<a name="17740"><span class="lineNum">   17740 </span>                :            :                     &quot; 4090 3179, 4050 3172),(4151 2998, 4158 2977, 4159 2946, 4147 2988, 4151 2998),(2920 3005, 2935 2994, 2864 2973,&quot;</a>
<a name="17741"><span class="lineNum">   17741 </span>                :            :                     &quot; 2905 3016, 2920 3005),(3571 2424, 3545 2469, 3608 2480, 3596 2434, 3571 2424),(4095 1229, 4073 1234, 4076 1293,&quot;</a>
<a name="17742"><span class="lineNum">   17742 </span>                :            :                     &quot; 4121 1285, 4095 1229),(4173 1536, 4153 1576, 4166 1585, 4198 1571, 4188 1532, 4213 1535, 4224 1512, 4224 1511,&quot;</a>
<a name="17743"><span class="lineNum">   17743 </span>                :            :                     &quot; 4209 1511, 4198 1506, 4190 1517, 4194 1509, 4192 1499, 4200 1496, 4202 1504, 4224 1510, 4224 1488, 4215 1486,&quot;</a>
<a name="17744"><span class="lineNum">   17744 </span>                :            :                     &quot; 4216 1478, 4224 1472, 4224 1464, 4207 1458, 4193 1464, 4173 1536),(3934 1537, 3968 1630, 3960 1666, 3968 1673,&quot;</a>
<a name="17745"><span class="lineNum">   17745 </span>                :            :                     &quot; 3975 1562, 3934 1537),(4182 1653, 4196 1624, 4166 1614, 4157 1674, 4216 1671, 4182 1653),(4200 1619, 4196 1620,&quot;</a>
<a name="17746"><span class="lineNum">   17746 </span>                :            :                     &quot; 4200 1632, 4195 1642, 4207 1648, 4200 1619),(4026 1835, 4025 1830, 4016 1808, 4007 1836, 4026 1835),(4199 1384,&quot;</a>
<a name="17747"><span class="lineNum">   17747 </span>                :            :                     &quot; 4182 1389, 4206 1412, 4216 1401, 4199 1384),(3926 1251, 3969 1206, 3913 1149, 3878 1173, 3876 1229, 3926 1251),&quot;</a>
<a name="17748"><span class="lineNum">   17748 </span>                :            :                     &quot; (3926 1354, 3958 1389, 3997 1384, 3991 1352, 3960 1322, 3955 1299, 3926 1354),(3964 1319, 3974 1329, 3984 1285,&quot;</a>
<a name="17749"><span class="lineNum">   17749 </span>                :            :                     &quot; 3963 1301, 3964 1319),(3687 959, 3696 903, 3678 885, 3665 930, 3687 959),(3452 79, 3437 124, 3456 149, 3476 141,&quot;</a>
<a name="17750"><span class="lineNum">   17750 </span>                :            :                     &quot; 3452 79),(3751 927, 3738 906, 3719 942, 3739 929, 3751 927))&quot; );</a>
<a name="17751"><span class="lineNum">   17751 </span>                :            : </a>
<a name="17752"><span class="lineNum">   17752 </span>                :<span class="lineCov">          1 :   QString poly2Wkt( &quot;Polygon ((-128 4224, -128 2734, -11 2643, -101 2919, 120 2654, 19 2846, 217 2897, -13 2873, -79 2998, -106 2989,&quot;</span></a>
<a name="17753"><span class="lineNum">   17753 </span>                :            :                     &quot; -128 3002, -128 4224, -128 4224, 1249 4224, 1247 4199, 1231 4132, 909 3902, 775 3278, 509 2903, 470 2603, 663 2311,&quot;</a>
<a name="17754"><span class="lineNum">   17754 </span>                :            :                     &quot; 889 2134, 989 2146, 534 2585, 575 2880, 833 3112, 833 3037, 1025 2977, 834 3096, 946 3217, 923 3153, 971 3094,&quot;</a>
<a name="17755"><span class="lineNum">   17755 </span>                :            :                     &quot; 997 3103, 1166 3423, 1198 3329, 1233 3367, 1270 3327, 1274 3354, 1290 3360, 1321 3322, 1331 3318, 1343 3325,&quot;</a>
<a name="17756"><span class="lineNum">   17756 </span>                :            :                     &quot; 1310 3073, 1363 3093, 1413 3186, 1325 3398, 1458 3364, 1493 3426, 1526 3394, 1588 3465, 1417 3824, 1458 3825,&quot;</a>
<a name="17757"><span class="lineNum">   17757 </span>                :            :                     &quot; 1522 3849, 1729 3488, 2018 3223, 1908 3291, 1924 3238, 1899 3187, 1913 3150, 2070 3041, 2102 3063, 2112 3053,&quot;</a>
<a name="17758"><span class="lineNum">   17758 </span>                :            :                     &quot; 2168 3085, 2101 2994, 2265 2863, 1890 2593, 2106 2713, 2130 2706, 2108 2678, 2117 2647, 2105 2636, 2099 2604,&quot;</a>
<a name="17759"><span class="lineNum">   17759 </span>                :            :                     &quot; 2094 2591, 2088 2575, 2088 2564, 2249 2751, 2441 2618, 2689 1728, 2681 2323, 2776 1685, 2711 1708, 2673 1680,&quot;</a>
<a name="17760"><span class="lineNum">   17760 </span>                :            :                     &quot; 2675 1639, 2810 1522, 2765 1535, 2734 1510, 2850 1332, 2863 1186, 2847 1025, 2832 985, 2739 1025, 2850 1090,&quot;</a>
<a name="17761"><span class="lineNum">   17761 </span>                :            :                     &quot; 2859 1174, 2853 1235, 2827 1235, 2839 1279, 2811 1286, 2751 1272, 2851 1160, 2788 1159, 2724 1204, 2713 1198,&quot;</a>
<a name="17762"><span class="lineNum">   17762 </span>                :            :                     &quot; 2708 1213, 2699 1221, 2724 1179, 2797 1145, 2785 1123, 2848 1143, 2821 1092, 2284 980, 2288 963, 2264 962,&quot;</a>
<a name="17763"><span class="lineNum">   17763 </span>                :            :                     &quot; 2261 948, 2247 958, 2194 947, 2120 900, 2047 809, 2434 923, 2450 817, 2528 737, 2527 667, 2641 544, 2641 460,&quot;</a>
<a name="17764"><span class="lineNum">   17764 </span>                :            :                     &quot; 2710 452, 2687 447, 2681 435, 2693 330, 2772 327, 2766 291, 2779 245, 2769 219, 2771 198, 2816 219, 2781 342,&quot;</a>
<a name="17765"><span class="lineNum">   17765 </span>                :            :                     &quot; 2612 647, 2903 188, 2803 539, 2950 206, 2927 342, 3123 339, 3092 300, 3073 175, 3082 160, 3412 -103, 4224 -128,&quot;</a>
<a name="17766"><span class="lineNum">   17766 </span>                :            :                     &quot; 4032 167, 3572 63, 3554 109, 3606 211, 3604 232, 3454 124, 3332 345, 3237 212, 3181 415, 2953 364, 2761 692,&quot;</a>
<a name="17767"><span class="lineNum">   17767 </span>                :            :                     &quot; 2819 788, 2997 769, 2997 626, 3199 659, 3155 730, 2929 805, 2908 841, 3218 717, 3276 744, 3246 723, 3270 658,&quot;</a>
<a name="17768"><span class="lineNum">   17768 </span>                :            :                     &quot; 4223 473, 4224 589, 3906 681, 3818 677, 3915 686, 4224 592, 4224 4224, -128 4224, -128 4224),(2049 3181,&quot;</a>
<a name="17769"><span class="lineNum">   17769 </span>                :            :                     &quot; 2224 3084, 2204 3040, 2169 3036, 2174 3084, 2155 3102, 2126 3123, 2109 3127, 2103 3102, 2049 3181),(1578 3811,&quot;</a>
<a name="17770"><span class="lineNum">   17770 </span>                :            :                     &quot; 1567 3883, 1675 3768, 1658 3712, 1659 3751, 1578 3811),(2304 2930, 2335 2918, 2287 2880, 2279 2926, 2304 2930),&quot;</a>
<a name="17771"><span class="lineNum">   17771 </span>                :            :                     &quot; (2316 2895, 2317 2895, 2316 2901, 2331 2901, 2332 2889, 2316 2895),(2304 2850, 2335 2861, 2344 2910, 2357 2828,&quot;</a>
<a name="17772"><span class="lineNum">   17772 </span>                :            :                     &quot; 2304 2850),(1714 3583, 1725 3638, 1682 3717, 1797 3564, 1714 3583),(1537 3873, 1456 3827, 1405 3876, 1461 3898,&quot;</a>
<a name="17773"><span class="lineNum">   17773 </span>                :            :                     &quot; 1537 3873),(2547 2560, 2375 2815, 2384 2825, 2470 2722, 2685 2336, 2648 2310, 2547 2560),(2107 3073, 2107 3098,&quot;</a>
<a name="17774"><span class="lineNum">   17774 </span>                :            :                     &quot; 2144 3086, 2122 3073, 2113 3059, 2107 3073),(2117 3120, 2156 3099, 2164 3083, 2106 3103, 2117 3120),(2303 2981,&quot;</a>
<a name="17775"><span class="lineNum">   17775 </span>                :            :                     &quot; 2226 3010, 2232 3064, 2286 3012, 2344 2928, 2303 2981),(2304 2858, 2291 2864, 2303 2885, 2324 2870, 2304 2858),&quot;</a>
<a name="17776"><span class="lineNum">   17776 </span>                :            :                     &quot; (2175 3002, 2179 2983, 2152 2991, 2175 3002, 2175 3002),(2175 3022, 2150 3017, 2144 3048, 2159 3031, 2184 3030,&quot;</a>
<a name="17777"><span class="lineNum">   17777 </span>                :            :                     &quot; 2175 3022),(2265 2953, 2270 2950, 2262 2950, 2254 2963, 2253 2979, 2265 2953),(2229 2928, 2250 2928, 2241 2922,&quot;</a>
<a name="17778"><span class="lineNum">   17778 </span>                :            :                     &quot; 2239 2914, 2224 2900, 2237 2914, 2229 2928),(2531 2473, 2520 2466, 2521 2474, 2511 2503, 2531 2473),(2547 2526,&quot;</a>
<a name="17779"><span class="lineNum">   17779 </span>                :            :                     &quot; 2529 2519, 2528 2541, 2544 2538, 2547 2526),(2559 646, 2513 810, 2463 835, 2462 930, 2746 731, 2559 646),(3840 653,&quot;</a>
<a name="17780"><span class="lineNum">   17780 </span>                :            :                     &quot; 3809 641, 3718 689, 3547 733, 3553 712, 3440 780, 3840 653),(3327 741, 3242 750, 3195 745, 3180 758, 3326 764,&quot;</a>
<a name="17781"><span class="lineNum">   17781 </span>                :            :                     &quot; 3440 742, 3327 741),(3282 702, 3265 699, 3273 721, 3290 714, 3282 702),(3762 662, 3783 654, 3786 638, 3742 653,&quot;</a>
<a name="17782"><span class="lineNum">   17782 </span>                :            :                     &quot; 3762 662),(3071 703, 3082 741, 3079 655, 3064 657, 3071 703),(3881 637, 3904 647, 3914 626, 3861 638, 3881 637))&quot; );</a>
<a name="17783"><span class="lineNum">   17783 </span>                :            : </a>
<a name="17784"><span class="lineNum">   17784 </span>                :<span class="lineCov">          1 :   QgsGeometry poly1 = QgsGeometry::fromWkt( poly1Wkt );</span></a>
<a name="17785"><span class="lineNum">   17785 </span>                :<span class="lineCov">          1 :   QgsGeometry poly2 = QgsGeometry::fromWkt( poly2Wkt );</span></a>
<a name="17786"><span class="lineNum">   17786 </span>                :            : </a>
<a name="17787"><span class="lineNum">   17787 </span>                :            :   double distance;</a>
<a name="17788"><span class="lineNum">   17788 </span>                :<span class="lineCov">          1 :   QgsPointXY point = poly1.poleOfInaccessibility( 1, &amp;distance ).asPoint();</span></a>
<a name="17789"><span class="lineNum">   17789 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3867.37, 0.01 );</span></a>
<a name="17790"><span class="lineNum">   17790 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 2126.45, 0.01 );</span></a>
<a name="17791"><span class="lineNum">   17791 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( distance, 289.51, 0.01 );</span></a>
<a name="17792"><span class="lineNum">   17792 </span>                :            : </a>
<a name="17793"><span class="lineNum">   17793 </span>                :<span class="lineCov">          1 :   point = poly1.poleOfInaccessibility( 50 ).asPoint();</span></a>
<a name="17794"><span class="lineNum">   17794 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3855.33, 0.01 );</span></a>
<a name="17795"><span class="lineNum">   17795 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 2117.55, 0.01 );</span></a>
<a name="17796"><span class="lineNum">   17796 </span>                :            : </a>
<a name="17797"><span class="lineNum">   17797 </span>                :<span class="lineCov">          1 :   point = poly2.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="17798"><span class="lineNum">   17798 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3263.50, 0.01 );</span></a>
<a name="17799"><span class="lineNum">   17799 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 3263.50, 0.01 );</span></a>
<a name="17800"><span class="lineNum">   17800 </span>                :            : </a>
<a name="17801"><span class="lineNum">   17801 </span>                :            :   //test degenerate polygons</a>
<a name="17802"><span class="lineNum">   17802 </span>                :<span class="lineCov">          2 :   QgsGeometry degen1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 0 0, 1 0, 2 0, 0 0 ))&quot; ) );</span></a>
<a name="17803"><span class="lineNum">   17803 </span>                :<span class="lineCov">          1 :   point = degen1.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="17804"><span class="lineNum">   17804 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 0, 0.01 );</span></a>
<a name="17805"><span class="lineNum">   17805 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 0, 0.01 );</span></a>
<a name="17806"><span class="lineNum">   17806 </span>                :            : </a>
<a name="17807"><span class="lineNum">   17807 </span>                :<span class="lineCov">          2 :   QgsGeometry degen2 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 0 0, 1 0, 1 1 , 1 0, 0 0 ))&quot; ) );</span></a>
<a name="17808"><span class="lineNum">   17808 </span>                :<span class="lineCov">          1 :   point = degen2.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="17809"><span class="lineNum">   17809 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 0, 0.01 );</span></a>
<a name="17810"><span class="lineNum">   17810 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 0, 0.01 );</span></a>
<a name="17811"><span class="lineNum">   17811 </span>                :            : </a>
<a name="17812"><span class="lineNum">   17812 </span>                :            :   //empty geometry</a>
<a name="17813"><span class="lineNum">   17813 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry().poleOfInaccessibility( 1 ).isNull() );</span></a>
<a name="17814"><span class="lineNum">   17814 </span>                :            : </a>
<a name="17815"><span class="lineNum">   17815 </span>                :            :   // not a polygon</a>
<a name="17816"><span class="lineNum">   17816 </span>                :<span class="lineCov">          2 :   QgsGeometry lineString = QgsGeometry::fromWkt( QStringLiteral( &quot;LineString(1 0, 2 2 )&quot; ) );</span></a>
<a name="17817"><span class="lineNum">   17817 </span>                :<span class="lineCov">          1 :   QVERIFY( lineString.poleOfInaccessibility( 1 ).isNull() );</span></a>
<a name="17818"><span class="lineNum">   17818 </span>                :            : </a>
<a name="17819"><span class="lineNum">   17819 </span>                :            :   // invalid threshold</a>
<a name="17820"><span class="lineNum">   17820 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1.poleOfInaccessibility( -1 ).isNull() );</span></a>
<a name="17821"><span class="lineNum">   17821 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1.poleOfInaccessibility( 0 ).isNull() );</span></a>
<a name="17822"><span class="lineNum">   17822 </span>                :            : </a>
<a name="17823"><span class="lineNum">   17823 </span>                :            :   // curved geometry</a>
<a name="17824"><span class="lineNum">   17824 </span>                :<span class="lineCov">          1 :   QgsGeometry curved = QgsGeometry::fromWkt( &quot;CurvePolygon( CompoundCurve( CircularString(-0.44 0.35, 0.51 0.34, 0.56 0.21, 0.11 -0.33, 0.15 -0.35,&quot;</span></a>
<a name="17825"><span class="lineNum">   17825 </span>                :            :                        &quot;-0.93 -0.30, -1.02 -0.22, -0.49 0.01, -0.23 -0.04),(-0.23 -0.04, -0.44, 0.35)))&quot; );</a>
<a name="17826"><span class="lineNum">   17826 </span>                :<span class="lineCov">          1 :   point = curved.poleOfInaccessibility( 0.01 ).asPoint();</span></a>
<a name="17827"><span class="lineNum">   17827 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), -0.4324, 0.0001 );</span></a>
<a name="17828"><span class="lineNum">   17828 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), -0.2434, 0.0001 );</span></a>
<a name="17829"><span class="lineNum">   17829 </span>                :            : </a>
<a name="17830"><span class="lineNum">   17830 </span>                :            :   // multipolygon</a>
<a name="17831"><span class="lineNum">   17831 </span>                :<span class="lineCov">          2 :   QgsGeometry multiPoly = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0)),((30 30, 50 30, 50 60, 30 60, 30 30)))&quot; ) );</span></a>
<a name="17832"><span class="lineNum">   17832 </span>                :<span class="lineCov">          1 :   point = multiPoly.poleOfInaccessibility( 0.01, &amp;distance ).asPoint();</span></a>
<a name="17833"><span class="lineNum">   17833 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 40, 0.0001 );</span></a>
<a name="17834"><span class="lineNum">   17834 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 45, 0.0001 );</span></a>
<a name="17835"><span class="lineNum">   17835 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( distance, 10.0, 0.00001 );</span></a>
<a name="17836"><span class="lineNum">   17836 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17837"><span class="lineNum">   17837 </span>                :            : </a>
<a name="17838"><span class="lineNum">   17838 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::makeValid()</span></a>
<a name="17839"><span class="lineNum">   17839 </span>                :            : {</a>
<a name="17840"><span class="lineNum">   17840 </span>                :            :   typedef QPair&lt;QString, QString&gt; InputAndExpectedWktPair;</a>
<a name="17841"><span class="lineNum">   17841 </span>                :<span class="lineCov">          1 :   QList&lt;InputAndExpectedWktPair&gt; geoms;</span></a>
<a name="17842"><span class="lineNum">   17842 </span>                :            :   // dimension collapse</a>
<a name="17843"><span class="lineNum">   17843 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;LINESTRING(0 0)&quot; ),</span></a>
<a name="17844"><span class="lineNum">   17844 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;POINT(0 0)&quot; ) );</span></a>
<a name="17845"><span class="lineNum">   17845 </span>                :            :   // unclosed ring</a>
<a name="17846"><span class="lineNum">   17846 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;POLYGON((10 22,10 32,20 32,20 22))&quot; ),</span></a>
<a name="17847"><span class="lineNum">   17847 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;POLYGON((10 22,10 32,20 32,20 22,10 22))&quot; ) );</span></a>
<a name="17848"><span class="lineNum">   17848 </span>                :            :   // butterfly polygon (self-intersecting ring)</a>
<a name="17849"><span class="lineNum">   17849 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;POLYGON((0 0, 10 10, 10 0, 0 10, 0 0))&quot; ),</span></a>
<a name="17850"><span class="lineNum">   17850 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;MULTIPOLYGON(((5 5, 0 0, 0 10, 5 5)),((5 5, 10 10, 10 0, 5 5)))&quot; ) );</span></a>
<a name="17851"><span class="lineNum">   17851 </span>                :            :   // polygon with extra tail (a part of the ring does not form any area)</a>
<a name="17852"><span class="lineNum">   17852 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;POLYGON((0 0, 1 0, 1 1, 0 1, 0 0, -1 0, 0 0))&quot; ),</span></a>
<a name="17853"><span class="lineNum">   17853 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;GEOMETRYCOLLECTION(POLYGON((0 0, 0 1, 1 1, 1 0, 0 0)), LINESTRING(0 0, -1 0))&quot; ) );</span></a>
<a name="17854"><span class="lineNum">   17854 </span>                :            :   // collection with invalid geometries</a>
<a name="17855"><span class="lineNum">   17855 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(0 0, 0 0), POLYGON((0 0, 10 10, 10 0, 0 10, 0 0)), LINESTRING(10 0, 10 10))&quot; ),</span></a>
<a name="17856"><span class="lineNum">   17856 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;GEOMETRYCOLLECTION(POINT(0 0), MULTIPOLYGON(((5 5, 0 0, 0 10, 5 5)),((5 5, 10 10, 10 0, 5 5))), LINESTRING(10 0, 10 10))&quot; ) );</span></a>
<a name="17857"><span class="lineNum">   17857 </span>                :            :   // null line (#18077)</a>
<a name="17858"><span class="lineNum">   17858 </span>                :<span class="lineCov">          3 :   geoms &lt;&lt; qMakePair( QStringLiteral( &quot;MultiLineString ((356984.0625 6300089, 356984.0625 6300089))&quot; ),</span></a>
<a name="17859"><span class="lineNum">   17859 </span>                :<span class="lineCov">          2 :                       QStringLiteral( &quot;MultiPoint ((356984.0625 6300089))&quot; ) );</span></a>
<a name="17860"><span class="lineNum">   17860 </span>                :            : </a>
<a name="17861"><span class="lineNum">   17861 </span>                :<span class="lineCov">          7 :   for ( const InputAndExpectedWktPair &amp;pair : geoms )</span></a>
<a name="17862"><span class="lineNum">   17862 </span>                :            :   {</a>
<a name="17863"><span class="lineNum">   17863 </span>                :<span class="lineCov">          6 :     QgsGeometry gInput = QgsGeometry::fromWkt( pair.first );</span></a>
<a name="17864"><span class="lineNum">   17864 </span>                :<span class="lineCov">          6 :     QgsGeometry gExp = QgsGeometry::fromWkt( pair.second );</span></a>
<a name="17865"><span class="lineNum">   17865 </span>                :<span class="lineCov">          6 :     QVERIFY( !gInput.isNull() );</span></a>
<a name="17866"><span class="lineNum">   17866 </span>                :<span class="lineCov">          6 :     QVERIFY( !gExp.isNull() );</span></a>
<a name="17867"><span class="lineNum">   17867 </span>                :            : </a>
<a name="17868"><span class="lineNum">   17868 </span>                :<span class="lineCov">          6 :     QgsGeometry gValid = gInput.makeValid();</span></a>
<a name="17869"><span class="lineNum">   17869 </span>                :<span class="lineCov">          6 :     QVERIFY( gValid.isGeosValid() );</span></a>
<a name="17870"><span class="lineNum">   17870 </span>                :<span class="lineCov">          6 :     QVERIFY( gValid.isGeosEqual( gExp ) );</span></a>
<a name="17871"><span class="lineNum">   17871 </span>                :<span class="lineCov">          6 :   }</span></a>
<a name="17872"><span class="lineNum">   17872 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17873"><span class="lineNum">   17873 </span>                :            : </a>
<a name="17874"><span class="lineNum">   17874 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isSimple_data()</span></a>
<a name="17875"><span class="lineNum">   17875 </span>                :            : {</a>
<a name="17876"><span class="lineNum">   17876 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;wkt&quot; );</span></a>
<a name="17877"><span class="lineNum">   17877 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;bool&gt;( &quot;simple&quot; );</span></a>
<a name="17878"><span class="lineNum">   17878 </span>                :            : </a>
<a name="17879"><span class="lineNum">   17879 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;linestring&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1)&quot; ) &lt;&lt; true;</span></a>
<a name="17880"><span class="lineNum">   17880 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;may be closed (linear ring)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0 0)&quot; ) &lt;&lt; true;</span></a>
<a name="17881"><span class="lineNum">   17881 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;self-intersection&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0 -1)&quot; ) &lt;&lt; false;</span></a>
<a name="17882"><span class="lineNum">   17882 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;self-tangency&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0.5 0, 0 1)&quot; ) &lt;&lt; false;</span></a>
<a name="17883"><span class="lineNum">   17883 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;points are simple&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 1)&quot; ) &lt;&lt; true;</span></a>
<a name="17884"><span class="lineNum">   17884 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;multipoint&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 1), (2 2))&quot; ) &lt;&lt; true;</span></a>
<a name="17885"><span class="lineNum">   17885 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;must not contain the same point twice&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 1), (1 1))&quot; ) &lt;&lt; false;</span></a>
<a name="17886"><span class="lineNum">   17886 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;multiline string simple&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 0), (0 1, 1 1))&quot; ) &lt;&lt; true;</span></a>
<a name="17887"><span class="lineNum">   17887 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;may be touching at endpoints&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 0), (0 0, 1 0))&quot; ) &lt;&lt; true;</span></a>
<a name="17888"><span class="lineNum">   17888 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;must not intersect each other&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 1), (0 1, 1 0))&quot; ) &lt;&lt; false;</span></a>
<a name="17889"><span class="lineNum">   17889 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17890"><span class="lineNum">   17890 </span>                :            : </a>
<a name="17891"><span class="lineNum">   17891 </span>                :<span class="lineCov">         10 : void TestQgsGeometry::isSimple()</span></a>
<a name="17892"><span class="lineNum">   17892 </span>                :            : {</a>
<a name="17893"><span class="lineNum">   17893 </span>                :<span class="lineCov">         10 :   QFETCH( QString, wkt );</span></a>
<a name="17894"><span class="lineNum">   17894 </span>                :<span class="lineCov">         10 :   QFETCH( bool, simple );</span></a>
<a name="17895"><span class="lineNum">   17895 </span>                :            : </a>
<a name="17896"><span class="lineNum">   17896 </span>                :<span class="lineCov">         10 :   QgsGeometry gInput = QgsGeometry::fromWkt( wkt );</span></a>
<a name="17897"><span class="lineNum">   17897 </span>                :<span class="lineCov">         10 :   QVERIFY( !gInput.isNull() );</span></a>
<a name="17898"><span class="lineNum">   17898 </span>                :            : </a>
<a name="17899"><span class="lineNum">   17899 </span>                :<span class="lineCov">         10 :   bool res = gInput.isSimple();</span></a>
<a name="17900"><span class="lineNum">   17900 </span>                :<span class="lineCov">         10 :   QCOMPARE( res, simple );</span></a>
<a name="17901"><span class="lineNum">   17901 </span>                :<span class="lineCov">         10 : }</span></a>
<a name="17902"><span class="lineNum">   17902 </span>                :            : </a>
<a name="17903"><span class="lineNum">   17903 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::reshapeGeometryLineMerge()</span></a>
<a name="17904"><span class="lineNum">   17904 </span>                :            : {</a>
<a name="17905"><span class="lineNum">   17905 </span>                :            :   int res;</a>
<a name="17906"><span class="lineNum">   17906 </span>                :<span class="lineCov">          2 :   QgsGeometry g2D = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRING(10 10, 20 20)&quot; ) );</span></a>
<a name="17907"><span class="lineNum">   17907 </span>                :<span class="lineCov">          2 :   QgsGeometry g3D = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRINGZ(10 10 1, 20 20 2)&quot; ) );</span></a>
<a name="17908"><span class="lineNum">   17908 </span>                :            : </a>
<a name="17909"><span class="lineNum">   17909 </span>                :            :   // prepare 2D reshaping line</a>
<a name="17910"><span class="lineNum">   17910 </span>                :<span class="lineCov">          1 :   QgsPointSequence v2D_1, v2D_2;</span></a>
<a name="17911"><span class="lineNum">   17911 </span>                :<span class="lineCov">          1 :   v2D_1 &lt;&lt; QgsPoint( 20, 20 ) &lt;&lt; QgsPoint( 30, 30 );</span></a>
<a name="17912"><span class="lineNum">   17912 </span>                :<span class="lineCov">          1 :   v2D_2 &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( -10, -10 );</span></a>
<a name="17913"><span class="lineNum">   17913 </span>                :<span class="lineCov">          1 :   QgsLineString line2D_1( v2D_1 ), line2D_2( v2D_2 );</span></a>
<a name="17914"><span class="lineNum">   17914 </span>                :            : </a>
<a name="17915"><span class="lineNum">   17915 </span>                :            :   // prepare 3D reshaping line</a>
<a name="17916"><span class="lineNum">   17916 </span>                :<span class="lineCov">          1 :   QgsPointSequence v3D_1, v3D_2;</span></a>
<a name="17917"><span class="lineNum">   17917 </span>                :<span class="lineCov">          1 :   v3D_1 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 20, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 30, 3 );</span></a>
<a name="17918"><span class="lineNum">   17918 </span>                :<span class="lineCov">          1 :   v3D_2 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, -10, -10, -1 );</span></a>
<a name="17919"><span class="lineNum">   17919 </span>                :<span class="lineCov">          1 :   QgsLineString line3D_1( v3D_1 ), line3D_2( v3D_2 );</span></a>
<a name="17920"><span class="lineNum">   17920 </span>                :            : </a>
<a name="17921"><span class="lineNum">   17921 </span>                :            :   // append with 2D line</a>
<a name="17922"><span class="lineNum">   17922 </span>                :<span class="lineCov">          1 :   QgsGeometry g2D_1 = g2D;</span></a>
<a name="17923"><span class="lineNum">   17923 </span>                :<span class="lineCov">          1 :   res = g2D_1.reshapeGeometry( line2D_1 );</span></a>
<a name="17924"><span class="lineNum">   17924 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="17925"><span class="lineNum">   17925 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2D_1.asWkt(), QString( &quot;LineString (10 10, 20 20, 30 30)&quot; ) );</span></a>
<a name="17926"><span class="lineNum">   17926 </span>                :            : </a>
<a name="17927"><span class="lineNum">   17927 </span>                :            :   // prepend with 2D line</a>
<a name="17928"><span class="lineNum">   17928 </span>                :<span class="lineCov">          1 :   QgsGeometry g2D_2 = g2D;</span></a>
<a name="17929"><span class="lineNum">   17929 </span>                :<span class="lineCov">          1 :   res = g2D_2.reshapeGeometry( line2D_2 );</span></a>
<a name="17930"><span class="lineNum">   17930 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="17931"><span class="lineNum">   17931 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2D_2.asWkt(), QString( &quot;LineString (-10 -10, 10 10, 20 20)&quot; ) );</span></a>
<a name="17932"><span class="lineNum">   17932 </span>                :            : </a>
<a name="17933"><span class="lineNum">   17933 </span>                :            :   // append with 3D line</a>
<a name="17934"><span class="lineNum">   17934 </span>                :<span class="lineCov">          1 :   QgsGeometry g3D_1 = g3D;</span></a>
<a name="17935"><span class="lineNum">   17935 </span>                :<span class="lineCov">          1 :   res = g3D_1.reshapeGeometry( line3D_1 );</span></a>
<a name="17936"><span class="lineNum">   17936 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="17937"><span class="lineNum">   17937 </span>                :<span class="lineCov">          1 :   QCOMPARE( g3D_1.asWkt(), QString( &quot;LineStringZ (10 10 1, 20 20 2, 30 30 3)&quot; ) );</span></a>
<a name="17938"><span class="lineNum">   17938 </span>                :            : </a>
<a name="17939"><span class="lineNum">   17939 </span>                :            :   // prepend with 3D line</a>
<a name="17940"><span class="lineNum">   17940 </span>                :<span class="lineCov">          1 :   QgsGeometry g3D_2 = g3D;</span></a>
<a name="17941"><span class="lineNum">   17941 </span>                :<span class="lineCov">          1 :   res = g3D_2.reshapeGeometry( line3D_2 );</span></a>
<a name="17942"><span class="lineNum">   17942 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="17943"><span class="lineNum">   17943 </span>                :<span class="lineCov">          1 :   QCOMPARE( g3D_2.asWkt(), QString( &quot;LineStringZ (-10 -10 -1, 10 10 1, 20 20 2)&quot; ) );</span></a>
<a name="17944"><span class="lineNum">   17944 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17945"><span class="lineNum">   17945 </span>                :            : </a>
<a name="17946"><span class="lineNum">   17946 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::createCollectionOfType()</span></a>
<a name="17947"><span class="lineNum">   17947 </span>                :            : {</a>
<a name="17948"><span class="lineNum">   17948 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryCollection &gt; collect( QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::Unknown ) );</span></a>
<a name="17949"><span class="lineNum">   17949 </span>                :<span class="lineCov">          1 :   QVERIFY( !collect );</span></a>
<a name="17950"><span class="lineNum">   17950 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::Point );</span></a>
<a name="17951"><span class="lineNum">   17951 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="17952"><span class="lineNum">   17952 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="17953"><span class="lineNum">   17953 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointM );</span></a>
<a name="17954"><span class="lineNum">   17954 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="17955"><span class="lineNum">   17955 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="17956"><span class="lineNum">   17956 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointZM );</span></a>
<a name="17957"><span class="lineNum">   17957 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="17958"><span class="lineNum">   17958 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="17959"><span class="lineNum">   17959 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointZ );</span></a>
<a name="17960"><span class="lineNum">   17960 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="17961"><span class="lineNum">   17961 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="17962"><span class="lineNum">   17962 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::MultiPoint );</span></a>
<a name="17963"><span class="lineNum">   17963 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="17964"><span class="lineNum">   17964 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="17965"><span class="lineNum">   17965 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::LineStringZ );</span></a>
<a name="17966"><span class="lineNum">   17966 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="17967"><span class="lineNum">   17967 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiLineString *&gt;( collect.get() ) );</span></a>
<a name="17968"><span class="lineNum">   17968 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PolygonM );</span></a>
<a name="17969"><span class="lineNum">   17969 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="17970"><span class="lineNum">   17970 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPolygon *&gt;( collect.get() ) );</span></a>
<a name="17971"><span class="lineNum">   17971 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::GeometryCollectionZ );</span></a>
<a name="17972"><span class="lineNum">   17972 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::GeometryCollectionZ );</span></a>
<a name="17973"><span class="lineNum">   17973 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsGeometryCollection *&gt;( collect.get() ) );</span></a>
<a name="17974"><span class="lineNum">   17974 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::CurvePolygonM );</span></a>
<a name="17975"><span class="lineNum">   17975 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="17976"><span class="lineNum">   17976 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiSurface *&gt;( collect.get() ) );</span></a>
<a name="17977"><span class="lineNum">   17977 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="17978"><span class="lineNum">   17978 </span>                :            : </a>
<a name="17979"><span class="lineNum">   17979 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::orientedMinimumBoundingBox()</span></a>
<a name="17980"><span class="lineNum">   17980 </span>                :            : {</a>
<a name="17981"><span class="lineNum">   17981 </span>                :<span class="lineCov">          1 :   QgsGeometry geomTest;</span></a>
<a name="17982"><span class="lineNum">   17982 </span>                :<span class="lineCov">          1 :   QgsGeometry result, resultTest;</span></a>
<a name="17983"><span class="lineNum">   17983 </span>                :            :   // empty</a>
<a name="17984"><span class="lineNum">   17984 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="17985"><span class="lineNum">   17985 </span>                :<span class="lineCov">          1 :   QVERIFY( result.isEmpty() );</span></a>
<a name="17986"><span class="lineNum">   17986 </span>                :            : </a>
<a name="17987"><span class="lineNum">   17987 </span>                :            :   // oriented rectangle</a>
<a name="17988"><span class="lineNum">   17988 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot; Polygon(0 0, 5 5, -2.07106781186547462 12.07106781186547551, -7.07106781186547462 7.07106781186547551, 0 0) &quot; ) );</span></a>
<a name="17989"><span class="lineNum">   17989 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="17990"><span class="lineNum">   17990 </span>                :<span class="lineCov">          1 :   QgsPolygonXY geomXY, resultXY;</span></a>
<a name="17991"><span class="lineNum">   17991 </span>                :<span class="lineCov">          1 :   geomXY = geomTest.asPolygon();</span></a>
<a name="17992"><span class="lineNum">   17992 </span>                :<span class="lineCov">          1 :   resultXY = result.asPolygon();</span></a>
<a name="17993"><span class="lineNum">   17993 </span>                :            : </a>
<a name="17994"><span class="lineNum">   17994 </span>                :<span class="lineCov">          1 :   QCOMPARE( geomXY.count(), resultXY.count() );</span></a>
<a name="17995"><span class="lineNum">   17995 </span>                :            :   // can't strictly compare, use tolerance</a>
<a name="17996"><span class="lineNum">   17996 </span>                :<span class="lineCov">          1 :   for ( int i = 0 ; i &lt; geomXY.count() ; ++i )</span></a>
<a name="17997"><span class="lineNum">   17997 </span>                :            :   {</a>
<a name="17998"><span class="lineNum">   17998 </span>                :<span class="lineNoCov">          0 :     QVERIFY( geomXY.at( 0 ).at( i ).compare( resultXY.at( 0 ).at( i ), 1E-8 ) );</span></a>
<a name="17999"><span class="lineNum">   17999 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="18000"><span class="lineNum">   18000 </span>                :            : </a>
<a name="18001"><span class="lineNum">   18001 </span>                :            :   // Issue https://github.com/qgis/QGIS/issues/33532</a>
<a name="18002"><span class="lineNum">   18002 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot; Polygon ((264 -525, 248 -521, 244 -519, 233 -508, 231 -504, 210 -445, 196 -396, 180 -332, 178 -322, 176 -310, 174 -296, 174 -261, 176 -257, 178 -255, 183 -251, 193 -245, 197 -243, 413 -176, 439 -168, 447 -166, 465 -164, 548 -164, 552 -166, 561 -175, 567 -187, 602 -304, 618 -379, 618 -400, 616 -406, 612 -414, 606 -420, 587 -430, 575 -436, 547 -446, 451 -474, 437 -478, 321 -511, 283 -521, 275 -523, 266 -525, 264 -525)) &quot; ) );</span></a>
<a name="18003"><span class="lineNum">   18003 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="18004"><span class="lineNum">   18004 </span>                :<span class="lineCov">          2 :   QString resultTestWKT = QStringLiteral( &quot;Polygon ((635.86 -420.08, 552.66 -134.85, 153.5 -251.27, 236.69 -536.51, 635.86 -420.08))&quot; );</span></a>
<a name="18005"><span class="lineNum">   18005 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.asWkt( 2 ), resultTestWKT );</span></a>
<a name="18006"><span class="lineNum">   18006 </span>                :            : </a>
<a name="18007"><span class="lineNum">   18007 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18008"><span class="lineNum">   18008 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::minimalEnclosingCircle()</span></a>
<a name="18009"><span class="lineNum">   18009 </span>                :            : {</a>
<a name="18010"><span class="lineNum">   18010 </span>                :<span class="lineCov">          1 :   QgsGeometry geomTest;</span></a>
<a name="18011"><span class="lineNum">   18011 </span>                :<span class="lineCov">          1 :   QgsGeometry result, resultTest;</span></a>
<a name="18012"><span class="lineNum">   18012 </span>                :<span class="lineCov">          1 :   QgsPointXY center;</span></a>
<a name="18013"><span class="lineNum">   18013 </span>                :            :   double radius;</a>
<a name="18014"><span class="lineNum">   18014 </span>                :            : </a>
<a name="18015"><span class="lineNum">   18015 </span>                :            :   // empty</a>
<a name="18016"><span class="lineNum">   18016 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius );</span></a>
<a name="18017"><span class="lineNum">   18017 </span>                :<span class="lineCov">          1 :   QCOMPARE( center, QgsPointXY() );</span></a>
<a name="18018"><span class="lineNum">   18018 </span>                :<span class="lineCov">          1 :   QCOMPARE( radius, 0.0 );</span></a>
<a name="18019"><span class="lineNum">   18019 </span>                :<span class="lineCov">          1 :   QVERIFY( result.isNull() );</span></a>
<a name="18020"><span class="lineNum">   18020 </span>                :            : </a>
<a name="18021"><span class="lineNum">   18021 </span>                :            :   // case 1</a>
<a name="18022"><span class="lineNum">   18022 </span>                :<span class="lineCov">          1 :   geomTest = QgsGeometry::fromPointXY( QgsPointXY( 5, 5 ) );</span></a>
<a name="18023"><span class="lineNum">   18023 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius );</span></a>
<a name="18024"><span class="lineNum">   18024 </span>                :<span class="lineCov">          1 :   QCOMPARE( center, QgsPointXY( 5, 5 ) );</span></a>
<a name="18025"><span class="lineNum">   18025 </span>                :<span class="lineCov">          1 :   QCOMPARE( radius, 0.0 );</span></a>
<a name="18026"><span class="lineNum">   18026 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="18027"><span class="lineNum">   18027 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.asWkt(), resultTest.asWkt() );</span></a>
<a name="18028"><span class="lineNum">   18028 </span>                :            : </a>
<a name="18029"><span class="lineNum">   18029 </span>                :            :   // case 2</a>
<a name="18030"><span class="lineNum">   18030 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 3 8, 7 4 )&quot; ) );</span></a>
<a name="18031"><span class="lineNum">   18031 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18032"><span class="lineNum">   18032 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 5, 6 ), 0.0001 );</span></a>
<a name="18033"><span class="lineNum">   18033 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, sqrt( 2 ) * 2, 0.0001 );</span></a>
<a name="18034"><span class="lineNum">   18034 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((7 4, 4.3 3.3, 2.3 5.3, 3 8, 5.7 8.7, 7.7 6.7, 7 4))&quot; ) );</span></a>
<a name="18035"><span class="lineNum">   18035 </span>                :            : </a>
<a name="18036"><span class="lineNum">   18036 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRING( 0 5, 2 2, 0 -5, -1 -1 )&quot; ) );</span></a>
<a name="18037"><span class="lineNum">   18037 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18038"><span class="lineNum">   18038 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="18039"><span class="lineNum">   18039 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="18040"><span class="lineNum">   18040 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="18041"><span class="lineNum">   18041 </span>                :            : </a>
<a name="18042"><span class="lineNum">   18042 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 0 5, 2 2, 0 -5, -1 -1 )&quot; ) );</span></a>
<a name="18043"><span class="lineNum">   18043 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18044"><span class="lineNum">   18044 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="18045"><span class="lineNum">   18045 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="18046"><span class="lineNum">   18046 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="18047"><span class="lineNum">   18047 </span>                :            : </a>
<a name="18048"><span class="lineNum">   18048 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;POLYGON(( 0 5, 2 2, 0 -5, -1 -1 ))&quot; ) );</span></a>
<a name="18049"><span class="lineNum">   18049 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18050"><span class="lineNum">   18050 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="18051"><span class="lineNum">   18051 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="18052"><span class="lineNum">   18052 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="18053"><span class="lineNum">   18053 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="18054"><span class="lineNum">   18054 </span>                :            : </a>
<a name="18055"><span class="lineNum">   18055 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 0 5, 0 -5, 0 0 )&quot; ) );</span></a>
<a name="18056"><span class="lineNum">   18056 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18057"><span class="lineNum">   18057 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="18058"><span class="lineNum">   18058 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="18059"><span class="lineNum">   18059 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="18060"><span class="lineNum">   18060 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="18061"><span class="lineNum">   18061 </span>                :            : </a>
<a name="18062"><span class="lineNum">   18062 </span>                :            :   // case 3</a>
<a name="18063"><span class="lineNum">   18063 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT((0 0), (5 5), (0 -5), (0 5), (-5 0))&quot; ) );</span></a>
<a name="18064"><span class="lineNum">   18064 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="18065"><span class="lineNum">   18065 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0.8333, 0.8333 ), 0.0001 );</span></a>
<a name="18066"><span class="lineNum">   18066 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5.8926, 0.0001 );</span></a>
<a name="18067"><span class="lineNum">   18067 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="18068"><span class="lineNum">   18068 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0.8 6.7, 5.9 3.8, 5.9 -2.1, 0.8 -5.1, -4.3 -2.1, -4.3 3.8, 0.8 6.7))&quot; ) );</span></a>
<a name="18069"><span class="lineNum">   18069 </span>                :            : </a>
<a name="18070"><span class="lineNum">   18070 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18071"><span class="lineNum">   18071 </span>                :            : </a>
<a name="18072"><span class="lineNum">   18072 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::splitGeometry()</span></a>
<a name="18073"><span class="lineNum">   18073 </span>                :            : {</a>
<a name="18074"><span class="lineNum">   18074 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsGeometry&gt; newGeoms;</span></a>
<a name="18075"><span class="lineNum">   18075 </span>                :<span class="lineCov">          1 :   QgsPointSequence testPoints;</span></a>
<a name="18076"><span class="lineNum">   18076 </span>                :<span class="lineCov">          1 :   qDebug() &lt;&lt; GEOSversion() &lt;&lt; &quot;\n&quot;;</span></a>
<a name="18077"><span class="lineNum">   18077 </span>                :<span class="lineCov">          2 :   QgsGeometry g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((492980.38648063864093274 7082334.45244149677455425, 493082.65415841294452548 7082319.87918917648494244, 492980.38648063858272508 7082334.45244149677455425, 492980.38648063864093274 7082334.45244149677455425))&quot; ) );</span></a>
<a name="18078"><span class="lineNum">   18078 </span>                :            :   if ( GEOS_VERSION_MAJOR == 3 &amp;&amp; GEOS_VERSION_MINOR &lt; 9 )</a>
<a name="18079"><span class="lineNum">   18079 </span>                :            :   {</a>
<a name="18080"><span class="lineNum">   18080 </span>                :            :     QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 493825.46541286131832749, 7082214.02779923938214779 ) &lt;&lt; QgsPoint( 492955.04876351181883365, 7082338.06309300474822521 ),</a>
<a name="18081"><span class="lineNum">   18081 </span>                :            :                                 newGeoms, false, testPoints ), QgsGeometry::NothingHappened );</a>
<a name="18082"><span class="lineNum">   18082 </span>                :            :   }</a>
<a name="18083"><span class="lineNum">   18083 </span>                :            :   else</a>
<a name="18084"><span class="lineNum">   18084 </span>                :            :   {</a>
<a name="18085"><span class="lineNum">   18085 </span>                :<span class="lineCov">          1 :     QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 493825.46541286131832749, 7082214.02779923938214779 ) &lt;&lt; QgsPoint( 492955.04876351181883365, 7082338.06309300474822521 ),</span></a>
<a name="18086"><span class="lineNum">   18086 </span>                :            :                                 newGeoms, false, testPoints ), QgsGeometry::InvalidBaseGeometry );</a>
<a name="18087"><span class="lineNum">   18087 </span>                :            :   }</a>
<a name="18088"><span class="lineNum">   18088 </span>                :<span class="lineCov">          1 :   QVERIFY( newGeoms.isEmpty() );</span></a>
<a name="18089"><span class="lineNum">   18089 </span>                :            : </a>
<a name="18090"><span class="lineNum">   18090 </span>                :            :   // Bug https://github.com/qgis/QGIS/issues/33489</a>
<a name="18091"><span class="lineNum">   18091 </span>                :<span class="lineCov">          1 :   QgsGeometry g2 = QgsGeometry::fromWkt( &quot;CompoundCurveZ ((2749546.2003820720128715 1262904.45356595050543547 100, 2749557.82053794478997588 1262920.05570670193992555 200))&quot; );</span></a>
<a name="18092"><span class="lineNum">   18092 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="18093"><span class="lineNum">   18093 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18094"><span class="lineNum">   18094 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 2749544.19, 1262914.79, 0 ) &lt;&lt; QgsPoint( 2749557.64, 1262897.30, 0 ), newGeoms, false, testPoints ), QgsGeometry::Success );</span></a>
<a name="18095"><span class="lineNum">   18095 </span>                :<span class="lineCov">          1 :   QVERIFY( newGeoms.count() == 1 );</span></a>
<a name="18096"><span class="lineNum">   18096 </span>                :<span class="lineCov">          2 :   QCOMPARE( newGeoms[0].asWkt( 2 ), QStringLiteral( &quot;LineStringZ (2749549.12 1262908.38 125.14, 2749557.82 1262920.06 200)&quot; ) );</span></a>
<a name="18097"><span class="lineNum">   18097 </span>                :            : </a>
<a name="18098"><span class="lineNum">   18098 </span>                :            :   // Test split geometry with topological editing</a>
<a name="18099"><span class="lineNum">   18099 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsPointXY&gt; testPointsXY;</span></a>
<a name="18100"><span class="lineNum">   18100 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="18101"><span class="lineNum">   18101 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18102"><span class="lineNum">   18102 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="18103"><span class="lineNum">   18103 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints ), QgsGeometry::Success );</span></a>
<a name="18104"><span class="lineNum">   18104 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 1 );</span></a>
<a name="18105"><span class="lineNum">   18105 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="18106"><span class="lineNum">   18106 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="18107"><span class="lineNum">   18107 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18108"><span class="lineNum">   18108 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18109"><span class="lineNum">   18109 </span>                :            : </a>
<a name="18110"><span class="lineNum">   18110 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18111"><span class="lineNum">   18111 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="18112"><span class="lineNum">   18112 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18113"><span class="lineNum">   18113 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="18114"><span class="lineNum">   18114 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints ), QgsGeometry::Success );</span></a>
<a name="18115"><span class="lineNum">   18115 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="18116"><span class="lineNum">   18116 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="18117"><span class="lineNum">   18117 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="18118"><span class="lineNum">   18118 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18119"><span class="lineNum">   18119 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18120"><span class="lineNum">   18120 </span>                :            : </a>
<a name="18121"><span class="lineNum">   18121 </span>                :            :   // Test split parts with topological editing</a>
<a name="18122"><span class="lineNum">   18122 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18123"><span class="lineNum">   18123 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="18124"><span class="lineNum">   18124 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18125"><span class="lineNum">   18125 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="18126"><span class="lineNum">   18126 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints, false ), QgsGeometry::Success );</span></a>
<a name="18127"><span class="lineNum">   18127 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="18128"><span class="lineNum">   18128 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="18129"><span class="lineNum">   18129 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="18130"><span class="lineNum">   18130 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18131"><span class="lineNum">   18131 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18132"><span class="lineNum">   18132 </span>                :            : </a>
<a name="18133"><span class="lineNum">   18133 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18134"><span class="lineNum">   18134 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="18135"><span class="lineNum">   18135 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18136"><span class="lineNum">   18136 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="18137"><span class="lineNum">   18137 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints, false ), QgsGeometry::Success );</span></a>
<a name="18138"><span class="lineNum">   18138 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 3 );</span></a>
<a name="18139"><span class="lineNum">   18139 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="18140"><span class="lineNum">   18140 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="18141"><span class="lineNum">   18141 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18142"><span class="lineNum">   18142 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18143"><span class="lineNum">   18143 </span>                :            : </a>
<a name="18144"><span class="lineNum">   18144 </span>                :            :   // Repeat previous tests with QVector&lt;QgsPointXY&gt; instead of QgsPointSequence</a>
<a name="18145"><span class="lineNum">   18145 </span>                :            :   // Those tests are for the deprecated QgsGeometry::splitGeometry() variant and should be removed in QGIS 4.0</a>
<a name="18146"><span class="lineNum">   18146 </span>                :            :   Q_NOWARN_DEPRECATED_PUSH</a>
<a name="18147"><span class="lineNum">   18147 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18148"><span class="lineNum">   18148 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18149"><span class="lineNum">   18149 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="18150"><span class="lineNum">   18150 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY ), QgsGeometry::Success );</span></a>
<a name="18151"><span class="lineNum">   18151 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 1 );</span></a>
<a name="18152"><span class="lineNum">   18152 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="18153"><span class="lineNum">   18153 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18154"><span class="lineNum">   18154 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18155"><span class="lineNum">   18155 </span>                :            : </a>
<a name="18156"><span class="lineNum">   18156 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18157"><span class="lineNum">   18157 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18158"><span class="lineNum">   18158 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="18159"><span class="lineNum">   18159 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY ), QgsGeometry::Success );</span></a>
<a name="18160"><span class="lineNum">   18160 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="18161"><span class="lineNum">   18161 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="18162"><span class="lineNum">   18162 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18163"><span class="lineNum">   18163 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18164"><span class="lineNum">   18164 </span>                :            : </a>
<a name="18165"><span class="lineNum">   18165 </span>                :            :   // Test split parts with topological editing</a>
<a name="18166"><span class="lineNum">   18166 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18167"><span class="lineNum">   18167 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18168"><span class="lineNum">   18168 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="18169"><span class="lineNum">   18169 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY, false ), QgsGeometry::Success );</span></a>
<a name="18170"><span class="lineNum">   18170 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="18171"><span class="lineNum">   18171 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="18172"><span class="lineNum">   18172 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18173"><span class="lineNum">   18173 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18174"><span class="lineNum">   18174 </span>                :            : </a>
<a name="18175"><span class="lineNum">   18175 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="18176"><span class="lineNum">   18176 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="18177"><span class="lineNum">   18177 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="18178"><span class="lineNum">   18178 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY, false ), QgsGeometry::Success );</span></a>
<a name="18179"><span class="lineNum">   18179 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 3 );</span></a>
<a name="18180"><span class="lineNum">   18180 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="18181"><span class="lineNum">   18181 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="18182"><span class="lineNum">   18182 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="18183"><span class="lineNum">   18183 </span>                :            :   Q_NOWARN_DEPRECATED_POP</a>
<a name="18184"><span class="lineNum">   18184 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18185"><span class="lineNum">   18185 </span>                :            : </a>
<a name="18186"><span class="lineNum">   18186 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::snappedToGrid()</span></a>
<a name="18187"><span class="lineNum">   18187 </span>                :            : {</a>
<a name="18188"><span class="lineNum">   18188 </span>                :            :   // points</a>
<a name="18189"><span class="lineNum">   18189 </span>                :            :   {</a>
<a name="18190"><span class="lineNum">   18190 </span>                :<span class="lineCov">         10 :     auto check = []( QgsPoint * _a, QgsPoint const &amp; b )</span></a>
<a name="18191"><span class="lineNum">   18191 </span>                :            :     {</a>
<a name="18192"><span class="lineNum">   18192 </span>                :<span class="lineCov">         10 :       std::unique_ptr&lt;QgsPoint&gt; a {_a};</span></a>
<a name="18193"><span class="lineNum">   18193 </span>                :            :       // because it is to check after snapping, there shouldn't be small precision errors</a>
<a name="18194"><span class="lineNum">   18194 </span>                :            : </a>
<a name="18195"><span class="lineNum">   18195 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.x() ) )</span></a>
<a name="18196"><span class="lineNum">   18196 </span>                :<span class="lineCov">         10 :         QVERIFY( ( float )a-&gt;x() == ( float )b.x() );</span></a>
<a name="18197"><span class="lineNum">   18197 </span>                :            : </a>
<a name="18198"><span class="lineNum">   18198 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.y() ) )</span></a>
<a name="18199"><span class="lineNum">   18199 </span>                :<span class="lineCov">         10 :         QVERIFY( ( float )a-&gt;y() == ( float )b.y() );</span></a>
<a name="18200"><span class="lineNum">   18200 </span>                :            : </a>
<a name="18201"><span class="lineNum">   18201 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.z() ) )</span></a>
<a name="18202"><span class="lineNum">   18202 </span>                :<span class="lineCov">          3 :         QVERIFY( ( float )a-&gt;z() == ( float )b.z() );</span></a>
<a name="18203"><span class="lineNum">   18203 </span>                :            : </a>
<a name="18204"><span class="lineNum">   18204 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.m() ) )</span></a>
<a name="18205"><span class="lineNum">   18205 </span>                :<span class="lineCov">          3 :         QVERIFY( ( float )a-&gt;m() == ( float )b.m() );</span></a>
<a name="18206"><span class="lineNum">   18206 </span>                :<span class="lineCov">         10 :     };</span></a>
<a name="18207"><span class="lineNum">   18207 </span>                :            : </a>
<a name="18208"><span class="lineNum">   18208 </span>                :            : </a>
<a name="18209"><span class="lineNum">   18209 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 0, 0 ).snappedToGrid( 1, 1 ),</span></a>
<a name="18210"><span class="lineNum">   18210 </span>                :<span class="lineCov">          1 :            QgsPoint( 0, 0 ) );</span></a>
<a name="18211"><span class="lineNum">   18211 </span>                :            : </a>
<a name="18212"><span class="lineNum">   18212 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1, 2.732 ).snappedToGrid( 1, 1 ),</span></a>
<a name="18213"><span class="lineNum">   18213 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 3 ) );</span></a>
<a name="18214"><span class="lineNum">   18214 </span>                :            : </a>
<a name="18215"><span class="lineNum">   18215 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1.3, 6.4 ).snappedToGrid( 1, 1 ),</span></a>
<a name="18216"><span class="lineNum">   18216 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 6 ) );</span></a>
<a name="18217"><span class="lineNum">   18217 </span>                :            : </a>
<a name="18218"><span class="lineNum">   18218 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1.3, 6.4 ).snappedToGrid( 1, 0 ),</span></a>
<a name="18219"><span class="lineNum">   18219 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 6.4 ) );</span></a>
<a name="18220"><span class="lineNum">   18220 </span>                :            : </a>
<a name="18221"><span class="lineNum">   18221 </span>                :            : </a>
<a name="18222"><span class="lineNum">   18222 </span>                :            :     // multiple checks with the same point</a>
<a name="18223"><span class="lineNum">   18223 </span>                :<span class="lineCov">          1 :     auto p1 = QgsPoint( 1.38, 2.4432 );</span></a>
<a name="18224"><span class="lineNum">   18224 </span>                :            : </a>
<a name="18225"><span class="lineNum">   18225 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 1 ),</span></a>
<a name="18226"><span class="lineNum">   18226 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2 ) );</span></a>
<a name="18227"><span class="lineNum">   18227 </span>                :            : </a>
<a name="18228"><span class="lineNum">   18228 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 0.1 ),</span></a>
<a name="18229"><span class="lineNum">   18229 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2.4 ) );</span></a>
<a name="18230"><span class="lineNum">   18230 </span>                :            : </a>
<a name="18231"><span class="lineNum">   18231 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 0.01 ),</span></a>
<a name="18232"><span class="lineNum">   18232 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2.44 ) );</span></a>
<a name="18233"><span class="lineNum">   18233 </span>                :            : </a>
<a name="18234"><span class="lineNum">   18234 </span>                :            :     // Let's test more dimensions</a>
<a name="18235"><span class="lineNum">   18235 </span>                :<span class="lineCov">          1 :     auto p2 = QgsPoint( 4.2134212, 543.1231, 0.123, 12.944145 );</span></a>
<a name="18236"><span class="lineNum">   18236 </span>                :            : </a>
<a name="18237"><span class="lineNum">   18237 </span>                :<span class="lineCov">          1 :     check( p2.snappedToGrid( 0, 0, 0, 0 ),</span></a>
<a name="18238"><span class="lineNum">   18238 </span>                :            :            p2 );</a>
<a name="18239"><span class="lineNum">   18239 </span>                :            : </a>
<a name="18240"><span class="lineNum">   18240 </span>                :<span class="lineCov">          2 :     check( p2.snappedToGrid( 0, 0, 1, 1 ),</span></a>
<a name="18241"><span class="lineNum">   18241 </span>                :<span class="lineCov">          1 :            QgsPoint( 4.2134212, 543.1231, 0, 13 ) );</span></a>
<a name="18242"><span class="lineNum">   18242 </span>                :            : </a>
<a name="18243"><span class="lineNum">   18243 </span>                :<span class="lineCov">          2 :     check( p2.snappedToGrid( 1, 0.1, 0.01, 0.001 ),</span></a>
<a name="18244"><span class="lineNum">   18244 </span>                :<span class="lineCov">          1 :            QgsPoint( 4, 543.1, 0.12, 12.944 ) );</span></a>
<a name="18245"><span class="lineNum">   18245 </span>                :            : </a>
<a name="18246"><span class="lineNum">   18246 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="18247"><span class="lineNum">   18247 </span>                :            : </a>
<a name="18248"><span class="lineNum">   18248 </span>                :            :   // MultiPolygon (testing QgsCollection, QgsCurvePolygon and QgsLineString)</a>
<a name="18249"><span class="lineNum">   18249 </span>                :            :   {</a>
<a name="18250"><span class="lineNum">   18250 </span>                :            :     /*</a>
<a name="18251"><span class="lineNum">   18251 </span>                :            :      * List of tested edge cases:</a>
<a name="18252"><span class="lineNum">   18252 </span>                :            :      *</a>
<a name="18253"><span class="lineNum">   18253 </span>                :            :      * - QgsLineString becoming a point</a>
<a name="18254"><span class="lineNum">   18254 </span>                :            :      * - QgsLineString losing enough points so it is no longer closed</a>
<a name="18255"><span class="lineNum">   18255 </span>                :            :      * - QgsCurvePolygon losing its external ring</a>
<a name="18256"><span class="lineNum">   18256 </span>                :            :      * - QgsCurvePolygon losing an internal ring</a>
<a name="18257"><span class="lineNum">   18257 </span>                :            :      * - QgsCurvePolygon losing all internal rings</a>
<a name="18258"><span class="lineNum">   18258 </span>                :            :      * - QgsCollection losing one of its members</a>
<a name="18259"><span class="lineNum">   18259 </span>                :            :      * - QgsCollection losing all its members</a>
<a name="18260"><span class="lineNum">   18260 </span>                :            :      */</a>
<a name="18261"><span class="lineNum">   18261 </span>                :            : </a>
<a name="18262"><span class="lineNum">   18262 </span>                :<span class="lineCov">          1 :     auto in = QString( &quot;MultiPolygon (((-1.2 -0.87, -0.943 0.8, 0.82 1.4, 1.2 0.9, 0.9 -0.6, -1.2 -0.87),(0.4 0, -0.4 0, 0 0.2, 0.4 0)),((2 0, 2.2 0.2, 2.2 -0.2)),((3 0, 4 0.2, 4 -0.2, 3 0)),((4 8, 3.6 4.1, 0.3 4.9, -0.2 7.8, 4 8),(6.7 7.3, 7 6.4, 5.6 5.9, 6.2 6.8, 6.7 7.3),(6 5.2, 4.9 5.3, 4.8 6.2, 6 5.2)))&quot; );</span></a>
<a name="18263"><span class="lineNum">   18263 </span>                :<span class="lineCov">          1 :     auto out = QString( &quot;MultiPolygon (((-1 -1, -1 1, 1 1, 1 -1, -1 -1)),((4 8, 4 4, 0 5, 0 8, 4 8),(7 7, 7 6, 6 6, 6 7, 7 7),(6 5, 5 5, 5 6, 6 5)))&quot; );</span></a>
<a name="18264"><span class="lineNum">   18264 </span>                :            : </a>
<a name="18265"><span class="lineNum">   18265 </span>                :<span class="lineCov">          1 :     auto inGeom = QgsGeometryFactory::geomFromWkt( in );</span></a>
<a name="18266"><span class="lineNum">   18266 </span>                :            : </a>
<a name="18267"><span class="lineNum">   18267 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { inGeom-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="18268"><span class="lineNum">   18268 </span>                :<span class="lineCov">          1 :     QCOMPARE( snapped-&gt;asWkt( 5 ), out );</span></a>
<a name="18269"><span class="lineNum">   18269 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="18270"><span class="lineNum">   18270 </span>                :            : </a>
<a name="18271"><span class="lineNum">   18271 </span>                :            :   {</a>
<a name="18272"><span class="lineNum">   18272 </span>                :            :     // Curves</a>
<a name="18273"><span class="lineNum">   18273 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;CircularString( 68.1 415.2, 27.1 505.2, 27.1 406.2 )&quot; );</span></a>
<a name="18274"><span class="lineNum">   18274 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="18275"><span class="lineNum">   18275 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 415, 27 505, 27 406)&quot; ) );</span></a>
<a name="18276"><span class="lineNum">   18276 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 10, 1 ) );</span></a>
<a name="18277"><span class="lineNum">   18277 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (70 415, 30 505, 30 406)&quot; ) );</span></a>
<a name="18278"><span class="lineNum">   18278 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 10 ) );</span></a>
<a name="18279"><span class="lineNum">   18279 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 420, 27 510, 27 410)&quot; ) );</span></a>
<a name="18280"><span class="lineNum">   18280 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 0, 0 ) );</span></a>
<a name="18281"><span class="lineNum">   18281 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68.1 415.2, 27.1 505.2, 27.1 406.2)&quot; ) );</span></a>
<a name="18282"><span class="lineNum">   18282 </span>                :            : </a>
<a name="18283"><span class="lineNum">   18283 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;CircularString (68.1 415.2, 27.1 505.2, 27.1 406.2, 35.1 410.1, 39.2 403.2)&quot; );</span></a>
<a name="18284"><span class="lineNum">   18284 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="18285"><span class="lineNum">   18285 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 415, 27 505, 27 406, 35 410, 39 403)&quot; ) );</span></a>
<a name="18286"><span class="lineNum">   18286 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="18287"><span class="lineNum">   18287 </span>                :            : </a>
<a name="18288"><span class="lineNum">   18288 </span>                :            :   {</a>
<a name="18289"><span class="lineNum">   18289 </span>                :            :     // Lines</a>
<a name="18290"><span class="lineNum">   18290 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;LineString( 68.1 415.2, 27.1 505.2, 27.1 406.2 )&quot; );</span></a>
<a name="18291"><span class="lineNum">   18291 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="18292"><span class="lineNum">   18292 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 415, 27 505, 27 406)&quot; ) );</span></a>
<a name="18293"><span class="lineNum">   18293 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 10, 1 ) );</span></a>
<a name="18294"><span class="lineNum">   18294 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (70 415, 30 505, 30 406)&quot; ) );</span></a>
<a name="18295"><span class="lineNum">   18295 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 10 ) );</span></a>
<a name="18296"><span class="lineNum">   18296 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 420, 27 510, 27 410)&quot; ) );</span></a>
<a name="18297"><span class="lineNum">   18297 </span>                :            : </a>
<a name="18298"><span class="lineNum">   18298 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 0, 1 ) );</span></a>
<a name="18299"><span class="lineNum">   18299 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68.1 415, 27.1 505, 27.1 406)&quot; ) );</span></a>
<a name="18300"><span class="lineNum">   18300 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 0 ) );</span></a>
<a name="18301"><span class="lineNum">   18301 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 415.2, 27 505.2, 27 406.2)&quot; ) );</span></a>
<a name="18302"><span class="lineNum">   18302 </span>                :            : </a>
<a name="18303"><span class="lineNum">   18303 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringZ (68.1 415.2 11.2, 27.1 505.2 23.6, 27.1 406.2 39.9)&quot; );</span></a>
<a name="18304"><span class="lineNum">   18304 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="18305"><span class="lineNum">   18305 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 11.2, 27 505 23.6, 27 406 39.9)&quot; ) );</span></a>
<a name="18306"><span class="lineNum">   18306 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 1 ) );</span></a>
<a name="18307"><span class="lineNum">   18307 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 11, 27 505 24, 27 406 40)&quot; ) );</span></a>
<a name="18308"><span class="lineNum">   18308 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 10 ) );</span></a>
<a name="18309"><span class="lineNum">   18309 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 10, 27 505 20, 27 406 40)&quot; ) );</span></a>
<a name="18310"><span class="lineNum">   18310 </span>                :            : </a>
<a name="18311"><span class="lineNum">   18311 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringM (68.1 415.2 11.2, 27.1 505.2 23.6, 27.1 406.2 39.9)&quot; );</span></a>
<a name="18312"><span class="lineNum">   18312 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="18313"><span class="lineNum">   18313 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 11.2, 27 505 23.6, 27 406 39.9)&quot; ) );</span></a>
<a name="18314"><span class="lineNum">   18314 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 0, 1 ) );</span></a>
<a name="18315"><span class="lineNum">   18315 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 11, 27 505 24, 27 406 40)&quot; ) );</span></a>
<a name="18316"><span class="lineNum">   18316 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 0, 10 ) );</span></a>
<a name="18317"><span class="lineNum">   18317 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 10, 27 505 20, 27 406 40)&quot; ) );</span></a>
<a name="18318"><span class="lineNum">   18318 </span>                :            : </a>
<a name="18319"><span class="lineNum">   18319 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringZM (68.1 415.2 11.2 56.7, 27.1 505.2 23.6 49.1, 27.1 406.2 39.9 32.4)&quot; );</span></a>
<a name="18320"><span class="lineNum">   18320 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="18321"><span class="lineNum">   18321 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 11.2 56.7, 27 505 23.6 49.1, 27 406 39.9 32.4)&quot; ) );</span></a>
<a name="18322"><span class="lineNum">   18322 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 1, 1 ) );</span></a>
<a name="18323"><span class="lineNum">   18323 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 11 57, 27 505 24 49, 27 406 40 32)&quot; ) );</span></a>
<a name="18324"><span class="lineNum">   18324 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 10, 10 ) );</span></a>
<a name="18325"><span class="lineNum">   18325 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 10 60, 27 505 20 50, 27 406 40 30)&quot; ) );</span></a>
<a name="18326"><span class="lineNum">   18326 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="18327"><span class="lineNum">   18327 </span>                :            : </a>
<a name="18328"><span class="lineNum">   18328 </span>                :            :   //compound curve</a>
<a name="18329"><span class="lineNum">   18329 </span>                :            :   {</a>
<a name="18330"><span class="lineNum">   18330 </span>                :            :     // Curves</a>
<a name="18331"><span class="lineNum">   18331 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;CompoundCurve(LineString(59.1 402.1, 68.1 415.2),CircularString( 68.1 415.2, 27.1 505.2, 27.1 406.2))&quot; );</span></a>
<a name="18332"><span class="lineNum">   18332 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="18333"><span class="lineNum">   18333 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt(), QStringLiteral( &quot;CompoundCurve ((59 402, 68 415),CircularString (68 415, 27 505, 27 406))&quot; ) );</span></a>
<a name="18334"><span class="lineNum">   18334 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="18335"><span class="lineNum">   18335 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18336"><span class="lineNum">   18336 </span>                :            : </a>
<a name="18337"><span class="lineNum">   18337 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::convertGeometryCollectionToSubclass()</span></a>
<a name="18338"><span class="lineNum">   18338 </span>                :            : {</a>
<a name="18339"><span class="lineNum">   18339 </span>                :<span class="lineCov">          2 :   QgsGeometry gc0 = QgsGeometry::fromWkt( QStringLiteral( &quot;GeometryCollection(Point(1 1), Polygon((2 2, 3 3, 2 3, 2 2)))&quot; ) );</span></a>
<a name="18340"><span class="lineNum">   18340 </span>                :            : </a>
<a name="18341"><span class="lineNum">   18341 </span>                :<span class="lineCov">          1 :   QgsGeometry gc1 = gc0;</span></a>
<a name="18342"><span class="lineNum">   18342 </span>                :<span class="lineCov">          1 :   QVERIFY( gc1.convertGeometryCollectionToSubclass( QgsWkbTypes::PointGeometry ) );</span></a>
<a name="18343"><span class="lineNum">   18343 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc1.asWkt(), QStringLiteral( &quot;MultiPoint ((1 1))&quot; ) );</span></a>
<a name="18344"><span class="lineNum">   18344 </span>                :            : </a>
<a name="18345"><span class="lineNum">   18345 </span>                :<span class="lineCov">          1 :   QgsGeometry gc2 = gc0;</span></a>
<a name="18346"><span class="lineNum">   18346 </span>                :<span class="lineCov">          1 :   QVERIFY( gc2.convertGeometryCollectionToSubclass( QgsWkbTypes::PolygonGeometry ) );</span></a>
<a name="18347"><span class="lineNum">   18347 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc2.asWkt(), QStringLiteral( &quot;MultiPolygon (((2 2, 3 3, 2 3, 2 2)))&quot; ) );</span></a>
<a name="18348"><span class="lineNum">   18348 </span>                :            : </a>
<a name="18349"><span class="lineNum">   18349 </span>                :<span class="lineCov">          1 :   QgsGeometry gc3 = gc0;</span></a>
<a name="18350"><span class="lineNum">   18350 </span>                :<span class="lineCov">          1 :   QVERIFY( gc3.convertGeometryCollectionToSubclass( QgsWkbTypes::LineGeometry ) );</span></a>
<a name="18351"><span class="lineNum">   18351 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc3.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="18352"><span class="lineNum">   18352 </span>                :<span class="lineCov">          1 :   QVERIFY( gc3.isEmpty() );</span></a>
<a name="18353"><span class="lineNum">   18353 </span>                :            : </a>
<a name="18354"><span class="lineNum">   18354 </span>                :            :   // trying to convert a geometry that is not a geometry collection</a>
<a name="18355"><span class="lineNum">   18355 </span>                :<span class="lineCov">          2 :   QgsGeometry wrong = QgsGeometry::fromWkt( QStringLiteral( &quot;Point(1 2)&quot; ) );</span></a>
<a name="18356"><span class="lineNum">   18356 </span>                :<span class="lineCov">          1 :   QVERIFY( !wrong.convertGeometryCollectionToSubclass( QgsWkbTypes::PolygonGeometry ) );</span></a>
<a name="18357"><span class="lineNum">   18357 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18358"><span class="lineNum">   18358 </span>                :            : </a>
<a name="18359"><span class="lineNum">   18359 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::emptyJson()</span></a>
<a name="18360"><span class="lineNum">   18360 </span>                :            : {</a>
<a name="18361"><span class="lineNum">   18361 </span>                :<span class="lineCov">          1 :   QString expected;</span></a>
<a name="18362"><span class="lineNum">   18362 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="18363"><span class="lineNum">   18363 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircularString().asJson(), expected );</span></a>
<a name="18364"><span class="lineNum">   18364 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCompoundCurve().asJson(), expected );</span></a>
<a name="18365"><span class="lineNum">   18365 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsLineString().asJson(), expected );</span></a>
<a name="18366"><span class="lineNum">   18366 </span>                :            : </a>
<a name="18367"><span class="lineNum">   18367 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;geometries\&quot;:[],\&quot;type\&quot;:\&quot;GeometryCollection\&quot;}&quot; );</span></a>
<a name="18368"><span class="lineNum">   18368 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsGeometryCollection().asJson(), expected );</span></a>
<a name="18369"><span class="lineNum">   18369 </span>                :            : </a>
<a name="18370"><span class="lineNum">   18370 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="18371"><span class="lineNum">   18371 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiCurve().asJson(), expected );</span></a>
<a name="18372"><span class="lineNum">   18372 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiLineString().asJson(), expected );</span></a>
<a name="18373"><span class="lineNum">   18373 </span>                :            : </a>
<a name="18374"><span class="lineNum">   18374 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="18375"><span class="lineNum">   18375 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiPoint().asJson(), expected );</span></a>
<a name="18376"><span class="lineNum">   18376 </span>                :            : </a>
<a name="18377"><span class="lineNum">   18377 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="18378"><span class="lineNum">   18378 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiSurface().asJson(), expected );</span></a>
<a name="18379"><span class="lineNum">   18379 </span>                :            : </a>
<a name="18380"><span class="lineNum">   18380 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; );</span></a>
<a name="18381"><span class="lineNum">   18381 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint().asJson(), expected );</span></a>
<a name="18382"><span class="lineNum">   18382 </span>                :            : </a>
<a name="18383"><span class="lineNum">   18383 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="18384"><span class="lineNum">   18384 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCurvePolygon().asJson(), expected );</span></a>
<a name="18385"><span class="lineNum">   18385 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPolygon().asJson(), expected );</span></a>
<a name="18386"><span class="lineNum">   18386 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsTriangle().asJson(), expected );</span></a>
<a name="18387"><span class="lineNum">   18387 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18388"><span class="lineNum">   18388 </span>                :            : </a>
<a name="18389"><span class="lineNum">   18389 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::testRandomPointsInPolygon()</span></a>
<a name="18390"><span class="lineNum">   18390 </span>                :            : {</a>
<a name="18391"><span class="lineNum">   18391 </span>                :            :   // null geometry</a>
<a name="18392"><span class="lineNum">   18392 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points = QgsGeometry().randomPointsInPolygon( 100 );</span></a>
<a name="18393"><span class="lineNum">   18393 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="18394"><span class="lineNum">   18394 </span>                :            : </a>
<a name="18395"><span class="lineNum">   18395 </span>                :            :   // not polygon geometry</a>
<a name="18396"><span class="lineNum">   18396 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;Point( 4 5 )&quot; ) ).randomPointsInPolygon( 100 );</span></a>
<a name="18397"><span class="lineNum">   18397 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="18398"><span class="lineNum">   18398 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;LineString( 4 5, 6 7 )&quot; ) ).randomPointsInPolygon( 100 );</span></a>
<a name="18399"><span class="lineNum">   18399 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="18400"><span class="lineNum">   18400 </span>                :            : </a>
<a name="18401"><span class="lineNum">   18401 </span>                :            :   // zero point count</a>
<a name="18402"><span class="lineNum">   18402 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 5 15, 10 15, 10 20, 5 20, 5 15 ))&quot; ) ).randomPointsInPolygon( 0 );</span></a>
<a name="18403"><span class="lineNum">   18403 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="18404"><span class="lineNum">   18404 </span>                :            : </a>
<a name="18405"><span class="lineNum">   18405 </span>                :            :   // valid polygon</a>
<a name="18406"><span class="lineNum">   18406 </span>                :<span class="lineCov">          2 :   QgsGeometry g = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 ))&quot; ) );</span></a>
<a name="18407"><span class="lineNum">   18407 </span>                :<span class="lineCov">          1 :   points = g.randomPointsInPolygon( 10000 );</span></a>
<a name="18408"><span class="lineNum">   18408 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="18409"><span class="lineNum">   18409 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="18410"><span class="lineNum">   18410 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="18411"><span class="lineNum">   18411 </span>                :            : </a>
<a name="18412"><span class="lineNum">   18412 </span>                :            :   // valid multipolygon</a>
<a name="18413"><span class="lineNum">   18413 </span>                :<span class="lineCov">          2 :   g = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon((( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 )), (( 105 115, 110 115, 110 120, 105 120, 105 115 ), (106 116, 108 116, 108 118, 106 116 )))&quot; ) );</span></a>
<a name="18414"><span class="lineNum">   18414 </span>                :<span class="lineCov">          1 :   points = g.randomPointsInPolygon( 10000 );</span></a>
<a name="18415"><span class="lineNum">   18415 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="18416"><span class="lineNum">   18416 </span>                :<span class="lineCov">          1 :   bool foundp1Point = false;</span></a>
<a name="18417"><span class="lineNum">   18417 </span>                :<span class="lineCov">          1 :   bool foundp2Point = false;</span></a>
<a name="18418"><span class="lineNum">   18418 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="18419"><span class="lineNum">   18419 </span>                :            :   {</a>
<a name="18420"><span class="lineNum">   18420 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="18421"><span class="lineNum">   18421 </span>                :<span class="lineCov">      10000 :     foundp1Point |= p.x() &lt; 100;</span></a>
<a name="18422"><span class="lineNum">   18422 </span>                :<span class="lineCov">      10000 :     foundp2Point |= p.x() &gt; 100;</span></a>
<a name="18423"><span class="lineNum">   18423 </span>                :            :   }</a>
<a name="18424"><span class="lineNum">   18424 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp1Point );</span></a>
<a name="18425"><span class="lineNum">   18425 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp2Point );</span></a>
<a name="18426"><span class="lineNum">   18426 </span>                :            : </a>
<a name="18427"><span class="lineNum">   18427 </span>                :            :   // with seed</a>
<a name="18428"><span class="lineNum">   18428 </span>                :<span class="lineCov">          2 :   g = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon((( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 )), (( 105 115, 110 115, 110 120, 105 120, 105 115 ), (106 116, 108 116, 108 118, 106 116 )))&quot; ) );</span></a>
<a name="18429"><span class="lineNum">   18429 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points1 = g.randomPointsInPolygon( 100, 200 );</span></a>
<a name="18430"><span class="lineNum">   18430 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1.count(), 100 );</span></a>
<a name="18431"><span class="lineNum">   18431 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points2 = g.randomPointsInPolygon( 100, 200 );</span></a>
<a name="18432"><span class="lineNum">   18432 </span>                :<span class="lineCov">          1 :   QCOMPARE( points2.count(), 100 );</span></a>
<a name="18433"><span class="lineNum">   18433 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1, points2 );</span></a>
<a name="18434"><span class="lineNum">   18434 </span>                :            : </a>
<a name="18435"><span class="lineNum">   18435 </span>                :            :   // no seed</a>
<a name="18436"><span class="lineNum">   18436 </span>                :<span class="lineCov">          1 :   points1 = g.randomPointsInPolygon( 100 );</span></a>
<a name="18437"><span class="lineNum">   18437 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1.count(), 100 );</span></a>
<a name="18438"><span class="lineNum">   18438 </span>                :<span class="lineCov">          1 :   points2 = g.randomPointsInPolygon( 100 );</span></a>
<a name="18439"><span class="lineNum">   18439 </span>                :<span class="lineCov">          1 :   QCOMPARE( points2.count(), 100 );</span></a>
<a name="18440"><span class="lineNum">   18440 </span>                :<span class="lineCov">          1 :   QVERIFY( points1 != points2 );</span></a>
<a name="18441"><span class="lineNum">   18441 </span>                :            : </a>
<a name="18442"><span class="lineNum">   18442 </span>                :            :   // with filter</a>
<a name="18443"><span class="lineNum">   18443 </span>                :<span class="lineCov">      20147 :   points = g.randomPointsInPolygon( 10000, []( const QgsPointXY &amp; p )-&gt;bool</span></a>
<a name="18444"><span class="lineNum">   18444 </span>                :            :   {</a>
<a name="18445"><span class="lineNum">   18445 </span>                :<span class="lineCov">      20146 :     return p.x() &gt; 100;</span></a>
<a name="18446"><span class="lineNum">   18446 </span>                :            :   } );</a>
<a name="18447"><span class="lineNum">   18447 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="18448"><span class="lineNum">   18448 </span>                :<span class="lineCov">          1 :   foundp1Point = false;</span></a>
<a name="18449"><span class="lineNum">   18449 </span>                :<span class="lineCov">          1 :   foundp2Point = false;</span></a>
<a name="18450"><span class="lineNum">   18450 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="18451"><span class="lineNum">   18451 </span>                :            :   {</a>
<a name="18452"><span class="lineNum">   18452 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="18453"><span class="lineNum">   18453 </span>                :<span class="lineCov">      10000 :     foundp1Point |= p.x() &lt; 100;</span></a>
<a name="18454"><span class="lineNum">   18454 </span>                :<span class="lineCov">      10000 :     foundp2Point |= p.x() &gt; 100;</span></a>
<a name="18455"><span class="lineNum">   18455 </span>                :            :   }</a>
<a name="18456"><span class="lineNum">   18456 </span>                :<span class="lineCov">          1 :   QVERIFY( !foundp1Point );</span></a>
<a name="18457"><span class="lineNum">   18457 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp2Point );</span></a>
<a name="18458"><span class="lineNum">   18458 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18459"><span class="lineNum">   18459 </span>                :            : </a>
<a name="18460"><span class="lineNum">   18460 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::wktParser()</span></a>
<a name="18461"><span class="lineNum">   18461 </span>                :            : {</a>
<a name="18462"><span class="lineNum">   18462 </span>                :            :   // POINT</a>
<a name="18463"><span class="lineNum">   18463 </span>                :            :   // unbalanced parentheses</a>
<a name="18464"><span class="lineNum">   18464 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT((0 1)&quot; ) );</span></a>
<a name="18465"><span class="lineNum">   18465 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT(0 1) )&quot; ) );</span></a>
<a name="18466"><span class="lineNum">   18466 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT ((0 1)&quot; ) );</span></a>
<a name="18467"><span class="lineNum">   18467 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT (0 1) )&quot; ) );</span></a>
<a name="18468"><span class="lineNum">   18468 </span>                :            :   // extra parentheses</a>
<a name="18469"><span class="lineNum">   18469 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT ( (5 1) )&quot; ) );</span></a>
<a name="18470"><span class="lineNum">   18470 </span>                :            :   // not a number</a>
<a name="18471"><span class="lineNum">   18471 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (a, b)&quot; ) );</span></a>
<a name="18472"><span class="lineNum">   18472 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (a b)&quot; ) );</span></a>
<a name="18473"><span class="lineNum">   18473 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT((0, 1)&quot; ) );</span></a>
<a name="18474"><span class="lineNum">   18474 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT(0, 1) )&quot; ) );</span></a>
<a name="18475"><span class="lineNum">   18475 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT ((0, 1)&quot; ) );</span></a>
<a name="18476"><span class="lineNum">   18476 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (0, 1) )&quot; ) );</span></a>
<a name="18477"><span class="lineNum">   18477 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT ( (5, 1) )&quot; ) );</span></a>
<a name="18478"><span class="lineNum">   18478 </span>                :            : </a>
<a name="18479"><span class="lineNum">   18479 </span>                :            :   // valid</a>
<a name="18480"><span class="lineNum">   18480 </span>                :<span class="lineCov">          1 :   QgsPoint p;</span></a>
<a name="18481"><span class="lineNum">   18481 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5 1)&quot; ) );</span></a>
<a name="18482"><span class="lineNum">   18482 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="18483"><span class="lineNum">   18483 </span>                :            :   // extra parentheses</a>
<a name="18484"><span class="lineNum">   18484 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( (5 1) )&quot; ) );</span></a>
<a name="18485"><span class="lineNum">   18485 </span>                :            :   // unbalanced parentheses</a>
<a name="18486"><span class="lineNum">   18486 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( (5 1)&quot; ) );</span></a>
<a name="18487"><span class="lineNum">   18487 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="18488"><span class="lineNum">   18488 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5 1) )&quot; ) );</span></a>
<a name="18489"><span class="lineNum">   18489 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="18490"><span class="lineNum">   18490 </span>                :            : </a>
<a name="18491"><span class="lineNum">   18491 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5.1234 1.4321)&quot; ) );</span></a>
<a name="18492"><span class="lineNum">   18492 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 4 ), QStringLiteral( &quot;Point (5.1234 1.4321)&quot; ) );</span></a>
<a name="18493"><span class="lineNum">   18493 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (-5.1234 -1.4321)&quot; ) );</span></a>
<a name="18494"><span class="lineNum">   18494 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 4 ), QStringLiteral( &quot;Point (-5.1234 -1.4321)&quot; ) );</span></a>
<a name="18495"><span class="lineNum">   18495 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (-12e4 -1.4e-1)&quot; ) );</span></a>
<a name="18496"><span class="lineNum">   18496 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 2 ), QStringLiteral( &quot;Point (-120000 -0.14)&quot; ) );</span></a>
<a name="18497"><span class="lineNum">   18497 </span>                :            : </a>
<a name="18498"><span class="lineNum">   18498 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( )&quot; ) );</span></a>
<a name="18499"><span class="lineNum">   18499 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="18500"><span class="lineNum">   18500 </span>                :<span class="lineCov">          1 :   QVERIFY( ! p.fromWkt( &quot;POINT (a, b)&quot; ) );</span></a>
<a name="18501"><span class="lineNum">   18501 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="18502"><span class="lineNum">   18502 </span>                :            :   // LINESTRING</a>
<a name="18503"><span class="lineNum">   18503 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString(0 1, 1 2) )&quot; ) );</span></a>
<a name="18504"><span class="lineNum">   18504 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString (0 1, 1 2) )&quot; ) );</span></a>
<a name="18505"><span class="lineNum">   18505 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString ( (0 1) )&quot; ) );</span></a>
<a name="18506"><span class="lineNum">   18506 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString ( ( 0 1, 2 3 ) )&quot; ) );</span></a>
<a name="18507"><span class="lineNum">   18507 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().fromWkt( &quot;MULTILINESTRING ((((1 2, 2 4, 4 5))&quot; ) );</span></a>
<a name="18508"><span class="lineNum">   18508 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().fromWkt( &quot;MULTILINESTRING((((1 2, 2 4, 4 5))&quot; ) );</span></a>
<a name="18509"><span class="lineNum">   18509 </span>                :            :   // not a number</a>
<a name="18510"><span class="lineNum">   18510 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString(0, 1) )&quot; ) );</span></a>
<a name="18511"><span class="lineNum">   18511 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString (0, 1) )&quot; ) );</span></a>
<a name="18512"><span class="lineNum">   18512 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString (a b, 3 4)&quot; ) );</span></a>
<a name="18513"><span class="lineNum">   18513 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsMultiLineString().fromWkt( &quot;MULTILINESTRING ((1 2, 2 a, 4 b))&quot; ) );</span></a>
<a name="18514"><span class="lineNum">   18514 </span>                :            :   // valid</a>
<a name="18515"><span class="lineNum">   18515 </span>                :<span class="lineCov">          1 :   QgsLineString l;</span></a>
<a name="18516"><span class="lineNum">   18516 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1 2, 3 4 )&quot; ) );</span></a>
<a name="18517"><span class="lineNum">   18517 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="18518"><span class="lineNum">   18518 </span>                :            :   // unbalanced parentheses</a>
<a name="18519"><span class="lineNum">   18519 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( ( 1 2, 3 4 )&quot; ) );</span></a>
<a name="18520"><span class="lineNum">   18520 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="18521"><span class="lineNum">   18521 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1 2, 3 4 ) )&quot; ) );</span></a>
<a name="18522"><span class="lineNum">   18522 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="18523"><span class="lineNum">   18523 </span>                :            :   // extra parentheses</a>
<a name="18524"><span class="lineNum">   18524 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING( ( 1 2, 3 4 ) )&quot; ) );</span></a>
<a name="18525"><span class="lineNum">   18525 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="18526"><span class="lineNum">   18526 </span>                :            :   // empty</a>
<a name="18527"><span class="lineNum">   18527 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING (  )&quot; ) );</span></a>
<a name="18528"><span class="lineNum">   18528 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString EMPTY&quot; ) );</span></a>
<a name="18529"><span class="lineNum">   18529 </span>                :<span class="lineCov">          1 :   QVERIFY( ! l.fromWkt( &quot;LINESTRING ( a b, 2 3  )&quot; ) );</span></a>
<a name="18530"><span class="lineNum">   18530 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString EMPTY&quot; ) );</span></a>
<a name="18531"><span class="lineNum">   18531 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1e4 -2, 3 +4.5 )&quot; ) );</span></a>
<a name="18532"><span class="lineNum">   18532 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt( 1 ), QStringLiteral( &quot;LineString (10000 -2, 3 4.5)&quot; ) );</span></a>
<a name="18533"><span class="lineNum">   18533 </span>                :<span class="lineCov">          1 :   QgsMultiLineString m;</span></a>
<a name="18534"><span class="lineNum">   18534 </span>                :<span class="lineCov">          1 :   m.fromWkt( &quot;MULTILINESTRING ((1 2, 2 3, 4 5))&quot; ) ;</span></a>
<a name="18535"><span class="lineNum">   18535 </span>                :<span class="lineCov">          1 :   QVERIFY( m.fromWkt( &quot;MULTILINESTRING ((1 2, 2 3, 4 5))&quot; ) );</span></a>
<a name="18536"><span class="lineNum">   18536 </span>                :<span class="lineCov">          2 :   QCOMPARE( m.asWkt( 1 ), QStringLiteral( &quot;MultiLineString ((1 2, 2 3, 4 5))&quot; ) );</span></a>
<a name="18537"><span class="lineNum">   18537 </span>                :            : </a>
<a name="18538"><span class="lineNum">   18538 </span>                :            :   // TRIANGLE</a>
<a name="18539"><span class="lineNum">   18539 </span>                :            :   // unbalanced parenthesis</a>
<a name="18540"><span class="lineNum">   18540 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().fromWkt( &quot;Triangle( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18541"><span class="lineNum">   18541 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().fromWkt( &quot;Triangle ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18542"><span class="lineNum">   18542 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18543"><span class="lineNum">   18543 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18544"><span class="lineNum">   18544 </span>                :            :   // not a number</a>
<a name="18545"><span class="lineNum">   18545 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle ( (0 a, b 2, 3 3 )) &quot; ) );</span></a>
<a name="18546"><span class="lineNum">   18546 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle ( (0 a, b 2, 3 3, 0 a )) &quot; ) );</span></a>
<a name="18547"><span class="lineNum">   18547 </span>                :            :   // incorrect number of points</a>
<a name="18548"><span class="lineNum">   18548 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 0, 1 1))&quot; ) );</span></a>
<a name="18549"><span class="lineNum">   18549 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 0, 1 1, 1 0, 2 3, 4 5))&quot; ) );</span></a>
<a name="18550"><span class="lineNum">   18550 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 1, 2 3, 3 4, 1 0))&quot; ) ); // four points but start and last points are different</span></a>
<a name="18551"><span class="lineNum">   18551 </span>                :            :   // valid</a>
<a name="18552"><span class="lineNum">   18552 </span>                :<span class="lineCov">          1 :   QgsTriangle t;</span></a>
<a name="18553"><span class="lineNum">   18553 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="18554"><span class="lineNum">   18554 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="18555"><span class="lineNum">   18555 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18556"><span class="lineNum">   18556 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18557"><span class="lineNum">   18557 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18558"><span class="lineNum">   18558 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18559"><span class="lineNum">   18559 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 3))&quot; ) );</span></a>
<a name="18560"><span class="lineNum">   18560 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="18561"><span class="lineNum">   18561 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 3, 4 5))&quot; ) );</span></a>
<a name="18562"><span class="lineNum">   18562 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="18563"><span class="lineNum">   18563 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3 ))&quot; ) );</span></a>
<a name="18564"><span class="lineNum">   18564 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="18565"><span class="lineNum">   18565 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE((0 1e3, -2 3, +3 4, 0 1e3))&quot; ) );</span></a>
<a name="18566"><span class="lineNum">   18566 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1000, -2 3, 3 4, 0 1000))&quot; ) );</span></a>
<a name="18567"><span class="lineNum">   18567 </span>                :            : </a>
<a name="18568"><span class="lineNum">   18568 </span>                :            :   // POLYGON</a>
<a name="18569"><span class="lineNum">   18569 </span>                :            :   // unbalanced parenthesis</a>
<a name="18570"><span class="lineNum">   18570 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().fromWkt( &quot;Polygon( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18571"><span class="lineNum">   18571 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().fromWkt( &quot;Polygon ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18572"><span class="lineNum">   18572 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18573"><span class="lineNum">   18573 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18574"><span class="lineNum">   18574 </span>                :            :   // not a number</a>
<a name="18575"><span class="lineNum">   18575 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon ( (0 a, b 2, 3 3 )) &quot; ) );</span></a>
<a name="18576"><span class="lineNum">   18576 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon ( (0 a, b 2, 3 3, 0 a )) &quot; ) );</span></a>
<a name="18577"><span class="lineNum">   18577 </span>                :            :   // valid</a>
<a name="18578"><span class="lineNum">   18578 </span>                :<span class="lineCov">          1 :   QgsPolygon poly;</span></a>
<a name="18579"><span class="lineNum">   18579 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon(( 0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="18580"><span class="lineNum">   18580 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1, 2 3, 3 4))&quot; ) ); // TODO: A polygon must be closed</span></a>
<a name="18581"><span class="lineNum">   18581 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18582"><span class="lineNum">   18582 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18583"><span class="lineNum">   18583 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon((0 1e3, -2 3, +3 4, 0 1))&quot; ) );</span></a>
<a name="18584"><span class="lineNum">   18584 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1000, -2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="18585"><span class="lineNum">   18585 </span>                :            : </a>
<a name="18586"><span class="lineNum">   18586 </span>                :            :   // Circular string</a>
<a name="18587"><span class="lineNum">   18587 </span>                :            :   // unbalanced parenthesis</a>
<a name="18588"><span class="lineNum">   18588 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18589"><span class="lineNum">   18589 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="18590"><span class="lineNum">   18590 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18591"><span class="lineNum">   18591 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="18592"><span class="lineNum">   18592 </span>                :            :   // not a number</a>
<a name="18593"><span class="lineNum">   18593 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsCircularString().fromWkt( &quot;CircularString (0 a, b 2, 3 3) &quot; ) );</span></a>
<a name="18594"><span class="lineNum">   18594 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsCircularString().fromWkt( &quot;CircularString (0 a, b 2, 3 3, 0 a) &quot; ) );</span></a>
<a name="18595"><span class="lineNum">   18595 </span>                :            :   // valid</a>
<a name="18596"><span class="lineNum">   18596 </span>                :<span class="lineCov">          1 :   QgsCircularString c;</span></a>
<a name="18597"><span class="lineNum">   18597 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString( 0 1, 2 3, 3 4)&quot; ) );</span></a>
<a name="18598"><span class="lineNum">   18598 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 1, 2 3, 3 4)&quot; ) );</span></a>
<a name="18599"><span class="lineNum">   18599 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString(0 1e3, -2 3, +3 4)&quot; ) );</span></a>
<a name="18600"><span class="lineNum">   18600 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 1000, -2 3, 3 4)&quot; ) );</span></a>
<a name="18601"><span class="lineNum">   18601 </span>                :            : </a>
<a name="18602"><span class="lineNum">   18602 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString ((0 0,1 1,2 0))&quot; ) ); // Added from an old test with an invalid wkt, but allowed in QGIS https://github.com/qgis/QGIS/pull/38439/files/59aab9dc9cc58bdc98e6d8091840bc129564ed2f#diff-fe3aa1328ee04f0eb00a1b1d59c0ea71L4247</span></a>
<a name="18603"><span class="lineNum">   18603 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 0, 1 1, 2 0)&quot; ) );</span></a>
<a name="18604"><span class="lineNum">   18604 </span>                :            : </a>
<a name="18605"><span class="lineNum">   18605 </span>                :            :   // multipoint</a>
<a name="18606"><span class="lineNum">   18606 </span>                :<span class="lineCov">          1 :   QgsMultiPoint mp;</span></a>
<a name="18607"><span class="lineNum">   18607 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT (((10 40), (40 30), (20 20), (30 10))&quot; ) );</span></a>
<a name="18608"><span class="lineNum">   18608 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT (((10 40), (40 30), (xx20 20), (30 10))&quot; ) );</span></a>
<a name="18609"><span class="lineNum">   18609 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT ((10 40, 40 30, 20 20, 30 10)&quot; ) );</span></a>
<a name="18610"><span class="lineNum">   18610 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))))&quot; ) );</span></a>
<a name="18611"><span class="lineNum">   18611 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ( )&quot; ) );</span></a>
<a name="18612"><span class="lineNum">   18612 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT EMPTY&quot; ) );</span></a>
<a name="18613"><span class="lineNum">   18613 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot; ) );</span></a>
<a name="18614"><span class="lineNum">   18614 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="18615"><span class="lineNum">   18615 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT (10 40, 40 30, 20 20, 30 10)&quot; ) );</span></a>
<a name="18616"><span class="lineNum">   18616 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="18617"><span class="lineNum">   18617 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))))&quot; ) );</span></a>
<a name="18618"><span class="lineNum">   18618 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="18619"><span class="lineNum">   18619 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ( )&quot; ) );</span></a>
<a name="18620"><span class="lineNum">   18620 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint EMPTY&quot; ) );</span></a>
<a name="18621"><span class="lineNum">   18621 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT EMPTY&quot; ) );</span></a>
<a name="18622"><span class="lineNum">   18622 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint EMPTY&quot; ) );</span></a>
<a name="18623"><span class="lineNum">   18623 </span>                :            :   // Added from an old test with an invalid wkt, but allowed in QGIS https://github.com/qgis/QGIS/pull/38439/files/59aab9dc9cc58bdc98e6d8091840bc129564ed2f#diff-4444b5a772b35be43721b71a4b95d785R50</a>
<a name="18624"><span class="lineNum">   18624 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT(0 20,20 20))&quot; ) );</span></a>
<a name="18625"><span class="lineNum">   18625 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((0 20),(20 20))&quot; ) );</span></a>
<a name="18626"><span class="lineNum">   18626 </span>                :            : </a>
<a name="18627"><span class="lineNum">   18627 </span>                :            :   // compoundcurve</a>
<a name="18628"><span class="lineNum">   18628 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve cc;</span></a>
<a name="18629"><span class="lineNum">   18629 </span>                :<span class="lineCov">          1 :   QVERIFY( ! cc.fromWkt( &quot;COMPOUNDCURVE((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18630"><span class="lineNum">   18630 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18631"><span class="lineNum">   18631 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18632"><span class="lineNum">   18632 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18633"><span class="lineNum">   18633 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18634"><span class="lineNum">   18634 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="18635"><span class="lineNum">   18635 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2),(2 2, 3 3))&quot; ) );</span></a>
<a name="18636"><span class="lineNum">   18636 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE ( )&quot; ) );</span></a>
<a name="18637"><span class="lineNum">   18637 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) );</span></a>
<a name="18638"><span class="lineNum">   18638 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE EMPTY&quot; ) );</span></a>
<a name="18639"><span class="lineNum">   18639 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) );</span></a>
<a name="18640"><span class="lineNum">   18640 </span>                :            :   // geometrycollection</a>
<a name="18641"><span class="lineNum">   18641 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection gc;</span></a>
<a name="18642"><span class="lineNum">   18642 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18643"><span class="lineNum">   18643 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (GeometryCollection (CircularString (0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18644"><span class="lineNum">   18644 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18645"><span class="lineNum">   18645 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18646"><span class="lineNum">   18646 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18647"><span class="lineNum">   18647 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18648"><span class="lineNum">   18648 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="18649"><span class="lineNum">   18649 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2),LineString (2 2, 3 3))&quot; ) );</span></a>
<a name="18650"><span class="lineNum">   18650 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection ( )&quot; ) );</span></a>
<a name="18651"><span class="lineNum">   18651 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="18652"><span class="lineNum">   18652 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="18653"><span class="lineNum">   18653 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="18654"><span class="lineNum">   18654 </span>                :            :   // curvepolygon</a>
<a name="18655"><span class="lineNum">   18655 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon cp;</span></a>
<a name="18656"><span class="lineNum">   18656 </span>                :<span class="lineCov">          1 :   QVERIFY( ! cp.fromWkt( &quot;CurvePolygon((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18657"><span class="lineNum">   18657 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18658"><span class="lineNum">   18658 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18659"><span class="lineNum">   18659 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18660"><span class="lineNum">   18660 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18661"><span class="lineNum">   18661 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="18662"><span class="lineNum">   18662 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2),(2 2, 3 3))&quot; ) );</span></a>
<a name="18663"><span class="lineNum">   18663 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon ( )&quot; ) );</span></a>
<a name="18664"><span class="lineNum">   18664 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="18665"><span class="lineNum">   18665 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="18666"><span class="lineNum">   18666 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="18667"><span class="lineNum">   18667 </span>                :            :   // multicurve</a>
<a name="18668"><span class="lineNum">   18668 </span>                :<span class="lineCov">          1 :   QgsMultiCurve mc;</span></a>
<a name="18669"><span class="lineNum">   18669 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mc.fromWkt( &quot;MultiCurve((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18670"><span class="lineNum">   18670 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18671"><span class="lineNum">   18671 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18672"><span class="lineNum">   18672 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18673"><span class="lineNum">   18673 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18674"><span class="lineNum">   18674 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="18675"><span class="lineNum">   18675 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2),LineString (2 2, 3 3))&quot; ) );</span></a>
<a name="18676"><span class="lineNum">   18676 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve ( )&quot; ) );</span></a>
<a name="18677"><span class="lineNum">   18677 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="18678"><span class="lineNum">   18678 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="18679"><span class="lineNum">   18679 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="18680"><span class="lineNum">   18680 </span>                :            :   // multisurface</a>
<a name="18681"><span class="lineNum">   18681 </span>                :<span class="lineCov">          1 :   QgsMultiSurface ms;</span></a>
<a name="18682"><span class="lineNum">   18682 </span>                :<span class="lineCov">          1 :   QVERIFY( ! ms.fromWkt( &quot;MultiSurface((Polygon( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18683"><span class="lineNum">   18683 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18684"><span class="lineNum">   18684 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18685"><span class="lineNum">   18685 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18686"><span class="lineNum">   18686 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18687"><span class="lineNum">   18687 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)), Polygon((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="18688"><span class="lineNum">   18688 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)),Polygon ((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="18689"><span class="lineNum">   18689 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface ( )&quot; ) );</span></a>
<a name="18690"><span class="lineNum">   18690 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="18691"><span class="lineNum">   18691 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="18692"><span class="lineNum">   18692 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="18693"><span class="lineNum">   18693 </span>                :            :   // multipolygon</a>
<a name="18694"><span class="lineNum">   18694 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon mpoly;</span></a>
<a name="18695"><span class="lineNum">   18695 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mpoly.fromWkt( &quot;MultiPolygon((Polygon( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18696"><span class="lineNum">   18696 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18697"><span class="lineNum">   18697 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18698"><span class="lineNum">   18698 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18699"><span class="lineNum">   18699 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18700"><span class="lineNum">   18700 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)), Polygon((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="18701"><span class="lineNum">   18701 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)),((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="18702"><span class="lineNum">   18702 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon ( )&quot; ) );</span></a>
<a name="18703"><span class="lineNum">   18703 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="18704"><span class="lineNum">   18704 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="18705"><span class="lineNum">   18705 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="18706"><span class="lineNum">   18706 </span>                :            : </a>
<a name="18707"><span class="lineNum">   18707 </span>                :            :   // multilinestring</a>
<a name="18708"><span class="lineNum">   18708 </span>                :<span class="lineCov">          1 :   QgsMultiLineString mline;</span></a>
<a name="18709"><span class="lineNum">   18709 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mline.fromWkt( &quot;MultiLineString((LineString( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18710"><span class="lineNum">   18710 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18711"><span class="lineNum">   18711 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18712"><span class="lineNum">   18712 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="18713"><span class="lineNum">   18713 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="18714"><span class="lineNum">   18714 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)), LineString((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="18715"><span class="lineNum">   18715 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2),(2 2, 3 3, 3 2))&quot; ) );</span></a>
<a name="18716"><span class="lineNum">   18716 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString ( )&quot; ) );</span></a>
<a name="18717"><span class="lineNum">   18717 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="18718"><span class="lineNum">   18718 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="18719"><span class="lineNum">   18719 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="18720"><span class="lineNum">   18720 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="18721"><span class="lineNum">   18721 </span>                :<span class="lineCov">          1 : QGSTEST_MAIN( TestQgsGeometry )</span></a>
<a name="18722"><span class="lineNum">   18722 </span>                :            : #include &quot;testqgsgeometry.moc&quot;</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
