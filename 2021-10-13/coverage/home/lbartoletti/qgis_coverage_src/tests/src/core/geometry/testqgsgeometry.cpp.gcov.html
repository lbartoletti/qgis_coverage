<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info.cleaned - /home/lbartoletti/qgis_coverage_src/tests/src/core/geometry/testqgsgeometry.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../../../index.html">top level</a> - <a href="index.html">home/lbartoletti/qgis_coverage_src/tests/src/core/geometry</a> - testqgsgeometry.cpp<span style="font-size: 80%;"> (source / <a href="testqgsgeometry.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info.cleaned</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">1908</td>
            <td class="headerCovTableEntry">1937</td>
            <td class="headerCovTableEntryHi">98.5 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-10-13 17:24:53</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /***************************************************************************</a>
<a name="2"><span class="lineNum">       2 </span>                :            :      testqgsgeometry.cpp</a>
<a name="3"><span class="lineNum">       3 </span>                :            :      --------------------------------------</a>
<a name="4"><span class="lineNum">       4 </span>                :            :     Date                 : 20 Jan 2008</a>
<a name="5"><span class="lineNum">       5 </span>                :            :     Copyright            : (C) 2008 by Tim Sutton</a>
<a name="6"><span class="lineNum">       6 </span>                :            :     Email                : tim @ linfiniti.com</a>
<a name="7"><span class="lineNum">       7 </span>                :            :  ***************************************************************************</a>
<a name="8"><span class="lineNum">       8 </span>                :            :  *                                                                         *</a>
<a name="9"><span class="lineNum">       9 </span>                :            :  *   This program is free software; you can redistribute it and/or modify  *</a>
<a name="10"><span class="lineNum">      10 </span>                :            :  *   it under the terms of the GNU General Public License as published by  *</a>
<a name="11"><span class="lineNum">      11 </span>                :            :  *   the Free Software Foundation; either version 2 of the License, or     *</a>
<a name="12"><span class="lineNum">      12 </span>                :            :  *   (at your option) any later version.                                   *</a>
<a name="13"><span class="lineNum">      13 </span>                :            :  *                                                                         *</a>
<a name="14"><span class="lineNum">      14 </span>                :            :  ***************************************************************************/</a>
<a name="15"><span class="lineNum">      15 </span>                :            : #include &quot;qgstest.h&quot;</a>
<a name="16"><span class="lineNum">      16 </span>                :            : #include &lt;cmath&gt;</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #include &lt;memory&gt;</a>
<a name="18"><span class="lineNum">      18 </span>                :            : #include &lt;limits&gt;</a>
<a name="19"><span class="lineNum">      19 </span>                :            : #include &lt;QObject&gt;</a>
<a name="20"><span class="lineNum">      20 </span>                :            : #include &lt;QString&gt;</a>
<a name="21"><span class="lineNum">      21 </span>                :            : #include &lt;QStringList&gt;</a>
<a name="22"><span class="lineNum">      22 </span>                :            : #include &lt;QApplication&gt;</a>
<a name="23"><span class="lineNum">      23 </span>                :            : #include &lt;QFileInfo&gt;</a>
<a name="24"><span class="lineNum">      24 </span>                :            : #include &lt;QDir&gt;</a>
<a name="25"><span class="lineNum">      25 </span>                :            : #include &lt;QDesktopServices&gt;</a>
<a name="26"><span class="lineNum">      26 </span>                :            : #include &lt;QVector&gt;</a>
<a name="27"><span class="lineNum">      27 </span>                :            : #include &lt;QPointF&gt;</a>
<a name="28"><span class="lineNum">      28 </span>                :            : #include &lt;QImage&gt;</a>
<a name="29"><span class="lineNum">      29 </span>                :            : #include &lt;QPainter&gt;</a>
<a name="30"><span class="lineNum">      30 </span>                :            : </a>
<a name="31"><span class="lineNum">      31 </span>                :            : //qgis includes...</a>
<a name="32"><span class="lineNum">      32 </span>                :            : #include &lt;qgsapplication.h&gt;</a>
<a name="33"><span class="lineNum">      33 </span>                :            : #include &quot;qgscompoundcurve.h&quot;</a>
<a name="34"><span class="lineNum">      34 </span>                :            : #include &lt;qgsgeometry.h&gt;</a>
<a name="35"><span class="lineNum">      35 </span>                :            : #include &quot;qgsgeometryutils.h&quot;</a>
<a name="36"><span class="lineNum">      36 </span>                :            : #include &quot;qgspoint.h&quot;</a>
<a name="37"><span class="lineNum">      37 </span>                :            : #include &quot;qgslinestring.h&quot;</a>
<a name="38"><span class="lineNum">      38 </span>                :            : #include &quot;qgspolygon.h&quot;</a>
<a name="39"><span class="lineNum">      39 </span>                :            : #include &quot;qgstriangle.h&quot;</a>
<a name="40"><span class="lineNum">      40 </span>                :            : #include &quot;qgsgeometryengine.h&quot;</a>
<a name="41"><span class="lineNum">      41 </span>                :            : #include &quot;qgscircle.h&quot;</a>
<a name="42"><span class="lineNum">      42 </span>                :            : #include &quot;qgsmultipoint.h&quot;</a>
<a name="43"><span class="lineNum">      43 </span>                :            : #include &quot;qgsmultilinestring.h&quot;</a>
<a name="44"><span class="lineNum">      44 </span>                :            : #include &quot;qgsmultipolygon.h&quot;</a>
<a name="45"><span class="lineNum">      45 </span>                :            : #include &quot;qgscircularstring.h&quot;</a>
<a name="46"><span class="lineNum">      46 </span>                :            : #include &quot;qgsgeometrycollection.h&quot;</a>
<a name="47"><span class="lineNum">      47 </span>                :            : #include &quot;qgsgeometryfactory.h&quot;</a>
<a name="48"><span class="lineNum">      48 </span>                :            : #include &quot;qgscurvepolygon.h&quot;</a>
<a name="49"><span class="lineNum">      49 </span>                :            : #include &quot;qgsproject.h&quot;</a>
<a name="50"><span class="lineNum">      50 </span>                :            : #include &quot;qgsgeos.h&quot;</a>
<a name="51"><span class="lineNum">      51 </span>                :            : #include &quot;qgsreferencedgeometry.h&quot;</a>
<a name="52"><span class="lineNum">      52 </span>                :            : </a>
<a name="53"><span class="lineNum">      53 </span>                :            : //qgs unit test utility class</a>
<a name="54"><span class="lineNum">      54 </span>                :            : #include &quot;qgsrenderchecker.h&quot;</a>
<a name="55"><span class="lineNum">      55 </span>                :            : </a>
<a name="56"><span class="lineNum">      56 </span>                :            : #include &quot;testtransformer.h&quot;</a>
<a name="57"><span class="lineNum">      57 </span>                :            : #include &quot;testgeometryutils.h&quot;</a>
<a name="58"><span class="lineNum">      58 </span>                :            : </a>
<a name="59"><span class="lineNum">      59 </span>                :            : /**</a>
<a name="60"><span class="lineNum">      60 </span>                :            :  * \ingroup UnitTests</a>
<a name="61"><span class="lineNum">      61 </span>                :            :  * This is a unit test for the different geometry operations on vector features.</a>
<a name="62"><span class="lineNum">      62 </span>                :            :  */</a>
<a name="63"><span class="lineNum">      63 </span>                :<span class="lineCov">          1 : class TestQgsGeometry : public QObject</span></a>
<a name="64"><span class="lineNum">      64 </span>                :            : {</a>
<a name="65"><span class="lineNum">      65 </span>                :            :     Q_OBJECT</a>
<a name="66"><span class="lineNum">      66 </span>                :            : </a>
<a name="67"><span class="lineNum">      67 </span>                :            :   public:</a>
<a name="68"><span class="lineNum">      68 </span>                :            :     TestQgsGeometry();</a>
<a name="69"><span class="lineNum">      69 </span>                :            : </a>
<a name="70"><span class="lineNum">      70 </span>                :<span class="lineCov">         12 :     static QgsAbstractGeometry *createEmpty( QgsAbstractGeometry *geom )</span></a>
<a name="71"><span class="lineNum">      71 </span>                :            :     {</a>
<a name="72"><span class="lineNum">      72 </span>                :<span class="lineCov">         12 :       return geom-&gt;createEmptyWithSameType();</span></a>
<a name="73"><span class="lineNum">      73 </span>                :            :     }</a>
<a name="74"><span class="lineNum">      74 </span>                :            : </a>
<a name="75"><span class="lineNum">      75 </span>                :            :   private slots:</a>
<a name="76"><span class="lineNum">      76 </span>                :            :     void initTestCase();// will be called before the first testfunction is executed.</a>
<a name="77"><span class="lineNum">      77 </span>                :            :     void cleanupTestCase();// will be called after the last testfunction was executed.</a>
<a name="78"><span class="lineNum">      78 </span>                :            :     void cleanup();// will be called after every testfunction.</a>
<a name="79"><span class="lineNum">      79 </span>                :            :     void copy();</a>
<a name="80"><span class="lineNum">      80 </span>                :            :     void assignment();</a>
<a name="81"><span class="lineNum">      81 </span>                :            :     void asVariant(); //test conversion to and from a QVariant</a>
<a name="82"><span class="lineNum">      82 </span>                :            :     void referenced();</a>
<a name="83"><span class="lineNum">      83 </span>                :            :     void isEmpty();</a>
<a name="84"><span class="lineNum">      84 </span>                :            :     void isValid();</a>
<a name="85"><span class="lineNum">      85 </span>                :            :     void equality();</a>
<a name="86"><span class="lineNum">      86 </span>                :            :     void vertexIterator();</a>
<a name="87"><span class="lineNum">      87 </span>                :            :     void partIterator();</a>
<a name="88"><span class="lineNum">      88 </span>                :            : </a>
<a name="89"><span class="lineNum">      89 </span>                :            :     void geos();</a>
<a name="90"><span class="lineNum">      90 </span>                :            : </a>
<a name="91"><span class="lineNum">      91 </span>                :            :     void curveIndexOf_data();</a>
<a name="92"><span class="lineNum">      92 </span>                :            :     void curveIndexOf();</a>
<a name="93"><span class="lineNum">      93 </span>                :            :     void splitCurve_data();</a>
<a name="94"><span class="lineNum">      94 </span>                :            :     void splitCurve();</a>
<a name="95"><span class="lineNum">      95 </span>                :            : </a>
<a name="96"><span class="lineNum">      96 </span>                :            :     void fromQgsPointXY();</a>
<a name="97"><span class="lineNum">      97 </span>                :            :     void fromQPoint();</a>
<a name="98"><span class="lineNum">      98 </span>                :            :     void fromQPolygonF();</a>
<a name="99"><span class="lineNum">      99 </span>                :            :     void fromPolyline();</a>
<a name="100"><span class="lineNum">     100 </span>                :            :     void asQPointF();</a>
<a name="101"><span class="lineNum">     101 </span>                :            :     void asQPolygonF();</a>
<a name="102"><span class="lineNum">     102 </span>                :            : </a>
<a name="103"><span class="lineNum">     103 </span>                :            :     void comparePolylines();</a>
<a name="104"><span class="lineNum">     104 </span>                :            :     void comparePolygons();</a>
<a name="105"><span class="lineNum">     105 </span>                :            : </a>
<a name="106"><span class="lineNum">     106 </span>                :            :     void createEmptyWithSameType();</a>
<a name="107"><span class="lineNum">     107 </span>                :            : </a>
<a name="108"><span class="lineNum">     108 </span>                :            :     void compareTo_data();</a>
<a name="109"><span class="lineNum">     109 </span>                :            :     void compareTo();</a>
<a name="110"><span class="lineNum">     110 </span>                :            : </a>
<a name="111"><span class="lineNum">     111 </span>                :            :     void scroll_data();</a>
<a name="112"><span class="lineNum">     112 </span>                :            :     void scroll();</a>
<a name="113"><span class="lineNum">     113 </span>                :            : </a>
<a name="114"><span class="lineNum">     114 </span>                :            :     void normalize_data();</a>
<a name="115"><span class="lineNum">     115 </span>                :            :     void normalize();</a>
<a name="116"><span class="lineNum">     116 </span>                :            : </a>
<a name="117"><span class="lineNum">     117 </span>                :            :     void simplifiedTypeRef_data();</a>
<a name="118"><span class="lineNum">     118 </span>                :            :     void simplifiedTypeRef();</a>
<a name="119"><span class="lineNum">     119 </span>                :            : </a>
<a name="120"><span class="lineNum">     120 </span>                :            :     // MK, Disabled 14.11.2014</a>
<a name="121"><span class="lineNum">     121 </span>                :            :     // Too unclear what exactly should be tested and which variations are allowed for the line</a>
<a name="122"><span class="lineNum">     122 </span>                :            : #if 0</a>
<a name="123"><span class="lineNum">     123 </span>                :            :     void simplifyCheck1();</a>
<a name="124"><span class="lineNum">     124 </span>                :            : #endif</a>
<a name="125"><span class="lineNum">     125 </span>                :            : </a>
<a name="126"><span class="lineNum">     126 </span>                :            :     void intersectionCheck1();</a>
<a name="127"><span class="lineNum">     127 </span>                :            :     void intersectionCheck2();</a>
<a name="128"><span class="lineNum">     128 </span>                :            :     void translateCheck1();</a>
<a name="129"><span class="lineNum">     129 </span>                :            :     void rotateCheck1();</a>
<a name="130"><span class="lineNum">     130 </span>                :            :     void unionCheck1();</a>
<a name="131"><span class="lineNum">     131 </span>                :            :     void unionCheck2();</a>
<a name="132"><span class="lineNum">     132 </span>                :            :     void differenceCheck1();</a>
<a name="133"><span class="lineNum">     133 </span>                :            :     void differenceCheck2();</a>
<a name="134"><span class="lineNum">     134 </span>                :            :     void bufferCheck();</a>
<a name="135"><span class="lineNum">     135 </span>                :            :     void smoothCheck();</a>
<a name="136"><span class="lineNum">     136 </span>                :            :     void shortestLineEmptyGeometry();</a>
<a name="137"><span class="lineNum">     137 </span>                :            : </a>
<a name="138"><span class="lineNum">     138 </span>                :            :     void unaryUnion();</a>
<a name="139"><span class="lineNum">     139 </span>                :            : </a>
<a name="140"><span class="lineNum">     140 </span>                :            :     void dataStream();</a>
<a name="141"><span class="lineNum">     141 </span>                :            : </a>
<a name="142"><span class="lineNum">     142 </span>                :            :     void exportToGeoJSON();</a>
<a name="143"><span class="lineNum">     143 </span>                :            : </a>
<a name="144"><span class="lineNum">     144 </span>                :            :     void wkbInOut();</a>
<a name="145"><span class="lineNum">     145 </span>                :            : </a>
<a name="146"><span class="lineNum">     146 </span>                :            :     void directionNeutralSegmentation();</a>
<a name="147"><span class="lineNum">     147 </span>                :            :     void poleOfInaccessibility();</a>
<a name="148"><span class="lineNum">     148 </span>                :            : </a>
<a name="149"><span class="lineNum">     149 </span>                :            :     void makeValid_data();</a>
<a name="150"><span class="lineNum">     150 </span>                :            :     void makeValid();</a>
<a name="151"><span class="lineNum">     151 </span>                :            : </a>
<a name="152"><span class="lineNum">     152 </span>                :            :     void isSimple_data();</a>
<a name="153"><span class="lineNum">     153 </span>                :            :     void isSimple();</a>
<a name="154"><span class="lineNum">     154 </span>                :            : </a>
<a name="155"><span class="lineNum">     155 </span>                :            :     void reshapeGeometryLineMerge();</a>
<a name="156"><span class="lineNum">     156 </span>                :            :     void createCollectionOfType();</a>
<a name="157"><span class="lineNum">     157 </span>                :            : </a>
<a name="158"><span class="lineNum">     158 </span>                :            :     void orientedMinimumBoundingBox( );</a>
<a name="159"><span class="lineNum">     159 </span>                :            :     void minimalEnclosingCircle( );</a>
<a name="160"><span class="lineNum">     160 </span>                :            :     void splitGeometry();</a>
<a name="161"><span class="lineNum">     161 </span>                :            :     void snappedToGrid();</a>
<a name="162"><span class="lineNum">     162 </span>                :            : </a>
<a name="163"><span class="lineNum">     163 </span>                :            :     void convertGeometryCollectionToSubclass();</a>
<a name="164"><span class="lineNum">     164 </span>                :            : </a>
<a name="165"><span class="lineNum">     165 </span>                :            :     void emptyJson();</a>
<a name="166"><span class="lineNum">     166 </span>                :            : </a>
<a name="167"><span class="lineNum">     167 </span>                :            :     void testRandomPointsInPolygon();</a>
<a name="168"><span class="lineNum">     168 </span>                :            : </a>
<a name="169"><span class="lineNum">     169 </span>                :            :     void wktParser();</a>
<a name="170"><span class="lineNum">     170 </span>                :            : </a>
<a name="171"><span class="lineNum">     171 </span>                :            :   private:</a>
<a name="172"><span class="lineNum">     172 </span>                :            :     //! Must be called before each render test</a>
<a name="173"><span class="lineNum">     173 </span>                :            :     void initPainterTest();</a>
<a name="174"><span class="lineNum">     174 </span>                :            : </a>
<a name="175"><span class="lineNum">     175 </span>                :            :     //! A helper method to do a render check to see if the geometry op is as expected</a>
<a name="176"><span class="lineNum">     176 </span>                :            :     bool renderCheck( const QString &amp;testName, const QString &amp;comment = QString(), int mismatchCount = 0 );</a>
<a name="177"><span class="lineNum">     177 </span>                :            :     //! A helper method to dump to qdebug the geometry of a multipolygon</a>
<a name="178"><span class="lineNum">     178 </span>                :            :     void dumpMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon );</a>
<a name="179"><span class="lineNum">     179 </span>                :            :     void paintMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon );</a>
<a name="180"><span class="lineNum">     180 </span>                :            :     //! A helper method to dump to qdebug the geometry of a polygon</a>
<a name="181"><span class="lineNum">     181 </span>                :            :     void dumpPolygon( QgsPolygonXY &amp;polygon );</a>
<a name="182"><span class="lineNum">     182 </span>                :            :     void paintPolygon( QgsPolygonXY &amp;polygon );</a>
<a name="183"><span class="lineNum">     183 </span>                :            :     //! A helper method to dump to qdebug the geometry of a polyline</a>
<a name="184"><span class="lineNum">     184 </span>                :            :     void dumpPolyline( QgsPolylineXY &amp;polyline );</a>
<a name="185"><span class="lineNum">     185 </span>                :            : </a>
<a name="186"><span class="lineNum">     186 </span>                :            :     // Release return with delete []</a>
<a name="187"><span class="lineNum">     187 </span>                :<span class="lineCov">          2 :     unsigned char *hex2bytes( const char *hex, int *size )</span></a>
<a name="188"><span class="lineNum">     188 </span>                :            :     {</a>
<a name="189"><span class="lineNum">     189 </span>                :<span class="lineCov">          2 :       QByteArray ba = QByteArray::fromHex( hex );</span></a>
<a name="190"><span class="lineNum">     190 </span>                :<span class="lineCov">          2 :       unsigned char *out = new unsigned char[ba.size()];</span></a>
<a name="191"><span class="lineNum">     191 </span>                :<span class="lineCov">          2 :       memcpy( out, ba.data(), ba.size() );</span></a>
<a name="192"><span class="lineNum">     192 </span>                :<span class="lineCov">          2 :       *size = ba.size();</span></a>
<a name="193"><span class="lineNum">     193 </span>                :<span class="lineCov">          2 :       return out;</span></a>
<a name="194"><span class="lineNum">     194 </span>                :<span class="lineCov">          2 :     }</span></a>
<a name="195"><span class="lineNum">     195 </span>                :            : </a>
<a name="196"><span class="lineNum">     196 </span>                :            :     QString bytes2hex( const unsigned char *bytes, int size )</a>
<a name="197"><span class="lineNum">     197 </span>                :            :     {</a>
<a name="198"><span class="lineNum">     198 </span>                :            :       QByteArray ba( ( const char * )bytes, size );</a>
<a name="199"><span class="lineNum">     199 </span>                :            :       QString out = ba.toHex();</a>
<a name="200"><span class="lineNum">     200 </span>                :            :       return out;</a>
<a name="201"><span class="lineNum">     201 </span>                :            :     }</a>
<a name="202"><span class="lineNum">     202 </span>                :            : </a>
<a name="203"><span class="lineNum">     203 </span>                :            : </a>
<a name="204"><span class="lineNum">     204 </span>                :            :     QgsPointXY mPoint1;</a>
<a name="205"><span class="lineNum">     205 </span>                :            :     QgsPointXY mPoint2;</a>
<a name="206"><span class="lineNum">     206 </span>                :            :     QgsPointXY mPoint3;</a>
<a name="207"><span class="lineNum">     207 </span>                :            :     QgsPointXY mPoint4;</a>
<a name="208"><span class="lineNum">     208 </span>                :            :     QgsPointXY mPointA;</a>
<a name="209"><span class="lineNum">     209 </span>                :            :     QgsPointXY mPointB;</a>
<a name="210"><span class="lineNum">     210 </span>                :            :     QgsPointXY mPointC;</a>
<a name="211"><span class="lineNum">     211 </span>                :            :     QgsPointXY mPointD;</a>
<a name="212"><span class="lineNum">     212 </span>                :            :     QgsPointXY mPointW;</a>
<a name="213"><span class="lineNum">     213 </span>                :            :     QgsPointXY mPointX;</a>
<a name="214"><span class="lineNum">     214 </span>                :            :     QgsPointXY mPointY;</a>
<a name="215"><span class="lineNum">     215 </span>                :            :     QgsPointXY mPointZ;</a>
<a name="216"><span class="lineNum">     216 </span>                :            :     QgsPolylineXY mPolylineA;</a>
<a name="217"><span class="lineNum">     217 </span>                :            :     QgsPolylineXY mPolylineB;</a>
<a name="218"><span class="lineNum">     218 </span>                :            :     QgsPolylineXY mPolylineC;</a>
<a name="219"><span class="lineNum">     219 </span>                :            :     QgsGeometry mpPolylineGeometryD;</a>
<a name="220"><span class="lineNum">     220 </span>                :            :     QgsPolygonXY mPolygonA;</a>
<a name="221"><span class="lineNum">     221 </span>                :            :     QgsPolygonXY mPolygonB;</a>
<a name="222"><span class="lineNum">     222 </span>                :            :     QgsPolygonXY mPolygonC;</a>
<a name="223"><span class="lineNum">     223 </span>                :            :     QgsGeometry mpPolygonGeometryA;</a>
<a name="224"><span class="lineNum">     224 </span>                :            :     QgsGeometry mpPolygonGeometryB;</a>
<a name="225"><span class="lineNum">     225 </span>                :            :     QgsGeometry mpPolygonGeometryC;</a>
<a name="226"><span class="lineNum">     226 </span>                :            :     QString mWktLine;</a>
<a name="227"><span class="lineNum">     227 </span>                :            :     QString mTestDataDir;</a>
<a name="228"><span class="lineNum">     228 </span>                :            :     QImage mImage;</a>
<a name="229"><span class="lineNum">     229 </span>                :<span class="lineCov">          1 :     QPainter *mpPainter = nullptr;</span></a>
<a name="230"><span class="lineNum">     230 </span>                :            :     QPen mPen1;</a>
<a name="231"><span class="lineNum">     231 </span>                :            :     QPen mPen2;</a>
<a name="232"><span class="lineNum">     232 </span>                :            :     QString mReport;</a>
<a name="233"><span class="lineNum">     233 </span>                :            : </a>
<a name="234"><span class="lineNum">     234 </span>                :            : };</a>
<a name="235"><span class="lineNum">     235 </span>                :            : </a>
<a name="236"><span class="lineNum">     236 </span>                :<span class="lineCov">          3 : TestQgsGeometry::TestQgsGeometry()</span></a>
<a name="237"><span class="lineNum">     237 </span>                :<span class="lineCov">          1 :   : mpPolylineGeometryD( nullptr )</span></a>
<a name="238"><span class="lineNum">     238 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryA( nullptr )</span></a>
<a name="239"><span class="lineNum">     239 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryB( nullptr )</span></a>
<a name="240"><span class="lineNum">     240 </span>                :<span class="lineCov">          1 :   , mpPolygonGeometryC( nullptr )</span></a>
<a name="241"><span class="lineNum">     241 </span>                :<span class="lineCov">          2 : {</span></a>
<a name="242"><span class="lineNum">     242 </span>                :            : </a>
<a name="243"><span class="lineNum">     243 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="244"><span class="lineNum">     244 </span>                :            : </a>
<a name="245"><span class="lineNum">     245 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::initTestCase()</span></a>
<a name="246"><span class="lineNum">     246 </span>                :            : {</a>
<a name="247"><span class="lineNum">     247 </span>                :            :   // Runs once before any tests are run</a>
<a name="248"><span class="lineNum">     248 </span>                :            :   // init QGIS's paths - true means that all path will be inited from prefix</a>
<a name="249"><span class="lineNum">     249 </span>                :<span class="lineCov">          1 :   QgsApplication::init();</span></a>
<a name="250"><span class="lineNum">     250 </span>                :<span class="lineCov">          1 :   QgsApplication::initQgis();</span></a>
<a name="251"><span class="lineNum">     251 </span>                :<span class="lineCov">          1 :   QgsApplication::showSettings();</span></a>
<a name="252"><span class="lineNum">     252 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;h1&gt;Geometry Tests&lt;/h1&gt;\n&quot; );</span></a>
<a name="253"><span class="lineNum">     253 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;green\&quot;&gt;Green = polygonA&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="254"><span class="lineNum">     254 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;red\&quot;&gt;Red = polygonB&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="255"><span class="lineNum">     255 </span>                :<span class="lineCov">          1 :   mReport += QLatin1String( &quot;&lt;p&gt;&lt;font color=\&quot;blue\&quot;&gt;Blue = polygonC&lt;/font&gt;&lt;/p&gt;\n&quot; );</span></a>
<a name="256"><span class="lineNum">     256 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="257"><span class="lineNum">     257 </span>                :            : </a>
<a name="258"><span class="lineNum">     258 </span>                :            : </a>
<a name="259"><span class="lineNum">     259 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::cleanupTestCase()</span></a>
<a name="260"><span class="lineNum">     260 </span>                :            : {</a>
<a name="261"><span class="lineNum">     261 </span>                :<span class="lineCov">          1 :   delete mpPainter;</span></a>
<a name="262"><span class="lineNum">     262 </span>                :<span class="lineCov">          1 :   mpPainter = nullptr;</span></a>
<a name="263"><span class="lineNum">     263 </span>                :            : </a>
<a name="264"><span class="lineNum">     264 </span>                :            :   // Runs once after all tests are run</a>
<a name="265"><span class="lineNum">     265 </span>                :<span class="lineCov">          1 :   QString myReportFile = QDir::tempPath() + &quot;/qgistest.html&quot;;</span></a>
<a name="266"><span class="lineNum">     266 </span>                :<span class="lineCov">          1 :   QFile myFile( myReportFile );</span></a>
<a name="267"><span class="lineNum">     267 </span>                :<span class="lineCov">          1 :   if ( myFile.open( QIODevice::WriteOnly | QIODevice::Append ) )</span></a>
<a name="268"><span class="lineNum">     268 </span>                :            :   {</a>
<a name="269"><span class="lineNum">     269 </span>                :<span class="lineCov">          1 :     QTextStream myQTextStream( &amp;myFile );</span></a>
<a name="270"><span class="lineNum">     270 </span>                :<span class="lineCov">          1 :     myQTextStream &lt;&lt; mReport;</span></a>
<a name="271"><span class="lineNum">     271 </span>                :<span class="lineCov">          1 :     myFile.close();</span></a>
<a name="272"><span class="lineNum">     272 </span>                :            :     //QDesktopServices::openUrl( &quot;file:///&quot; + myReportFile );</a>
<a name="273"><span class="lineNum">     273 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="274"><span class="lineNum">     274 </span>                :            : </a>
<a name="275"><span class="lineNum">     275 </span>                :<span class="lineCov">          1 :   QgsApplication::exitQgis();</span></a>
<a name="276"><span class="lineNum">     276 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="277"><span class="lineNum">     277 </span>                :            : </a>
<a name="278"><span class="lineNum">     278 </span>                :<span class="lineCov">          6 : void TestQgsGeometry::initPainterTest()</span></a>
<a name="279"><span class="lineNum">     279 </span>                :            : {</a>
<a name="280"><span class="lineNum">     280 </span>                :<span class="lineCov">          6 :   delete mpPainter;</span></a>
<a name="281"><span class="lineNum">     281 </span>                :<span class="lineCov">          6 :   mpPainter = nullptr;</span></a>
<a name="282"><span class="lineNum">     282 </span>                :            :   //</a>
<a name="283"><span class="lineNum">     283 </span>                :            :   // Reset / reinitialize the geometries before each test is run</a>
<a name="284"><span class="lineNum">     284 </span>                :            :   //</a>
<a name="285"><span class="lineNum">     285 </span>                :<span class="lineCov">          6 :   mPoint1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="286"><span class="lineNum">     286 </span>                :<span class="lineCov">          6 :   mPoint2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="287"><span class="lineNum">     287 </span>                :<span class="lineCov">          6 :   mPoint3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="288"><span class="lineNum">     288 </span>                :<span class="lineCov">          6 :   mPoint4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="289"><span class="lineNum">     289 </span>                :<span class="lineCov">          6 :   mPointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="290"><span class="lineNum">     290 </span>                :<span class="lineCov">          6 :   mPointB = QgsPointXY( 100.0, 40.0 );</span></a>
<a name="291"><span class="lineNum">     291 </span>                :<span class="lineCov">          6 :   mPointC = QgsPointXY( 100.0, 100.0 );</span></a>
<a name="292"><span class="lineNum">     292 </span>                :<span class="lineCov">          6 :   mPointD = QgsPointXY( 40.0, 100.0 );</span></a>
<a name="293"><span class="lineNum">     293 </span>                :<span class="lineCov">          6 :   mPointW = QgsPointXY( 200.0, 200.0 );</span></a>
<a name="294"><span class="lineNum">     294 </span>                :<span class="lineCov">          6 :   mPointX = QgsPointXY( 240.0, 200.0 );</span></a>
<a name="295"><span class="lineNum">     295 </span>                :<span class="lineCov">          6 :   mPointY = QgsPointXY( 240.0, 240.0 );</span></a>
<a name="296"><span class="lineNum">     296 </span>                :<span class="lineCov">          6 :   mPointZ = QgsPointXY( 200.0, 240.0 );</span></a>
<a name="297"><span class="lineNum">     297 </span>                :            : </a>
<a name="298"><span class="lineNum">     298 </span>                :<span class="lineCov">         12 :   mWktLine = QStringLiteral( &quot;LINESTRING(117.623198 35.198654, 117.581274 35.198654, 117.078178 35.324427, 116.868555 35.534051, 116.617007 35.869448, 116.491233 35.953297, 116.155836 36.288694, 116.071987 36.372544, 115.443117 36.749865, 114.814247 37.043338, 114.311152 37.169112, 113.388810 37.378735, 113.095337 37.378735, 112.592241 37.378735, 111.753748 37.294886, 111.502201 37.252961, 111.082954 37.127187, 110.747557 37.127187, 110.160612 36.917564, 110.034838 36.833715, 109.741366 36.749865, 109.573667 36.666016, 109.238270 36.498317, 109.070571 36.414468, 108.819023 36.288694, 108.693250 36.246770, 108.483626 36.162920, 107.645134 35.911372, 106.597017 35.869448, 106.051997 35.701749, 105.800449 35.617900, 105.590826 35.575975, 105.297354 35.575975, 104.961956 35.575975, 104.710409 35.534051, 104.458861 35.492126, 103.871916 35.492126, 103.788066 35.492126, 103.326895 35.408277, 102.949574 35.408277, 102.488402 35.450201, 102.069156 35.450201, 101.482211 35.450201, 100.937191 35.659825, 100.308321 35.869448, 100.056773 36.037146, 99.050582 36.079071, 97.667069 35.743674, 97.163973 35.617900, 96.115857 35.534051, 95.612761 35.534051, 94.396947 35.911372, 93.684228 36.288694, 92.929584 36.833715, 92.258790 37.169112, 91.629920 37.504509, 90.414105 37.881831, 90.414105 37.881831, 90.246407 37.923755, 89.491763 37.839906, 89.156366 37.672207, 88.485572 37.504509, 87.814778 37.252961, 87.563230 37.169112, 87.143983 37.043338, 85.970093 36.875639, 85.802395 36.875639, 84.083484 36.959489, 84.041560 37.043338, 82.951519 37.546433, 82.699971 37.630283)&quot; );</span></a>
<a name="299"><span class="lineNum">     299 </span>                :            : </a>
<a name="300"><span class="lineNum">     300 </span>                :<span class="lineCov">          6 :   mPolygonA.clear();</span></a>
<a name="301"><span class="lineNum">     301 </span>                :<span class="lineCov">          6 :   mPolygonB.clear();</span></a>
<a name="302"><span class="lineNum">     302 </span>                :<span class="lineCov">          6 :   mPolygonC.clear();</span></a>
<a name="303"><span class="lineNum">     303 </span>                :<span class="lineCov">          6 :   mPolylineA.clear();</span></a>
<a name="304"><span class="lineNum">     304 </span>                :<span class="lineCov">          6 :   mPolylineB.clear();</span></a>
<a name="305"><span class="lineNum">     305 </span>                :<span class="lineCov">          6 :   mPolylineC.clear();</span></a>
<a name="306"><span class="lineNum">     306 </span>                :<span class="lineCov">          6 :   mPolylineA &lt;&lt; mPoint1 &lt;&lt; mPoint2 &lt;&lt; mPoint3 &lt;&lt; mPoint4 &lt;&lt; mPoint1;</span></a>
<a name="307"><span class="lineNum">     307 </span>                :<span class="lineCov">          6 :   mPolygonA &lt;&lt; mPolylineA;</span></a>
<a name="308"><span class="lineNum">     308 </span>                :            :   //Polygon B intersects Polygon A</a>
<a name="309"><span class="lineNum">     309 </span>                :<span class="lineCov">          6 :   mPolylineB &lt;&lt; mPointA &lt;&lt; mPointB &lt;&lt; mPointC &lt;&lt; mPointD &lt;&lt; mPointA;</span></a>
<a name="310"><span class="lineNum">     310 </span>                :<span class="lineCov">          6 :   mPolygonB &lt;&lt; mPolylineB;</span></a>
<a name="311"><span class="lineNum">     311 </span>                :            :   // Polygon C should intersect no other polys</a>
<a name="312"><span class="lineNum">     312 </span>                :<span class="lineCov">          6 :   mPolylineC &lt;&lt; mPointW &lt;&lt; mPointX &lt;&lt; mPointY &lt;&lt; mPointZ &lt;&lt; mPointW;</span></a>
<a name="313"><span class="lineNum">     313 </span>                :<span class="lineCov">          6 :   mPolygonC &lt;&lt; mPolylineC;</span></a>
<a name="314"><span class="lineNum">     314 </span>                :            : </a>
<a name="315"><span class="lineNum">     315 </span>                :<span class="lineCov">          6 :   mpPolylineGeometryD = QgsGeometry::fromWkt( mWktLine );</span></a>
<a name="316"><span class="lineNum">     316 </span>                :            : </a>
<a name="317"><span class="lineNum">     317 </span>                :            :   //polygon: first item of the list is outer ring,</a>
<a name="318"><span class="lineNum">     318 </span>                :            :   // inner rings (if any) start from second item</a>
<a name="319"><span class="lineNum">     319 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryA = QgsGeometry::fromPolygonXY( mPolygonA );</span></a>
<a name="320"><span class="lineNum">     320 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryB = QgsGeometry::fromPolygonXY( mPolygonB );</span></a>
<a name="321"><span class="lineNum">     321 </span>                :<span class="lineCov">          6 :   mpPolygonGeometryC = QgsGeometry::fromPolygonXY( mPolygonC );</span></a>
<a name="322"><span class="lineNum">     322 </span>                :            : </a>
<a name="323"><span class="lineNum">     323 </span>                :<span class="lineCov">          6 :   mImage = QImage( 250, 250, QImage::Format_RGB32 );</span></a>
<a name="324"><span class="lineNum">     324 </span>                :<span class="lineCov">          6 :   mImage.fill( qRgb( 152, 219, 249 ) );</span></a>
<a name="325"><span class="lineNum">     325 </span>                :<span class="lineCov">          6 :   mpPainter = new QPainter( &amp;mImage );</span></a>
<a name="326"><span class="lineNum">     326 </span>                :            : </a>
<a name="327"><span class="lineNum">     327 </span>                :            :   // Draw the test shapes first</a>
<a name="328"><span class="lineNum">     328 </span>                :<span class="lineCov">          6 :   mPen1 = QPen();</span></a>
<a name="329"><span class="lineNum">     329 </span>                :<span class="lineCov">          6 :   mPen1.setWidth( 5 );</span></a>
<a name="330"><span class="lineNum">     330 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::green );</span></a>
<a name="331"><span class="lineNum">     331 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="332"><span class="lineNum">     332 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonA );</span></a>
<a name="333"><span class="lineNum">     333 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::red );</span></a>
<a name="334"><span class="lineNum">     334 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="335"><span class="lineNum">     335 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonB );</span></a>
<a name="336"><span class="lineNum">     336 </span>                :<span class="lineCov">          6 :   mPen1.setBrush( Qt::blue );</span></a>
<a name="337"><span class="lineNum">     337 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen1 );</span></a>
<a name="338"><span class="lineNum">     338 </span>                :<span class="lineCov">          6 :   paintPolygon( mPolygonC );</span></a>
<a name="339"><span class="lineNum">     339 </span>                :            : </a>
<a name="340"><span class="lineNum">     340 </span>                :<span class="lineCov">          6 :   mPen2 = QPen();</span></a>
<a name="341"><span class="lineNum">     341 </span>                :<span class="lineCov">          6 :   mPen2.setWidth( 1 );</span></a>
<a name="342"><span class="lineNum">     342 </span>                :<span class="lineCov">          6 :   mPen2.setBrush( Qt::black );</span></a>
<a name="343"><span class="lineNum">     343 </span>                :<span class="lineCov">          6 :   QBrush myBrush( Qt::DiagCrossPattern );</span></a>
<a name="344"><span class="lineNum">     344 </span>                :            : </a>
<a name="345"><span class="lineNum">     345 </span>                :            : </a>
<a name="346"><span class="lineNum">     346 </span>                :            :   //set the pen to a different color -</a>
<a name="347"><span class="lineNum">     347 </span>                :            :   //any test outs will be drawn in pen2</a>
<a name="348"><span class="lineNum">     348 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setPen( mPen2 );</span></a>
<a name="349"><span class="lineNum">     349 </span>                :<span class="lineCov">          6 :   mpPainter-&gt;setBrush( myBrush );</span></a>
<a name="350"><span class="lineNum">     350 </span>                :<span class="lineCov">          6 : }</span></a>
<a name="351"><span class="lineNum">     351 </span>                :            : </a>
<a name="352"><span class="lineNum">     352 </span>                :<span class="lineCov">        333 : void TestQgsGeometry::cleanup()</span></a>
<a name="353"><span class="lineNum">     353 </span>                :            : {</a>
<a name="354"><span class="lineNum">     354 </span>                :            :   // will be called after every testfunction.</a>
<a name="355"><span class="lineNum">     355 </span>                :<span class="lineCov">        333 : }</span></a>
<a name="356"><span class="lineNum">     356 </span>                :            : </a>
<a name="357"><span class="lineNum">     357 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::copy()</span></a>
<a name="358"><span class="lineNum">     358 </span>                :            : {</a>
<a name="359"><span class="lineNum">     359 </span>                :            :   //create a point geometry</a>
<a name="360"><span class="lineNum">     360 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="361"><span class="lineNum">     361 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="362"><span class="lineNum">     362 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="363"><span class="lineNum">     363 </span>                :            : </a>
<a name="364"><span class="lineNum">     364 </span>                :            :   //implicitly shared copy</a>
<a name="365"><span class="lineNum">     365 </span>                :<span class="lineCov">          1 :   QgsGeometry copy( original );</span></a>
<a name="366"><span class="lineNum">     366 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="367"><span class="lineNum">     367 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="368"><span class="lineNum">     368 </span>                :            : </a>
<a name="369"><span class="lineNum">     369 </span>                :            :   //trigger a detach</a>
<a name="370"><span class="lineNum">     370 </span>                :<span class="lineCov">          1 :   copy.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="371"><span class="lineNum">     371 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 3.0 );</span></a>
<a name="372"><span class="lineNum">     372 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 4.0 );</span></a>
<a name="373"><span class="lineNum">     373 </span>                :            : </a>
<a name="374"><span class="lineNum">     374 </span>                :            :   //make sure original was untouched</a>
<a name="375"><span class="lineNum">     375 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="376"><span class="lineNum">     376 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="377"><span class="lineNum">     377 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="378"><span class="lineNum">     378 </span>                :            : </a>
<a name="379"><span class="lineNum">     379 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::assignment()</span></a>
<a name="380"><span class="lineNum">     380 </span>                :            : {</a>
<a name="381"><span class="lineNum">     381 </span>                :            :   //create a point geometry</a>
<a name="382"><span class="lineNum">     382 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="383"><span class="lineNum">     383 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="384"><span class="lineNum">     384 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="385"><span class="lineNum">     385 </span>                :            : </a>
<a name="386"><span class="lineNum">     386 </span>                :            :   //assign to implicitly shared copy</a>
<a name="387"><span class="lineNum">     387 </span>                :<span class="lineCov">          1 :   QgsGeometry copy;</span></a>
<a name="388"><span class="lineNum">     388 </span>                :<span class="lineCov">          1 :   copy = original;</span></a>
<a name="389"><span class="lineNum">     389 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="390"><span class="lineNum">     390 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="391"><span class="lineNum">     391 </span>                :            : </a>
<a name="392"><span class="lineNum">     392 </span>                :            :   //trigger a detach</a>
<a name="393"><span class="lineNum">     393 </span>                :<span class="lineCov">          1 :   copy.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="394"><span class="lineNum">     394 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 3.0 );</span></a>
<a name="395"><span class="lineNum">     395 </span>                :<span class="lineCov">          1 :   QCOMPARE( copy.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 4.0 );</span></a>
<a name="396"><span class="lineNum">     396 </span>                :            : </a>
<a name="397"><span class="lineNum">     397 </span>                :            :   //make sure original was untouched</a>
<a name="398"><span class="lineNum">     398 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="399"><span class="lineNum">     399 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="400"><span class="lineNum">     400 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="401"><span class="lineNum">     401 </span>                :            : </a>
<a name="402"><span class="lineNum">     402 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asVariant()</span></a>
<a name="403"><span class="lineNum">     403 </span>                :            : {</a>
<a name="404"><span class="lineNum">     404 </span>                :            :   //create a point geometry</a>
<a name="405"><span class="lineNum">     405 </span>                :<span class="lineCov">          1 :   QgsGeometry original( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="406"><span class="lineNum">     406 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="407"><span class="lineNum">     407 </span>                :<span class="lineCov">          1 :   QCOMPARE( original.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="408"><span class="lineNum">     408 </span>                :            : </a>
<a name="409"><span class="lineNum">     409 </span>                :            :   //convert to and from a QVariant</a>
<a name="410"><span class="lineNum">     410 </span>                :<span class="lineCov">          1 :   QVariant var = QVariant::fromValue( original );</span></a>
<a name="411"><span class="lineNum">     411 </span>                :<span class="lineCov">          1 :   QVERIFY( var.isValid() );</span></a>
<a name="412"><span class="lineNum">     412 </span>                :<span class="lineCov">          1 :   QVERIFY( !var.canConvert&lt; QgsReferencedGeometry &gt;() );</span></a>
<a name="413"><span class="lineNum">     413 </span>                :            : </a>
<a name="414"><span class="lineNum">     414 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar = qvariant_cast&lt;QgsGeometry&gt;( var );</span></a>
<a name="415"><span class="lineNum">     415 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="416"><span class="lineNum">     416 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="417"><span class="lineNum">     417 </span>                :            : </a>
<a name="418"><span class="lineNum">     418 </span>                :            :   //also check copying variant</a>
<a name="419"><span class="lineNum">     419 </span>                :<span class="lineCov">          1 :   const QVariant &amp;var2 = var;</span></a>
<a name="420"><span class="lineNum">     420 </span>                :<span class="lineCov">          1 :   QVERIFY( var2.isValid() );</span></a>
<a name="421"><span class="lineNum">     421 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar2 = qvariant_cast&lt;QgsGeometry&gt;( var2 );</span></a>
<a name="422"><span class="lineNum">     422 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar2.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="423"><span class="lineNum">     423 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar2.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="424"><span class="lineNum">     424 </span>                :            : </a>
<a name="425"><span class="lineNum">     425 </span>                :            :   //modify original and check detachment</a>
<a name="426"><span class="lineNum">     426 </span>                :<span class="lineCov">          1 :   original.set( new QgsPoint( 3.0, 4.0 ) );</span></a>
<a name="427"><span class="lineNum">     427 </span>                :<span class="lineCov">          1 :   QgsGeometry fromVar3 = qvariant_cast&lt;QgsGeometry&gt;( var );</span></a>
<a name="428"><span class="lineNum">     428 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar3.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).x(), 1.0 );</span></a>
<a name="429"><span class="lineNum">     429 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromVar3.constGet()-&gt;vertexAt( QgsVertexId( 0, 0, 0 ) ).y(), 2.0 );</span></a>
<a name="430"><span class="lineNum">     430 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="431"><span class="lineNum">     431 </span>                :            : </a>
<a name="432"><span class="lineNum">     432 </span>                :            : </a>
<a name="433"><span class="lineNum">     433 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::referenced()</span></a>
<a name="434"><span class="lineNum">     434 </span>                :            : {</a>
<a name="435"><span class="lineNum">     435 </span>                :<span class="lineCov">          2 :   QgsReferencedGeometry geom1 = QgsReferencedGeometry( QgsGeometry::fromPointXY( QgsPointXY( 1, 2 ) ), QgsCoordinateReferenceSystem( QStringLiteral( &quot;EPSG:3111&quot; ) ) );</span></a>
<a name="436"><span class="lineNum">     436 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom1.crs().authid(), QStringLiteral( &quot;EPSG:3111&quot; ) );</span></a>
<a name="437"><span class="lineNum">     437 </span>                :<span class="lineCov">          2 :   geom1.setCrs( QgsCoordinateReferenceSystem( QStringLiteral( &quot;EPSG:28356&quot; ) ) );</span></a>
<a name="438"><span class="lineNum">     438 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom1.crs().authid(), QStringLiteral( &quot;EPSG:28356&quot; ) );</span></a>
<a name="439"><span class="lineNum">     439 </span>                :            : </a>
<a name="440"><span class="lineNum">     440 </span>                :            :   //convert to and from a QVariant</a>
<a name="441"><span class="lineNum">     441 </span>                :<span class="lineCov">          1 :   QVariant var = QVariant::fromValue( geom1 );</span></a>
<a name="442"><span class="lineNum">     442 </span>                :<span class="lineCov">          1 :   QVERIFY( var.isValid() );</span></a>
<a name="443"><span class="lineNum">     443 </span>                :            : </a>
<a name="444"><span class="lineNum">     444 </span>                :<span class="lineCov">          1 :   QVERIFY( var.canConvert&lt; QgsReferencedGeometry &gt;() );</span></a>
<a name="445"><span class="lineNum">     445 </span>                :            : </a>
<a name="446"><span class="lineNum">     446 </span>                :<span class="lineCov">          1 :   QgsReferencedGeometry geom2 = qvariant_cast&lt;QgsReferencedGeometry&gt;( var );</span></a>
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">          1 :   QCOMPARE( geom2.asWkt(), geom1.asWkt() );</span></a>
<a name="448"><span class="lineNum">     448 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom2.crs().authid(), QStringLiteral( &quot;EPSG:28356&quot; ) );</span></a>
<a name="449"><span class="lineNum">     449 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="450"><span class="lineNum">     450 </span>                :            : </a>
<a name="451"><span class="lineNum">     451 </span>                :            : </a>
<a name="452"><span class="lineNum">     452 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isEmpty()</span></a>
<a name="453"><span class="lineNum">     453 </span>                :            : {</a>
<a name="454"><span class="lineNum">     454 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="455"><span class="lineNum">     455 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isNull() );</span></a>
<a name="456"><span class="lineNum">     456 </span>                :            : </a>
<a name="457"><span class="lineNum">     457 </span>                :<span class="lineCov">          1 :   geom.set( new QgsPoint() );</span></a>
<a name="458"><span class="lineNum">     458 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isEmpty() );</span></a>
<a name="459"><span class="lineNum">     459 </span>                :            : </a>
<a name="460"><span class="lineNum">     460 </span>                :<span class="lineCov">          1 :   geom.set( new QgsPoint( 1.0, 2.0 ) );</span></a>
<a name="461"><span class="lineNum">     461 </span>                :<span class="lineCov">          1 :   QVERIFY( !geom.isNull() );</span></a>
<a name="462"><span class="lineNum">     462 </span>                :            : </a>
<a name="463"><span class="lineNum">     463 </span>                :<span class="lineCov">          1 :   geom.set( nullptr );</span></a>
<a name="464"><span class="lineNum">     464 </span>                :<span class="lineCov">          1 :   QVERIFY( geom.isNull() );</span></a>
<a name="465"><span class="lineNum">     465 </span>                :            : </a>
<a name="466"><span class="lineNum">     466 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection collection;</span></a>
<a name="467"><span class="lineNum">     467 </span>                :<span class="lineCov">          1 :   QVERIFY( collection.isEmpty() );</span></a>
<a name="468"><span class="lineNum">     468 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="469"><span class="lineNum">     469 </span>                :            : </a>
<a name="470"><span class="lineNum">     470 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isValid()</span></a>
<a name="471"><span class="lineNum">     471 </span>                :            : {</a>
<a name="472"><span class="lineNum">     472 </span>                :<span class="lineCov">          1 :   QString error;</span></a>
<a name="473"><span class="lineNum">     473 </span>                :            :   // LineString</a>
<a name="474"><span class="lineNum">     474 </span>                :<span class="lineCov">          1 :   QgsLineString line;</span></a>
<a name="475"><span class="lineNum">     475 </span>                :<span class="lineCov">          1 :   QVERIFY( line.isValid( error ) );</span></a>
<a name="476"><span class="lineNum">     476 </span>                :<span class="lineCov">          1 :   line.addVertex( QgsPoint( 0, 0 ) );</span></a>
<a name="477"><span class="lineNum">     477 </span>                :<span class="lineCov">          1 :   QVERIFY( !line.isValid( error ) );</span></a>
<a name="478"><span class="lineNum">     478 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;LineString has less than 2 points and is not empty.&quot; ) );</span></a>
<a name="479"><span class="lineNum">     479 </span>                :<span class="lineCov">          1 :   line.addVertex( QgsPoint( 1, 1 ) );</span></a>
<a name="480"><span class="lineNum">     480 </span>                :<span class="lineCov">          1 :   QVERIFY( line.isValid( error ) );</span></a>
<a name="481"><span class="lineNum">     481 </span>                :            : </a>
<a name="482"><span class="lineNum">     482 </span>                :            :   // CircularString</a>
<a name="483"><span class="lineNum">     483 </span>                :<span class="lineCov">          1 :   QgsCircularString circ;</span></a>
<a name="484"><span class="lineNum">     484 </span>                :<span class="lineCov">          1 :   QVERIFY( circ.isValid( error ) );</span></a>
<a name="485"><span class="lineNum">     485 </span>                :<span class="lineCov">          1 :   QgsPointSequence pts = QgsPointSequence() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 2.5, 2.3 );</span></a>
<a name="486"><span class="lineNum">     486 </span>                :<span class="lineCov">          1 :   circ.setPoints( pts );</span></a>
<a name="487"><span class="lineNum">     487 </span>                :<span class="lineCov">          1 :   QVERIFY( !circ.isValid( error ) );</span></a>
<a name="488"><span class="lineNum">     488 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;CircularString has less than 3 points and is not empty.&quot; ) );</span></a>
<a name="489"><span class="lineNum">     489 </span>                :<span class="lineCov">          1 :   pts.append( QgsPoint( 5, 5 ) );</span></a>
<a name="490"><span class="lineNum">     490 </span>                :<span class="lineCov">          1 :   circ.setPoints( pts );</span></a>
<a name="491"><span class="lineNum">     491 </span>                :<span class="lineCov">          1 :   QVERIFY( circ.isValid( error ) );</span></a>
<a name="492"><span class="lineNum">     492 </span>                :            : </a>
<a name="493"><span class="lineNum">     493 </span>                :            :   // CompoundCurve</a>
<a name="494"><span class="lineNum">     494 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve curve;</span></a>
<a name="495"><span class="lineNum">     495 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="496"><span class="lineNum">     496 </span>                :<span class="lineCov">          1 :   curve.addCurve( line.clone() );</span></a>
<a name="497"><span class="lineNum">     497 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="498"><span class="lineNum">     498 </span>                :<span class="lineCov">          1 :   curve.addCurve( circ.clone() );</span></a>
<a name="499"><span class="lineNum">     499 </span>                :<span class="lineCov">          1 :   QVERIFY( curve.isValid( error ) );</span></a>
<a name="500"><span class="lineNum">     500 </span>                :<span class="lineCov">          1 :   QgsLineString invalidLine;</span></a>
<a name="501"><span class="lineNum">     501 </span>                :<span class="lineCov">          1 :   invalidLine.addVertex( QgsPoint( 0, 0 ) );</span></a>
<a name="502"><span class="lineNum">     502 </span>                :<span class="lineCov">          1 :   curve.addCurve( invalidLine.clone() );</span></a>
<a name="503"><span class="lineNum">     503 </span>                :<span class="lineCov">          1 :   QVERIFY( !curve.isValid( error ) );</span></a>
<a name="504"><span class="lineNum">     504 </span>                :<span class="lineCov">          2 :   QCOMPARE( error, QStringLiteral( &quot;Curve[3]: LineString has less than 2 points and is not empty.&quot; ) );</span></a>
<a name="505"><span class="lineNum">     505 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="506"><span class="lineNum">     506 </span>                :            : </a>
<a name="507"><span class="lineNum">     507 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::equality()</span></a>
<a name="508"><span class="lineNum">     508 </span>                :            : {</a>
<a name="509"><span class="lineNum">     509 </span>                :            :   // null geometries</a>
<a name="510"><span class="lineNum">     510 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry().equals( QgsGeometry() ) );</span></a>
<a name="511"><span class="lineNum">     511 </span>                :            : </a>
<a name="512"><span class="lineNum">     512 </span>                :            :   // compare to null</a>
<a name="513"><span class="lineNum">     513 </span>                :<span class="lineCov">          1 :   QgsGeometry g1( std::make_unique&lt; QgsPoint &gt;( 1.0, 2.0 ) );</span></a>
<a name="514"><span class="lineNum">     514 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( QgsGeometry() ) );</span></a>
<a name="515"><span class="lineNum">     515 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry().equals( g1 ) );</span></a>
<a name="516"><span class="lineNum">     516 </span>                :            : </a>
<a name="517"><span class="lineNum">     517 </span>                :            :   // compare implicitly shared copies</a>
<a name="518"><span class="lineNum">     518 </span>                :<span class="lineCov">          1 :   QgsGeometry g2( g1 );</span></a>
<a name="519"><span class="lineNum">     519 </span>                :<span class="lineCov">          1 :   QVERIFY( g2.equals( g1 ) );</span></a>
<a name="520"><span class="lineNum">     520 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g2 ) );</span></a>
<a name="521"><span class="lineNum">     521 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g1 ) );</span></a>
<a name="522"><span class="lineNum">     522 </span>                :            : </a>
<a name="523"><span class="lineNum">     523 </span>                :            :   // equal geometry, but different internal data</a>
<a name="524"><span class="lineNum">     524 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;Point( 1.0 2.0 )&quot; );</span></a>
<a name="525"><span class="lineNum">     525 </span>                :<span class="lineCov">          1 :   QVERIFY( g2.equals( g1 ) );</span></a>
<a name="526"><span class="lineNum">     526 </span>                :<span class="lineCov">          1 :   QVERIFY( g1.equals( g2 ) );</span></a>
<a name="527"><span class="lineNum">     527 </span>                :            : </a>
<a name="528"><span class="lineNum">     528 </span>                :            :   // different dimensionality</a>
<a name="529"><span class="lineNum">     529 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;PointM( 1.0 2.0 3.0)&quot; );</span></a>
<a name="530"><span class="lineNum">     530 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="531"><span class="lineNum">     531 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="532"><span class="lineNum">     532 </span>                :            : </a>
<a name="533"><span class="lineNum">     533 </span>                :            :   // different type</a>
<a name="534"><span class="lineNum">     534 </span>                :<span class="lineCov">          1 :   g2 = QgsGeometry::fromWkt( &quot;LineString( 1.0 2.0, 3.0 4.0 )&quot; );</span></a>
<a name="535"><span class="lineNum">     535 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="536"><span class="lineNum">     536 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="537"><span class="lineNum">     537 </span>                :            : </a>
<a name="538"><span class="lineNum">     538 </span>                :            :   // different direction</a>
<a name="539"><span class="lineNum">     539 </span>                :<span class="lineCov">          1 :   g1 = QgsGeometry::fromWkt( &quot;LineString( 3.0 4.0, 1.0 2.0 )&quot; );</span></a>
<a name="540"><span class="lineNum">     540 </span>                :<span class="lineCov">          1 :   QVERIFY( !g2.equals( g1 ) );</span></a>
<a name="541"><span class="lineNum">     541 </span>                :<span class="lineCov">          1 :   QVERIFY( !g1.equals( g2 ) );</span></a>
<a name="542"><span class="lineNum">     542 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="543"><span class="lineNum">     543 </span>                :            : </a>
<a name="544"><span class="lineNum">     544 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::vertexIterator()</span></a>
<a name="545"><span class="lineNum">     545 </span>                :            : {</a>
<a name="546"><span class="lineNum">     546 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="547"><span class="lineNum">     547 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it = geom.vertices();</span></a>
<a name="548"><span class="lineNum">     548 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="549"><span class="lineNum">     549 </span>                :            : </a>
<a name="550"><span class="lineNum">     550 </span>                :<span class="lineCov">          1 :   QgsPolylineXY polyline;</span></a>
<a name="551"><span class="lineNum">     551 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QgsPoint( 1, 2 ) &lt;&lt; QgsPoint( 3, 4 );</span></a>
<a name="552"><span class="lineNum">     552 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2 = QgsGeometry::fromPolylineXY( polyline );</span></a>
<a name="553"><span class="lineNum">     553 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it2 = geom2.vertices();</span></a>
<a name="554"><span class="lineNum">     554 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="555"><span class="lineNum">     555 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 1, 2 ) );</span></a>
<a name="556"><span class="lineNum">     556 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="557"><span class="lineNum">     557 </span>                :<span class="lineCov">          1 :   QCOMPARE( it2.next(), QgsPoint( 3, 4 ) );</span></a>
<a name="558"><span class="lineNum">     558 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="559"><span class="lineNum">     559 </span>                :            : </a>
<a name="560"><span class="lineNum">     560 </span>                :<span class="lineCov">          1 :   QgsGeometry emptyGeom = QgsGeometry::fromWkt( &quot;LINESTRING EMPTY&quot; );</span></a>
<a name="561"><span class="lineNum">     561 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it3 = emptyGeom.vertices();</span></a>
<a name="562"><span class="lineNum">     562 </span>                :<span class="lineCov">          1 :   QVERIFY( !it3.hasNext() );</span></a>
<a name="563"><span class="lineNum">     563 </span>                :<span class="lineCov">          1 :   emptyGeom = QgsGeometry::fromWkt( &quot;POINT EMPTY&quot; );</span></a>
<a name="564"><span class="lineNum">     564 </span>                :<span class="lineCov">          1 :   QgsVertexIterator it4 = emptyGeom.vertices();</span></a>
<a name="565"><span class="lineNum">     565 </span>                :<span class="lineCov">          1 :   QVERIFY( !it4.hasNext() );</span></a>
<a name="566"><span class="lineNum">     566 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="567"><span class="lineNum">     567 </span>                :            : </a>
<a name="568"><span class="lineNum">     568 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::partIterator()</span></a>
<a name="569"><span class="lineNum">     569 </span>                :            : {</a>
<a name="570"><span class="lineNum">     570 </span>                :<span class="lineCov">          1 :   QgsGeometry geom;</span></a>
<a name="571"><span class="lineNum">     571 </span>                :<span class="lineCov">          1 :   QgsGeometryPartIterator it = geom.parts();</span></a>
<a name="572"><span class="lineNum">     572 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="573"><span class="lineNum">     573 </span>                :            : </a>
<a name="574"><span class="lineNum">     574 </span>                :<span class="lineCov">          2 :   geom = QgsGeometry::fromWkt( QStringLiteral( &quot;Point( 1 2 )&quot; ) );</span></a>
<a name="575"><span class="lineNum">     575 </span>                :<span class="lineCov">          1 :   QgsGeometryConstPartIterator it2 = geom.constParts();</span></a>
<a name="576"><span class="lineNum">     576 </span>                :<span class="lineCov">          1 :   QVERIFY( it2.hasNext() );</span></a>
<a name="577"><span class="lineNum">     577 </span>                :<span class="lineCov">          2 :   QCOMPARE( it2.next()-&gt;asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="578"><span class="lineNum">     578 </span>                :<span class="lineCov">          1 :   QVERIFY( !it2.hasNext() );</span></a>
<a name="579"><span class="lineNum">     579 </span>                :            : </a>
<a name="580"><span class="lineNum">     580 </span>                :            :   // test that non-const iterator detaches</a>
<a name="581"><span class="lineNum">     581 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2 = geom;</span></a>
<a name="582"><span class="lineNum">     582 </span>                :<span class="lineCov">          1 :   it = geom2.parts();</span></a>
<a name="583"><span class="lineNum">     583 </span>                :<span class="lineCov">          1 :   QVERIFY( it.hasNext() );</span></a>
<a name="584"><span class="lineNum">     584 </span>                :<span class="lineCov">          1 :   QgsAbstractGeometry *part = it.next();</span></a>
<a name="585"><span class="lineNum">     585 </span>                :<span class="lineCov">          2 :   QCOMPARE( part-&gt;asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="586"><span class="lineNum">     586 </span>                :<span class="lineCov">          1 :   static_cast&lt; QgsPoint * &gt;( part )-&gt;setX( 100 );</span></a>
<a name="587"><span class="lineNum">     587 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom2.asWkt(), QStringLiteral( &quot;Point (100 2)&quot; ) );</span></a>
<a name="588"><span class="lineNum">     588 </span>                :<span class="lineCov">          1 :   QVERIFY( !it.hasNext() );</span></a>
<a name="589"><span class="lineNum">     589 </span>                :            :   // geom2 should have adetached, geom should be unaffected by change</a>
<a name="590"><span class="lineNum">     590 </span>                :<span class="lineCov">          2 :   QCOMPARE( geom.asWkt(), QStringLiteral( &quot;Point (1 2)&quot; ) );</span></a>
<a name="591"><span class="lineNum">     591 </span>                :            : </a>
<a name="592"><span class="lineNum">     592 </span>                :            :   // See test_qgsgeometry.py for geometry-type specific checks!</a>
<a name="593"><span class="lineNum">     593 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="594"><span class="lineNum">     594 </span>                :            : </a>
<a name="595"><span class="lineNum">     595 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::geos()</span></a>
<a name="596"><span class="lineNum">     596 </span>                :            : {</a>
<a name="597"><span class="lineNum">     597 </span>                :            :   // test GEOS conversion utils</a>
<a name="598"><span class="lineNum">     598 </span>                :            : </a>
<a name="599"><span class="lineNum">     599 </span>                :            :   // empty parts should NOT be added to a GEOS collection -- it can cause crashes in GEOS</a>
<a name="600"><span class="lineNum">     600 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon polyWithEmptyParts;</span></a>
<a name="601"><span class="lineNum">     601 </span>                :<span class="lineCov">          1 :   geos::unique_ptr asGeos( QgsGeos::asGeos( &amp;polyWithEmptyParts ) );</span></a>
<a name="602"><span class="lineNum">     602 </span>                :<span class="lineCov">          1 :   QgsGeometry res( QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="603"><span class="lineNum">     603 </span>                :<span class="lineCov">          2 :   QCOMPARE( res.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="604"><span class="lineNum">     604 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString() ) );</span></a>
<a name="605"><span class="lineNum">     605 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 0, 0 ) &lt;&lt; QgsPoint( 0, 1 ) &lt;&lt; QgsPoint( 1, 1 ) &lt;&lt; QgsPoint( 0, 0 ) ) ) );</span></a>
<a name="606"><span class="lineNum">     606 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString() ) );</span></a>
<a name="607"><span class="lineNum">     607 </span>                :<span class="lineCov">          1 :   polyWithEmptyParts.addGeometry( new QgsPolygon( new QgsLineString( QVector&lt; QgsPoint &gt;() &lt;&lt; QgsPoint( 10, 0 ) &lt;&lt; QgsPoint( 10, 1 ) &lt;&lt; QgsPoint( 11, 1 ) &lt;&lt; QgsPoint( 10, 0 ) ) ) );</span></a>
<a name="608"><span class="lineNum">     608 </span>                :<span class="lineCov">          1 :   asGeos = QgsGeos::asGeos( &amp;polyWithEmptyParts );</span></a>
<a name="609"><span class="lineNum">     609 </span>                :<span class="lineCov">          1 :   QCOMPARE( GEOSGetNumGeometries_r( QgsGeos::getGEOSHandler(), asGeos.get() ), 2 );</span></a>
<a name="610"><span class="lineNum">     610 </span>                :<span class="lineCov">          1 :   res = QgsGeometry( QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="611"><span class="lineNum">     611 </span>                :<span class="lineCov">          2 :   QCOMPARE( res.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 0 1, 1 1, 0 0)),((10 0, 10 1, 11 1, 10 0)))&quot; ) );</span></a>
<a name="612"><span class="lineNum">     612 </span>                :            : </a>
<a name="613"><span class="lineNum">     613 </span>                :            :   // Empty geometry</a>
<a name="614"><span class="lineNum">     614 </span>                :<span class="lineCov">          1 :   QgsPoint point;</span></a>
<a name="615"><span class="lineNum">     615 </span>                :<span class="lineCov">          1 :   asGeos = QgsGeos::asGeos( &amp;point );</span></a>
<a name="616"><span class="lineNum">     616 </span>                :            :   // should be treated as a null geometry, not an empty point in order to maintain api compatibility with</a>
<a name="617"><span class="lineNum">     617 </span>                :            :   // earlier QGIS 3.x releases</a>
<a name="618"><span class="lineNum">     618 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeos::fromGeos( asGeos.get() ) );</span></a>
<a name="619"><span class="lineNum">     619 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="620"><span class="lineNum">     620 </span>                :            : </a>
<a name="621"><span class="lineNum">     621 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::curveIndexOf_data()</span></a>
<a name="622"><span class="lineNum">     622 </span>                :            : {</a>
<a name="623"><span class="lineNum">     623 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;curve&quot; );</span></a>
<a name="624"><span class="lineNum">     624 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;point&quot; );</span></a>
<a name="625"><span class="lineNum">     625 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;int&gt;( &quot;expected&quot; );</span></a>
<a name="626"><span class="lineNum">     626 </span>                :            : </a>
<a name="627"><span class="lineNum">     627 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; -1;</span></a>
<a name="628"><span class="lineNum">     628 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring one point no match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; -1;</span></a>
<a name="629"><span class="lineNum">     629 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring one point match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2 )&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; 0;</span></a>
<a name="630"><span class="lineNum">     630 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match 0&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; 0;</span></a>
<a name="631"><span class="lineNum">     631 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match 1&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 2 3 )&quot; ) &lt;&lt; 1;</span></a>
<a name="632"><span class="lineNum">     632 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match 2&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 3 4 )&quot; ) &lt;&lt; 2;</span></a>
<a name="633"><span class="lineNum">     633 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring no match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 3 3 )&quot; ) &lt;&lt; -1;</span></a>
<a name="634"><span class="lineNum">     634 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringz no match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 2 3 11)&quot; ) &lt;&lt; -1;</span></a>
<a name="635"><span class="lineNum">     635 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringz match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 2 3 12)&quot; ) &lt;&lt; 1;</span></a>
<a name="636"><span class="lineNum">     636 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringm no match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 2 3 11)&quot; ) &lt;&lt; -1;</span></a>
<a name="637"><span class="lineNum">     637 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringm match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 2 3 12)&quot; ) &lt;&lt; 1;</span></a>
<a name="638"><span class="lineNum">     638 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringzm no match z&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 2 3 11 22)&quot; ) &lt;&lt; -1;</span></a>
<a name="639"><span class="lineNum">     639 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringzm no match m&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 2 3 12 23)&quot; ) &lt;&lt; -1;</span></a>
<a name="640"><span class="lineNum">     640 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringzm match&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZM( 2 3 12 22)&quot; ) &lt;&lt; 1;</span></a>
<a name="641"><span class="lineNum">     641 </span>                :            : </a>
<a name="642"><span class="lineNum">     642 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring empty&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; -1;</span></a>
<a name="643"><span class="lineNum">     643 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match 0&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; 0;</span></a>
<a name="644"><span class="lineNum">     644 </span>                :            :   // should not match -- we only consider segment points, not curve points</a>
<a name="645"><span class="lineNum">     645 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match 1&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 2 3 )&quot; ) &lt;&lt; -1;</span></a>
<a name="646"><span class="lineNum">     646 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match 2&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 3 4 )&quot; ) &lt;&lt; 2;</span></a>
<a name="647"><span class="lineNum">     647 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring no match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 3 3 )&quot; ) &lt;&lt; -1;</span></a>
<a name="648"><span class="lineNum">     648 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringz no match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 3 4 12)&quot; ) &lt;&lt; -1;</span></a>
<a name="649"><span class="lineNum">     649 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringz match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 3 4 13)&quot; ) &lt;&lt; 2;</span></a>
<a name="650"><span class="lineNum">     650 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringm no match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 3 4 12)&quot; ) &lt;&lt; -1;</span></a>
<a name="651"><span class="lineNum">     651 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringm match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 2 11, 2 3 12, 3 4 13)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 3 4 13)&quot; ) &lt;&lt; 2;</span></a>
<a name="652"><span class="lineNum">     652 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringzm no match z&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 3 4 14 23)&quot; ) &lt;&lt; -1;</span></a>
<a name="653"><span class="lineNum">     653 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringzm no match m&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 3 4 13 24)&quot; ) &lt;&lt; -1;</span></a>
<a name="654"><span class="lineNum">     654 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringzm match&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23)&quot; ) &lt;&lt; QStringLiteral( &quot;PointZM( 3 4 13 23)&quot; ) &lt;&lt; 2;</span></a>
<a name="655"><span class="lineNum">     655 </span>                :            : </a>
<a name="656"><span class="lineNum">     656 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 2 )&quot; ) &lt;&lt; -1;</span></a>
<a name="657"><span class="lineNum">     657 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve no match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 21 )&quot; ) &lt;&lt; -1;</span></a>
<a name="658"><span class="lineNum">     658 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 0&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 1 1 )&quot; ) &lt;&lt; 0;</span></a>
<a name="659"><span class="lineNum">     659 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 1&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 2 3 )&quot; ) &lt;&lt; 1;</span></a>
<a name="660"><span class="lineNum">     660 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 2&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 3 4 )&quot; ) &lt;&lt; 2;</span></a>
<a name="661"><span class="lineNum">     661 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 3&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 5 6 )&quot; ) &lt;&lt; 3;</span></a>
<a name="662"><span class="lineNum">     662 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 4&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 7 8 )&quot; ) &lt;&lt; 4;</span></a>
<a name="663"><span class="lineNum">     663 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve match 5&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),(3 4, 5 6, 7 8),(7 8, 9 10))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 9 10 )&quot; ) &lt;&lt; 5;</span></a>
<a name="664"><span class="lineNum">     664 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve circular string match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),CIRCULARSTRING(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 7 8 )&quot; ) &lt;&lt; 4;</span></a>
<a name="665"><span class="lineNum">     665 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve circular string no match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 3, 3 4),CIRCULARSTRING(3 4, 5 6, 7 8))&quot; ) &lt;&lt; QStringLiteral( &quot;Point( 5 6 )&quot; ) &lt;&lt; -1;</span></a>
<a name="666"><span class="lineNum">     666 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ((1 1 11, 2 3 12, 3 4 13),(3 4 13, 5 6 14, 7 8 15))&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 7 8 15)&quot; ) &lt;&lt; 4;</span></a>
<a name="667"><span class="lineNum">     667 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z nomatch&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ((1 1 11, 2 3 12, 3 4 13),(3 4 13, 5 6 14, 7 8 15))&quot; ) &lt;&lt; QStringLiteral( &quot;PointZ( 7 8 16)&quot; ) &lt;&lt; -1;</span></a>
<a name="668"><span class="lineNum">     668 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM((1 1 11, 2 3 12, 3 4 13),(3 4 13, 5 6 14, 7 8 15))&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 7 8 15)&quot; ) &lt;&lt; 4;</span></a>
<a name="669"><span class="lineNum">     669 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m nomatch&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM((1 1 11, 2 3 12, 3 4 13),(3 4 13, 5 6 14, 7 8 15))&quot; ) &lt;&lt; QStringLiteral( &quot;PointM( 7 8 16)&quot; ) &lt;&lt; -1;</span></a>
<a name="670"><span class="lineNum">     670 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm match&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM((1 1 11 22, 2 3 12 23, 3 4 13 24),(3 4 13 24, 5 6 14 25, 7 8 15 26))&quot; ) &lt;&lt; QStringLiteral( &quot;PointZM( 7 8 15 26)&quot; ) &lt;&lt; 4;</span></a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm nomatch z&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM((1 1 11 22, 2 3 12 23, 3 4 13 24),(3 4 13 24, 5 6 14 25, 7 8 15 26))&quot; ) &lt;&lt; QStringLiteral( &quot;PointZM( 7 8 16 26)&quot; ) &lt;&lt; -1;</span></a>
<a name="672"><span class="lineNum">     672 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm nomatch m&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM((1 1 11 22, 2 3 12 23, 3 4 13 24),(3 4 13 24, 5 6 14 25, 7 8 15 26))&quot; ) &lt;&lt; QStringLiteral( &quot;PointZM( 7 8 15 27)&quot; ) &lt;&lt; -1;</span></a>
<a name="673"><span class="lineNum">     673 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="674"><span class="lineNum">     674 </span>                :            : </a>
<a name="675"><span class="lineNum">     675 </span>                :<span class="lineCov">         43 : void TestQgsGeometry::curveIndexOf()</span></a>
<a name="676"><span class="lineNum">     676 </span>                :            : {</a>
<a name="677"><span class="lineNum">     677 </span>                :<span class="lineCov">         43 :   QFETCH( QString, curve );</span></a>
<a name="678"><span class="lineNum">     678 </span>                :<span class="lineCov">         43 :   QFETCH( QString, point );</span></a>
<a name="679"><span class="lineNum">     679 </span>                :<span class="lineCov">         43 :   QFETCH( int, expected );</span></a>
<a name="680"><span class="lineNum">     680 </span>                :            : </a>
<a name="681"><span class="lineNum">     681 </span>                :<span class="lineCov">         43 :   QgsGeometry g = QgsGeometry::fromWkt( curve );</span></a>
<a name="682"><span class="lineNum">     682 </span>                :<span class="lineCov">         43 :   QgsPoint p;</span></a>
<a name="683"><span class="lineNum">     683 </span>                :<span class="lineCov">         43 :   p.fromWkt( point );</span></a>
<a name="684"><span class="lineNum">     684 </span>                :<span class="lineCov">         43 :   QCOMPARE( qgsgeometry_cast&lt; const QgsCurve * &gt;( g.constGet() )-&gt;indexOf( p ), expected );</span></a>
<a name="685"><span class="lineNum">     685 </span>                :<span class="lineCov">         43 : }</span></a>
<a name="686"><span class="lineNum">     686 </span>                :            : </a>
<a name="687"><span class="lineNum">     687 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::splitCurve_data()</span></a>
<a name="688"><span class="lineNum">     688 </span>                :            : {</a>
<a name="689"><span class="lineNum">     689 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;wkt&quot; );</span></a>
<a name="690"><span class="lineNum">     690 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;int&gt;( &quot;vertex&quot; );</span></a>
<a name="691"><span class="lineNum">     691 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;curve1&quot; );</span></a>
<a name="692"><span class="lineNum">     692 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;curve2&quot; );</span></a>
<a name="693"><span class="lineNum">     693 </span>                :            : </a>
<a name="694"><span class="lineNum">     694 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="695"><span class="lineNum">     695 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring empty 1&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="696"><span class="lineNum">     696 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring one vertex 0&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="697"><span class="lineNum">     697 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring one vertex 1 &quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="698"><span class="lineNum">     698 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring one vertex 2&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="699"><span class="lineNum">     699 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring two 0&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3)&quot; );</span></a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring two 1&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="701"><span class="lineNum">     701 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring two 2&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="702"><span class="lineNum">     702 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring three 0&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4)&quot; );</span></a>
<a name="703"><span class="lineNum">     703 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring three 1&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (2 3, 3 4)&quot; );</span></a>
<a name="704"><span class="lineNum">     704 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring three 2&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="705"><span class="lineNum">     705 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring three 3&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="706"><span class="lineNum">     706 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring four 0&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4, 5 6)&quot; );</span></a>
<a name="707"><span class="lineNum">     707 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring four 1&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (2 3, 3 4, 5 6)&quot; );</span></a>
<a name="708"><span class="lineNum">     708 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring four 2&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString (3 4, 5 6)&quot; );</span></a>
<a name="709"><span class="lineNum">     709 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestring four 3&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="710"><span class="lineNum">     710 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestringz&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 2 11, 2 3 12, 3 4 13, 5 6 14)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineStringZ (1 2 11, 2 3 12)&quot; ) &lt;&lt; QStringLiteral( &quot;LineStringZ (2 3 12, 3 4 13, 5 6 14)&quot; );</span></a>
<a name="711"><span class="lineNum">     711 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestringm&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 2 11, 2 3 12, 3 4 13, 5 6 14)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineStringM (1 2 11, 2 3 12)&quot; ) &lt;&lt; QStringLiteral( &quot;LineStringM (2 3 12, 3 4 13, 5 6 14)&quot; );</span></a>
<a name="712"><span class="lineNum">     712 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;linestringzm&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 2 11 21, 2 3 12 22, 3 4 13 23, 5 6 14 24)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineStringZM (1 2 11 21, 2 3 12 22)&quot; ) &lt;&lt; QStringLiteral( &quot;LineStringZM (2 3 12 22, 3 4 13 23, 5 6 14 24)&quot; );</span></a>
<a name="713"><span class="lineNum">     713 </span>                :            : </a>
<a name="714"><span class="lineNum">     714 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString empty&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString()&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="715"><span class="lineNum">     715 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString empty 1&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString()&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="716"><span class="lineNum">     716 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString one vertex 0&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="717"><span class="lineNum">     717 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString one vertex 1 &quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="718"><span class="lineNum">     718 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString one vertex 2&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularString (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="719"><span class="lineNum">     719 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString three 0&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4)&quot; );</span></a>
<a name="720"><span class="lineNum">     720 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString three 1&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (2 3, 3 4)&quot; );</span></a>
<a name="721"><span class="lineNum">     721 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString three 2&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="722"><span class="lineNum">     722 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString three 3&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4)&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="723"><span class="lineNum">     723 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString five 0&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4, 5 6, 7 8)&quot; );</span></a>
<a name="724"><span class="lineNum">     724 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString five 1&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (2 3, 3 4, 5 6, 7 8)&quot; );</span></a>
<a name="725"><span class="lineNum">     725 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString five 2&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (3 4, 5 6, 7 8)&quot; );</span></a>
<a name="726"><span class="lineNum">     726 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString five 3&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4, 5 6)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString (5 6, 7 8)&quot; );</span></a>
<a name="727"><span class="lineNum">     727 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularString five 4&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString( 1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;CircularString (1 2, 2 3, 3 4, 5 6, 7 8)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="728"><span class="lineNum">     728 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularStringz&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringZ( 1 2 11, 2 3 12, 3 4 13, 5 6 14, 7 8 15)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularStringZ (1 2 11, 2 3 12)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringZ (2 3 12, 3 4 13, 5 6 14, 7 8 15)&quot; );</span></a>
<a name="729"><span class="lineNum">     729 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularStringm&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringM( 1 2 11, 2 3 12, 3 4 13, 5 6 14, 7 8 15)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularStringM (1 2 11, 2 3 12)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringM (2 3 12, 3 4 13, 5 6 14, 7 8 15)&quot; );</span></a>
<a name="730"><span class="lineNum">     730 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CircularStringzm&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringZM( 1 2 11 21, 2 3 12 22, 3 4 13 23, 5 6 14 24, 7 8 15 25)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CircularStringZM (1 2 11 21, 2 3 12 22)&quot; ) &lt;&lt; QStringLiteral( &quot;CircularStringZM (2 3 12 22, 3 4 13 23, 5 6 14 24, 7 8 15 25)&quot; );</span></a>
<a name="731"><span class="lineNum">     731 </span>                :            : </a>
<a name="732"><span class="lineNum">     732 </span>                :<span class="lineCov">          4 :   QTest::newRow( &quot;CompoundCurve empty&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve()&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="733"><span class="lineNum">     733 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 0&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6),CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 0</span></a>
<a name="734"><span class="lineNum">     734 </span>                :<span class="lineCov">          3 :                                      &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; );</span></a>
<a name="735"><span class="lineNum">     735 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 1&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6),CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 1</span></a>
<a name="736"><span class="lineNum">     736 </span>                :<span class="lineCov">          3 :                                      &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve ((3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; );</span></a>
<a name="737"><span class="lineNum">     737 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 2&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6),CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 2</span></a>
<a name="738"><span class="lineNum">     738 </span>                :<span class="lineCov">          3 :                                      &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve (CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; );</span></a>
<a name="739"><span class="lineNum">     739 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 4&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6),CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 4</span></a>
<a name="740"><span class="lineNum">     740 </span>                :<span class="lineCov">          3 :                                      &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve (CircularString (9 10, 11 12, 13 14))&quot; );</span></a>
<a name="741"><span class="lineNum">     741 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 6&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 6</span></a>
<a name="742"><span class="lineNum">     742 </span>                :<span class="lineCov">          3 :                                      &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="743"><span class="lineNum">     743 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve 10&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; 10</span></a>
<a name="744"><span class="lineNum">     744 </span>                :<span class="lineCov">          3 :                                       &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="745"><span class="lineNum">     745 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve three parts 6&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14), (13 14, 15 16, 17 18))&quot; ) &lt;&lt; 6</span></a>
<a name="746"><span class="lineNum">     746 </span>                :<span class="lineCov">          3 :       &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve ((13 14, 15 16, 17 18))&quot; );</span></a>
<a name="747"><span class="lineNum">     747 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve three parts 7&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14), (13 14, 15 16, 17 18))&quot; ) &lt;&lt; 7</span></a>
<a name="748"><span class="lineNum">     748 </span>                :<span class="lineCov">          3 :       &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14),(13 14, 15 16))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve ((15 16, 17 18))&quot; );</span></a>
<a name="749"><span class="lineNum">     749 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve three parts 7&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14), (13 14, 15 16, 17 18))&quot; ) &lt;&lt; 8</span></a>
<a name="750"><span class="lineNum">     750 </span>                :<span class="lineCov">          3 :       &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14),(13 14, 15 16, 17 18))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="751"><span class="lineNum">     751 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;CompoundCurve three parts 1&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve((1 2, 3 4, 5 6), CircularString(5 6, 7 8, 9 10, 11 12, 13 14), (13 14, 15 16, 17 18))&quot; ) &lt;&lt; 1</span></a>
<a name="752"><span class="lineNum">     752 </span>                :<span class="lineCov">          3 :       &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 3 4))&quot; ) &lt;&lt; QStringLiteral( &quot;CompoundCurve ((3 4, 5 6),CircularString (5 6, 7 8, 9 10, 11 12, 13 14),(13 14, 15 16, 17 18))&quot; );</span></a>
<a name="753"><span class="lineNum">     753 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="754"><span class="lineNum">     754 </span>                :            : </a>
<a name="755"><span class="lineNum">     755 </span>                :<span class="lineCov">         47 : void TestQgsGeometry::splitCurve()</span></a>
<a name="756"><span class="lineNum">     756 </span>                :            : {</a>
<a name="757"><span class="lineNum">     757 </span>                :<span class="lineCov">         47 :   QFETCH( QString, wkt );</span></a>
<a name="758"><span class="lineNum">     758 </span>                :<span class="lineCov">         47 :   QFETCH( int, vertex );</span></a>
<a name="759"><span class="lineNum">     759 </span>                :<span class="lineCov">         47 :   QFETCH( QString, curve1 );</span></a>
<a name="760"><span class="lineNum">     760 </span>                :<span class="lineCov">         47 :   QFETCH( QString, curve2 );</span></a>
<a name="761"><span class="lineNum">     761 </span>                :            : </a>
<a name="762"><span class="lineNum">     762 </span>                :<span class="lineCov">         47 :   QgsGeometry curve( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="763"><span class="lineNum">     763 </span>                :<span class="lineCov">         94 :   auto [p1, p2] = qgsgeometry_cast&lt; const QgsCurve * &gt;( curve.constGet() )-&gt;splitCurveAtVertex( vertex );</span></a>
<a name="764"><span class="lineNum">     764 </span>                :<span class="lineCov">         47 :   QCOMPARE( p1-&gt;asWkt(), curve1 );</span></a>
<a name="765"><span class="lineNum">     765 </span>                :<span class="lineCov">         47 :   QCOMPARE( p2-&gt;asWkt(), curve2 );</span></a>
<a name="766"><span class="lineNum">     766 </span>                :<span class="lineCov">         47 : }</span></a>
<a name="767"><span class="lineNum">     767 </span>                :            : </a>
<a name="768"><span class="lineNum">     768 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQgsPointXY()</span></a>
<a name="769"><span class="lineNum">     769 </span>                :            : {</a>
<a name="770"><span class="lineNum">     770 </span>                :<span class="lineCov">          1 :   QgsPointXY point( 1.0, 2.0 );</span></a>
<a name="771"><span class="lineNum">     771 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromPointXY( point ) );</span></a>
<a name="772"><span class="lineNum">     772 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="773"><span class="lineNum">     773 </span>                :<span class="lineCov">          1 :   QgsPointXY resultPoint = result.asPoint();</span></a>
<a name="774"><span class="lineNum">     774 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint, point );</span></a>
<a name="775"><span class="lineNum">     775 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="776"><span class="lineNum">     776 </span>                :            : </a>
<a name="777"><span class="lineNum">     777 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQPoint()</span></a>
<a name="778"><span class="lineNum">     778 </span>                :            : {</a>
<a name="779"><span class="lineNum">     779 </span>                :<span class="lineCov">          1 :   QPointF point( 1.0, 2.0 );</span></a>
<a name="780"><span class="lineNum">     780 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromQPointF( point ) );</span></a>
<a name="781"><span class="lineNum">     781 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Point );</span></a>
<a name="782"><span class="lineNum">     782 </span>                :<span class="lineCov">          1 :   QgsPointXY resultPoint = result.asPoint();</span></a>
<a name="783"><span class="lineNum">     783 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint.x(), 1.0 );</span></a>
<a name="784"><span class="lineNum">     784 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint.y(), 2.0 );</span></a>
<a name="785"><span class="lineNum">     785 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="786"><span class="lineNum">     786 </span>                :            : </a>
<a name="787"><span class="lineNum">     787 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromQPolygonF()</span></a>
<a name="788"><span class="lineNum">     788 </span>                :            : {</a>
<a name="789"><span class="lineNum">     789 </span>                :            :   //test with a polyline</a>
<a name="790"><span class="lineNum">     790 </span>                :<span class="lineCov">          1 :   QPolygonF polyline;</span></a>
<a name="791"><span class="lineNum">     791 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QPointF( 1.0, 2.0 ) &lt;&lt; QPointF( 4.0, 6.0 ) &lt;&lt; QPointF( 4.0, 3.0 ) &lt;&lt; QPointF( 2.0, 2.0 );</span></a>
<a name="792"><span class="lineNum">     792 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::fromQPolygonF( polyline ) );</span></a>
<a name="793"><span class="lineNum">     793 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="794"><span class="lineNum">     794 </span>                :<span class="lineCov">          1 :   QgsPolylineXY resultLine = result.asPolyline();</span></a>
<a name="795"><span class="lineNum">     795 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.size(), 4 );</span></a>
<a name="796"><span class="lineNum">     796 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 0 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="797"><span class="lineNum">     797 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 1 ), QgsPointXY( 4.0, 6.0 ) );</span></a>
<a name="798"><span class="lineNum">     798 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 2 ), QgsPointXY( 4.0, 3.0 ) );</span></a>
<a name="799"><span class="lineNum">     799 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultLine.at( 3 ), QgsPointXY( 2.0, 2.0 ) );</span></a>
<a name="800"><span class="lineNum">     800 </span>                :            : </a>
<a name="801"><span class="lineNum">     801 </span>                :            :   //test with a closed polygon</a>
<a name="802"><span class="lineNum">     802 </span>                :<span class="lineCov">          1 :   QPolygonF polygon;</span></a>
<a name="803"><span class="lineNum">     803 </span>                :<span class="lineCov">          1 :   polygon &lt;&lt; QPointF( 1.0, 2.0 ) &lt;&lt; QPointF( 4.0, 6.0 ) &lt;&lt; QPointF( 4.0, 3.0 ) &lt;&lt; QPointF( 2.0, 2.0 ) &lt;&lt; QPointF( 1.0, 2.0 );</span></a>
<a name="804"><span class="lineNum">     804 </span>                :<span class="lineCov">          1 :   QgsGeometry result2( QgsGeometry::fromQPolygonF( polygon ) );</span></a>
<a name="805"><span class="lineNum">     805 </span>                :<span class="lineCov">          1 :   QCOMPARE( result2.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="806"><span class="lineNum">     806 </span>                :<span class="lineCov">          1 :   QgsPolygonXY resultPolygon = result2.asPolygon();</span></a>
<a name="807"><span class="lineNum">     807 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.size(), 1 );</span></a>
<a name="808"><span class="lineNum">     808 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 0 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="809"><span class="lineNum">     809 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 1 ), QgsPointXY( 4.0, 6.0 ) );</span></a>
<a name="810"><span class="lineNum">     810 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 2 ), QgsPointXY( 4.0, 3.0 ) );</span></a>
<a name="811"><span class="lineNum">     811 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 3 ), QgsPointXY( 2.0, 2.0 ) );</span></a>
<a name="812"><span class="lineNum">     812 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPolygon.at( 0 ).at( 4 ), QgsPointXY( 1.0, 2.0 ) );</span></a>
<a name="813"><span class="lineNum">     813 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="814"><span class="lineNum">     814 </span>                :            : </a>
<a name="815"><span class="lineNum">     815 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::fromPolyline()</span></a>
<a name="816"><span class="lineNum">     816 </span>                :            : {</a>
<a name="817"><span class="lineNum">     817 </span>                :<span class="lineCov">          1 :   QgsPolyline polyline;</span></a>
<a name="818"><span class="lineNum">     818 </span>                :<span class="lineCov">          1 :   QgsGeometry fromPolyline = QgsGeometry::fromPolyline( polyline );</span></a>
<a name="819"><span class="lineNum">     819 </span>                :<span class="lineCov">          1 :   QVERIFY( fromPolyline.isEmpty() );</span></a>
<a name="820"><span class="lineNum">     820 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPolyline.wkbType(), QgsWkbTypes::LineString );</span></a>
<a name="821"><span class="lineNum">     821 </span>                :<span class="lineCov">          1 :   polyline &lt;&lt; QgsPoint( 10, 20 ) &lt;&lt; QgsPoint( 30, 40 );</span></a>
<a name="822"><span class="lineNum">     822 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polyline );</span></a>
<a name="823"><span class="lineNum">     823 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineString (10 20, 30 40)&quot; ) );</span></a>
<a name="824"><span class="lineNum">     824 </span>                :<span class="lineCov">          1 :   QgsPolyline polyline3d;</span></a>
<a name="825"><span class="lineNum">     825 </span>                :<span class="lineCov">          1 :   polyline3d &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 20, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 40, 200 );</span></a>
<a name="826"><span class="lineNum">     826 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polyline3d );</span></a>
<a name="827"><span class="lineNum">     827 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringZ (10 20 100, 30 40 200)&quot; ) );</span></a>
<a name="828"><span class="lineNum">     828 </span>                :<span class="lineCov">          1 :   QgsPolyline polylineM;</span></a>
<a name="829"><span class="lineNum">     829 </span>                :<span class="lineCov">          1 :   polylineM &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 10, 20, 0, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointM, 30, 40, 0, 200 );</span></a>
<a name="830"><span class="lineNum">     830 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polylineM );</span></a>
<a name="831"><span class="lineNum">     831 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringM (10 20 100, 30 40 200)&quot; ) );</span></a>
<a name="832"><span class="lineNum">     832 </span>                :<span class="lineCov">          1 :   QgsPolyline polylineZM;</span></a>
<a name="833"><span class="lineNum">     833 </span>                :<span class="lineCov">          1 :   polylineZM &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 10, 20, 4, 100 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZM, 30, 40, 5, 200 );</span></a>
<a name="834"><span class="lineNum">     834 </span>                :<span class="lineCov">          1 :   fromPolyline = QgsGeometry::fromPolyline( polylineZM );</span></a>
<a name="835"><span class="lineNum">     835 </span>                :<span class="lineCov">          2 :   QCOMPARE( fromPolyline.asWkt(), QStringLiteral( &quot;LineStringZM (10 20 4 100, 30 40 5 200)&quot; ) );</span></a>
<a name="836"><span class="lineNum">     836 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="837"><span class="lineNum">     837 </span>                :            : </a>
<a name="838"><span class="lineNum">     838 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asQPointF()</span></a>
<a name="839"><span class="lineNum">     839 </span>                :            : {</a>
<a name="840"><span class="lineNum">     840 </span>                :<span class="lineCov">          1 :   QPointF point( 1.0, 2.0 );</span></a>
<a name="841"><span class="lineNum">     841 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromQPointF( point ) );</span></a>
<a name="842"><span class="lineNum">     842 </span>                :<span class="lineCov">          1 :   QPointF resultPoint = geom.asQPointF();</span></a>
<a name="843"><span class="lineNum">     843 </span>                :<span class="lineCov">          1 :   QCOMPARE( resultPoint, point );</span></a>
<a name="844"><span class="lineNum">     844 </span>                :            : </a>
<a name="845"><span class="lineNum">     845 </span>                :            :   //non point geom</a>
<a name="846"><span class="lineNum">     846 </span>                :<span class="lineCov">          1 :   QPointF badPoint = mpPolygonGeometryA.asQPointF();</span></a>
<a name="847"><span class="lineNum">     847 </span>                :<span class="lineCov">          1 :   QVERIFY( badPoint.isNull() );</span></a>
<a name="848"><span class="lineNum">     848 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="849"><span class="lineNum">     849 </span>                :            : </a>
<a name="850"><span class="lineNum">     850 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::asQPolygonF()</span></a>
<a name="851"><span class="lineNum">     851 </span>                :            : {</a>
<a name="852"><span class="lineNum">     852 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="853"><span class="lineNum">     853 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="854"><span class="lineNum">     854 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="855"><span class="lineNum">     855 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="856"><span class="lineNum">     856 </span>                :            : </a>
<a name="857"><span class="lineNum">     857 </span>                :<span class="lineCov">          1 :   QgsGeometry polygonGeometryA = QgsGeometry::fromPolygonXY( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point4 &lt;&lt; point1 ) );</span></a>
<a name="858"><span class="lineNum">     858 </span>                :            : </a>
<a name="859"><span class="lineNum">     859 </span>                :            :   //test polygon</a>
<a name="860"><span class="lineNum">     860 </span>                :<span class="lineCov">          1 :   QPolygonF fromPoly = polygonGeometryA.asQPolygonF();</span></a>
<a name="861"><span class="lineNum">     861 </span>                :<span class="lineCov">          1 :   QVERIFY( fromPoly.isClosed() );</span></a>
<a name="862"><span class="lineNum">     862 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.size(), 5 );</span></a>
<a name="863"><span class="lineNum">     863 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 0 ).x(), point1.x() );</span></a>
<a name="864"><span class="lineNum">     864 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 0 ).y(), point1.y() );</span></a>
<a name="865"><span class="lineNum">     865 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 1 ).x(), point2.x() );</span></a>
<a name="866"><span class="lineNum">     866 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 1 ).y(), point2.y() );</span></a>
<a name="867"><span class="lineNum">     867 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 2 ).x(), point3.x() );</span></a>
<a name="868"><span class="lineNum">     868 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 2 ).y(), point3.y() );</span></a>
<a name="869"><span class="lineNum">     869 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 3 ).x(), point4.x() );</span></a>
<a name="870"><span class="lineNum">     870 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 3 ).y(), point4.y() );</span></a>
<a name="871"><span class="lineNum">     871 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 4 ).x(), point1.x() );</span></a>
<a name="872"><span class="lineNum">     872 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromPoly.at( 4 ).y(), point1.y() );</span></a>
<a name="873"><span class="lineNum">     873 </span>                :            : </a>
<a name="874"><span class="lineNum">     874 </span>                :            :   //test polyline</a>
<a name="875"><span class="lineNum">     875 </span>                :<span class="lineCov">          1 :   QgsPolylineXY testline;</span></a>
<a name="876"><span class="lineNum">     876 </span>                :<span class="lineCov">          1 :   testline &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="877"><span class="lineNum">     877 </span>                :<span class="lineCov">          1 :   QgsGeometry lineGeom( QgsGeometry::fromPolylineXY( testline ) );</span></a>
<a name="878"><span class="lineNum">     878 </span>                :<span class="lineCov">          1 :   QPolygonF fromLine = lineGeom.asQPolygonF();</span></a>
<a name="879"><span class="lineNum">     879 </span>                :<span class="lineCov">          1 :   QVERIFY( !fromLine.isClosed() );</span></a>
<a name="880"><span class="lineNum">     880 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.size(), 3 );</span></a>
<a name="881"><span class="lineNum">     881 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 0 ).x(), point1.x() );</span></a>
<a name="882"><span class="lineNum">     882 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 0 ).y(), point1.y() );</span></a>
<a name="883"><span class="lineNum">     883 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 1 ).x(), point2.x() );</span></a>
<a name="884"><span class="lineNum">     884 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 1 ).y(), point2.y() );</span></a>
<a name="885"><span class="lineNum">     885 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 2 ).x(), point3.x() );</span></a>
<a name="886"><span class="lineNum">     886 </span>                :<span class="lineCov">          1 :   QCOMPARE( fromLine.at( 2 ).y(), point3.y() );</span></a>
<a name="887"><span class="lineNum">     887 </span>                :            : </a>
<a name="888"><span class="lineNum">     888 </span>                :            :   //test a bad geometry</a>
<a name="889"><span class="lineNum">     889 </span>                :<span class="lineCov">          1 :   QgsGeometry badGeom( QgsGeometry::fromPointXY( point1 ) );</span></a>
<a name="890"><span class="lineNum">     890 </span>                :<span class="lineCov">          1 :   QPolygonF fromBad = badGeom.asQPolygonF();</span></a>
<a name="891"><span class="lineNum">     891 </span>                :<span class="lineCov">          1 :   QVERIFY( fromBad.isEmpty() );</span></a>
<a name="892"><span class="lineNum">     892 </span>                :            : </a>
<a name="893"><span class="lineNum">     893 </span>                :            :   // test a multipolygon</a>
<a name="894"><span class="lineNum">     894 </span>                :<span class="lineCov">          2 :   QPolygonF res = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; ) ).asQPolygonF();</span></a>
<a name="895"><span class="lineNum">     895 </span>                :<span class="lineCov">          1 :   QVERIFY( res.isClosed() );</span></a>
<a name="896"><span class="lineNum">     896 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.size(), 5 );</span></a>
<a name="897"><span class="lineNum">     897 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).x(), 0.0 );</span></a>
<a name="898"><span class="lineNum">     898 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).y(), 0.0 );</span></a>
<a name="899"><span class="lineNum">     899 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).x(), 10.0 );</span></a>
<a name="900"><span class="lineNum">     900 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).y(), 0.0 );</span></a>
<a name="901"><span class="lineNum">     901 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).x(), 10.0 );</span></a>
<a name="902"><span class="lineNum">     902 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).y(), 10.0 );</span></a>
<a name="903"><span class="lineNum">     903 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).x(), 0.0 );</span></a>
<a name="904"><span class="lineNum">     904 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).y(), 10.0 );</span></a>
<a name="905"><span class="lineNum">     905 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 4 ).x(), 0.0 );</span></a>
<a name="906"><span class="lineNum">     906 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 4 ).y(), 0.0 );</span></a>
<a name="907"><span class="lineNum">     907 </span>                :            : </a>
<a name="908"><span class="lineNum">     908 </span>                :            :   // test a multilinestring</a>
<a name="909"><span class="lineNum">     909 </span>                :<span class="lineCov">          2 :   res = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiLineString((0 0, 10 0, 10 10, 0 10 ),(2 2, 4 2, 4 4, 2 4))&quot; ) ).asQPolygonF();</span></a>
<a name="910"><span class="lineNum">     910 </span>                :<span class="lineCov">          1 :   QVERIFY( !res.isClosed() );</span></a>
<a name="911"><span class="lineNum">     911 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.size(), 4 );</span></a>
<a name="912"><span class="lineNum">     912 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).x(), 0.0 );</span></a>
<a name="913"><span class="lineNum">     913 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 0 ).y(), 0.0 );</span></a>
<a name="914"><span class="lineNum">     914 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).x(), 10.0 );</span></a>
<a name="915"><span class="lineNum">     915 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 1 ).y(), 0.0 );</span></a>
<a name="916"><span class="lineNum">     916 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).x(), 10.0 );</span></a>
<a name="917"><span class="lineNum">     917 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 2 ).y(), 10.0 );</span></a>
<a name="918"><span class="lineNum">     918 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).x(), 0.0 );</span></a>
<a name="919"><span class="lineNum">     919 </span>                :<span class="lineCov">          1 :   QCOMPARE( res.at( 3 ).y(), 10.0 );</span></a>
<a name="920"><span class="lineNum">     920 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="921"><span class="lineNum">     921 </span>                :            : </a>
<a name="922"><span class="lineNum">     922 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::comparePolylines()</span></a>
<a name="923"><span class="lineNum">     923 </span>                :            : {</a>
<a name="924"><span class="lineNum">     924 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="925"><span class="lineNum">     925 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="926"><span class="lineNum">     926 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="927"><span class="lineNum">     927 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="928"><span class="lineNum">     928 </span>                :<span class="lineCov">          1 :   QgsPointXY pointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="929"><span class="lineNum">     929 </span>                :            : </a>
<a name="930"><span class="lineNum">     930 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line1;</span></a>
<a name="931"><span class="lineNum">     931 </span>                :<span class="lineCov">          1 :   line1 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="932"><span class="lineNum">     932 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line2;</span></a>
<a name="933"><span class="lineNum">     933 </span>                :<span class="lineCov">          1 :   line2 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3;</span></a>
<a name="934"><span class="lineNum">     934 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line1, line2 ) );</span></a>
<a name="935"><span class="lineNum">     935 </span>                :            : </a>
<a name="936"><span class="lineNum">     936 </span>                :            :   //different number of nodes</a>
<a name="937"><span class="lineNum">     937 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line3;</span></a>
<a name="938"><span class="lineNum">     938 </span>                :<span class="lineCov">          1 :   line3 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point4;</span></a>
<a name="939"><span class="lineNum">     939 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( line1, line3 ) );</span></a>
<a name="940"><span class="lineNum">     940 </span>                :            : </a>
<a name="941"><span class="lineNum">     941 </span>                :            :   //different nodes</a>
<a name="942"><span class="lineNum">     942 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line4;</span></a>
<a name="943"><span class="lineNum">     943 </span>                :<span class="lineCov">          1 :   line3 &lt;&lt; point1 &lt;&lt; pointA &lt;&lt; point3 &lt;&lt; point4;</span></a>
<a name="944"><span class="lineNum">     944 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( line3, line4 ) );</span></a>
<a name="945"><span class="lineNum">     945 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="946"><span class="lineNum">     946 </span>                :            : </a>
<a name="947"><span class="lineNum">     947 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::comparePolygons()</span></a>
<a name="948"><span class="lineNum">     948 </span>                :            : {</a>
<a name="949"><span class="lineNum">     949 </span>                :<span class="lineCov">          1 :   QgsPointXY point1 = QgsPointXY( 20.0, 20.0 );</span></a>
<a name="950"><span class="lineNum">     950 </span>                :<span class="lineCov">          1 :   QgsPointXY point2 = QgsPointXY( 80.0, 20.0 );</span></a>
<a name="951"><span class="lineNum">     951 </span>                :<span class="lineCov">          1 :   QgsPointXY point3 = QgsPointXY( 80.0, 80.0 );</span></a>
<a name="952"><span class="lineNum">     952 </span>                :<span class="lineCov">          1 :   QgsPointXY point4 = QgsPointXY( 20.0, 80.0 );</span></a>
<a name="953"><span class="lineNum">     953 </span>                :<span class="lineCov">          1 :   QgsPointXY pointA = QgsPointXY( 40.0, 40.0 );</span></a>
<a name="954"><span class="lineNum">     954 </span>                :<span class="lineCov">          1 :   QgsPointXY pointB = QgsPointXY( 100.0, 40.0 );</span></a>
<a name="955"><span class="lineNum">     955 </span>                :            : </a>
<a name="956"><span class="lineNum">     956 </span>                :<span class="lineCov">          1 :   QgsPolylineXY ring1;</span></a>
<a name="957"><span class="lineNum">     957 </span>                :<span class="lineCov">          1 :   ring1 &lt;&lt; point1 &lt;&lt; point2 &lt;&lt; point3 &lt;&lt; point1;</span></a>
<a name="958"><span class="lineNum">     958 </span>                :<span class="lineCov">          1 :   QgsPolylineXY ring2;</span></a>
<a name="959"><span class="lineNum">     959 </span>                :<span class="lineCov">          1 :   ring2 &lt;&lt; point4 &lt;&lt; pointA &lt;&lt; pointB &lt;&lt; point4;</span></a>
<a name="960"><span class="lineNum">     960 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly1;</span></a>
<a name="961"><span class="lineNum">     961 </span>                :<span class="lineCov">          1 :   poly1 &lt;&lt; ring1 &lt;&lt; ring2;</span></a>
<a name="962"><span class="lineNum">     962 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly2;</span></a>
<a name="963"><span class="lineNum">     963 </span>                :<span class="lineCov">          1 :   poly2 &lt;&lt; ring1 &lt;&lt; ring2;</span></a>
<a name="964"><span class="lineNum">     964 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly1, poly2 ) );</span></a>
<a name="965"><span class="lineNum">     965 </span>                :            : </a>
<a name="966"><span class="lineNum">     966 </span>                :            :   //different number of rings</a>
<a name="967"><span class="lineNum">     967 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly3;</span></a>
<a name="968"><span class="lineNum">     968 </span>                :<span class="lineCov">          1 :   poly3 &lt;&lt; ring1;</span></a>
<a name="969"><span class="lineNum">     969 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( poly1, poly3 ) );</span></a>
<a name="970"><span class="lineNum">     970 </span>                :            : </a>
<a name="971"><span class="lineNum">     971 </span>                :            :   //different rings</a>
<a name="972"><span class="lineNum">     972 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly4;</span></a>
<a name="973"><span class="lineNum">     973 </span>                :<span class="lineCov">          1 :   poly4 &lt;&lt; ring2;</span></a>
<a name="974"><span class="lineNum">     974 </span>                :<span class="lineCov">          1 :   QVERIFY( !QgsGeometry::compare( poly3, poly4 ) );</span></a>
<a name="975"><span class="lineNum">     975 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="976"><span class="lineNum">     976 </span>                :            : </a>
<a name="977"><span class="lineNum">     977 </span>                :            : #if defined(__clang__) || defined(__GNUG__)</a>
<a name="978"><span class="lineNum">     978 </span>                :            : #include &lt;cxxabi.h&gt;</a>
<a name="979"><span class="lineNum">     979 </span>                :            : #include &lt;ctime&gt;</a>
<a name="980"><span class="lineNum">     980 </span>                :            : </a>
<a name="981"><span class="lineNum">     981 </span>                :<span class="lineCov">       1392 : QString generateSpacesString( int numberOfSpace )</span></a>
<a name="982"><span class="lineNum">     982 </span>                :            : {</a>
<a name="983"><span class="lineNum">     983 </span>                :<span class="lineCov">       1392 :   QStringList spaces;</span></a>
<a name="984"><span class="lineNum">     984 </span>                :<span class="lineCov">       1392 :   spaces &lt;&lt; QString( &quot; &quot; ) &lt;&lt; QString( &quot;\t&quot; ) &lt;&lt; QString( &quot;\n&quot; ) &lt;&lt; QString( &quot;\r&quot; );</span></a>
<a name="985"><span class="lineNum">     985 </span>                :            : </a>
<a name="986"><span class="lineNum">     986 </span>                :<span class="lineCov">       1392 :   QString ret;</span></a>
<a name="987"><span class="lineNum">     987 </span>                :<span class="lineCov">       7872 :   for ( int i = 0; i &lt; numberOfSpace; ++i )</span></a>
<a name="988"><span class="lineNum">     988 </span>                :            :   {</a>
<a name="989"><span class="lineNum">     989 </span>                :<span class="lineCov">       6480 :     int r = rand() % ( spaces.count() );</span></a>
<a name="990"><span class="lineNum">     990 </span>                :<span class="lineCov">       6480 :     ret += spaces.at( r );</span></a>
<a name="991"><span class="lineNum">     991 </span>                :<span class="lineCov">       6480 :   }</span></a>
<a name="992"><span class="lineNum">     992 </span>                :<span class="lineCov">       1392 :   return ret;</span></a>
<a name="993"><span class="lineNum">     993 </span>                :<span class="lineCov">       1392 : }</span></a>
<a name="994"><span class="lineNum">     994 </span>                :            : </a>
<a name="995"><span class="lineNum">     995 </span>                :            : #endif</a>
<a name="996"><span class="lineNum">     996 </span>                :            : // Helper function (in anonymous namespace to prevent possible link with the extirior)</a>
<a name="997"><span class="lineNum">     997 </span>                :            : namespace</a>
<a name="998"><span class="lineNum">     998 </span>                :            : {</a>
<a name="999"><span class="lineNum">     999 </span>                :            :   template&lt;typename T&gt;</a>
<a name="1000"><span class="lineNum">    1000 </span>                :<span class="lineCov">         12 :   inline void testCreateEmptyWithSameType()</span></a>
<a name="1001"><span class="lineNum">    1001 </span>                :            :   {</a>
<a name="1002"><span class="lineNum">    1002 </span>                :<span class="lineCov">         12 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; geom { new T() };</span></a>
<a name="1003"><span class="lineNum">    1003 </span>                :<span class="lineCov">         12 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; created { TestQgsGeometry::createEmpty( geom.get() ) };</span></a>
<a name="1004"><span class="lineNum">    1004 </span>                :<span class="lineCov">         12 :     QVERIFY( created-&gt;isEmpty() );</span></a>
<a name="1005"><span class="lineNum">    1005 </span>                :            : #if defined(__clang__) || defined(__GNUG__)</a>
<a name="1006"><span class="lineNum">    1006 </span>                :<span class="lineCov">         12 :     srand( ( unsigned )time( NULL ) );</span></a>
<a name="1007"><span class="lineNum">    1007 </span>                :            : </a>
<a name="1008"><span class="lineNum">    1008 </span>                :<span class="lineCov">         12 :     const std::type_info  &amp;ti = typeid( T );</span></a>
<a name="1009"><span class="lineNum">    1009 </span>                :            :     int status;</a>
<a name="1010"><span class="lineNum">    1010 </span>                :<span class="lineCov">         12 :     char *realname = abi::__cxa_demangle( ti.name(), 0, 0, &amp;status );</span></a>
<a name="1011"><span class="lineNum">    1011 </span>                :            : </a>
<a name="1012"><span class="lineNum">    1012 </span>                :<span class="lineCov">         12 :     QString type = realname;</span></a>
<a name="1013"><span class="lineNum">    1013 </span>                :            : // remove Qgs prefix</a>
<a name="1014"><span class="lineNum">    1014 </span>                :<span class="lineCov">         12 :     type = type.right( type.count() - 3 );</span></a>
<a name="1015"><span class="lineNum">    1015 </span>                :<span class="lineCov">         12 :     QStringList extensionZM;</span></a>
<a name="1016"><span class="lineNum">    1016 </span>                :<span class="lineCov">         12 :     extensionZM &lt;&lt; QString() &lt;&lt; QString( &quot;Z&quot; ) &lt;&lt; QString( &quot;M&quot; ) &lt;&lt; QString( &quot;ZM&quot; );</span></a>
<a name="1017"><span class="lineNum">    1017 </span>                :<span class="lineCov">         60 :     for ( const QString &amp;ext : extensionZM )</span></a>
<a name="1018"><span class="lineNum">    1018 </span>                :            :     {</a>
<a name="1019"><span class="lineNum">    1019 </span>                :<span class="lineCov">         48 :       QString wkt = type + ext;</span></a>
<a name="1020"><span class="lineNum">    1020 </span>                :<span class="lineCov">         48 :       QString result = wkt + QLatin1String( &quot; EMPTY&quot; );</span></a>
<a name="1021"><span class="lineNum">    1021 </span>                :            : </a>
<a name="1022"><span class="lineNum">    1022 </span>                :<span class="lineCov">         48 :       QStringList emptyStringList;</span></a>
<a name="1023"><span class="lineNum">    1023 </span>                :<span class="lineCov">         48 :       emptyStringList &lt;&lt; QString( &quot;EMPTY&quot; ) &lt;&lt; QString( &quot;Empty&quot; ) &lt;&lt; QString( &quot;empty&quot; ) &lt;&lt; QString( &quot;EmptY&quot; ) &lt;&lt; QString( &quot;EmPtY&quot; );</span></a>
<a name="1024"><span class="lineNum">    1024 </span>                :<span class="lineCov">        528 :       for ( int i = 0 ; i &lt; 10 ; ++i )</span></a>
<a name="1025"><span class="lineNum">    1025 </span>                :            :       {</a>
<a name="1026"><span class="lineNum">    1026 </span>                :<span class="lineCov">        480 :         QString spacesBefore = generateSpacesString( i );</span></a>
<a name="1027"><span class="lineNum">    1027 </span>                :<span class="lineCov">        528 :         QString spacesMiddle = i == 0 ? QStringLiteral( &quot; &quot; ) : generateSpacesString( i );</span></a>
<a name="1028"><span class="lineNum">    1028 </span>                :<span class="lineCov">        480 :         QString spacesAfter = generateSpacesString( i );</span></a>
<a name="1029"><span class="lineNum">    1029 </span>                :<span class="lineCov">       2880 :         for ( int j = 0; j &lt; emptyStringList.count() ; ++j )</span></a>
<a name="1030"><span class="lineNum">    1030 </span>                :            :         {</a>
<a name="1031"><span class="lineNum">    1031 </span>                :<span class="lineCov">       2400 :           QString generatedWkt = spacesBefore + wkt + spacesMiddle + emptyStringList.at( j ) + spacesAfter;</span></a>
<a name="1032"><span class="lineNum">    1032 </span>                :            : </a>
<a name="1033"><span class="lineNum">    1033 </span>                :<span class="lineCov">       2400 :           QgsGeometry gWkt = QgsGeometry().fromWkt( generatedWkt );</span></a>
<a name="1034"><span class="lineNum">    1034 </span>                :<span class="lineCov">       2400 :           QVERIFY( gWkt.asWkt().compare( result, Qt::CaseInsensitive ) == 0 );</span></a>
<a name="1035"><span class="lineNum">    1035 </span>                :            : </a>
<a name="1036"><span class="lineNum">    1036 </span>                :<span class="lineCov">       2400 :           QVERIFY( geom-&gt;fromWkt( generatedWkt ) );</span></a>
<a name="1037"><span class="lineNum">    1037 </span>                :<span class="lineCov">       2400 :           QVERIFY( geom-&gt;asWkt().compare( result, Qt::CaseInsensitive ) == 0 );</span></a>
<a name="1038"><span class="lineNum">    1038 </span>                :<span class="lineCov">       2400 :         }</span></a>
<a name="1039"><span class="lineNum">    1039 </span>                :<span class="lineCov">        480 :       }</span></a>
<a name="1040"><span class="lineNum">    1040 </span>                :<span class="lineCov">         48 :     }</span></a>
<a name="1041"><span class="lineNum">    1041 </span>                :<span class="lineCov">         12 :     free( realname );</span></a>
<a name="1042"><span class="lineNum">    1042 </span>                :            : #endif</a>
<a name="1043"><span class="lineNum">    1043 </span>                :            : </a>
<a name="1044"><span class="lineNum">    1044 </span>                :            : </a>
<a name="1045"><span class="lineNum">    1045 </span>                :            :     // Check that it is the correct type</a>
<a name="1046"><span class="lineNum">    1046 </span>                :<span class="lineCov">         12 :     QVERIFY( static_cast&lt;T *&gt;( created.get() ) != nullptr );</span></a>
<a name="1047"><span class="lineNum">    1047 </span>                :<span class="lineCov">         12 :   }</span></a>
<a name="1048"><span class="lineNum">    1048 </span>                :            : }</a>
<a name="1049"><span class="lineNum">    1049 </span>                :            : </a>
<a name="1050"><span class="lineNum">    1050 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::createEmptyWithSameType()</span></a>
<a name="1051"><span class="lineNum">    1051 </span>                :            : {</a>
<a name="1052"><span class="lineNum">    1052 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCircularString&gt;();</span></a>
<a name="1053"><span class="lineNum">    1053 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCompoundCurve&gt;();</span></a>
<a name="1054"><span class="lineNum">    1054 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsLineString&gt;();</span></a>
<a name="1055"><span class="lineNum">    1055 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsGeometryCollection&gt;();</span></a>
<a name="1056"><span class="lineNum">    1056 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiCurve&gt;();</span></a>
<a name="1057"><span class="lineNum">    1057 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiLineString&gt;();</span></a>
<a name="1058"><span class="lineNum">    1058 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiPoint&gt;();</span></a>
<a name="1059"><span class="lineNum">    1059 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsMultiSurface&gt;();</span></a>
<a name="1060"><span class="lineNum">    1060 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsPoint&gt;();</span></a>
<a name="1061"><span class="lineNum">    1061 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsCurvePolygon&gt;();</span></a>
<a name="1062"><span class="lineNum">    1062 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsPolygon&gt;();</span></a>
<a name="1063"><span class="lineNum">    1063 </span>                :<span class="lineCov">          1 :   testCreateEmptyWithSameType&lt;QgsTriangle&gt;();</span></a>
<a name="1064"><span class="lineNum">    1064 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1065"><span class="lineNum">    1065 </span>                :            : </a>
<a name="1066"><span class="lineNum">    1066 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::compareTo_data()</span></a>
<a name="1067"><span class="lineNum">    1067 </span>                :            : {</a>
<a name="1068"><span class="lineNum">    1068 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;geom1&quot; );</span></a>
<a name="1069"><span class="lineNum">    1069 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;geom2&quot; );</span></a>
<a name="1070"><span class="lineNum">    1070 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;int&gt;( &quot;expected&quot; );</span></a>
<a name="1071"><span class="lineNum">    1071 </span>                :            : </a>
<a name="1072"><span class="lineNum">    1072 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs multipoint&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 1 2 )&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 2))&quot; ) &lt;&lt; -1;</span></a>
<a name="1073"><span class="lineNum">    1073 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;multipoint vs point&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 2))&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 1 2 )&quot; ) &lt;&lt; 1;</span></a>
<a name="1074"><span class="lineNum">    1074 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;empty point vs empty point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; ) &lt;&lt; 0;</span></a>
<a name="1075"><span class="lineNum">    1075 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;empty point vs non-empty point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; ) &lt;&lt; QStringLiteral( &quot;POINT (1 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1076"><span class="lineNum">    1076 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;non-empty point vs empty point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT (1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; ) &lt;&lt; 1;</span></a>
<a name="1077"><span class="lineNum">    1077 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 1 2 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 2)&quot; ) &lt;&lt; 0;</span></a>
<a name="1078"><span class="lineNum">    1078 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point greater x&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 2 2 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1079"><span class="lineNum">    1079 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point lesser x&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 0 2 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1080"><span class="lineNum">    1080 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point greater y&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1081"><span class="lineNum">    1081 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point lesser y&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 1 1 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1082"><span class="lineNum">    1082 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point first with z&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(2 1)&quot; ) &lt;&lt; 1;</span></a>
<a name="1083"><span class="lineNum">    1083 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point second with z&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 2 1 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1084"><span class="lineNum">    1084 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point equal z&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 3)&quot; ) &lt;&lt; 0;</span></a>
<a name="1085"><span class="lineNum">    1085 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point greater z&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ( 2 1 4 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1086"><span class="lineNum">    1086 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point lower z&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1087"><span class="lineNum">    1087 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point first with m&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(2 1)&quot; ) &lt;&lt; 1;</span></a>
<a name="1088"><span class="lineNum">    1088 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point second with m&quot; ) &lt;&lt; QStringLiteral( &quot;POINT( 2 1 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1089"><span class="lineNum">    1089 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point equal m&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3)&quot; ) &lt;&lt; 0;</span></a>
<a name="1090"><span class="lineNum">    1090 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point greater m&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM( 2 1 4 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1091"><span class="lineNum">    1091 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point lower m&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1092"><span class="lineNum">    1092 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point first with z second with m&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1093"><span class="lineNum">    1093 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point first with m second with z&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM( 2 1 3 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZ(2 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1094"><span class="lineNum">    1094 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point zm&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZM( 2 1 3 4 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZM(2 1 4 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1095"><span class="lineNum">    1095 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point vs point zm second&quot; ) &lt;&lt; QStringLiteral( &quot;POINTZM( 2 1 3 4 )&quot; ) &lt;&lt; QStringLiteral( &quot;POINTM(2 1 3 5)&quot; ) &lt;&lt; -1;</span></a>
<a name="1096"><span class="lineNum">    1096 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring empty vs polygon empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON(())&quot; ) &lt;&lt; -1;</span></a>
<a name="1097"><span class="lineNum">    1097 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon empty vs linesting empty&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON(())&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(())&quot; ) &lt;&lt; 1;</span></a>
<a name="1098"><span class="lineNum">    1098 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring empty vs non empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(1 1, 2 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1099"><span class="lineNum">    1099 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring non empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; 1;</span></a>
<a name="1100"><span class="lineNum">    1100 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; 0;</span></a>
<a name="1101"><span class="lineNum">    1101 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring equal&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; 0;</span></a>
<a name="1102"><span class="lineNum">    1102 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring longer vs shorter&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2, 3 3)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1103"><span class="lineNum">    1103 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring shorter vs longer&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2, 3 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1104"><span class="lineNum">    1104 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring x less&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1105"><span class="lineNum">    1105 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring x greater&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 3 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1106"><span class="lineNum">    1106 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring y less&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 0)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1107"><span class="lineNum">    1107 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring y greater&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 3 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 3 1)&quot; ) &lt;&lt; 1;</span></a>
<a name="1108"><span class="lineNum">    1108 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring z vs no z&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1109"><span class="lineNum">    1109 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring no z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1110"><span class="lineNum">    1110 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; 0;</span></a>
<a name="1111"><span class="lineNum">    1111 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring z less&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 0)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1112"><span class="lineNum">    1112 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring z greater&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 6)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; 1;</span></a>
<a name="1113"><span class="lineNum">    1113 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring m vs no m&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1114"><span class="lineNum">    1114 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring no m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1115"><span class="lineNum">    1115 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; 0;</span></a>
<a name="1116"><span class="lineNum">    1116 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring m less&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 0)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1117"><span class="lineNum">    1117 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring m greater&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 6)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; 1;</span></a>
<a name="1118"><span class="lineNum">    1118 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring first with z vs second with m&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; 1;</span></a>
<a name="1119"><span class="lineNum">    1119 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring first with m vs second with z&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3, 2 2 4)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3, 2 2 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1120"><span class="lineNum">    1120 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring zm&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 6)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 6)&quot; ) &lt;&lt; 0;</span></a>
<a name="1121"><span class="lineNum">    1121 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring zm second&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 5)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 6)&quot; ) &lt;&lt; -1;</span></a>
<a name="1122"><span class="lineNum">    1122 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring zm third&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 7)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 2 2 4 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1123"><span class="lineNum">    1123 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring vs circular string&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 1, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1124"><span class="lineNum">    1124 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string vs linestring&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 3)&quot; )  &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 1, 2 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1125"><span class="lineNum">    1125 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string empty vs non empty&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING(1 1, 2 2, 2 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1126"><span class="lineNum">    1126 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string non empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; 1;</span></a>
<a name="1127"><span class="lineNum">    1127 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; 0;</span></a>
<a name="1128"><span class="lineNum">    1128 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string equal&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; 0;</span></a>
<a name="1129"><span class="lineNum">    1129 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string longer vs shorter&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3, 4 3, 4 4)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1130"><span class="lineNum">    1130 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string shorter vs longer&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3, 4 3, 4 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1131"><span class="lineNum">    1131 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string x less&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 2 2)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 4 2)&quot; ) &lt;&lt; -1;</span></a>
<a name="1132"><span class="lineNum">    1132 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string x greater&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 4 2)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 2 2)&quot; ) &lt;&lt; 1;</span></a>
<a name="1133"><span class="lineNum">    1133 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string y less&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 0, 2 1)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 2 1)&quot; ) &lt;&lt; -1;</span></a>
<a name="1134"><span class="lineNum">    1134 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string y greater&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 3 2, 2 1)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 3 1, 2 1)&quot; ) &lt;&lt; 1;</span></a>
<a name="1135"><span class="lineNum">    1135 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string z vs no z&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 4)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1136"><span class="lineNum">    1136 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string no z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1137"><span class="lineNum">    1137 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; 0;</span></a>
<a name="1138"><span class="lineNum">    1138 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string z less&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 0, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; -1;</span></a>
<a name="1139"><span class="lineNum">    1139 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string z greater&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 6, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; 1;</span></a>
<a name="1140"><span class="lineNum">    1140 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string m vs no m&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1141"><span class="lineNum">    1141 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string no m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 2, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; -1;</span></a>
<a name="1142"><span class="lineNum">    1142 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; 0;</span></a>
<a name="1143"><span class="lineNum">    1143 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string m less&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 0, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; -1;</span></a>
<a name="1144"><span class="lineNum">    1144 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string m greater&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 6, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; 1;</span></a>
<a name="1145"><span class="lineNum">    1145 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string first with z vs second with m&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; 1;</span></a>
<a name="1146"><span class="lineNum">    1146 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string first with m vs second with z&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3, 2 2 4, 2 3 5)&quot; ) &lt;&lt; -1;</span></a>
<a name="1147"><span class="lineNum">    1147 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string zm&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 6, 2 3 5 6)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 6, 2 3 5 6)&quot; ) &lt;&lt; 0;</span></a>
<a name="1148"><span class="lineNum">    1148 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string zm second&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 5, 2 3 5 6)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 6, 2 3 5 6)&quot; ) &lt;&lt; -1;</span></a>
<a name="1149"><span class="lineNum">    1149 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string zm third&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 7, 2 3 5 6)&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 2 4 3, 2 3 5 6)&quot; ) &lt;&lt; 1;</span></a>
<a name="1150"><span class="lineNum">    1150 </span>                :            : </a>
<a name="1151"><span class="lineNum">    1151 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring vs compound curve&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 1, 2 3)&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 1, 2 3))&quot; ) &lt;&lt; -1;</span></a>
<a name="1152"><span class="lineNum">    1152 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve vs linestring&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 1, 2 3 ))&quot; )  &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 2 1, 2 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1153"><span class="lineNum">    1153 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve empty vs non empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 2, 2 3))&quot; ) &lt;&lt; -1;</span></a>
<a name="1154"><span class="lineNum">    1154 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve non empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE( (1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; 1;</span></a>
<a name="1155"><span class="lineNum">    1155 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; 0;</span></a>
<a name="1156"><span class="lineNum">    1156 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve equal&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 2, 2 3))&quot; ) &lt;&lt; 0;</span></a>
<a name="1157"><span class="lineNum">    1157 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve longer vs shorter&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3, 4 3, 4 4))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE((1 1, 2 2, 2 3))&quot; ) &lt;&lt; 1;</span></a>
<a name="1158"><span class="lineNum">    1158 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve shorter vs longer&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3, 4 3, 4 4))&quot; ) &lt;&lt; -1;</span></a>
<a name="1159"><span class="lineNum">    1159 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve x less&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 2 2))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 4 2))&quot; ) &lt;&lt; -1;</span></a>
<a name="1160"><span class="lineNum">    1160 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve x greater&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 4 2))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 2 2))&quot; ) &lt;&lt; 1;</span></a>
<a name="1161"><span class="lineNum">    1161 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve y less&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 0, 2 1))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 2 1))&quot; ) &lt;&lt; -1;</span></a>
<a name="1162"><span class="lineNum">    1162 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve y greater&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 3 2, 2 1))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 3 1, 2 1))&quot; ) &lt;&lt; 1;</span></a>
<a name="1163"><span class="lineNum">    1163 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z vs no z&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 4))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3))&quot; ) &lt;&lt; 1;</span></a>
<a name="1164"><span class="lineNum">    1164 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve no z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 4))&quot; ) &lt;&lt; -1;</span></a>
<a name="1165"><span class="lineNum">    1165 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z vs z&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; 0;</span></a>
<a name="1166"><span class="lineNum">    1166 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z less&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 0, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; -1;</span></a>
<a name="1167"><span class="lineNum">    1167 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve z greater&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 6, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; 1;</span></a>
<a name="1168"><span class="lineNum">    1168 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m vs no m&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3))&quot; ) &lt;&lt; 1;</span></a>
<a name="1169"><span class="lineNum">    1169 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve no m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; -1;</span></a>
<a name="1170"><span class="lineNum">    1170 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m vs m&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; 0;</span></a>
<a name="1171"><span class="lineNum">    1171 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m less&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 0, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; -1;</span></a>
<a name="1172"><span class="lineNum">    1172 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve m greater&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 6, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; 1;</span></a>
<a name="1173"><span class="lineNum">    1173 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve first with z vs second with m&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; 1;</span></a>
<a name="1174"><span class="lineNum">    1174 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve first with m vs second with z&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3, 2 2 4, 2 3 5))&quot; ) &lt;&lt; -1;</span></a>
<a name="1175"><span class="lineNum">    1175 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 6, 2 3 5 6))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 6, 2 3 5 6))&quot; ) &lt;&lt; 0;</span></a>
<a name="1176"><span class="lineNum">    1176 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm second&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 5, 2 3 5 6))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 6, 2 3 5 6))&quot; ) &lt;&lt; -1;</span></a>
<a name="1177"><span class="lineNum">    1177 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve zm third&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 7, 2 3 5 6))&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 2 2 4 3, 2 3 5 6))&quot; ) &lt;&lt; 1;</span></a>
<a name="1178"><span class="lineNum">    1178 </span>                :            : </a>
<a name="1179"><span class="lineNum">    1179 </span>                :            :   // same code is used for all CurvePolygon derivates!</a>
<a name="1180"><span class="lineNum">    1180 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon empty vs non empty&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON()&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; -1;</span></a>
<a name="1181"><span class="lineNum">    1181 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon non empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON()&quot; ) &lt;&lt; 1;</span></a>
<a name="1182"><span class="lineNum">    1182 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon equal&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; 0;</span></a>
<a name="1183"><span class="lineNum">    1183 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon exterior less&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 10, 2 12, 2 13, 1 10))&quot; ) &lt;&lt; -1;</span></a>
<a name="1184"><span class="lineNum">    1184 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon exterior greater&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 11, 2 12, 2 13, 1 11))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 1, 2 1, 1 1))&quot; ) &lt;&lt; 1;</span></a>
<a name="1185"><span class="lineNum">    1185 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon less rings&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; -1;</span></a>
<a name="1186"><span class="lineNum">    1186 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon less equal&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; 0;</span></a>
<a name="1187"><span class="lineNum">    1187 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon less more&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; 1;</span></a>
<a name="1188"><span class="lineNum">    1188 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon ring lesser&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.3, 1.1 1.1))&quot; ) &lt;&lt; -1;</span></a>
<a name="1189"><span class="lineNum">    1189 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon ring greater&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON( (1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.3, 1.1 1.1))&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((1 1, 2 2, 2 3, 1 1),(1.1 1.1, 1.2 1.1, 1.1 1.2, 1.1 1.1))&quot; ) &lt;&lt; 1;</span></a>
<a name="1190"><span class="lineNum">    1190 </span>                :            : </a>
<a name="1191"><span class="lineNum">    1191 </span>                :            :   // same code is used for all geometry collection derivates!</a>
<a name="1192"><span class="lineNum">    1192 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection empty vs non empty&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION()&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; -1;</span></a>
<a name="1193"><span class="lineNum">    1193 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection non empty vs empty&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION()&quot; ) &lt;&lt; 1;</span></a>
<a name="1194"><span class="lineNum">    1194 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection equal&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3, 1 1))&quot; ) &lt;&lt; 0;</span></a>
<a name="1195"><span class="lineNum">    1195 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection different types&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(CIRCULARSTRING(1 1, 2 2, 2 3))&quot; ) &lt;&lt; -1;</span></a>
<a name="1196"><span class="lineNum">    1196 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection same&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3), POINT( 1 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3), POINT( 1 3)&quot; ) &lt;&lt; 0;</span></a>
<a name="1197"><span class="lineNum">    1197 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection less members&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3), POINT( 1 3)&quot; ) &lt;&lt; -1;</span></a>
<a name="1198"><span class="lineNum">    1198 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection more members&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3), POINT( 1 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(POINT( 1 3)&quot; ) &lt;&lt; 1;</span></a>
<a name="1199"><span class="lineNum">    1199 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection member less&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3), POINT( 1 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3), POINT( 1 4)&quot; ) &lt;&lt; -1;</span></a>
<a name="1200"><span class="lineNum">    1200 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection member greater&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION( LINESTRING(1 1, 2 2, 2 3), POINT( 1 3))&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(1 1, 2 2, 2 3), POINT( 1 1)&quot; ) &lt;&lt; 1;</span></a>
<a name="1201"><span class="lineNum">    1201 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1202"><span class="lineNum">    1202 </span>                :            : </a>
<a name="1203"><span class="lineNum">    1203 </span>                :<span class="lineCov">        124 : void TestQgsGeometry::compareTo()</span></a>
<a name="1204"><span class="lineNum">    1204 </span>                :            : {</a>
<a name="1205"><span class="lineNum">    1205 </span>                :<span class="lineCov">        124 :   QFETCH( QString, geom1 );</span></a>
<a name="1206"><span class="lineNum">    1206 </span>                :<span class="lineCov">        124 :   QFETCH( QString, geom2 );</span></a>
<a name="1207"><span class="lineNum">    1207 </span>                :<span class="lineCov">        124 :   QFETCH( int, expected );</span></a>
<a name="1208"><span class="lineNum">    1208 </span>                :            : </a>
<a name="1209"><span class="lineNum">    1209 </span>                :<span class="lineCov">        124 :   QCOMPARE( QgsGeometry::fromWkt( geom1 ).get()-&gt;compareTo( QgsGeometry::fromWkt( geom2 ).get() ), expected );</span></a>
<a name="1210"><span class="lineNum">    1210 </span>                :<span class="lineCov">        124 : }</span></a>
<a name="1211"><span class="lineNum">    1211 </span>                :            : </a>
<a name="1212"><span class="lineNum">    1212 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::scroll_data()</span></a>
<a name="1213"><span class="lineNum">    1213 </span>                :            : {</a>
<a name="1214"><span class="lineNum">    1214 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;curve&quot; );</span></a>
<a name="1215"><span class="lineNum">    1215 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;int&gt;( &quot;vertex&quot; );</span></a>
<a name="1216"><span class="lineNum">    1216 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;expected&quot; );</span></a>
<a name="1217"><span class="lineNum">    1217 </span>                :            : </a>
<a name="1218"><span class="lineNum">    1218 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING()&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="1219"><span class="lineNum">    1219 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring no matching point&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3)&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 1 3)&quot; );</span></a>
<a name="1220"><span class="lineNum">    1220 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring one vertex&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString (1 1)&quot; );</span></a>
<a name="1221"><span class="lineNum">    1221 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match first&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3, 1 4, 1 1)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 1 3, 1 4, 1 1)&quot; );</span></a>
<a name="1222"><span class="lineNum">    1222 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match second&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3, 1 4, 1 1)&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;LineString (1 2, 1 3, 1 4, 1 1, 1 2)&quot; );</span></a>
<a name="1223"><span class="lineNum">    1223 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match third&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3, 1 4, 1 1)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineString (1 3, 1 4, 1 1, 1 2, 1 3)&quot; );</span></a>
<a name="1224"><span class="lineNum">    1224 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match forth&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3, 1 4, 1 1)&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;LineString (1 4, 1 1, 1 2, 1 3, 1 4)&quot; );</span></a>
<a name="1225"><span class="lineNum">    1225 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestring match last&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING( 1 1, 1 2, 1 3, 1 4, 1 1)&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 1 3, 1 4, 1 1)&quot; );</span></a>
<a name="1226"><span class="lineNum">    1226 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringz&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZ( 1 1 3 , 1 2 4, 1 3 5 , 1 4 6, 1 1 3)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineStringZ (1 3 5, 1 4 6, 1 1 3, 1 2 4, 1 3 5)&quot; );</span></a>
<a name="1227"><span class="lineNum">    1227 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringm&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGM( 1 1 3 , 1 2 4, 1 3 5 , 1 4 6, 1 1 3)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineStringM (1 3 5, 1 4 6, 1 1 3, 1 2 4, 1 3 5)&quot; );</span></a>
<a name="1228"><span class="lineNum">    1228 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;linestringzm&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRINGZM( 1 1 3 5, 1 2 4 6, 1 3 5 7, 1 4 6 8, 1 1 3 5)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;LineStringZM (1 3 5 7, 1 4 6 8, 1 1 3 5, 1 2 4 6, 1 3 5 7)&quot; );</span></a>
<a name="1229"><span class="lineNum">    1229 </span>                :            : </a>
<a name="1230"><span class="lineNum">    1230 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring empty&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING()&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularString EMPTY&quot; );</span></a>
<a name="1231"><span class="lineNum">    1231 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring no matching point&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 1 2, 1 3)&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;CircularString (1 1, 1 2, 1 3)&quot; );</span></a>
<a name="1232"><span class="lineNum">    1232 </span>                :            :   // technically not valid, but we don't want a crash</a>
<a name="1233"><span class="lineNum">    1233 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring one vertex&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString (1 1)&quot; );</span></a>
<a name="1234"><span class="lineNum">    1234 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match first&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 2, 1 4, 1 1)&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CircularString (1 1, 2 1, 2 2, 1 4, 1 1)&quot; );</span></a>
<a name="1235"><span class="lineNum">    1235 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match third&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 2, 1 4, 1 1)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularString (2 2, 1 4, 1 1, 2 1, 2 2)&quot; );</span></a>
<a name="1236"><span class="lineNum">    1236 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match 5th&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 2, 3 4, 2 4, 1 4, 1 1)&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;CircularString (2 4, 1 4, 1 1, 2 1, 2 2, 3 4, 2 4)&quot; );</span></a>
<a name="1237"><span class="lineNum">    1237 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstring match last&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRING( 1 1, 2 1, 2 2, 3 4, 2 4, 1 4, 1 1)&quot; ) &lt;&lt; 6 &lt;&lt; QStringLiteral( &quot;CircularString (1 1, 2 1, 2 2, 3 4, 2 4, 1 4, 1 1)&quot; );</span></a>
<a name="1238"><span class="lineNum">    1238 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringz&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZ( 1 1 3 , 2 1 4, 2 2 5 , 1 4 6, 1 1 3)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularStringZ (2 2 5, 1 4 6, 1 1 3, 2 1 4, 2 2 5)&quot; );</span></a>
<a name="1239"><span class="lineNum">    1239 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringm&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGM( 1 1 3 , 2 1 4, 2 2 5 , 1 4 6, 1 1 3)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularStringM (2 2 5, 1 4 6, 1 1 3, 2 1 4, 2 2 5)&quot; );</span></a>
<a name="1240"><span class="lineNum">    1240 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circularstringzm&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM( 1 1 3 5, 2 1 4 6, 2 2 5 7, 1 4 6 8, 1 1 3 5)&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CircularStringZM (2 2 5 7, 1 4 6 8, 1 1 3 5, 2 1 4 6, 2 2 5 7)&quot; );</span></a>
<a name="1241"><span class="lineNum">    1241 </span>                :            : </a>
<a name="1242"><span class="lineNum">    1242 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE()&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="1243"><span class="lineNum">    1243 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve no matching point&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2, 1 3))&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 1, 1 2, 1 3))&quot; );</span></a>
<a name="1244"><span class="lineNum">    1244 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve one vertex&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1))&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 1))&quot; );</span></a>
<a name="1245"><span class="lineNum">    1245 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve match first&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2),( 1 2, 1 3, 1 4, 1 1))&quot; ) &lt;&lt; 0 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 1, 1 2),(1 2, 1 3, 1 4, 1 1))&quot; );</span></a>
<a name="1246"><span class="lineNum">    1246 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve match second&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2),( 1 2, 1 3, 1 4, 1 1))&quot; ) &lt;&lt; 1 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 2, 1 3, 1 4, 1 1),(1 1, 1 2))&quot; );</span></a>
<a name="1247"><span class="lineNum">    1247 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve match third&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2),( 1 2, 1 3, 1 4, 1 1))&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 3, 1 4, 1 1),(1 1, 1 2),(1 2, 1 3))&quot; );</span></a>
<a name="1248"><span class="lineNum">    1248 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve match forth&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2),( 1 2, 1 3, 1 4, 1 1))&quot; ) &lt;&lt; 3 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 4, 1 1),(1 1, 1 2),(1 2, 1 3, 1 4))&quot; );</span></a>
<a name="1249"><span class="lineNum">    1249 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurve match last&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE(( 1 1, 1 2),( 1 2, 1 3, 1 4, 1 1))&quot; ) &lt;&lt; 4 &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 1, 1 2),(1 2, 1 3, 1 4, 1 1))&quot; );</span></a>
<a name="1250"><span class="lineNum">    1250 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurvez&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZ(( 1 1 3 , 1 2 4, 1 3 5 , 1 4 6, 1 1 3))&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CompoundCurveZ ((1 3 5, 1 4 6, 1 1 3),(1 1 3, 1 2 4, 1 3 5))&quot; );</span></a>
<a name="1251"><span class="lineNum">    1251 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurvem&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEM(( 1 1 3 , 1 2 4, 1 3 5 , 1 4 6, 1 1 3))&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CompoundCurveM ((1 3 5, 1 4 6, 1 1 3),(1 1 3, 1 2 4, 1 3 5))&quot; );</span></a>
<a name="1252"><span class="lineNum">    1252 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compoundcurvezm&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVEZM(( 1 1 3 5, 1 2 4 6, 1 3 5 7, 1 4 6 8, 1 1 3 5))&quot; ) &lt;&lt; 2 &lt;&lt; QStringLiteral( &quot;CompoundCurveZM ((1 3 5 7, 1 4 6 8, 1 1 3 5),(1 1 3 5, 1 2 4 6, 1 3 5 7))&quot; );</span></a>
<a name="1253"><span class="lineNum">    1253 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1254"><span class="lineNum">    1254 </span>                :            : </a>
<a name="1255"><span class="lineNum">    1255 </span>                :<span class="lineCov">         32 : void TestQgsGeometry::scroll()</span></a>
<a name="1256"><span class="lineNum">    1256 </span>                :            : {</a>
<a name="1257"><span class="lineNum">    1257 </span>                :<span class="lineCov">         32 :   QFETCH( QString, curve );</span></a>
<a name="1258"><span class="lineNum">    1258 </span>                :<span class="lineCov">         32 :   QFETCH( int, vertex );</span></a>
<a name="1259"><span class="lineNum">    1259 </span>                :<span class="lineCov">         32 :   QFETCH( QString, expected );</span></a>
<a name="1260"><span class="lineNum">    1260 </span>                :            : </a>
<a name="1261"><span class="lineNum">    1261 </span>                :<span class="lineCov">         32 :   QgsGeometry geom = QgsGeometry::fromWkt( curve );</span></a>
<a name="1262"><span class="lineNum">    1262 </span>                :<span class="lineCov">         32 :   qgsgeometry_cast&lt; QgsCurve * &gt;( geom.get() )-&gt;scroll( vertex );</span></a>
<a name="1263"><span class="lineNum">    1263 </span>                :            : </a>
<a name="1264"><span class="lineNum">    1264 </span>                :<span class="lineCov">         32 :   QCOMPARE( geom.get()-&gt;asWkt(), expected );</span></a>
<a name="1265"><span class="lineNum">    1265 </span>                :<span class="lineCov">         32 : }</span></a>
<a name="1266"><span class="lineNum">    1266 </span>                :            : </a>
<a name="1267"><span class="lineNum">    1267 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::normalize_data()</span></a>
<a name="1268"><span class="lineNum">    1268 </span>                :            : {</a>
<a name="1269"><span class="lineNum">    1269 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;wkt&quot; );</span></a>
<a name="1270"><span class="lineNum">    1270 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;expected&quot; );</span></a>
<a name="1271"><span class="lineNum">    1271 </span>                :            : </a>
<a name="1272"><span class="lineNum">    1272 </span>                :<span class="lineCov">          1 :   QTest::newRow( &quot;empty&quot; ) &lt;&lt; QString() &lt;&lt; QString();</span></a>
<a name="1273"><span class="lineNum">    1273 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point empty&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;Point EMPTY&quot; );</span></a>
<a name="1274"><span class="lineNum">    1274 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT (1 2)&quot; )  &lt;&lt; QStringLiteral( &quot;Point (1 2)&quot; );</span></a>
<a name="1275"><span class="lineNum">    1275 </span>                :            :   // same code paths are used for all curve derivatives</a>
<a name="1276"><span class="lineNum">    1276 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;line empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="1277"><span class="lineNum">    1277 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;line open&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING (1 1, 1 2, 1 3)&quot; )  &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 1 3)&quot; );</span></a>
<a name="1278"><span class="lineNum">    1278 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;line closed&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING (1 1, 1 0, 0 0, 0 1, 1 1)&quot; )  &lt;&lt; QStringLiteral( &quot;LineString (0 0, 0 1, 1 1, 1 0, 0 0)&quot; );</span></a>
<a name="1279"><span class="lineNum">    1279 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string closed&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM (1 1 11 21, 1 0 12 22, 0 0 13 23, 0 1 14 24, 1 1 11 21)&quot; )  &lt;&lt; QStringLiteral( &quot;CircularStringZM (0 0 13 23, 0 1 14 24, 1 1 11 21, 1 0 12 22, 0 0 13 23)&quot; );</span></a>
<a name="1280"><span class="lineNum">    1280 </span>                :            :   // same code paths are used for all curve polygon derivatives</a>
<a name="1281"><span class="lineNum">    1281 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon empty&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;Polygon EMPTY&quot; );</span></a>
<a name="1282"><span class="lineNum">    1282 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon exterior&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON ((1 1, 0 1, 0 0, 1 0, 1 1))&quot; )  &lt;&lt; QStringLiteral( &quot;Polygon ((0 0, 0 1, 1 1, 1 0, 0 0))&quot; );</span></a>
<a name="1283"><span class="lineNum">    1283 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon rings&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON ((1 1, 0 1, 0 0, 1 0, 1 1),(0.1 0.2,  0.2 0.2, 0.2 0.1, 0.1 0.1, 0.1 0.2),(0.8 0.8, 0.8 0.7, 0.7 0.7, 0.7 0.8, 0.8 0.8))&quot; )  &lt;&lt; QStringLiteral( &quot;Polygon ((0 0, 0 1, 1 1, 1 0, 0 0),(0.7 0.7, 0.8 0.7, 0.8 0.8, 0.7 0.8, 0.7 0.7),(0.1 0.1, 0.2 0.1, 0.2 0.2, 0.1 0.2, 0.1 0.1))&quot; );</span></a>
<a name="1284"><span class="lineNum">    1284 </span>                :            :   // same code paths are used for all collection derivatives</a>
<a name="1285"><span class="lineNum">    1285 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection empty&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;GeometryCollection EMPTY&quot; );</span></a>
<a name="1286"><span class="lineNum">    1286 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;multipoint&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT(1 1, 3 4, 1 3, 2 2)&quot; )  &lt;&lt; QStringLiteral( &quot;MultiPoint ((3 4),(2 2),(1 3),(1 1))&quot; );</span></a>
<a name="1287"><span class="lineNum">    1287 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1288"><span class="lineNum">    1288 </span>                :            : </a>
<a name="1289"><span class="lineNum">    1289 </span>                :<span class="lineCov">         12 : void TestQgsGeometry::normalize()</span></a>
<a name="1290"><span class="lineNum">    1290 </span>                :            : {</a>
<a name="1291"><span class="lineNum">    1291 </span>                :<span class="lineCov">         12 :   QFETCH( QString, wkt );</span></a>
<a name="1292"><span class="lineNum">    1292 </span>                :<span class="lineCov">         12 :   QFETCH( QString, expected );</span></a>
<a name="1293"><span class="lineNum">    1293 </span>                :            : </a>
<a name="1294"><span class="lineNum">    1294 </span>                :<span class="lineCov">         12 :   QgsGeometry geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1295"><span class="lineNum">    1295 </span>                :<span class="lineCov">         12 :   geom.normalize();</span></a>
<a name="1296"><span class="lineNum">    1296 </span>                :            : </a>
<a name="1297"><span class="lineNum">    1297 </span>                :<span class="lineCov">         12 :   QCOMPARE( geom.asWkt( 1 ), expected );</span></a>
<a name="1298"><span class="lineNum">    1298 </span>                :<span class="lineCov">         12 : }</span></a>
<a name="1299"><span class="lineNum">    1299 </span>                :            : </a>
<a name="1300"><span class="lineNum">    1300 </span>                :            : </a>
<a name="1301"><span class="lineNum">    1301 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::simplifiedTypeRef_data()</span></a>
<a name="1302"><span class="lineNum">    1302 </span>                :            : {</a>
<a name="1303"><span class="lineNum">    1303 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;wkt&quot; );</span></a>
<a name="1304"><span class="lineNum">    1304 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;expected&quot; );</span></a>
<a name="1305"><span class="lineNum">    1305 </span>                :            : </a>
<a name="1306"><span class="lineNum">    1306 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point empty&quot; ) &lt;&lt; QStringLiteral( &quot;POINT EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;Point EMPTY&quot; );</span></a>
<a name="1307"><span class="lineNum">    1307 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;point&quot; ) &lt;&lt; QStringLiteral( &quot;POINT (1 2)&quot; )  &lt;&lt; QStringLiteral( &quot;Point (1 2)&quot; );</span></a>
<a name="1308"><span class="lineNum">    1308 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;line empty&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;LineString EMPTY&quot; );</span></a>
<a name="1309"><span class="lineNum">    1309 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;line&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING (1 1, 1 2, 1 3)&quot; )  &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 1 3)&quot; );</span></a>
<a name="1310"><span class="lineNum">    1310 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;circular string&quot; ) &lt;&lt; QStringLiteral( &quot;CIRCULARSTRINGZM (1 1 11 21, 1 0 12 22, 0 0 13 23, 0 1 14 24, 1 1 11 21)&quot; )  &lt;&lt; QStringLiteral( &quot;CircularStringZM (1 1 11 21, 1 0 12 22, 0 0 13 23, 0 1 14 24, 1 1 11 21)&quot; );</span></a>
<a name="1311"><span class="lineNum">    1311 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve empty&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;CompoundCurve EMPTY&quot; );</span></a>
<a name="1312"><span class="lineNum">    1312 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve one curve&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE ((1 1, 1 2, 2 3))&quot; )  &lt;&lt; QStringLiteral( &quot;LineString (1 1, 1 2, 2 3)&quot; );</span></a>
<a name="1313"><span class="lineNum">    1313 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;compound curve two curves&quot; ) &lt;&lt; QStringLiteral( &quot;COMPOUNDCURVE ((1 1, 1 2, 2 3),(2 3, 4 4))&quot; )  &lt;&lt; QStringLiteral( &quot;CompoundCurve ((1 1, 1 2, 2 3),(2 3, 4 4))&quot; );</span></a>
<a name="1314"><span class="lineNum">    1314 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon empty&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;Polygon EMPTY&quot; );</span></a>
<a name="1315"><span class="lineNum">    1315 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon exterior&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON ((1 1, 0 1, 0 0, 1 0, 1 1))&quot; )  &lt;&lt; QStringLiteral( &quot;Polygon ((1 1, 0 1, 0 0, 1 0, 1 1))&quot; );</span></a>
<a name="1316"><span class="lineNum">    1316 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection empty&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION EMPTY&quot; )  &lt;&lt; QStringLiteral( &quot;GeometryCollection EMPTY&quot; );</span></a>
<a name="1317"><span class="lineNum">    1317 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;multipoint one point&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT(1 1)&quot; )  &lt;&lt; QStringLiteral( &quot;Point (1 1)&quot; );</span></a>
<a name="1318"><span class="lineNum">    1318 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;multipoint&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT(1 1, 3 4, 1 3, 2 2)&quot; )  &lt;&lt; QStringLiteral( &quot;MultiPoint ((1 1),(3 4),(1 3),(2 2))&quot; );</span></a>
<a name="1319"><span class="lineNum">    1319 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1320"><span class="lineNum">    1320 </span>                :            : </a>
<a name="1321"><span class="lineNum">    1321 </span>                :<span class="lineCov">         13 : void TestQgsGeometry::simplifiedTypeRef()</span></a>
<a name="1322"><span class="lineNum">    1322 </span>                :            : {</a>
<a name="1323"><span class="lineNum">    1323 </span>                :<span class="lineCov">         13 :   QFETCH( QString, wkt );</span></a>
<a name="1324"><span class="lineNum">    1324 </span>                :<span class="lineCov">         13 :   QFETCH( QString, expected );</span></a>
<a name="1325"><span class="lineNum">    1325 </span>                :            : </a>
<a name="1326"><span class="lineNum">    1326 </span>                :<span class="lineCov">         13 :   QgsGeometry geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1327"><span class="lineNum">    1327 </span>                :<span class="lineCov">         13 :   QCOMPARE( geom.constGet()-&gt;simplifiedTypeRef()-&gt;asWkt( 1 ), expected );</span></a>
<a name="1328"><span class="lineNum">    1328 </span>                :<span class="lineCov">         13 : }</span></a>
<a name="1329"><span class="lineNum">    1329 </span>                :            : </a>
<a name="1330"><span class="lineNum">    1330 </span>                :            : // MK, Disabled 14.11.2014</a>
<a name="1331"><span class="lineNum">    1331 </span>                :            : // Too unclear what exactly should be tested and which variations are allowed for the line</a>
<a name="1332"><span class="lineNum">    1332 </span>                :            : #if 0</a>
<a name="1333"><span class="lineNum">    1333 </span>                :            : void TestQgsGeometry::simplifyCheck1()</a>
<a name="1334"><span class="lineNum">    1334 </span>                :            : {</a>
<a name="1335"><span class="lineNum">    1335 </span>                :            :   initPainterTest();</a>
<a name="1336"><span class="lineNum">    1336 </span>                :            :   QVERIFY( mpPolylineGeometryD-&gt;simplify( 0.5 ) );</a>
<a name="1337"><span class="lineNum">    1337 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="1338"><span class="lineNum">    1338 </span>                :            :   QgsGeometry *mypSimplifyGeometry  =  mpPolylineGeometryD-&gt;simplify( 0.5 );</a>
<a name="1339"><span class="lineNum">    1339 </span>                :            :   qDebug( &quot;Geometry Type: %s&quot;, QgsWkbTypes::displayString( mypSimplifyGeometry-&gt;wkbType() ) );</a>
<a name="1340"><span class="lineNum">    1340 </span>                :            :   QVERIFY( mypSimplifyGeometry-&gt;wkbType() == QgsWkbTypes::LineString );</a>
<a name="1341"><span class="lineNum">    1341 </span>                :            :   QgsPolyline myLine = mypSimplifyGeometry-&gt;asPolyline();</a>
<a name="1342"><span class="lineNum">    1342 </span>                :            :   QVERIFY( myLine.size() &gt; 0 ); //check that the union created a feature</a>
<a name="1343"><span class="lineNum">    1343 </span>                :            :   dumpPolyline( myLine );</a>
<a name="1344"><span class="lineNum">    1344 </span>                :            :   delete mypSimplifyGeometry;</a>
<a name="1345"><span class="lineNum">    1345 </span>                :            :   QVERIFY( renderCheck( &quot;geometry_simplifyCheck1&quot;, &quot;Checking simplify of line&quot; ) );</a>
<a name="1346"><span class="lineNum">    1346 </span>                :            : }</a>
<a name="1347"><span class="lineNum">    1347 </span>                :            : #endif</a>
<a name="1348"><span class="lineNum">    1348 </span>                :            : </a>
<a name="1349"><span class="lineNum">    1349 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::intersectionCheck1()</span></a>
<a name="1350"><span class="lineNum">    1350 </span>                :            : {</a>
<a name="1351"><span class="lineNum">    1351 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1352"><span class="lineNum">    1352 </span>                :<span class="lineCov">          1 :   QVERIFY( mpPolygonGeometryA.intersects( mpPolygonGeometryB ) );</span></a>
<a name="1353"><span class="lineNum">    1353 </span>                :            : </a>
<a name="1354"><span class="lineNum">    1354 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryEngine &gt; engine( QgsGeometry::createGeometryEngine( mpPolygonGeometryA.constGet() ) );</span></a>
<a name="1355"><span class="lineNum">    1355 </span>                :<span class="lineCov">          1 :   QVERIFY( engine-&gt;intersects( mpPolygonGeometryB.constGet() ) );</span></a>
<a name="1356"><span class="lineNum">    1356 </span>                :<span class="lineCov">          1 :   engine-&gt;prepareGeometry();</span></a>
<a name="1357"><span class="lineNum">    1357 </span>                :<span class="lineCov">          1 :   QVERIFY( engine-&gt;intersects( mpPolygonGeometryB.constGet() ) );</span></a>
<a name="1358"><span class="lineNum">    1358 </span>                :            : </a>
<a name="1359"><span class="lineNum">    1359 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="1360"><span class="lineNum">    1360 </span>                :<span class="lineCov">          1 :   QgsGeometry mypIntersectionGeometry  =  mpPolygonGeometryA.intersection( mpPolygonGeometryB );</span></a>
<a name="1361"><span class="lineNum">    1361 </span>                :<span class="lineCov">          1 :   QVERIFY( mypIntersectionGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="1362"><span class="lineNum">    1362 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypIntersectionGeometry.asPolygon();</span></a>
<a name="1363"><span class="lineNum">    1363 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="1364"><span class="lineNum">    1364 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="1365"><span class="lineNum">    1365 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_intersectionCheck1&quot;, &quot;Checking if A intersects B&quot; ) );</span></a>
<a name="1366"><span class="lineNum">    1366 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1367"><span class="lineNum">    1367 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::intersectionCheck2()</span></a>
<a name="1368"><span class="lineNum">    1368 </span>                :            : {</a>
<a name="1369"><span class="lineNum">    1369 </span>                :<span class="lineCov">          1 :   QVERIFY( !mpPolygonGeometryA.intersects( mpPolygonGeometryC ) );</span></a>
<a name="1370"><span class="lineNum">    1370 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1371"><span class="lineNum">    1371 </span>                :            : </a>
<a name="1372"><span class="lineNum">    1372 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::translateCheck1()</span></a>
<a name="1373"><span class="lineNum">    1373 </span>                :            : {</a>
<a name="1374"><span class="lineNum">    1374 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;LineString (0 0, 10 0, 10 10)&quot; );</span></a>
<a name="1375"><span class="lineNum">    1375 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="1376"><span class="lineNum">    1376 </span>                :<span class="lineCov">          1 :   geom.translate( 10, -5 );</span></a>
<a name="1377"><span class="lineNum">    1377 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asWkt();</span></a>
<a name="1378"><span class="lineNum">    1378 </span>                :<span class="lineCov">          2 :   QString expected = QStringLiteral( &quot;LineString (10 -5, 20 -5, 20 5)&quot; );</span></a>
<a name="1379"><span class="lineNum">    1379 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1380"><span class="lineNum">    1380 </span>                :<span class="lineCov">          1 :   geom.translate( -10, 5 );</span></a>
<a name="1381"><span class="lineNum">    1381 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1382"><span class="lineNum">    1382 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1383"><span class="lineNum">    1383 </span>                :            : </a>
<a name="1384"><span class="lineNum">    1384 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((-2 4, -2 -10, 2 3, -2 4),(1 1, -1 1, -1 -1, 1 1))&quot; );</span></a>
<a name="1385"><span class="lineNum">    1385 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1386"><span class="lineNum">    1386 </span>                :<span class="lineCov">          1 :   geom.translate( -2, 10 );</span></a>
<a name="1387"><span class="lineNum">    1387 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1388"><span class="lineNum">    1388 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Polygon ((-4 14, -4 0, 0 13, -4 14),(-1 11, -3 11, -3 9, -1 11))&quot; );</span></a>
<a name="1389"><span class="lineNum">    1389 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1390"><span class="lineNum">    1390 </span>                :<span class="lineCov">          1 :   geom.translate( 2, -10 );</span></a>
<a name="1391"><span class="lineNum">    1391 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1392"><span class="lineNum">    1392 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1393"><span class="lineNum">    1393 </span>                :            : </a>
<a name="1394"><span class="lineNum">    1394 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="1395"><span class="lineNum">    1395 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1396"><span class="lineNum">    1396 </span>                :<span class="lineCov">          1 :   geom.translate( -2, 10 );</span></a>
<a name="1397"><span class="lineNum">    1397 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1398"><span class="lineNum">    1398 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (38 60)&quot; );</span></a>
<a name="1399"><span class="lineNum">    1399 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1400"><span class="lineNum">    1400 </span>                :<span class="lineCov">          1 :   geom.translate( 2, -10 );</span></a>
<a name="1401"><span class="lineNum">    1401 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1402"><span class="lineNum">    1402 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1403"><span class="lineNum">    1403 </span>                :            : </a>
<a name="1404"><span class="lineNum">    1404 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1405"><span class="lineNum">    1405 </span>                :            : </a>
<a name="1406"><span class="lineNum">    1406 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::rotateCheck1()</span></a>
<a name="1407"><span class="lineNum">    1407 </span>                :            : {</a>
<a name="1408"><span class="lineNum">    1408 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;LineString (0 0, 10 0, 10 10)&quot; );</span></a>
<a name="1409"><span class="lineNum">    1409 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="1410"><span class="lineNum">    1410 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1411"><span class="lineNum">    1411 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asWkt();</span></a>
<a name="1412"><span class="lineNum">    1412 </span>                :<span class="lineCov">          2 :   QString expected = QStringLiteral( &quot;LineString (0 0, 0 -10, 10 -10)&quot; );</span></a>
<a name="1413"><span class="lineNum">    1413 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1414"><span class="lineNum">    1414 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1415"><span class="lineNum">    1415 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1416"><span class="lineNum">    1416 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1417"><span class="lineNum">    1417 </span>                :            : </a>
<a name="1418"><span class="lineNum">    1418 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((-2 4, -2 -10, 2 3, -2 4),(1 1, -1 1, -1 -1, 1 1))&quot; );</span></a>
<a name="1419"><span class="lineNum">    1419 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1420"><span class="lineNum">    1420 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1421"><span class="lineNum">    1421 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1422"><span class="lineNum">    1422 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Polygon ((4 2, -10 2, 3 -2, 4 2),(1 -1, 1 1, -1 1, 1 -1))&quot; );</span></a>
<a name="1423"><span class="lineNum">    1423 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1424"><span class="lineNum">    1424 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1425"><span class="lineNum">    1425 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1426"><span class="lineNum">    1426 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1427"><span class="lineNum">    1427 </span>                :            : </a>
<a name="1428"><span class="lineNum">    1428 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="1429"><span class="lineNum">    1429 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1430"><span class="lineNum">    1430 </span>                :<span class="lineCov">          1 :   geom.rotate( 90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1431"><span class="lineNum">    1431 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1432"><span class="lineNum">    1432 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (50 -40)&quot; );</span></a>
<a name="1433"><span class="lineNum">    1433 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1434"><span class="lineNum">    1434 </span>                :<span class="lineCov">          1 :   geom.rotate( -90, QgsPointXY( 0, 0 ) );</span></a>
<a name="1435"><span class="lineNum">    1435 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1436"><span class="lineNum">    1436 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1437"><span class="lineNum">    1437 </span>                :<span class="lineCov">          1 :   geom.rotate( 180, QgsPointXY( 40, 0 ) );</span></a>
<a name="1438"><span class="lineNum">    1438 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;Point (40 -50)&quot; );</span></a>
<a name="1439"><span class="lineNum">    1439 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1440"><span class="lineNum">    1440 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, expected );</span></a>
<a name="1441"><span class="lineNum">    1441 </span>                :<span class="lineCov">          1 :   geom.rotate( 180, QgsPointXY( 40, 0 ) ); // round-trip</span></a>
<a name="1442"><span class="lineNum">    1442 </span>                :<span class="lineCov">          1 :   obtained = geom.asWkt();</span></a>
<a name="1443"><span class="lineNum">    1443 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1444"><span class="lineNum">    1444 </span>                :            : </a>
<a name="1445"><span class="lineNum">    1445 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1446"><span class="lineNum">    1446 </span>                :            : </a>
<a name="1447"><span class="lineNum">    1447 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unionCheck1()</span></a>
<a name="1448"><span class="lineNum">    1448 </span>                :            : {</a>
<a name="1449"><span class="lineNum">    1449 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1450"><span class="lineNum">    1450 </span>                :            :   // should be a multipolygon with 2 parts as A does not intersect C</a>
<a name="1451"><span class="lineNum">    1451 </span>                :<span class="lineCov">          1 :   QgsGeometry mypUnionGeometry  =  mpPolygonGeometryA.combine( mpPolygonGeometryC );</span></a>
<a name="1452"><span class="lineNum">    1452 </span>                :<span class="lineCov">          1 :   QVERIFY( mypUnionGeometry.wkbType() == QgsWkbTypes::MultiPolygon );</span></a>
<a name="1453"><span class="lineNum">    1453 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY myMultiPolygon = mypUnionGeometry.asMultiPolygon();</span></a>
<a name="1454"><span class="lineNum">    1454 </span>                :<span class="lineCov">          1 :   QVERIFY( myMultiPolygon.size() &gt; 0 ); //check that the union did not fail</span></a>
<a name="1455"><span class="lineNum">    1455 </span>                :<span class="lineCov">          1 :   paintMultiPolygon( myMultiPolygon );</span></a>
<a name="1456"><span class="lineNum">    1456 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_unionCheck1&quot;, &quot;Checking A union C produces 2 polys&quot; ) );</span></a>
<a name="1457"><span class="lineNum">    1457 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1458"><span class="lineNum">    1458 </span>                :            : </a>
<a name="1459"><span class="lineNum">    1459 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unionCheck2()</span></a>
<a name="1460"><span class="lineNum">    1460 </span>                :            : {</a>
<a name="1461"><span class="lineNum">    1461 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1462"><span class="lineNum">    1462 </span>                :            :   // should be a single polygon as A intersect B</a>
<a name="1463"><span class="lineNum">    1463 </span>                :<span class="lineCov">          1 :   QgsGeometry mypUnionGeometry  =  mpPolygonGeometryA.combine( mpPolygonGeometryB );</span></a>
<a name="1464"><span class="lineNum">    1464 </span>                :<span class="lineCov">          1 :   QVERIFY( mypUnionGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="1465"><span class="lineNum">    1465 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypUnionGeometry.asPolygon();</span></a>
<a name="1466"><span class="lineNum">    1466 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="1467"><span class="lineNum">    1467 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="1468"><span class="lineNum">    1468 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_unionCheck2&quot;, &quot;Checking A union B produces single union poly&quot; ) );</span></a>
<a name="1469"><span class="lineNum">    1469 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1470"><span class="lineNum">    1470 </span>                :            : </a>
<a name="1471"><span class="lineNum">    1471 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::differenceCheck1()</span></a>
<a name="1472"><span class="lineNum">    1472 </span>                :            : {</a>
<a name="1473"><span class="lineNum">    1473 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1474"><span class="lineNum">    1474 </span>                :            :   // should be same as A since A does not intersect C so diff is 100% of A</a>
<a name="1475"><span class="lineNum">    1475 </span>                :<span class="lineCov">          1 :   QgsGeometry mypDifferenceGeometry( mpPolygonGeometryA.difference( mpPolygonGeometryC ) );</span></a>
<a name="1476"><span class="lineNum">    1476 </span>                :<span class="lineCov">          1 :   QVERIFY( mypDifferenceGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="1477"><span class="lineNum">    1477 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypDifferenceGeometry.asPolygon();</span></a>
<a name="1478"><span class="lineNum">    1478 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union did not fail</span></a>
<a name="1479"><span class="lineNum">    1479 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="1480"><span class="lineNum">    1480 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_differenceCheck1&quot;, &quot;Checking (A - C) = A&quot; ) );</span></a>
<a name="1481"><span class="lineNum">    1481 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1482"><span class="lineNum">    1482 </span>                :            : </a>
<a name="1483"><span class="lineNum">    1483 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::differenceCheck2()</span></a>
<a name="1484"><span class="lineNum">    1484 </span>                :            : {</a>
<a name="1485"><span class="lineNum">    1485 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1486"><span class="lineNum">    1486 </span>                :            :   // should be a single polygon as (A - B) = subset of A</a>
<a name="1487"><span class="lineNum">    1487 </span>                :<span class="lineCov">          1 :   QgsGeometry mypDifferenceGeometry( mpPolygonGeometryA.difference( mpPolygonGeometryB ) );</span></a>
<a name="1488"><span class="lineNum">    1488 </span>                :<span class="lineCov">          1 :   QVERIFY( mypDifferenceGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="1489"><span class="lineNum">    1489 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypDifferenceGeometry.asPolygon();</span></a>
<a name="1490"><span class="lineNum">    1490 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the union created a feature</span></a>
<a name="1491"><span class="lineNum">    1491 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="1492"><span class="lineNum">    1492 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_differenceCheck2&quot;, &quot;Checking (A - B) = subset of A&quot; ) );</span></a>
<a name="1493"><span class="lineNum">    1493 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1494"><span class="lineNum">    1494 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::bufferCheck()</span></a>
<a name="1495"><span class="lineNum">    1495 </span>                :            : {</a>
<a name="1496"><span class="lineNum">    1496 </span>                :<span class="lineCov">          1 :   initPainterTest();</span></a>
<a name="1497"><span class="lineNum">    1497 </span>                :            :   // should be a single polygon</a>
<a name="1498"><span class="lineNum">    1498 </span>                :<span class="lineCov">          1 :   QgsGeometry mypBufferGeometry( mpPolygonGeometryB.buffer( 10, 10 ) );</span></a>
<a name="1499"><span class="lineNum">    1499 </span>                :<span class="lineCov">          1 :   QVERIFY( mypBufferGeometry.wkbType() == QgsWkbTypes::Polygon );</span></a>
<a name="1500"><span class="lineNum">    1500 </span>                :<span class="lineCov">          1 :   QgsPolygonXY myPolygon = mypBufferGeometry.asPolygon();</span></a>
<a name="1501"><span class="lineNum">    1501 </span>                :<span class="lineCov">          1 :   QVERIFY( myPolygon.size() &gt; 0 ); //check that the buffer created a feature</span></a>
<a name="1502"><span class="lineNum">    1502 </span>                :<span class="lineCov">          1 :   paintPolygon( myPolygon );</span></a>
<a name="1503"><span class="lineNum">    1503 </span>                :<span class="lineCov">          1 :   QVERIFY( renderCheck( &quot;geometry_bufferCheck&quot;, &quot;Checking buffer(10,10) of B&quot;, 10 ) );</span></a>
<a name="1504"><span class="lineNum">    1504 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1505"><span class="lineNum">    1505 </span>                :            : </a>
<a name="1506"><span class="lineNum">    1506 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::smoothCheck()</span></a>
<a name="1507"><span class="lineNum">    1507 </span>                :            : {</a>
<a name="1508"><span class="lineNum">    1508 </span>                :            :   //can't smooth a point</a>
<a name="1509"><span class="lineNum">    1509 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="1510"><span class="lineNum">    1510 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="1511"><span class="lineNum">    1511 </span>                :<span class="lineCov">          1 :   QgsGeometry result = geom.smooth( 1, 0.25 );</span></a>
<a name="1512"><span class="lineNum">    1512 </span>                :<span class="lineCov">          1 :   QString obtained = result.asWkt();</span></a>
<a name="1513"><span class="lineNum">    1513 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, wkt );</span></a>
<a name="1514"><span class="lineNum">    1514 </span>                :            : </a>
<a name="1515"><span class="lineNum">    1515 </span>                :            :   //linestring</a>
<a name="1516"><span class="lineNum">    1516 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="1517"><span class="lineNum">    1517 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1518"><span class="lineNum">    1518 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1519"><span class="lineNum">    1519 </span>                :<span class="lineCov">          1 :   QgsPolylineXY line = result.asPolyline();</span></a>
<a name="1520"><span class="lineNum">    1520 </span>                :<span class="lineCov">          1 :   QgsPolylineXY expectedLine;</span></a>
<a name="1521"><span class="lineNum">    1521 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="1522"><span class="lineNum">    1522 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 12.5, 10.0 ) &lt;&lt; QgsPointXY( 20.0, 10.0 );</span></a>
<a name="1523"><span class="lineNum">    1523 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="1524"><span class="lineNum">    1524 </span>                :            : </a>
<a name="1525"><span class="lineNum">    1525 </span>                :            :   //linestringM</a>
<a name="1526"><span class="lineNum">    1526 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringM(0 0 1, 10 0 2, 10 10 6, 20 10 4)&quot; );</span></a>
<a name="1527"><span class="lineNum">    1527 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1528"><span class="lineNum">    1528 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1529"><span class="lineNum">    1529 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringM (0 0 1, 7.5 0 1.75, 10 2.5 3, 10 7.5 5, 12.5 10 5.5, 20 10 4)&quot; ) );</span></a>
<a name="1530"><span class="lineNum">    1530 </span>                :            : </a>
<a name="1531"><span class="lineNum">    1531 </span>                :            :   //linestringZ</a>
<a name="1532"><span class="lineNum">    1532 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringZ(0 0 1, 10 0 2, 10 10 6, 20 10 4)&quot; );</span></a>
<a name="1533"><span class="lineNum">    1533 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1534"><span class="lineNum">    1534 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1535"><span class="lineNum">    1535 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringZ (0 0 1, 7.5 0 1.75, 10 2.5 3, 10 7.5 5, 12.5 10 5.5, 20 10 4)&quot; ) );</span></a>
<a name="1536"><span class="lineNum">    1536 </span>                :            : </a>
<a name="1537"><span class="lineNum">    1537 </span>                :            :   //linestringZM</a>
<a name="1538"><span class="lineNum">    1538 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineStringZM(0 0 1 4, 10 0 2 8, 10 10 6 2, 20 10 4 0)&quot; );</span></a>
<a name="1539"><span class="lineNum">    1539 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1540"><span class="lineNum">    1540 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1541"><span class="lineNum">    1541 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;LineStringZM (0 0 1 4, 7.5 0 1.75 7, 10 2.5 3 6.5, 10 7.5 5 3.5, 12.5 10 5.5 1.5, 20 10 4 0)&quot; ) );</span></a>
<a name="1542"><span class="lineNum">    1542 </span>                :            : </a>
<a name="1543"><span class="lineNum">    1543 </span>                :            :   //linestring, with min distance</a>
<a name="1544"><span class="lineNum">    1544 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 15 10, 15 20)&quot; );</span></a>
<a name="1545"><span class="lineNum">    1545 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1546"><span class="lineNum">    1546 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 6 );</span></a>
<a name="1547"><span class="lineNum">    1547 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="1548"><span class="lineNum">    1548 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="1549"><span class="lineNum">    1549 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="1550"><span class="lineNum">    1550 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 15, 12.5 ) &lt;&lt; QgsPointXY( 15.0, 20.0 );</span></a>
<a name="1551"><span class="lineNum">    1551 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="1552"><span class="lineNum">    1552 </span>                :            : </a>
<a name="1553"><span class="lineNum">    1553 </span>                :            :   //linestring, with max angle</a>
<a name="1554"><span class="lineNum">    1554 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 15 5, 25 -5, 30 -5 )&quot; );</span></a>
<a name="1555"><span class="lineNum">    1555 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1556"><span class="lineNum">    1556 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="1557"><span class="lineNum">    1557 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="1558"><span class="lineNum">    1558 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="1559"><span class="lineNum">    1559 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 11.25, 1.25 )</span></a>
<a name="1560"><span class="lineNum">    1560 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 15.0, 5.0 ) &lt;&lt; QgsPointXY( 22.5, -2.5 ) &lt;&lt; QgsPointXY( 26.25, -5 ) &lt;&lt; QgsPointXY( 30, -5 );</span></a>
<a name="1561"><span class="lineNum">    1561 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="1562"><span class="lineNum">    1562 </span>                :            : </a>
<a name="1563"><span class="lineNum">    1563 </span>                :            :   //linestring, with max angle, other direction</a>
<a name="1564"><span class="lineNum">    1564 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString( 30 -5, 25 -5, 15 5, 10 0, 0 0 )&quot; );</span></a>
<a name="1565"><span class="lineNum">    1565 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1566"><span class="lineNum">    1566 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="1567"><span class="lineNum">    1567 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="1568"><span class="lineNum">    1568 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="1569"><span class="lineNum">    1569 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 30, -5 ) &lt;&lt; QgsPointXY( 26.25, -5 ) &lt;&lt; QgsPointXY( 22.5, -2.5 )</span></a>
<a name="1570"><span class="lineNum">    1570 </span>                :<span class="lineCov">          1 :                &lt;&lt; QgsPointXY( 15.0, 5.0 ) &lt;&lt; QgsPointXY( 11.25, 1.25 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 0, 0 );</span></a>
<a name="1571"><span class="lineNum">    1571 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="1572"><span class="lineNum">    1572 </span>                :            : </a>
<a name="1573"><span class="lineNum">    1573 </span>                :            :   //linestring, max angle, first corner sharp</a>
<a name="1574"><span class="lineNum">    1574 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10 )&quot; );</span></a>
<a name="1575"><span class="lineNum">    1575 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1576"><span class="lineNum">    1576 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, 0, 50 );</span></a>
<a name="1577"><span class="lineNum">    1577 </span>                :<span class="lineCov">          1 :   line = result.asPolyline();</span></a>
<a name="1578"><span class="lineNum">    1578 </span>                :<span class="lineCov">          1 :   expectedLine.clear();</span></a>
<a name="1579"><span class="lineNum">    1579 </span>                :<span class="lineCov">          1 :   expectedLine &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 10, 0 ) &lt;&lt; QgsPointXY( 10, 10 );</span></a>
<a name="1580"><span class="lineNum">    1580 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( line, expectedLine ) );</span></a>
<a name="1581"><span class="lineNum">    1581 </span>                :            : </a>
<a name="1582"><span class="lineNum">    1582 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiLineString ((0 0, 10 0, 10 10, 20 10),(30 30, 40 30, 40 40, 50 40))&quot; );</span></a>
<a name="1583"><span class="lineNum">    1583 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1584"><span class="lineNum">    1584 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1585"><span class="lineNum">    1585 </span>                :<span class="lineCov">          1 :   QgsMultiPolylineXY multiLine = result.asMultiPolyline();</span></a>
<a name="1586"><span class="lineNum">    1586 </span>                :<span class="lineCov">          1 :   QgsMultiPolylineXY expectedMultiline;</span></a>
<a name="1587"><span class="lineNum">    1587 </span>                :<span class="lineCov">          3 :   expectedMultiline &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="1588"><span class="lineNum">    1588 </span>                :<span class="lineCov">          1 :                          &lt;&lt;  QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 12.5, 10.0 ) &lt;&lt; QgsPointXY( 20.0, 10.0 ) )</span></a>
<a name="1589"><span class="lineNum">    1589 </span>                :<span class="lineCov">          2 :                     &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 30.0, 30.0 ) &lt;&lt; QgsPointXY( 37.5, 30.0 ) &lt;&lt; QgsPointXY( 40.0, 32.5 )</span></a>
<a name="1590"><span class="lineNum">    1590 </span>                :<span class="lineCov">          1 :                          &lt;&lt; QgsPointXY( 40.0, 37.5 ) &lt;&lt; QgsPointXY( 42.5, 40.0 ) &lt;&lt; QgsPointXY( 50.0, 40.0 ) );</span></a>
<a name="1591"><span class="lineNum">    1591 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( multiLine, expectedMultiline ) );</span></a>
<a name="1592"><span class="lineNum">    1592 </span>                :            : </a>
<a name="1593"><span class="lineNum">    1593 </span>                :            :   //polygon</a>
<a name="1594"><span class="lineNum">    1594 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ),(2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="1595"><span class="lineNum">    1595 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1596"><span class="lineNum">    1596 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1597"><span class="lineNum">    1597 </span>                :<span class="lineCov">          1 :   QgsPolygonXY poly = result.asPolygon();</span></a>
<a name="1598"><span class="lineNum">    1598 </span>                :<span class="lineCov">          1 :   QgsPolygonXY expectedPolygon;</span></a>
<a name="1599"><span class="lineNum">    1599 </span>                :<span class="lineCov">          3 :   expectedPolygon &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.5, 0 ) &lt;&lt; QgsPointXY( 7.5, 0 ) &lt;&lt; QgsPointXY( 10.0, 2.5 )</span></a>
<a name="1600"><span class="lineNum">    1600 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPointXY( 10.0, 7.5 ) &lt;&lt; QgsPointXY( 7.5, 10.0 ) &lt;&lt; QgsPointXY( 2.5, 10.0 ) &lt;&lt; QgsPointXY( 0, 7.5 )</span></a>
<a name="1601"><span class="lineNum">    1601 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 0, 2.5 ) &lt;&lt; QgsPointXY( 2.5, 0 ) )</span></a>
<a name="1602"><span class="lineNum">    1602 </span>                :<span class="lineCov">          2 :                   &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.5, 2.0 ) &lt;&lt; QgsPointXY( 3.5, 2.0 ) &lt;&lt; QgsPointXY( 4.0, 2.5 )</span></a>
<a name="1603"><span class="lineNum">    1603 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 4.0, 3.5 ) &lt;&lt; QgsPointXY( 3.5, 4.0 ) &lt;&lt; QgsPointXY( 2.5, 4.0 )</span></a>
<a name="1604"><span class="lineNum">    1604 </span>                :<span class="lineCov">          1 :                        &lt;&lt; QgsPointXY( 2.0, 3.5 ) &lt;&lt; QgsPointXY( 2.0, 2.5 ) &lt;&lt; QgsPointXY( 2.5, 2.0 ) );</span></a>
<a name="1605"><span class="lineNum">    1605 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly, expectedPolygon ) );</span></a>
<a name="1606"><span class="lineNum">    1606 </span>                :            : </a>
<a name="1607"><span class="lineNum">    1607 </span>                :            :   //polygonM</a>
<a name="1608"><span class="lineNum">    1608 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonM ((0 0 1, 10 0 4, 10 10 6, 0 10 8, 0 0 1 ),(2 2 3, 4 2 5, 4 4 7, 2 4 9, 2 2 3))&quot; );</span></a>
<a name="1609"><span class="lineNum">    1609 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1610"><span class="lineNum">    1610 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1611"><span class="lineNum">    1611 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonM ((2.5 0 1.75, 7.5 0 3.25, 10 2.5 4.5, 10 7.5 5.5, 7.5 10 6.5, 2.5 10 7.5, 0 7.5 6.25, 0 2.5 2.75, 2.5 0 1.75),(2.5 2 3.5, 3.5 2 4.5, 4 2.5 5.5, 4 3.5 6.5, 3.5 4 7.5, 2.5 4 8.5, 2 3.5 7.5, 2 2.5 4.5, 2.5 2 3.5))&quot; ) );</span></a>
<a name="1612"><span class="lineNum">    1612 </span>                :            : </a>
<a name="1613"><span class="lineNum">    1613 </span>                :            :   //polygonZ</a>
<a name="1614"><span class="lineNum">    1614 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonZ ((0 0 1, 10 0 4, 10 10 6, 0 10 8, 0 0 1 ),(2 2 3, 4 2 5, 4 4 7, 2 4 9, 2 2 3))&quot; );</span></a>
<a name="1615"><span class="lineNum">    1615 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1616"><span class="lineNum">    1616 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1617"><span class="lineNum">    1617 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonZ ((2.5 0 1.75, 7.5 0 3.25, 10 2.5 4.5, 10 7.5 5.5, 7.5 10 6.5, 2.5 10 7.5, 0 7.5 6.25, 0 2.5 2.75, 2.5 0 1.75),(2.5 2 3.5, 3.5 2 4.5, 4 2.5 5.5, 4 3.5 6.5, 3.5 4 7.5, 2.5 4 8.5, 2 3.5 7.5, 2 2.5 4.5, 2.5 2 3.5))&quot; ) );</span></a>
<a name="1618"><span class="lineNum">    1618 </span>                :            : </a>
<a name="1619"><span class="lineNum">    1619 </span>                :            :   //polygonZM</a>
<a name="1620"><span class="lineNum">    1620 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;PolygonZ ((0 0 1 6, 10 0 4 2, 10 10 6 0, 0 10 8 4, 0 0 1 6 ))&quot; );</span></a>
<a name="1621"><span class="lineNum">    1621 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1622"><span class="lineNum">    1622 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25 );</span></a>
<a name="1623"><span class="lineNum">    1623 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt(), QStringLiteral( &quot;PolygonZM ((2.5 0 1.75 5, 7.5 0 3.25 3, 10 2.5 4.5 1.5, 10 7.5 5.5 0.5, 7.5 10 6.5 1, 2.5 10 7.5 3, 0 7.5 6.25 4.5, 0 2.5 2.75 5.5, 2.5 0 1.75 5))&quot; ) );</span></a>
<a name="1624"><span class="lineNum">    1624 </span>                :            : </a>
<a name="1625"><span class="lineNum">    1625 </span>                :            :   //polygon with max angle - should be unchanged</a>
<a name="1626"><span class="lineNum">    1626 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0))&quot; );</span></a>
<a name="1627"><span class="lineNum">    1627 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1628"><span class="lineNum">    1628 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.25, -1, 50 );</span></a>
<a name="1629"><span class="lineNum">    1629 </span>                :<span class="lineCov">          1 :   poly = result.asPolygon();</span></a>
<a name="1630"><span class="lineNum">    1630 </span>                :<span class="lineCov">          1 :   expectedPolygon.clear();</span></a>
<a name="1631"><span class="lineNum">    1631 </span>                :<span class="lineCov">          2 :   expectedPolygon &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 0, 0 ) &lt;&lt; QgsPointXY( 10, 0 ) &lt;&lt; QgsPointXY( 10.0, 10 )</span></a>
<a name="1632"><span class="lineNum">    1632 </span>                :<span class="lineCov">          1 :                        &lt;&lt;  QgsPointXY( 0, 10 ) &lt;&lt; QgsPointXY( 0, 0 ) );</span></a>
<a name="1633"><span class="lineNum">    1633 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( poly, expectedPolygon ) );</span></a>
<a name="1634"><span class="lineNum">    1634 </span>                :            : </a>
<a name="1635"><span class="lineNum">    1635 </span>                :            :   //multipolygon)</a>
<a name="1636"><span class="lineNum">    1636 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; );</span></a>
<a name="1637"><span class="lineNum">    1637 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1638"><span class="lineNum">    1638 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 1, 0.1 );</span></a>
<a name="1639"><span class="lineNum">    1639 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY multipoly = result.asMultiPolygon();</span></a>
<a name="1640"><span class="lineNum">    1640 </span>                :<span class="lineCov">          1 :   QgsMultiPolygonXY expectedMultiPoly;</span></a>
<a name="1641"><span class="lineNum">    1641 </span>                :<span class="lineCov">          1 :   expectedMultiPoly</span></a>
<a name="1642"><span class="lineNum">    1642 </span>                :<span class="lineCov">          2 :       &lt;&lt; ( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 1.0, 0 ) &lt;&lt; QgsPointXY( 9, 0 ) &lt;&lt; QgsPointXY( 10.0, 1 )</span></a>
<a name="1643"><span class="lineNum">    1643 </span>                :<span class="lineCov">          1 :                                &lt;&lt;  QgsPointXY( 10.0, 9 ) &lt;&lt; QgsPointXY( 9, 10.0 ) &lt;&lt; QgsPointXY( 1, 10.0 ) &lt;&lt; QgsPointXY( 0, 9 )</span></a>
<a name="1644"><span class="lineNum">    1644 </span>                :<span class="lineCov">          1 :                                &lt;&lt; QgsPointXY( 0, 1 ) &lt;&lt; QgsPointXY( 1, 0 ) ) )</span></a>
<a name="1645"><span class="lineNum">    1645 </span>                :<span class="lineCov">          2 :       &lt;&lt; ( QgsPolygonXY() &lt;&lt; ( QgsPolylineXY() &lt;&lt; QgsPointXY( 2.2, 2.0 ) &lt;&lt; QgsPointXY( 3.8, 2.0 ) &lt;&lt; QgsPointXY( 4.0, 2.2 )</span></a>
<a name="1646"><span class="lineNum">    1646 </span>                :<span class="lineCov">          1 :                                &lt;&lt;  QgsPointXY( 4.0, 3.8 ) &lt;&lt; QgsPointXY( 3.8, 4.0 ) &lt;&lt; QgsPointXY( 2.2, 4.0 ) &lt;&lt; QgsPointXY( 2.0, 3.8 )</span></a>
<a name="1647"><span class="lineNum">    1647 </span>                :<span class="lineCov">          1 :                                &lt;&lt; QgsPointXY( 2, 2.2 ) &lt;&lt; QgsPointXY( 2.2, 2 ) ) );</span></a>
<a name="1648"><span class="lineNum">    1648 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry::compare( multipoly, expectedMultiPoly ) );</span></a>
<a name="1649"><span class="lineNum">    1649 </span>                :            : </a>
<a name="1650"><span class="lineNum">    1650 </span>                :            :   // curved geometry</a>
<a name="1651"><span class="lineNum">    1651 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;CurvePolygon (CompoundCurve (CircularString (-70.75639028391421448 42.11076979194393743, -70.75300889449444242 42.10738840252416537, -70.75639028391421448 42.10400701310439331, -70.75977167333398654 42.10738840252416537, -70.75639028391421448 42.11076979194393743)))        1&quot; );</span></a>
<a name="1652"><span class="lineNum">    1652 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1653"><span class="lineNum">    1653 </span>                :<span class="lineCov">          1 :   result = geom.smooth( 3 );</span></a>
<a name="1654"><span class="lineNum">    1654 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.wkbType(), QgsWkbTypes::Polygon );</span></a>
<a name="1655"><span class="lineNum">    1655 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1656"><span class="lineNum">    1656 </span>                :            : </a>
<a name="1657"><span class="lineNum">    1657 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::shortestLineEmptyGeometry()</span></a>
<a name="1658"><span class="lineNum">    1658 </span>                :            : {</a>
<a name="1659"><span class="lineNum">    1659 </span>                :            :   // test calculating distance to an empty geometry</a>
<a name="1660"><span class="lineNum">    1660 </span>                :            :   // refs https://github.com/qgis/QGIS/issues/41968</a>
<a name="1661"><span class="lineNum">    1661 </span>                :<span class="lineCov">          2 :   QgsGeometry geom1( QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ))&quot; ) ) );</span></a>
<a name="1662"><span class="lineNum">    1662 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2( new QgsPoint() );</span></a>
<a name="1663"><span class="lineNum">    1663 </span>                :<span class="lineCov">          1 :   QgsGeos geos( geom1.constGet() );</span></a>
<a name="1664"><span class="lineNum">    1664 </span>                :<span class="lineCov">          1 :   QVERIFY( geos.shortestLine( geom2.constGet() ).isNull() );</span></a>
<a name="1665"><span class="lineNum">    1665 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1666"><span class="lineNum">    1666 </span>                :            : </a>
<a name="1667"><span class="lineNum">    1667 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::unaryUnion()</span></a>
<a name="1668"><span class="lineNum">    1668 </span>                :            : {</a>
<a name="1669"><span class="lineNum">    1669 </span>                :            :   //test QgsGeometry::unaryUnion with null geometry</a>
<a name="1670"><span class="lineNum">    1670 </span>                :<span class="lineCov">          2 :   QString wkt1 = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ))&quot; );</span></a>
<a name="1671"><span class="lineNum">    1671 </span>                :<span class="lineCov">          2 :   QString wkt2 = QStringLiteral( &quot;Polygon ((2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="1672"><span class="lineNum">    1672 </span>                :<span class="lineCov">          1 :   QgsGeometry geom1( QgsGeometry::fromWkt( wkt1 ) );</span></a>
<a name="1673"><span class="lineNum">    1673 </span>                :<span class="lineCov">          1 :   QgsGeometry geom2( QgsGeometry::fromWkt( wkt2 ) );</span></a>
<a name="1674"><span class="lineNum">    1674 </span>                :<span class="lineCov">          1 :   QgsGeometry empty;</span></a>
<a name="1675"><span class="lineNum">    1675 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsGeometry &gt; list;</span></a>
<a name="1676"><span class="lineNum">    1676 </span>                :<span class="lineCov">          1 :   list &lt;&lt; geom1 &lt;&lt; empty &lt;&lt; geom2;</span></a>
<a name="1677"><span class="lineNum">    1677 </span>                :            : </a>
<a name="1678"><span class="lineNum">    1678 </span>                :<span class="lineCov">          1 :   QgsGeometry result( QgsGeometry::unaryUnion( list ) );</span></a>
<a name="1679"><span class="lineNum">    1679 </span>                :            :   Q_UNUSED( result );</a>
<a name="1680"><span class="lineNum">    1680 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1681"><span class="lineNum">    1681 </span>                :            : </a>
<a name="1682"><span class="lineNum">    1682 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::dataStream()</span></a>
<a name="1683"><span class="lineNum">    1683 </span>                :            : {</a>
<a name="1684"><span class="lineNum">    1684 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="1685"><span class="lineNum">    1685 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="1686"><span class="lineNum">    1686 </span>                :            : </a>
<a name="1687"><span class="lineNum">    1687 </span>                :<span class="lineCov">          1 :   QByteArray ba;</span></a>
<a name="1688"><span class="lineNum">    1688 </span>                :<span class="lineCov">          1 :   QDataStream ds( &amp;ba, QIODevice::ReadWrite );</span></a>
<a name="1689"><span class="lineNum">    1689 </span>                :<span class="lineCov">          1 :   ds &lt;&lt; geom;</span></a>
<a name="1690"><span class="lineNum">    1690 </span>                :            : </a>
<a name="1691"><span class="lineNum">    1691 </span>                :<span class="lineCov">          1 :   QgsGeometry resultGeometry;</span></a>
<a name="1692"><span class="lineNum">    1692 </span>                :<span class="lineCov">          1 :   ds.device()-&gt;seek( 0 );</span></a>
<a name="1693"><span class="lineNum">    1693 </span>                :<span class="lineCov">          1 :   ds &gt;&gt; resultGeometry;</span></a>
<a name="1694"><span class="lineNum">    1694 </span>                :            : </a>
<a name="1695"><span class="lineNum">    1695 </span>                :<span class="lineCov">          1 :   QCOMPARE( geom.constGet()-&gt;asWkt(), resultGeometry.constGet()-&gt;asWkt() );</span></a>
<a name="1696"><span class="lineNum">    1696 </span>                :            : </a>
<a name="1697"><span class="lineNum">    1697 </span>                :            :   //also test with geometry without data</a>
<a name="1698"><span class="lineNum">    1698 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt;QgsGeometry&gt; emptyGeom( new QgsGeometry() );</span></a>
<a name="1699"><span class="lineNum">    1699 </span>                :            : </a>
<a name="1700"><span class="lineNum">    1700 </span>                :<span class="lineCov">          1 :   QByteArray ba2;</span></a>
<a name="1701"><span class="lineNum">    1701 </span>                :<span class="lineCov">          1 :   QDataStream ds2( &amp;ba2, QIODevice::ReadWrite );</span></a>
<a name="1702"><span class="lineNum">    1702 </span>                :<span class="lineCov">          1 :   ds2 &lt;&lt; emptyGeom.get();</span></a>
<a name="1703"><span class="lineNum">    1703 </span>                :            : </a>
<a name="1704"><span class="lineNum">    1704 </span>                :<span class="lineCov">          1 :   ds2.device()-&gt;seek( 0 );</span></a>
<a name="1705"><span class="lineNum">    1705 </span>                :<span class="lineCov">          1 :   ds2 &gt;&gt; resultGeometry;</span></a>
<a name="1706"><span class="lineNum">    1706 </span>                :            : </a>
<a name="1707"><span class="lineNum">    1707 </span>                :<span class="lineCov">          1 :   QVERIFY( resultGeometry.isNull() );</span></a>
<a name="1708"><span class="lineNum">    1708 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1709"><span class="lineNum">    1709 </span>                :            : </a>
<a name="1710"><span class="lineNum">    1710 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::exportToGeoJSON()</span></a>
<a name="1711"><span class="lineNum">    1711 </span>                :            : {</a>
<a name="1712"><span class="lineNum">    1712 </span>                :            :   //Point</a>
<a name="1713"><span class="lineNum">    1713 </span>                :<span class="lineCov">          2 :   QString wkt = QStringLiteral( &quot;Point (40 50)&quot; );</span></a>
<a name="1714"><span class="lineNum">    1714 </span>                :<span class="lineCov">          1 :   QgsGeometry geom( QgsGeometry::fromWkt( wkt ) );</span></a>
<a name="1715"><span class="lineNum">    1715 </span>                :<span class="lineCov">          1 :   QString obtained = geom.asJson();</span></a>
<a name="1716"><span class="lineNum">    1716 </span>                :<span class="lineCov">          2 :   QString geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[40.0,50.0],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; );</span></a>
<a name="1717"><span class="lineNum">    1717 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1718"><span class="lineNum">    1718 </span>                :            : </a>
<a name="1719"><span class="lineNum">    1719 </span>                :            :   //MultiPoint</a>
<a name="1720"><span class="lineNum">    1720 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPoint (0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="1721"><span class="lineNum">    1721 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1722"><span class="lineNum">    1722 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="1723"><span class="lineNum">    1723 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="1724"><span class="lineNum">    1724 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1725"><span class="lineNum">    1725 </span>                :            : </a>
<a name="1726"><span class="lineNum">    1726 </span>                :            :   //Linestring</a>
<a name="1727"><span class="lineNum">    1727 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;LineString(0 0, 10 0, 10 10, 20 10)&quot; );</span></a>
<a name="1728"><span class="lineNum">    1728 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1729"><span class="lineNum">    1729 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="1730"><span class="lineNum">    1730 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="1731"><span class="lineNum">    1731 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1732"><span class="lineNum">    1732 </span>                :            : </a>
<a name="1733"><span class="lineNum">    1733 </span>                :            :   //MultiLineString</a>
<a name="1734"><span class="lineNum">    1734 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiLineString ((0 0, 10 0, 10 10, 20 10),(30 30, 40 30, 40 40, 50 40))&quot; );</span></a>
<a name="1735"><span class="lineNum">    1735 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1736"><span class="lineNum">    1736 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="1737"><span class="lineNum">    1737 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[20.0,10.0]],[[30.0,30.0],[40.0,30.0],[40.0,40.0],[50.0,40.0]]],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="1738"><span class="lineNum">    1738 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1739"><span class="lineNum">    1739 </span>                :            : </a>
<a name="1740"><span class="lineNum">    1740 </span>                :            :   //Polygon</a>
<a name="1741"><span class="lineNum">    1741 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;Polygon ((0 0, 10 0, 10 10, 0 10, 0 0 ),(2 2, 4 2, 4 4, 2 4, 2 2))&quot; );</span></a>
<a name="1742"><span class="lineNum">    1742 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1743"><span class="lineNum">    1743 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="1744"><span class="lineNum">    1744 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[0.0,10.0],[0.0,0.0]],[[2.0,2.0],[4.0,2.0],[4.0,4.0],[2.0,4.0],[2.0,2.0]]],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="1745"><span class="lineNum">    1745 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1746"><span class="lineNum">    1746 </span>                :            : </a>
<a name="1747"><span class="lineNum">    1747 </span>                :            :   //MultiPolygon</a>
<a name="1748"><span class="lineNum">    1748 </span>                :<span class="lineCov">          2 :   wkt = QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0 )),((2 2, 4 2, 4 4, 2 4, 2 2)))&quot; );</span></a>
<a name="1749"><span class="lineNum">    1749 </span>                :<span class="lineCov">          1 :   geom = QgsGeometry::fromWkt( wkt );</span></a>
<a name="1750"><span class="lineNum">    1750 </span>                :<span class="lineCov">          1 :   obtained = geom.asJson();</span></a>
<a name="1751"><span class="lineNum">    1751 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[[[[0.0,0.0],[10.0,0.0],[10.0,10.0],[0.0,10.0],[0.0,0.0]]],[[[2.0,2.0],[4.0,2.0],[4.0,4.0],[2.0,4.0],[2.0,2.0]]]],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="1752"><span class="lineNum">    1752 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1753"><span class="lineNum">    1753 </span>                :            : </a>
<a name="1754"><span class="lineNum">    1754 </span>                :            :   // no geometry</a>
<a name="1755"><span class="lineNum">    1755 </span>                :<span class="lineCov">          1 :   QgsGeometry nullGeom( nullptr );</span></a>
<a name="1756"><span class="lineNum">    1756 </span>                :<span class="lineCov">          1 :   obtained = nullGeom.asJson();</span></a>
<a name="1757"><span class="lineNum">    1757 </span>                :<span class="lineCov">          2 :   geojson = QStringLiteral( &quot;null&quot; );</span></a>
<a name="1758"><span class="lineNum">    1758 </span>                :<span class="lineCov">          1 :   QCOMPARE( obtained, geojson );</span></a>
<a name="1759"><span class="lineNum">    1759 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1760"><span class="lineNum">    1760 </span>                :            : </a>
<a name="1761"><span class="lineNum">    1761 </span>                :<span class="lineCov">          6 : bool TestQgsGeometry::renderCheck( const QString &amp;testName, const QString &amp;comment, int mismatchCount )</span></a>
<a name="1762"><span class="lineNum">    1762 </span>                :            : {</a>
<a name="1763"><span class="lineNum">    1763 </span>                :<span class="lineCov">          6 :   mReport += &quot;&lt;h2&gt;&quot; + testName + &quot;&lt;/h2&gt;\n&quot;;</span></a>
<a name="1764"><span class="lineNum">    1764 </span>                :<span class="lineCov">          6 :   mReport += &quot;&lt;h3&gt;&quot; + comment + &quot;&lt;/h3&gt;\n&quot;;</span></a>
<a name="1765"><span class="lineNum">    1765 </span>                :<span class="lineCov">          6 :   QString myTmpDir = QDir::tempPath() + '/';</span></a>
<a name="1766"><span class="lineNum">    1766 </span>                :<span class="lineCov">          6 :   QString myFileName = myTmpDir + testName + &quot;.png&quot;;</span></a>
<a name="1767"><span class="lineNum">    1767 </span>                :<span class="lineCov">          6 :   mImage.save( myFileName, &quot;PNG&quot; );</span></a>
<a name="1768"><span class="lineNum">    1768 </span>                :<span class="lineCov">          6 :   QgsRenderChecker myChecker;</span></a>
<a name="1769"><span class="lineNum">    1769 </span>                :<span class="lineCov">          6 :   myChecker.setControlName( &quot;expected_&quot; + testName );</span></a>
<a name="1770"><span class="lineNum">    1770 </span>                :<span class="lineCov">          6 :   myChecker.setRenderedImage( myFileName );</span></a>
<a name="1771"><span class="lineNum">    1771 </span>                :<span class="lineCov">          6 :   bool myResultFlag = myChecker.compareImages( testName, mismatchCount );</span></a>
<a name="1772"><span class="lineNum">    1772 </span>                :<span class="lineCov">          6 :   mReport += myChecker.report();</span></a>
<a name="1773"><span class="lineNum">    1773 </span>                :<span class="lineCov">          6 :   return myResultFlag;</span></a>
<a name="1774"><span class="lineNum">    1774 </span>                :<span class="lineCov">          6 : }</span></a>
<a name="1775"><span class="lineNum">    1775 </span>                :            : </a>
<a name="1776"><span class="lineNum">    1776 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon )</span></a>
<a name="1777"><span class="lineNum">    1777 </span>                :            : {</a>
<a name="1778"><span class="lineNum">    1778 </span>                :<span class="lineNoCov">          0 :   qDebug( &quot;Multipolygon Geometry Dump&quot; );</span></a>
<a name="1779"><span class="lineNum">    1779 </span>                :<span class="lineNoCov">          0 :   for ( int i = 0; i &lt; multiPolygon.size(); i++ )</span></a>
<a name="1780"><span class="lineNum">    1780 </span>                :            :   {</a>
<a name="1781"><span class="lineNum">    1781 </span>                :<span class="lineNoCov">          0 :     QgsPolygonXY myPolygon = multiPolygon.at( i );</span></a>
<a name="1782"><span class="lineNum">    1782 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\tPolygon in multipolygon: %d&quot;, i );</span></a>
<a name="1783"><span class="lineNum">    1783 </span>                :<span class="lineNoCov">          0 :     dumpPolygon( myPolygon );</span></a>
<a name="1784"><span class="lineNum">    1784 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="1785"><span class="lineNum">    1785 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="1786"><span class="lineNum">    1786 </span>                :            : </a>
<a name="1787"><span class="lineNum">    1787 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::paintMultiPolygon( QgsMultiPolygonXY &amp;multiPolygon )</span></a>
<a name="1788"><span class="lineNum">    1788 </span>                :            : {</a>
<a name="1789"><span class="lineNum">    1789 </span>                :<span class="lineCov">          3 :   for ( int i = 0; i &lt; multiPolygon.size(); i++ )</span></a>
<a name="1790"><span class="lineNum">    1790 </span>                :            :   {</a>
<a name="1791"><span class="lineNum">    1791 </span>                :<span class="lineCov">          2 :     QgsPolygonXY myPolygon = multiPolygon.at( i );</span></a>
<a name="1792"><span class="lineNum">    1792 </span>                :<span class="lineCov">          2 :     paintPolygon( myPolygon );</span></a>
<a name="1793"><span class="lineNum">    1793 </span>                :<span class="lineCov">          2 :   }</span></a>
<a name="1794"><span class="lineNum">    1794 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1795"><span class="lineNum">    1795 </span>                :            : </a>
<a name="1796"><span class="lineNum">    1796 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpPolygon( QgsPolygonXY &amp;polygon )</span></a>
<a name="1797"><span class="lineNum">    1797 </span>                :            : {</a>
<a name="1798"><span class="lineNum">    1798 </span>                :<span class="lineNoCov">          0 :   for ( int j = 0; j &lt; polygon.size(); j++ )</span></a>
<a name="1799"><span class="lineNum">    1799 </span>                :            :   {</a>
<a name="1800"><span class="lineNum">    1800 </span>                :<span class="lineNoCov">          0 :     const QgsPolylineXY &amp;myPolyline = polygon.at( j ); //rings of polygon</span></a>
<a name="1801"><span class="lineNum">    1801 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\t\tRing in polygon: %d&quot;, j );</span></a>
<a name="1802"><span class="lineNum">    1802 </span>                :            : </a>
<a name="1803"><span class="lineNum">    1803 </span>                :<span class="lineNoCov">          0 :     for ( int k = 0; k &lt; myPolyline.size(); k++ )</span></a>
<a name="1804"><span class="lineNum">    1804 </span>                :            :     {</a>
<a name="1805"><span class="lineNum">    1805 </span>                :<span class="lineNoCov">          0 :       const QgsPointXY &amp;myPoint = myPolyline.at( k );</span></a>
<a name="1806"><span class="lineNum">    1806 </span>                :<span class="lineNoCov">          0 :       qDebug( &quot;\t\t\tPoint in ring %d : %s&quot;, k, myPoint.toString().toLocal8Bit().constData() );</span></a>
<a name="1807"><span class="lineNum">    1807 </span>                :<span class="lineNoCov">          0 :     }</span></a>
<a name="1808"><span class="lineNum">    1808 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="1809"><span class="lineNum">    1809 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="1810"><span class="lineNum">    1810 </span>                :            : </a>
<a name="1811"><span class="lineNum">    1811 </span>                :<span class="lineCov">         25 : void TestQgsGeometry::paintPolygon( QgsPolygonXY &amp;polygon )</span></a>
<a name="1812"><span class="lineNum">    1812 </span>                :            : {</a>
<a name="1813"><span class="lineNum">    1813 </span>                :<span class="lineCov">         25 :   QVector&lt;QPointF&gt; myPoints;</span></a>
<a name="1814"><span class="lineNum">    1814 </span>                :<span class="lineCov">         50 :   for ( int j = 0; j &lt; polygon.size(); j++ )</span></a>
<a name="1815"><span class="lineNum">    1815 </span>                :            :   {</a>
<a name="1816"><span class="lineNum">    1816 </span>                :<span class="lineCov">         25 :     const QgsPolylineXY &amp;myPolyline = polygon.at( j ); //rings of polygon</span></a>
<a name="1817"><span class="lineNum">    1817 </span>                :<span class="lineCov">        196 :     for ( int k = 0; k &lt; myPolyline.size(); k++ )</span></a>
<a name="1818"><span class="lineNum">    1818 </span>                :            :     {</a>
<a name="1819"><span class="lineNum">    1819 </span>                :<span class="lineCov">        171 :       const QgsPointXY &amp;myPoint = myPolyline.at( k );</span></a>
<a name="1820"><span class="lineNum">    1820 </span>                :<span class="lineCov">        171 :       myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</span></a>
<a name="1821"><span class="lineNum">    1821 </span>                :<span class="lineCov">        171 :     }</span></a>
<a name="1822"><span class="lineNum">    1822 </span>                :<span class="lineCov">         25 :   }</span></a>
<a name="1823"><span class="lineNum">    1823 </span>                :<span class="lineCov">         25 :   mpPainter-&gt;drawPolygon( myPoints );</span></a>
<a name="1824"><span class="lineNum">    1824 </span>                :<span class="lineCov">         25 : }</span></a>
<a name="1825"><span class="lineNum">    1825 </span>                :            : </a>
<a name="1826"><span class="lineNum">    1826 </span>                :<span class="lineNoCov">          0 : void TestQgsGeometry::dumpPolyline( QgsPolylineXY &amp;polyline )</span></a>
<a name="1827"><span class="lineNum">    1827 </span>                :            : {</a>
<a name="1828"><span class="lineNum">    1828 </span>                :<span class="lineNoCov">          0 :   QVector&lt;QPointF&gt; myPoints;</span></a>
<a name="1829"><span class="lineNum">    1829 </span>                :            : //  QgsPolyline myPolyline = polyline.at( j ); //rings of polygon</a>
<a name="1830"><span class="lineNum">    1830 </span>                :<span class="lineNoCov">          0 :   for ( int j = 0; j &lt; polyline.size(); j++ )</span></a>
<a name="1831"><span class="lineNum">    1831 </span>                :            :   {</a>
<a name="1832"><span class="lineNum">    1832 </span>                :<span class="lineNoCov">          0 :     const QgsPointXY &amp;myPoint = polyline.at( j );</span></a>
<a name="1833"><span class="lineNum">    1833 </span>                :            : //    QgsPolyline myPolyline = polygon.at( j ); //rings of polygon</a>
<a name="1834"><span class="lineNum">    1834 </span>                :<span class="lineNoCov">          0 :     myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</span></a>
<a name="1835"><span class="lineNum">    1835 </span>                :<span class="lineNoCov">          0 :     qDebug( &quot;\t\tPoint in line: %d&quot;, j );</span></a>
<a name="1836"><span class="lineNum">    1836 </span>                :            : </a>
<a name="1837"><span class="lineNum">    1837 </span>                :            : //    for ( int k = 0; k &lt; myPolyline.size(); k++ )</a>
<a name="1838"><span class="lineNum">    1838 </span>                :            : //    {</a>
<a name="1839"><span class="lineNum">    1839 </span>                :            : //      QgsPointXY myPoint = myPolyline.at( k );</a>
<a name="1840"><span class="lineNum">    1840 </span>                :            : //      qDebug( &quot;\t\t\tPoint in ring %d : %s&quot;, k, myPoint.toString().toLocal8Bit().constData() );</a>
<a name="1841"><span class="lineNum">    1841 </span>                :            : //      myPoints &lt;&lt; QPointF( myPoint.x(), myPoint.y() );</a>
<a name="1842"><span class="lineNum">    1842 </span>                :            : //    }</a>
<a name="1843"><span class="lineNum">    1843 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="1844"><span class="lineNum">    1844 </span>                :<span class="lineNoCov">          0 :   mpPainter-&gt;drawPolyline( myPoints );</span></a>
<a name="1845"><span class="lineNum">    1845 </span>                :<span class="lineNoCov">          0 : }</span></a>
<a name="1846"><span class="lineNum">    1846 </span>                :            : </a>
<a name="1847"><span class="lineNum">    1847 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::wkbInOut()</span></a>
<a name="1848"><span class="lineNum">    1848 </span>                :            : {</a>
<a name="1849"><span class="lineNum">    1849 </span>                :            :   // Premature end of WKB</a>
<a name="1850"><span class="lineNum">    1850 </span>                :            :   // See https://github.com/qgis/QGIS/issues/22184</a>
<a name="1851"><span class="lineNum">    1851 </span>                :<span class="lineCov">          1 :   const char *hexwkb = &quot;0102000000EF0000000000000000000000000000000000000000000000000000000000000000000000&quot;;</span></a>
<a name="1852"><span class="lineNum">    1852 </span>                :            :   int size;</a>
<a name="1853"><span class="lineNum">    1853 </span>                :<span class="lineCov">          1 :   unsigned char *wkb = hex2bytes( hexwkb, &amp;size );</span></a>
<a name="1854"><span class="lineNum">    1854 </span>                :<span class="lineCov">          1 :   QgsGeometry g14182;</span></a>
<a name="1855"><span class="lineNum">    1855 </span>                :            :   // NOTE: wkb onwership transferred to QgsGeometry</a>
<a name="1856"><span class="lineNum">    1856 </span>                :<span class="lineCov">          1 :   g14182.fromWkb( wkb, size );</span></a>
<a name="1857"><span class="lineNum">    1857 </span>                :            :   //QList&lt;QgsGeometry::Error&gt; errors;</a>
<a name="1858"><span class="lineNum">    1858 </span>                :            :   //g14182.validateGeometry(errors);</a>
<a name="1859"><span class="lineNum">    1859 </span>                :            :   // Check with valgrind !</a>
<a name="1860"><span class="lineNum">    1860 </span>                :<span class="lineCov">          1 :   QString wkt = g14182.asWkt();</span></a>
<a name="1861"><span class="lineNum">    1861 </span>                :<span class="lineCov">          1 :   QCOMPARE( wkt, QString() );</span></a>
<a name="1862"><span class="lineNum">    1862 </span>                :            : </a>
<a name="1863"><span class="lineNum">    1863 </span>                :            :   //WKB with a truncated header</a>
<a name="1864"><span class="lineNum">    1864 </span>                :<span class="lineCov">          1 :   const char *badHeaderHexwkb = &quot;0102&quot;;</span></a>
<a name="1865"><span class="lineNum">    1865 </span>                :<span class="lineCov">          1 :   wkb = hex2bytes( badHeaderHexwkb, &amp;size );</span></a>
<a name="1866"><span class="lineNum">    1866 </span>                :<span class="lineCov">          1 :   QgsGeometry badHeader;</span></a>
<a name="1867"><span class="lineNum">    1867 </span>                :            :   // NOTE: wkb onwership transferred to QgsGeometry</a>
<a name="1868"><span class="lineNum">    1868 </span>                :<span class="lineCov">          1 :   badHeader.fromWkb( wkb, size );</span></a>
<a name="1869"><span class="lineNum">    1869 </span>                :<span class="lineCov">          1 :   QVERIFY( badHeader.isNull() );</span></a>
<a name="1870"><span class="lineNum">    1870 </span>                :<span class="lineCov">          1 :   QCOMPARE( badHeader.wkbType(), QgsWkbTypes::Unknown );</span></a>
<a name="1871"><span class="lineNum">    1871 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1872"><span class="lineNum">    1872 </span>                :            : </a>
<a name="1873"><span class="lineNum">    1873 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::directionNeutralSegmentation()</span></a>
<a name="1874"><span class="lineNum">    1874 </span>                :            : {</a>
<a name="1875"><span class="lineNum">    1875 </span>                :            :   //Tests, if segmentation of a circularstring is the same in both directions</a>
<a name="1876"><span class="lineNum">    1876 </span>                :<span class="lineCov">          2 :   QString CWCircularStringWkt( QStringLiteral( &quot;CIRCULARSTRING( 0 0, 0.5 0.5, 0.83 7.33 )&quot; ) );</span></a>
<a name="1877"><span class="lineNum">    1877 </span>                :<span class="lineCov">          1 :   QgsCircularString *CWCircularString = static_cast&lt;QgsCircularString *&gt;( QgsGeometryFactory::geomFromWkt( CWCircularStringWkt ).release() );</span></a>
<a name="1878"><span class="lineNum">    1878 </span>                :<span class="lineCov">          1 :   QgsLineString *CWLineString = CWCircularString-&gt;curveToLine();</span></a>
<a name="1879"><span class="lineNum">    1879 </span>                :            : </a>
<a name="1880"><span class="lineNum">    1880 </span>                :<span class="lineCov">          2 :   QString CCWCircularStringWkt( QStringLiteral( &quot;CIRCULARSTRING( 0.83 7.33, 0.5 0.5, 0 0 )&quot; ) );</span></a>
<a name="1881"><span class="lineNum">    1881 </span>                :<span class="lineCov">          1 :   QgsCircularString *CCWCircularString = static_cast&lt;QgsCircularString *&gt;( QgsGeometryFactory::geomFromWkt( CCWCircularStringWkt ).release() );</span></a>
<a name="1882"><span class="lineNum">    1882 </span>                :<span class="lineCov">          1 :   QgsLineString *CCWLineString = CCWCircularString-&gt;curveToLine();</span></a>
<a name="1883"><span class="lineNum">    1883 </span>                :<span class="lineCov">          1 :   QgsLineString *reversedCCWLineString = CCWLineString-&gt;reversed();</span></a>
<a name="1884"><span class="lineNum">    1884 </span>                :            : </a>
<a name="1885"><span class="lineNum">    1885 </span>                :<span class="lineCov">          1 :   QCOMPARE( CWLineString-&gt;asWkt(), reversedCCWLineString-&gt;asWkt() );</span></a>
<a name="1886"><span class="lineNum">    1886 </span>                :<span class="lineCov">          1 :   bool equal = ( *CWLineString == *reversedCCWLineString );</span></a>
<a name="1887"><span class="lineNum">    1887 </span>                :            : </a>
<a name="1888"><span class="lineNum">    1888 </span>                :<span class="lineCov">          1 :   delete CWCircularString;</span></a>
<a name="1889"><span class="lineNum">    1889 </span>                :<span class="lineCov">          1 :   delete CCWCircularString;</span></a>
<a name="1890"><span class="lineNum">    1890 </span>                :<span class="lineCov">          1 :   delete CWLineString;</span></a>
<a name="1891"><span class="lineNum">    1891 </span>                :<span class="lineCov">          1 :   delete CCWLineString;</span></a>
<a name="1892"><span class="lineNum">    1892 </span>                :<span class="lineCov">          1 :   delete reversedCCWLineString;</span></a>
<a name="1893"><span class="lineNum">    1893 </span>                :            : </a>
<a name="1894"><span class="lineNum">    1894 </span>                :<span class="lineCov">          1 :   QVERIFY( equal );</span></a>
<a name="1895"><span class="lineNum">    1895 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="1896"><span class="lineNum">    1896 </span>                :            : </a>
<a name="1897"><span class="lineNum">    1897 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::poleOfInaccessibility()</span></a>
<a name="1898"><span class="lineNum">    1898 </span>                :            : {</a>
<a name="1899"><span class="lineNum">    1899 </span>                :<span class="lineCov">          1 :   QString poly1Wkt( &quot;Polygon ((3116 3071, 3394 3431, 3563 3362, 3611 3205, 3599 3181, 3477 3281, 3449 3160, 3570 3127, 3354 3116,&quot;</span></a>
<a name="1900"><span class="lineNum">    1900 </span>                :            :                     &quot; 3436 3008, 3158 2907, 2831 2438, 3269 2916, 3438 2885, 3295 2799, 3407 2772, 3278 2629, 3411 2689, 3329 2611,&quot;</a>
<a name="1901"><span class="lineNum">    1901 </span>                :            :                     &quot; 3360 2531, 3603 2800, 3598 2501, 3317 2429, 3329 2401, 3170 2340, 3142 2291, 3524 2403, 3598 2233, 3460 2117,&quot;</a>
<a name="1902"><span class="lineNum">    1902 </span>                :            :                     &quot; 3590 1931, 3364 1753, 3597 1875, 3639 1835, 3660 1733, 3600 1771, 3538 1694, 3661 1732, 3359 1554, 3334 1554,&quot;</a>
<a name="1903"><span class="lineNum">    1903 </span>                :            :                     &quot; 3341 1588, 3317 1588, 3305 1644, 3286 1656, 3115 1255, 3072 1252, 3078 1335, 3046 1355, 2984 1234, 2983 1409,&quot;</a>
<a name="1904"><span class="lineNum">    1904 </span>                :            :                     &quot; 2876 1222, 2525 1161, 2488 787, 2162 913, 2079 661, 2270 380, 2188 823, 2510 592, 2659 992, 2911 1118, 2943 938,&quot;</a>
<a name="1905"><span class="lineNum">    1905 </span>                :            :                     &quot; 2957 1097, 3092 1002, 3006 1097, 3233 1282, 3325 1291, 3296 1116, 3333 1115, 3391 1333, 3434 1274, 3413 1326,&quot;</a>
<a name="1906"><span class="lineNum">    1906 </span>                :            :                     &quot; 3449 1327, 3473 1408, 3490 1430, 3526 1434, 3198 -112, 3263 -87, 3289 -128, 4224 -128, 4224 -128, 3474 -128,&quot;</a>
<a name="1907"><span class="lineNum">    1907 </span>                :            :                     &quot; 3475 -116, 3486 -120, 3458 -49, 3523 -78, 3513 -128, 3509 -119, 3509 -128, 3717 -128, 3705 -60, 3735 -16,&quot;</a>
<a name="1908"><span class="lineNum">    1908 </span>                :            :                     &quot; 3714 38, 3758 88, 3825 47, 3812 -11, 3859 -51, 3871 49, 3760 149, 3636 -74, 3510 126, 3501 245, 3504 270,&quot;</a>
<a name="1909"><span class="lineNum">    1909 </span>                :            :                     &quot; 3511 284, 3582 16, 3631 19, 3569 125, 3570 193, 3610 212, 3583 119, 3655 29, 3738 170, 3561 466, 3826 549,&quot;</a>
<a name="1910"><span class="lineNum">    1910 </span>                :            :                     &quot; 3527 604, 3609 833, 3681 798, 3956 1127, 3917 964, 4043 850, 4049 1096, 4193 1052, 4191 1078, 4208 1106,&quot;</a>
<a name="1911"><span class="lineNum">    1911 </span>                :            :                     &quot; 4222 1110, 4224 1109, 4224 1144, 4202 1158, 4177 1161, 4182 1181, 4075 1201, 4141 1275, 4215 1215, 4221 1223,&quot;</a>
<a name="1912"><span class="lineNum">    1912 </span>                :            :                     &quot; 4219 1231, 4224 1243, 4224 1257, 4224 1262, 4224 1345, 4224 1339, 4224 1328, 4215 1335, 4203 1355, 4215 1369,&quot;</a>
<a name="1913"><span class="lineNum">    1913 </span>                :            :                     &quot; 4224 1363, 4215 1377, 4208 1387, 4217 1401, 4224 1403, 4224 1520, 4219 1535, 4221 1544, 4199 1593, 4223 1595,&quot;</a>
<a name="1914"><span class="lineNum">    1914 </span>                :            :                     &quot; 4206 1626, 4214 1648, 4224 1645, 4224 1640, 4224 2108, 4220 2125, 4224 2125, 4224 2143, 4205 2141, 4180 2159,&quot;</a>
<a name="1915"><span class="lineNum">    1915 </span>                :            :                     &quot; 4201 2182, 4163 2189, 4176 2229, 4199 2211, 4210 2218, 4212 2210, 4223 2214, 4224 2207, 4224 2216, 4217 2225,&quot;</a>
<a name="1916"><span class="lineNum">    1916 </span>                :            :                     &quot; 4221 2233, 4203 2227, 4209 2248, 4185 2240, 4198 2276, 4144 2218, 4091 2343, 4119 2332, 4121 2347, 4155 2337,&quot;</a>
<a name="1917"><span class="lineNum">    1917 </span>                :            :                     &quot; 4180 2355, 4200 2342, 4201 2354, 4213 2352, 4224 2348, 4224 2356, 4207 2361, 4184 2358, 4176 2367, 4106 2355,&quot;</a>
<a name="1918"><span class="lineNum">    1918 </span>                :            :                     &quot; 3983 2765, 4050 3151, 4139 2720, 4209 2589, 4211 2600, 4219 2599, 4224 2592, 4224 2574, 4223 2566, 4224 2562,&quot;</a>
<a name="1919"><span class="lineNum">    1919 </span>                :            :                     &quot; 4224 2553, 4224 2552, 4224 -128, 4224 4224, 4205 4224, 4015 3513, 3993 3494, 3873 3533, 3887 3539, 3923 3524,&quot;</a>
<a name="1920"><span class="lineNum">    1920 </span>                :            :                     &quot; 3950 3529, 4018 3572, 3987 3633, 3983 3571, 3955 3583, 3936 3547, 3882 3539, 3913 3557, 3920 3598, 3901 3596,&quot;</a>
<a name="1921"><span class="lineNum">    1921 </span>                :            :                     &quot; 3923 3631, 3914 3628, 3919 3647, 3922 3656, 3917 3666, 3523 3438, 3631 3564, 3527 3597, 3718 3655, 3578 3672,&quot;</a>
<a name="1922"><span class="lineNum">    1922 </span>                :            :                     &quot; 3660 3867, 3543 3628, 3416 3725, 3487 3503, 3274 3583, 3271 3644, 3197 3671, 3210 3775, 3184 3788, 3181 3672,&quot;</a>
<a name="1923"><span class="lineNum">    1923 </span>                :            :                     &quot; 3306 3521, 3292 3508, 3229 3565, 3219 3564, 3216 3574, 3192 3578, 3297 3444, 3089 3395, 3029 3028, 2973 3133,&quot;</a>
<a name="1924"><span class="lineNum">    1924 </span>                :            :                     &quot; 2529 2945, 2538 2811, 2461 2901, 2170 2839, 2121 2797, 2156 2733, 2105 2709, 2096 2695, 2114 2621, 2102 2693,&quot;</a>
<a name="1925"><span class="lineNum">    1925 </span>                :            :                     &quot; 2168 2738, 2167 2778, 2447 2765, 2441 2866, 2527 2793, 2670 2938, 2626 2651, 2688 2623, 2740 2922, 3084 2960,&quot;</a>
<a name="1926"><span class="lineNum">    1926 </span>                :            :                     &quot; 3116 3071),(4016 1878, 4029 1859, 4008 1839, 4006 1863, 4016 1878),(3315 1339, 3331 1324, 3290 1293, 3305 1315,&quot;</a>
<a name="1927"><span class="lineNum">    1927 </span>                :            :                     &quot; 3315 1339),(4136 3071, 4136 3080, 4143 3020, 4137 3036, 4136 3071),(4218 3073, 4183 3114, 4117 3157, 4159 3147,&quot;</a>
<a name="1928"><span class="lineNum">    1928 </span>                :            :                     &quot; 4218 3073),(3912 3542, 3934 3536, 3955 3536, 3937 3527, 3900 3540, 3912 3542),(4050 3172, 4043 3210, 4085 3209,&quot;</a>
<a name="1929"><span class="lineNum">    1929 </span>                :            :                     &quot; 4090 3179, 4050 3172),(4151 2998, 4158 2977, 4159 2946, 4147 2988, 4151 2998),(2920 3005, 2935 2994, 2864 2973,&quot;</a>
<a name="1930"><span class="lineNum">    1930 </span>                :            :                     &quot; 2905 3016, 2920 3005),(3571 2424, 3545 2469, 3608 2480, 3596 2434, 3571 2424),(4095 1229, 4073 1234, 4076 1293,&quot;</a>
<a name="1931"><span class="lineNum">    1931 </span>                :            :                     &quot; 4121 1285, 4095 1229),(4173 1536, 4153 1576, 4166 1585, 4198 1571, 4188 1532, 4213 1535, 4224 1512, 4224 1511,&quot;</a>
<a name="1932"><span class="lineNum">    1932 </span>                :            :                     &quot; 4209 1511, 4198 1506, 4190 1517, 4194 1509, 4192 1499, 4200 1496, 4202 1504, 4224 1510, 4224 1488, 4215 1486,&quot;</a>
<a name="1933"><span class="lineNum">    1933 </span>                :            :                     &quot; 4216 1478, 4224 1472, 4224 1464, 4207 1458, 4193 1464, 4173 1536),(3934 1537, 3968 1630, 3960 1666, 3968 1673,&quot;</a>
<a name="1934"><span class="lineNum">    1934 </span>                :            :                     &quot; 3975 1562, 3934 1537),(4182 1653, 4196 1624, 4166 1614, 4157 1674, 4216 1671, 4182 1653),(4200 1619, 4196 1620,&quot;</a>
<a name="1935"><span class="lineNum">    1935 </span>                :            :                     &quot; 4200 1632, 4195 1642, 4207 1648, 4200 1619),(4026 1835, 4025 1830, 4016 1808, 4007 1836, 4026 1835),(4199 1384,&quot;</a>
<a name="1936"><span class="lineNum">    1936 </span>                :            :                     &quot; 4182 1389, 4206 1412, 4216 1401, 4199 1384),(3926 1251, 3969 1206, 3913 1149, 3878 1173, 3876 1229, 3926 1251),&quot;</a>
<a name="1937"><span class="lineNum">    1937 </span>                :            :                     &quot; (3926 1354, 3958 1389, 3997 1384, 3991 1352, 3960 1322, 3955 1299, 3926 1354),(3964 1319, 3974 1329, 3984 1285,&quot;</a>
<a name="1938"><span class="lineNum">    1938 </span>                :            :                     &quot; 3963 1301, 3964 1319),(3687 959, 3696 903, 3678 885, 3665 930, 3687 959),(3452 79, 3437 124, 3456 149, 3476 141,&quot;</a>
<a name="1939"><span class="lineNum">    1939 </span>                :            :                     &quot; 3452 79),(3751 927, 3738 906, 3719 942, 3739 929, 3751 927))&quot; );</a>
<a name="1940"><span class="lineNum">    1940 </span>                :            : </a>
<a name="1941"><span class="lineNum">    1941 </span>                :<span class="lineCov">          1 :   QString poly2Wkt( &quot;Polygon ((-128 4224, -128 2734, -11 2643, -101 2919, 120 2654, 19 2846, 217 2897, -13 2873, -79 2998, -106 2989,&quot;</span></a>
<a name="1942"><span class="lineNum">    1942 </span>                :            :                     &quot; -128 3002, -128 4224, -128 4224, 1249 4224, 1247 4199, 1231 4132, 909 3902, 775 3278, 509 2903, 470 2603, 663 2311,&quot;</a>
<a name="1943"><span class="lineNum">    1943 </span>                :            :                     &quot; 889 2134, 989 2146, 534 2585, 575 2880, 833 3112, 833 3037, 1025 2977, 834 3096, 946 3217, 923 3153, 971 3094,&quot;</a>
<a name="1944"><span class="lineNum">    1944 </span>                :            :                     &quot; 997 3103, 1166 3423, 1198 3329, 1233 3367, 1270 3327, 1274 3354, 1290 3360, 1321 3322, 1331 3318, 1343 3325,&quot;</a>
<a name="1945"><span class="lineNum">    1945 </span>                :            :                     &quot; 1310 3073, 1363 3093, 1413 3186, 1325 3398, 1458 3364, 1493 3426, 1526 3394, 1588 3465, 1417 3824, 1458 3825,&quot;</a>
<a name="1946"><span class="lineNum">    1946 </span>                :            :                     &quot; 1522 3849, 1729 3488, 2018 3223, 1908 3291, 1924 3238, 1899 3187, 1913 3150, 2070 3041, 2102 3063, 2112 3053,&quot;</a>
<a name="1947"><span class="lineNum">    1947 </span>                :            :                     &quot; 2168 3085, 2101 2994, 2265 2863, 1890 2593, 2106 2713, 2130 2706, 2108 2678, 2117 2647, 2105 2636, 2099 2604,&quot;</a>
<a name="1948"><span class="lineNum">    1948 </span>                :            :                     &quot; 2094 2591, 2088 2575, 2088 2564, 2249 2751, 2441 2618, 2689 1728, 2681 2323, 2776 1685, 2711 1708, 2673 1680,&quot;</a>
<a name="1949"><span class="lineNum">    1949 </span>                :            :                     &quot; 2675 1639, 2810 1522, 2765 1535, 2734 1510, 2850 1332, 2863 1186, 2847 1025, 2832 985, 2739 1025, 2850 1090,&quot;</a>
<a name="1950"><span class="lineNum">    1950 </span>                :            :                     &quot; 2859 1174, 2853 1235, 2827 1235, 2839 1279, 2811 1286, 2751 1272, 2851 1160, 2788 1159, 2724 1204, 2713 1198,&quot;</a>
<a name="1951"><span class="lineNum">    1951 </span>                :            :                     &quot; 2708 1213, 2699 1221, 2724 1179, 2797 1145, 2785 1123, 2848 1143, 2821 1092, 2284 980, 2288 963, 2264 962,&quot;</a>
<a name="1952"><span class="lineNum">    1952 </span>                :            :                     &quot; 2261 948, 2247 958, 2194 947, 2120 900, 2047 809, 2434 923, 2450 817, 2528 737, 2527 667, 2641 544, 2641 460,&quot;</a>
<a name="1953"><span class="lineNum">    1953 </span>                :            :                     &quot; 2710 452, 2687 447, 2681 435, 2693 330, 2772 327, 2766 291, 2779 245, 2769 219, 2771 198, 2816 219, 2781 342,&quot;</a>
<a name="1954"><span class="lineNum">    1954 </span>                :            :                     &quot; 2612 647, 2903 188, 2803 539, 2950 206, 2927 342, 3123 339, 3092 300, 3073 175, 3082 160, 3412 -103, 4224 -128,&quot;</a>
<a name="1955"><span class="lineNum">    1955 </span>                :            :                     &quot; 4032 167, 3572 63, 3554 109, 3606 211, 3604 232, 3454 124, 3332 345, 3237 212, 3181 415, 2953 364, 2761 692,&quot;</a>
<a name="1956"><span class="lineNum">    1956 </span>                :            :                     &quot; 2819 788, 2997 769, 2997 626, 3199 659, 3155 730, 2929 805, 2908 841, 3218 717, 3276 744, 3246 723, 3270 658,&quot;</a>
<a name="1957"><span class="lineNum">    1957 </span>                :            :                     &quot; 4223 473, 4224 589, 3906 681, 3818 677, 3915 686, 4224 592, 4224 4224, -128 4224, -128 4224),(2049 3181,&quot;</a>
<a name="1958"><span class="lineNum">    1958 </span>                :            :                     &quot; 2224 3084, 2204 3040, 2169 3036, 2174 3084, 2155 3102, 2126 3123, 2109 3127, 2103 3102, 2049 3181),(1578 3811,&quot;</a>
<a name="1959"><span class="lineNum">    1959 </span>                :            :                     &quot; 1567 3883, 1675 3768, 1658 3712, 1659 3751, 1578 3811),(2304 2930, 2335 2918, 2287 2880, 2279 2926, 2304 2930),&quot;</a>
<a name="1960"><span class="lineNum">    1960 </span>                :            :                     &quot; (2316 2895, 2317 2895, 2316 2901, 2331 2901, 2332 2889, 2316 2895),(2304 2850, 2335 2861, 2344 2910, 2357 2828,&quot;</a>
<a name="1961"><span class="lineNum">    1961 </span>                :            :                     &quot; 2304 2850),(1714 3583, 1725 3638, 1682 3717, 1797 3564, 1714 3583),(1537 3873, 1456 3827, 1405 3876, 1461 3898,&quot;</a>
<a name="1962"><span class="lineNum">    1962 </span>                :            :                     &quot; 1537 3873),(2547 2560, 2375 2815, 2384 2825, 2470 2722, 2685 2336, 2648 2310, 2547 2560),(2107 3073, 2107 3098,&quot;</a>
<a name="1963"><span class="lineNum">    1963 </span>                :            :                     &quot; 2144 3086, 2122 3073, 2113 3059, 2107 3073),(2117 3120, 2156 3099, 2164 3083, 2106 3103, 2117 3120),(2303 2981,&quot;</a>
<a name="1964"><span class="lineNum">    1964 </span>                :            :                     &quot; 2226 3010, 2232 3064, 2286 3012, 2344 2928, 2303 2981),(2304 2858, 2291 2864, 2303 2885, 2324 2870, 2304 2858),&quot;</a>
<a name="1965"><span class="lineNum">    1965 </span>                :            :                     &quot; (2175 3002, 2179 2983, 2152 2991, 2175 3002, 2175 3002),(2175 3022, 2150 3017, 2144 3048, 2159 3031, 2184 3030,&quot;</a>
<a name="1966"><span class="lineNum">    1966 </span>                :            :                     &quot; 2175 3022),(2265 2953, 2270 2950, 2262 2950, 2254 2963, 2253 2979, 2265 2953),(2229 2928, 2250 2928, 2241 2922,&quot;</a>
<a name="1967"><span class="lineNum">    1967 </span>                :            :                     &quot; 2239 2914, 2224 2900, 2237 2914, 2229 2928),(2531 2473, 2520 2466, 2521 2474, 2511 2503, 2531 2473),(2547 2526,&quot;</a>
<a name="1968"><span class="lineNum">    1968 </span>                :            :                     &quot; 2529 2519, 2528 2541, 2544 2538, 2547 2526),(2559 646, 2513 810, 2463 835, 2462 930, 2746 731, 2559 646),(3840 653,&quot;</a>
<a name="1969"><span class="lineNum">    1969 </span>                :            :                     &quot; 3809 641, 3718 689, 3547 733, 3553 712, 3440 780, 3840 653),(3327 741, 3242 750, 3195 745, 3180 758, 3326 764,&quot;</a>
<a name="1970"><span class="lineNum">    1970 </span>                :            :                     &quot; 3440 742, 3327 741),(3282 702, 3265 699, 3273 721, 3290 714, 3282 702),(3762 662, 3783 654, 3786 638, 3742 653,&quot;</a>
<a name="1971"><span class="lineNum">    1971 </span>                :            :                     &quot; 3762 662),(3071 703, 3082 741, 3079 655, 3064 657, 3071 703),(3881 637, 3904 647, 3914 626, 3861 638, 3881 637))&quot; );</a>
<a name="1972"><span class="lineNum">    1972 </span>                :            : </a>
<a name="1973"><span class="lineNum">    1973 </span>                :<span class="lineCov">          1 :   QgsGeometry poly1 = QgsGeometry::fromWkt( poly1Wkt );</span></a>
<a name="1974"><span class="lineNum">    1974 </span>                :<span class="lineCov">          1 :   QgsGeometry poly2 = QgsGeometry::fromWkt( poly2Wkt );</span></a>
<a name="1975"><span class="lineNum">    1975 </span>                :            : </a>
<a name="1976"><span class="lineNum">    1976 </span>                :            :   double distance;</a>
<a name="1977"><span class="lineNum">    1977 </span>                :<span class="lineCov">          1 :   QgsPointXY point = poly1.poleOfInaccessibility( 1, &amp;distance ).asPoint();</span></a>
<a name="1978"><span class="lineNum">    1978 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3867.37, 0.01 );</span></a>
<a name="1979"><span class="lineNum">    1979 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 2126.45, 0.01 );</span></a>
<a name="1980"><span class="lineNum">    1980 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( distance, 289.51, 0.01 );</span></a>
<a name="1981"><span class="lineNum">    1981 </span>                :            : </a>
<a name="1982"><span class="lineNum">    1982 </span>                :<span class="lineCov">          1 :   point = poly1.poleOfInaccessibility( 50 ).asPoint();</span></a>
<a name="1983"><span class="lineNum">    1983 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3855.33, 0.01 );</span></a>
<a name="1984"><span class="lineNum">    1984 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 2117.55, 0.01 );</span></a>
<a name="1985"><span class="lineNum">    1985 </span>                :            : </a>
<a name="1986"><span class="lineNum">    1986 </span>                :<span class="lineCov">          1 :   point = poly2.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="1987"><span class="lineNum">    1987 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 3263.50, 0.01 );</span></a>
<a name="1988"><span class="lineNum">    1988 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 3263.50, 0.01 );</span></a>
<a name="1989"><span class="lineNum">    1989 </span>                :            : </a>
<a name="1990"><span class="lineNum">    1990 </span>                :            :   //test degenerate polygons</a>
<a name="1991"><span class="lineNum">    1991 </span>                :<span class="lineCov">          2 :   QgsGeometry degen1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 0 0, 1 0, 2 0, 0 0 ))&quot; ) );</span></a>
<a name="1992"><span class="lineNum">    1992 </span>                :<span class="lineCov">          1 :   point = degen1.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="1993"><span class="lineNum">    1993 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 0, 0.01 );</span></a>
<a name="1994"><span class="lineNum">    1994 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 0, 0.01 );</span></a>
<a name="1995"><span class="lineNum">    1995 </span>                :            : </a>
<a name="1996"><span class="lineNum">    1996 </span>                :<span class="lineCov">          2 :   QgsGeometry degen2 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 0 0, 1 0, 1 1 , 1 0, 0 0 ))&quot; ) );</span></a>
<a name="1997"><span class="lineNum">    1997 </span>                :<span class="lineCov">          1 :   point = degen2.poleOfInaccessibility( 1 ).asPoint();</span></a>
<a name="1998"><span class="lineNum">    1998 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 0, 0.01 );</span></a>
<a name="1999"><span class="lineNum">    1999 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 0, 0.01 );</span></a>
<a name="2000"><span class="lineNum">    2000 </span>                :            : </a>
<a name="2001"><span class="lineNum">    2001 </span>                :            :   //empty geometry</a>
<a name="2002"><span class="lineNum">    2002 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsGeometry().poleOfInaccessibility( 1 ).isNull() );</span></a>
<a name="2003"><span class="lineNum">    2003 </span>                :            : </a>
<a name="2004"><span class="lineNum">    2004 </span>                :            :   // not a polygon</a>
<a name="2005"><span class="lineNum">    2005 </span>                :<span class="lineCov">          2 :   QgsGeometry lineString = QgsGeometry::fromWkt( QStringLiteral( &quot;LineString(1 0, 2 2 )&quot; ) );</span></a>
<a name="2006"><span class="lineNum">    2006 </span>                :<span class="lineCov">          1 :   QVERIFY( lineString.poleOfInaccessibility( 1 ).isNull() );</span></a>
<a name="2007"><span class="lineNum">    2007 </span>                :            : </a>
<a name="2008"><span class="lineNum">    2008 </span>                :            :   // invalid threshold</a>
<a name="2009"><span class="lineNum">    2009 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1.poleOfInaccessibility( -1 ).isNull() );</span></a>
<a name="2010"><span class="lineNum">    2010 </span>                :<span class="lineCov">          1 :   QVERIFY( poly1.poleOfInaccessibility( 0 ).isNull() );</span></a>
<a name="2011"><span class="lineNum">    2011 </span>                :            : </a>
<a name="2012"><span class="lineNum">    2012 </span>                :            :   // curved geometry</a>
<a name="2013"><span class="lineNum">    2013 </span>                :<span class="lineCov">          1 :   QgsGeometry curved = QgsGeometry::fromWkt( &quot;CurvePolygon( CompoundCurve( CircularString(-0.44 0.35, 0.51 0.34, 0.56 0.21, 0.11 -0.33, 0.15 -0.35,&quot;</span></a>
<a name="2014"><span class="lineNum">    2014 </span>                :            :                        &quot;-0.93 -0.30, -1.02 -0.22, -0.49 0.01, -0.23 -0.04),(-0.23 -0.04, -0.44, 0.35)))&quot; );</a>
<a name="2015"><span class="lineNum">    2015 </span>                :<span class="lineCov">          1 :   point = curved.poleOfInaccessibility( 0.01 ).asPoint();</span></a>
<a name="2016"><span class="lineNum">    2016 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), -0.4324, 0.0001 );</span></a>
<a name="2017"><span class="lineNum">    2017 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), -0.2434, 0.0001 );</span></a>
<a name="2018"><span class="lineNum">    2018 </span>                :            : </a>
<a name="2019"><span class="lineNum">    2019 </span>                :            :   // multipolygon</a>
<a name="2020"><span class="lineNum">    2020 </span>                :<span class="lineCov">          2 :   QgsGeometry multiPoly = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon (((0 0, 10 0, 10 10, 0 10, 0 0)),((30 30, 50 30, 50 60, 30 60, 30 30)))&quot; ) );</span></a>
<a name="2021"><span class="lineNum">    2021 </span>                :<span class="lineCov">          1 :   point = multiPoly.poleOfInaccessibility( 0.01, &amp;distance ).asPoint();</span></a>
<a name="2022"><span class="lineNum">    2022 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.x(), 40, 0.0001 );</span></a>
<a name="2023"><span class="lineNum">    2023 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( point.y(), 45, 0.0001 );</span></a>
<a name="2024"><span class="lineNum">    2024 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( distance, 10.0, 0.00001 );</span></a>
<a name="2025"><span class="lineNum">    2025 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2026"><span class="lineNum">    2026 </span>                :            : </a>
<a name="2027"><span class="lineNum">    2027 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::makeValid_data()</span></a>
<a name="2028"><span class="lineNum">    2028 </span>                :            : {</a>
<a name="2029"><span class="lineNum">    2029 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;input&quot; );</span></a>
<a name="2030"><span class="lineNum">    2030 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;expected&quot; );</span></a>
<a name="2031"><span class="lineNum">    2031 </span>                :            : </a>
<a name="2032"><span class="lineNum">    2032 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;dimension collapse&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0)&quot; ) &lt;&lt; QStringLiteral( &quot;&quot; );</span></a>
<a name="2033"><span class="lineNum">    2033 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;unclosed ring&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((10 22,10 32,20 32,20 22))&quot; ) &lt;&lt; QStringLiteral( &quot;Polygon ((10 22, 10 32, 20 32, 20 22, 10 22))&quot; );</span></a>
<a name="2034"><span class="lineNum">    2034 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;butterfly polygon (self-intersecting ring)&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((0 0, 10 10, 10 0, 0 10, 0 0))&quot; ) &lt;&lt; QStringLiteral( &quot;MultiPolygon (((5 5, 10 10, 10 0, 5 5)),((0 0, 0 10, 5 5, 0 0)))&quot; );</span></a>
<a name="2035"><span class="lineNum">    2035 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;polygon with extra tail (a part of the ring does not form any area)&quot; ) &lt;&lt; QStringLiteral( &quot;POLYGON((0 0, 1 0, 1 1, 0 1, 0 0, -1 0, 0 0))&quot; ) &lt;&lt; QStringLiteral( &quot;GeometryCollection (Polygon ((0 0, 0 1, 1 1, 1 0, 0 0)),LineString (0 0, -1 0))&quot; );</span></a>
<a name="2036"><span class="lineNum">    2036 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;collection with invalid geometries&quot; ) &lt;&lt; QStringLiteral( &quot;GEOMETRYCOLLECTION(LINESTRING(0 0, 0 0), POLYGON((0 0, 10 10, 10 0, 0 10, 0 0)), LINESTRING(10 0, 10 10))&quot; ) &lt;&lt; QStringLiteral( &quot;GeometryCollection (MultiPolygon (((5 5, 10 10, 10 0, 5 5)),((0 0, 0 10, 5 5, 0 0))),LineString (10 0, 10 10),Point (0 0))&quot; );</span></a>
<a name="2037"><span class="lineNum">    2037 </span>                :<span class="lineCov">          3 :   QTest::newRow( &quot;null line (#18077)&quot; ) &lt;&lt; QStringLiteral( &quot;MultiLineString ((356984.0625 6300089, 356984.0625 6300089))&quot; ) &lt;&lt; QStringLiteral( &quot;Point (356984.0625 6300089)&quot; );</span></a>
<a name="2038"><span class="lineNum">    2038 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2039"><span class="lineNum">    2039 </span>                :            : </a>
<a name="2040"><span class="lineNum">    2040 </span>                :<span class="lineCov">          6 : void TestQgsGeometry::makeValid()</span></a>
<a name="2041"><span class="lineNum">    2041 </span>                :            : {</a>
<a name="2042"><span class="lineNum">    2042 </span>                :<span class="lineCov">          6 :   QFETCH( QString, input );</span></a>
<a name="2043"><span class="lineNum">    2043 </span>                :<span class="lineCov">          6 :   QFETCH( QString, expected );</span></a>
<a name="2044"><span class="lineNum">    2044 </span>                :            : </a>
<a name="2045"><span class="lineNum">    2045 </span>                :<span class="lineCov">          6 :   QgsGeometry gInput = QgsGeometry::fromWkt( input );</span></a>
<a name="2046"><span class="lineNum">    2046 </span>                :<span class="lineCov">          6 :   QVERIFY( !gInput.isNull() );</span></a>
<a name="2047"><span class="lineNum">    2047 </span>                :            : </a>
<a name="2048"><span class="lineNum">    2048 </span>                :<span class="lineCov">          6 :   QgsGeometry gValid = gInput.makeValid();</span></a>
<a name="2049"><span class="lineNum">    2049 </span>                :<span class="lineCov">          6 :   gValid.normalize();</span></a>
<a name="2050"><span class="lineNum">    2050 </span>                :<span class="lineCov">          6 :   QCOMPARE( gValid.asWkt(), expected );</span></a>
<a name="2051"><span class="lineNum">    2051 </span>                :<span class="lineCov">          6 : }</span></a>
<a name="2052"><span class="lineNum">    2052 </span>                :            : </a>
<a name="2053"><span class="lineNum">    2053 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::isSimple_data()</span></a>
<a name="2054"><span class="lineNum">    2054 </span>                :            : {</a>
<a name="2055"><span class="lineNum">    2055 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;QString&gt;( &quot;wkt&quot; );</span></a>
<a name="2056"><span class="lineNum">    2056 </span>                :<span class="lineCov">          1 :   QTest::addColumn&lt;bool&gt;( &quot;simple&quot; );</span></a>
<a name="2057"><span class="lineNum">    2057 </span>                :            : </a>
<a name="2058"><span class="lineNum">    2058 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;linestring&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1)&quot; ) &lt;&lt; true;</span></a>
<a name="2059"><span class="lineNum">    2059 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;may be closed (linear ring)&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0 0)&quot; ) &lt;&lt; true;</span></a>
<a name="2060"><span class="lineNum">    2060 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;self-intersection&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0 -1)&quot; ) &lt;&lt; false;</span></a>
<a name="2061"><span class="lineNum">    2061 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;self-tangency&quot; ) &lt;&lt; QStringLiteral( &quot;LINESTRING(0 0, 1 0, 1 1, 0.5 0, 0 1)&quot; ) &lt;&lt; false;</span></a>
<a name="2062"><span class="lineNum">    2062 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;points are simple&quot; ) &lt;&lt; QStringLiteral( &quot;POINT(1 1)&quot; ) &lt;&lt; true;</span></a>
<a name="2063"><span class="lineNum">    2063 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;multipoint&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 1), (2 2))&quot; ) &lt;&lt; true;</span></a>
<a name="2064"><span class="lineNum">    2064 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;must not contain the same point twice&quot; ) &lt;&lt; QStringLiteral( &quot;MULTIPOINT((1 1), (1 1))&quot; ) &lt;&lt; false;</span></a>
<a name="2065"><span class="lineNum">    2065 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;multiline string simple&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 0), (0 1, 1 1))&quot; ) &lt;&lt; true;</span></a>
<a name="2066"><span class="lineNum">    2066 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;may be touching at endpoints&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 0), (0 0, 1 0))&quot; ) &lt;&lt; true;</span></a>
<a name="2067"><span class="lineNum">    2067 </span>                :<span class="lineCov">          2 :   QTest::newRow( &quot;must not intersect each other&quot; ) &lt;&lt; QStringLiteral( &quot;MULTILINESTRING((0 0, 1 1), (0 1, 1 0))&quot; ) &lt;&lt; false;</span></a>
<a name="2068"><span class="lineNum">    2068 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2069"><span class="lineNum">    2069 </span>                :            : </a>
<a name="2070"><span class="lineNum">    2070 </span>                :<span class="lineCov">         10 : void TestQgsGeometry::isSimple()</span></a>
<a name="2071"><span class="lineNum">    2071 </span>                :            : {</a>
<a name="2072"><span class="lineNum">    2072 </span>                :<span class="lineCov">         10 :   QFETCH( QString, wkt );</span></a>
<a name="2073"><span class="lineNum">    2073 </span>                :<span class="lineCov">         10 :   QFETCH( bool, simple );</span></a>
<a name="2074"><span class="lineNum">    2074 </span>                :            : </a>
<a name="2075"><span class="lineNum">    2075 </span>                :<span class="lineCov">         10 :   QgsGeometry gInput = QgsGeometry::fromWkt( wkt );</span></a>
<a name="2076"><span class="lineNum">    2076 </span>                :<span class="lineCov">         10 :   QVERIFY( !gInput.isNull() );</span></a>
<a name="2077"><span class="lineNum">    2077 </span>                :            : </a>
<a name="2078"><span class="lineNum">    2078 </span>                :<span class="lineCov">         10 :   bool res = gInput.isSimple();</span></a>
<a name="2079"><span class="lineNum">    2079 </span>                :<span class="lineCov">         10 :   QCOMPARE( res, simple );</span></a>
<a name="2080"><span class="lineNum">    2080 </span>                :<span class="lineCov">         10 : }</span></a>
<a name="2081"><span class="lineNum">    2081 </span>                :            : </a>
<a name="2082"><span class="lineNum">    2082 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::reshapeGeometryLineMerge()</span></a>
<a name="2083"><span class="lineNum">    2083 </span>                :            : {</a>
<a name="2084"><span class="lineNum">    2084 </span>                :            :   int res;</a>
<a name="2085"><span class="lineNum">    2085 </span>                :<span class="lineCov">          2 :   QgsGeometry g2D = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRING(10 10, 20 20)&quot; ) );</span></a>
<a name="2086"><span class="lineNum">    2086 </span>                :<span class="lineCov">          2 :   QgsGeometry g3D = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRINGZ(10 10 1, 20 20 2)&quot; ) );</span></a>
<a name="2087"><span class="lineNum">    2087 </span>                :            : </a>
<a name="2088"><span class="lineNum">    2088 </span>                :            :   // prepare 2D reshaping line</a>
<a name="2089"><span class="lineNum">    2089 </span>                :<span class="lineCov">          1 :   QgsPointSequence v2D_1, v2D_2;</span></a>
<a name="2090"><span class="lineNum">    2090 </span>                :<span class="lineCov">          1 :   v2D_1 &lt;&lt; QgsPoint( 20, 20 ) &lt;&lt; QgsPoint( 30, 30 );</span></a>
<a name="2091"><span class="lineNum">    2091 </span>                :<span class="lineCov">          1 :   v2D_2 &lt;&lt; QgsPoint( 10, 10 ) &lt;&lt; QgsPoint( -10, -10 );</span></a>
<a name="2092"><span class="lineNum">    2092 </span>                :<span class="lineCov">          1 :   QgsLineString line2D_1( v2D_1 ), line2D_2( v2D_2 );</span></a>
<a name="2093"><span class="lineNum">    2093 </span>                :            : </a>
<a name="2094"><span class="lineNum">    2094 </span>                :            :   // prepare 3D reshaping line</a>
<a name="2095"><span class="lineNum">    2095 </span>                :<span class="lineCov">          1 :   QgsPointSequence v3D_1, v3D_2;</span></a>
<a name="2096"><span class="lineNum">    2096 </span>                :<span class="lineCov">          1 :   v3D_1 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 20, 20, 2 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 30, 30, 3 );</span></a>
<a name="2097"><span class="lineNum">    2097 </span>                :<span class="lineCov">          1 :   v3D_2 &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, 10, 10, 1 ) &lt;&lt; QgsPoint( QgsWkbTypes::PointZ, -10, -10, -1 );</span></a>
<a name="2098"><span class="lineNum">    2098 </span>                :<span class="lineCov">          1 :   QgsLineString line3D_1( v3D_1 ), line3D_2( v3D_2 );</span></a>
<a name="2099"><span class="lineNum">    2099 </span>                :            : </a>
<a name="2100"><span class="lineNum">    2100 </span>                :            :   // append with 2D line</a>
<a name="2101"><span class="lineNum">    2101 </span>                :<span class="lineCov">          1 :   QgsGeometry g2D_1 = g2D;</span></a>
<a name="2102"><span class="lineNum">    2102 </span>                :<span class="lineCov">          1 :   res = static_cast&lt; int &gt;( g2D_1.reshapeGeometry( line2D_1 ) );</span></a>
<a name="2103"><span class="lineNum">    2103 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="2104"><span class="lineNum">    2104 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2D_1.asWkt(), QString( &quot;LineString (10 10, 20 20, 30 30)&quot; ) );</span></a>
<a name="2105"><span class="lineNum">    2105 </span>                :            : </a>
<a name="2106"><span class="lineNum">    2106 </span>                :            :   // prepend with 2D line</a>
<a name="2107"><span class="lineNum">    2107 </span>                :<span class="lineCov">          1 :   QgsGeometry g2D_2 = g2D;</span></a>
<a name="2108"><span class="lineNum">    2108 </span>                :<span class="lineCov">          1 :   res = static_cast&lt; int &gt;( g2D_2.reshapeGeometry( line2D_2 ) );</span></a>
<a name="2109"><span class="lineNum">    2109 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="2110"><span class="lineNum">    2110 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2D_2.asWkt(), QString( &quot;LineString (-10 -10, 10 10, 20 20)&quot; ) );</span></a>
<a name="2111"><span class="lineNum">    2111 </span>                :            : </a>
<a name="2112"><span class="lineNum">    2112 </span>                :            :   // append with 3D line</a>
<a name="2113"><span class="lineNum">    2113 </span>                :<span class="lineCov">          1 :   QgsGeometry g3D_1 = g3D;</span></a>
<a name="2114"><span class="lineNum">    2114 </span>                :<span class="lineCov">          1 :   res = static_cast&lt; int &gt;( g3D_1.reshapeGeometry( line3D_1 ) );</span></a>
<a name="2115"><span class="lineNum">    2115 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="2116"><span class="lineNum">    2116 </span>                :<span class="lineCov">          1 :   QCOMPARE( g3D_1.asWkt(), QString( &quot;LineStringZ (10 10 1, 20 20 2, 30 30 3)&quot; ) );</span></a>
<a name="2117"><span class="lineNum">    2117 </span>                :            : </a>
<a name="2118"><span class="lineNum">    2118 </span>                :            :   // prepend with 3D line</a>
<a name="2119"><span class="lineNum">    2119 </span>                :<span class="lineCov">          1 :   QgsGeometry g3D_2 = g3D;</span></a>
<a name="2120"><span class="lineNum">    2120 </span>                :<span class="lineCov">          1 :   res = static_cast&lt; int &gt;( g3D_2.reshapeGeometry( line3D_2 ) );</span></a>
<a name="2121"><span class="lineNum">    2121 </span>                :<span class="lineCov">          1 :   QCOMPARE( res, 0 );</span></a>
<a name="2122"><span class="lineNum">    2122 </span>                :<span class="lineCov">          1 :   QCOMPARE( g3D_2.asWkt(), QString( &quot;LineStringZ (-10 -10 -1, 10 10 1, 20 20 2)&quot; ) );</span></a>
<a name="2123"><span class="lineNum">    2123 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2124"><span class="lineNum">    2124 </span>                :            : </a>
<a name="2125"><span class="lineNum">    2125 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::createCollectionOfType()</span></a>
<a name="2126"><span class="lineNum">    2126 </span>                :            : {</a>
<a name="2127"><span class="lineNum">    2127 </span>                :<span class="lineCov">          1 :   std::unique_ptr&lt; QgsGeometryCollection &gt; collect( QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::Unknown ) );</span></a>
<a name="2128"><span class="lineNum">    2128 </span>                :<span class="lineCov">          1 :   QVERIFY( !collect );</span></a>
<a name="2129"><span class="lineNum">    2129 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::Point );</span></a>
<a name="2130"><span class="lineNum">    2130 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="2131"><span class="lineNum">    2131 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="2132"><span class="lineNum">    2132 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointM );</span></a>
<a name="2133"><span class="lineNum">    2133 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointM );</span></a>
<a name="2134"><span class="lineNum">    2134 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="2135"><span class="lineNum">    2135 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointZM );</span></a>
<a name="2136"><span class="lineNum">    2136 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointZM );</span></a>
<a name="2137"><span class="lineNum">    2137 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="2138"><span class="lineNum">    2138 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PointZ );</span></a>
<a name="2139"><span class="lineNum">    2139 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPointZ );</span></a>
<a name="2140"><span class="lineNum">    2140 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="2141"><span class="lineNum">    2141 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::MultiPoint );</span></a>
<a name="2142"><span class="lineNum">    2142 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPoint );</span></a>
<a name="2143"><span class="lineNum">    2143 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPoint *&gt;( collect.get() ) );</span></a>
<a name="2144"><span class="lineNum">    2144 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::LineStringZ );</span></a>
<a name="2145"><span class="lineNum">    2145 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiLineStringZ );</span></a>
<a name="2146"><span class="lineNum">    2146 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiLineString *&gt;( collect.get() ) );</span></a>
<a name="2147"><span class="lineNum">    2147 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::PolygonM );</span></a>
<a name="2148"><span class="lineNum">    2148 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiPolygonM );</span></a>
<a name="2149"><span class="lineNum">    2149 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiPolygon *&gt;( collect.get() ) );</span></a>
<a name="2150"><span class="lineNum">    2150 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::GeometryCollectionZ );</span></a>
<a name="2151"><span class="lineNum">    2151 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::GeometryCollectionZ );</span></a>
<a name="2152"><span class="lineNum">    2152 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsGeometryCollection *&gt;( collect.get() ) );</span></a>
<a name="2153"><span class="lineNum">    2153 </span>                :<span class="lineCov">          1 :   collect = QgsGeometryFactory::createCollectionOfType( QgsWkbTypes::CurvePolygonM );</span></a>
<a name="2154"><span class="lineNum">    2154 </span>                :<span class="lineCov">          1 :   QCOMPARE( collect-&gt;wkbType(), QgsWkbTypes::MultiSurfaceM );</span></a>
<a name="2155"><span class="lineNum">    2155 </span>                :<span class="lineCov">          1 :   QVERIFY( dynamic_cast&lt; QgsMultiSurface *&gt;( collect.get() ) );</span></a>
<a name="2156"><span class="lineNum">    2156 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2157"><span class="lineNum">    2157 </span>                :            : </a>
<a name="2158"><span class="lineNum">    2158 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::orientedMinimumBoundingBox()</span></a>
<a name="2159"><span class="lineNum">    2159 </span>                :            : {</a>
<a name="2160"><span class="lineNum">    2160 </span>                :<span class="lineCov">          1 :   QgsGeometry geomTest;</span></a>
<a name="2161"><span class="lineNum">    2161 </span>                :<span class="lineCov">          1 :   QgsGeometry result, resultTest;</span></a>
<a name="2162"><span class="lineNum">    2162 </span>                :            :   // empty</a>
<a name="2163"><span class="lineNum">    2163 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="2164"><span class="lineNum">    2164 </span>                :<span class="lineCov">          1 :   QVERIFY( result.isEmpty() );</span></a>
<a name="2165"><span class="lineNum">    2165 </span>                :            : </a>
<a name="2166"><span class="lineNum">    2166 </span>                :            :   // oriented rectangle</a>
<a name="2167"><span class="lineNum">    2167 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot; Polygon(0 0, 5 5, -2.07106781186547462 12.07106781186547551, -7.07106781186547462 7.07106781186547551, 0 0) &quot; ) );</span></a>
<a name="2168"><span class="lineNum">    2168 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="2169"><span class="lineNum">    2169 </span>                :<span class="lineCov">          1 :   QgsPolygonXY geomXY, resultXY;</span></a>
<a name="2170"><span class="lineNum">    2170 </span>                :<span class="lineCov">          1 :   geomXY = geomTest.asPolygon();</span></a>
<a name="2171"><span class="lineNum">    2171 </span>                :<span class="lineCov">          1 :   resultXY = result.asPolygon();</span></a>
<a name="2172"><span class="lineNum">    2172 </span>                :            : </a>
<a name="2173"><span class="lineNum">    2173 </span>                :<span class="lineCov">          1 :   QCOMPARE( geomXY.count(), resultXY.count() );</span></a>
<a name="2174"><span class="lineNum">    2174 </span>                :            :   // can't strictly compare, use tolerance</a>
<a name="2175"><span class="lineNum">    2175 </span>                :<span class="lineCov">          1 :   for ( int i = 0 ; i &lt; geomXY.count() ; ++i )</span></a>
<a name="2176"><span class="lineNum">    2176 </span>                :            :   {</a>
<a name="2177"><span class="lineNum">    2177 </span>                :<span class="lineNoCov">          0 :     QVERIFY( geomXY.at( 0 ).at( i ).compare( resultXY.at( 0 ).at( i ), 1E-8 ) );</span></a>
<a name="2178"><span class="lineNum">    2178 </span>                :<span class="lineNoCov">          0 :   }</span></a>
<a name="2179"><span class="lineNum">    2179 </span>                :            : </a>
<a name="2180"><span class="lineNum">    2180 </span>                :            :   // Issue https://github.com/qgis/QGIS/issues/33532</a>
<a name="2181"><span class="lineNum">    2181 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot; Polygon ((264 -525, 248 -521, 244 -519, 233 -508, 231 -504, 210 -445, 196 -396, 180 -332, 178 -322, 176 -310, 174 -296, 174 -261, 176 -257, 178 -255, 183 -251, 193 -245, 197 -243, 413 -176, 439 -168, 447 -166, 465 -164, 548 -164, 552 -166, 561 -175, 567 -187, 602 -304, 618 -379, 618 -400, 616 -406, 612 -414, 606 -420, 587 -430, 575 -436, 547 -446, 451 -474, 437 -478, 321 -511, 283 -521, 275 -523, 266 -525, 264 -525)) &quot; ) );</span></a>
<a name="2182"><span class="lineNum">    2182 </span>                :<span class="lineCov">          1 :   result = geomTest.orientedMinimumBoundingBox( );</span></a>
<a name="2183"><span class="lineNum">    2183 </span>                :<span class="lineCov">          2 :   QString resultTestWKT = QStringLiteral( &quot;Polygon ((635.86 -420.08, 552.66 -134.85, 153.5 -251.27, 236.69 -536.51, 635.86 -420.08))&quot; );</span></a>
<a name="2184"><span class="lineNum">    2184 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.asWkt( 2 ), resultTestWKT );</span></a>
<a name="2185"><span class="lineNum">    2185 </span>                :            : </a>
<a name="2186"><span class="lineNum">    2186 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2187"><span class="lineNum">    2187 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::minimalEnclosingCircle()</span></a>
<a name="2188"><span class="lineNum">    2188 </span>                :            : {</a>
<a name="2189"><span class="lineNum">    2189 </span>                :<span class="lineCov">          1 :   QgsGeometry geomTest;</span></a>
<a name="2190"><span class="lineNum">    2190 </span>                :<span class="lineCov">          1 :   QgsGeometry result, resultTest;</span></a>
<a name="2191"><span class="lineNum">    2191 </span>                :<span class="lineCov">          1 :   QgsPointXY center;</span></a>
<a name="2192"><span class="lineNum">    2192 </span>                :            :   double radius;</a>
<a name="2193"><span class="lineNum">    2193 </span>                :            : </a>
<a name="2194"><span class="lineNum">    2194 </span>                :            :   // empty</a>
<a name="2195"><span class="lineNum">    2195 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius );</span></a>
<a name="2196"><span class="lineNum">    2196 </span>                :<span class="lineCov">          1 :   QCOMPARE( center, QgsPointXY() );</span></a>
<a name="2197"><span class="lineNum">    2197 </span>                :<span class="lineCov">          1 :   QCOMPARE( radius, 0.0 );</span></a>
<a name="2198"><span class="lineNum">    2198 </span>                :<span class="lineCov">          1 :   QVERIFY( result.isNull() );</span></a>
<a name="2199"><span class="lineNum">    2199 </span>                :            : </a>
<a name="2200"><span class="lineNum">    2200 </span>                :            :   // case 1</a>
<a name="2201"><span class="lineNum">    2201 </span>                :<span class="lineCov">          1 :   geomTest = QgsGeometry::fromPointXY( QgsPointXY( 5, 5 ) );</span></a>
<a name="2202"><span class="lineNum">    2202 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius );</span></a>
<a name="2203"><span class="lineNum">    2203 </span>                :<span class="lineCov">          1 :   QCOMPARE( center, QgsPointXY( 5, 5 ) );</span></a>
<a name="2204"><span class="lineNum">    2204 </span>                :<span class="lineCov">          1 :   QCOMPARE( radius, 0.0 );</span></a>
<a name="2205"><span class="lineNum">    2205 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="2206"><span class="lineNum">    2206 </span>                :<span class="lineCov">          1 :   QCOMPARE( result.asWkt(), resultTest.asWkt() );</span></a>
<a name="2207"><span class="lineNum">    2207 </span>                :            : </a>
<a name="2208"><span class="lineNum">    2208 </span>                :            :   // case 2</a>
<a name="2209"><span class="lineNum">    2209 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 3 8, 7 4 )&quot; ) );</span></a>
<a name="2210"><span class="lineNum">    2210 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2211"><span class="lineNum">    2211 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 5, 6 ), 0.0001 );</span></a>
<a name="2212"><span class="lineNum">    2212 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, sqrt( 2 ) * 2, 0.0001 );</span></a>
<a name="2213"><span class="lineNum">    2213 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((7 4, 4.3 3.3, 2.3 5.3, 3 8, 5.7 8.7, 7.7 6.7, 7 4))&quot; ) );</span></a>
<a name="2214"><span class="lineNum">    2214 </span>                :            : </a>
<a name="2215"><span class="lineNum">    2215 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;LINESTRING( 0 5, 2 2, 0 -5, -1 -1 )&quot; ) );</span></a>
<a name="2216"><span class="lineNum">    2216 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2217"><span class="lineNum">    2217 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="2218"><span class="lineNum">    2218 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="2219"><span class="lineNum">    2219 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="2220"><span class="lineNum">    2220 </span>                :            : </a>
<a name="2221"><span class="lineNum">    2221 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 0 5, 2 2, 0 -5, -1 -1 )&quot; ) );</span></a>
<a name="2222"><span class="lineNum">    2222 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2223"><span class="lineNum">    2223 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="2224"><span class="lineNum">    2224 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="2225"><span class="lineNum">    2225 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="2226"><span class="lineNum">    2226 </span>                :            : </a>
<a name="2227"><span class="lineNum">    2227 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;POLYGON(( 0 5, 2 2, 0 -5, -1 -1 ))&quot; ) );</span></a>
<a name="2228"><span class="lineNum">    2228 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2229"><span class="lineNum">    2229 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="2230"><span class="lineNum">    2230 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="2231"><span class="lineNum">    2231 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="2232"><span class="lineNum">    2232 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="2233"><span class="lineNum">    2233 </span>                :            : </a>
<a name="2234"><span class="lineNum">    2234 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT( 0 5, 0 -5, 0 0 )&quot; ) );</span></a>
<a name="2235"><span class="lineNum">    2235 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2236"><span class="lineNum">    2236 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0, 0 ), 0.0001 );</span></a>
<a name="2237"><span class="lineNum">    2237 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5, 0.0001 );</span></a>
<a name="2238"><span class="lineNum">    2238 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="2239"><span class="lineNum">    2239 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0 5, 4.3 2.5, 4.3 -2.5, 0 -5, -4.3 -2.5, -4.3 2.5, 0 5))&quot; ) );</span></a>
<a name="2240"><span class="lineNum">    2240 </span>                :            : </a>
<a name="2241"><span class="lineNum">    2241 </span>                :            :   // case 3</a>
<a name="2242"><span class="lineNum">    2242 </span>                :<span class="lineCov">          2 :   geomTest = QgsGeometry::fromWkt( QStringLiteral( &quot;MULTIPOINT((0 0), (5 5), (0 -5), (0 5), (-5 0))&quot; ) );</span></a>
<a name="2243"><span class="lineNum">    2243 </span>                :<span class="lineCov">          1 :   result = geomTest.minimalEnclosingCircle( center, radius, 6 );</span></a>
<a name="2244"><span class="lineNum">    2244 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEARPOINT( center, QgsPointXY( 0.8333, 0.8333 ), 0.0001 );</span></a>
<a name="2245"><span class="lineNum">    2245 </span>                :<span class="lineCov">          1 :   QGSCOMPARENEAR( radius, 5.8926, 0.0001 );</span></a>
<a name="2246"><span class="lineNum">    2246 </span>                :<span class="lineCov">          1 :   resultTest.set( QgsCircle( QgsPoint( center ), radius ).toPolygon( 36 ) );</span></a>
<a name="2247"><span class="lineNum">    2247 </span>                :<span class="lineCov">          2 :   QCOMPARE( result.asWkt( 1 ), QStringLiteral( &quot;Polygon ((0.8 6.7, 5.9 3.8, 5.9 -2.1, 0.8 -5.1, -4.3 -2.1, -4.3 3.8, 0.8 6.7))&quot; ) );</span></a>
<a name="2248"><span class="lineNum">    2248 </span>                :            : </a>
<a name="2249"><span class="lineNum">    2249 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2250"><span class="lineNum">    2250 </span>                :            : </a>
<a name="2251"><span class="lineNum">    2251 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::splitGeometry()</span></a>
<a name="2252"><span class="lineNum">    2252 </span>                :            : {</a>
<a name="2253"><span class="lineNum">    2253 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsGeometry&gt; newGeoms;</span></a>
<a name="2254"><span class="lineNum">    2254 </span>                :<span class="lineCov">          1 :   QgsPointSequence testPoints;</span></a>
<a name="2255"><span class="lineNum">    2255 </span>                :<span class="lineCov">          1 :   qDebug() &lt;&lt; GEOSversion() &lt;&lt; &quot;\n&quot;;</span></a>
<a name="2256"><span class="lineNum">    2256 </span>                :<span class="lineCov">          2 :   QgsGeometry g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((492980.38648063864093274 7082334.45244149677455425, 493082.65415841294452548 7082319.87918917648494244, 492980.38648063858272508 7082334.45244149677455425, 492980.38648063864093274 7082334.45244149677455425))&quot; ) );</span></a>
<a name="2257"><span class="lineNum">    2257 </span>                :            :   if ( GEOS_VERSION_MAJOR == 3 &amp;&amp; GEOS_VERSION_MINOR &lt; 9 )</a>
<a name="2258"><span class="lineNum">    2258 </span>                :            :   {</a>
<a name="2259"><span class="lineNum">    2259 </span>                :            :     QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 493825.46541286131832749, 7082214.02779923938214779 ) &lt;&lt; QgsPoint( 492955.04876351181883365, 7082338.06309300474822521 ),</a>
<a name="2260"><span class="lineNum">    2260 </span>                :            :                                 newGeoms, false, testPoints ), Qgis::GeometryOperationResult::NothingHappened );</a>
<a name="2261"><span class="lineNum">    2261 </span>                :            :   }</a>
<a name="2262"><span class="lineNum">    2262 </span>                :            :   else</a>
<a name="2263"><span class="lineNum">    2263 </span>                :            :   {</a>
<a name="2264"><span class="lineNum">    2264 </span>                :<span class="lineCov">          1 :     QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 493825.46541286131832749, 7082214.02779923938214779 ) &lt;&lt; QgsPoint( 492955.04876351181883365, 7082338.06309300474822521 ),</span></a>
<a name="2265"><span class="lineNum">    2265 </span>                :            :                                 newGeoms, false, testPoints ), Qgis::GeometryOperationResult::InvalidBaseGeometry );</a>
<a name="2266"><span class="lineNum">    2266 </span>                :            :   }</a>
<a name="2267"><span class="lineNum">    2267 </span>                :<span class="lineCov">          1 :   QVERIFY( newGeoms.isEmpty() );</span></a>
<a name="2268"><span class="lineNum">    2268 </span>                :            : </a>
<a name="2269"><span class="lineNum">    2269 </span>                :            :   // Bug https://github.com/qgis/QGIS/issues/33489</a>
<a name="2270"><span class="lineNum">    2270 </span>                :<span class="lineCov">          1 :   QgsGeometry g2 = QgsGeometry::fromWkt( &quot;CompoundCurveZ ((2749546.2003820720128715 1262904.45356595050543547 100, 2749557.82053794478997588 1262920.05570670193992555 200))&quot; );</span></a>
<a name="2271"><span class="lineNum">    2271 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="2272"><span class="lineNum">    2272 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2273"><span class="lineNum">    2273 </span>                :<span class="lineCov">          1 :   QCOMPARE( g2.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 2749544.19, 1262914.79, 0 ) &lt;&lt; QgsPoint( 2749557.64, 1262897.30, 0 ), newGeoms, false, testPoints ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2274"><span class="lineNum">    2274 </span>                :<span class="lineCov">          1 :   QVERIFY( newGeoms.count() == 1 );</span></a>
<a name="2275"><span class="lineNum">    2275 </span>                :<span class="lineCov">          2 :   QCOMPARE( newGeoms[0].asWkt( 2 ), QStringLiteral( &quot;LineStringZ (2749549.12 1262908.38 125.14, 2749557.82 1262920.06 200)&quot; ) );</span></a>
<a name="2276"><span class="lineNum">    2276 </span>                :            : </a>
<a name="2277"><span class="lineNum">    2277 </span>                :            :   // Test split geometry with topological editing</a>
<a name="2278"><span class="lineNum">    2278 </span>                :<span class="lineCov">          1 :   QVector&lt;QgsPointXY&gt; testPointsXY;</span></a>
<a name="2279"><span class="lineNum">    2279 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="2280"><span class="lineNum">    2280 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2281"><span class="lineNum">    2281 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="2282"><span class="lineNum">    2282 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2283"><span class="lineNum">    2283 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 1 );</span></a>
<a name="2284"><span class="lineNum">    2284 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="2285"><span class="lineNum">    2285 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="2286"><span class="lineNum">    2286 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2287"><span class="lineNum">    2287 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2288"><span class="lineNum">    2288 </span>                :            : </a>
<a name="2289"><span class="lineNum">    2289 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2290"><span class="lineNum">    2290 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="2291"><span class="lineNum">    2291 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2292"><span class="lineNum">    2292 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="2293"><span class="lineNum">    2293 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2294"><span class="lineNum">    2294 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="2295"><span class="lineNum">    2295 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="2296"><span class="lineNum">    2296 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="2297"><span class="lineNum">    2297 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2298"><span class="lineNum">    2298 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2299"><span class="lineNum">    2299 </span>                :            : </a>
<a name="2300"><span class="lineNum">    2300 </span>                :            :   // Test split parts with topological editing</a>
<a name="2301"><span class="lineNum">    2301 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2302"><span class="lineNum">    2302 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="2303"><span class="lineNum">    2303 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2304"><span class="lineNum">    2304 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="2305"><span class="lineNum">    2305 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints, false ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2306"><span class="lineNum">    2306 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="2307"><span class="lineNum">    2307 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="2308"><span class="lineNum">    2308 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="2309"><span class="lineNum">    2309 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2310"><span class="lineNum">    2310 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2311"><span class="lineNum">    2311 </span>                :            : </a>
<a name="2312"><span class="lineNum">    2312 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2313"><span class="lineNum">    2313 </span>                :<span class="lineCov">          1 :   testPoints.clear();</span></a>
<a name="2314"><span class="lineNum">    2314 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2315"><span class="lineNum">    2315 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="2316"><span class="lineNum">    2316 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPointSequence() &lt;&lt; QgsPoint( 0.0, 42.0 ) &lt;&lt; QgsPoint( 101.0, 42.0 ), newGeoms, true, testPoints, false ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2317"><span class="lineNum">    2317 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 3 );</span></a>
<a name="2318"><span class="lineNum">    2318 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPoints.count(), 2 );</span></a>
<a name="2319"><span class="lineNum">    2319 </span>                :<span class="lineCov">          1 :   QgsGeometry::convertPointList( testPoints, testPointsXY );</span></a>
<a name="2320"><span class="lineNum">    2320 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2321"><span class="lineNum">    2321 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2322"><span class="lineNum">    2322 </span>                :            : </a>
<a name="2323"><span class="lineNum">    2323 </span>                :            :   // Repeat previous tests with QVector&lt;QgsPointXY&gt; instead of QgsPointSequence</a>
<a name="2324"><span class="lineNum">    2324 </span>                :            :   // Those tests are for the deprecated QgsGeometry::splitGeometry() variant and should be removed in QGIS 4.0</a>
<a name="2325"><span class="lineNum">    2325 </span>                :            :   Q_NOWARN_DEPRECATED_PUSH</a>
<a name="2326"><span class="lineNum">    2326 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2327"><span class="lineNum">    2327 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2328"><span class="lineNum">    2328 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="2329"><span class="lineNum">    2329 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2330"><span class="lineNum">    2330 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 1 );</span></a>
<a name="2331"><span class="lineNum">    2331 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="2332"><span class="lineNum">    2332 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2333"><span class="lineNum">    2333 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2334"><span class="lineNum">    2334 </span>                :            : </a>
<a name="2335"><span class="lineNum">    2335 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2336"><span class="lineNum">    2336 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2337"><span class="lineNum">    2337 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="2338"><span class="lineNum">    2338 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2339"><span class="lineNum">    2339 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="2340"><span class="lineNum">    2340 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="2341"><span class="lineNum">    2341 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2342"><span class="lineNum">    2342 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2343"><span class="lineNum">    2343 </span>                :            : </a>
<a name="2344"><span class="lineNum">    2344 </span>                :            :   // Test split parts with topological editing</a>
<a name="2345"><span class="lineNum">    2345 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2346"><span class="lineNum">    2346 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2347"><span class="lineNum">    2347 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon ((1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0))&quot; ) );</span></a>
<a name="2348"><span class="lineNum">    2348 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY, false ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2349"><span class="lineNum">    2349 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 2 );</span></a>
<a name="2350"><span class="lineNum">    2350 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="2351"><span class="lineNum">    2351 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2352"><span class="lineNum">    2352 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2353"><span class="lineNum">    2353 </span>                :            : </a>
<a name="2354"><span class="lineNum">    2354 </span>                :<span class="lineCov">          1 :   testPointsXY.clear();</span></a>
<a name="2355"><span class="lineNum">    2355 </span>                :<span class="lineCov">          1 :   newGeoms.clear();</span></a>
<a name="2356"><span class="lineNum">    2356 </span>                :<span class="lineCov">          2 :   g1 = QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 1.0, 1.0 100.0, 100.0 100.0, 100.0 1.0, 1.0 1.0)&quot; ) );</span></a>
<a name="2357"><span class="lineNum">    2357 </span>                :<span class="lineCov">          1 :   QCOMPARE( g1.splitGeometry( QgsPolylineXY() &lt;&lt; QgsPointXY( 0.0, 42.0 ) &lt;&lt; QgsPointXY( 101.0, 42.0 ), newGeoms, true, testPointsXY, false ), Qgis::GeometryOperationResult::Success );</span></a>
<a name="2358"><span class="lineNum">    2358 </span>                :<span class="lineCov">          1 :   QCOMPARE( newGeoms.count(), 3 );</span></a>
<a name="2359"><span class="lineNum">    2359 </span>                :<span class="lineCov">          1 :   QCOMPARE( testPointsXY.count(), 2 );</span></a>
<a name="2360"><span class="lineNum">    2360 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 0 ) ) ) );</span></a>
<a name="2361"><span class="lineNum">    2361 </span>                :<span class="lineCov">          2 :   QVERIFY( QgsGeometry::fromWkt( QStringLiteral( &quot;Linestring (1.0 42.0, 100.0 42.0)&quot; ) ).touches( QgsGeometry::fromPointXY( testPointsXY.at( 1 ) ) ) );</span></a>
<a name="2362"><span class="lineNum">    2362 </span>                :            :   Q_NOWARN_DEPRECATED_POP</a>
<a name="2363"><span class="lineNum">    2363 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2364"><span class="lineNum">    2364 </span>                :            : </a>
<a name="2365"><span class="lineNum">    2365 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::snappedToGrid()</span></a>
<a name="2366"><span class="lineNum">    2366 </span>                :            : {</a>
<a name="2367"><span class="lineNum">    2367 </span>                :            :   // points</a>
<a name="2368"><span class="lineNum">    2368 </span>                :            :   {</a>
<a name="2369"><span class="lineNum">    2369 </span>                :<span class="lineCov">         10 :     auto check = []( QgsPoint * _a, QgsPoint const &amp; b )</span></a>
<a name="2370"><span class="lineNum">    2370 </span>                :            :     {</a>
<a name="2371"><span class="lineNum">    2371 </span>                :<span class="lineCov">         10 :       std::unique_ptr&lt;QgsPoint&gt; a {_a};</span></a>
<a name="2372"><span class="lineNum">    2372 </span>                :            :       // because it is to check after snapping, there shouldn't be small precision errors</a>
<a name="2373"><span class="lineNum">    2373 </span>                :            : </a>
<a name="2374"><span class="lineNum">    2374 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.x() ) )</span></a>
<a name="2375"><span class="lineNum">    2375 </span>                :<span class="lineCov">         10 :         QVERIFY( ( float )a-&gt;x() == ( float )b.x() );</span></a>
<a name="2376"><span class="lineNum">    2376 </span>                :            : </a>
<a name="2377"><span class="lineNum">    2377 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.y() ) )</span></a>
<a name="2378"><span class="lineNum">    2378 </span>                :<span class="lineCov">         10 :         QVERIFY( ( float )a-&gt;y() == ( float )b.y() );</span></a>
<a name="2379"><span class="lineNum">    2379 </span>                :            : </a>
<a name="2380"><span class="lineNum">    2380 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.z() ) )</span></a>
<a name="2381"><span class="lineNum">    2381 </span>                :<span class="lineCov">          3 :         QVERIFY( ( float )a-&gt;z() == ( float )b.z() );</span></a>
<a name="2382"><span class="lineNum">    2382 </span>                :            : </a>
<a name="2383"><span class="lineNum">    2383 </span>                :<span class="lineCov">         10 :       if ( !std::isnan( b.m() ) )</span></a>
<a name="2384"><span class="lineNum">    2384 </span>                :<span class="lineCov">          3 :         QVERIFY( ( float )a-&gt;m() == ( float )b.m() );</span></a>
<a name="2385"><span class="lineNum">    2385 </span>                :<span class="lineCov">         10 :     };</span></a>
<a name="2386"><span class="lineNum">    2386 </span>                :            : </a>
<a name="2387"><span class="lineNum">    2387 </span>                :            : </a>
<a name="2388"><span class="lineNum">    2388 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 0, 0 ).snappedToGrid( 1, 1 ),</span></a>
<a name="2389"><span class="lineNum">    2389 </span>                :<span class="lineCov">          1 :            QgsPoint( 0, 0 ) );</span></a>
<a name="2390"><span class="lineNum">    2390 </span>                :            : </a>
<a name="2391"><span class="lineNum">    2391 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1, 2.732 ).snappedToGrid( 1, 1 ),</span></a>
<a name="2392"><span class="lineNum">    2392 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 3 ) );</span></a>
<a name="2393"><span class="lineNum">    2393 </span>                :            : </a>
<a name="2394"><span class="lineNum">    2394 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1.3, 6.4 ).snappedToGrid( 1, 1 ),</span></a>
<a name="2395"><span class="lineNum">    2395 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 6 ) );</span></a>
<a name="2396"><span class="lineNum">    2396 </span>                :            : </a>
<a name="2397"><span class="lineNum">    2397 </span>                :<span class="lineCov">          2 :     check( QgsPoint( 1.3, 6.4 ).snappedToGrid( 1, 0 ),</span></a>
<a name="2398"><span class="lineNum">    2398 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 6.4 ) );</span></a>
<a name="2399"><span class="lineNum">    2399 </span>                :            : </a>
<a name="2400"><span class="lineNum">    2400 </span>                :            : </a>
<a name="2401"><span class="lineNum">    2401 </span>                :            :     // multiple checks with the same point</a>
<a name="2402"><span class="lineNum">    2402 </span>                :<span class="lineCov">          1 :     auto p1 = QgsPoint( 1.38, 2.4432 );</span></a>
<a name="2403"><span class="lineNum">    2403 </span>                :            : </a>
<a name="2404"><span class="lineNum">    2404 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 1 ),</span></a>
<a name="2405"><span class="lineNum">    2405 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2 ) );</span></a>
<a name="2406"><span class="lineNum">    2406 </span>                :            : </a>
<a name="2407"><span class="lineNum">    2407 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 0.1 ),</span></a>
<a name="2408"><span class="lineNum">    2408 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2.4 ) );</span></a>
<a name="2409"><span class="lineNum">    2409 </span>                :            : </a>
<a name="2410"><span class="lineNum">    2410 </span>                :<span class="lineCov">          2 :     check( p1.snappedToGrid( 1, 0.01 ),</span></a>
<a name="2411"><span class="lineNum">    2411 </span>                :<span class="lineCov">          1 :            QgsPoint( 1, 2.44 ) );</span></a>
<a name="2412"><span class="lineNum">    2412 </span>                :            : </a>
<a name="2413"><span class="lineNum">    2413 </span>                :            :     // Let's test more dimensions</a>
<a name="2414"><span class="lineNum">    2414 </span>                :<span class="lineCov">          1 :     auto p2 = QgsPoint( 4.2134212, 543.1231, 0.123, 12.944145 );</span></a>
<a name="2415"><span class="lineNum">    2415 </span>                :            : </a>
<a name="2416"><span class="lineNum">    2416 </span>                :<span class="lineCov">          1 :     check( p2.snappedToGrid( 0, 0, 0, 0 ),</span></a>
<a name="2417"><span class="lineNum">    2417 </span>                :            :            p2 );</a>
<a name="2418"><span class="lineNum">    2418 </span>                :            : </a>
<a name="2419"><span class="lineNum">    2419 </span>                :<span class="lineCov">          2 :     check( p2.snappedToGrid( 0, 0, 1, 1 ),</span></a>
<a name="2420"><span class="lineNum">    2420 </span>                :<span class="lineCov">          1 :            QgsPoint( 4.2134212, 543.1231, 0, 13 ) );</span></a>
<a name="2421"><span class="lineNum">    2421 </span>                :            : </a>
<a name="2422"><span class="lineNum">    2422 </span>                :<span class="lineCov">          2 :     check( p2.snappedToGrid( 1, 0.1, 0.01, 0.001 ),</span></a>
<a name="2423"><span class="lineNum">    2423 </span>                :<span class="lineCov">          1 :            QgsPoint( 4, 543.1, 0.12, 12.944 ) );</span></a>
<a name="2424"><span class="lineNum">    2424 </span>                :            : </a>
<a name="2425"><span class="lineNum">    2425 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="2426"><span class="lineNum">    2426 </span>                :            : </a>
<a name="2427"><span class="lineNum">    2427 </span>                :            :   // MultiPolygon (testing QgsCollection, QgsCurvePolygon and QgsLineString)</a>
<a name="2428"><span class="lineNum">    2428 </span>                :            :   {</a>
<a name="2429"><span class="lineNum">    2429 </span>                :            :     /*</a>
<a name="2430"><span class="lineNum">    2430 </span>                :            :      * List of tested edge cases:</a>
<a name="2431"><span class="lineNum">    2431 </span>                :            :      *</a>
<a name="2432"><span class="lineNum">    2432 </span>                :            :      * - QgsLineString becoming a point</a>
<a name="2433"><span class="lineNum">    2433 </span>                :            :      * - QgsLineString losing enough points so it is no longer closed</a>
<a name="2434"><span class="lineNum">    2434 </span>                :            :      * - QgsCurvePolygon losing its external ring</a>
<a name="2435"><span class="lineNum">    2435 </span>                :            :      * - QgsCurvePolygon losing an internal ring</a>
<a name="2436"><span class="lineNum">    2436 </span>                :            :      * - QgsCurvePolygon losing all internal rings</a>
<a name="2437"><span class="lineNum">    2437 </span>                :            :      * - QgsCollection losing one of its members</a>
<a name="2438"><span class="lineNum">    2438 </span>                :            :      * - QgsCollection losing all its members</a>
<a name="2439"><span class="lineNum">    2439 </span>                :            :      */</a>
<a name="2440"><span class="lineNum">    2440 </span>                :            : </a>
<a name="2441"><span class="lineNum">    2441 </span>                :<span class="lineCov">          1 :     auto in = QString( &quot;MultiPolygon (((-1.2 -0.87, -0.943 0.8, 0.82 1.4, 1.2 0.9, 0.9 -0.6, -1.2 -0.87),(0.4 0, -0.4 0, 0 0.2, 0.4 0)),((2 0, 2.2 0.2, 2.2 -0.2)),((3 0, 4 0.2, 4 -0.2, 3 0)),((4 8, 3.6 4.1, 0.3 4.9, -0.2 7.8, 4 8),(6.7 7.3, 7 6.4, 5.6 5.9, 6.2 6.8, 6.7 7.3),(6 5.2, 4.9 5.3, 4.8 6.2, 6 5.2)))&quot; );</span></a>
<a name="2442"><span class="lineNum">    2442 </span>                :<span class="lineCov">          1 :     auto out = QString( &quot;MultiPolygon (((-1 -1, -1 1, 1 1, 1 -1, -1 -1)),((4 8, 4 4, 0 5, 0 8, 4 8),(7 7, 7 6, 6 6, 6 7, 7 7),(6 5, 5 5, 5 6, 6 5)))&quot; );</span></a>
<a name="2443"><span class="lineNum">    2443 </span>                :            : </a>
<a name="2444"><span class="lineNum">    2444 </span>                :<span class="lineCov">          1 :     auto inGeom = QgsGeometryFactory::geomFromWkt( in );</span></a>
<a name="2445"><span class="lineNum">    2445 </span>                :            : </a>
<a name="2446"><span class="lineNum">    2446 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { inGeom-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="2447"><span class="lineNum">    2447 </span>                :<span class="lineCov">          1 :     QCOMPARE( snapped-&gt;asWkt( 5 ), out );</span></a>
<a name="2448"><span class="lineNum">    2448 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="2449"><span class="lineNum">    2449 </span>                :            : </a>
<a name="2450"><span class="lineNum">    2450 </span>                :            :   {</a>
<a name="2451"><span class="lineNum">    2451 </span>                :            :     // Curves</a>
<a name="2452"><span class="lineNum">    2452 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;CircularString( 68.1 415.2, 27.1 505.2, 27.1 406.2 )&quot; );</span></a>
<a name="2453"><span class="lineNum">    2453 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="2454"><span class="lineNum">    2454 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 415, 27 505, 27 406)&quot; ) );</span></a>
<a name="2455"><span class="lineNum">    2455 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 10, 1 ) );</span></a>
<a name="2456"><span class="lineNum">    2456 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (70 415, 30 505, 30 406)&quot; ) );</span></a>
<a name="2457"><span class="lineNum">    2457 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 10 ) );</span></a>
<a name="2458"><span class="lineNum">    2458 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 420, 27 510, 27 410)&quot; ) );</span></a>
<a name="2459"><span class="lineNum">    2459 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 0, 0 ) );</span></a>
<a name="2460"><span class="lineNum">    2460 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68.1 415.2, 27.1 505.2, 27.1 406.2)&quot; ) );</span></a>
<a name="2461"><span class="lineNum">    2461 </span>                :            : </a>
<a name="2462"><span class="lineNum">    2462 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;CircularString (68.1 415.2, 27.1 505.2, 27.1 406.2, 35.1 410.1, 39.2 403.2)&quot; );</span></a>
<a name="2463"><span class="lineNum">    2463 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="2464"><span class="lineNum">    2464 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;CircularString (68 415, 27 505, 27 406, 35 410, 39 403)&quot; ) );</span></a>
<a name="2465"><span class="lineNum">    2465 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="2466"><span class="lineNum">    2466 </span>                :            : </a>
<a name="2467"><span class="lineNum">    2467 </span>                :            :   {</a>
<a name="2468"><span class="lineNum">    2468 </span>                :            :     // Lines</a>
<a name="2469"><span class="lineNum">    2469 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;LineString( 68.1 415.2, 27.1 505.2, 27.1 406.2 )&quot; );</span></a>
<a name="2470"><span class="lineNum">    2470 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="2471"><span class="lineNum">    2471 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 415, 27 505, 27 406)&quot; ) );</span></a>
<a name="2472"><span class="lineNum">    2472 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 10, 1 ) );</span></a>
<a name="2473"><span class="lineNum">    2473 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (70 415, 30 505, 30 406)&quot; ) );</span></a>
<a name="2474"><span class="lineNum">    2474 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 10 ) );</span></a>
<a name="2475"><span class="lineNum">    2475 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 420, 27 510, 27 410)&quot; ) );</span></a>
<a name="2476"><span class="lineNum">    2476 </span>                :            : </a>
<a name="2477"><span class="lineNum">    2477 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 0, 1 ) );</span></a>
<a name="2478"><span class="lineNum">    2478 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68.1 415, 27.1 505, 27.1 406)&quot; ) );</span></a>
<a name="2479"><span class="lineNum">    2479 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 0 ) );</span></a>
<a name="2480"><span class="lineNum">    2480 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineString (68 415.2, 27 505.2, 27 406.2)&quot; ) );</span></a>
<a name="2481"><span class="lineNum">    2481 </span>                :            : </a>
<a name="2482"><span class="lineNum">    2482 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringZ (68.1 415.2 11.2, 27.1 505.2 23.6, 27.1 406.2 39.9)&quot; );</span></a>
<a name="2483"><span class="lineNum">    2483 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="2484"><span class="lineNum">    2484 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 11.2, 27 505 23.6, 27 406 39.9)&quot; ) );</span></a>
<a name="2485"><span class="lineNum">    2485 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 1 ) );</span></a>
<a name="2486"><span class="lineNum">    2486 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 11, 27 505 24, 27 406 40)&quot; ) );</span></a>
<a name="2487"><span class="lineNum">    2487 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 10 ) );</span></a>
<a name="2488"><span class="lineNum">    2488 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZ (68 415 10, 27 505 20, 27 406 40)&quot; ) );</span></a>
<a name="2489"><span class="lineNum">    2489 </span>                :            : </a>
<a name="2490"><span class="lineNum">    2490 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringM (68.1 415.2 11.2, 27.1 505.2 23.6, 27.1 406.2 39.9)&quot; );</span></a>
<a name="2491"><span class="lineNum">    2491 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="2492"><span class="lineNum">    2492 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 11.2, 27 505 23.6, 27 406 39.9)&quot; ) );</span></a>
<a name="2493"><span class="lineNum">    2493 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 0, 1 ) );</span></a>
<a name="2494"><span class="lineNum">    2494 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 11, 27 505 24, 27 406 40)&quot; ) );</span></a>
<a name="2495"><span class="lineNum">    2495 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 0, 10 ) );</span></a>
<a name="2496"><span class="lineNum">    2496 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringM (68 415 10, 27 505 20, 27 406 40)&quot; ) );</span></a>
<a name="2497"><span class="lineNum">    2497 </span>                :            : </a>
<a name="2498"><span class="lineNum">    2498 </span>                :<span class="lineCov">          1 :     curve = QgsGeometry::fromWkt( &quot;LineStringZM (68.1 415.2 11.2 56.7, 27.1 505.2 23.6 49.1, 27.1 406.2 39.9 32.4)&quot; );</span></a>
<a name="2499"><span class="lineNum">    2499 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1 ) );</span></a>
<a name="2500"><span class="lineNum">    2500 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 11.2 56.7, 27 505 23.6 49.1, 27 406 39.9 32.4)&quot; ) );</span></a>
<a name="2501"><span class="lineNum">    2501 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 1, 1 ) );</span></a>
<a name="2502"><span class="lineNum">    2502 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 11 57, 27 505 24 49, 27 406 40 32)&quot; ) );</span></a>
<a name="2503"><span class="lineNum">    2503 </span>                :<span class="lineCov">          1 :     snapped.reset( curve.constGet()-&gt;snappedToGrid( 1, 1, 10, 10 ) );</span></a>
<a name="2504"><span class="lineNum">    2504 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt( 5 ), QStringLiteral( &quot;LineStringZM (68 415 10 60, 27 505 20 50, 27 406 40 30)&quot; ) );</span></a>
<a name="2505"><span class="lineNum">    2505 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="2506"><span class="lineNum">    2506 </span>                :            : </a>
<a name="2507"><span class="lineNum">    2507 </span>                :            :   //compound curve</a>
<a name="2508"><span class="lineNum">    2508 </span>                :            :   {</a>
<a name="2509"><span class="lineNum">    2509 </span>                :            :     // Curves</a>
<a name="2510"><span class="lineNum">    2510 </span>                :<span class="lineCov">          1 :     QgsGeometry curve = QgsGeometry::fromWkt( &quot;CompoundCurve(LineString(59.1 402.1, 68.1 415.2),CircularString( 68.1 415.2, 27.1 505.2, 27.1 406.2))&quot; );</span></a>
<a name="2511"><span class="lineNum">    2511 </span>                :<span class="lineCov">          1 :     std::unique_ptr&lt;QgsAbstractGeometry&gt; snapped { curve.constGet()-&gt;snappedToGrid( 1, 1 ) };</span></a>
<a name="2512"><span class="lineNum">    2512 </span>                :<span class="lineCov">          2 :     QCOMPARE( snapped-&gt;asWkt(), QStringLiteral( &quot;CompoundCurve ((59 402, 68 415),CircularString (68 415, 27 505, 27 406))&quot; ) );</span></a>
<a name="2513"><span class="lineNum">    2513 </span>                :<span class="lineCov">          1 :   }</span></a>
<a name="2514"><span class="lineNum">    2514 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2515"><span class="lineNum">    2515 </span>                :            : </a>
<a name="2516"><span class="lineNum">    2516 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::convertGeometryCollectionToSubclass()</span></a>
<a name="2517"><span class="lineNum">    2517 </span>                :            : {</a>
<a name="2518"><span class="lineNum">    2518 </span>                :<span class="lineCov">          2 :   QgsGeometry gc0 = QgsGeometry::fromWkt( QStringLiteral( &quot;GeometryCollection(Point(1 1), Polygon((2 2, 3 3, 2 3, 2 2)))&quot; ) );</span></a>
<a name="2519"><span class="lineNum">    2519 </span>                :            : </a>
<a name="2520"><span class="lineNum">    2520 </span>                :<span class="lineCov">          1 :   QgsGeometry gc1 = gc0;</span></a>
<a name="2521"><span class="lineNum">    2521 </span>                :<span class="lineCov">          1 :   QVERIFY( gc1.convertGeometryCollectionToSubclass( QgsWkbTypes::PointGeometry ) );</span></a>
<a name="2522"><span class="lineNum">    2522 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc1.asWkt(), QStringLiteral( &quot;MultiPoint ((1 1))&quot; ) );</span></a>
<a name="2523"><span class="lineNum">    2523 </span>                :            : </a>
<a name="2524"><span class="lineNum">    2524 </span>                :<span class="lineCov">          1 :   QgsGeometry gc2 = gc0;</span></a>
<a name="2525"><span class="lineNum">    2525 </span>                :<span class="lineCov">          1 :   QVERIFY( gc2.convertGeometryCollectionToSubclass( QgsWkbTypes::PolygonGeometry ) );</span></a>
<a name="2526"><span class="lineNum">    2526 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc2.asWkt(), QStringLiteral( &quot;MultiPolygon (((2 2, 3 3, 2 3, 2 2)))&quot; ) );</span></a>
<a name="2527"><span class="lineNum">    2527 </span>                :            : </a>
<a name="2528"><span class="lineNum">    2528 </span>                :<span class="lineCov">          1 :   QgsGeometry gc3 = gc0;</span></a>
<a name="2529"><span class="lineNum">    2529 </span>                :<span class="lineCov">          1 :   QVERIFY( gc3.convertGeometryCollectionToSubclass( QgsWkbTypes::LineGeometry ) );</span></a>
<a name="2530"><span class="lineNum">    2530 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc3.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="2531"><span class="lineNum">    2531 </span>                :<span class="lineCov">          1 :   QVERIFY( gc3.isEmpty() );</span></a>
<a name="2532"><span class="lineNum">    2532 </span>                :            : </a>
<a name="2533"><span class="lineNum">    2533 </span>                :            :   // trying to convert a geometry that is not a geometry collection</a>
<a name="2534"><span class="lineNum">    2534 </span>                :<span class="lineCov">          2 :   QgsGeometry wrong = QgsGeometry::fromWkt( QStringLiteral( &quot;Point(1 2)&quot; ) );</span></a>
<a name="2535"><span class="lineNum">    2535 </span>                :<span class="lineCov">          1 :   QVERIFY( !wrong.convertGeometryCollectionToSubclass( QgsWkbTypes::PolygonGeometry ) );</span></a>
<a name="2536"><span class="lineNum">    2536 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2537"><span class="lineNum">    2537 </span>                :            : </a>
<a name="2538"><span class="lineNum">    2538 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::emptyJson()</span></a>
<a name="2539"><span class="lineNum">    2539 </span>                :            : {</a>
<a name="2540"><span class="lineNum">    2540 </span>                :<span class="lineCov">          1 :   QString expected;</span></a>
<a name="2541"><span class="lineNum">    2541 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;LineString\&quot;}&quot; );</span></a>
<a name="2542"><span class="lineNum">    2542 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCircularString().asJson(), expected );</span></a>
<a name="2543"><span class="lineNum">    2543 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCompoundCurve().asJson(), expected );</span></a>
<a name="2544"><span class="lineNum">    2544 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsLineString().asJson(), expected );</span></a>
<a name="2545"><span class="lineNum">    2545 </span>                :            : </a>
<a name="2546"><span class="lineNum">    2546 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;geometries\&quot;:[],\&quot;type\&quot;:\&quot;GeometryCollection\&quot;}&quot; );</span></a>
<a name="2547"><span class="lineNum">    2547 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsGeometryCollection().asJson(), expected );</span></a>
<a name="2548"><span class="lineNum">    2548 </span>                :            : </a>
<a name="2549"><span class="lineNum">    2549 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiLineString\&quot;}&quot; );</span></a>
<a name="2550"><span class="lineNum">    2550 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiCurve().asJson(), expected );</span></a>
<a name="2551"><span class="lineNum">    2551 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiLineString().asJson(), expected );</span></a>
<a name="2552"><span class="lineNum">    2552 </span>                :            : </a>
<a name="2553"><span class="lineNum">    2553 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiPoint\&quot;}&quot; );</span></a>
<a name="2554"><span class="lineNum">    2554 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiPoint().asJson(), expected );</span></a>
<a name="2555"><span class="lineNum">    2555 </span>                :            : </a>
<a name="2556"><span class="lineNum">    2556 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;MultiPolygon\&quot;}&quot; );</span></a>
<a name="2557"><span class="lineNum">    2557 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsMultiSurface().asJson(), expected );</span></a>
<a name="2558"><span class="lineNum">    2558 </span>                :            : </a>
<a name="2559"><span class="lineNum">    2559 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;Point\&quot;}&quot; );</span></a>
<a name="2560"><span class="lineNum">    2560 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPoint().asJson(), expected );</span></a>
<a name="2561"><span class="lineNum">    2561 </span>                :            : </a>
<a name="2562"><span class="lineNum">    2562 </span>                :<span class="lineCov">          2 :   expected = QStringLiteral( &quot;{\&quot;coordinates\&quot;:[],\&quot;type\&quot;:\&quot;Polygon\&quot;}&quot; );</span></a>
<a name="2563"><span class="lineNum">    2563 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsCurvePolygon().asJson(), expected );</span></a>
<a name="2564"><span class="lineNum">    2564 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsPolygon().asJson(), expected );</span></a>
<a name="2565"><span class="lineNum">    2565 </span>                :<span class="lineCov">          1 :   QCOMPARE( QgsTriangle().asJson(), expected );</span></a>
<a name="2566"><span class="lineNum">    2566 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2567"><span class="lineNum">    2567 </span>                :            : </a>
<a name="2568"><span class="lineNum">    2568 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::testRandomPointsInPolygon()</span></a>
<a name="2569"><span class="lineNum">    2569 </span>                :            : {</a>
<a name="2570"><span class="lineNum">    2570 </span>                :            :   // null geometry</a>
<a name="2571"><span class="lineNum">    2571 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points = QgsGeometry().randomPointsInPolygon( 100 );</span></a>
<a name="2572"><span class="lineNum">    2572 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="2573"><span class="lineNum">    2573 </span>                :            : </a>
<a name="2574"><span class="lineNum">    2574 </span>                :            :   // not polygon geometry</a>
<a name="2575"><span class="lineNum">    2575 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;Point( 4 5 )&quot; ) ).randomPointsInPolygon( 100 );</span></a>
<a name="2576"><span class="lineNum">    2576 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="2577"><span class="lineNum">    2577 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;LineString( 4 5, 6 7 )&quot; ) ).randomPointsInPolygon( 100 );</span></a>
<a name="2578"><span class="lineNum">    2578 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="2579"><span class="lineNum">    2579 </span>                :            : </a>
<a name="2580"><span class="lineNum">    2580 </span>                :            :   // zero point count</a>
<a name="2581"><span class="lineNum">    2581 </span>                :<span class="lineCov">          2 :   points = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 5 15, 10 15, 10 20, 5 20, 5 15 ))&quot; ) ).randomPointsInPolygon( 0 );</span></a>
<a name="2582"><span class="lineNum">    2582 </span>                :<span class="lineCov">          1 :   QVERIFY( points.empty() );</span></a>
<a name="2583"><span class="lineNum">    2583 </span>                :            : </a>
<a name="2584"><span class="lineNum">    2584 </span>                :            :   // valid polygon</a>
<a name="2585"><span class="lineNum">    2585 </span>                :<span class="lineCov">          2 :   QgsGeometry g = QgsGeometry::fromWkt( QStringLiteral( &quot;Polygon(( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 ))&quot; ) );</span></a>
<a name="2586"><span class="lineNum">    2586 </span>                :<span class="lineCov">          1 :   points = g.randomPointsInPolygon( 10000 );</span></a>
<a name="2587"><span class="lineNum">    2587 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="2588"><span class="lineNum">    2588 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="2589"><span class="lineNum">    2589 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="2590"><span class="lineNum">    2590 </span>                :            : </a>
<a name="2591"><span class="lineNum">    2591 </span>                :            :   // valid multipolygon</a>
<a name="2592"><span class="lineNum">    2592 </span>                :<span class="lineCov">          2 :   g = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon((( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 )), (( 105 115, 110 115, 110 120, 105 120, 105 115 ), (106 116, 108 116, 108 118, 106 116 )))&quot; ) );</span></a>
<a name="2593"><span class="lineNum">    2593 </span>                :<span class="lineCov">          1 :   points = g.randomPointsInPolygon( 10000 );</span></a>
<a name="2594"><span class="lineNum">    2594 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="2595"><span class="lineNum">    2595 </span>                :<span class="lineCov">          1 :   bool foundp1Point = false;</span></a>
<a name="2596"><span class="lineNum">    2596 </span>                :<span class="lineCov">          1 :   bool foundp2Point = false;</span></a>
<a name="2597"><span class="lineNum">    2597 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="2598"><span class="lineNum">    2598 </span>                :            :   {</a>
<a name="2599"><span class="lineNum">    2599 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="2600"><span class="lineNum">    2600 </span>                :<span class="lineCov">      10000 :     foundp1Point |= p.x() &lt; 100;</span></a>
<a name="2601"><span class="lineNum">    2601 </span>                :<span class="lineCov">      10000 :     foundp2Point |= p.x() &gt; 100;</span></a>
<a name="2602"><span class="lineNum">    2602 </span>                :            :   }</a>
<a name="2603"><span class="lineNum">    2603 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp1Point );</span></a>
<a name="2604"><span class="lineNum">    2604 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp2Point );</span></a>
<a name="2605"><span class="lineNum">    2605 </span>                :            : </a>
<a name="2606"><span class="lineNum">    2606 </span>                :            :   // with seed</a>
<a name="2607"><span class="lineNum">    2607 </span>                :<span class="lineCov">          2 :   g = QgsGeometry::fromWkt( QStringLiteral( &quot;MultiPolygon((( 5 15, 10 15, 10 20, 5 20, 5 15 ), (6 16, 8 16, 8 18, 6 16 )), (( 105 115, 110 115, 110 120, 105 120, 105 115 ), (106 116, 108 116, 108 118, 106 116 )))&quot; ) );</span></a>
<a name="2608"><span class="lineNum">    2608 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points1 = g.randomPointsInPolygon( 100, 200 );</span></a>
<a name="2609"><span class="lineNum">    2609 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1.count(), 100 );</span></a>
<a name="2610"><span class="lineNum">    2610 </span>                :<span class="lineCov">          1 :   QVector&lt; QgsPointXY &gt; points2 = g.randomPointsInPolygon( 100, 200 );</span></a>
<a name="2611"><span class="lineNum">    2611 </span>                :<span class="lineCov">          1 :   QCOMPARE( points2.count(), 100 );</span></a>
<a name="2612"><span class="lineNum">    2612 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1, points2 );</span></a>
<a name="2613"><span class="lineNum">    2613 </span>                :            : </a>
<a name="2614"><span class="lineNum">    2614 </span>                :            :   // no seed</a>
<a name="2615"><span class="lineNum">    2615 </span>                :<span class="lineCov">          1 :   points1 = g.randomPointsInPolygon( 100 );</span></a>
<a name="2616"><span class="lineNum">    2616 </span>                :<span class="lineCov">          1 :   QCOMPARE( points1.count(), 100 );</span></a>
<a name="2617"><span class="lineNum">    2617 </span>                :<span class="lineCov">          1 :   points2 = g.randomPointsInPolygon( 100 );</span></a>
<a name="2618"><span class="lineNum">    2618 </span>                :<span class="lineCov">          1 :   QCOMPARE( points2.count(), 100 );</span></a>
<a name="2619"><span class="lineNum">    2619 </span>                :<span class="lineCov">          1 :   QVERIFY( points1 != points2 );</span></a>
<a name="2620"><span class="lineNum">    2620 </span>                :            : </a>
<a name="2621"><span class="lineNum">    2621 </span>                :            :   // with filter</a>
<a name="2622"><span class="lineNum">    2622 </span>                :<span class="lineCov">      20197 :   points = g.randomPointsInPolygon( 10000, []( const QgsPointXY &amp; p )-&gt;bool</span></a>
<a name="2623"><span class="lineNum">    2623 </span>                :            :   {</a>
<a name="2624"><span class="lineNum">    2624 </span>                :<span class="lineCov">      20196 :     return p.x() &gt; 100;</span></a>
<a name="2625"><span class="lineNum">    2625 </span>                :            :   } );</a>
<a name="2626"><span class="lineNum">    2626 </span>                :<span class="lineCov">          1 :   QCOMPARE( points.count(), 10000 );</span></a>
<a name="2627"><span class="lineNum">    2627 </span>                :<span class="lineCov">          1 :   foundp1Point = false;</span></a>
<a name="2628"><span class="lineNum">    2628 </span>                :<span class="lineCov">          1 :   foundp2Point = false;</span></a>
<a name="2629"><span class="lineNum">    2629 </span>                :<span class="lineCov">      10001 :   for ( const QgsPointXY &amp;p : std::as_const( points ) )</span></a>
<a name="2630"><span class="lineNum">    2630 </span>                :            :   {</a>
<a name="2631"><span class="lineNum">    2631 </span>                :<span class="lineCov">      10000 :     QVERIFY( g.intersects( QgsGeometry::fromPointXY( p ) ) );</span></a>
<a name="2632"><span class="lineNum">    2632 </span>                :<span class="lineCov">      10000 :     foundp1Point |= p.x() &lt; 100;</span></a>
<a name="2633"><span class="lineNum">    2633 </span>                :<span class="lineCov">      10000 :     foundp2Point |= p.x() &gt; 100;</span></a>
<a name="2634"><span class="lineNum">    2634 </span>                :            :   }</a>
<a name="2635"><span class="lineNum">    2635 </span>                :<span class="lineCov">          1 :   QVERIFY( !foundp1Point );</span></a>
<a name="2636"><span class="lineNum">    2636 </span>                :<span class="lineCov">          1 :   QVERIFY( foundp2Point );</span></a>
<a name="2637"><span class="lineNum">    2637 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2638"><span class="lineNum">    2638 </span>                :            : </a>
<a name="2639"><span class="lineNum">    2639 </span>                :<span class="lineCov">          1 : void TestQgsGeometry::wktParser()</span></a>
<a name="2640"><span class="lineNum">    2640 </span>                :            : {</a>
<a name="2641"><span class="lineNum">    2641 </span>                :            :   // POINT</a>
<a name="2642"><span class="lineNum">    2642 </span>                :            :   // unbalanced parentheses</a>
<a name="2643"><span class="lineNum">    2643 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT((0 1)&quot; ) );</span></a>
<a name="2644"><span class="lineNum">    2644 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT(0 1) )&quot; ) );</span></a>
<a name="2645"><span class="lineNum">    2645 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT ((0 1)&quot; ) );</span></a>
<a name="2646"><span class="lineNum">    2646 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT (0 1) )&quot; ) );</span></a>
<a name="2647"><span class="lineNum">    2647 </span>                :            :   // extra parentheses</a>
<a name="2648"><span class="lineNum">    2648 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPoint().fromWkt( &quot;POINT ( (5 1) )&quot; ) );</span></a>
<a name="2649"><span class="lineNum">    2649 </span>                :            :   // not a number</a>
<a name="2650"><span class="lineNum">    2650 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (a, b)&quot; ) );</span></a>
<a name="2651"><span class="lineNum">    2651 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (a b)&quot; ) );</span></a>
<a name="2652"><span class="lineNum">    2652 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT((0, 1)&quot; ) );</span></a>
<a name="2653"><span class="lineNum">    2653 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT(0, 1) )&quot; ) );</span></a>
<a name="2654"><span class="lineNum">    2654 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT ((0, 1)&quot; ) );</span></a>
<a name="2655"><span class="lineNum">    2655 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT (0, 1) )&quot; ) );</span></a>
<a name="2656"><span class="lineNum">    2656 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPoint().fromWkt( &quot;POINT ( (5, 1) )&quot; ) );</span></a>
<a name="2657"><span class="lineNum">    2657 </span>                :            : </a>
<a name="2658"><span class="lineNum">    2658 </span>                :            :   // valid</a>
<a name="2659"><span class="lineNum">    2659 </span>                :<span class="lineCov">          1 :   QgsPoint p;</span></a>
<a name="2660"><span class="lineNum">    2660 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5 1)&quot; ) );</span></a>
<a name="2661"><span class="lineNum">    2661 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="2662"><span class="lineNum">    2662 </span>                :            :   // extra parentheses</a>
<a name="2663"><span class="lineNum">    2663 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( (5 1) )&quot; ) );</span></a>
<a name="2664"><span class="lineNum">    2664 </span>                :            :   // unbalanced parentheses</a>
<a name="2665"><span class="lineNum">    2665 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( (5 1)&quot; ) );</span></a>
<a name="2666"><span class="lineNum">    2666 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="2667"><span class="lineNum">    2667 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5 1) )&quot; ) );</span></a>
<a name="2668"><span class="lineNum">    2668 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point (5 1)&quot; ) );</span></a>
<a name="2669"><span class="lineNum">    2669 </span>                :            : </a>
<a name="2670"><span class="lineNum">    2670 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (5.1234 1.4321)&quot; ) );</span></a>
<a name="2671"><span class="lineNum">    2671 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 4 ), QStringLiteral( &quot;Point (5.1234 1.4321)&quot; ) );</span></a>
<a name="2672"><span class="lineNum">    2672 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (-5.1234 -1.4321)&quot; ) );</span></a>
<a name="2673"><span class="lineNum">    2673 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 4 ), QStringLiteral( &quot;Point (-5.1234 -1.4321)&quot; ) );</span></a>
<a name="2674"><span class="lineNum">    2674 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT (-12e4 -1.4e-1)&quot; ) );</span></a>
<a name="2675"><span class="lineNum">    2675 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt( 2 ), QStringLiteral( &quot;Point (-120000 -0.14)&quot; ) );</span></a>
<a name="2676"><span class="lineNum">    2676 </span>                :            : </a>
<a name="2677"><span class="lineNum">    2677 </span>                :<span class="lineCov">          1 :   QVERIFY( p.fromWkt( &quot;POINT ( )&quot; ) );</span></a>
<a name="2678"><span class="lineNum">    2678 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="2679"><span class="lineNum">    2679 </span>                :<span class="lineCov">          1 :   QVERIFY( ! p.fromWkt( &quot;POINT (a, b)&quot; ) );</span></a>
<a name="2680"><span class="lineNum">    2680 </span>                :<span class="lineCov">          2 :   QCOMPARE( p.asWkt(), QStringLiteral( &quot;Point EMPTY&quot; ) );</span></a>
<a name="2681"><span class="lineNum">    2681 </span>                :            :   // LINESTRING</a>
<a name="2682"><span class="lineNum">    2682 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString(0 1, 1 2) )&quot; ) );</span></a>
<a name="2683"><span class="lineNum">    2683 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString (0 1, 1 2) )&quot; ) );</span></a>
<a name="2684"><span class="lineNum">    2684 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString ( (0 1) )&quot; ) );</span></a>
<a name="2685"><span class="lineNum">    2685 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsLineString().fromWkt( &quot;LineString ( ( 0 1, 2 3 ) )&quot; ) );</span></a>
<a name="2686"><span class="lineNum">    2686 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().fromWkt( &quot;MULTILINESTRING ((((1 2, 2 4, 4 5))&quot; ) );</span></a>
<a name="2687"><span class="lineNum">    2687 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsMultiLineString().fromWkt( &quot;MULTILINESTRING((((1 2, 2 4, 4 5))&quot; ) );</span></a>
<a name="2688"><span class="lineNum">    2688 </span>                :            :   // not a number</a>
<a name="2689"><span class="lineNum">    2689 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString(0, 1) )&quot; ) );</span></a>
<a name="2690"><span class="lineNum">    2690 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString (0, 1) )&quot; ) );</span></a>
<a name="2691"><span class="lineNum">    2691 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsLineString().fromWkt( &quot;LineString (a b, 3 4)&quot; ) );</span></a>
<a name="2692"><span class="lineNum">    2692 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsMultiLineString().fromWkt( &quot;MULTILINESTRING ((1 2, 2 a, 4 b))&quot; ) );</span></a>
<a name="2693"><span class="lineNum">    2693 </span>                :            :   // valid</a>
<a name="2694"><span class="lineNum">    2694 </span>                :<span class="lineCov">          1 :   QgsLineString l;</span></a>
<a name="2695"><span class="lineNum">    2695 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1 2, 3 4 )&quot; ) );</span></a>
<a name="2696"><span class="lineNum">    2696 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="2697"><span class="lineNum">    2697 </span>                :            :   // unbalanced parentheses</a>
<a name="2698"><span class="lineNum">    2698 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( ( 1 2, 3 4 )&quot; ) );</span></a>
<a name="2699"><span class="lineNum">    2699 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="2700"><span class="lineNum">    2700 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1 2, 3 4 ) )&quot; ) );</span></a>
<a name="2701"><span class="lineNum">    2701 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="2702"><span class="lineNum">    2702 </span>                :            :   // extra parentheses</a>
<a name="2703"><span class="lineNum">    2703 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING( ( 1 2, 3 4 ) )&quot; ) );</span></a>
<a name="2704"><span class="lineNum">    2704 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString (1 2, 3 4)&quot; ) );</span></a>
<a name="2705"><span class="lineNum">    2705 </span>                :            :   // empty</a>
<a name="2706"><span class="lineNum">    2706 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING (  )&quot; ) );</span></a>
<a name="2707"><span class="lineNum">    2707 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString EMPTY&quot; ) );</span></a>
<a name="2708"><span class="lineNum">    2708 </span>                :<span class="lineCov">          1 :   QVERIFY( ! l.fromWkt( &quot;LINESTRING ( a b, 2 3  )&quot; ) );</span></a>
<a name="2709"><span class="lineNum">    2709 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt(), QStringLiteral( &quot;LineString EMPTY&quot; ) );</span></a>
<a name="2710"><span class="lineNum">    2710 </span>                :<span class="lineCov">          1 :   QVERIFY( l.fromWkt( &quot;LINESTRING ( 1e4 -2, 3 +4.5 )&quot; ) );</span></a>
<a name="2711"><span class="lineNum">    2711 </span>                :<span class="lineCov">          2 :   QCOMPARE( l.asWkt( 1 ), QStringLiteral( &quot;LineString (10000 -2, 3 4.5)&quot; ) );</span></a>
<a name="2712"><span class="lineNum">    2712 </span>                :<span class="lineCov">          1 :   QgsMultiLineString m;</span></a>
<a name="2713"><span class="lineNum">    2713 </span>                :<span class="lineCov">          1 :   m.fromWkt( &quot;MULTILINESTRING ((1 2, 2 3, 4 5))&quot; ) ;</span></a>
<a name="2714"><span class="lineNum">    2714 </span>                :<span class="lineCov">          1 :   QVERIFY( m.fromWkt( &quot;MULTILINESTRING ((1 2, 2 3, 4 5))&quot; ) );</span></a>
<a name="2715"><span class="lineNum">    2715 </span>                :<span class="lineCov">          2 :   QCOMPARE( m.asWkt( 1 ), QStringLiteral( &quot;MultiLineString ((1 2, 2 3, 4 5))&quot; ) );</span></a>
<a name="2716"><span class="lineNum">    2716 </span>                :            : </a>
<a name="2717"><span class="lineNum">    2717 </span>                :            :   // TRIANGLE</a>
<a name="2718"><span class="lineNum">    2718 </span>                :            :   // unbalanced parenthesis</a>
<a name="2719"><span class="lineNum">    2719 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().fromWkt( &quot;Triangle( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2720"><span class="lineNum">    2720 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsTriangle().fromWkt( &quot;Triangle ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2721"><span class="lineNum">    2721 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2722"><span class="lineNum">    2722 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2723"><span class="lineNum">    2723 </span>                :            :   // not a number</a>
<a name="2724"><span class="lineNum">    2724 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle ( (0 a, b 2, 3 3 )) &quot; ) );</span></a>
<a name="2725"><span class="lineNum">    2725 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle ( (0 a, b 2, 3 3, 0 a )) &quot; ) );</span></a>
<a name="2726"><span class="lineNum">    2726 </span>                :            :   // incorrect number of points</a>
<a name="2727"><span class="lineNum">    2727 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 0, 1 1))&quot; ) );</span></a>
<a name="2728"><span class="lineNum">    2728 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 0, 1 1, 1 0, 2 3, 4 5))&quot; ) );</span></a>
<a name="2729"><span class="lineNum">    2729 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsTriangle().fromWkt( &quot;Triangle (( 0 1, 2 3, 3 4, 1 0))&quot; ) ); // four points but start and last points are different</span></a>
<a name="2730"><span class="lineNum">    2730 </span>                :            :   // valid</a>
<a name="2731"><span class="lineNum">    2731 </span>                :<span class="lineCov">          1 :   QgsTriangle t;</span></a>
<a name="2732"><span class="lineNum">    2732 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="2733"><span class="lineNum">    2733 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="2734"><span class="lineNum">    2734 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2735"><span class="lineNum">    2735 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2736"><span class="lineNum">    2736 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2737"><span class="lineNum">    2737 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2738"><span class="lineNum">    2738 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 3))&quot; ) );</span></a>
<a name="2739"><span class="lineNum">    2739 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="2740"><span class="lineNum">    2740 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3, 3 4, 0 3, 4 5))&quot; ) );</span></a>
<a name="2741"><span class="lineNum">    2741 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="2742"><span class="lineNum">    2742 </span>                :<span class="lineCov">          1 :   QVERIFY( ! t.fromWkt( &quot;TRIANGLE(( 0 1, 2 3 ))&quot; ) );</span></a>
<a name="2743"><span class="lineNum">    2743 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle EMPTY&quot; ) );</span></a>
<a name="2744"><span class="lineNum">    2744 </span>                :<span class="lineCov">          1 :   QVERIFY( t.fromWkt( &quot;TRIANGLE((0 1e3, -2 3, +3 4, 0 1e3))&quot; ) );</span></a>
<a name="2745"><span class="lineNum">    2745 </span>                :<span class="lineCov">          2 :   QCOMPARE( t.asWkt(), QStringLiteral( &quot;Triangle ((0 1000, -2 3, 3 4, 0 1000))&quot; ) );</span></a>
<a name="2746"><span class="lineNum">    2746 </span>                :            : </a>
<a name="2747"><span class="lineNum">    2747 </span>                :            :   // POLYGON</a>
<a name="2748"><span class="lineNum">    2748 </span>                :            :   // unbalanced parenthesis</a>
<a name="2749"><span class="lineNum">    2749 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().fromWkt( &quot;Polygon( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2750"><span class="lineNum">    2750 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsPolygon().fromWkt( &quot;Polygon ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2751"><span class="lineNum">    2751 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2752"><span class="lineNum">    2752 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2753"><span class="lineNum">    2753 </span>                :            :   // not a number</a>
<a name="2754"><span class="lineNum">    2754 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon ( (0 a, b 2, 3 3 )) &quot; ) );</span></a>
<a name="2755"><span class="lineNum">    2755 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsPolygon().fromWkt( &quot;Polygon ( (0 a, b 2, 3 3, 0 a )) &quot; ) );</span></a>
<a name="2756"><span class="lineNum">    2756 </span>                :            :   // valid</a>
<a name="2757"><span class="lineNum">    2757 </span>                :<span class="lineCov">          1 :   QgsPolygon poly;</span></a>
<a name="2758"><span class="lineNum">    2758 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon(( 0 1, 2 3, 3 4))&quot; ) );</span></a>
<a name="2759"><span class="lineNum">    2759 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1, 2 3, 3 4))&quot; ) ); // TODO: A polygon must be closed</span></a>
<a name="2760"><span class="lineNum">    2760 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon(( 0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2761"><span class="lineNum">    2761 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1, 2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2762"><span class="lineNum">    2762 </span>                :<span class="lineCov">          1 :   QVERIFY( poly.fromWkt( &quot;Polygon((0 1e3, -2 3, +3 4, 0 1))&quot; ) );</span></a>
<a name="2763"><span class="lineNum">    2763 </span>                :<span class="lineCov">          2 :   QCOMPARE( poly.asWkt(), QStringLiteral( &quot;Polygon ((0 1000, -2 3, 3 4, 0 1))&quot; ) );</span></a>
<a name="2764"><span class="lineNum">    2764 </span>                :            : </a>
<a name="2765"><span class="lineNum">    2765 </span>                :            :   // Circular string</a>
<a name="2766"><span class="lineNum">    2766 </span>                :            :   // unbalanced parenthesis</a>
<a name="2767"><span class="lineNum">    2767 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString(0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2768"><span class="lineNum">    2768 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString (0 1, 1 2, 3 3) )&quot; ) );</span></a>
<a name="2769"><span class="lineNum">    2769 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2770"><span class="lineNum">    2770 </span>                :<span class="lineCov">          1 :   QVERIFY( QgsCircularString().fromWkt( &quot;CircularString ( (0 1, 1 2, 3 3) )) &quot; ) );</span></a>
<a name="2771"><span class="lineNum">    2771 </span>                :            :   // not a number</a>
<a name="2772"><span class="lineNum">    2772 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsCircularString().fromWkt( &quot;CircularString (0 a, b 2, 3 3) &quot; ) );</span></a>
<a name="2773"><span class="lineNum">    2773 </span>                :<span class="lineCov">          1 :   QVERIFY( ! QgsCircularString().fromWkt( &quot;CircularString (0 a, b 2, 3 3, 0 a) &quot; ) );</span></a>
<a name="2774"><span class="lineNum">    2774 </span>                :            :   // valid</a>
<a name="2775"><span class="lineNum">    2775 </span>                :<span class="lineCov">          1 :   QgsCircularString c;</span></a>
<a name="2776"><span class="lineNum">    2776 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString( 0 1, 2 3, 3 4)&quot; ) );</span></a>
<a name="2777"><span class="lineNum">    2777 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 1, 2 3, 3 4)&quot; ) );</span></a>
<a name="2778"><span class="lineNum">    2778 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString(0 1e3, -2 3, +3 4)&quot; ) );</span></a>
<a name="2779"><span class="lineNum">    2779 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 1000, -2 3, 3 4)&quot; ) );</span></a>
<a name="2780"><span class="lineNum">    2780 </span>                :            : </a>
<a name="2781"><span class="lineNum">    2781 </span>                :<span class="lineCov">          1 :   QVERIFY( c.fromWkt( &quot;CircularString ((0 0,1 1,2 0))&quot; ) ); // Added from an old test with an invalid wkt, but allowed in QGIS https://github.com/qgis/QGIS/pull/38439/files/59aab9dc9cc58bdc98e6d8091840bc129564ed2f#diff-fe3aa1328ee04f0eb00a1b1d59c0ea71L4247</span></a>
<a name="2782"><span class="lineNum">    2782 </span>                :<span class="lineCov">          2 :   QCOMPARE( c.asWkt(), QStringLiteral( &quot;CircularString (0 0, 1 1, 2 0)&quot; ) );</span></a>
<a name="2783"><span class="lineNum">    2783 </span>                :            : </a>
<a name="2784"><span class="lineNum">    2784 </span>                :            :   // multipoint</a>
<a name="2785"><span class="lineNum">    2785 </span>                :<span class="lineCov">          1 :   QgsMultiPoint mp;</span></a>
<a name="2786"><span class="lineNum">    2786 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT (((10 40), (40 30), (20 20), (30 10))&quot; ) );</span></a>
<a name="2787"><span class="lineNum">    2787 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT (((10 40), (40 30), (xx20 20), (30 10))&quot; ) );</span></a>
<a name="2788"><span class="lineNum">    2788 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mp.fromWkt( &quot;MULTIPOINT ((10 40, 40 30, 20 20, 30 10)&quot; ) );</span></a>
<a name="2789"><span class="lineNum">    2789 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))))&quot; ) );</span></a>
<a name="2790"><span class="lineNum">    2790 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ( )&quot; ) );</span></a>
<a name="2791"><span class="lineNum">    2791 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT EMPTY&quot; ) );</span></a>
<a name="2792"><span class="lineNum">    2792 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))&quot; ) );</span></a>
<a name="2793"><span class="lineNum">    2793 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="2794"><span class="lineNum">    2794 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT (10 40, 40 30, 20 20, 30 10)&quot; ) );</span></a>
<a name="2795"><span class="lineNum">    2795 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="2796"><span class="lineNum">    2796 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ((10 40), (40 30), (20 20), (30 10))))&quot; ) );</span></a>
<a name="2797"><span class="lineNum">    2797 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((10 40),(40 30),(20 20),(30 10))&quot; ) );</span></a>
<a name="2798"><span class="lineNum">    2798 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT ( )&quot; ) );</span></a>
<a name="2799"><span class="lineNum">    2799 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint EMPTY&quot; ) );</span></a>
<a name="2800"><span class="lineNum">    2800 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT EMPTY&quot; ) );</span></a>
<a name="2801"><span class="lineNum">    2801 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint EMPTY&quot; ) );</span></a>
<a name="2802"><span class="lineNum">    2802 </span>                :            :   // Added from an old test with an invalid wkt, but allowed in QGIS https://github.com/qgis/QGIS/pull/38439/files/59aab9dc9cc58bdc98e6d8091840bc129564ed2f#diff-4444b5a772b35be43721b71a4b95d785R50</a>
<a name="2803"><span class="lineNum">    2803 </span>                :<span class="lineCov">          1 :   QVERIFY( mp.fromWkt( &quot;MULTIPOINT(0 20,20 20))&quot; ) );</span></a>
<a name="2804"><span class="lineNum">    2804 </span>                :<span class="lineCov">          2 :   QCOMPARE( mp.asWkt(), QStringLiteral( &quot;MultiPoint ((0 20),(20 20))&quot; ) );</span></a>
<a name="2805"><span class="lineNum">    2805 </span>                :            : </a>
<a name="2806"><span class="lineNum">    2806 </span>                :            :   // compoundcurve</a>
<a name="2807"><span class="lineNum">    2807 </span>                :<span class="lineCov">          1 :   QgsCompoundCurve cc;</span></a>
<a name="2808"><span class="lineNum">    2808 </span>                :<span class="lineCov">          1 :   QVERIFY( ! cc.fromWkt( &quot;COMPOUNDCURVE((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2809"><span class="lineNum">    2809 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2810"><span class="lineNum">    2810 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2811"><span class="lineNum">    2811 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2812"><span class="lineNum">    2812 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2813"><span class="lineNum">    2813 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="2814"><span class="lineNum">    2814 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve (CircularString (0 0, 1 1, 2 2),(2 2, 3 3))&quot; ) );</span></a>
<a name="2815"><span class="lineNum">    2815 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE ( )&quot; ) );</span></a>
<a name="2816"><span class="lineNum">    2816 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) );</span></a>
<a name="2817"><span class="lineNum">    2817 </span>                :<span class="lineCov">          1 :   QVERIFY( cc.fromWkt( &quot;COMPOUNDCURVE EMPTY&quot; ) );</span></a>
<a name="2818"><span class="lineNum">    2818 </span>                :<span class="lineCov">          2 :   QCOMPARE( cc.asWkt(), QStringLiteral( &quot;CompoundCurve EMPTY&quot; ) );</span></a>
<a name="2819"><span class="lineNum">    2819 </span>                :            :   // geometrycollection</a>
<a name="2820"><span class="lineNum">    2820 </span>                :<span class="lineCov">          1 :   QgsGeometryCollection gc;</span></a>
<a name="2821"><span class="lineNum">    2821 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2822"><span class="lineNum">    2822 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (GeometryCollection (CircularString (0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2823"><span class="lineNum">    2823 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2824"><span class="lineNum">    2824 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2825"><span class="lineNum">    2825 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2826"><span class="lineNum">    2826 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2827"><span class="lineNum">    2827 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="2828"><span class="lineNum">    2828 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection (CircularString (0 0, 1 1, 2 2),LineString (2 2, 3 3))&quot; ) );</span></a>
<a name="2829"><span class="lineNum">    2829 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection ( )&quot; ) );</span></a>
<a name="2830"><span class="lineNum">    2830 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="2831"><span class="lineNum">    2831 </span>                :<span class="lineCov">          1 :   QVERIFY( gc.fromWkt( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="2832"><span class="lineNum">    2832 </span>                :<span class="lineCov">          2 :   QCOMPARE( gc.asWkt(), QStringLiteral( &quot;GeometryCollection EMPTY&quot; ) );</span></a>
<a name="2833"><span class="lineNum">    2833 </span>                :            :   // curvepolygon</a>
<a name="2834"><span class="lineNum">    2834 </span>                :<span class="lineCov">          1 :   QgsCurvePolygon cp;</span></a>
<a name="2835"><span class="lineNum">    2835 </span>                :<span class="lineCov">          1 :   QVERIFY( ! cp.fromWkt( &quot;CurvePolygon((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2836"><span class="lineNum">    2836 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2837"><span class="lineNum">    2837 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2838"><span class="lineNum">    2838 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2839"><span class="lineNum">    2839 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2840"><span class="lineNum">    2840 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="2841"><span class="lineNum">    2841 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon (CircularString (0 0, 1 1, 2 2),(2 2, 3 3))&quot; ) );</span></a>
<a name="2842"><span class="lineNum">    2842 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon ( )&quot; ) );</span></a>
<a name="2843"><span class="lineNum">    2843 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="2844"><span class="lineNum">    2844 </span>                :<span class="lineCov">          1 :   QVERIFY( cp.fromWkt( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="2845"><span class="lineNum">    2845 </span>                :<span class="lineCov">          2 :   QCOMPARE( cp.asWkt(), QStringLiteral( &quot;CurvePolygon EMPTY&quot; ) );</span></a>
<a name="2846"><span class="lineNum">    2846 </span>                :            :   // multicurve</a>
<a name="2847"><span class="lineNum">    2847 </span>                :<span class="lineCov">          1 :   QgsMultiCurve mc;</span></a>
<a name="2848"><span class="lineNum">    2848 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mc.fromWkt( &quot;MultiCurve((CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2849"><span class="lineNum">    2849 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2850"><span class="lineNum">    2850 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2851"><span class="lineNum">    2851 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2852"><span class="lineNum">    2852 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2853"><span class="lineNum">    2853 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve(CIRCULARSTRING( 0 0, 1 1, 2 2), LINESTRING((2 2, 3 3)))&quot; ) );</span></a>
<a name="2854"><span class="lineNum">    2854 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve (CircularString (0 0, 1 1, 2 2),LineString (2 2, 3 3))&quot; ) );</span></a>
<a name="2855"><span class="lineNum">    2855 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve ( )&quot; ) );</span></a>
<a name="2856"><span class="lineNum">    2856 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="2857"><span class="lineNum">    2857 </span>                :<span class="lineCov">          1 :   QVERIFY( mc.fromWkt( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="2858"><span class="lineNum">    2858 </span>                :<span class="lineCov">          2 :   QCOMPARE( mc.asWkt(), QStringLiteral( &quot;MultiCurve EMPTY&quot; ) );</span></a>
<a name="2859"><span class="lineNum">    2859 </span>                :            :   // multisurface</a>
<a name="2860"><span class="lineNum">    2860 </span>                :<span class="lineCov">          1 :   QgsMultiSurface ms;</span></a>
<a name="2861"><span class="lineNum">    2861 </span>                :<span class="lineCov">          1 :   QVERIFY( ! ms.fromWkt( &quot;MultiSurface((Polygon( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2862"><span class="lineNum">    2862 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2863"><span class="lineNum">    2863 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2864"><span class="lineNum">    2864 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2865"><span class="lineNum">    2865 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2866"><span class="lineNum">    2866 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface(Polygon(( 0 0, 1 1, 2 2)), Polygon((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="2867"><span class="lineNum">    2867 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface (Polygon ((0 0, 1 1, 2 2)),Polygon ((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="2868"><span class="lineNum">    2868 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface ( )&quot; ) );</span></a>
<a name="2869"><span class="lineNum">    2869 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="2870"><span class="lineNum">    2870 </span>                :<span class="lineCov">          1 :   QVERIFY( ms.fromWkt( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="2871"><span class="lineNum">    2871 </span>                :<span class="lineCov">          2 :   QCOMPARE( ms.asWkt(), QStringLiteral( &quot;MultiSurface EMPTY&quot; ) );</span></a>
<a name="2872"><span class="lineNum">    2872 </span>                :            :   // multipolygon</a>
<a name="2873"><span class="lineNum">    2873 </span>                :<span class="lineCov">          1 :   QgsMultiPolygon mpoly;</span></a>
<a name="2874"><span class="lineNum">    2874 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mpoly.fromWkt( &quot;MultiPolygon((Polygon( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2875"><span class="lineNum">    2875 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2876"><span class="lineNum">    2876 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2877"><span class="lineNum">    2877 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2878"><span class="lineNum">    2878 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2879"><span class="lineNum">    2879 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon(Polygon(( 0 0, 1 1, 2 2)), Polygon((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="2880"><span class="lineNum">    2880 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon (((0 0, 1 1, 2 2)),((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="2881"><span class="lineNum">    2881 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon ( )&quot; ) );</span></a>
<a name="2882"><span class="lineNum">    2882 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="2883"><span class="lineNum">    2883 </span>                :<span class="lineCov">          1 :   QVERIFY( mpoly.fromWkt( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="2884"><span class="lineNum">    2884 </span>                :<span class="lineCov">          2 :   QCOMPARE( mpoly.asWkt(), QStringLiteral( &quot;MultiPolygon EMPTY&quot; ) );</span></a>
<a name="2885"><span class="lineNum">    2885 </span>                :            : </a>
<a name="2886"><span class="lineNum">    2886 </span>                :            :   // multilinestring</a>
<a name="2887"><span class="lineNum">    2887 </span>                :<span class="lineCov">          1 :   QgsMultiLineString mline;</span></a>
<a name="2888"><span class="lineNum">    2888 </span>                :<span class="lineCov">          1 :   QVERIFY( ! mline.fromWkt( &quot;MultiLineString((LineString( 0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2889"><span class="lineNum">    2889 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2890"><span class="lineNum">    2890 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2891"><span class="lineNum">    2891 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)))&quot; ) );</span></a>
<a name="2892"><span class="lineNum">    2892 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2))&quot; ) );</span></a>
<a name="2893"><span class="lineNum">    2893 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString(LineString(( 0 0, 1 1, 2 2)), LineString((2 2, 3 3, 3 2)))&quot; ) );</span></a>
<a name="2894"><span class="lineNum">    2894 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString ((0 0, 1 1, 2 2),(2 2, 3 3, 3 2))&quot; ) );</span></a>
<a name="2895"><span class="lineNum">    2895 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString ( )&quot; ) );</span></a>
<a name="2896"><span class="lineNum">    2896 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="2897"><span class="lineNum">    2897 </span>                :<span class="lineCov">          1 :   QVERIFY( mline.fromWkt( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="2898"><span class="lineNum">    2898 </span>                :<span class="lineCov">          2 :   QCOMPARE( mline.asWkt(), QStringLiteral( &quot;MultiLineString EMPTY&quot; ) );</span></a>
<a name="2899"><span class="lineNum">    2899 </span>                :<span class="lineCov">          1 : }</span></a>
<a name="2900"><span class="lineNum">    2900 </span>                :<span class="lineCov">          1 : QGSTEST_MAIN( TestQgsGeometry )</span></a>
<a name="2901"><span class="lineNum">    2901 </span>                :            : #include &quot;testqgsgeometry.moc&quot;</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.15</a></td></tr>
  </table>
  <br>

</body>
</html>
