<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - coverage.info.cleaned - core/qgsspatialindex.h</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">core</a> - qgsspatialindex.h<span style="font-size: 80%;"> (source / <a href="qgsspatialindex.h.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">coverage.info.cleaned</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2021-10-13 17:24:53</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntryHi">-</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : /***************************************************************************</a>
<a name="2"><span class="lineNum">       2 </span>                :            :     qgsspatialindex.h  - wrapper class for spatial index library</a>
<a name="3"><span class="lineNum">       3 </span>                :            :     ----------------------</a>
<a name="4"><span class="lineNum">       4 </span>                :            :     begin                : December 2006</a>
<a name="5"><span class="lineNum">       5 </span>                :            :     copyright            : (C) 2006 by Martin Dobias</a>
<a name="6"><span class="lineNum">       6 </span>                :            :     email                : wonder.sk at gmail dot com</a>
<a name="7"><span class="lineNum">       7 </span>                :            :  ***************************************************************************</a>
<a name="8"><span class="lineNum">       8 </span>                :            :  *                                                                         *</a>
<a name="9"><span class="lineNum">       9 </span>                :            :  *   This program is free software; you can redistribute it and/or modify  *</a>
<a name="10"><span class="lineNum">      10 </span>                :            :  *   it under the terms of the GNU General Public License as published by  *</a>
<a name="11"><span class="lineNum">      11 </span>                :            :  *   the Free Software Foundation; either version 2 of the License, or     *</a>
<a name="12"><span class="lineNum">      12 </span>                :            :  *   (at your option) any later version.                                   *</a>
<a name="13"><span class="lineNum">      13 </span>                :            :  *                                                                         *</a>
<a name="14"><span class="lineNum">      14 </span>                :            :  ***************************************************************************/</a>
<a name="15"><span class="lineNum">      15 </span>                :            : </a>
<a name="16"><span class="lineNum">      16 </span>                :            : #ifndef QGSSPATIALINDEX_H</a>
<a name="17"><span class="lineNum">      17 </span>                :            : #define QGSSPATIALINDEX_H</a>
<a name="18"><span class="lineNum">      18 </span>                :            : </a>
<a name="19"><span class="lineNum">      19 </span>                :            : </a>
<a name="20"><span class="lineNum">      20 </span>                :            : #include &quot;qgis_sip.h&quot;</a>
<a name="21"><span class="lineNum">      21 </span>                :            : </a>
<a name="22"><span class="lineNum">      22 </span>                :            : // forward declaration</a>
<a name="23"><span class="lineNum">      23 </span>                :            : namespace SpatialIndex SIP_SKIP</a>
<a name="24"><span class="lineNum">      24 </span>                :            : {</a>
<a name="25"><span class="lineNum">      25 </span>                :            :   class IStorageManager;</a>
<a name="26"><span class="lineNum">      26 </span>                :            :   class ISpatialIndex;</a>
<a name="27"><span class="lineNum">      27 </span>                :            :   class Region;</a>
<a name="28"><span class="lineNum">      28 </span>                :            :   class Point;</a>
<a name="29"><span class="lineNum">      29 </span>                :            : </a>
<a name="30"><span class="lineNum">      30 </span>                :            :   namespace StorageManager</a>
<a name="31"><span class="lineNum">      31 </span>                :            :   {</a>
<a name="32"><span class="lineNum">      32 </span>                :            :     class IBuffer;</a>
<a name="33"><span class="lineNum">      33 </span>                :            :   }</a>
<a name="34"><span class="lineNum">      34 </span>                :            : }</a>
<a name="35"><span class="lineNum">      35 </span>                :            : </a>
<a name="36"><span class="lineNum">      36 </span>                :            : class QgsFeedback;</a>
<a name="37"><span class="lineNum">      37 </span>                :            : class QgsFeature;</a>
<a name="38"><span class="lineNum">      38 </span>                :            : class QgsRectangle;</a>
<a name="39"><span class="lineNum">      39 </span>                :            : class QgsPointXY;</a>
<a name="40"><span class="lineNum">      40 </span>                :            : </a>
<a name="41"><span class="lineNum">      41 </span>                :            : #include &quot;qgis_core.h&quot;</a>
<a name="42"><span class="lineNum">      42 </span>                :            : #include &quot;qgsfeaturesink.h&quot;</a>
<a name="43"><span class="lineNum">      43 </span>                :            : #include &lt;QList&gt;</a>
<a name="44"><span class="lineNum">      44 </span>                :            : #include &lt;QSharedDataPointer&gt;</a>
<a name="45"><span class="lineNum">      45 </span>                :            : </a>
<a name="46"><span class="lineNum">      46 </span>                :            : #include &quot;qgsfeature.h&quot;</a>
<a name="47"><span class="lineNum">      47 </span>                :            : </a>
<a name="48"><span class="lineNum">      48 </span>                :            : class QgsSpatialIndexData;</a>
<a name="49"><span class="lineNum">      49 </span>                :            : class QgsFeatureIterator;</a>
<a name="50"><span class="lineNum">      50 </span>                :            : class QgsFeatureSource;</a>
<a name="51"><span class="lineNum">      51 </span>                :            : </a>
<a name="52"><span class="lineNum">      52 </span>                :            : /**</a>
<a name="53"><span class="lineNum">      53 </span>                :            :  * \ingroup core</a>
<a name="54"><span class="lineNum">      54 </span>                :            :  * \class QgsSpatialIndex</a>
<a name="55"><span class="lineNum">      55 </span>                :            :  *</a>
<a name="56"><span class="lineNum">      56 </span>                :            :  * \brief A spatial index for QgsFeature objects.</a>
<a name="57"><span class="lineNum">      57 </span>                :            :  *</a>
<a name="58"><span class="lineNum">      58 </span>                :            :  * QgsSpatialIndex objects are implicitly shared and can be inexpensively copied.</a>
<a name="59"><span class="lineNum">      59 </span>                :            :  *</a>
<a name="60"><span class="lineNum">      60 </span>                :            :  * \note While the underlying libspatialindex is not thread safe on some platforms, the QgsSpatialIndex</a>
<a name="61"><span class="lineNum">      61 </span>                :            :  * class implements its own locks and accordingly, a single QgsSpatialIndex object can safely</a>
<a name="62"><span class="lineNum">      62 </span>                :            :  * be used across multiple threads.</a>
<a name="63"><span class="lineNum">      63 </span>                :            :  *</a>
<a name="64"><span class="lineNum">      64 </span>                :            :  * \see QgsSpatialIndexKDBush, which is an optimised non-mutable index for point geometries only.</a>
<a name="65"><span class="lineNum">      65 </span>                :            :  * \see QgsMeshSpatialIndex, which is for mesh faces</a>
<a name="66"><span class="lineNum">      66 </span>                :            :  */</a>
<a name="67"><span class="lineNum">      67 </span>                :            : class CORE_EXPORT QgsSpatialIndex : public QgsFeatureSink</a>
<a name="68"><span class="lineNum">      68 </span>                :            : {</a>
<a name="69"><span class="lineNum">      69 </span>                :            : </a>
<a name="70"><span class="lineNum">      70 </span>                :            :   public:</a>
<a name="71"><span class="lineNum">      71 </span>                :            : </a>
<a name="72"><span class="lineNum">      72 </span>                :            :     /* creation of spatial index */</a>
<a name="73"><span class="lineNum">      73 </span>                :            : </a>
<a name="74"><span class="lineNum">      74 </span>                :            :     //! Flags controlling index behavior</a>
<a name="75"><span class="lineNum">      75 </span>                :            :     enum Flag</a>
<a name="76"><span class="lineNum">      76 </span>                :            :     {</a>
<a name="77"><span class="lineNum">      77 </span>                :            :       FlagStoreFeatureGeometries = 1 &lt;&lt; 0, //!&lt; Indicates that the spatial index should also store feature geometries. This requires more memory, but can speed up operations by avoiding additional requests to data providers to fetch matching feature geometries. Additionally, it is required for non-bounding box nearest neighbor searches.</a>
<a name="78"><span class="lineNum">      78 </span>                :            :     };</a>
<a name="79"><span class="lineNum">      79 </span>                :            :     Q_DECLARE_FLAGS( Flags, Flag )</a>
<a name="80"><span class="lineNum">      80 </span>                :            : </a>
<a name="81"><span class="lineNum">      81 </span>                :            :     /**</a>
<a name="82"><span class="lineNum">      82 </span>                :            :      * Constructor for QgsSpatialIndex. Creates an empty R-tree index.</a>
<a name="83"><span class="lineNum">      83 </span>                :            :      */</a>
<a name="84"><span class="lineNum">      84 </span>                :            :     QgsSpatialIndex( QgsSpatialIndex::Flags flags = QgsSpatialIndex::Flags() );</a>
<a name="85"><span class="lineNum">      85 </span>                :            : </a>
<a name="86"><span class="lineNum">      86 </span>                :            :     /**</a>
<a name="87"><span class="lineNum">      87 </span>                :            :      * Constructor - creates R-tree and bulk loads it with features from the iterator.</a>
<a name="88"><span class="lineNum">      88 </span>                :            :      * This is much faster approach than creating an empty index and then inserting features one by one.</a>
<a name="89"><span class="lineNum">      89 </span>                :            :      *</a>
<a name="90"><span class="lineNum">      90 </span>                :            :      * The optional \a feedback object can be used to allow cancellation of bulk feature loading. Ownership</a>
<a name="91"><span class="lineNum">      91 </span>                :            :      * of \a feedback is not transferred, and callers must take care that the lifetime of feedback exceeds</a>
<a name="92"><span class="lineNum">      92 </span>                :            :      * that of the spatial index construction.</a>
<a name="93"><span class="lineNum">      93 </span>                :            :      *</a>
<a name="94"><span class="lineNum">      94 </span>                :            :      * \since QGIS 2.8</a>
<a name="95"><span class="lineNum">      95 </span>                :            :      */</a>
<a name="96"><span class="lineNum">      96 </span>                :            :     explicit QgsSpatialIndex( const QgsFeatureIterator &amp;fi, QgsFeedback *feedback = nullptr, QgsSpatialIndex::Flags flags = QgsSpatialIndex::Flags() );</a>
<a name="97"><span class="lineNum">      97 </span>                :            : </a>
<a name="98"><span class="lineNum">      98 </span>                :            : #ifndef SIP_RUN</a>
<a name="99"><span class="lineNum">      99 </span>                :            : </a>
<a name="100"><span class="lineNum">     100 </span>                :            :     /**</a>
<a name="101"><span class="lineNum">     101 </span>                :            :      * Constructor - creates R-tree and bulk loads it with features from the iterator.</a>
<a name="102"><span class="lineNum">     102 </span>                :            :      * This is much faster approach than creating an empty index and then inserting features one by one.</a>
<a name="103"><span class="lineNum">     103 </span>                :            :      *</a>
<a name="104"><span class="lineNum">     104 </span>                :            :      * This construct and bulk load variant allows for a \a callback function to be specified, which is</a>
<a name="105"><span class="lineNum">     105 </span>                :            :      * called for each added feature in turn. It allows for bulk spatial index load along with other feature</a>
<a name="106"><span class="lineNum">     106 </span>                :            :      * based operations on a single iteration through a feature source. If \a callback returns FALSE, the</a>
<a name="107"><span class="lineNum">     107 </span>                :            :      * load and iteration is canceled.</a>
<a name="108"><span class="lineNum">     108 </span>                :            :      *</a>
<a name="109"><span class="lineNum">     109 </span>                :            :      * \note Not available in Python bindings</a>
<a name="110"><span class="lineNum">     110 </span>                :            :      * \since QGIS 2.12</a>
<a name="111"><span class="lineNum">     111 </span>                :            :      */</a>
<a name="112"><span class="lineNum">     112 </span>                :            :     explicit QgsSpatialIndex( const QgsFeatureIterator &amp;fi, const std::function&lt; bool( const QgsFeature &amp; ) &gt; &amp;callback, QgsSpatialIndex::Flags flags = QgsSpatialIndex::Flags() );</a>
<a name="113"><span class="lineNum">     113 </span>                :            : #endif</a>
<a name="114"><span class="lineNum">     114 </span>                :            : </a>
<a name="115"><span class="lineNum">     115 </span>                :            :     /**</a>
<a name="116"><span class="lineNum">     116 </span>                :            :      * Constructor - creates R-tree and bulk loads it with features from the source.</a>
<a name="117"><span class="lineNum">     117 </span>                :            :      * This is much faster approach than creating an empty index and then inserting features one by one.</a>
<a name="118"><span class="lineNum">     118 </span>                :            :      *</a>
<a name="119"><span class="lineNum">     119 </span>                :            :      * The optional \a feedback object can be used to allow cancellation of bulk feature loading. Ownership</a>
<a name="120"><span class="lineNum">     120 </span>                :            :      * of \a feedback is not transferred, and callers must take care that the lifetime of feedback exceeds</a>
<a name="121"><span class="lineNum">     121 </span>                :            :      * that of the spatial index construction.</a>
<a name="122"><span class="lineNum">     122 </span>                :            : </a>
<a name="123"><span class="lineNum">     123 </span>                :            :      *</a>
<a name="124"><span class="lineNum">     124 </span>                :            :      * \since QGIS 3.0</a>
<a name="125"><span class="lineNum">     125 </span>                :            :      */</a>
<a name="126"><span class="lineNum">     126 </span>                :            :     explicit QgsSpatialIndex( const QgsFeatureSource &amp;source, QgsFeedback *feedback = nullptr, QgsSpatialIndex::Flags flags = QgsSpatialIndex::Flags() );</a>
<a name="127"><span class="lineNum">     127 </span>                :            : </a>
<a name="128"><span class="lineNum">     128 </span>                :            :     //! Copy constructor</a>
<a name="129"><span class="lineNum">     129 </span>                :            :     QgsSpatialIndex( const QgsSpatialIndex &amp;other );</a>
<a name="130"><span class="lineNum">     130 </span>                :            : </a>
<a name="131"><span class="lineNum">     131 </span>                :            :     //! Destructor finalizes work with spatial index</a>
<a name="132"><span class="lineNum">     132 </span>                :            :     ~QgsSpatialIndex() override;</a>
<a name="133"><span class="lineNum">     133 </span>                :            : </a>
<a name="134"><span class="lineNum">     134 </span>                :            :     //! Implement assignment operator</a>
<a name="135"><span class="lineNum">     135 </span>                :            :     QgsSpatialIndex &amp;operator=( const QgsSpatialIndex &amp;other );</a>
<a name="136"><span class="lineNum">     136 </span>                :            : </a>
<a name="137"><span class="lineNum">     137 </span>                :            :     /* operations */</a>
<a name="138"><span class="lineNum">     138 </span>                :            : </a>
<a name="139"><span class="lineNum">     139 </span>                :            :     /**</a>
<a name="140"><span class="lineNum">     140 </span>                :            :      * Adds a \a feature to the index.</a>
<a name="141"><span class="lineNum">     141 </span>                :            :      * \deprecated Use addFeature() instead</a>
<a name="142"><span class="lineNum">     142 </span>                :            :      */</a>
<a name="143"><span class="lineNum">     143 </span>                :            :     Q_DECL_DEPRECATED bool insertFeature( const QgsFeature &amp;feature ) SIP_DEPRECATED;</a>
<a name="144"><span class="lineNum">     144 </span>                :            : </a>
<a name="145"><span class="lineNum">     145 </span>                :            :     /**</a>
<a name="146"><span class="lineNum">     146 </span>                :            :      * Adds a \a feature to the index.</a>
<a name="147"><span class="lineNum">     147 </span>                :            :      *</a>
<a name="148"><span class="lineNum">     148 </span>                :            :      * The \a flags argument is ignored.</a>
<a name="149"><span class="lineNum">     149 </span>                :            :      *</a>
<a name="150"><span class="lineNum">     150 </span>                :            :      * \since QGIS 3.4</a>
<a name="151"><span class="lineNum">     151 </span>                :            :      */</a>
<a name="152"><span class="lineNum">     152 </span>                :            :     bool addFeature( QgsFeature &amp;feature, QgsFeatureSink::Flags flags = QgsFeatureSink::Flags() ) override;</a>
<a name="153"><span class="lineNum">     153 </span>                :            : </a>
<a name="154"><span class="lineNum">     154 </span>                :            :     /**</a>
<a name="155"><span class="lineNum">     155 </span>                :            :      * Adds a list of \a features to the index.</a>
<a name="156"><span class="lineNum">     156 </span>                :            :      *</a>
<a name="157"><span class="lineNum">     157 </span>                :            :      * The \a flags argument is ignored.</a>
<a name="158"><span class="lineNum">     158 </span>                :            :      *</a>
<a name="159"><span class="lineNum">     159 </span>                :            :      * \see addFeature()</a>
<a name="160"><span class="lineNum">     160 </span>                :            :      */</a>
<a name="161"><span class="lineNum">     161 </span>                :            :     bool addFeatures( QgsFeatureList &amp;features, QgsFeatureSink::Flags flags = QgsFeatureSink::Flags() ) override;</a>
<a name="162"><span class="lineNum">     162 </span>                :            : </a>
<a name="163"><span class="lineNum">     163 </span>                :            :     /**</a>
<a name="164"><span class="lineNum">     164 </span>                :            :      * Add a feature \a id to the index with a specified bounding box.</a>
<a name="165"><span class="lineNum">     165 </span>                :            :      * \returns TRUE if feature was successfully added to index.</a>
<a name="166"><span class="lineNum">     166 </span>                :            :      * \deprecated Use addFeature() instead</a>
<a name="167"><span class="lineNum">     167 </span>                :            :     */</a>
<a name="168"><span class="lineNum">     168 </span>                :            :     Q_DECL_DEPRECATED bool insertFeature( QgsFeatureId id, const QgsRectangle &amp;bounds ) SIP_DEPRECATED;</a>
<a name="169"><span class="lineNum">     169 </span>                :            : </a>
<a name="170"><span class="lineNum">     170 </span>                :            :     /**</a>
<a name="171"><span class="lineNum">     171 </span>                :            :      * Add a feature \a id to the index with a specified bounding box.</a>
<a name="172"><span class="lineNum">     172 </span>                :            :      * \returns TRUE if feature was successfully added to index.</a>
<a name="173"><span class="lineNum">     173 </span>                :            :      * \since QGIS 3.4</a>
<a name="174"><span class="lineNum">     174 </span>                :            :     */</a>
<a name="175"><span class="lineNum">     175 </span>                :            :     bool addFeature( QgsFeatureId id, const QgsRectangle &amp;bounds );</a>
<a name="176"><span class="lineNum">     176 </span>                :            : </a>
<a name="177"><span class="lineNum">     177 </span>                :            :     /**</a>
<a name="178"><span class="lineNum">     178 </span>                :            :      * Removes a \a feature from the index.</a>
<a name="179"><span class="lineNum">     179 </span>                :            :      */</a>
<a name="180"><span class="lineNum">     180 </span>                :            :     bool deleteFeature( const QgsFeature &amp;feature );</a>
<a name="181"><span class="lineNum">     181 </span>                :            : </a>
<a name="182"><span class="lineNum">     182 </span>                :            : </a>
<a name="183"><span class="lineNum">     183 </span>                :            :     /* queries */</a>
<a name="184"><span class="lineNum">     184 </span>                :            : </a>
<a name="185"><span class="lineNum">     185 </span>                :            :     /**</a>
<a name="186"><span class="lineNum">     186 </span>                :            :      * Returns a list of features with a bounding box which intersects the specified \a rectangle.</a>
<a name="187"><span class="lineNum">     187 </span>                :            :      *</a>
<a name="188"><span class="lineNum">     188 </span>                :            :      * \note The intersection test is performed based on the feature bounding boxes only, so for non-point</a>
<a name="189"><span class="lineNum">     189 </span>                :            :      * geometry features it is necessary to manually test the returned features for exact geometry intersection</a>
<a name="190"><span class="lineNum">     190 </span>                :            :      * when required.</a>
<a name="191"><span class="lineNum">     191 </span>                :            :      */</a>
<a name="192"><span class="lineNum">     192 </span>                :            :     QList&lt;QgsFeatureId&gt; intersects( const QgsRectangle &amp;rectangle ) const;</a>
<a name="193"><span class="lineNum">     193 </span>                :            : </a>
<a name="194"><span class="lineNum">     194 </span>                :            :     /**</a>
<a name="195"><span class="lineNum">     195 </span>                :            :      * Returns nearest neighbors to a \a point. The number of neighbors returned is specified</a>
<a name="196"><span class="lineNum">     196 </span>                :            :      * by the \a neighbors argument.</a>
<a name="197"><span class="lineNum">     197 </span>                :            :      *</a>
<a name="198"><span class="lineNum">     198 </span>                :            :      * If the \a maxDistance argument is greater than 0, then only features within the specified</a>
<a name="199"><span class="lineNum">     199 </span>                :            :      * distance of \a point will be considered.</a>
<a name="200"><span class="lineNum">     200 </span>                :            :      *</a>
<a name="201"><span class="lineNum">     201 </span>                :            :      * Note that in some cases the number of returned features may differ from the requested</a>
<a name="202"><span class="lineNum">     202 </span>                :            :      * number of \a neighbors. E.g. if not enough features exist within the \a maxDistance of the</a>
<a name="203"><span class="lineNum">     203 </span>                :            :      * search point. If multiple features are equidistant from the search \a point then the</a>
<a name="204"><span class="lineNum">     204 </span>                :            :      * number of returned feature IDs may exceed \a neighbors.</a>
<a name="205"><span class="lineNum">     205 </span>                :            :      *</a>
<a name="206"><span class="lineNum">     206 </span>                :            :      * \warning If this QgsSpatialIndex object was not constructed with the FlagStoreFeatureGeometries flag,</a>
<a name="207"><span class="lineNum">     207 </span>                :            :      * then the nearest neighbor test is performed based on the feature bounding boxes ONLY, so for non-point</a>
<a name="208"><span class="lineNum">     208 </span>                :            :      * geometry features this method is not guaranteed to return the actual closest neighbors.</a>
<a name="209"><span class="lineNum">     209 </span>                :            :      */</a>
<a name="210"><span class="lineNum">     210 </span>                :            :     QList&lt;QgsFeatureId&gt; nearestNeighbor( const QgsPointXY &amp;point, int neighbors = 1, double maxDistance = 0 ) const;</a>
<a name="211"><span class="lineNum">     211 </span>                :            : </a>
<a name="212"><span class="lineNum">     212 </span>                :            :     /**</a>
<a name="213"><span class="lineNum">     213 </span>                :            :      * Returns nearest neighbors to a \a geometry. The number of neighbors returned is specified</a>
<a name="214"><span class="lineNum">     214 </span>                :            :      * by the \a neighbors argument.</a>
<a name="215"><span class="lineNum">     215 </span>                :            :      *</a>
<a name="216"><span class="lineNum">     216 </span>                :            :      * If the \a maxDistance argument is greater than 0, then only features within the specified</a>
<a name="217"><span class="lineNum">     217 </span>                :            :      * distance of \a point will be considered.</a>
<a name="218"><span class="lineNum">     218 </span>                :            :      *</a>
<a name="219"><span class="lineNum">     219 </span>                :            :      * Note that in some cases the number of returned features may differ from the requested</a>
<a name="220"><span class="lineNum">     220 </span>                :            :      * number of \a neighbors. E.g. if not enough features exist within the \a maxDistance of the</a>
<a name="221"><span class="lineNum">     221 </span>                :            :      * search point. If multiple features are equidistant from the search \a point then the</a>
<a name="222"><span class="lineNum">     222 </span>                :            :      * number of returned feature IDs may exceed \a neighbors.</a>
<a name="223"><span class="lineNum">     223 </span>                :            :      *</a>
<a name="224"><span class="lineNum">     224 </span>                :            :      * \warning If this QgsSpatialIndex object was not constructed with the FlagStoreFeatureGeometries flag,</a>
<a name="225"><span class="lineNum">     225 </span>                :            :      * then the nearest neighbor test is performed based on the feature bounding boxes ONLY, so for non-point</a>
<a name="226"><span class="lineNum">     226 </span>                :            :      * geometry features this method is not guaranteed to return the actual closest neighbors.</a>
<a name="227"><span class="lineNum">     227 </span>                :            :      *</a>
<a name="228"><span class="lineNum">     228 </span>                :            :      * \since QGIS 3.8</a>
<a name="229"><span class="lineNum">     229 </span>                :            :      */</a>
<a name="230"><span class="lineNum">     230 </span>                :            :     QList&lt;QgsFeatureId&gt; nearestNeighbor( const QgsGeometry &amp;geometry, int neighbors = 1, double maxDistance = 0 ) const;</a>
<a name="231"><span class="lineNum">     231 </span>                :            : </a>
<a name="232"><span class="lineNum">     232 </span>                :            : #ifndef SIP_RUN</a>
<a name="233"><span class="lineNum">     233 </span>                :            : </a>
<a name="234"><span class="lineNum">     234 </span>                :            :     /**</a>
<a name="235"><span class="lineNum">     235 </span>                :            :      * Returns the stored geometry for the indexed feature with matching \a id.</a>
<a name="236"><span class="lineNum">     236 </span>                :            :      *</a>
<a name="237"><span class="lineNum">     237 </span>                :            :      * Geometry is only stored if the QgsSpatialIndex was created with the FlagStoreFeatureGeometries flag.</a>
<a name="238"><span class="lineNum">     238 </span>                :            :      *</a>
<a name="239"><span class="lineNum">     239 </span>                :            :      * \since QGIS 3.6</a>
<a name="240"><span class="lineNum">     240 </span>                :            :      */</a>
<a name="241"><span class="lineNum">     241 </span>                :            :     QgsGeometry geometry( QgsFeatureId id ) const;</a>
<a name="242"><span class="lineNum">     242 </span>                :            : </a>
<a name="243"><span class="lineNum">     243 </span>                :            : #else</a>
<a name="244"><span class="lineNum">     244 </span>                :            : </a>
<a name="245"><span class="lineNum">     245 </span>                :            :     /**</a>
<a name="246"><span class="lineNum">     246 </span>                :            :      * Returns the stored geometry for the indexed feature with matching \a id.</a>
<a name="247"><span class="lineNum">     247 </span>                :            :      *</a>
<a name="248"><span class="lineNum">     248 </span>                :            :      * Geometry is only stored if the QgsSpatialIndex was created with the FlagStoreFeatureGeometries flag.</a>
<a name="249"><span class="lineNum">     249 </span>                :            :      *</a>
<a name="250"><span class="lineNum">     250 </span>                :            :      * \throws KeyError if no geometry with the specified feature id exists in the index.</a>
<a name="251"><span class="lineNum">     251 </span>                :            :      *</a>
<a name="252"><span class="lineNum">     252 </span>                :            :      * \since QGIS 3.6</a>
<a name="253"><span class="lineNum">     253 </span>                :            :      */</a>
<a name="254"><span class="lineNum">     254 </span>                :            :     SIP_PYOBJECT geometry( QgsFeatureId id ) const SIP_TYPEHINT( QgsGeometry );</a>
<a name="255"><span class="lineNum">     255 </span>                :            :     % MethodCode</a>
<a name="256"><span class="lineNum">     256 </span>                :            :     std::unique_ptr&lt; QgsGeometry &gt; g = std::make_unique&lt; QgsGeometry &gt;( sipCpp-&gt;geometry( a0 ) );</a>
<a name="257"><span class="lineNum">     257 </span>                :            :     if ( g-&gt;isNull() )</a>
<a name="258"><span class="lineNum">     258 </span>                :            :     {</a>
<a name="259"><span class="lineNum">     259 </span>                :            :       PyErr_SetString( PyExc_KeyError, QStringLiteral( &quot;No geometry with feature id %1 exists in the index.&quot; ).arg( a0 ).toUtf8().constData() );</a>
<a name="260"><span class="lineNum">     260 </span>                :            :       sipIsErr = 1;</a>
<a name="261"><span class="lineNum">     261 </span>                :            :     }</a>
<a name="262"><span class="lineNum">     262 </span>                :            :     else</a>
<a name="263"><span class="lineNum">     263 </span>                :            :     {</a>
<a name="264"><span class="lineNum">     264 </span>                :            :       sipRes = sipConvertFromType( g.release(), sipType_QgsGeometry, Py_None );</a>
<a name="265"><span class="lineNum">     265 </span>                :            :     }</a>
<a name="266"><span class="lineNum">     266 </span>                :            :     % End</a>
<a name="267"><span class="lineNum">     267 </span>                :            : #endif</a>
<a name="268"><span class="lineNum">     268 </span>                :            : </a>
<a name="269"><span class="lineNum">     269 </span>                :            :     /* debugging */</a>
<a name="270"><span class="lineNum">     270 </span>                :            : </a>
<a name="271"><span class="lineNum">     271 </span>                :            :     //! Gets reference count - just for debugging!</a>
<a name="272"><span class="lineNum">     272 </span>                :            :     QAtomicInt SIP_PYALTERNATIVETYPE( int ) refs() const;</a>
<a name="273"><span class="lineNum">     273 </span>                :            : </a>
<a name="274"><span class="lineNum">     274 </span>                :            :   private:</a>
<a name="275"><span class="lineNum">     275 </span>                :            : </a>
<a name="276"><span class="lineNum">     276 </span>                :            :     /**</a>
<a name="277"><span class="lineNum">     277 </span>                :            :      * Calculates feature info to insert into index.</a>
<a name="278"><span class="lineNum">     278 </span>                :            :     * \param f input feature</a>
<a name="279"><span class="lineNum">     279 </span>                :            :     * \param r will be set to spatial index region</a>
<a name="280"><span class="lineNum">     280 </span>                :            :     * \param id will be set to feature's ID</a>
<a name="281"><span class="lineNum">     281 </span>                :            :     * \returns TRUE if feature info was successfully retrieved and the feature can be added to</a>
<a name="282"><span class="lineNum">     282 </span>                :            :     * the index</a>
<a name="283"><span class="lineNum">     283 </span>                :            :     */</a>
<a name="284"><span class="lineNum">     284 </span>                :            :     static bool featureInfo( const QgsFeature &amp;f, SpatialIndex::Region &amp;r, QgsFeatureId &amp;id ) SIP_SKIP;</a>
<a name="285"><span class="lineNum">     285 </span>                :            : </a>
<a name="286"><span class="lineNum">     286 </span>                :            :     /**</a>
<a name="287"><span class="lineNum">     287 </span>                :            :      * Calculates feature info to insert into index.</a>
<a name="288"><span class="lineNum">     288 </span>                :            :      * \param f input feature</a>
<a name="289"><span class="lineNum">     289 </span>                :            :      * \param rect will be set to feature's geometry bounding box</a>
<a name="290"><span class="lineNum">     290 </span>                :            :      * \param id will be set to feature's ID</a>
<a name="291"><span class="lineNum">     291 </span>                :            :      * \returns TRUE if feature info was successfully retrieved and the feature can be added to</a>
<a name="292"><span class="lineNum">     292 </span>                :            :      * the index</a>
<a name="293"><span class="lineNum">     293 </span>                :            :      * \since QGIS 3.0</a>
<a name="294"><span class="lineNum">     294 </span>                :            :      */</a>
<a name="295"><span class="lineNum">     295 </span>                :            :     static bool featureInfo( const QgsFeature &amp;f, QgsRectangle &amp;rect, QgsFeatureId &amp;id );</a>
<a name="296"><span class="lineNum">     296 </span>                :            : </a>
<a name="297"><span class="lineNum">     297 </span>                :            :     friend class QgsFeatureIteratorDataStream; // for access to featureInfo()</a>
<a name="298"><span class="lineNum">     298 </span>                :            : </a>
<a name="299"><span class="lineNum">     299 </span>                :            :   private:</a>
<a name="300"><span class="lineNum">     300 </span>                :            : </a>
<a name="301"><span class="lineNum">     301 </span>                :            :     QSharedDataPointer&lt;QgsSpatialIndexData&gt; d;</a>
<a name="302"><span class="lineNum">     302 </span>                :            : </a>
<a name="303"><span class="lineNum">     303 </span>                :            : };</a>
<a name="304"><span class="lineNum">     304 </span>                :            : </a>
<a name="305"><span class="lineNum">     305 </span>                :<span class="lineNoCov">          0 : Q_DECLARE_OPERATORS_FOR_FLAGS( QgsSpatialIndex::Flags )</span></a>
<a name="306"><span class="lineNum">     306 </span>                :            : </a>
<a name="307"><span class="lineNum">     307 </span>                :            : #endif //QGSSPATIALINDEX_H</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.15</a></td></tr>
  </table>
  <br>

</body>
</html>
